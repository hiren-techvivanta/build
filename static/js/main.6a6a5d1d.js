/*! For license information please see main.6a6a5d1d.js.LICENSE.txt */
(()=>{var e={108:(e,t,n)=>{"use strict";function i(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function r(e){if(!((t=e)instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name))throw new Error("Uint8Array expected");for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];if(i.length>0&&!i.includes(e.length))throw new Error("Uint8Array expected of length "+i+", got length="+e.length)}function s(e){if("function"!==typeof e||"function"!==typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");i(e.outputLen),i(e.blockLen)}function a(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function o(e,t){r(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}n.d(t,{CC:()=>a,DO:()=>r,Fe:()=>i,Ht:()=>o,sd:()=>s})},268:(e,t,n)=>{"use strict";n.d(t,{S:()=>v});var i=1e6,r=1e6,s="[big.js] ",a=s+"Invalid ",o=a+"decimal places",l=a+"rounding mode",c=s+"Division by zero",h={},u=void 0,d=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function p(e,t,n,i){var r=e.c;if(n===u&&(n=e.constructor.RM),0!==n&&1!==n&&2!==n&&3!==n)throw Error(l);if(t<1)i=3===n&&(i||!!r[0])||0===t&&(1===n&&r[0]>=5||2===n&&(r[0]>5||5===r[0]&&(i||r[1]!==u))),r.length=1,i?(e.e=e.e-t+1,r[0]=1):r[0]=e.e=0;else if(t<r.length){if(i=1===n&&r[t]>=5||2===n&&(r[t]>5||5===r[t]&&(i||r[t+1]!==u||1&r[t-1]))||3===n&&(i||!!r[0]),r.length=t,i)for(;++r[--t]>9;)if(r[t]=0,0===t){++e.e,r.unshift(1);break}for(t=r.length;!r[--t];)r.pop()}return e}function f(e,t,n){var i=e.e,r=e.c.join(""),s=r.length;if(t)r=r.charAt(0)+(s>1?"."+r.slice(1):"")+(i<0?"e":"e+")+i;else if(i<0){for(;++i;)r="0"+r;r="0."+r}else if(i>0)if(++i>s)for(i-=s;i--;)r+="0";else i<s&&(r=r.slice(0,i)+"."+r.slice(i));else s>1&&(r=r.charAt(0)+"."+r.slice(1));return e.s<0&&n?"-"+r:r}h.abs=function(){var e=new this.constructor(this);return e.s=1,e},h.cmp=function(e){var t,n=this,i=n.c,r=(e=new n.constructor(e)).c,s=n.s,a=e.s,o=n.e,l=e.e;if(!i[0]||!r[0])return i[0]?s:r[0]?-a:0;if(s!=a)return s;if(t=s<0,o!=l)return o>l^t?1:-1;for(a=(o=i.length)<(l=r.length)?o:l,s=-1;++s<a;)if(i[s]!=r[s])return i[s]>r[s]^t?1:-1;return o==l?0:o>l^t?1:-1},h.div=function(e){var t=this,n=t.constructor,r=t.c,s=(e=new n(e)).c,a=t.s==e.s?1:-1,l=n.DP;if(l!==~~l||l<0||l>i)throw Error(o);if(!s[0])throw Error(c);if(!r[0])return e.s=a,e.c=[e.e=0],e;var h,d,f,m,g,v=s.slice(),y=h=s.length,b=r.length,w=r.slice(0,h),x=w.length,E=e,C=E.c=[],A=0,S=l+(E.e=t.e-e.e)+1;for(E.s=a,a=S<0?0:S,v.unshift(0);x++<h;)w.push(0);do{for(f=0;f<10;f++){if(h!=(x=w.length))m=h>x?1:-1;else for(g=-1,m=0;++g<h;)if(s[g]!=w[g]){m=s[g]>w[g]?1:-1;break}if(!(m<0))break;for(d=x==h?s:v;x;){if(w[--x]<d[x]){for(g=x;g&&!w[--g];)w[g]=9;--w[g],w[x]+=10}w[x]-=d[x]}for(;!w[0];)w.shift()}C[A++]=m?f:++f,w[0]&&m?w[x]=r[y]||0:w=[r[y]]}while((y++<b||w[0]!==u)&&a--);return C[0]||1==A||(C.shift(),E.e--,S--),A>S&&p(E,S,n.RM,w[0]!==u),E},h.eq=function(e){return 0===this.cmp(e)},h.gt=function(e){return this.cmp(e)>0},h.gte=function(e){return this.cmp(e)>-1},h.lt=function(e){return this.cmp(e)<0},h.lte=function(e){return this.cmp(e)<1},h.minus=h.sub=function(e){var t,n,i,r,s=this,a=s.constructor,o=s.s,l=(e=new a(e)).s;if(o!=l)return e.s=-l,s.plus(e);var c=s.c.slice(),h=s.e,u=e.c,d=e.e;if(!c[0]||!u[0])return u[0]?e.s=-l:c[0]?e=new a(s):e.s=1,e;if(o=h-d){for((r=o<0)?(o=-o,i=c):(d=h,i=u),i.reverse(),l=o;l--;)i.push(0);i.reverse()}else for(n=((r=c.length<u.length)?c:u).length,o=l=0;l<n;l++)if(c[l]!=u[l]){r=c[l]<u[l];break}if(r&&(i=c,c=u,u=i,e.s=-e.s),(l=(n=u.length)-(t=c.length))>0)for(;l--;)c[t++]=0;for(l=t;n>o;){if(c[--n]<u[n]){for(t=n;t&&!c[--t];)c[t]=9;--c[t],c[n]+=10}c[n]-=u[n]}for(;0===c[--l];)c.pop();for(;0===c[0];)c.shift(),--d;return c[0]||(e.s=1,c=[d=0]),e.c=c,e.e=d,e},h.mod=function(e){var t,n=this,i=n.constructor,r=n.s,s=(e=new i(e)).s;if(!e.c[0])throw Error(c);return n.s=e.s=1,t=1==e.cmp(n),n.s=r,e.s=s,t?new i(n):(r=i.DP,s=i.RM,i.DP=i.RM=0,n=n.div(e),i.DP=r,i.RM=s,this.minus(n.times(e)))},h.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e},h.plus=h.add=function(e){var t,n,i,r=this,s=r.constructor;if(e=new s(e),r.s!=e.s)return e.s=-e.s,r.minus(e);var a=r.e,o=r.c,l=e.e,c=e.c;if(!o[0]||!c[0])return c[0]||(o[0]?e=new s(r):e.s=r.s),e;if(o=o.slice(),t=a-l){for(t>0?(l=a,i=c):(t=-t,i=o),i.reverse();t--;)i.push(0);i.reverse()}for(o.length-c.length<0&&(i=c,c=o,o=i),t=c.length,n=0;t;o[t]%=10)n=(o[--t]=o[t]+c[t]+n)/10|0;for(n&&(o.unshift(n),++l),t=o.length;0===o[--t];)o.pop();return e.c=o,e.e=l,e},h.pow=function(e){var t=this,n=new t.constructor("1"),i=n,s=e<0;if(e!==~~e||e<-1e6||e>r)throw Error(a+"exponent");for(s&&(e=-e);1&e&&(i=i.times(t)),e>>=1;)t=t.times(t);return s?n.div(i):i},h.prec=function(e,t){if(e!==~~e||e<1||e>i)throw Error(a+"precision");return p(new this.constructor(this),e,t)},h.round=function(e,t){if(e===u)e=0;else if(e!==~~e||e<-i||e>i)throw Error(o);return p(new this.constructor(this),e+this.e+1,t)},h.sqrt=function(){var e,t,n,i=this,r=i.constructor,a=i.s,o=i.e,l=new r("0.5");if(!i.c[0])return new r(i);if(a<0)throw Error(s+"No square root");0===(a=Math.sqrt(+f(i,!0,!0)))||a===1/0?((t=i.c.join("")).length+o&1||(t+="0"),o=((o+1)/2|0)-(o<0||1&o),e=new r(((a=Math.sqrt(t))==1/0?"5e":(a=a.toExponential()).slice(0,a.indexOf("e")+1))+o)):e=new r(a+""),o=e.e+(r.DP+=4);do{n=e,e=l.times(n.plus(i.div(n)))}while(n.c.slice(0,o).join("")!==e.c.slice(0,o).join(""));return p(e,(r.DP-=4)+e.e+1,r.RM)},h.times=h.mul=function(e){var t,n=this,i=n.constructor,r=n.c,s=(e=new i(e)).c,a=r.length,o=s.length,l=n.e,c=e.e;if(e.s=n.s==e.s?1:-1,!r[0]||!s[0])return e.c=[e.e=0],e;for(e.e=l+c,a<o&&(t=r,r=s,s=t,c=a,a=o,o=c),t=new Array(c=a+o);c--;)t[c]=0;for(l=o;l--;){for(o=0,c=a+l;c>l;)o=t[c]+s[l]*r[c-l-1]+o,t[c--]=o%10,o=o/10|0;t[c]=o}for(o?++e.e:t.shift(),l=t.length;!t[--l];)t.pop();return e.c=t,e},h.toExponential=function(e,t){var n=this,r=n.c[0];if(e!==u){if(e!==~~e||e<0||e>i)throw Error(o);for(n=p(new n.constructor(n),++e,t);n.c.length<e;)n.c.push(0)}return f(n,!0,!!r)},h.toFixed=function(e,t){var n=this,r=n.c[0];if(e!==u){if(e!==~~e||e<0||e>i)throw Error(o);for(e=e+(n=p(new n.constructor(n),e+n.e+1,t)).e+1;n.c.length<e;)n.c.push(0)}return f(n,!1,!!r)},h[Symbol.for("nodejs.util.inspect.custom")]=h.toJSON=h.toString=function(){var e=this,t=e.constructor;return f(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},h.toNumber=function(){var e=+f(this,!0,!0);if(!0===this.constructor.strict&&!this.eq(e.toString()))throw Error(s+"Imprecise conversion");return e},h.toPrecision=function(e,t){var n=this,r=n.constructor,s=n.c[0];if(e!==u){if(e!==~~e||e<1||e>i)throw Error(a+"precision");for(n=p(new r(n),e,t);n.c.length<e;)n.c.push(0)}return f(n,e<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)},h.valueOf=function(){var e=this,t=e.constructor;if(!0===t.strict)throw Error(s+"valueOf disallowed");return f(e,e.e<=t.NE||e.e>=t.PE,!0)};var m=function e(){function t(n){var i=this;if(!(i instanceof t))return n===u?e():new t(n);if(n instanceof t)i.s=n.s,i.e=n.e,i.c=n.c.slice();else{if("string"!==typeof n){if(!0===t.strict&&"bigint"!==typeof n)throw TypeError(a+"value");n=0===n&&1/n<0?"-0":String(n)}!function(e,t){var n,i,r;if(!d.test(t))throw Error(a+"number");e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(n=t.indexOf("."))>-1&&(t=t.replace(".",""));(i=t.search(/e/i))>0?(n<0&&(n=i),n+=+t.slice(i+1),t=t.substring(0,i)):n<0&&(n=t.length);for(r=t.length,i=0;i<r&&"0"==t.charAt(i);)++i;if(i==r)e.c=[e.e=0];else{for(;r>0&&"0"==t.charAt(--r););for(e.e=n-i-1,e.c=[],n=0;i<=r;)e.c[n++]=+t.charAt(i++)}}(i,n)}i.constructor=t}return t.prototype=h,t.DP=20,t.RM=1,t.NE=-7,t.PE=21,t.strict=false,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}();const g=m,v={bigNumber:e=>new g(e||0),multiply(e,t){if(void 0===e||void 0===t)return new g(0);const n=new g(e),i=new g(t);return n.times(i)},formatNumberToLocalString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return void 0===e?"0.00":"number"===typeof e?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t})},parseLocalStringToNumber:e=>void 0===e?0:parseFloat(e.replace(/,/gu,""))}},568:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromMiliseconds=t.toMiliseconds=void 0;const i=n(48251);t.toMiliseconds=function(e){return e*i.ONE_THOUSAND},t.fromMiliseconds=function(e){return Math.floor(e/i.ONE_THOUSAND)}},595:(e,t,n)=>{"use strict";n.d(t,{U:()=>h});var i=n(38993),r=n(84657),s=n(24657),a=n(65618),o=n(15814),l=n(7258);const c=(0,i.BX)({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[]}),h={state:c,replaceState(e){e&&Object.assign(c,(0,i.KR)(e))},subscribe:e=>o.W.subscribeChainProp("accountState",(t=>{if(t)return e(t)})),subscribeKey(e,t,n){let i;return o.W.subscribeChainProp("accountState",(n=>{if(n){const r=n[e];i!==r&&(i=r,t(r))}}),n)},setStatus(e,t){o.W.setAccountProp("status",e,t)},getCaipAddress:e=>o.W.getAccountProp("caipAddress",e),setCaipAddress(e,t){const n=e?s.w.getPlainAddress(e):void 0;t===o.W.state.activeChain&&(o.W.state.activeCaipAddress=e),o.W.setAccountProp("caipAddress",e,t),o.W.setAccountProp("address",n,t)},setBalance(e,t,n){o.W.setAccountProp("balance",e,n),o.W.setAccountProp("balanceSymbol",t,n)},setProfileName(e,t){o.W.setAccountProp("profileName",e,t)},setProfileImage(e,t){o.W.setAccountProp("profileImage",e,t)},setUser(e,t){o.W.setAccountProp("user",e,t)},setAddressExplorerUrl(e,t){o.W.setAccountProp("addressExplorerUrl",e,t)},setSmartAccountDeployed(e,t){o.W.setAccountProp("smartAccountDeployed",e,t)},setCurrentTab(e){o.W.setAccountProp("currentTab",e,o.W.state.activeChain)},setTokenBalance(e,t){e&&o.W.setAccountProp("tokenBalance",e,t)},setShouldUpdateToAddress(e,t){o.W.setAccountProp("shouldUpdateToAddress",e,t)},setAllAccounts(e,t){o.W.setAccountProp("allAccounts",e,t)},addAddressLabel(e,t,n){const i=o.W.getAccountProp("addressLabels",n)||new Map;i.set(e,t),o.W.setAccountProp("addressLabels",i,n)},removeAddressLabel(e,t){const n=o.W.getAccountProp("addressLabels",t)||new Map;n.delete(e),o.W.setAccountProp("addressLabels",n,t)},setConnectedWalletInfo(e,t){o.W.setAccountProp("connectedWalletInfo",e,t,!1)},setPreferredAccountType(e,t){o.W.setAccountProp("preferredAccountTypes",{...c.preferredAccountTypes,[t]:e},t)},setPreferredAccountTypes(e){c.preferredAccountTypes=e},setSocialProvider(e,t){e&&o.W.setAccountProp("socialProvider",e,t)},setSocialWindow(e,t){o.W.setAccountProp("socialWindow",e?(0,i.KR)(e):void 0,t)},setFarcasterUrl(e,t){o.W.setAccountProp("farcasterUrl",e,t)},async fetchTokenBalance(e){c.balanceLoading=!0;const t=o.W.state.activeCaipNetwork?.caipNetworkId,n=o.W.state.activeCaipNetwork?.chainNamespace,i=o.W.state.activeCaipAddress,h=i?s.w.getPlainAddress(i):void 0;if(c.lastRetry&&!s.w.isAllowedRetry(c.lastRetry,30*r.oU.ONE_SEC_MS))return c.balanceLoading=!1,[];try{if(h&&t&&n){const e=(await a.T.getBalance(h,t)).balances.filter((e=>"0"!==e.quantity.decimals));return this.setTokenBalance(e,n),c.lastRetry=void 0,c.balanceLoading=!1,e}}catch(u){c.lastRetry=Date.now(),e?.(u),l.P.showError("Token Balance Unavailable")}finally{c.balanceLoading=!1}return[]},resetAccount(e){o.W.resetAccount(e)}}},1067:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(56121).__exportStar(n(40656),t)},1273:(e,t,n)=>{"use strict";n.d(t,{c:()=>s});var i=n(69611),r=n(10306);function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"wei";return(0,r.J)(e,i.eL[t])}},1348:(e,t,n)=>{"use strict";n.d(t,{$:()=>l});var i=n(38993),r=n(16496),s=n(36596);const a={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00"},o=(0,i.BX)({networkImagePromises:{}}),l={async fetchWalletImage(e){if(e)return await r.N._fetchWalletImage(e),this.getWalletImageById(e)},async fetchNetworkImage(e){if(!e)return;const t=this.getNetworkImageById(e);return t||(o.networkImagePromises[e]||(o.networkImagePromises[e]=r.N._fetchNetworkImage(e)),await o.networkImagePromises[e],this.getNetworkImageById(e))},getWalletImageById(e){if(e)return s.j.state.walletImages[e]},getWalletImage:e=>e?.image_url?e?.image_url:e?.image_id?s.j.state.walletImages[e.image_id]:void 0,getNetworkImage:e=>e?.assets?.imageUrl?e?.assets?.imageUrl:e?.assets?.imageId?s.j.state.networkImages[e.assets.imageId]:void 0,getNetworkImageById(e){if(e)return s.j.state.networkImages[e]},getConnectorImage:e=>e?.imageUrl?e.imageUrl:e?.imageId?s.j.state.connectorImages[e.imageId]:void 0,getChainImage:e=>s.j.state.networkImages[a[e]]}},2283:(e,t,n)=>{"use strict";n.d(t,{iY:()=>l});var i=n(97965),r=n(31499),s=n(74074),a=n(30284),o=n(73924);function l(e){const{abi:t,args:n=[],name:s}=e,l=(0,r.q)(s,{strict:!1}),u=t.filter((e=>l?"function"===e.type?(0,o.V)(e)===s:"event"===e.type&&(0,a.h)(e)===s:"name"in e&&e.name===s));if(0===u.length)return;if(1===u.length)return u[0];let d;for(const r of u){if(!("inputs"in r))continue;if(!n||0===n.length){if(!r.inputs||0===r.inputs.length)return r;continue}if(!r.inputs)continue;if(0===r.inputs.length)continue;if(r.inputs.length!==n.length)continue;if(n.every(((e,t)=>{const n="inputs"in r&&r.inputs[t];return!!n&&c(e,n)}))){if(d&&"inputs"in d&&d.inputs){const e=h(r.inputs,d.inputs,n);if(e)throw new i.nM({abiItem:r,type:e[0]},{abiItem:d,type:e[1]})}d=r}}return d||u[0]}function c(e,t){const n=typeof e,i=t.type;switch(i){case"address":return(0,s.P)(e,{strict:!1});case"bool":return"boolean"===n;case"function":case"string":return"string"===n;default:return"tuple"===i&&"components"in t?Object.values(t.components).every(((t,n)=>c(Object.values(e)[n],t))):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(i)?"number"===n||"bigint"===n:/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(i)?"string"===n||e instanceof Uint8Array:!!/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(i)&&(Array.isArray(e)&&e.every((e=>c(e,{...t,type:i.replace(/(\[[0-9]{0,}\])$/,"")}))))}}function h(e,t,n){for(const i in e){const r=e[i],a=t[i];if("tuple"===r.type&&"tuple"===a.type&&"components"in r&&"components"in a)return h(r.components,a.components,n[i]);const o=[r.type,a.type];if(!(!o.includes("address")||!o.includes("bytes20"))||(o.includes("address")&&o.includes("string")||!(!o.includes("address")||!o.includes("bytes")))&&(0,s.P)(n[i],{strict:!1}))return o}}},3458:(e,t,n)=>{"use strict";n.d(t,{Ty:()=>r,u:()=>a,xO:()=>s});var i=n(21627);class r extends i.C{constructor(e){let{max:t,min:n,signed:i,size:r,value:s}=e;super(`Number "${s}" is not in safe ${r?`${8*r}-bit ${i?"signed":"unsigned"} `:""}integer range ${t?`(${n} to ${t})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class s extends i.C{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}}i.C;i.C;class a extends i.C{constructor(e){let{givenSize:t,maxSize:n}=e;super(`Size cannot exceed ${n} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}}},3491:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});var i=n(21627);class r extends i.C{constructor(e){let{address:t}=e;super(`Address "${t}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}},4498:(e,t,n)=>{"use strict";function i(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function r(e){if(!((t=e)instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name))throw new Error("Uint8Array expected");for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];if(i.length>0&&!i.includes(e.length))throw new Error("Uint8Array expected of length "+i+", got length="+e.length)}function s(e){if("function"!==typeof e||"function"!==typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");i(e.outputLen),i(e.blockLen)}function a(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function o(e,t){r(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}n.d(t,{CC:()=>a,DO:()=>r,Fe:()=>i,Ht:()=>o,sd:()=>s})},4569:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s});var i=n(69611),r=n(10306);function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"wei";return(0,r.J)(e,i.sz[t])}},5896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var o=2*(i+1)-1,l=e[o],c=o+1,h=e[c];if(0>s(l,n))c<r&&0>s(h,l)?(e[i]=h,e[c]=n,i=c):(e[i]=l,e[o]=n,i=o);else{if(!(c<r&&0>s(h,n)))break e;e[i]=h,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],h=[],u=1,d=null,p=3,f=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=i(h);null!==t;){if(null===t.callback)r(h);else{if(!(t.startTime<=e))break;r(h),t.sortIndex=t.expirationTime,n(c,t)}t=i(h)}}function E(e){if(g=!1,x(e),!m)if(null!==i(c))m=!0,A||(A=!0,C());else{var t=i(h);null!==t&&O(E,t.startTime-e)}}var C,A=!1,S=-1,_=5,T=-1;function P(){return!!v||!(t.unstable_now()-T<_)}function M(){if(v=!1,A){var e=t.unstable_now();T=e;var n=!0;try{e:{m=!1,g&&(g=!1,b(S),S=-1),f=!0;var s=p;try{t:{for(x(e),d=i(c);null!==d&&!(d.expirationTime>e&&P());){var a=d.callback;if("function"===typeof a){d.callback=null,p=d.priorityLevel;var o=a(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){d.callback=o,x(e),n=!0;break t}d===i(c)&&r(c),x(e)}else r(c);d=i(c)}if(null!==d)n=!0;else{var l=i(h);null!==l&&O(E,l.startTime-e),n=!1}}break e}finally{d=null,p=s,f=!1}n=void 0}}finally{n?C():A=!1}}}if("function"===typeof w)C=function(){w(M)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,I=N.port2;N.port1.onmessage=M,C=function(){I.postMessage(null)}}else C=function(){y(M,0)};function O(e,n){S=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(h,e),null===i(c)&&e===i(h)&&(g?(b(S),S=-1):g=!0,O(E,s-a))):(e.sortIndex=o,n(c,e),m||f||(m=!0,A||(A=!0,C()))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},6177:(e,t,n)=>{var i="undefined"!==typeof globalThis&&globalThis||"undefined"!==typeof self&&self||"undefined"!==typeof n.g&&n.g,r=function(){function e(){this.fetch=!1,this.DOMException=i.DOMException}return e.prototype=i,new e}();!function(e){!function(t){var i="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||"undefined"!==typeof n.g&&n.g||{},r="URLSearchParams"in i,s="Symbol"in i&&"iterator"in Symbol,a="FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in i,l="ArrayBuffer"in i;if(l)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function d(e){return"string"!==typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return s&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function m(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function g(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function v(e){var t=new FileReader,n=g(t);return t.readAsArrayBuffer(e),n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"===typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():l&&a&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l&&(ArrayBuffer.prototype.isPrototypeOf(e)||h(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=m(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=m(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(a)return this.blob().then(v);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e=m(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=g(t),i=/charset=([A-Za-z0-9_-]+)/.exec(e.type),r=i?i[1]:"utf-8";return t.readAsText(e,r),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),i=0;i<t.length;i++)n[i]=String.fromCharCode(t[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=u(e),t=d(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},f.prototype.delete=function(e){delete this.map[u(e)]},f.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},f.prototype.set=function(e,t){this.map[u(e)]=d(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),p(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),p(e)},s&&(f.prototype[Symbol.iterator]=f.prototype.entries);var w=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function x(e,t){if(!(this instanceof x))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n=(t=t||{}).body;if(e instanceof x){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=function(e){var t=e.toUpperCase();return w.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in i)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),("GET"===this.method||"HEAD"===this.method)&&("no-store"===t.cache||"no-cache"===t.cache)){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function E(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(r))}})),t}function C(e){var t=new f;return e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();try{t.append(i,r)}catch(s){console.warn("Response "+s.message)}}})),t}function A(e,t){if(!(this instanceof A))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}x.prototype.clone=function(){return new x(this,{body:this._bodyInit})},b.call(x.prototype),b.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},A.error=function(){var e=new A(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var S=[301,302,303,307,308];A.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new A(null,{status:t,headers:{location:e}})},t.DOMException=i.DOMException;try{new t.DOMException}catch(T){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function _(e,n){return new Promise((function(r,s){var o=new x(e,n);if(o.signal&&o.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var c=new XMLHttpRequest;function h(){c.abort()}if(c.onload=function(){var e={statusText:c.statusText,headers:C(c.getAllResponseHeaders()||"")};0===o.url.indexOf("file://")&&(c.status<200||c.status>599)?e.status=200:e.status=c.status,e.url="responseURL"in c?c.responseURL:e.headers.get("X-Request-URL");var t="response"in c?c.response:c.responseText;setTimeout((function(){r(new A(t,e))}),0)},c.onerror=function(){setTimeout((function(){s(new TypeError("Network request failed"))}),0)},c.ontimeout=function(){setTimeout((function(){s(new TypeError("Network request timed out"))}),0)},c.onabort=function(){setTimeout((function(){s(new t.DOMException("Aborted","AbortError"))}),0)},c.open(o.method,function(e){try{return""===e&&i.location.href?i.location.href:e}catch(t){return e}}(o.url),!0),"include"===o.credentials?c.withCredentials=!0:"omit"===o.credentials&&(c.withCredentials=!1),"responseType"in c&&(a?c.responseType="blob":l&&(c.responseType="arraybuffer")),n&&"object"===typeof n.headers&&!(n.headers instanceof f||i.Headers&&n.headers instanceof i.Headers)){var p=[];Object.getOwnPropertyNames(n.headers).forEach((function(e){p.push(u(e)),c.setRequestHeader(e,d(n.headers[e]))})),o.headers.forEach((function(e,t){-1===p.indexOf(t)&&c.setRequestHeader(t,e)}))}else o.headers.forEach((function(e,t){c.setRequestHeader(t,e)}));o.signal&&(o.signal.addEventListener("abort",h),c.onreadystatechange=function(){4===c.readyState&&o.signal.removeEventListener("abort",h)}),c.send("undefined"===typeof o._bodyInit?null:o._bodyInit)}))}_.polyfill=!0,i.fetch||(i.fetch=_,i.Headers=f,i.Request=x,i.Response=A),t.Headers=f,t.Request=x,t.Response=A,t.fetch=_,Object.defineProperty(t,"__esModule",{value:!0})}({})}(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=i.fetch?i:r;(t=s.fetch).default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t},6310:(e,t,n)=>{"use strict";n.d(t,{EH:()=>s,YE:()=>o,jF:()=>a,rj:()=>r});var i=n(21627);class r extends i.C{constructor(e){let{blockNumber:t,chain:n,contract:i}=e;super(`Chain "${n.name}" does not support contract "${i.name}".`,{metaMessages:["This could be due to any of the following:",...t&&i.blockCreated&&i.blockCreated>t?[`- The contract "${i.name}" was not deployed until block ${i.blockCreated} (current block ${t}).`]:[`- The chain does not have the contract "${i.name}" configured.`]],name:"ChainDoesNotSupportContract"})}}class s extends i.C{constructor(e){let{chain:t,currentChainId:n}=e;super(`The current chain of the wallet (id: ${n}) does not match the target chain for the transaction (id: ${t.id} \u2013 ${t.name}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${t.id} \u2013 ${t.name}`],name:"ChainMismatchError"})}}class a extends i.C{constructor(){super(["No chain was provided to the request.","Please provide a chain with the `chain` argument on the Action, or by supplying a `chain` to WalletClient."].join("\n"),{name:"ChainNotFoundError"})}}class o extends i.C{constructor(){super("No chain was provided to the Client.",{name:"ClientChainNotConfiguredError"})}}i.C},6812:(e,t,n)=>{"use strict";n.d(t,{Bv:()=>s});var i=n(84117);const r={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"};function s(e){const t={};return"undefined"!==typeof e.authorizationList&&(t.authorizationList=e.authorizationList.map((e=>({address:e.address,r:e.r?(0,i.cK)(BigInt(e.r)):e.r,s:e.s?(0,i.cK)(BigInt(e.s)):e.s,chainId:(0,i.cK)(e.chainId),nonce:(0,i.cK)(e.nonce),..."undefined"!==typeof e.yParity?{yParity:(0,i.cK)(e.yParity)}:{},..."undefined"!==typeof e.v&&"undefined"===typeof e.yParity?{v:(0,i.cK)(e.v)}:{}})))),"undefined"!==typeof e.accessList&&(t.accessList=e.accessList),"undefined"!==typeof e.blobVersionedHashes&&(t.blobVersionedHashes=e.blobVersionedHashes),"undefined"!==typeof e.blobs&&("string"!==typeof e.blobs[0]?t.blobs=e.blobs.map((e=>(0,i.My)(e))):t.blobs=e.blobs),"undefined"!==typeof e.data&&(t.data=e.data),"undefined"!==typeof e.from&&(t.from=e.from),"undefined"!==typeof e.gas&&(t.gas=(0,i.cK)(e.gas)),"undefined"!==typeof e.gasPrice&&(t.gasPrice=(0,i.cK)(e.gasPrice)),"undefined"!==typeof e.maxFeePerBlobGas&&(t.maxFeePerBlobGas=(0,i.cK)(e.maxFeePerBlobGas)),"undefined"!==typeof e.maxFeePerGas&&(t.maxFeePerGas=(0,i.cK)(e.maxFeePerGas)),"undefined"!==typeof e.maxPriorityFeePerGas&&(t.maxPriorityFeePerGas=(0,i.cK)(e.maxPriorityFeePerGas)),"undefined"!==typeof e.nonce&&(t.nonce=(0,i.cK)(e.nonce)),"undefined"!==typeof e.to&&(t.to=e.to),"undefined"!==typeof e.type&&(t.type=r[e.type]),"undefined"!==typeof e.value&&(t.value=(0,i.cK)(e.value)),t}},6816:(e,t,n)=>{"use strict";n.d(t,{h:()=>s});var i=n(3491),r=n(74074);function s(e,t){if(!(0,r.P)(e,{strict:!1}))throw new i.M({address:e});if(!(0,r.P)(t,{strict:!1}))throw new i.M({address:t});return e.toLowerCase()===t.toLowerCase()}},7258:(e,t,n)=>{"use strict";n.d(t,{P:()=>l});var i=n(38993),r=n(76844),s=n(24657);const a=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),o=(0,i.BX)({...a}),l={state:o,subscribeKey:(e,t)=>(0,r.u$)(o,e,t),showLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._showMessage({message:e,variant:"loading",...t})},showSuccess(e){this._showMessage({message:e,variant:"success"})},showSvg(e,t){this._showMessage({message:e,svg:t})},showError(e){const t=s.w.parseError(e);this._showMessage({message:t,variant:"error"})},hide(){o.message=a.message,o.variant=a.variant,o.svg=a.svg,o.open=a.open,o.autoClose=a.autoClose},_showMessage(e){let{message:t,svg:n,variant:i="success",autoClose:r=a.autoClose}=e;o.open?(o.open=!1,setTimeout((()=>{o.message=t,o.variant=i,o.svg=n,o.open=!0,o.autoClose=r}),150)):(o.message=t,o.variant=i,o.svg=n,o.open=!0,o.autoClose=r)}}},8092:function(e){e.exports=function(){"use strict";return function(e,t,n){e=e||{};var i=t.prototype,r={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function s(e,t,n,r){return i.fromToBase(e,t,n,r)}n.en.relativeTime=r,i.fromToBase=function(t,i,s,a,o){for(var l,c,h,u=s.$locale().relativeTime||r,d=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],p=d.length,f=0;f<p;f+=1){var m=d[f];m.d&&(l=a?n(t).diff(s,m.d,!0):s.diff(t,m.d,!0));var g=(e.rounding||Math.round)(Math.abs(l));if(h=l>0,g<=m.r||!m.r){g<=1&&f>0&&(m=d[f-1]);var v=u[m.l];o&&(g=o(""+g)),c="string"==typeof v?v.replace("%d",g):v(g,i,m.l,h);break}}if(i)return c;var y=h?u.future:u.past;return"function"==typeof y?y(c):y.replace("%s",c)},i.to=function(e,t){return s(e,t,this,!0)},i.from=function(e,t){return s(e,t,this)};var a=function(e){return e.$u?n.utc():n()};i.toNow=function(e){return this.to(a(this),e)},i.fromNow=function(e){return this.from(a(this),e)}}}()},8129:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(46613);i.__exportStar(n(10364),t),i.__exportStar(n(96454),t)},8951:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_THOUSAND=t.ONE_HUNDRED=void 0,t.ONE_HUNDRED=100,t.ONE_THOUSAND=1e3},10306:(e,t,n)=>{"use strict";function i(e,t){let n=e.toString();const i=n.startsWith("-");i&&(n=n.slice(1)),n=n.padStart(t,"0");let[r,s]=[n.slice(0,n.length-t),n.slice(n.length-t)];return s=s.replace(/(0+)$/,""),`${i?"-":""}${r||"0"}${s?`.${s}`:""}`}n.d(t,{J:()=>i})},10364:(e,t,n)=>{"use strict";function i(){return(null===n.g||void 0===n.g?void 0:n.g.crypto)||(null===n.g||void 0===n.g?void 0:n.g.msCrypto)||{}}function r(){const e=i();return e.subtle||e.webkitSubtle}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=i,t.getSubtleCrypto=r,t.isBrowserCryptoAvailable=function(){return!!i()&&!!r()}},10446:(e,t,n)=>{var i=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt,l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,c="object"==typeof self&&self&&self.Object===Object&&self,h=l||c||Function("return this")(),u=Object.prototype.toString,d=Math.max,p=Math.min,f=function(){return h.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=s.test(e);return n||a.test(e)?o(e.slice(2),n?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,n){var i,r,s,a,o,l,c=0,h=!1,u=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=i,s=r;return i=r=void 0,c=t,a=e.apply(s,n)}function b(e){var n=e-l;return void 0===l||n>=t||n<0||u&&e-c>=s}function w(){var e=f();if(b(e))return x(e);o=setTimeout(w,function(e){var n=t-(e-l);return u?p(n,s-(e-c)):n}(e))}function x(e){return o=void 0,v&&i?y(e):(i=r=void 0,a)}function E(){var e=f(),n=b(e);if(i=arguments,r=this,l=e,n){if(void 0===o)return function(e){return c=e,o=setTimeout(w,t),h?y(e):a}(l);if(u)return o=setTimeout(w,t),y(l)}return void 0===o&&(o=setTimeout(w,t)),a}return t=g(t)||0,m(n)&&(h=!!n.leading,s=(u="maxWait"in n)?d(g(n.maxWait)||0,t):s,v="trailing"in n?!!n.trailing:v),E.cancel=function(){void 0!==o&&clearTimeout(o),c=0,i=l=r=o=void 0},E.flush=function(){return void 0===o?a:x(f())},E}},12343:(e,t,n)=>{"use strict";n.d(t,{A7:()=>s,BG:()=>a,Fo:()=>p,K0:()=>l,Oh:()=>c,RM:()=>g,jj:()=>o,k5:()=>u,lN:()=>m,lY:()=>d,uC:()=>f,vW:()=>h});var i=n(4569),r=n(21627);class s extends r.C{constructor(){let{cause:e,message:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${n?`with reason: ${n}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(s,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(s,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class a extends r.C{constructor(){let{cause:e,maxFeePerGas:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(`The fee cap (\`maxFeePerGas\`${t?` = ${(0,i.Q)(t)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(a,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class o extends r.C{constructor(){let{cause:e,maxFeePerGas:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(`The fee cap (\`maxFeePerGas\`${t?` = ${(0,i.Q)(t)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(o,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class l extends r.C{constructor(){let{cause:e,nonce:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(`Nonce provided for the transaction ${t?`(${t}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(l,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class c extends r.C{constructor(){let{cause:e,nonce:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super([`Nonce provided for the transaction ${t?`(${t}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join("\n"),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(c,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class h extends r.C{constructor(){let{cause:e,nonce:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(`Nonce provided for the transaction ${t?`(${t}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(h,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class u extends r.C{constructor(){let{cause:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join("\n"),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(u,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class d extends r.C{constructor(){let{cause:e,gas:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(d,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class p extends r.C{constructor(){let{cause:e,gas:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(p,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class f extends r.C{constructor(e){let{cause:t}=e;super("The transaction type is not supported for this chain.",{cause:t,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(f,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class m extends r.C{constructor(){let{cause:e,maxPriorityFeePerGas:t,maxFeePerGas:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super([`The provided tip (\`maxPriorityFeePerGas\`${t?` = ${(0,i.Q)(t)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${n?` = ${(0,i.Q)(n)} gwei`:""}).`].join("\n"),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(m,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class g extends r.C{constructor(e){let{cause:t}=e;super(`An error occurred while executing: ${t?.shortMessage}`,{cause:t,name:"UnknownNodeError"})}}},13237:(e,t,n)=>{"use strict";n.d(t,{U:()=>m});n(62983);var i=n(80883),r=n(59979),s=n(595),a=n(15814),o=n(93022),l=n(73939),c=n(79323),h=n(73609),u=n(42661),d=n(61139),p=n(7258),f=n(24657);const m={getSIWX:()=>u.H.state.siwx,async initializeIfEnabled(){const e=u.H.state.siwx,t=a.W.getActiveCaipAddress();if(!e||!t)return;const[n,i,r]=t.split(":");if(a.W.checkIfSupportedNetwork(n))try{if((await e.getSessions(`${n}:${i}`,r)).length)return;await h.W.open({view:"SIWXSignMessage"})}catch(s){console.error("SIWXUtil:initializeIfEnabled",s),c.E.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await(o.x._getClient()?.disconnect().catch(console.error)),d.I.reset("Connect"),p.P.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const e=u.H.state.siwx,t=f.w.getPlainAddress(a.W.getActiveCaipAddress()),n=a.W.getActiveCaipNetwork(),r=o.x._getClient();if(!e)throw new Error("SIWX is not enabled");if(!t)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const s=await e.createMessage({chainId:n.caipNetworkId,accountAddress:t}),a=s.toString();l.a.getConnectorId(n.chainNamespace)===i.o.CONNECTOR_ID.AUTH&&d.I.pushTransactionStack({view:null,goBack:!1,replace:!0});const o=await r.signMessage(a);await e.addSession({data:s,message:a,signature:o}),h.W.close(),c.E.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const e=this.getSIWXEventProperties();h.W.state.open&&"ApproveTransaction"!==d.I.state.view||await h.W.open({view:"SIWXSignMessage"}),e.isSmartAccount?p.P.showError("This application might not support Smart Accounts"):p.P.showError("Signature declined"),c.E.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:e}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){try{const e=this.getSIWX(),t=e?.getRequired?.();t?await o.x.disconnect():h.W.close(),d.I.reset("Connect"),c.E.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getSessions(){const e=u.H.state.siwx,t=f.w.getPlainAddress(a.W.getActiveCaipAddress()),n=a.W.getActiveCaipNetwork();return e&&t&&n?e.getSessions(n.caipNetworkId,t):[]},async isSIWXCloseDisabled(){const e=this.getSIWX();if(e){const t="ApproveTransaction"===d.I.state.view,n="SIWXSignMessage"===d.I.state.view;if(t||n)return e.getRequired?.()&&0===(await this.getSessions()).length}return!1},async universalProviderAuthenticate(e){let{universalProvider:t,chains:n,methods:i}=e;const r=m.getSIWX(),o=new Set(n.map((e=>e.split(":")[0])));if(!r||1!==o.size||!o.has("eip155"))return!1;const l=await r.createMessage({chainId:a.W.getActiveCaipNetwork()?.caipNetworkId||"",accountAddress:""}),h=await t.authenticate({nonce:l.nonce,domain:l.domain,uri:l.uri,exp:l.expirationTime,iat:l.issuedAt,nbf:l.notBefore,requestId:l.requestId,version:l.version,resources:l.resources,statement:l.statement,chainId:l.chainId,methods:i,chains:[l.chainId,...n.filter((e=>e!==l.chainId))]});if(p.P.showLoading("Authenticating...",{autoClose:!1}),s.U.setConnectedWalletInfo({...h.session.peer.metadata,name:h.session.peer.metadata.name,icon:h.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"},Array.from(o)[0]),h?.auths?.length){const e=h.auths.map((e=>{const n=t.client.formatAuthMessage({request:e.p,iss:e.p.iss});return{data:{...e.p,accountAddress:e.p.iss.split(":").slice(-1).join(""),chainId:e.p.iss.split(":").slice(2,4).join(":"),uri:e.p.aud,version:e.p.version||l.version,expirationTime:e.p.exp,issuedAt:e.p.iat,notBefore:e.p.nbf},message:n,signature:e.s.s,cacao:e}}));try{await r.setSessions(e),c.E.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:m.getSIWXEventProperties()})}catch(u){throw console.error("SIWX:universalProviderAuth - failed to set sessions",u),c.E.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:m.getSIWXEventProperties()}),await t.disconnect().catch(console.error),u}finally{p.P.hide()}}return!0},getSIWXEventProperties(){const e=a.W.state.activeChain;return{network:a.W.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:s.U.state.preferredAccountTypes?.[e]===r.Vl.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const e=this.getSIWX();e&&await e.setSessions([])}}},15814:(e,t,n)=>{"use strict";n.d(t,{W:()=>C});var i=n(38993),r=n(76844),s=n(99632),a=n(80883),o=n(73939);function l(e,t){return o.a.getConnectorId(e)===t}var c=n(84657),h=n(24657),u=n(88861),d=n(595),p=n(93022),f=n(79323),m=n(73609),g=n(42661),v=n(44098),y=n(61139),b=n(71636);const w={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[],user:void 0},x={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},E=(0,i.BX)({chains:(0,r.zC)(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),C={state:E,subscribe:e=>(0,i.B1)(E,(()=>{e(E)})),subscribeKey:(e,t)=>(0,r.u$)(E,e,t),subscribeChainProp(e,t,n){let r;return(0,i.B1)(E.chains,(()=>{const i=n||E.activeChain;if(i){const n=E.chains.get(i)?.[e];r!==n&&(r=n,t(n))}}))},initialize(e,t,n){const{chainId:r,namespace:s}=u.i.getActiveNetworkProps(),a=t?.find((e=>e.id.toString()===r?.toString())),o=e.find((e=>e?.namespace===s))||e?.[0],l=new Set([...t?.map((e=>e.chainNamespace))??[]]);0!==e?.length&&o||(E.noAdapters=!0),E.noAdapters||(E.activeChain=o?.namespace,E.activeCaipNetwork=a,this.setChainNetworkData(o?.namespace,{caipNetwork:a}),E.activeChain&&v.z.set({activeChain:o?.namespace})),l.forEach((e=>{const r=t?.filter((t=>t.chainNamespace===e));C.state.chains.set(e,{namespace:e,networkState:(0,i.BX)({...x,caipNetwork:r?.[0]}),accountState:(0,i.BX)(w),caipNetworks:r??[],...n}),this.setRequestedCaipNetworks(r??[],e)}))},removeAdapter(e){if(E.activeChain===e){const t=Array.from(E.chains.entries()).find((t=>{let[n]=t;return n!==e}));if(t){const e=t[1]?.caipNetworks?.[0];e&&this.setActiveCaipNetwork(e)}}E.chains.delete(e)},addAdapter(e,t,n){let{networkControllerClient:i,connectionControllerClient:r}=t;E.chains.set(e.namespace,{namespace:e.namespace,networkState:{...x,caipNetwork:n[0]},accountState:w,caipNetworks:n,connectionControllerClient:r,networkControllerClient:i}),this.setRequestedCaipNetworks(n?.filter((t=>t.chainNamespace===e.namespace))??[],e.namespace)},addNetwork(e){const t=E.chains.get(e.chainNamespace);if(t){const n=[...t.caipNetworks||[]];t.caipNetworks?.find((t=>t.id===e.id))||n.push(e),E.chains.set(e.chainNamespace,{...t,caipNetworks:n}),this.setRequestedCaipNetworks(n,e.chainNamespace)}},removeNetwork(e,t){const n=E.chains.get(e);if(n){const i=E.activeCaipNetwork?.id===t,r=[...n.caipNetworks?.filter((e=>e.id!==t))||[]];i&&n?.caipNetworks?.[0]&&this.setActiveCaipNetwork(n.caipNetworks[0]),E.chains.set(e,{...n,caipNetworks:r}),this.setRequestedCaipNetworks(r||[],e)}},setAdapterNetworkState(e,t){const n=E.chains.get(e);n&&(n.networkState={...n.networkState||x,...t},E.chains.set(e,n))},setChainAccountData(e,t){if(!e)throw new Error("Chain is required to update chain account data");const n=E.chains.get(e);if(n){const i={...n.accountState||w,...t};E.chains.set(e,{...n,accountState:i}),1!==E.chains.size&&E.activeChain!==e||(t.caipAddress&&(E.activeCaipAddress=t.caipAddress),d.U.replaceState(i))}},setChainNetworkData(e,t){if(!e)return;const n=E.chains.get(e);if(n){const i={...n.networkState||x,...t};E.chains.set(e,{...n,networkState:i})}},setAccountProp(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.setChainAccountData(n,{[e]:t},i),"status"===e&&"disconnected"===t&&n&&o.a.removeConnectorId(n)},setActiveNamespace(e){E.activeChain=e;const t=e?E.chains.get(e):void 0,n=t?.networkState?.caipNetwork;n?.id&&e&&(E.activeCaipAddress=t?.accountState?.caipAddress,E.activeCaipNetwork=n,this.setChainNetworkData(e,{caipNetwork:n}),u.i.setActiveCaipNetworkId(n?.caipNetworkId),v.z.set({activeChain:e,selectedNetworkId:n?.caipNetworkId}))},setActiveCaipNetwork(e){if(!e)return;E.activeChain!==e.chainNamespace&&this.setIsSwitchingNamespace(!0);const t=E.chains.get(e.chainNamespace);E.activeChain=e.chainNamespace,E.activeCaipNetwork=e,this.setChainNetworkData(e.chainNamespace,{caipNetwork:e}),E.activeCaipAddress=t?.accountState?.address?`${e.chainNamespace}:${e.id}:${t?.accountState?.address}`:void 0,this.setAccountProp("caipAddress",E.activeCaipAddress,e.chainNamespace),t&&d.U.replaceState(t.accountState),b.R.resetSend(),v.z.set({activeChain:E.activeChain,selectedNetworkId:E.activeCaipNetwork?.caipNetworkId}),u.i.setActiveCaipNetworkId(e.caipNetworkId);this.checkIfSupportedNetwork(e.chainNamespace)||!g.H.state.enableNetworkSwitch||g.H.state.allowUnsupportedChain||p.x.state.wcBasic||this.showUnsupportedChainUI()},addCaipNetwork(e){if(!e)return;const t=E.chains.get(e.chainNamespace);t&&t?.caipNetworks?.push(e)},async switchActiveNamespace(e){if(!e)return;const t=e!==C.state.activeChain,n=C.getNetworkData(e)?.caipNetwork,i=C.getCaipNetworkByNamespace(e,n?.id);t&&i&&await C.switchActiveNetwork(i)},async switchActiveNetwork(e){const t=C.state.chains.get(C.state.activeChain);!t?.caipNetworks?.some((e=>e.id===E.activeCaipNetwork?.id))&&y.I.goBack();const n=this.getNetworkControllerClient(e.chainNamespace);n&&(await n.switchCaipNetwork(e),f.E.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:e.caipNetworkId}}))},getNetworkControllerClient(e){const t=e||E.activeChain,n=E.chains.get(t);if(!n)throw new Error("Chain adapter not found");if(!n.networkControllerClient)throw new Error("NetworkController client not set");return n.networkControllerClient},getConnectionControllerClient(e){const t=e||E.activeChain;if(!t)throw new Error("Chain is required to get connection controller client");const n=E.chains.get(t);if(!n?.connectionControllerClient)throw new Error("ConnectionController client not set");return n.connectionControllerClient},getAccountProp(e,t){let n=E.activeChain;if(t&&(n=t),!n)return;const i=E.chains.get(n)?.accountState;return i?i[e]:void 0},getNetworkProp(e,t){const n=E.chains.get(t)?.networkState;if(n)return n[e]},getRequestedCaipNetworks(e){const t=E.chains.get(e),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:i=[]}=t?.networkState||{};return h.w.sortRequestedNetworks(n,i)},getAllRequestedCaipNetworks(){const e=[];return E.chains.forEach((t=>{const n=this.getRequestedCaipNetworks(t.namespace);e.push(...n)})),e},setRequestedCaipNetworks(e,t){this.setAdapterNetworkState(t,{requestedCaipNetworks:e})},getAllApprovedCaipNetworkIds(){const e=[];return E.chains.forEach((t=>{const n=this.getApprovedCaipNetworkIds(t.namespace);e.push(...n)})),e},getActiveCaipNetwork:()=>E.activeCaipNetwork,getActiveCaipAddress:()=>E.activeCaipAddress,getApprovedCaipNetworkIds(e){const t=E.chains.get(e);return t?.networkState?.approvedCaipNetworkIds||[]},async setApprovedCaipNetworksData(e){const t=this.getNetworkControllerClient(),n=await(t?.getApprovedCaipNetworksData());this.setAdapterNetworkState(e,{approvedCaipNetworkIds:n?.approvedCaipNetworkIds,supportsAllNetworks:n?.supportsAllNetworks})},checkIfSupportedNetwork(e,t){const n=t||E.activeCaipNetwork,i=this.getRequestedCaipNetworks(e);return!i.length||i?.some((e=>e.id===n?.id))},checkIfSupportedChainId(e){if(!E.activeChain)return!0;const t=this.getRequestedCaipNetworks(E.activeChain);return t?.some((t=>t.id===e))},setSmartAccountEnabledNetworks(e,t){this.setAdapterNetworkState(t,{smartAccountEnabledNetworks:e})},checkIfSmartAccountEnabled(){const e=s.L.caipNetworkIdToNumber(E.activeCaipNetwork?.caipNetworkId),t=E.activeChain;if(!t||!e)return!1;const n=this.getNetworkProp("smartAccountEnabledNetworks",t);return Boolean(n?.includes(Number(e)))},getActiveNetworkTokenAddress(){const e=E.activeCaipNetwork?.chainNamespace||"eip155";return`${e}:${E.activeCaipNetwork?.id||1}:${c.oU.NATIVE_TOKEN_ADDRESS[e]}`},showUnsupportedChainUI(){m.W.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const e=E.activeCaipNetwork;return Boolean(e?.chainNamespace&&c.oU.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(e.chainNamespace))},resetNetwork(e){this.setAdapterNetworkState(e,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]})},resetAccount(e){const t=e;if(!t)throw new Error("Chain is required to set account prop");E.activeCaipAddress=void 0,this.setChainAccountData(t,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountTypes:void 0,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,allAccounts:[],user:void 0,status:"disconnected"}),o.a.removeConnectorId(t)},async disconnect(e){const t=function(e){const t=Array.from(C.state.chains.keys());let n=[];return e?(n.push([e,C.state.chains.get(e)]),l(e,a.o.CONNECTOR_ID.WALLET_CONNECT)?t.forEach((t=>{t!==e&&l(t,a.o.CONNECTOR_ID.WALLET_CONNECT)&&n.push([t,C.state.chains.get(t)])})):l(e,a.o.CONNECTOR_ID.AUTH)&&t.forEach((t=>{t!==e&&l(t,a.o.CONNECTOR_ID.AUTH)&&n.push([t,C.state.chains.get(t)])}))):n=Array.from(C.state.chains.entries()),n}(e);try{b.R.resetSend();const n=await Promise.allSettled(t.map((async e=>{let[t,n]=e;try{const{caipAddress:e}=this.getAccountData(t)||{};e&&n.connectionControllerClient?.disconnect&&await n.connectionControllerClient.disconnect(t),this.resetAccount(t),this.resetNetwork(t)}catch(i){throw new Error(`Failed to disconnect chain ${t}: ${i.message}`)}})));p.x.resetWcConnection();const i=n.filter((e=>"rejected"===e.status));if(i.length>0)throw new Error(i.map((e=>e.reason.message)).join(", "));u.i.deleteConnectedSocialProvider(),e?o.a.removeConnectorId(e):o.a.resetConnectorIds(),f.E.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:e||"all"}})}catch(n){console.error(n.message||"Failed to disconnect chains"),f.E.sendEvent({type:"track",event:"DISCONNECT_ERROR",properties:{message:n.message||"Failed to disconnect chains"}})}},setIsSwitchingNamespace(e){E.isSwitchingNamespace=e},getFirstCaipNetworkSupportsAuthConnector(){const e=[];let t;if(E.chains.forEach((t=>{a.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.find((e=>e===t.namespace))&&t.namespace&&e.push(t.namespace)})),e.length>0){const n=e[0];return t=n?E.chains.get(n)?.caipNetworks?.[0]:void 0,t}},getAccountData:e=>e?C.state.chains.get(e)?.accountState:d.U.state,getNetworkData(e){const t=e||E.activeChain;if(t)return C.state.chains.get(t)?.networkState},getCaipNetworkByNamespace(e,t){if(!e)return;const n=C.state.chains.get(e),i=n?.caipNetworks?.find((e=>e.id===t));return i||(n?.networkState?.caipNetwork||n?.caipNetworks?.[0])},getRequestedCaipNetworkIds(){const e=o.a.state.filterByNamespace;return(e?[E.chains.get(e)]:Array.from(E.chains.values())).flatMap((e=>e?.caipNetworks||[])).map((e=>e.caipNetworkId))},getCaipNetworks:e=>e?C.getRequestedCaipNetworks(e):C.getAllRequestedCaipNetworks()}},15977:(e,t,n)=>{"use strict";n.d(t,{r:()=>i});const i="2.17.0"},16496:(e,t,n)=>{"use strict";n.d(t,{N:()=>y});var i=n(38993),r=n(76844),s=n(1348),a=n(24657),o=n(64564),l=n(88861),c=n(36596),h=n(15814),u=n(73939),d=n(79323),p=n(42661);const f=["1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79","fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa","a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393"],m=a.w.getApiUrl(),g=new o.Z({baseUrl:m,clientId:null}),v=(0,i.BX)({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),y={state:v,subscribeKey:(e,t)=>(0,r.u$)(v,e,t),_getSdkProperties(){const{projectId:e,sdkType:t,sdkVersion:n}=p.H.state;return{projectId:e,st:t||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions:e=>p.H.state.isUniversalProvider?e.filter((e=>Boolean(e.mobile_link||e.desktop_link||e.webapp_link))):e,async _fetchWalletImage(e){const t=`${g.baseUrl}/getWalletImage/${e}`,n=await g.getBlob({path:t,params:y._getSdkProperties()});c.j.setWalletImage(e,URL.createObjectURL(n))},async _fetchNetworkImage(e){const t=`${g.baseUrl}/public/getAssetImage/${e}`,n=await g.getBlob({path:t,params:y._getSdkProperties()});c.j.setNetworkImage(e,URL.createObjectURL(n))},async _fetchConnectorImage(e){const t=`${g.baseUrl}/public/getAssetImage/${e}`,n=await g.getBlob({path:t,params:y._getSdkProperties()});c.j.setConnectorImage(e,URL.createObjectURL(n))},async _fetchCurrencyImage(e){const t=`${g.baseUrl}/public/getCurrencyImage/${e}`,n=await g.getBlob({path:t,params:y._getSdkProperties()});c.j.setCurrencyImage(e,URL.createObjectURL(n))},async _fetchTokenImage(e){const t=`${g.baseUrl}/public/getTokenImage/${e}`,n=await g.getBlob({path:t,params:y._getSdkProperties()});c.j.setTokenImage(e,URL.createObjectURL(n))},async fetchNetworkImages(){const e=h.W.getAllRequestedCaipNetworks(),t=e?.map((e=>{let{assets:t}=e;return t?.imageId})).filter(Boolean).filter((e=>!s.$.getNetworkImageById(e)));t&&await Promise.allSettled(t.map((e=>y._fetchNetworkImage(e))))},async fetchConnectorImages(){const{connectors:e}=u.a.state,t=e.map((e=>{let{imageId:t}=e;return t})).filter(Boolean);await Promise.allSettled(t.map((e=>y._fetchConnectorImage(e))))},async fetchCurrencyImages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];await Promise.allSettled(e.map((e=>y._fetchCurrencyImage(e))))},async fetchTokenImages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];await Promise.allSettled(e.map((e=>y._fetchTokenImage(e))))},async fetchWallets(e){const t=e.exclude??[];return y._getSdkProperties().sv.startsWith("html-core-")&&t.push(...f),await g.get({path:"/getWallets",params:{...y._getSdkProperties(),...e,page:String(e.page),entries:String(e.entries),include:e.include?.join(","),exclude:e.exclude?.join(",")}})},async fetchFeaturedWallets(){const{featuredWalletIds:e}=p.H.state;if(e?.length){const t={...y._getSdkProperties(),page:1,entries:e?.length??4,include:e},{data:n}=await y.fetchWallets(t);n.sort(((t,n)=>e.indexOf(t.id)-e.indexOf(n.id)));const i=n.map((e=>e.image_id)).filter(Boolean);await Promise.allSettled(i.map((e=>y._fetchWalletImage(e)))),v.featured=n,v.allFeatured=n}},async fetchRecommendedWallets(){try{v.isFetchingRecommendedWallets=!0;const{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:n}=p.H.state,i=[...t??[],...n??[]].filter(Boolean),r={page:1,entries:4,include:e,exclude:i,chains:h.W.getRequestedCaipNetworkIds().join(",")},{data:s,count:a}=await y.fetchWallets(r),o=l.i.getRecentWallets(),c=s.map((e=>e.image_id)).filter(Boolean),u=o.map((e=>e.image_id)).filter(Boolean);await Promise.allSettled([...c,...u].map((e=>y._fetchWalletImage(e)))),v.recommended=s,v.allRecommended=s,v.count=a??0}catch{}finally{v.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage(e){let{page:t}=e;const{includeWalletIds:n,excludeWalletIds:i,featuredWalletIds:r}=p.H.state,s=h.W.getRequestedCaipNetworkIds().join(","),o={page:t,entries:40,include:n,exclude:[...v.recommended.map((e=>{let{id:t}=e;return t})),...i??[],...r??[]].filter(Boolean),chains:s},{data:l,count:c}=await y.fetchWallets(o),u=l.slice(0,20).map((e=>e.image_id)).filter(Boolean);await Promise.allSettled(u.map((e=>y._fetchWalletImage(e)))),v.wallets=a.w.uniqueBy([...v.wallets,...y._filterOutExtensions(l)],"id"),v.count=c>v.count?c:v.count,v.page=t},async initializeExcludedWallets(e){let{ids:t}=e;const n=h.W.getRequestedCaipNetworkIds().join(","),i={page:1,entries:t.length,include:t,chains:n},{data:r}=await y.fetchWallets(i);r&&r.forEach((e=>{v.excludedWallets.push({rdns:e.rdns,name:e.name})}))},async searchWallet(e){let{search:t,badge:n}=e;const{includeWalletIds:i,excludeWalletIds:r}=p.H.state,s=h.W.getRequestedCaipNetworkIds().join(",");v.search=[];const o={page:1,entries:100,search:t?.trim(),badge_type:n,include:i,exclude:r,chains:s},{data:l}=await y.fetchWallets(o);d.E.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:n??"",search:t??""}});const c=l.map((e=>e.image_id)).filter(Boolean);await Promise.allSettled([...c.map((e=>y._fetchWalletImage(e))),a.w.wait(300)]),v.search=y._filterOutExtensions(l)},initPromise(e,t){const n=v.promises[e];return n||(v.promises[e]=t())},prefetch(){let{fetchConnectorImages:e=!0,fetchFeaturedWallets:t=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:i=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=[e&&y.initPromise("connectorImages",y.fetchConnectorImages),t&&y.initPromise("featuredWallets",y.fetchFeaturedWallets),n&&y.initPromise("recommendedWallets",y.fetchRecommendedWallets),i&&y.initPromise("networkImages",y.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(r)},prefetchAnalyticsConfig(){p.H.state.features?.analytics&&y.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:e}=await g.get({path:"/getAnalyticsConfig",params:y._getSdkProperties()});p.H.setFeatures({analytics:e})}catch(e){p.H.setFeatures({analytics:!1})}},setFilterByNamespace(e){if(!e)return v.featured=v.allFeatured,void(v.recommended=v.allRecommended);const t=h.W.getRequestedCaipNetworkIds().join(",");v.featured=v.allFeatured.filter((e=>e.chains?.some((e=>t.includes(e))))),v.recommended=v.allRecommended.filter((e=>e.chains?.some((e=>t.includes(e)))))}}},17143:(e,t,n)=>{"use strict";n.d(t,{db:()=>s,eV:()=>r});var i=n(24603);function r(e){let{dir:t,size:n=32}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"===typeof e?s(e,{dir:t,size:n}):function(e){let{dir:t,size:n=32}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null===n)return e;if(e.length>n)throw new i.Fl({size:e.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let i=0;i<n;i++){const s="right"===t;r[s?i:n-i-1]=e[s?i:e.length-i-1]}return r}(e,{dir:t,size:n})}function s(e){let{dir:t,size:n=32}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null===n)return e;const r=e.replace("0x","");if(r.length>2*n)throw new i.Fl({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r["right"===t?"padEnd":"padStart"](2*n,"0")}`}},19048:(e,t,n)=>{"use strict";n.d(t,{J9:()=>s,Mc:()=>r,fD:()=>i});const i={1:"An `assert` condition failed.",17:"Arithmetic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},r={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},s={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"}},20033:(e,t)=>{"use strict";function n(e){let t;return"undefined"!==typeof window&&"undefined"!==typeof window[e]&&(t=window[e]),t}function i(e){const t=n(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=n,t.getFromWindowOrThrow=i,t.getDocumentOrThrow=function(){return i("document")},t.getDocument=function(){return n("document")},t.getNavigatorOrThrow=function(){return i("navigator")},t.getNavigator=function(){return n("navigator")},t.getLocationOrThrow=function(){return i("location")},t.getLocation=function(){return n("location")},t.getCryptoOrThrow=function(){return i("crypto")},t.getCrypto=function(){return n("crypto")},t.getLocalStorageOrThrow=function(){return i("localStorage")},t.getLocalStorage=function(){return n("localStorage")}},21602:(e,t,n)=>{"use strict";n.d(t,{Hi:()=>r,ft:()=>s,uj:()=>o});var i=n(21627);class r extends i.C{constructor(e){let{address:t}=e;super(`State for account "${t}" is set multiple times.`,{name:"AccountStateConflictError"})}}class s extends i.C{constructor(){super("state and stateDiff are set on the same account.",{name:"StateAssignmentConflictError"})}}function a(e){return e.reduce(((e,t)=>{let{slot:n,value:i}=t;return`${e}        ${n}: ${i}\n`}),"")}function o(e){return e.reduce(((e,t)=>{let{address:n,...i}=t,r=`${e}    ${n}:\n`;return i.nonce&&(r+=`      nonce: ${i.nonce}\n`),i.balance&&(r+=`      balance: ${i.balance}\n`),i.code&&(r+=`      code: ${i.code}\n`),i.state&&(r+="      state:\n",r+=a(i.state)),i.stateDiff&&(r+="      stateDiff:\n",r+=a(i.stateDiff)),r}),"  State Override:\n").slice(0,-1)}},21627:(e,t,n)=>{"use strict";n.d(t,{C:()=>s});const i="2.28.0";let r={getDocsUrl:e=>{let{docsBaseUrl:t,docsPath:n="",docsSlug:i}=e;return n?`${t??"https://viem.sh"}${n}${i?`#${i}`:""}`:void 0},version:`viem@${i}`};class s extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.cause instanceof s?t.cause.details:t.cause?.message?t.cause.message:t.details,a=t.cause instanceof s&&t.cause.docsPath||t.docsPath,o=r.getDocsUrl?.({...t,docsPath:a});super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...o?[`Docs: ${o}`]:[],...n?[`Details: ${n}`]:[],...r.version?[`Version: ${r.version}`]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=a,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=i}walk(e){return a(this,e)}}function a(e,t){return t?.(e)?e:e&&"object"===typeof e&&"cause"in e&&void 0!==e.cause?a(e.cause,t):t?null:e}},22017:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});var i=n(31499);function r(e){return(0,i.q)(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}},22538:(e,t,n)=>{"use strict";n.d(t,{Q:()=>l});const i=/^0x(?:[A-Fa-f0-9]{64})$/u,r=/^0x(?:[a-fA-F0-9]{62,})$/u;var s=n(59979),a=n(67887);const o=3e4,l={checkIfAllowedToTriggerEmail(){const e=a.o.get(s.s1.LAST_EMAIL_LOGIN_TIME);if(e){const t=Date.now()-Number(e);if(t<o){const e=Math.ceil((o-t)/1e3);throw new Error(`Please try again after ${e} seconds`)}}},getTimeToNextEmailLogin(){const e=a.o.get(s.s1.LAST_EMAIL_LOGIN_TIME);if(e){const t=Date.now()-Number(e);if(t<o)return Math.ceil((o-t)/1e3)}return 0},checkIfRequestExists:e=>s.Vl.NOT_SAFE_RPC_METHODS.includes(e.method)||s.Vl.SAFE_RPC_METHODS.includes(e.method),getResponseType:e=>"string"===typeof e&&(e?.match(i)||e?.match(r))?s.s1.RPC_RESPONSE_TYPE_TX:s.s1.RPC_RESPONSE_TYPE_OBJECT,checkIfRequestIsSafe:e=>s.Vl.SAFE_RPC_METHODS.includes(e.method),isClient:"undefined"!==typeof window}},22799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function r(e,t,i){var r=null;if(void 0!==i&&(r=""+i),void 0!==t.key&&(r=""+t.key),"key"in t)for(var s in i={},t)"key"!==s&&(i[s]=t[s]);else i=t;return t=i.ref,{$$typeof:n,type:e,key:r,ref:void 0!==t?t:null,props:i}}t.Fragment=i,t.jsx=r,t.jsxs=r},23512:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=(e,t,n)=>JSON.stringify(e,((e,n)=>{const i="bigint"===typeof n?n.toString():n;return"function"===typeof t?t(e,i):i}),n)},24603:(e,t,n)=>{"use strict";n.d(t,{Fl:()=>s,NV:()=>a,ii:()=>r});var i=n(21627);class r extends i.C{constructor(e){let{offset:t,position:n,size:i}=e;super(`Slice ${"start"===n?"starting":"ending"} at offset "${t}" is out-of-bounds (size: ${i}).`,{name:"SliceOffsetOutOfBoundsError"})}}class s extends i.C{constructor(e){let{size:t,targetSize:n,type:i}=e;super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} size (${t}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}class a extends i.C{constructor(e){let{size:t,targetSize:n,type:i}=e;super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} is expected to be ${n} ${i} long, but is ${t} ${i} long.`,{name:"InvalidBytesLengthError"})}}},24657:(e,t,n)=>{"use strict";n.d(t,{w:()=>a});var i=n(80883),r=n(84657),s=n(88861);const a={isMobile(){return!!this.isClient()&&Boolean(window?.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent))},checkCaipNetwork(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e?.caipNetworkId.toLocaleLowerCase().includes(t.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const e=window?.navigator.userAgent.toLowerCase();return a.isMobile()&&e.includes("android")},isIos(){if(!this.isMobile())return!1;const e=window?.navigator.userAgent.toLowerCase();return e.includes("iphone")||e.includes("ipad")},isSafari(){if(!this.isClient())return!1;const e=window?.navigator.userAgent.toLowerCase();return e.includes("safari")},isClient:()=>"undefined"!==typeof window,isPairingExpired:e=>!e||e-Date.now()<=r.oU.TEN_SEC_MS,isAllowedRetry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.oU.ONE_SEC_MS;return Date.now()-e>=t},copyToClopboard(e){navigator.clipboard.writeText(e)},isIframe(){try{return window?.self!==window?.top}catch(e){return!1}},getPairingExpiry:()=>Date.now()+r.oU.FOUR_MINUTES_MS,getNetworkId:e=>e?.split(":")[1],getPlainAddress:e=>e?.split(":")[2],wait:async e=>new Promise((t=>{setTimeout(t,e)})),debounce(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];t&&clearTimeout(t),t=setTimeout((function(){e(...r)}),n)}},isHttpUrl:e=>e.startsWith("http://")||e.startsWith("https://"),formatNativeUrl(e,t){if(a.isHttpUrl(e))return this.formatUniversalUrl(e,t);let n=e;n.includes("://")||(n=e.replaceAll("/","").replaceAll(":",""),n=`${n}://`),n.endsWith("/")||(n=`${n}/`),this.isTelegram()&&this.isAndroid()&&(t=encodeURIComponent(t));return{redirect:`${n}wc?uri=${encodeURIComponent(t)}`,href:n}},formatUniversalUrl(e,t){if(!a.isHttpUrl(e))return this.formatNativeUrl(e,t);let n=e;n.endsWith("/")||(n=`${n}/`);return{redirect:`${n}wc?uri=${encodeURIComponent(t)}`,href:n}},getOpenTargetForPlatform(e){return"popupWindow"===e?e:this.isTelegram()?s.i.getTelegramSocialProvider()?"_top":"_blank":e},openHref(e,t,n){window?.open(e,this.getOpenTargetForPlatform(t),n||"noreferrer noopener")},returnOpenHref(e,t,n){return window?.open(e,this.getOpenTargetForPlatform(t),n||"noreferrer noopener")},isTelegram:()=>"undefined"!==typeof window&&(Boolean(window.TelegramWebviewProxy)||Boolean(window.Telegram)||Boolean(window.TelegramWebviewProxyProto)),async preloadImage(e){const t=new Promise(((t,n)=>{const i=new Image;i.onload=t,i.onerror=n,i.crossOrigin="anonymous",i.src=e}));return Promise.race([t,a.wait(2e3)])},formatBalance(e,t){let n="0.000";if("string"===typeof e){const t=Number(e);if(t){const e=Math.floor(1e3*t)/1e3;e&&(n=e.toString())}}return`${n}${t?` ${t}`:""}`},formatBalance2(e,t){let n;if("0"===e)n="0";else if("string"===typeof e){const t=Number(e);t&&(n=t.toString().match(/^-?\d+(?:\.\d{0,3})?/u)?.[0])}return{value:n??"0",rest:"0"===n?"000":"",symbol:t}},getApiUrl:()=>i.o.W3M_API_URL,getBlockchainApiUrl:()=>i.o.BLOCKCHAIN_API_RPC_URL,getAnalyticsUrl:()=>i.o.PULSE_API_URL,getUUID:()=>crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),parseError:e=>"string"===typeof e?e:"string"===typeof e?.issues?.[0]?.message?e.issues[0].message:e instanceof Error?e.message:"Unknown error",sortRequestedNetworks(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n={};return t&&e&&(e.forEach(((e,t)=>{n[e]=t})),t.sort(((e,t)=>{const i=n[e.id],r=n[t.id];return void 0!==i&&void 0!==r?i-r:void 0!==i?-1:void 0!==r?1:0}))),t},calculateBalance(e){let t=0;for(const n of e)t+=n.value??0;return t},formatTokenBalance(e){const t=e.toFixed(2),[n,i]=t.split(".");return{dollars:n,pennies:i}},isAddress(e){switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"eip155"){case"eip155":return!!/^(?:0x)?[0-9a-f]{40}$/iu.test(e)&&!(!/^(?:0x)?[0-9a-f]{40}$/iu.test(e)&&!/^(?:0x)?[0-9A-F]{40}$/iu.test(e));case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(e);default:return!1}},uniqueBy(e,t){const n=new Set;return e.filter((e=>{const i=e[t];return!n.has(i)&&(n.add(i),!0)}))},generateSdkVersion:(e,t,n)=>`${t}-${0===e.length?r.oU.ADAPTER_TYPES.UNIVERSAL:e.map((e=>e.adapterType)).join(",")}-${n}`,createAccount:(e,t,n,i,r)=>({namespace:e,address:t,type:n,publicKey:i,path:r}),isCaipAddress(e){if("string"!==typeof e)return!1;const t=e.split(":"),n=t[0];return 3===t.filter(Boolean).length&&n in i.o.CHAIN_NAME_MAP},isMac(){const e=window?.navigator.userAgent.toLowerCase();return e.includes("macintosh")&&!e.includes("safari")},formatTelegramSocialLoginUrl(e){const t=`--${encodeURIComponent(window?.location.href)}`,n="state=";if("auth.magic.link"===new URL(e).host){const i="provider_authorization_url=",r=e.substring(e.indexOf(i)+i.length),s=this.injectIntoUrl(decodeURIComponent(r),n,t);return e.replace(r,encodeURIComponent(s))}return this.injectIntoUrl(e,n,t)},injectIntoUrl(e,t,n){const i=e.indexOf(t);if(-1===i)throw new Error(`${t} parameter not found in the URL: ${e}`);const r=e.indexOf("&",i),s=t.length,a=-1!==r?r:e.length;return e.substring(0,i+s)+(e.substring(i+s,a)+n)+e.substring(r)}}},24684:(e,t,n)=>{"use strict";n.d(t,{r:()=>c});var i=n(60446),r=n(33513),s=n(8092),a=n(62658);i.extend(s),i.extend(a);const o={...r,name:"en-web3-modal",relativeTime:{future:"in %s",past:"%s ago",s:"%d sec",m:"1 min",mm:"%d min",h:"1 hr",hh:"%d hrs",d:"1 d",dd:"%d d",M:"1 mo",MM:"%d mo",y:"1 yr",yy:"%d yr"}},l=["January","February","March","April","May","June","July","August","September","October","November","December"];i.locale("en-web3-modal",o);const c={getMonthNameByIndex:e=>l[e],getYear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(new Date).toISOString();return i(e).year()},getRelativeDateFromNow:e=>i(e).locale("en-web3-modal").fromNow(!0),formatDate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DD MMM";return i(e).format(t)}}},24722:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e.replace(/{([^{}]*)}/g,((e,n)=>{const i=t[n];return"string"===typeof i||"number"===typeof i?i.toString():e}))}},25347:(e,t,n)=>{"use strict";function i(e,t){return"light"===t?{"--w3m-accent":e?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":e?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}n.d(t,{o:()=>i})},25711:(e,t,n)=>{"use strict";const i=n(75984);e.exports=a;const r=function(){function e(e){return"undefined"!==typeof e&&e}try{return"undefined"!==typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},s={mapHttpRequest:d,mapHttpResponse:d,wrapRequestSerializer:p,wrapResponseSerializer:p,wrapErrorSerializer:p,req:d,res:d,err:function(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const n in e)void 0===t[n]&&(t[n]=e[n]);return t}};function a(e){(e=e||{}).browser=e.browser||{};const t=e.browser.transmit;if(t&&"function"!==typeof t.send)throw Error("pino: transmit option must have a send function");const n=e.browser.write||r;e.browser.write&&(e.browser.asObject=!0);const i=e.serializers||{},s=function(e,t){if(Array.isArray(e))return e.filter((function(e){return"!stdSerializers.err"!==e}));return!0===e&&Object.keys(t)}(e.browser.serialize,i);let d=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(d=!1);"function"===typeof n&&(n.error=n.fatal=n.warn=n.info=n.debug=n.trace=n),!1===e.enabled&&(e.level="silent");const p=e.level||"info",m=Object.create(n);m.log||(m.log=f),Object.defineProperty(m,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(m,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,o(g,m,"error","log"),o(g,m,"fatal","error"),o(g,m,"warn","error"),o(g,m,"info","log"),o(g,m,"debug","log"),o(g,m,"trace","log")}});const g={transmit:t,serialize:s,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:u(e)};return m.levels=a.levels,m.level=p,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=f,m.serializers=i,m._serialize=s,m._stdErrSerialize=d,m.child=function(n,r){if(!n)throw new Error("missing bindings for child Pino");r=r||{},s&&n.serializers&&(r.serializers=n.serializers);const a=r.serializers;if(s&&a){var o=Object.assign({},i,a),u=!0===e.browser.serialize?Object.keys(o):s;delete n.serializers,l([n],u,o,this._stdErrSerialize)}function d(e){this._childLevel=1+(0|e._childLevel),this.error=c(e,n,"error"),this.fatal=c(e,n,"fatal"),this.warn=c(e,n,"warn"),this.info=c(e,n,"info"),this.debug=c(e,n,"debug"),this.trace=c(e,n,"trace"),o&&(this.serializers=o,this._serialize=u),t&&(this._logEvent=h([].concat(e._logEvent.bindings,n)))}return d.prototype=this,new d(this)},t&&(m._logEvent=h()),m}function o(e,t,n,s){const o=Object.getPrototypeOf(t);t[n]=t.levelVal>t.levels.values[n]?f:o[n]?o[n]:r[n]||r[s]||f,function(e,t,n){if(!e.transmit&&t[n]===f)return;t[n]=(s=t[n],function(){const o=e.timestamp(),c=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var d=0;d<c.length;d++)c[d]=arguments[d];if(e.serialize&&!e.asObject&&l(c,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?s.call(u,function(e,t,n,r){e._serialize&&l(n,e._serialize,e.serializers,e._stdErrSerialize);const s=n.slice();let o=s[0];const c={};r&&(c.time=r),c.level=a.levels.values[t];let h=1+(0|e._childLevel);if(h<1&&(h=1),null!==o&&"object"===typeof o){for(;h--&&"object"===typeof s[0];)Object.assign(c,s.shift());o=s.length?i(s.shift(),s):void 0}else"string"===typeof o&&(o=i(s.shift(),s));return void 0!==o&&(c.msg=o),c}(this,n,c,o)):s.apply(u,c),e.transmit){const i=e.transmit.level||t.level,r=a.levels.values[i],s=a.levels.values[n];if(s<r)return;!function(e,t,n){const i=t.send,r=t.ts,s=t.methodLevel,a=t.methodValue,o=t.val,c=e._logEvent.bindings;l(n,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=r,e._logEvent.messages=n.filter((function(e){return-1===c.indexOf(e)})),e._logEvent.level.label=s,e._logEvent.level.value=a,i(s,e._logEvent,o),e._logEvent=h(c)}(this,{ts:o,methodLevel:n,methodValue:s,transmitLevel:i,transmitValue:a.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},c)}});var s}(e,t,n)}function l(e,t,n,i){for(const r in e)if(i&&e[r]instanceof Error)e[r]=a.stdSerializers.err(e[r]);else if("object"===typeof e[r]&&!Array.isArray(e[r]))for(const i in e[r])t&&t.indexOf(i)>-1&&i in n&&(e[r][i]=n[i](e[r][i]))}function c(e,t,n){return function(){const i=new Array(1+arguments.length);i[0]=t;for(var r=1;r<i.length;r++)i[r]=arguments[r-1];return e[n].apply(this,i)}}function h(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function u(e){return"function"===typeof e.timestamp?e.timestamp:!1===e.timestamp?m:g}function d(){return{}}function p(e){return e}function f(){}function m(){return!1}function g(){return Date.now()}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=s,a.stdTimeFunctions=Object.assign({},{nullTime:m,epochTime:g,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}})},26615:(e,t,n)=>{"use strict";n.d(t,{l:()=>s});var i=n(21627),r=n(12343);function s(e,t){const n=(e.details||"").toLowerCase(),s=e instanceof i.C?e.walk((e=>e?.code===r.A7.code)):e;return s instanceof i.C?new r.A7({cause:e,message:s.details}):r.A7.nodeMessage.test(n)?new r.A7({cause:e,message:e.details}):r.BG.nodeMessage.test(n)?new r.BG({cause:e,maxFeePerGas:t?.maxFeePerGas}):r.jj.nodeMessage.test(n)?new r.jj({cause:e,maxFeePerGas:t?.maxFeePerGas}):r.K0.nodeMessage.test(n)?new r.K0({cause:e,nonce:t?.nonce}):r.Oh.nodeMessage.test(n)?new r.Oh({cause:e,nonce:t?.nonce}):r.vW.nodeMessage.test(n)?new r.vW({cause:e,nonce:t?.nonce}):r.k5.nodeMessage.test(n)?new r.k5({cause:e}):r.lY.nodeMessage.test(n)?new r.lY({cause:e,gas:t?.gas}):r.Fo.nodeMessage.test(n)?new r.Fo({cause:e,gas:t?.gas}):r.uC.nodeMessage.test(n)?new r.uC({cause:e}):r.lN.nodeMessage.test(n)?new r.lN({cause:e,maxFeePerGas:t?.maxFeePerGas,maxPriorityFeePerGas:t?.maxPriorityFeePerGas}):new r.RM({cause:e})}},27284:e=>{"use strict";var t,n="object"===typeof Reflect?Reflect:null,i=n&&"function"===typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"===typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!==e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,s),i(n)}function s(){"function"===typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}m(e,t,s,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&m(e,"error",t,n)}(e,r,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function o(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var r,s,a,c;if(o(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),a=s[t]),void 0===a)a=s[t]=n,++e._eventsCount;else if("function"===typeof a?a=s[t]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),(r=l(e))>0&&a.length>r&&!a.warned){a.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=a.length,c=h,console&&console.warn&&console.warn(c)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=h.bind(i);return r.listener=n,i.wrapFn=r,r}function d(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"===typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):f(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function m(e,t,n,i){if("function"===typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(s){i.once&&e.removeEventListener(t,r),n(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var l=s[e];if(void 0===l)return!1;if("function"===typeof l)i(l,this,t);else{var c=l.length,h=f(l,c);for(n=0;n<c;++n)i(h[n],this,t)}return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return o(t),this.on(e,u(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,u(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,i,r,s,a;if(o(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(r=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,r=s;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,s=Object.keys(n);for(i=0;i<s.length;++i)"removeListener"!==(r=s[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},s.prototype.listeners=function(e){return d(this,e,!0)},s.prototype.rawListeners=function(e){return d(this,e,!1)},s.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},27908:(e,t,n)=>{"use strict";n.d(t,{p:()=>h});var i=n(52620),r=n(43479),s=n(97965),a=n(73924),o=n(59052),l=n(2283);const c="/docs/contract/encodeFunctionData";function h(e){const{args:t}=e,{abi:n,functionName:h}=1===e.abi.length&&e.functionName?.startsWith("0x")?e:function(e){const{abi:t,args:n,functionName:i}=e;let r=t[0];if(i){const e=(0,l.iY)({abi:t,args:n,name:i});if(!e)throw new s.Iz(i,{docsPath:c});r=e}if("function"!==r.type)throw new s.Iz(void 0,{docsPath:c});return{abi:[r],functionName:(0,a.V)((0,o.B)(r))}}(e),u=n[0],d=h,p="inputs"in u&&u.inputs?(0,r.h)(u.inputs,t??[]):void 0;return(0,i.aP)([d,p??"0x"])}},28429:(e,t,n)=>{"use strict";function i(e,t){const n=e.exec(t);return n?.groups}n.d(t,{BD:()=>r,Ge:()=>s,Yv:()=>i,wj:()=>a});const r=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,s=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,a=/^\(.+?\).*?$/},28531:(e,t,n)=>{"use strict";n.d(t,{JW:()=>S,XX:()=>H,c0:()=>_,ge:()=>j,qy:()=>A,s6:()=>T});const i=globalThis,r=i.trustedTypes,s=r?r.createPolicy("lit-html",{createHTML:e=>e}):void 0,a="$lit$",o=`lit$${Math.random().toFixed(9).slice(2)}$`,l="?"+o,c=`<${l}>`,h=document,u=()=>h.createComment(""),d=e=>null===e||"object"!=typeof e&&"function"!=typeof e,p=Array.isArray,f=e=>p(e)||"function"==typeof e?.[Symbol.iterator],m="[ \t\n\f\r]",g=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v=/-->/g,y=/>/g,b=RegExp(`>|${m}(?:([^\\s"'>=/]+)(${m}*=${m}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),w=/'/g,x=/"/g,E=/^(?:script|style|textarea|title)$/i,C=e=>function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return{_$litType$:e,strings:t,values:i}},A=C(1),S=C(2),_=(C(3),Symbol.for("lit-noChange")),T=Symbol.for("lit-nothing"),P=new WeakMap,M=h.createTreeWalker(h,129);function N(e,t){if(!p(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==s?s.createHTML(t):t}const I=(e,t)=>{const n=e.length-1,i=[];let r,s=2===t?"<svg>":3===t?"<math>":"",l=g;for(let h=0;h<n;h++){const t=e[h];let n,u,d=-1,p=0;for(;p<t.length&&(l.lastIndex=p,u=l.exec(t),null!==u);)p=l.lastIndex,l===g?"!--"===u[1]?l=v:void 0!==u[1]?l=y:void 0!==u[2]?(E.test(u[2])&&(r=RegExp("</"+u[2],"g")),l=b):void 0!==u[3]&&(l=b):l===b?">"===u[0]?(l=r??g,d=-1):void 0===u[1]?d=-2:(d=l.lastIndex-u[2].length,n=u[1],l=void 0===u[3]?b:'"'===u[3]?x:w):l===x||l===w?l=b:l===v||l===y?l=g:(l=b,r=void 0);const f=l===b&&e[h+1].startsWith("/>")?" ":"";s+=l===g?t+c:d>=0?(i.push(n),t.slice(0,d)+a+t.slice(d)+o+f):t+o+(-2===d?h:f)}return[N(e,s+(e[n]||"<?>")+(2===t?"</svg>":3===t?"</math>":"")),i]};class O{constructor(e,t){let n,{strings:i,_$litType$:s}=e;this.parts=[];let c=0,h=0;const d=i.length-1,p=this.parts,[f,m]=I(i,s);if(this.el=O.createElement(f,t),M.currentNode=this.el.content,2===s||3===s){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(n=M.nextNode())&&p.length<d;){if(1===n.nodeType){if(n.hasAttributes())for(const e of n.getAttributeNames())if(e.endsWith(a)){const t=m[h++],i=n.getAttribute(e).split(o),r=/([.?@])?(.*)/.exec(t);p.push({type:1,index:c,name:r[2],strings:i,ctor:"."===r[1]?B:"?"===r[1]?U:"@"===r[1]?z:k}),n.removeAttribute(e)}else e.startsWith(o)&&(p.push({type:6,index:c}),n.removeAttribute(e));if(E.test(n.tagName)){const e=n.textContent.split(o),t=e.length-1;if(t>0){n.textContent=r?r.emptyScript:"";for(let i=0;i<t;i++)n.append(e[i],u()),M.nextNode(),p.push({type:2,index:++c});n.append(e[t],u())}}}else if(8===n.nodeType)if(n.data===l)p.push({type:2,index:c});else{let e=-1;for(;-1!==(e=n.data.indexOf(o,e+1));)p.push({type:7,index:c}),e+=o.length-1}c++}}static createElement(e,t){const n=h.createElement("template");return n.innerHTML=e,n}}function D(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3?arguments[3]:void 0;if(t===_)return t;let r=void 0!==i?n._$Co?.[i]:n._$Cl;const s=d(t)?void 0:t._$litDirective$;return r?.constructor!==s&&(r?._$AO?.(!1),void 0===s?r=void 0:(r=new s(e),r._$AT(e,n,i)),void 0!==i?(n._$Co??=[])[i]=r:n._$Cl=r),void 0!==r&&(t=D(e,r._$AS(e,t.values),r,i)),t}class L{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,i=(e?.creationScope??h).importNode(t,!0);M.currentNode=i;let r=M.nextNode(),s=0,a=0,o=n[0];for(;void 0!==o;){if(s===o.index){let t;2===o.type?t=new R(r,r.nextSibling,this,e):1===o.type?t=new o.ctor(r,o.name,o.strings,this,e):6===o.type&&(t=new F(r,this,e)),this._$AV.push(t),o=n[++a]}s!==o?.index&&(r=M.nextNode(),s++)}return M.currentNode=h,i}p(e){let t=0;for(const n of this._$AV)void 0!==n&&(void 0!==n.strings?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,n,i){this.type=2,this._$AH=T,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e?.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e){e=D(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this),d(e)?e===T||null==e||""===e?(this._$AH!==T&&this._$AR(),this._$AH=T):e!==this._$AH&&e!==_&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):f(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==T&&d(this._$AH)?this._$AA.nextSibling.data=e:this.T(h.createTextNode(e)),this._$AH=e}$(e){const{values:t,_$litType$:n}=e,i="number"==typeof n?this._$AC(e):(void 0===n.el&&(n.el=O.createElement(N(n.h,n.h[0]),this.options)),n);if(this._$AH?._$AD===i)this._$AH.p(t);else{const e=new L(i,this),n=e.u(this.options);e.p(t),this.T(n),this._$AH=e}}_$AC(e){let t=P.get(e.strings);return void 0===t&&P.set(e.strings,t=new O(e)),t}k(e){p(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,i=0;for(const r of e)i===t.length?t.push(n=new R(this.O(u()),this.O(u()),this,this.options)):n=t[i],n._$AI(r),i++;i<t.length&&(this._$AR(n&&n._$AB.nextSibling,i),t.length=i)}_$AR(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._$AA.nextSibling,t=arguments.length>1?arguments[1]:void 0;for(this._$AP?.(!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,i,r){this.type=1,this._$AH=T,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=r,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=T}_$AI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;const r=this.strings;let s=!1;if(void 0===r)e=D(this,e,t,0),s=!d(e)||e!==this._$AH&&e!==_,s&&(this._$AH=e);else{const i=e;let a,o;for(e=r[0],a=0;a<r.length-1;a++)o=D(this,i[n+a],t,a),o===_&&(o=this._$AH[a]),s||=!d(o)||o!==this._$AH[a],o===T?e=T:e!==T&&(e+=(o??"")+r[a+1]),this._$AH[a]=o}s&&!i&&this.j(e)}j(e){e===T?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class B extends k{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===T?void 0:e}}class U extends k{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==T)}}class z extends k{constructor(e,t,n,i,r){super(e,t,n,i,r),this.type=5}_$AI(e){if((e=D(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,0)??T)===_)return;const t=this._$AH,n=e===T&&t!==T||e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive,i=e!==T&&(t===T||n);n&&this.element.removeEventListener(this.name,this,t),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class F{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){D(this,e)}}const j={M:a,P:o,A:l,C:1,L:I,R:L,D:f,V:D,I:R,H:k,N:U,U:z,B:B,F:F},V=i.litHtmlPolyfillSupport;V?.(O,R),(i.litHtmlVersions??=[]).push("3.3.0");const H=(e,t,n)=>{const i=n?.renderBefore??t;let r=i._$litPart$;if(void 0===r){const e=n?.renderBefore??null;i._$litPart$=r=new R(t.insertBefore(u(),e),e,void 0,n??{})}return r._$AI(e),r}},30284:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});const i=n(61945).k},30296:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise((t=>{setTimeout((()=>{t(!0)}),e)}))}},30751:(e,t,n)=>{"use strict";n.d(t,{l:()=>s});var i=n(99577);const r={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new i.hX({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(e){if(e<0||e>this.bytes.length-1)throw new i.SK({length:this.bytes.length,position:e})},decrementPosition(e){if(e<0)throw new i.B4({offset:e});const t=this.position-e;this.assertPosition(t),this.position=t},getReadCount(e){return this.positionReadCount.get(e||this.position)||0},incrementPosition(e){if(e<0)throw new i.B4({offset:e});const t=this.position+e;this.assertPosition(t),this.position=t},inspectByte(e){const t=e??this.position;return this.assertPosition(t),this.bytes[t]},inspectBytes(e,t){const n=t??this.position;return this.assertPosition(n+e-1),this.bytes.subarray(n,n+e)},inspectUint8(e){const t=e??this.position;return this.assertPosition(t),this.bytes[t]},inspectUint16(e){const t=e??this.position;return this.assertPosition(t+1),this.dataView.getUint16(t)},inspectUint24(e){const t=e??this.position;return this.assertPosition(t+2),(this.dataView.getUint16(t)<<8)+this.dataView.getUint8(t+2)},inspectUint32(e){const t=e??this.position;return this.assertPosition(t+3),this.dataView.getUint32(t)},pushByte(e){this.assertPosition(this.position),this.bytes[this.position]=e,this.position++},pushBytes(e){this.assertPosition(this.position+e.length-1),this.bytes.set(e,this.position),this.position+=e.length},pushUint8(e){this.assertPosition(this.position),this.bytes[this.position]=e,this.position++},pushUint16(e){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,e),this.position+=2},pushUint24(e){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,e>>8),this.dataView.setUint8(this.position+2,255&e),this.position+=3},pushUint32(e){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,e),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const e=this.inspectByte();return this.position++,e},readBytes(e,t){this.assertReadLimit(),this._touch();const n=this.inspectBytes(e);return this.position+=t??e,n},readUint8(){this.assertReadLimit(),this._touch();const e=this.inspectUint8();return this.position+=1,e},readUint16(){this.assertReadLimit(),this._touch();const e=this.inspectUint16();return this.position+=2,e},readUint24(){this.assertReadLimit(),this._touch();const e=this.inspectUint24();return this.position+=3,e},readUint32(){this.assertReadLimit(),this._touch();const e=this.inspectUint32();return this.position+=4,e},get remaining(){return this.bytes.length-this.position},setPosition(e){const t=this.position;return this.assertPosition(e),this.position=e,()=>this.position=t},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const e=this.getReadCount();this.positionReadCount.set(this.position,e+1),e>0&&this.recursiveReadCount++}};function s(e){let{recursiveReadLimit:t=8192}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Object.create(r);return n.bytes=e,n.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength),n.positionReadCount=new Map,n.recursiveReadLimit=t,n}},31499:(e,t,n)=>{"use strict";function i(e){let{strict:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!!e&&("string"===typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")))}n.d(t,{q:()=>i})},31666:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const i=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let o=0;o<t.length;o++)t[o]=255;for(let o=0;o<e.length;o++){const n=e.charAt(o),i=n.charCodeAt(0);if(255!==t[i])throw new TypeError(n+" is ambiguous");t[i]=o}const n=e.length,i=e.charAt(0),r=Math.log(n)/Math.log(256),s=Math.log(256)/Math.log(n);function a(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;let s=0,a=0,o=0;for(;e[s]===i;)a++,s++;const l=(e.length-s)*r+1>>>0,c=new Uint8Array(l);for(;s<e.length;){const i=e.charCodeAt(s);if(i>255)return;let r=t[i];if(255===r)return;let a=0;for(let e=l-1;(0!==r||a<o)&&-1!==e;e--,a++)r+=n*c[e]>>>0,c[e]=r%256>>>0,r=r/256>>>0;if(0!==r)throw new Error("Non-zero carry");o=a,s++}let h=l-o;for(;h!==l&&0===c[h];)h++;const u=new Uint8Array(a+(l-h));let d=a;for(;h!==l;)u[d++]=c[h++];return u}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";let r=0,a=0,o=0;const l=t.length;for(;o!==l&&0===t[o];)o++,r++;const c=(l-o)*s+1>>>0,h=new Uint8Array(c);for(;o!==l;){let e=t[o],i=0;for(let t=c-1;(0!==e||i<a)&&-1!==t;t--,i++)e+=256*h[t]>>>0,h[t]=e%n>>>0,e=e/n>>>0;if(0!==e)throw new Error("Non-zero carry");a=i,o++}let u=c-a;for(;u!==c&&0===h[u];)u++;let d=i.repeat(r);for(;u<c;++u)d+=e.charAt(h[u]);return d},decodeUnsafe:a,decode:function(e){const t=a(e);if(t)return t;throw new Error("Non-base"+n+" character")}}};const r=i("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},31898:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});var i=n(6310);function r(e){let{blockNumber:t,chain:n,contract:r}=e;const s=n?.contracts?.[r];if(!s)throw new i.rj({chain:n,contract:{name:r}});if(t&&s.blockCreated&&s.blockCreated>t)throw new i.rj({blockNumber:t,chain:n,contract:{name:r,blockCreated:s.blockCreated}});return s.address}},32819:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});const i={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"}},33513:function(e){e.exports=function(){"use strict";return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}}}()},33901:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56121);i.__exportStar(n(65871),t),i.__exportStar(n(71822),t),i.__exportStar(n(1067),t),i.__exportStar(n(48251),t)},36141:(e,t,n)=>{"use strict";n.d(t,{W:()=>o});var i=n(38993),r=n(25347),s=n(73939);const a=(0,i.BX)({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),o={state:a,subscribe:e=>(0,i.B1)(a,(()=>e(a))),setThemeMode(e){a.themeMode=e;try{const t=s.a.getAuthConnector();if(t){const n=o.getSnapshot().themeVariables;t.provider.syncTheme({themeMode:e,themeVariables:n,w3mThemeVariables:(0,r.o)(n,e)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(e){a.themeVariables={...a.themeVariables,...e};try{const e=s.a.getAuthConnector();if(e){const t=o.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:t,w3mThemeVariables:(0,r.o)(a.themeVariables,a.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot:()=>(0,i.P9)(a)}},36220:(e,t,n)=>{"use strict";n.d(t,{A1:()=>c,di:()=>a});var i=n(24603),r=n(31499),s=n(22017);function a(e,t,n){let{strict:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,r.q)(e,{strict:!1})?function(e,t,n){let{strict:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};o(e,t);const r=`0x${e.replace("0x","").slice(2*(t??0),2*(n??e.length))}`;i&&l(r,t,n);return r}(e,t,n,{strict:i}):c(e,t,n,{strict:i})}function o(e,t){if("number"===typeof t&&t>0&&t>(0,s.E)(e)-1)throw new i.ii({offset:t,position:"start",size:(0,s.E)(e)})}function l(e,t,n){if("number"===typeof t&&"number"===typeof n&&(0,s.E)(e)!==n-t)throw new i.ii({offset:n,position:"end",size:(0,s.E)(e)})}function c(e,t,n){let{strict:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};o(e,t);const r=e.slice(t,n);return i&&l(r,t,n),r}},36596:(e,t,n)=>{"use strict";n.d(t,{j:()=>a});var i=n(38993),r=n(76844);const s=(0,i.BX)({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),a={state:s,subscribeNetworkImages:e=>(0,i.B1)(s.networkImages,(()=>e(s.networkImages))),subscribeKey:(e,t)=>(0,r.u$)(s,e,t),subscribe:e=>(0,i.B1)(s,(()=>e(s))),setWalletImage(e,t){s.walletImages[e]=t},setNetworkImage(e,t){s.networkImages[e]=t},setChainImage(e,t){s.chainImages[e]=t},setConnectorImage(e,t){s.connectorImages={...s.connectorImages,[e]:t}},setTokenImage(e,t){s.tokenImages[e]=t},setCurrencyImage(e,t){s.currencyImages[e]=t}}},37022:(e,t,n)=>{"use strict";n.d(t,{WF:()=>a,AH:()=>i.AH,qy:()=>r.qy,JW:()=>r.JW,iz:()=>i.iz});var i=n(46830),r=n(28531);const s=globalThis;class a extends i.mN{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=(0,r.XX)(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return r.c0}}a._$litElement$=!0,a.finalized=!0,s.litElementHydrateSupport?.({LitElement:a});const o=s.litElementPolyfillSupport;o?.({LitElement:a});(s.litElementVersions??=[]).push("4.2.0")},37131:(e,t,n)=>{"use strict";n.d(t,{Af:()=>p,ZJ:()=>c,aT:()=>d});var i=n(21627),r=n(31499),s=n(17143),a=n(67962),o=n(84117);const l=new TextEncoder;function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"number"===typeof e||"bigint"===typeof e?function(e,t){const n=(0,o.cK)(e,t);return d(n)}(e,t):"boolean"===typeof e?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new Uint8Array(1);if(n[0]=Number(e),"number"===typeof t.size)return(0,a.Sl)(n,{size:t.size}),(0,s.eV)(n,{size:t.size});return n}(e,t):(0,r.q)(e)?d(e,t):p(e,t)}const h={zero:48,nine:57,A:65,F:70,a:97,f:102};function u(e){return e>=h.zero&&e<=h.nine?e-h.zero:e>=h.A&&e<=h.F?e-(h.A-10):e>=h.a&&e<=h.f?e-(h.a-10):void 0}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;t.size&&((0,a.Sl)(n,{size:t.size}),n=(0,s.eV)(n,{dir:"right",size:t.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const o=r.length/2,l=new Uint8Array(o);for(let s=0,a=0;s<o;s++){const e=u(r.charCodeAt(a++)),t=u(r.charCodeAt(a++));if(void 0===e||void 0===t)throw new i.C(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);l[s]=16*e+t}return l}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=l.encode(e);return"number"===typeof t.size?((0,a.Sl)(n,{size:t.size}),(0,s.eV)(n,{dir:"right",size:t.size})):n}},37845:(e,t,n)=>{"use strict";function i(e){return function(t){return"function"===typeof t?function(e,t){return customElements.get(e)||customElements.define(e,t),t}(e,t):function(e,t){const{kind:n,elements:i}=t;return{kind:n,elements:i,finisher(t){customElements.get(e)||customElements.define(e,t)}}}(e,t)}}n.d(t,{E:()=>i})},38639:(e,t,n)=>{"use strict";n.d(t,{HF:()=>c,aj:()=>o,gC:()=>a,nM:()=>s,nk:()=>r,xU:()=>l});var i=n(60392);class r extends i.C{constructor(){super("Chain not configured."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainNotConfiguredError"})}}class s extends i.C{constructor(){super("Connector already connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAlreadyConnectedError"})}}class a extends i.C{constructor(){super("Connector not connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorNotConnectedError"})}}i.C;class o extends i.C{constructor(e){let{address:t,connector:n}=e;super(`Account "${t}" not found for connector "${n.name}".`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAccountNotFoundError"})}}class l extends i.C{constructor(e){let{connectionChainId:t,connectorChainId:n}=e;super(`The current chain of the connector (id: ${n}) does not match the connection's chain (id: ${t}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${t}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorChainMismatchError"})}}class c extends i.C{constructor(e){let{connector:t}=e;super(`Connector "${t.name}" unavailable while reconnecting.`,{details:["During the reconnection step, the only connector methods guaranteed to be available are: `id`, `name`, `type`, `uid`.","All other methods are not guaranteed to be available until reconnection completes and connectors are fully restored.","This error commonly occurs for connectors that asynchronously inject after reconnection has already started."].join(" ")}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorUnavailableReconnectingError"})}}},38993:(e,t,n)=>{"use strict";n.d(t,{BX:()=>p,KR:()=>g,P9:()=>m,B1:()=>f});Symbol();const i=Symbol();const r=Object.getPrototypeOf,s=new WeakMap,a=e=>e&&(s.has(e)?s.get(e):r(e)===Object.prototype||r(e)===Array.prototype),o=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];s.set(e,t)},l=e=>"object"===typeof e&&null!==e,c=new WeakMap,h=new WeakSet,u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.is,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>new Proxy(e,t),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>l(e)&&!h.has(e)&&(Array.isArray(e)||!(Symbol.iterator in e))&&!(e instanceof WeakMap)&&!(e instanceof WeakSet)&&!(e instanceof Error)&&!(e instanceof Number)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof RegExp)&&!(e instanceof ArrayBuffer),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>{switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e}},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new WeakMap,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r;const i=s.get(e);if((null==i?void 0:i[0])===t)return i[1];const a=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return o(a,!0),s.set(e,[t,a]),Reflect.ownKeys(e).forEach((t=>{if(Object.getOwnPropertyDescriptor(a,t))return;const i=Reflect.get(e,t),{enumerable:r}=Reflect.getOwnPropertyDescriptor(e,t),s={value:i,enumerable:r,configurable:!0};if(h.has(i))o(i,!1);else if(i instanceof Promise)delete s.value,s.get=()=>n(i);else if(c.has(i)){const[e,t]=c.get(i);s.value=u(e,t(),n)}Object.defineProperty(a,t,s)})),Object.preventExtensions(a)},d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new WeakMap,p=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[1,1],f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:r=>{if(!l(r))throw new Error("object required");const s=d.get(r);if(s)return s;let o=p[0];const m=new Set,g=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:++p[0];o!==t&&(o=t,m.forEach((n=>n(e,t))))};let v=p[1];const y=e=>(t,n)=>{const i=[...t];i[1]=[e,...i[1]],g(i,n)},b=new Map,w=e=>{var t;const n=b.get(e);n&&(b.delete(e),null==(t=n[1])||t.call(n))},x=Array.isArray(r)?[]:Object.create(Object.getPrototypeOf(r)),E={deleteProperty(e,t){const n=Reflect.get(e,t);w(t);const i=Reflect.deleteProperty(e,t);return i&&g(["delete",[t],n]),i},set(t,r,s,o){const u=Reflect.has(t,r),p=Reflect.get(t,r,o);if(u&&(e(p,s)||d.has(s)&&e(p,d.get(s))))return!0;w(r),l(s)&&(s=(e=>a(e)&&e[i]||null)(s)||s);let v=s;if(s instanceof Promise)s.then((e=>{s.status="fulfilled",s.value=e,g(["resolve",[r],e])})).catch((e=>{s.status="rejected",s.reason=e,g(["reject",[r],e])}));else{!c.has(s)&&n(s)&&(v=f(s));const e=!h.has(v)&&c.get(v);e&&((e,t)=>{if(b.has(e))throw new Error("prop listener already exists");if(m.size){const n=t[3](y(e));b.set(e,[t,n])}else b.set(e,[t])})(r,e)}return Reflect.set(t,r,v,o),g(["set",[r],s,p]),!0}},C=t(x,E);d.set(r,C);const A=[x,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:++p[1];return v===e||m.size||(v=e,b.forEach((t=>{let[n]=t;const i=n[1](e);i>o&&(o=i)}))),o},u,e=>{m.add(e),1===m.size&&b.forEach(((e,t)=>{let[n,i]=e;if(i)throw new Error("remove already exists");const r=n[3](y(t));b.set(t,[n,r])}));return()=>{m.delete(e),0===m.size&&b.forEach(((e,t)=>{let[n,i]=e;i&&(i(),b.set(t,[n]))}))}}];return c.set(C,A),Reflect.ownKeys(r).forEach((e=>{const t=Object.getOwnPropertyDescriptor(r,e);"value"in t&&(C[e]=r[e],delete t.value,delete t.writable),Object.defineProperty(x,e,t)})),C};return[f,c,h,e,t,n,r,s,u,d,p]},[d]=u();function p(){return d(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function f(e,t,n){const i=c.get(e);let r;i||console.warn("Please use proxy object");const s=[],a=i[3];let o=!1;const l=a((e=>{s.push(e),n?t(s.splice(0)):r||(r=Promise.resolve().then((()=>{r=void 0,o&&t(s.splice(0))})))}));return o=!0,()=>{o=!1,l()}}function m(e,t){const n=c.get(e);n||console.warn("Please use proxy object");const[i,r,s]=n;return s(i,r(),t)}function g(e){return h.add(e),e}},39332:(e,t,n)=>{"use strict";t.g=void 0;const i=n(20033);t.g=function(){let e,t;try{e=i.getDocumentOrThrow(),t=i.getLocationOrThrow()}catch(s){return null}function n(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];const r=e.getElementsByTagName("meta");for(let e=0;e<r.length;e++){const t=r[e],i=["itemprop","property","name"].map((e=>t.getAttribute(e))).filter((e=>!!e&&n.includes(e)));if(i.length&&i){const e=t.getAttribute("content");if(e)return e}}return""}const r=function(){let t=n("name","og:site_name","og:title","twitter:title");return t||(t=e.title),t}();return{description:n("description","og:description","twitter:description","keywords"),url:t.origin,icons:function(){const n=e.getElementsByTagName("link"),i=[];for(let e=0;e<n.length;e++){const r=n[e],s=r.getAttribute("rel");if(s&&s.toLowerCase().indexOf("icon")>-1){const e=r.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let n=t.protocol+"//"+t.host;if(0===e.indexOf("/"))n+=e;else{const i=t.pathname.split("/");i.pop();n+=i.join("/")+"/"+e}i.push(n)}else if(0===e.indexOf("//")){const n=t.protocol+e;i.push(n)}else i.push(e)}}return i}(),name:r}}},39446:(e,t,n)=>{"use strict";n.d(t,{JX:()=>c,RF:()=>l,W5:()=>d,ck:()=>f,ds:()=>h,fD:()=>p});var i=n(37022),r=n(25347);let s,a,o;function l(e,t){s=document.createElement("style"),a=document.createElement("style"),o=document.createElement("style"),s.textContent=u(e).core.cssText,a.textContent=u(e).dark.cssText,o.textContent=u(e).light.cssText,document.head.appendChild(s),document.head.appendChild(a),document.head.appendChild(o),c(t)}function c(e){a&&o&&("light"===e?(a.removeAttribute("media"),o.media="enabled"):(o.removeAttribute("media"),a.media="enabled"))}function h(e){s&&a&&o&&(s.textContent=u(e).core.cssText,a.textContent=u(e).dark.cssText,o.textContent=u(e).light.cssText)}function u(e){return{core:i.AH`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${(0,i.iz)(e?.["--w3m-color-mix-strength"]?`${e["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${(0,i.iz)(e?.["--w3m-font-family"]||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${(0,i.iz)(e?.["--w3m-font-size-master"]||"10px")};
        --w3m-border-radius-master: ${(0,i.iz)(e?.["--w3m-border-radius-master"]||"4px")};
        --w3m-z-index: ${(0,i.iz)(e?.["--w3m-z-index"]||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:i.AH`
      :root {
        --w3m-color-mix: ${(0,i.iz)(e?.["--w3m-color-mix"]||"#fff")};
        --w3m-accent: ${(0,i.iz)((0,r.o)(e,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${(0,i.iz)((0,r.o)(e,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:i.AH`
      :root {
        --w3m-color-mix: ${(0,i.iz)(e?.["--w3m-color-mix"]||"#000")};
        --w3m-accent: ${(0,i.iz)((0,r.o)(e,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${(0,i.iz)((0,r.o)(e,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const d=i.AH`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,p=i.AH`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,f=i.AH`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`},40656:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IWatch=void 0;t.IWatch=class{}},40920:(e,t,n)=>{"use strict";n.d(t,{c:()=>c});var i=n(64034);const r=2n**256n-1n;var s=n(3491),a=n(12343),o=n(83003),l=n(74074);function c(e){const{account:t,gasPrice:n,maxFeePerGas:c,maxPriorityFeePerGas:h,to:u}=e,d=t?(0,i.J)(t):void 0;if(d&&!(0,l.P)(d.address))throw new s.M({address:d.address});if(u&&!(0,l.P)(u))throw new s.M({address:u});if("undefined"!==typeof n&&("undefined"!==typeof c||"undefined"!==typeof h))throw new o.n3;if(c&&c>r)throw new a.BG({maxFeePerGas:c});if(h&&c&&h>c)throw new a.lN({maxFeePerGas:c,maxPriorityFeePerGas:h})}},41928:(e,t,n)=>{"use strict";function i(e,t){let{format:n}=t;if(!n)return{};const i={};return function t(n){const r=Object.keys(n);for(const s of r)s in e&&(i[s]=e[s]),n[s]&&"object"===typeof n[s]&&!Array.isArray(n[s])&&t(n[s])}(n(e||{})),i}n.d(t,{o:()=>i})},42661:(e,t,n)=>{"use strict";n.d(t,{H:()=>c});var i=n(38993),r=n(76844),s=n(84657),a=n(24657);const o={getFeatureValue(e,t){const n=t?.[e];return void 0===n?s.oU.DEFAULT_FEATURES[e]:n},filterSocialsByPlatform(e){if(!e||!e.length)return e;if(a.w.isTelegram()){if(a.w.isIos())return e.filter((e=>"google"!==e));if(a.w.isMac())return e.filter((e=>"x"!==e));if(a.w.isAndroid())return e.filter((e=>!["facebook","x"].includes(e)))}return e}},l=(0,i.BX)({features:s.oU.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:{solana:"eoa",bip122:"payment",polkadot:"eoa",eip155:"smartAccount"},enableNetworkSwitch:!0}),c={state:l,subscribeKey:(e,t)=>(0,r.u$)(l,e,t),setOptions(e){Object.assign(l,e)},setFeatures(e){if(!e)return;l.features||(l.features=s.oU.DEFAULT_FEATURES);const t={...l.features,...e};l.features=t,l.features.socials&&(l.features.socials=o.filterSocialsByPlatform(l.features.socials))},setProjectId(e){l.projectId=e},setCustomRpcUrls(e){l.customRpcUrls=e},setAllWallets(e){l.allWallets=e},setIncludeWalletIds(e){l.includeWalletIds=e},setExcludeWalletIds(e){l.excludeWalletIds=e},setFeaturedWalletIds(e){l.featuredWalletIds=e},setTokens(e){l.tokens=e},setTermsConditionsUrl(e){l.termsConditionsUrl=e},setPrivacyPolicyUrl(e){l.privacyPolicyUrl=e},setCustomWallets(e){l.customWallets=e},setIsSiweEnabled(e){l.isSiweEnabled=e},setIsUniversalProvider(e){l.isUniversalProvider=e},setSdkVersion(e){l.sdkVersion=e},setMetadata(e){l.metadata=e},setDisableAppend(e){l.disableAppend=e},setEIP6963Enabled(e){l.enableEIP6963=e},setDebug(e){l.debug=e},setEnableWalletConnect(e){l.enableWalletConnect=e},setEnableWalletGuide(e){l.enableWalletGuide=e},setEnableAuthLogger(e){l.enableAuthLogger=e},setEnableWallets(e){l.enableWallets=e},setHasMultipleAddresses(e){l.hasMultipleAddresses=e},setSIWX(e){l.siwx=e},setConnectMethodsOrder(e){l.features={...l.features,connectMethodsOrder:e}},setWalletFeaturesOrder(e){l.features={...l.features,walletFeaturesOrder:e}},setSocialsOrder(e){l.features={...l.features,socials:e}},setCollapseWallets(e){l.features={...l.features,collapseWallets:e}},setEnableEmbedded(e){l.enableEmbedded=e},setAllowUnsupportedChain(e){l.allowUnsupportedChain=e},setManualWCControl(e){l.manualWCControl=e},setEnableNetworkSwitch(e){l.enableNetworkSwitch=e},setDefaultAccountTypes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.entries(e).forEach((e=>{let[t,n]=e;n&&(l.defaultAccountTypes[t]=n)}))},setUniversalProviderConfigOverride(e){l.universalProviderConfigOverride=e},getUniversalProviderConfigOverride:()=>l.universalProviderConfigOverride,getSnapshot:()=>(0,i.P9)(l)}},43028:(e,t,n)=>{"use strict";n.d(t,{b:()=>h,o:()=>c});var i=n(3491),r=n(37131),s=n(81064),a=n(56844),o=n(74074);const l=new a.A(8192);function c(e,t){if(l.has(`${e}.${t}`))return l.get(`${e}.${t}`);const n=t?`${t}${e.toLowerCase()}`:e.substring(2).toLowerCase(),i=(0,s.S)((0,r.Af)(n),"bytes"),a=(t?n.substring(`${t}0x`.length):n).split("");for(let r=0;r<40;r+=2)i[r>>1]>>4>=8&&a[r]&&(a[r]=a[r].toUpperCase()),(15&i[r>>1])>=8&&a[r+1]&&(a[r+1]=a[r+1].toUpperCase());const o=`0x${a.join("")}`;return l.set(`${e}.${t}`,o),o}function h(e,t){if(!(0,o.P)(e,{strict:!1}))throw new i.M({address:e});return c(e,t)}},43340:(e,t,n)=>{"use strict";n.d(t,{CL:()=>l,D5:()=>h,Di:()=>d,G1:()=>N,Gi:()=>c,L5:()=>S,MI:()=>O,RV:()=>E,Sf:()=>x,WT:()=>_,XU:()=>o,YW:()=>m,ab:()=>g,bq:()=>u,cg:()=>P,ch:()=>A,hA:()=>p,hl:()=>T,jz:()=>I,qZ:()=>f,s0:()=>v,sV:()=>w,uL:()=>M,vx:()=>b,xQ:()=>y,xq:()=>C});var i=n(21627),r=n(72494);class s extends i.C{constructor(e,t){let{code:n,docsPath:i,metaMessages:s,name:a,shortMessage:o}=t;super(o,{cause:e,docsPath:i,metaMessages:s||e?.metaMessages,name:a||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=a||e.name,this.code=e instanceof r.J8?e.code:n??-1}}class a extends s{constructor(e,t){super(e,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class o extends s{constructor(e){super(e,{code:o.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(o,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class l extends s{constructor(e){super(e,{code:l.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(l,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class c extends s{constructor(e){let{method:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,{code:c.code,name:"MethodNotFoundRpcError",shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`})}}Object.defineProperty(c,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class h extends s{constructor(e){super(e,{code:h.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join("\n")})}}Object.defineProperty(h,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class u extends s{constructor(e){super(e,{code:u.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(u,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class d extends s{constructor(e){super(e,{code:d.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join("\n")})}}Object.defineProperty(d,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class p extends s{constructor(e){super(e,{code:p.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(p,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class f extends s{constructor(e){super(e,{code:f.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(f,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class m extends s{constructor(e){super(e,{code:m.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(m,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class g extends s{constructor(e){let{method:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,{code:g.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${t?` "${t}"`:""} is not supported.`})}}Object.defineProperty(g,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class v extends s{constructor(e){super(e,{code:v.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(v,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class y extends s{constructor(e){super(e,{code:y.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(y,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class b extends a{constructor(e){super(e,{code:b.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(b,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class w extends a{constructor(e){super(e,{code:w.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(w,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class x extends a{constructor(e){let{method:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,{code:x.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`})}}Object.defineProperty(x,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class E extends a{constructor(e){super(e,{code:E.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(E,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class C extends a{constructor(e){super(e,{code:C.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(C,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class A extends a{constructor(e){super(e,{code:A.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(A,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class S extends a{constructor(e){super(e,{code:S.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(S,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class _ extends a{constructor(e){super(e,{code:_.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(_,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class T extends a{constructor(e){super(e,{code:T.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(T,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class P extends a{constructor(e){super(e,{code:P.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(P,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class M extends a{constructor(e){super(e,{code:M.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(M,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class N extends a{constructor(e){super(e,{code:N.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(N,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class I extends a{constructor(e){super(e,{code:I.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(I,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class O extends s{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}},43479:(e,t,n)=>{"use strict";n.d(t,{h:()=>f,k:()=>v});var i=n(97965),r=n(3491),s=n(21627),a=n(3458),o=n(74074),l=n(52620),c=n(17143),h=n(22017),u=n(36220),d=n(84117);const p=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function f(e,t){if(e.length!==t.length)throw new i.YE({expectedLength:e.length,givenLength:t.length});const n=function(e){let{params:t,values:n}=e;const i=[];for(let r=0;r<t.length;r++)i.push(m({param:t[r],value:n[r]}));return i}({params:e,values:t}),r=g(n);return 0===r.length?"0x":r}function m(e){let{param:t,value:n}=e;const f=v(t.type);if(f){const[e,r]=f;return function(e,t){let{length:n,param:r}=t;const s=null===n;if(!Array.isArray(e))throw new i.dm(e);if(!s&&e.length!==n)throw new i.Nc({expectedLength:n,givenLength:e.length,type:`${r.type}[${n}]`});let a=!1;const o=[];for(let i=0;i<e.length;i++){const t=m({param:r,value:e[i]});t.dynamic&&(a=!0),o.push(t)}if(s||a){const e=g(o);if(s){const t=(0,d.cK)(o.length,{size:32});return{dynamic:!0,encoded:o.length>0?(0,l.xW)([t,e]):t}}if(a)return{dynamic:!0,encoded:e}}return{dynamic:!1,encoded:(0,l.xW)(o.map((e=>{let{encoded:t}=e;return t})))}}(n,{length:e,param:{...t,type:r}})}if("tuple"===t.type)return function(e,t){let{param:n}=t,i=!1;const r=[];for(let s=0;s<n.components.length;s++){const t=n.components[s],a=m({param:t,value:e[Array.isArray(e)?s:t.name]});r.push(a),a.dynamic&&(i=!0)}return{dynamic:i,encoded:i?g(r):(0,l.xW)(r.map((e=>{let{encoded:t}=e;return t})))}}(n,{param:t});if("address"===t.type)return function(e){if(!(0,o.P)(e))throw new r.M({address:e});return{dynamic:!1,encoded:(0,c.db)(e.toLowerCase())}}(n);if("bool"===t.type)return function(e){if("boolean"!==typeof e)throw new s.C(`Invalid boolean value: "${e}" (type: ${typeof e}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:(0,c.db)((0,d.$P)(e))}}(n);if(t.type.startsWith("uint")||t.type.startsWith("int")){const e=t.type.startsWith("int"),[,,i="256"]=p.exec(t.type)??[];return function(e,t){let{signed:n,size:i=256}=t;if("number"===typeof i){const t=2n**(BigInt(i)-(n?1n:0n))-1n,r=n?-t-1n:0n;if(e>t||e<r)throw new a.Ty({max:t.toString(),min:r.toString(),signed:n,size:i/8,value:e.toString()})}return{dynamic:!1,encoded:(0,d.cK)(e,{size:32,signed:n})}}(n,{signed:e,size:Number(i)})}if(t.type.startsWith("bytes"))return function(e,t){let{param:n}=t;const[,r]=n.type.split("bytes"),s=(0,h.E)(e);if(!r){let t=e;return s%32!==0&&(t=(0,c.db)(t,{dir:"right",size:32*Math.ceil((e.length-2)/2/32)})),{dynamic:!0,encoded:(0,l.xW)([(0,c.db)((0,d.cK)(s,{size:32})),t])}}if(s!==Number.parseInt(r))throw new i.gH({expectedSize:Number.parseInt(r),value:e});return{dynamic:!1,encoded:(0,c.db)(e,{dir:"right"})}}(n,{param:t});if("string"===t.type)return function(e){const t=(0,d.i3)(e),n=Math.ceil((0,h.E)(t)/32),i=[];for(let r=0;r<n;r++)i.push((0,c.db)((0,u.di)(t,32*r,32*(r+1)),{dir:"right"}));return{dynamic:!0,encoded:(0,l.xW)([(0,c.db)((0,d.cK)((0,h.E)(t),{size:32})),...i])}}(n);throw new i.nK(t.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function g(e){let t=0;for(let s=0;s<e.length;s++){const{dynamic:n,encoded:i}=e[s];t+=n?32:(0,h.E)(i)}const n=[],i=[];let r=0;for(let s=0;s<e.length;s++){const{dynamic:a,encoded:o}=e[s];a?(n.push((0,d.cK)(t+r,{size:32})),i.push(o),r+=(0,h.E)(o)):n.push(o)}return(0,l.xW)([...n,...i])}function v(e){const t=e.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}},44098:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var i=n(38993),r=n(76844);const s=(0,i.BX)({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),a={state:s,subscribe:e=>(0,i.B1)(s,(()=>e(s))),subscribeOpen:e=>(0,r.u$)(s,"open",e),set(e){Object.assign(s,{...s,...e})}}},44288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var x=Array.isArray,E={H:null,A:null,T:null,S:null,V:null},C=Object.prototype.hasOwnProperty;function A(e,t,i,r,s,a){return i=a.ref,{$$typeof:n,type:e,key:t,ref:void 0!==i?i:null,props:a}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(){}function M(e,t,r,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,h=!1;if(null===e)h=!0;else switch(o){case"bigint":case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case n:case i:h=!0;break;case d:return M((h=e._init)(e._payload),t,r,s,a)}}if(h)return a=a(e),h=""===s?"."+T(e,0):s,x(a)?(r="",null!=h&&(r=h.replace(_,"$&/")+"/"),M(a,t,r,"",(function(e){return e}))):null!=a&&(S(a)&&(l=a,c=r+(null==a.key||e&&e.key===a.key?"":(""+a.key).replace(_,"$&/")+"/")+h,a=A(l.type,c,void 0,0,0,l.props)),t.push(a)),1;h=0;var u,f=""===s?".":s+":";if(x(e))for(var m=0;m<e.length;m++)h+=M(s=e[m],t,r,o=f+T(s,m),a);else if("function"===typeof(m=null===(u=e)||"object"!==typeof u?null:"function"===typeof(u=p&&u[p]||u["@@iterator"])?u:null))for(e=m.call(e),m=0;!(s=e.next()).done;)h+=M(s=s.value,t,r,o=f+T(s,m++),a);else if("object"===o){if("function"===typeof e.then)return M(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(P,P):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,r,s,a);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return h}function N(e,t,n){if(null==e)return e;var i=[],r=0;return M(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function I(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function D(){}t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=a,t.PureComponent=b,t.StrictMode=s,t.Suspense=h,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return E.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var i=m({},e.props),r=e.key;if(null!=t)for(s in void 0!==t.ref&&void 0,void 0!==t.key&&(r=""+t.key),t)!C.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(i[s]=t[s]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var a=Array(s),o=0;o<s;o++)a[o]=arguments[o+2];i.children=a}return A(e.type,r,void 0,0,0,i)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var i,r={},s=null;if(null!=t)for(i in void 0!==t.key&&(s=""+t.key),t)C.call(t,i)&&"key"!==i&&"__self"!==i&&"__source"!==i&&(r[i]=t[i]);var a=arguments.length-2;if(1===a)r.children=n;else if(1<a){for(var o=Array(a),l=0;l<a;l++)o[l]=arguments[l+2];r.children=o}if(e&&e.defaultProps)for(i in a=e.defaultProps)void 0===r[i]&&(r[i]=a[i]);return A(e,s,void 0,0,0,r)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:I}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.T,n={};E.T=n;try{var i=e(),r=E.S;null!==r&&r(n,i),"object"===typeof i&&null!==i&&"function"===typeof i.then&&i.then(D,O)}catch(s){O(s)}finally{E.T=t}},t.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},t.use=function(e){return E.H.use(e)},t.useActionState=function(e,t,n){return E.H.useActionState(e,t,n)},t.useCallback=function(e,t){return E.H.useCallback(e,t)},t.useContext=function(e){return E.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return E.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var i=E.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return i.useEffect(e,t)},t.useId=function(){return E.H.useId()},t.useImperativeHandle=function(e,t,n){return E.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return E.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return E.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return E.H.useMemo(e,t)},t.useOptimistic=function(e,t){return E.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return E.H.useReducer(e,t,n)},t.useRef=function(e){return E.H.useRef(e)},t.useState=function(e){return E.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return E.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return E.H.useTransition()},t.version="19.1.0"},45746:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY},46510:(e,t,n)=>{"use strict";n.d(t,{u:()=>s});var i=n(78628);const r=new Map;function s(e){let{fn:t,id:n,shouldSplitBatch:s,wait:a=0,sort:o}=e;const l=async()=>{const e=h();c();const n=e.map((e=>{let{args:t}=e;return t}));0!==n.length&&t(n).then((t=>{o&&Array.isArray(t)&&t.sort(o);for(let n=0;n<e.length;n++){const{resolve:i}=e[n];i?.([t[n],t])}})).catch((t=>{for(let n=0;n<e.length;n++){const{reject:i}=e[n];i?.(t)}}))},c=()=>r.delete(n),h=()=>r.get(n)||[],u=e=>r.set(n,[...h(),e]);return{flush:c,async schedule(e){const{promise:t,resolve:n,reject:r}=(0,i.Y)(),o=s?.([...h().map((e=>{let{args:t}=e;return t})),e]);o&&l();return h().length>0?(u({args:e,resolve:n,reject:r}),t):(u({args:e,resolve:n,reject:r}),setTimeout(l,a),t)}}}},46613:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__assign:()=>s,__asyncDelegator:()=>w,__asyncGenerator:()=>b,__asyncValues:()=>x,__await:()=>y,__awaiter:()=>h,__classPrivateFieldGet:()=>S,__classPrivateFieldSet:()=>_,__createBinding:()=>d,__decorate:()=>o,__exportStar:()=>p,__extends:()=>r,__generator:()=>u,__importDefault:()=>A,__importStar:()=>C,__makeTemplateObject:()=>E,__metadata:()=>c,__param:()=>l,__read:()=>m,__rest:()=>a,__spread:()=>g,__spreadArrays:()=>v,__values:()=>f});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)};function r(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s.apply(this,arguments)};function a(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function o(e,t,n,i){var r,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,n,a):r(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a}function l(e,t){return function(n,i){t(n,i,e)}}function c(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{l(i.next(e))}catch(t){s(t)}}function o(e){try{l(i.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))}function u(e,t){var n,i,r,s,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(o){s=[6,o],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}function d(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}function p(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])}function f(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(o){r={error:o}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,r++)i[r]=s[a];return i}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function b(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){s.push([e,t,n,i])>1||o(e,t)}))})}function o(e,t){try{(n=r[e](t)).value instanceof y?Promise.resolve(n.value.v).then(l,c):h(s[0][2],n)}catch(i){h(s[0][3],i)}var n}function l(e){o("next",e)}function c(e){o("throw",e)}function h(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}}function w(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:y(e[i](t)),done:"return"===i}:r?r(t):t}:r}}function x(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function A(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function _(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}},46672:(e,t,n)=>{"use strict";var i=n(65043);function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var a={d:{f:s,r:function(){throw Error(r(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(r(299));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=a.p;try{if(l.T=null,a.p=2,e)return e()}finally{l.T=t,a.p=n,a.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,a.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&a.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,i=c(n,t.crossOrigin),r="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?a.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:s}):"script"===n&&a.d.X(e,{crossOrigin:i,integrity:r,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);a.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&a.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,i=c(n,t.crossOrigin);a.d.L(e,n,{crossOrigin:i,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);a.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else a.d.m(e)},t.requestFormReset=function(e){a.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.0"},46830:(e,t,n)=>{"use strict";n.d(t,{mN:()=>_,AH:()=>c,W3:()=>C,Ec:()=>A,iz:()=>l});const i=globalThis,r=i.ShadowRoot&&(void 0===i.ShadyCSS||i.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s=Symbol(),a=new WeakMap;class o{constructor(e,t,n){if(this._$cssResult$=!0,n!==s)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(r&&void 0===e){const n=void 0!==t&&1===t.length;n&&(e=a.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&a.set(t,e))}return e}toString(){return this.cssText}}const l=e=>new o("string"==typeof e?e:e+"",void 0,s),c=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=1===e.length?e[0]:n.reduce(((t,n,i)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+e[i+1]),e[0]);return new o(r,e,s)},h=(e,t)=>{if(r)e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet));else for(const n of t){const t=document.createElement("style"),r=i.litNonce;void 0!==r&&t.setAttribute("nonce",r),t.textContent=n.cssText,e.appendChild(t)}},u=r?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return l(t)})(e):e,{is:d,defineProperty:p,getOwnPropertyDescriptor:f,getOwnPropertyNames:m,getOwnPropertySymbols:g,getPrototypeOf:v}=Object,y=globalThis,b=y.trustedTypes,w=b?b.emptyScript:"",x=y.reactiveElementPolyfillSupport,E=(e,t)=>e,C={toAttribute(e,t){switch(t){case Boolean:e=e?w:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch(e){n=null}}return n}},A=(e,t)=>!d(e,t),S={attribute:!0,type:String,converter:C,reflect:!1,useDefault:!1,hasChanged:A};Symbol.metadata??=Symbol("metadata"),y.litPropertyMetadata??=new WeakMap;class _ extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S;if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),i=this.getPropertyDescriptor(e,n,t);void 0!==i&&p(this.prototype,e,i)}}static getPropertyDescriptor(e,t,n){const{get:i,set:r}=f(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get:i,set(t){const s=i?.call(this);r?.call(this,t),this.requestUpdate(e,s,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??S}static _$Ei(){if(this.hasOwnProperty(E("elementProperties")))return;const e=v(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(E("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(E("properties"))){const e=this.properties,t=[...m(e),...g(e)];for(const n of t)this.createProperty(n,e[n])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,n]of t)this.elementProperties.set(e,n)}this._$Eh=new Map;for(const[t,n]of this.elementProperties){const e=this._$Eu(t,n);void 0!==e&&this._$Eh.set(e,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(u(e))}else void 0!==e&&t.push(u(e));return t}static _$Eu(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return h(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$ET(e,t){const n=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,n);if(void 0!==i&&!0===n.reflect){const r=(void 0!==n.converter?.toAttribute?n.converter:C).toAttribute(t,n.type);this._$Em=e,null==r?this.removeAttribute(i):this.setAttribute(i,r),this._$Em=null}}_$AK(e,t){const n=this.constructor,i=n._$Eh.get(e);if(void 0!==i&&this._$Em!==i){const e=n.getPropertyOptions(i),r="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:C;this._$Em=i,this[i]=r.fromAttribute(t,e.type)??this._$Ej?.get(i)??null,this._$Em=null}}requestUpdate(e,t,n){if(void 0!==e){const i=this.constructor,r=this[e];if(n??=i.getPropertyOptions(e),!((n.hasChanged??A)(r,t)||n.useDefault&&n.reflect&&r===this._$Ej?.get(e)&&!this.hasAttribute(i._$Eu(e,n))))return;this.C(e,t,n)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,n,i){let{useDefault:r,reflect:s,wrapped:a}=n;r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,i??t??this[e]),!0!==a||void 0!==i)||(this._$AL.has(e)||(this.hasUpdated||r||(t=void 0),this._$AL.set(e,t)),!0===s&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,n]of e){const{wrapped:e}=n,i=this[t];!0!==e||this._$AL.has(t)||void 0===i||this.C(t,void 0,n,i)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach((e=>e.hostUpdate?.())),this.update(t)):this._$EM()}catch(t){throw e=!1,this._$EM(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach((e=>e.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach((e=>this._$ET(e,this[e]))),this._$EM()}updated(e){}firstUpdated(e){}}_.elementStyles=[],_.shadowRootOptions={mode:"open"},_[E("elementProperties")]=new Map,_[E("finalized")]=new Map,x?.({ReactiveElement:_}),(y.reactiveElementVersions??=[]).push("2.1.0")},47204:(e,t,n)=>{"use strict";n.d(t,{X:()=>v,J:()=>g});var i=n(92770),r=n(19048),s=n(97965),a=n(36220),o=n(73924),l=n(63206),c=n(59052);var h=n(52620),u=n(43479),d=n(2283);const p="/docs/contract/encodeErrorResult";function f(e){const{abi:t,errorName:n,args:i}=e;let r=t[0];if(n){const e=(0,d.iY)({abi:t,args:i,name:n});if(!e)throw new s.yy(n,{docsPath:p});r=e}if("error"!==r.type)throw new s.yy(void 0,{docsPath:p});const a=(0,c.B)(r),l=(0,o.V)(a);let f="0x";if(i&&i.length>0){if(!r.inputs)throw new s.ZP(r.name,{docsPath:p});f=(0,u.h)(r.inputs,i)}return(0,h.aP)([l,f])}const m="/docs/contract/encodeFunctionResult";const g="x-batch-gateway:true";async function v(e){const{data:t,ccipRequest:n}=e,{args:[h]}=function(e){const{abi:t,data:n}=e,i=(0,a.di)(n,0,4),r=t.find((e=>"function"===e.type&&i===(0,o.V)((0,c.B)(e))));if(!r)throw new s.EB(i,{docsPath:"/docs/contract/decodeFunctionData"});return{functionName:r.name,args:"inputs"in r&&r.inputs&&r.inputs.length>0?(0,l.n)(r.inputs,(0,a.di)(n,4)):void 0}}({abi:i.b2,data:t}),p=[],g=[];return await Promise.all(h.map((async(e,t)=>{try{g[t]=await n(e),p[t]=!1}catch(a){p[t]=!0,g[t]="HttpRequestError"===(s=a).name&&s.status?f({abi:i.b2,errorName:"HttpError",args:[s.status,s.shortMessage]}):f({abi:[r.Mc],errorName:"Error",args:["shortMessage"in s?s.shortMessage:s.message]})}var s}))),function(e){const{abi:t,functionName:n,result:i}=e;let r=t[0];if(n){const e=(0,d.iY)({abi:t,name:n});if(!e)throw new s.Iz(n,{docsPath:m});r=e}if("function"!==r.type)throw new s.Iz(void 0,{docsPath:m});if(!r.outputs)throw new s.MR(r.name,{docsPath:m});const a=(()=>{if(0===r.outputs.length)return[];if(1===r.outputs.length)return[i];if(Array.isArray(i))return i;throw new s.dm(i)})();return(0,u.h)(r.outputs,a)}({abi:i.b2,functionName:"query",result:[p,g]})}},48251:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56121);i.__exportStar(n(8951),t),i.__exportStar(n(45746),t)},48604:(e,t,n)=>{"use strict";function i(e){let{dir:t="left"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="string"===typeof e?e.replace("0x",""):e,i=0;for(let r=0;r<n.length-1&&"0"===n["left"===t?r:n.length-r-1].toString();r++)i++;return n="left"===t?n.slice(i):n.slice(0,n.length-i),"string"===typeof e?(1===n.length&&"right"===t&&(n=`${n}0`),`0x${n.length%2===1?`0${n}`:n}`):n}n.d(t,{B:()=>i})},48661:(e,t,n)=>{"use strict";n.d(t,{h:()=>a,j:()=>s});const i=e=>JSON.stringify(e,((e,t)=>"bigint"===typeof t?t.toString()+"n":t)),r=e=>{const t=e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(t,((e,t)=>"string"===typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t))};function s(e){if("string"!==typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return r(e)}catch(t){return e}}function a(e){return"string"===typeof e?e:i(e)||""}},49477:(e,t,n)=>{"use strict";n.d(t,{IP:()=>a,T8:()=>r,Ud:()=>s,Ws:()=>i});const i={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types"};function r(e){if(!e)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${e}:connected_connector_id`}const s={setItem(e,t){a()&&void 0!==t&&localStorage.setItem(e,t)},getItem(e){if(a())return localStorage.getItem(e)||void 0},removeItem(e){a()&&localStorage.removeItem(e)},clear(){a()&&localStorage.clear()}};function a(){return"undefined"!==typeof window&&"undefined"!==typeof localStorage}},51738:(e,t,n)=>{"use strict";n.r(t),n.d(t,{afterMain:()=>E,afterRead:()=>b,afterWrite:()=>S,applyStyles:()=>O,arrow:()=>J,auto:()=>o,basePlacements:()=>l,beforeMain:()=>w,beforeRead:()=>v,beforeWrite:()=>C,bottom:()=>r,clippingParents:()=>u,computeStyles:()=>ne,createPopper:()=>De,createPopperBase:()=>Oe,createPopperLite:()=>Le,detectOverflow:()=>ye,end:()=>h,eventListeners:()=>re,flip:()=>be,hide:()=>Ee,left:()=>a,main:()=>x,modifierPhases:()=>_,offset:()=>Ce,placements:()=>g,popper:()=>p,popperGenerator:()=>Ie,popperOffsets:()=>Ae,preventOverflow:()=>Se,read:()=>y,reference:()=>f,right:()=>s,start:()=>c,top:()=>i,variationPlacements:()=>m,viewport:()=>d,write:()=>A});var i="top",r="bottom",s="right",a="left",o="auto",l=[i,r,s,a],c="start",h="end",u="clippingParents",d="viewport",p="popper",f="reference",m=l.reduce((function(e,t){return e.concat([t+"-"+c,t+"-"+h])}),[]),g=[].concat(l,[o]).reduce((function(e,t){return e.concat([t,t+"-"+c,t+"-"+h])}),[]),v="beforeRead",y="read",b="afterRead",w="beforeMain",x="main",E="afterMain",C="beforeWrite",A="write",S="afterWrite",_=[v,y,b,w,x,E,C,A,S];function T(e){return e?(e.nodeName||"").toLowerCase():null}function P(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function M(e){return e instanceof P(e).Element||e instanceof Element}function N(e){return e instanceof P(e).HTMLElement||e instanceof HTMLElement}function I(e){return"undefined"!==typeof ShadowRoot&&(e instanceof P(e).ShadowRoot||e instanceof ShadowRoot)}const O={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},i=t.attributes[e]||{},r=t.elements[e];N(r)&&T(r)&&(Object.assign(r.style,n),Object.keys(i).forEach((function(e){var t=i[e];!1===t?r.removeAttribute(e):r.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var i=t.elements[e],r=t.attributes[e]||{},s=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});N(i)&&T(i)&&(Object.assign(i.style,s),Object.keys(r).forEach((function(e){i.removeAttribute(e)})))}))}},requires:["computeStyles"]};function D(e){return e.split("-")[0]}var L=Math.max,R=Math.min,k=Math.round;function B(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function U(){return!/^((?!chrome|android).)*safari/i.test(B())}function z(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=e.getBoundingClientRect(),r=1,s=1;t&&N(e)&&(r=e.offsetWidth>0&&k(i.width)/e.offsetWidth||1,s=e.offsetHeight>0&&k(i.height)/e.offsetHeight||1);var a=(M(e)?P(e):window).visualViewport,o=!U()&&n,l=(i.left+(o&&a?a.offsetLeft:0))/r,c=(i.top+(o&&a?a.offsetTop:0))/s,h=i.width/r,u=i.height/s;return{width:h,height:u,top:c,right:l+h,bottom:c+u,left:l,x:l,y:c}}function F(e){var t=z(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}function j(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&I(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function V(e){return P(e).getComputedStyle(e)}function H(e){return["table","td","th"].indexOf(T(e))>=0}function W(e){return((M(e)?e.ownerDocument:e.document)||window.document).documentElement}function G(e){return"html"===T(e)?e:e.assignedSlot||e.parentNode||(I(e)?e.host:null)||W(e)}function q(e){return N(e)&&"fixed"!==V(e).position?e.offsetParent:null}function K(e){for(var t=P(e),n=q(e);n&&H(n)&&"static"===V(n).position;)n=q(n);return n&&("html"===T(n)||"body"===T(n)&&"static"===V(n).position)?t:n||function(e){var t=/firefox/i.test(B());if(/Trident/i.test(B())&&N(e)&&"fixed"===V(e).position)return null;var n=G(e);for(I(n)&&(n=n.host);N(n)&&["html","body"].indexOf(T(n))<0;){var i=V(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(e)||t}function Y(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Q(e,t,n){return L(e,R(t,n))}function X(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Z(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}const J={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,o=e.name,c=e.options,h=n.elements.arrow,u=n.modifiersData.popperOffsets,d=D(n.placement),p=Y(d),f=[a,s].indexOf(d)>=0?"height":"width";if(h&&u){var m=function(e,t){return X("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:Z(e,l))}(c.padding,n),g=F(h),v="y"===p?i:a,y="y"===p?r:s,b=n.rects.reference[f]+n.rects.reference[p]-u[p]-n.rects.popper[f],w=u[p]-n.rects.reference[p],x=K(h),E=x?"y"===p?x.clientHeight||0:x.clientWidth||0:0,C=b/2-w/2,A=m[v],S=E-g[f]-m[y],_=E/2-g[f]/2+C,T=Q(A,_,S),P=p;n.modifiersData[o]=((t={})[P]=T,t.centerOffset=T-_,t)}},effect:function(e){var t=e.state,n=e.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!==typeof i||(i=t.elements.popper.querySelector(i)))&&j(t.elements.popper,i)&&(t.elements.arrow=i)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function $(e){return e.split("-")[1]}var ee={top:"auto",right:"auto",bottom:"auto",left:"auto"};function te(e){var t,n=e.popper,o=e.popperRect,l=e.placement,c=e.variation,u=e.offsets,d=e.position,p=e.gpuAcceleration,f=e.adaptive,m=e.roundOffsets,g=e.isFixed,v=u.x,y=void 0===v?0:v,b=u.y,w=void 0===b?0:b,x="function"===typeof m?m({x:y,y:w}):{x:y,y:w};y=x.x,w=x.y;var E=u.hasOwnProperty("x"),C=u.hasOwnProperty("y"),A=a,S=i,_=window;if(f){var T=K(n),M="clientHeight",N="clientWidth";if(T===P(n)&&"static"!==V(T=W(n)).position&&"absolute"===d&&(M="scrollHeight",N="scrollWidth"),l===i||(l===a||l===s)&&c===h)S=r,w-=(g&&T===_&&_.visualViewport?_.visualViewport.height:T[M])-o.height,w*=p?1:-1;if(l===a||(l===i||l===r)&&c===h)A=s,y-=(g&&T===_&&_.visualViewport?_.visualViewport.width:T[N])-o.width,y*=p?1:-1}var I,O=Object.assign({position:d},f&&ee),D=!0===m?function(e,t){var n=e.x,i=e.y,r=t.devicePixelRatio||1;return{x:k(n*r)/r||0,y:k(i*r)/r||0}}({x:y,y:w},P(n)):{x:y,y:w};return y=D.x,w=D.y,p?Object.assign({},O,((I={})[S]=C?"0":"",I[A]=E?"0":"",I.transform=(_.devicePixelRatio||1)<=1?"translate("+y+"px, "+w+"px)":"translate3d("+y+"px, "+w+"px, 0)",I)):Object.assign({},O,((t={})[S]=C?w+"px":"",t[A]=E?y+"px":"",t.transform="",t))}const ne={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,i=n.gpuAcceleration,r=void 0===i||i,s=n.adaptive,a=void 0===s||s,o=n.roundOffsets,l=void 0===o||o,c={placement:D(t.placement),variation:$(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,te(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,te(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var ie={passive:!0};const re={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,i=e.options,r=i.scroll,s=void 0===r||r,a=i.resize,o=void 0===a||a,l=P(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach((function(e){e.addEventListener("scroll",n.update,ie)})),o&&l.addEventListener("resize",n.update,ie),function(){s&&c.forEach((function(e){e.removeEventListener("scroll",n.update,ie)})),o&&l.removeEventListener("resize",n.update,ie)}},data:{}};var se={left:"right",right:"left",bottom:"top",top:"bottom"};function ae(e){return e.replace(/left|right|bottom|top/g,(function(e){return se[e]}))}var oe={start:"end",end:"start"};function le(e){return e.replace(/start|end/g,(function(e){return oe[e]}))}function ce(e){var t=P(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function he(e){return z(W(e)).left+ce(e).scrollLeft}function ue(e){var t=V(e),n=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function de(e){return["html","body","#document"].indexOf(T(e))>=0?e.ownerDocument.body:N(e)&&ue(e)?e:de(G(e))}function pe(e,t){var n;void 0===t&&(t=[]);var i=de(e),r=i===(null==(n=e.ownerDocument)?void 0:n.body),s=P(i),a=r?[s].concat(s.visualViewport||[],ue(i)?i:[]):i,o=t.concat(a);return r?o:o.concat(pe(G(a)))}function fe(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function me(e,t,n){return t===d?fe(function(e,t){var n=P(e),i=W(e),r=n.visualViewport,s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(r){s=r.width,a=r.height;var c=U();(c||!c&&"fixed"===t)&&(o=r.offsetLeft,l=r.offsetTop)}return{width:s,height:a,x:o+he(e),y:l}}(e,n)):M(t)?function(e,t){var n=z(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):fe(function(e){var t,n=W(e),i=ce(e),r=null==(t=e.ownerDocument)?void 0:t.body,s=L(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=L(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),o=-i.scrollLeft+he(e),l=-i.scrollTop;return"rtl"===V(r||n).direction&&(o+=L(n.clientWidth,r?r.clientWidth:0)-s),{width:s,height:a,x:o,y:l}}(W(e)))}function ge(e,t,n,i){var r="clippingParents"===t?function(e){var t=pe(G(e)),n=["absolute","fixed"].indexOf(V(e).position)>=0&&N(e)?K(e):e;return M(n)?t.filter((function(e){return M(e)&&j(e,n)&&"body"!==T(e)})):[]}(e):[].concat(t),s=[].concat(r,[n]),a=s[0],o=s.reduce((function(t,n){var r=me(e,n,i);return t.top=L(r.top,t.top),t.right=R(r.right,t.right),t.bottom=R(r.bottom,t.bottom),t.left=L(r.left,t.left),t}),me(e,a,i));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function ve(e){var t,n=e.reference,o=e.element,l=e.placement,u=l?D(l):null,d=l?$(l):null,p=n.x+n.width/2-o.width/2,f=n.y+n.height/2-o.height/2;switch(u){case i:t={x:p,y:n.y-o.height};break;case r:t={x:p,y:n.y+n.height};break;case s:t={x:n.x+n.width,y:f};break;case a:t={x:n.x-o.width,y:f};break;default:t={x:n.x,y:n.y}}var m=u?Y(u):null;if(null!=m){var g="y"===m?"height":"width";switch(d){case c:t[m]=t[m]-(n[g]/2-o[g]/2);break;case h:t[m]=t[m]+(n[g]/2-o[g]/2)}}return t}function ye(e,t){void 0===t&&(t={});var n=t,a=n.placement,o=void 0===a?e.placement:a,c=n.strategy,h=void 0===c?e.strategy:c,m=n.boundary,g=void 0===m?u:m,v=n.rootBoundary,y=void 0===v?d:v,b=n.elementContext,w=void 0===b?p:b,x=n.altBoundary,E=void 0!==x&&x,C=n.padding,A=void 0===C?0:C,S=X("number"!==typeof A?A:Z(A,l)),_=w===p?f:p,T=e.rects.popper,P=e.elements[E?_:w],N=ge(M(P)?P:P.contextElement||W(e.elements.popper),g,y,h),I=z(e.elements.reference),O=ve({reference:I,element:T,strategy:"absolute",placement:o}),D=fe(Object.assign({},T,O)),L=w===p?D:I,R={top:N.top-L.top+S.top,bottom:L.bottom-N.bottom+S.bottom,left:N.left-L.left+S.left,right:L.right-N.right+S.right},k=e.modifiersData.offset;if(w===p&&k){var B=k[o];Object.keys(R).forEach((function(e){var t=[s,r].indexOf(e)>=0?1:-1,n=[i,r].indexOf(e)>=0?"y":"x";R[e]+=B[n]*t}))}return R}const be={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,h=e.name;if(!t.modifiersData[h]._skip){for(var u=n.mainAxis,d=void 0===u||u,p=n.altAxis,f=void 0===p||p,v=n.fallbackPlacements,y=n.padding,b=n.boundary,w=n.rootBoundary,x=n.altBoundary,E=n.flipVariations,C=void 0===E||E,A=n.allowedAutoPlacements,S=t.options.placement,_=D(S),T=v||(_===S||!C?[ae(S)]:function(e){if(D(e)===o)return[];var t=ae(e);return[le(e),t,le(t)]}(S)),P=[S].concat(T).reduce((function(e,n){return e.concat(D(n)===o?function(e,t){void 0===t&&(t={});var n=t,i=n.placement,r=n.boundary,s=n.rootBoundary,a=n.padding,o=n.flipVariations,c=n.allowedAutoPlacements,h=void 0===c?g:c,u=$(i),d=u?o?m:m.filter((function(e){return $(e)===u})):l,p=d.filter((function(e){return h.indexOf(e)>=0}));0===p.length&&(p=d);var f=p.reduce((function(t,n){return t[n]=ye(e,{placement:n,boundary:r,rootBoundary:s,padding:a})[D(n)],t}),{});return Object.keys(f).sort((function(e,t){return f[e]-f[t]}))}(t,{placement:n,boundary:b,rootBoundary:w,padding:y,flipVariations:C,allowedAutoPlacements:A}):n)}),[]),M=t.rects.reference,N=t.rects.popper,I=new Map,O=!0,L=P[0],R=0;R<P.length;R++){var k=P[R],B=D(k),U=$(k)===c,z=[i,r].indexOf(B)>=0,F=z?"width":"height",j=ye(t,{placement:k,boundary:b,rootBoundary:w,altBoundary:x,padding:y}),V=z?U?s:a:U?r:i;M[F]>N[F]&&(V=ae(V));var H=ae(V),W=[];if(d&&W.push(j[B]<=0),f&&W.push(j[V]<=0,j[H]<=0),W.every((function(e){return e}))){L=k,O=!1;break}I.set(k,W)}if(O)for(var G=function(e){var t=P.find((function(t){var n=I.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return L=t,"break"},q=C?3:1;q>0;q--){if("break"===G(q))break}t.placement!==L&&(t.modifiersData[h]._skip=!0,t.placement=L,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function we(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function xe(e){return[i,s,r,a].some((function(t){return e[t]>=0}))}const Ee={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,i=t.rects.reference,r=t.rects.popper,s=t.modifiersData.preventOverflow,a=ye(t,{elementContext:"reference"}),o=ye(t,{altBoundary:!0}),l=we(a,i),c=we(o,r,s),h=xe(l),u=xe(c);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:u},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":u})}};const Ce={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,l=void 0===o?[0,0]:o,c=g.reduce((function(e,n){return e[n]=function(e,t,n){var r=D(e),o=[a,i].indexOf(r)>=0?-1:1,l="function"===typeof n?n(Object.assign({},t,{placement:e})):n,c=l[0],h=l[1];return c=c||0,h=(h||0)*o,[a,s].indexOf(r)>=0?{x:h,y:c}:{x:c,y:h}}(n,t.rects,l),e}),{}),h=c[t.placement],u=h.x,d=h.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=d),t.modifiersData[r]=c}};const Ae={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=ve({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};const Se={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,o=e.name,l=n.mainAxis,h=void 0===l||l,u=n.altAxis,d=void 0!==u&&u,p=n.boundary,f=n.rootBoundary,m=n.altBoundary,g=n.padding,v=n.tether,y=void 0===v||v,b=n.tetherOffset,w=void 0===b?0:b,x=ye(t,{boundary:p,rootBoundary:f,padding:g,altBoundary:m}),E=D(t.placement),C=$(t.placement),A=!C,S=Y(E),_="x"===S?"y":"x",T=t.modifiersData.popperOffsets,P=t.rects.reference,M=t.rects.popper,N="function"===typeof w?w(Object.assign({},t.rects,{placement:t.placement})):w,I="number"===typeof N?{mainAxis:N,altAxis:N}:Object.assign({mainAxis:0,altAxis:0},N),O=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,k={x:0,y:0};if(T){if(h){var B,U="y"===S?i:a,z="y"===S?r:s,j="y"===S?"height":"width",V=T[S],H=V+x[U],W=V-x[z],G=y?-M[j]/2:0,q=C===c?P[j]:M[j],X=C===c?-M[j]:-P[j],Z=t.elements.arrow,J=y&&Z?F(Z):{width:0,height:0},ee=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},te=ee[U],ne=ee[z],ie=Q(0,P[j],J[j]),re=A?P[j]/2-G-ie-te-I.mainAxis:q-ie-te-I.mainAxis,se=A?-P[j]/2+G+ie+ne+I.mainAxis:X+ie+ne+I.mainAxis,ae=t.elements.arrow&&K(t.elements.arrow),oe=ae?"y"===S?ae.clientTop||0:ae.clientLeft||0:0,le=null!=(B=null==O?void 0:O[S])?B:0,ce=V+se-le,he=Q(y?R(H,V+re-le-oe):H,V,y?L(W,ce):W);T[S]=he,k[S]=he-V}if(d){var ue,de="x"===S?i:a,pe="x"===S?r:s,fe=T[_],me="y"===_?"height":"width",ge=fe+x[de],ve=fe-x[pe],be=-1!==[i,a].indexOf(E),we=null!=(ue=null==O?void 0:O[_])?ue:0,xe=be?ge:fe-P[me]-M[me]-we+I.altAxis,Ee=be?fe+P[me]+M[me]-we-I.altAxis:ve,Ce=y&&be?function(e,t,n){var i=Q(e,t,n);return i>n?n:i}(xe,fe,Ee):Q(y?xe:ge,fe,y?Ee:ve);T[_]=Ce,k[_]=Ce-fe}t.modifiersData[o]=k}},requiresIfExists:["offset"]};function _e(e,t,n){void 0===n&&(n=!1);var i=N(t),r=N(t)&&function(e){var t=e.getBoundingClientRect(),n=k(t.width)/e.offsetWidth||1,i=k(t.height)/e.offsetHeight||1;return 1!==n||1!==i}(t),s=W(t),a=z(e,r,n),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!n)&&(("body"!==T(t)||ue(s))&&(o=function(e){return e!==P(e)&&N(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:ce(e);var t}(t)),N(t)?((l=z(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=he(s))),{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function Te(e){var t=new Map,n=new Set,i=[];function r(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var i=t.get(e);i&&r(i)}})),i.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||r(e)})),i}function Pe(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}var Me={placement:"bottom",modifiers:[],strategy:"absolute"};function Ne(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"===typeof e.getBoundingClientRect)}))}function Ie(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,i=void 0===n?[]:n,r=t.defaultOptions,s=void 0===r?Me:r;return function(e,t,n){void 0===n&&(n=s);var r={placement:"bottom",orderedModifiers:[],options:Object.assign({},Me,s),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},a=[],o=!1,l={state:r,setOptions:function(n){var o="function"===typeof n?n(r.options):n;c(),r.options=Object.assign({},s,r.options,o),r.scrollParents={reference:M(e)?pe(e):e.contextElement?pe(e.contextElement):[],popper:pe(t)};var h=function(e){var t=Te(e);return _.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(i,r.options.modifiers)));return r.orderedModifiers=h.filter((function(e){return e.enabled})),r.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,i=void 0===n?{}:n,s=e.effect;if("function"===typeof s){var o=s({state:r,name:t,instance:l,options:i}),c=function(){};a.push(o||c)}})),l.update()},forceUpdate:function(){if(!o){var e=r.elements,t=e.reference,n=e.popper;if(Ne(t,n)){r.rects={reference:_e(t,K(n),"fixed"===r.options.strategy),popper:F(n)},r.reset=!1,r.placement=r.options.placement,r.orderedModifiers.forEach((function(e){return r.modifiersData[e.name]=Object.assign({},e.data)}));for(var i=0;i<r.orderedModifiers.length;i++)if(!0!==r.reset){var s=r.orderedModifiers[i],a=s.fn,c=s.options,h=void 0===c?{}:c,u=s.name;"function"===typeof a&&(r=a({state:r,options:h,name:u,instance:l})||r)}else r.reset=!1,i=-1}}},update:Pe((function(){return new Promise((function(e){l.forceUpdate(),e(r)}))})),destroy:function(){c(),o=!0}};if(!Ne(e,t))return l;function c(){a.forEach((function(e){return e()})),a=[]}return l.setOptions(n).then((function(e){!o&&n.onFirstUpdate&&n.onFirstUpdate(e)})),l}}var Oe=Ie(),De=Ie({defaultModifiers:[re,Ae,ne,O,Ce,be,Se,J,Ee]}),Le=Ie({defaultModifiers:[re,Ae,ne,O]})},52461:(e,t,n)=>{"use strict";n.d(t,{Vw:()=>p,Fc:()=>h,Id:()=>d,O8:()=>a,qv:()=>l,po:()=>m,Ow:()=>o,ZJ:()=>u,DH:()=>s,ld:()=>f});const i="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;var r=n(4498);function s(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function a(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function o(e,t){return e<<32-t|e>>>t}const l=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])();function c(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function h(e){for(let t=0;t<e.length;t++)e[t]=c(e[t])}function u(e){return"string"===typeof e&&(e=function(e){if("string"!==typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),(0,r.DO)(e),e}function d(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];(0,r.DO)(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,i=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,i),i+=e.length}return t}class p{clone(){return this._cloneInto()}}function f(e){const t=t=>e().update(u(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(i&&"function"===typeof i.getRandomValues)return i.getRandomValues(new Uint8Array(e));if(i&&"function"===typeof i.randomBytes)return i.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}},52620:(e,t,n)=>{"use strict";function i(e){return"string"===typeof e[0]?r(e):function(e){let t=0;for(const r of e)t+=r.length;const n=new Uint8Array(t);let i=0;for(const r of e)n.set(r,i),i+=r.length;return n}(e)}function r(e){return`0x${e.reduce(((e,t)=>e+t.replace("0x","")),"")}`}n.d(t,{aP:()=>r,xW:()=>i})},52898:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,i,s,a){if("function"!==typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,r,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,h=this._events[o],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,i),!0;case 4:return h.fn.call(h.context,t,i,r),!0;case 5:return h.fn.call(h.context,t,i,r,s),!0;case 6:return h.fn.call(h.context,t,i,r,s,a),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];h.fn.apply(h.context,l)}else{var d,p=h.length;for(c=0;c<p;c++)switch(h[c].once&&this.removeListener(e,h[c].fn,void 0,!0),u){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,t);break;case 3:h[c].fn.call(h[c].context,t,i);break;case 4:h[c].fn.call(h[c].context,t,i,r);break;default:if(!l)for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];h[c].fn.apply(h[c].context,l)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var l=0,c=[],h=o.length;l<h;l++)(o[l].fn!==t||r&&!o[l].once||i&&o[l].context!==i)&&c.push(o[l]);c.length?this._events[s]=1===c.length?c[0]:c:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o},56121:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__assign:()=>s,__asyncDelegator:()=>w,__asyncGenerator:()=>b,__asyncValues:()=>x,__await:()=>y,__awaiter:()=>h,__classPrivateFieldGet:()=>S,__classPrivateFieldSet:()=>_,__createBinding:()=>d,__decorate:()=>o,__exportStar:()=>p,__extends:()=>r,__generator:()=>u,__importDefault:()=>A,__importStar:()=>C,__makeTemplateObject:()=>E,__metadata:()=>c,__param:()=>l,__read:()=>m,__rest:()=>a,__spread:()=>g,__spreadArrays:()=>v,__values:()=>f});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)};function r(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s.apply(this,arguments)};function a(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function o(e,t,n,i){var r,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(a=(s<3?r(a):s>3?r(t,n,a):r(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a}function l(e,t){return function(n,i){t(n,i,e)}}function c(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{l(i.next(e))}catch(t){s(t)}}function o(e){try{l(i.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))}function u(e,t){var n,i,r,s,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(o){s=[6,o],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}function d(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}function p(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])}function f(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)a.push(i.value)}catch(o){r={error:o}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,r++)i[r]=s[a];return i}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function b(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){s.push([e,t,n,i])>1||o(e,t)}))})}function o(e,t){try{(n=r[e](t)).value instanceof y?Promise.resolve(n.value.v).then(l,c):h(s[0][2],n)}catch(i){h(s[0][3],i)}var n}function l(e){o("next",e)}function c(e){o("throw",e)}function h(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}}function w(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:y(e[i](t)),done:"return"===i}:r?r(t):t}:r}}function x(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function A(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function _(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}},56844:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});class i extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const e=this.keys().next().value;e&&this.delete(e)}return this}}},59052:(e,t,n)=>{"use strict";n.d(t,{A:()=>s,B:()=>r});var i=n(97965);function r(e){let{includeName:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!==e.type&&"event"!==e.type&&"error"!==e.type)throw new i.d_(e.type);return`${e.name}(${s(e.inputs,{includeName:t})})`}function s(e){let{includeName:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?e.map((e=>function(e,t){let{includeName:n}=t;if(e.type.startsWith("tuple"))return`(${s(e.components,{includeName:n})})${e.type.slice(5)}`;return e.type+(n&&e.name?` ${e.name}`:"")}(e,{includeName:t}))).join(t?", ":","):""}},59979:(e,t,n)=>{"use strict";n.d(t,{OH:()=>r,Vl:()=>o,gS:()=>s,hy:()=>i,s1:()=>a});const i=("undefined"!==typeof process?{NODE_ENV:"production",PUBLIC_URL:"/build",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PROJECT_ID:"bb8edcd28daf7c13ce0a49cafab2782d"}.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||"https://secure.walletconnect.org/sdk",r=("undefined"!==typeof process?{NODE_ENV:"production",PUBLIC_URL:"/build",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PROJECT_ID:"bb8edcd28daf7c13ce0a49cafab2782d"}.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",s=("undefined"!==typeof process?{NODE_ENV:"production",PUBLIC_URL:"/build",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PROJECT_ID:"bb8edcd28daf7c13ce0a49cafab2782d"}.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",a={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},o={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}}},60392:(e,t,n)=>{"use strict";n.d(t,{C:()=>o});var i=n(15977);var r,s,a=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)};class o extends Error{get docsBaseUrl(){return"https://wagmi.sh/core"}get version(){return`@wagmi/core@${i.r}`}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),r.add(this),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiCoreError"});const n=t.cause instanceof o?t.cause.details:t.cause?.message?t.cause.message:t.details,i=t.cause instanceof o&&t.cause.docsPath||t.docsPath;this.message=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${this.docsBaseUrl}${i}.html${t.docsSlug?`#${t.docsSlug}`:""}`]:[],...n?[`Details: ${n}`]:[],`Version: ${this.version}`].join("\n"),t.cause&&(this.cause=t.cause),this.details=n,this.docsPath=i,this.metaMessages=t.metaMessages,this.shortMessage=e}walk(e){return a(this,r,"m",s).call(this,this,e)}}r=new WeakSet,s=function e(t,n){return n?.(t)?t:t.cause?a(this,r,"m",e).call(this,t.cause,n):t}},60446:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,i="millisecond",r="second",s="minute",a="hour",o="day",l="week",c="month",h="quarter",u="year",d="date",p="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},v=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},y={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),i=Math.floor(n/60),r=n%60;return(t<=0?"+":"-")+v(i,2,"0")+":"+v(r,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var i=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(i,c),s=n-r<0,a=t.clone().add(i+(s?-1:1),c);return+(-(i+(n-r)/(s?r-a:a-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:l,d:o,D:d,h:a,m:s,s:r,ms:i,Q:h}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",w={};w[b]=g;var x="$isDayjsObject",E=function(e){return e instanceof _||!(!e||!e[x])},C=function e(t,n,i){var r;if(!t)return b;if("string"==typeof t){var s=t.toLowerCase();w[s]&&(r=s),n&&(w[s]=n,r=s);var a=t.split("-");if(!r&&a.length>1)return e(a[0])}else{var o=t.name;w[o]=t,r=o}return!i&&r&&(b=r),r||!i&&b},A=function(e,t){if(E(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new _(n)},S=y;S.l=C,S.i=E,S.w=function(e,t){return A(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var _=function(){function g(e){this.$L=C(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[x]=!0}var v=g.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(S.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(f);if(i){var r=i[2]-1||0,s=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)):new Date(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return S},v.isValid=function(){return!(this.$d.toString()===p)},v.isSame=function(e,t){var n=A(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return A(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<A(e)},v.$g=function(e,t,n){return S.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,i=!!S.u(t)||t,h=S.p(e),p=function(e,t){var r=S.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return i?r:r.endOf(o)},f=function(e,t){return S.w(n.toDate()[e].apply(n.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(h){case u:return i?p(1,0):p(31,11);case c:return i?p(1,g):p(0,g+1);case l:var b=this.$locale().weekStart||0,w=(m<b?m+7:m)-b;return p(i?v-w:v+(6-w),g);case o:case d:return f(y+"Hours",0);case a:return f(y+"Minutes",1);case s:return f(y+"Seconds",2);case r:return f(y+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,l=S.p(e),h="set"+(this.$u?"UTC":""),p=(n={},n[o]=h+"Date",n[d]=h+"Date",n[c]=h+"Month",n[u]=h+"FullYear",n[a]=h+"Hours",n[s]=h+"Minutes",n[r]=h+"Seconds",n[i]=h+"Milliseconds",n)[l],f=l===o?this.$D+(t-this.$W):t;if(l===c||l===u){var m=this.clone().set(d,1);m.$d[p](f),m.init(),this.$d=m.set(d,Math.min(this.$D,m.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[S.p(e)]()},v.add=function(i,h){var d,p=this;i=Number(i);var f=S.p(h),m=function(e){var t=A(p);return S.w(t.date(t.date()+Math.round(e*i)),p)};if(f===c)return this.set(c,this.$M+i);if(f===u)return this.set(u,this.$y+i);if(f===o)return m(1);if(f===l)return m(7);var g=(d={},d[s]=t,d[a]=n,d[r]=e,d)[f]||1,v=this.$d.getTime()+i*g;return S.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||p;var i=e||"YYYY-MM-DDTHH:mm:ssZ",r=S.z(this),s=this.$H,a=this.$m,o=this.$M,l=n.weekdays,c=n.months,h=n.meridiem,u=function(e,n,r,s){return e&&(e[n]||e(t,i))||r[n].slice(0,s)},d=function(e){return S.s(s%12||12,e,"0")},f=h||function(e,t,n){var i=e<12?"AM":"PM";return n?i.toLowerCase():i};return i.replace(m,(function(e,i){return i||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return S.s(t.$y,4,"0");case"M":return o+1;case"MM":return S.s(o+1,2,"0");case"MMM":return u(n.monthsShort,o,c,3);case"MMMM":return u(c,o);case"D":return t.$D;case"DD":return S.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return u(n.weekdaysMin,t.$W,l,2);case"ddd":return u(n.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(s);case"HH":return S.s(s,2,"0");case"h":return d(1);case"hh":return d(2);case"a":return f(s,a,!0);case"A":return f(s,a,!1);case"m":return String(a);case"mm":return S.s(a,2,"0");case"s":return String(t.$s);case"ss":return S.s(t.$s,2,"0");case"SSS":return S.s(t.$ms,3,"0");case"Z":return r}return null}(e)||r.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(i,d,p){var f,m=this,g=S.p(d),v=A(i),y=(v.utcOffset()-this.utcOffset())*t,b=this-v,w=function(){return S.m(m,v)};switch(g){case u:f=w()/12;break;case c:f=w();break;case h:f=w()/3;break;case l:f=(b-y)/6048e5;break;case o:f=(b-y)/864e5;break;case a:f=b/n;break;case s:f=b/t;break;case r:f=b/e;break;default:f=b}return p?f:S.a(f)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return w[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),i=C(e,t,!0);return i&&(n.$L=i),n},v.clone=function(){return S.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),T=_.prototype;return A.prototype=T,[["$ms",i],["$s",r],["$m",s],["$H",a],["$W",o],["$M",c],["$y",u],["$D",d]].forEach((function(e){T[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),A.extend=function(e,t){return e.$i||(e(t,_,A),e.$i=!0),A},A.locale=C,A.isDayjs=E,A.unix=function(e){return A(1e3*e)},A.en=w[b],A.Ls=w,A.p={},A}()},60473:(e,t,n)=>{"use strict";n.d(t,{sc:()=>u});var i=n(108),r=n(90464);function s(e,t,n){return e&t^e&n^t&n}class a extends r.Vw{constructor(e,t,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=(0,r.O8)(this.buffer)}update(e){(0,i.CC)(this);const{view:t,buffer:n,blockLen:s}=this,a=(e=(0,r.ZJ)(e)).length;for(let i=0;i<a;){const o=Math.min(s-this.pos,a-i);if(o!==s)n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===s&&(this.process(t,0),this.pos=0);else{const t=(0,r.O8)(e);for(;s<=a-i;i+=s)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,i.CC)(this),(0,i.Ht)(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:a}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let i=o;i<s;i++)t[i]=0;!function(e,t,n,i){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,n,i);const r=BigInt(32),s=BigInt(4294967295),a=Number(n>>r&s),o=Number(n&s),l=i?4:0,c=i?0:4;e.setUint32(t+l,a,i),e.setUint32(t+c,o,i)}(n,s-8,BigInt(8*this.length),a),this.process(n,0);const l=(0,r.O8)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const h=c/4,u=this.get();if(h>u.length)throw new Error("_sha2: outputLen bigger than state");for(let i=0;i<h;i++)l.setUint32(4*i,u[i],a)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:r,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=r,e.destroyed=s,i%t&&e.buffer.set(n),e}}const o=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),l=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint32Array(64);class h extends a{constructor(){super(64,arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,8,!1),this.A=0|l[0],this.B=0|l[1],this.C=0|l[2],this.D=0|l[3],this.E=0|l[4],this.F=0|l[5],this.G=0|l[6],this.H=0|l[7]}get(){const{A:e,B:t,C:n,D:i,E:r,F:s,G:a,H:o}=this;return[e,t,n,i,r,s,a,o]}set(e,t,n,i,r,s,a,o){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|i,this.E=0|r,this.F=0|s,this.G=0|a,this.H=0|o}process(e,t){for(let r=0;r<16;r++,t+=4)c[r]=e.getUint32(t,!1);for(let s=16;s<64;s++){const e=c[s-15],t=c[s-2],n=(0,r.Ow)(e,7)^(0,r.Ow)(e,18)^e>>>3,i=(0,r.Ow)(t,17)^(0,r.Ow)(t,19)^t>>>10;c[s]=i+c[s-7]+n+c[s-16]|0}let{A:n,B:i,C:a,D:l,E:h,F:u,G:d,H:p}=this;for(let m=0;m<64;m++){const e=p+((0,r.Ow)(h,6)^(0,r.Ow)(h,11)^(0,r.Ow)(h,25))+((f=h)&u^~f&d)+o[m]+c[m]|0,t=((0,r.Ow)(n,2)^(0,r.Ow)(n,13)^(0,r.Ow)(n,22))+s(n,i,a)|0;p=d,d=u,u=h,h=l+e|0,l=a,a=i,i=n,n=e+t|0}var f;n=n+this.A|0,i=i+this.B|0,a=a+this.C|0,l=l+this.D|0,h=h+this.E|0,u=u+this.F|0,d=d+this.G|0,p=p+this.H|0,this.set(n,i,a,l,h,u,d,p)}roundClean(){c.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const u=(0,r.ld)((()=>new h))},61139:(e,t,n)=>{"use strict";n.d(t,{I:()=>u});var i=n(38993),r=n(76844),s=n(595),a=n(15814),o=n(73939),l=n(73609),c=n(42661);const h=(0,i.BX)({view:"Connect",history:["Connect"],transactionStack:[]}),u={state:h,subscribeKey:(e,t)=>(0,r.u$)(h,e,t),pushTransactionStack(e){h.transactionStack.push(e)},popTransactionStack(e){const t=h.transactionStack.pop();if(t)if(e)this.goBack(),t?.onCancel?.();else{if(t.goBack)this.goBack();else if(t.replace){const e=h.history.indexOf("ConnectingSiwe");e>0?this.goBackToIndex(e-1):(l.W.close(),h.history=[])}else t.view&&this.reset(t.view);t?.onSuccess?.()}},push(e,t){e!==h.view&&(h.view=e,h.history.push(e),h.data=t)},reset(e,t){h.view=e,h.history=[e],h.data=t},replace(e,t){h.history.at(-1)===e||(h.view=e,h.history[h.history.length-1]=e,h.data=t)},goBack(){const e=!a.W.state.activeCaipAddress&&"ConnectingFarcaster"===this.state.view;if(h.history.length>1&&!h.history.includes("UnsupportedChain")){h.history.pop();const[e]=h.history.slice(-1);e&&(h.view=e)}else l.W.close();h.data?.wallet&&(h.data.wallet=void 0),setTimeout((()=>{if(e){s.U.setFarcasterUrl(void 0,a.W.state.activeChain);const e=o.a.getAuthConnector();e?.provider?.reload();const t=(0,i.P9)(c.H.state);e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,projectId:t.projectId,sdkType:t.sdkType})}}),100)},goBackToIndex(e){if(h.history.length>1){h.history=h.history.slice(0,e+1);const[t]=h.history.slice(-1);t&&(h.view=t)}}}},61198:e=>{"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},61313:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var i=n(97965),r=n(63206),s=n(2283);const a="/docs/contract/decodeFunctionResult";function o(e){const{abi:t,args:n,functionName:o,data:l}=e;let c=t[0];if(o){const e=(0,s.iY)({abi:t,args:n,name:o});if(!e)throw new i.Iz(o,{docsPath:a});c=e}if("function"!==c.type)throw new i.Iz(void 0,{docsPath:a});if(!c.outputs)throw new i.MR(c.name,{docsPath:a});const h=(0,r.n)(c.outputs,l);return h&&h.length>1?h:h&&1===h.length?h[0]:void 0}},61945:(e,t,n)=>{"use strict";n.d(t,{k:()=>d});var i=n(37131),r=n(81064);const s=e=>(0,r.S)((0,i.ZJ)(e));var a=n(28429);const o=/^tuple(?<array>(\[(\d*)\])*)$/;function l(e){let t=e.type;if(o.test(e.type)&&"components"in e){t="(";const n=e.components.length;for(let r=0;r<n;r++){t+=l(e.components[r]),r<n-1&&(t+=", ")}const i=(0,a.Yv)(o,e.type);return t+=`)${i?.array??""}`,l({...e,type:t})}return"indexed"in e&&e.indexed&&(t=`${t} indexed`),e.name?`${t} ${e.name}`:t}function c(e){let t="";const n=e.length;for(let i=0;i<n;i++){t+=l(e[i]),i!==n-1&&(t+=", ")}return t}var h=n(21627);const u=e=>function(e){let t=!0,n="",i=0,r="",s=!1;for(let a=0;a<e.length;a++){const o=e[a];if(["(",")",","].includes(o)&&(t=!0),"("===o&&i++,")"===o&&i--,t)if(0!==i)" "!==o?(r+=o,n+=o):","!==e[a-1]&&","!==n&&",("!==n&&(n="",t=!1);else if(" "===o&&["event","function",""].includes(r))r="";else if(r+=o,")"===o){s=!0;break}}if(!s)throw new h.C("Unable to normalize signature.");return r}((()=>{return"string"===typeof e?e:"function"===(t=e).type?`function ${t.name}(${c(t.inputs)})${t.stateMutability&&"nonpayable"!==t.stateMutability?` ${t.stateMutability}`:""}${t.outputs?.length?` returns (${c(t.outputs)})`:""}`:"event"===t.type?`event ${t.name}(${c(t.inputs)})`:"error"===t.type?`error ${t.name}(${c(t.inputs)})`:"constructor"===t.type?`constructor(${c(t.inputs)})${"payable"===t.stateMutability?" payable":""}`:"fallback"===t.type?"fallback() external"+("payable"===t.stateMutability?" payable":""):"receive() external payable";var t})());function d(e){return t=u(e),s(t);var t}},61990:(e,t,n)=>{"use strict";n.d(t,{T:()=>he});var i=n(28429);const r=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;const s=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;const a=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/;const o=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/;function l(e){return o.test(e)}function c(e){return(0,i.Yv)(o,e)}const h=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/;const u=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/;const d=/^receive\(\) external payable$/;new Set(["memory","indexed","storage","calldata"]);const p=new Set(["indexed"]),f=new Set(["calldata","memory","storage"]);class m extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.cause instanceof m?t.cause.details:t.cause?.message?t.cause.message:t.details,i=t.cause instanceof m&&t.cause.docsPath||t.docsPath;super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: https://abitype.dev${i}`]:[],...n?[`Details: ${n}`]:[],"Version: abitype@1.0.8"].join("\n")),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),t.cause&&(this.cause=t.cause),this.details=n,this.docsPath=i,this.metaMessages=t.metaMessages,this.shortMessage=e}}class g extends m{constructor(e){let{type:t}=e;super("Unknown type.",{metaMessages:[`Type "${t}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}}class v extends m{constructor(e){let{type:t}=e;super("Unknown type.",{metaMessages:[`Type "${t}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}class y extends m{constructor(e){let{param:t}=e;super("Invalid ABI parameter.",{details:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}}class b extends m{constructor(e){let{param:t,name:n}=e;super("Invalid ABI parameter.",{details:t,metaMessages:[`"${n}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}}class w extends m{constructor(e){let{param:t,type:n,modifier:i}=e;super("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${i}" not allowed${n?` in "${n}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}}class x extends m{constructor(e){let{param:t,type:n,modifier:i}=e;super("Invalid ABI parameter.",{details:t,metaMessages:[`Modifier "${i}" not allowed${n?` in "${n}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${i}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}}class E extends m{constructor(e){let{abiParameter:t}=e;super("Invalid ABI parameter.",{details:JSON.stringify(t,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}class C extends m{constructor(e){let{signature:t,type:n}=e;super(`Invalid ${n} signature.`,{details:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}}class A extends m{constructor(e){let{signature:t}=e;super("Unknown signature.",{details:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}}class S extends m{constructor(e){let{signature:t}=e;super("Invalid struct signature.",{details:t,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}class _ extends m{constructor(e){let{type:t}=e;super("Circular reference detected.",{metaMessages:[`Struct "${t}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}class T extends m{constructor(e){let{current:t,depth:n}=e;super("Unbalanced parentheses.",{metaMessages:[`"${t.trim()}" has too many ${n>0?"opening":"closing"} parentheses.`],details:`Depth "${n}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}const P=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]);function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e){return a.test(e)}(e))return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=function(e){return(0,i.Yv)(a,e)}(e);if(!n)throw new C({signature:e,type:"function"});const r=L(n.parameters),s=[],o=r.length;for(let i=0;i<o;i++)s.push(D(r[i],{modifiers:f,structs:t,type:"function"}));const l=[];if(n.returns){const e=L(n.returns),i=e.length;for(let n=0;n<i;n++)l.push(D(e[n],{modifiers:f,structs:t,type:"function"}))}return{name:n.name,type:"function",stateMutability:n.stateMutability??"nonpayable",inputs:s,outputs:l}}(e,t);if(function(e){return s.test(e)}(e))return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=function(e){return(0,i.Yv)(s,e)}(e);if(!n)throw new C({signature:e,type:"event"});const r=L(n.parameters),a=[],o=r.length;for(let i=0;i<o;i++)a.push(D(r[i],{modifiers:p,structs:t,type:"event"}));return{name:n.name,type:"event",inputs:a}}(e,t);if(function(e){return r.test(e)}(e))return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=function(e){return(0,i.Yv)(r,e)}(e);if(!n)throw new C({signature:e,type:"error"});const s=L(n.parameters),a=[],o=s.length;for(let i=0;i<o;i++)a.push(D(s[i],{structs:t,type:"error"}));return{name:n.name,type:"error",inputs:a}}(e,t);if(function(e){return h.test(e)}(e))return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=function(e){return(0,i.Yv)(h,e)}(e);if(!n)throw new C({signature:e,type:"constructor"});const r=L(n.parameters),s=[],a=r.length;for(let i=0;i<a;i++)s.push(D(r[i],{structs:t,type:"constructor"}));return{type:"constructor",stateMutability:n.stateMutability??"nonpayable",inputs:s}}(e,t);if(function(e){return u.test(e)}(e))return function(e){const t=function(e){return(0,i.Yv)(u,e)}(e);if(!t)throw new C({signature:e,type:"fallback"});return{type:"fallback",stateMutability:t.stateMutability??"nonpayable"}}(e);if(function(e){return d.test(e)}(e))return{type:"receive",stateMutability:"payable"};throw new A({signature:e})}const N=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,I=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,O=/^u?int$/;function D(e,t){const n=function(e,t,n){let i="";if(n)for(const r of Object.entries(n)){if(!r)continue;let e="";for(const t of r[1])e+=`[${t.type}${t.name?`:${t.name}`:""}]`;i+=`(${r[0]}{${e}})`}return t?`${t}:${e}${i}`:e}(e,t?.type,t?.structs);if(P.has(n))return P.get(n);const r=i.wj.test(e),s=(0,i.Yv)(r?I:N,e);if(!s)throw new y({param:e});if(s.name&&function(e){return"address"===e||"bool"===e||"function"===e||"string"===e||"tuple"===e||i.BD.test(e)||i.Ge.test(e)||k.test(e)}(s.name))throw new b({param:e,name:s.name});const a=s.name?{name:s.name}:{},o="indexed"===s.modifier?{indexed:!0}:{},l=t?.structs??{};let c,h={};if(r){c="tuple";const e=L(s.type),t=[],n=e.length;for(let i=0;i<n;i++)t.push(D(e[i],{structs:l}));h={components:t}}else if(s.type in l)c="tuple",h={components:l[s.type]};else if(O.test(s.type))c=`${s.type}256`;else if(c=s.type,"struct"!==t?.type&&!R(c))throw new v({type:c});if(s.modifier){if(!t?.modifiers?.has?.(s.modifier))throw new w({param:e,type:t?.type,modifier:s.modifier});if(f.has(s.modifier)&&!function(e,t){return t||"bytes"===e||"string"===e||"tuple"===e}(c,!!s.array))throw new x({param:e,type:t?.type,modifier:s.modifier})}const u={type:`${c}${s.array??""}`,...a,...o,...h};return P.set(n,u),u}function L(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const r=e.trim().length;for(let s=0;s<r;s++){const r=e[s],a=e.slice(s+1);switch(r){case",":return 0===i?L(a,[...t,n.trim()]):L(a,t,`${n}${r}`,i);case"(":return L(a,t,`${n}${r}`,i+1);case")":return L(a,t,`${n}${r}`,i-1);default:return L(a,t,`${n}${r}`,i)}}if(""===n)return t;if(0!==i)throw new T({current:n,depth:i});return t.push(n.trim()),t}function R(e){return"address"===e||"bool"===e||"function"===e||"string"===e||i.BD.test(e)||i.Ge.test(e)}const k=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;const B=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/;function U(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const r=[],s=e.length;for(let a=0;a<s;a++){const s=e[a];if(i.wj.test(s.type))r.push(s);else{const e=(0,i.Yv)(B,s.type);if(!e?.type)throw new E({abiParameter:s});const{array:a,type:o}=e;if(o in t){if(n.has(o))throw new _({type:o});r.push({...s,type:`tuple${a??""}`,components:U(t[o]??[],t,new Set([...n,o]))})}else{if(!R(o))throw new g({type:o});r.push(s)}}}return r}function z(e){const t=function(e){const t={},n=e.length;for(let a=0;a<n;a++){const n=e[a];if(!l(n))continue;const i=c(n);if(!i)throw new C({signature:n,type:"struct"});const r=i.properties.split(";"),s=[],o=r.length;for(let e=0;e<o;e++){const t=r[e].trim();if(!t)continue;const n=D(t,{type:"struct"});s.push(n)}if(!s.length)throw new S({signature:n});t[i.name]=s}const i={},r=Object.entries(t),s=r.length;for(let a=0;a<s;a++){const[e,n]=r[a];i[e]=U(n,t)}return i}(e),n=[],i=e.length;for(let r=0;r<i;r++){const i=e[r];l(i)||n.push(M(i,t))}return n}var F=n(64034),j=n(92770);const V="0x82ad56cb",H="0x608060405234801561001057600080fd5b5060405161018e38038061018e83398101604081905261002f91610124565b6000808351602085016000f59050803b61004857600080fd5b6000808351602085016000855af16040513d6000823e81610067573d81fd5b3d81f35b634e487b7160e01b600052604160045260246000fd5b600082601f83011261009257600080fd5b81516001600160401b038111156100ab576100ab61006b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156100d9576100d961006b565b6040528181528382016020018510156100f157600080fd5b60005b82811015610110576020818601810151838301820152016100f4565b506000918101602001919091529392505050565b6000806040838503121561013757600080fd5b82516001600160401b0381111561014d57600080fd5b61015985828601610081565b602085015190935090506001600160401b0381111561017757600080fd5b61018385828601610081565b915050925092905056fe",W="0x608060405234801561001057600080fd5b506040516102c03803806102c083398101604081905261002f916101e6565b836001600160a01b03163b6000036100e457600080836001600160a01b03168360405161005c9190610270565b6000604051808303816000865af19150503d8060008114610099576040519150601f19603f3d011682016040523d82523d6000602084013e61009e565b606091505b50915091508115806100b857506001600160a01b0386163b155b156100e1578060405163101bb98d60e01b81526004016100d8919061028c565b60405180910390fd5b50505b6000808451602086016000885af16040513d6000823e81610103573d81fd5b3d81f35b80516001600160a01b038116811461011e57600080fd5b919050565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561015457818101518382015260200161013c565b50506000910152565b600082601f83011261016e57600080fd5b81516001600160401b0381111561018757610187610123565b604051601f8201601f19908116603f011681016001600160401b03811182821017156101b5576101b5610123565b6040528181528382016020018510156101cd57600080fd5b6101de826020830160208701610139565b949350505050565b600080600080608085870312156101fc57600080fd5b61020585610107565b60208601519094506001600160401b0381111561022157600080fd5b61022d8782880161015d565b93505061023c60408601610107565b60608601519092506001600160401b0381111561025857600080fd5b6102648782880161015d565b91505092959194509250565b60008251610282818460208701610139565b9190910192915050565b60208152600082518060208401526102ab816040850160208701610139565b601f01601f1916919091016040019291505056fe";var G=n(21627),q=n(6310),K=n(87942),Y=n(61313),Q=n(97965),X=n(52620),Z=n(43479);const J="/docs/contract/encodeDeployData";function $(e){const{abi:t,args:n,bytecode:i}=e;if(!n||0===n.length)return i;const r=t.find((e=>"type"in e&&"constructor"===e.type));if(!r)throw new Q.YW({docsPath:J});if(!("inputs"in r))throw new Q.YF({docsPath:J});if(!r.inputs||0===r.inputs.length)throw new Q.YF({docsPath:J});const s=(0,Z.h)(r.inputs,n);return(0,X.aP)([i,s])}var ee=n(27908),te=n(31898),ne=n(84117),ie=n(12343),re=n(26615);var se=n(41928),ae=n(6812),oe=n(46510),le=n(93692),ce=n(40920);async function he(e,t){const{account:i=e.account,batch:r=Boolean(e.batch?.multicall),blockNumber:s,blockTag:a="latest",accessList:o,blobs:l,code:c,data:h,factory:u,factoryData:d,gas:p,gasPrice:f,maxFeePerBlobGas:m,maxFeePerGas:g,maxPriorityFeePerGas:v,nonce:y,to:b,value:w,stateOverride:x,...E}=t,C=i?(0,F.J)(i):void 0;if(c&&(u||d))throw new G.C("Cannot provide both `code` & `factory`/`factoryData` as parameters.");if(c&&b)throw new G.C("Cannot provide both `code` & `to` as parameters.");const A=c&&h,S=u&&d&&b&&h,_=A||S,T=A?function(e){const{code:t,data:n}=e;return $({abi:z(["constructor(bytes, bytes)"]),bytecode:H,args:[t,n]})}({code:c,data:h}):S?function(e){const{data:t,factory:n,factoryData:i,to:r}=e;return $({abi:z(["constructor(address, bytes, address, bytes)"]),bytecode:W,args:[r,t,n,i]})}({data:h,factory:u,factoryData:d,to:b}):h;try{(0,ce.c)(t);const n=(s?(0,ne.cK)(s):void 0)||a,i=(0,le.yH)(x),c=e.chain?.formatters?.transactionRequest?.format,h=(c||ae.Bv)({...(0,se.o)(E,{format:c}),from:C?.address,accessList:o,blobs:l,data:T,gas:p,gasPrice:f,maxFeePerBlobGas:m,maxFeePerGas:g,maxPriorityFeePerGas:v,nonce:y,to:_?void 0:b,value:w});if(r&&function(e){let{request:t}=e;const{data:n,to:i,...r}=t;return!!n&&(!n.startsWith(V)&&(!!i&&!(Object.values(r).filter((e=>"undefined"!==typeof e)).length>0)))}({request:h})&&!i)try{return await async function(e,t){const{batchSize:n=1024,wait:i=0}="object"===typeof e.batch?.multicall?e.batch.multicall:{},{blockNumber:r,blockTag:s="latest",data:a,multicallAddress:o,to:l}=t;let c=o;if(!c){if(!e.chain)throw new q.YE;c=(0,te.M)({blockNumber:r,chain:e.chain,contract:"multicall3"})}const h=r?(0,ne.cK)(r):void 0,u=h||s,{schedule:d}=(0,oe.u)({id:`${e.uid}.${u}`,wait:i,shouldSplitBatch(e){const t=e.reduce(((e,t)=>{let{data:n}=t;return e+(n.length-2)}),0);return t>2*n},fn:async t=>{const n=t.map((e=>({allowFailure:!0,callData:e.data,target:e.to}))),i=(0,ee.p)({abi:j.v2,args:[n],functionName:"aggregate3"}),r=await e.request({method:"eth_call",params:[{data:i,to:c},u]});return(0,Y.e)({abi:j.v2,args:[n],functionName:"aggregate3",data:r||"0x"})}}),[{returnData:p,success:f}]=await d({data:a,to:l});if(!f)throw new K.$S({data:p});return"0x"===p?{data:void 0}:{data:p}}(e,{...h,blockNumber:s,blockTag:a})}catch(P){if(!(P instanceof q.YE)&&!(P instanceof q.rj))throw P}const u=await e.request({method:"eth_call",params:i?[h,n,i]:[h,n]});return"0x"===u?{data:void 0}:{data:u}}catch(P){const i=function(e){if(!(e instanceof G.C))return;const t=e.walk();return"object"===typeof t?.data?t.data?.data:t.data}(P),{offchainLookup:r,offchainLookupSignature:s}=await n.e(7055).then(n.bind(n,97055));if(!1!==e.ccipRead&&i?.slice(0,10)===s&&b)return{data:await r(e,{data:i,to:b})};if(_&&"0x101bb98d"===i?.slice(0,10))throw new K.Po({factory:u});throw function(e,t){let{docsPath:n,...i}=t;const r=(()=>{const t=(0,re.l)(e,i);return t instanceof ie.RM?e:t})();return new K.zX(r,{docsPath:n,...i})}(P,{...t,account:C,chain:e.chain})}}},62499:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=[{countryNameEn:"Andorra",countryNameLocal:"Andorra",countryCode:"AD",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"ca",officialLanguageNameEn:"Catalan, Valencian",officialLanguageNameLocal:"Catal\xe0, Valenci\xe0",countryCallingCode:"376",areaCodes:[],region:"Europe",flag:"\ud83c\udde6\ud83c\udde9"},{countryNameEn:"Afghanistan",countryNameLocal:"\u062f \u0627\u0641\u063a\u0627\u0646\u0633\u062a\u0627\u0646 \u0627\u0633\u0644\u0627\u0645\u064a \u062f\u0648\u0644\u062a\u062f\u0648\u0644\u062a \u0627\u0633\u0644\u0627\u0645\u06cc \u0627\u0641\u063a\u0627\u0646\u0633\u062a\u0627\u0646, \u062c\u0645\u0647\u0648\u0631\u06cc \u0627\u0633\u0644\u0627\u0645\u06cc \u0627\u0641\u063a\u0627\u0646\u0633\u062a\u0627\u0646",countryCode:"AF",currencyCode:"AFN",currencyNameEn:"Afghan afghani",tinType:"",tinName:"",officialLanguageCode:"fa",officialLanguageNameEn:"Persian",officialLanguageNameLocal:"\u0641\u0627\u0631\u0633\u06cc",countryCallingCode:"93",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udde6\ud83c\uddeb"},{countryNameEn:"Antigua and Barbuda",countryNameLocal:"Antigua and Barbuda",countryCode:"AG",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1268",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde6\ud83c\uddec"},{countryNameEn:"Anguilla",countryNameLocal:"Anguilla",countryCode:"AI",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1264",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde6\ud83c\uddee"},{countryNameEn:"Albania",countryNameLocal:"Shqip\xebria",countryCode:"AL",currencyCode:"ALL",currencyNameEn:"Albanian lek",tinType:"NIPT",tinName:"Numri i Identifikimit p\xebr Personin e Tatuesh\xebm",officialLanguageCode:"sq",officialLanguageNameEn:"Albanian",officialLanguageNameLocal:"Shqip",countryCallingCode:"355",areaCodes:[],region:"Europe",flag:"\ud83c\udde6\ud83c\uddf1"},{countryNameEn:"Armenia",countryNameLocal:"\u0540\u0561\u0575\u0561\u057d\u057f\u0561\u0576",countryCode:"AM",currencyCode:"AMD",currencyNameEn:"Armenian dram",tinType:"",tinName:"",officialLanguageCode:"hy",officialLanguageNameEn:"Armenian",officialLanguageNameLocal:"\u0540\u0561\u0575\u0565\u0580\u0565\u0576",countryCallingCode:"374",areaCodes:[],region:"Europe",flag:"\ud83c\udde6\ud83c\uddf2"},{countryNameEn:"Angola",countryNameLocal:"Angola",countryCode:"AO",currencyCode:"AOA",currencyNameEn:"Angolan kwanza",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugu\xeas",countryCallingCode:"244",areaCodes:[],region:"Africa",flag:"\ud83c\udde6\ud83c\uddf4"},{countryNameEn:"Antarctica",countryNameLocal:"Antarctica, Ant\xe1rtico, Antarctique, \u0410\u043d\u0442\u0430\u0440\u043a\u0442\u0438\u043a\u0435",countryCode:"AQ",currencyCode:"",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"672",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udde6\ud83c\uddf6"},{countryNameEn:"Argentina",countryNameLocal:"Argentina",countryCode:"AR",currencyCode:"ARS",currencyNameEn:"Argentine peso",tinType:"CUIT",tinName:"C\xf3digo \xdanico de Identificaci\xf3n Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"54",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde6\ud83c\uddf7"},{countryNameEn:"American Samoa",countryNameLocal:"American Samoa",countryCode:"AS",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1684",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udde6\ud83c\uddf8"},{countryNameEn:"Austria",countryNameLocal:"\xd6sterreich",countryCode:"AT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"UID",tinName:"Umsatzsteuer-Identifikationsnummer",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"43",areaCodes:[],region:"Europe",flag:"\ud83c\udde6\ud83c\uddf9"},{countryNameEn:"Australia",countryNameLocal:"Australia",countryCode:"AU",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"ABN",tinName:"Australian Business Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"61",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udde6\ud83c\uddfa"},{countryNameEn:"Aruba",countryNameLocal:"Aruba",countryCode:"AW",currencyCode:"AWG",currencyNameEn:"Aruban florin",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"297",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde6\ud83c\uddfc"},{countryNameEn:"\xc5land Islands",countryNameLocal:"\xc5land",countryCode:"AX",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"sv",officialLanguageNameEn:"Swedish",officialLanguageNameLocal:"Svenska",countryCallingCode:"358",areaCodes:[],region:"Europe",flag:"\ud83c\udde6\ud83c\uddfd"},{countryNameEn:"Azerbaijan",countryNameLocal:"Az\u0259rbaycan",countryCode:"AZ",currencyCode:"AZN",currencyNameEn:"Azerbaijani manat",tinType:"",tinName:"",officialLanguageCode:"az",officialLanguageNameEn:"Azerbaijani",officialLanguageNameLocal:"az\u0259rbaycan dili",countryCallingCode:"994",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udde6\ud83c\uddff"},{countryNameEn:"Bosnia and Herzegovina",countryNameLocal:"Bosna i Hercegovina",countryCode:"BA",currencyCode:"BAM",currencyNameEn:"Bosnia and Herzegovina convertible mark",tinType:"",tinName:"",officialLanguageCode:"bs",officialLanguageNameEn:"Bosnian",officialLanguageNameLocal:"bosanski jezik",countryCallingCode:"387",areaCodes:[],region:"Europe",flag:"\ud83c\udde7\ud83c\udde6"},{countryNameEn:"Barbados",countryNameLocal:"Barbados",countryCode:"BB",currencyCode:"BBD",currencyNameEn:"Barbados dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1246",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde7\ud83c\udde7"},{countryNameEn:"Bangladesh",countryNameLocal:"\u0997\u09a3\u09aa\u09cd\u09b0\u099c\u09be\u09a4\u09a8\u09cd\u09a4\u09cd\u09b0\u09c0 \u09ac\u09be\u0982\u09b2\u09be\u09a6\u09c7\u09b6",countryCode:"BD",currencyCode:"BDT",currencyNameEn:"Bangladeshi taka",tinType:"",tinName:"",officialLanguageCode:"bn",officialLanguageNameEn:"Bengali",officialLanguageNameLocal:"\u09ac\u09be\u0982\u09b2\u09be",countryCallingCode:"880",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udde7\ud83c\udde9"},{countryNameEn:"Belgium",countryNameLocal:"Belgi\xeb, Belgique, Belgien",countryCode:"BE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"n\xb0 TVABTW-nr Mwst-nr",tinName:"BTW identificatienummer / Num\xe9ro de TVA",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"32",areaCodes:[],region:"Europe",flag:"\ud83c\udde7\ud83c\uddea"},{countryNameEn:"Burkina Faso",countryNameLocal:"Burkina Faso",countryCode:"BF",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"226",areaCodes:[],region:"Africa",flag:"\ud83c\udde7\ud83c\uddeb"},{countryNameEn:"Bulgaria",countryNameLocal:"\u0411\u044a\u043b\u0433\u0430\u0440\u0438\u044f",countryCode:"BG",currencyCode:"BGN",currencyNameEn:"Bulgarian lev",tinType:"\u0414\u0414\u0421 \u043d\u043e\u043c\u0435\u0440",tinName:"\u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u043e\u043d\u0435\u043d \u043d\u043e\u043c\u0435\u0440 \u043f\u043e \u0414\u0414\u0421",officialLanguageCode:"bg",officialLanguageNameEn:"Bulgarian",officialLanguageNameLocal:"\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438 \u0435\u0437\u0438\u043a",countryCallingCode:"359",areaCodes:[],region:"Europe",flag:"\ud83c\udde7\ud83c\uddec"},{countryNameEn:"Bahrain",countryNameLocal:"\u0627\u0644\u0628\u062d\u0631\u064a\u0646",countryCode:"BH",currencyCode:"BHD",currencyNameEn:"Bahraini dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"973",areaCodes:[],region:"Arab States",flag:"\ud83c\udde7\ud83c\udded"},{countryNameEn:"Burundi",countryNameLocal:"Burundi",countryCode:"BI",currencyCode:"BIF",currencyNameEn:"Burundian franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"257",areaCodes:[],region:"Africa",flag:"\ud83c\udde7\ud83c\uddee"},{countryNameEn:"Benin",countryNameLocal:"B\xe9nin",countryCode:"BJ",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"229",areaCodes:[],region:"Africa",flag:"\ud83c\udde7\ud83c\uddef"},{countryNameEn:"Saint Barth\xe9lemy",countryNameLocal:"Saint-Barth\xe9lemy",countryCode:"BL",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"590",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde7\ud83c\uddf1"},{countryNameEn:"Bermuda",countryNameLocal:"Bermuda",countryCode:"BM",currencyCode:"BMD",currencyNameEn:"Bermudian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1441",areaCodes:[],region:"North America",flag:"\ud83c\udde7\ud83c\uddf2"},{countryNameEn:"Brunei Darussalam",countryNameLocal:"Brunei Darussalam",countryCode:"BN",currencyCode:"BND",currencyNameEn:"Brunei dollar",tinType:"",tinName:"",officialLanguageCode:"ms",officialLanguageNameEn:"Malay",officialLanguageNameLocal:"Bahasa Melayu, \u0628\u0647\u0627\u0633 \u0645\u0644\u0627\u064a\u0648\u200e",countryCallingCode:"673",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udde7\ud83c\uddf3"},{countryNameEn:"Bolivia (Plurinational State of)",countryNameLocal:"Bolivia, Bulibiya, Vol\xedvia, Wuliwya",countryCode:"BO",currencyCode:"BOP",currencyNameEn:"",tinType:"NIT",tinName:"N\xfamero de Identificaci\xf3n Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"591",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde7\ud83c\uddf4"},{countryNameEn:"Bonaire, Sint Eustatius and Saba",countryNameLocal:"Caribisch Nederland",countryCode:"BQ",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"5997",areaCodes:[],region:"Unknown",flag:"\ud83c\udde7\ud83c\uddf6"},{countryNameEn:"Brazil",countryNameLocal:"Brasil",countryCode:"BR",currencyCode:"BRL",currencyNameEn:"Brazilian real",tinType:"CNPJ",tinName:"Cadastro Nacional de Pessoa Jur\xeddica",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugu\xeas",countryCallingCode:"55",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde7\ud83c\uddf7"},{countryNameEn:"Bhutan",countryNameLocal:"\u0f60\u0f56\u0fb2\u0f74\u0f42\u0f0b\u0f61\u0f74\u0f63",countryCode:"BT",currencyCode:"BTN",currencyNameEn:"Bhutanese ngultrum",tinType:"",tinName:"",officialLanguageCode:"dz",officialLanguageNameEn:"Dzongkha",officialLanguageNameLocal:"\u0f62\u0fab\u0f7c\u0f44\u0f0b\u0f41",countryCallingCode:"975",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udde7\ud83c\uddf9"},{countryNameEn:"Bouvet Island",countryNameLocal:"Bouvet\xf8ya",countryCode:"BV",currencyCode:"NOK",currencyNameEn:"Norwegian krone",tinType:"",tinName:"",officialLanguageCode:"no",officialLanguageNameEn:"Norwegian",officialLanguageNameLocal:"Norsk",countryCallingCode:"47",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde7\ud83c\uddfb"},{countryNameEn:"Botswana",countryNameLocal:"Botswana",countryCode:"BW",currencyCode:"BWP",currencyNameEn:"Botswana pula",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"267",areaCodes:[],region:"Africa",flag:"\ud83c\udde7\ud83c\uddfc"},{countryNameEn:"Belarus",countryNameLocal:"\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u044c",countryCode:"BY",currencyCode:"BYR",currencyNameEn:"",tinType:"\u0423\u041d\u041f (UNP)",tinName:"\u0423\u0447\u0435\u0442\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u043f\u043b\u0430\u0442\u0435\u043b\u044c\u0449\u0438\u043a\u0430",officialLanguageCode:"be",officialLanguageNameEn:"Belarusian",officialLanguageNameLocal:"\u0431\u0435\u043b\u0430\u0440\u0443\u0441\u043a\u0430\u044f \u043c\u043e\u0432\u0430",countryCallingCode:"375",areaCodes:[],region:"Europe",flag:"\ud83c\udde7\ud83c\uddfe"},{countryNameEn:"Belize",countryNameLocal:"Belize",countryCode:"BZ",currencyCode:"BZD",currencyNameEn:"Belize dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"501",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde7\ud83c\uddff"},{countryNameEn:"Canada",countryNameLocal:"Canada",countryCode:"CA",currencyCode:"CAD",currencyNameEn:"Canadian dollar",tinType:"BN / NE",tinName:"Business Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:["403","587","780","825","236","250","604","672","778","204","431","506","709","782","902","226","249","289","343","365","416","437","519","548","613","647","705","807","905","367","418","438","450","514","579","581","819","873","306","639","867"],region:"North America",flag:"\ud83c\udde8\ud83c\udde6"},{countryNameEn:"Switzerland",countryNameLocal:"Schweiz, Suisse, Svizzera, Svizra",countryCode:"CH",currencyCode:"CHF",currencyNameEn:"Swiss franc",tinType:"MWST/TVA/IVA",tinName:"Mehrwertsteuernummer",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"41",areaCodes:[],region:"Europe",flag:"\ud83c\udde8\ud83c\udded"},{countryNameEn:"C\xf4te d'Ivoire",countryNameLocal:"C\xf4te d'Ivoire",countryCode:"CI",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"225",areaCodes:[],region:"Africa",flag:"\ud83c\udde8\ud83c\uddee"},{countryNameEn:"Chile",countryNameLocal:"Chile",countryCode:"CL",currencyCode:"CLP",currencyNameEn:"Chilean peso",tinType:"RUT",tinName:"Rol \xdanico Tributario",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"56",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde8\ud83c\uddf1"},{countryNameEn:"Cameroon",countryNameLocal:"Cameroun, Cameroon",countryCode:"CM",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"237",areaCodes:[],region:"Africa",flag:"\ud83c\udde8\ud83c\uddf2"},{countryNameEn:"China",countryNameLocal:"\u4e2d\u56fd",countryCode:"CN",currencyCode:"CNY",currencyNameEn:"Renminbi (Chinese) yuan",tinType:"",tinName:"",officialLanguageCode:"zh-hans",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"86",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udde8\ud83c\uddf3"},{countryNameEn:"Colombia",countryNameLocal:"Colombia",countryCode:"CO",currencyCode:"COP",currencyNameEn:"Colombian peso",tinType:"NIT",tinName:"N\xfamero De Identificaci\xf3n Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"57",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde8\ud83c\uddf4"},{countryNameEn:"Costa Rica",countryNameLocal:"Costa Rica",countryCode:"CR",currencyCode:"CRC",currencyNameEn:"Costa Rican colon",tinType:"",tinName:"C\xe9dula Jur\xeddica",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"506",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde8\ud83c\uddf7"},{countryNameEn:"Cuba",countryNameLocal:"Cuba",countryCode:"CU",currencyCode:"CUC",currencyNameEn:"Cuban convertible peso",tinType:"",tinName:"",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"53",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde8\ud83c\uddfa"},{countryNameEn:"Cabo Verde",countryNameLocal:"Cabo Verde",countryCode:"CV",currencyCode:"CVE",currencyNameEn:"Cape Verdean escudo",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugu\xeas",countryCallingCode:"238",areaCodes:[],region:"Africa",flag:"\ud83c\udde8\ud83c\uddfb"},{countryNameEn:"Cura\xe7ao",countryNameLocal:"Cura\xe7ao",countryCode:"CW",currencyCode:"ANG",currencyNameEn:"Netherlands Antillean guilder",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"599",areaCodes:[],region:"Unknown",flag:"\ud83c\udde8\ud83c\uddfc"},{countryNameEn:"Christmas Island",countryNameLocal:"Christmas Island",countryCode:"CX",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"61",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udde8\ud83c\uddfd"},{countryNameEn:"Cyprus",countryNameLocal:"\u039a\u03cd\u03c0\u03c1\u03bf\u03c2, Kibris",countryCode:"CY",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"\u03a6\u03a0\u0391",tinName:"\u0391\u03c1\u03b9\u03b8\u03bc\u03cc\u03c2 \u0395\u03b3\u03b3\u03c1\u03b1\u03c6\u03ae\u03c2 \u03a6.\u03a0.\u0391.",officialLanguageCode:"el",officialLanguageNameEn:"Greek, Modern (1453-)",officialLanguageNameLocal:"\u03b5\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",countryCallingCode:"357",areaCodes:[],region:"Europe",flag:"\ud83c\udde8\ud83c\uddfe"},{countryNameEn:"Germany",countryNameLocal:"Deutschland",countryCode:"DE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"USt-IdNr.",tinName:"Umsatzsteuer-Identifikationsnummer",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"49",areaCodes:[],region:"Europe",flag:"\ud83c\udde9\ud83c\uddea"},{countryNameEn:"Djibouti",countryNameLocal:"Djibouti, \u062c\u064a\u0628\u0648\u062a\u064a, Jabuuti, Gabuutih",countryCode:"DJ",currencyCode:"DJF",currencyNameEn:"Djiboutian franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"253",areaCodes:[],region:"Arab States",flag:"\ud83c\udde9\ud83c\uddef"},{countryNameEn:"Denmark",countryNameLocal:"Danmark",countryCode:"DK",currencyCode:"DKK",currencyNameEn:"Danish krone",tinType:"CVR",tinName:"Momsregistreringsnummer",officialLanguageCode:"da",officialLanguageNameEn:"Danish",officialLanguageNameLocal:"dansk",countryCallingCode:"45",areaCodes:[],region:"Europe",flag:"\ud83c\udde9\ud83c\uddf0"},{countryNameEn:"Dominica",countryNameLocal:"Dominica",countryCode:"DM",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"767",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde9\ud83c\uddf2"},{countryNameEn:"Algeria",countryNameLocal:"\u0627\u0644\u062c\u0632\u0627\u0626\u0631",countryCode:"DZ",currencyCode:"DZD",currencyNameEn:"Algerian dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"213",areaCodes:[],region:"Arab States",flag:"\ud83c\udde9\ud83c\uddff"},{countryNameEn:"Ecuador",countryNameLocal:"Ecuador",countryCode:"EC",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"RUC",tinName:"N\xfamero de Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"593",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddea\ud83c\udde8"},{countryNameEn:"Estonia",countryNameLocal:"Eesti",countryCode:"EE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"KMKR",tinName:"K\xe4ibemaksukohustuslase number",officialLanguageCode:"et",officialLanguageNameEn:"Estonian",officialLanguageNameLocal:"eesti, eesti keel",countryCallingCode:"372",areaCodes:[],region:"Europe",flag:"\ud83c\uddea\ud83c\uddea"},{countryNameEn:"Egypt",countryNameLocal:"\u0645\u0635\u0631",countryCode:"EG",currencyCode:"EGP",currencyNameEn:"Egyptian pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"20",areaCodes:[],region:"Arab States",flag:"\ud83c\uddea\ud83c\uddec"},{countryNameEn:"Western Sahara",countryNameLocal:"Sahara Occidental",countryCode:"EH",currencyCode:"MAD",currencyNameEn:"Moroccan dirham",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"212",areaCodes:[],region:"Africa",flag:"\ud83c\uddea\ud83c\udded"},{countryNameEn:"Eritrea",countryNameLocal:"\u12a4\u122d\u1275\u122b, \u0625\u0631\u062a\u0631\u064a\u0627, Eritrea",countryCode:"ER",currencyCode:"ERN",currencyNameEn:"Eritrean nakfa",tinType:"",tinName:"",officialLanguageCode:"ti",officialLanguageNameEn:"Tigrinya",officialLanguageNameLocal:"\u1275\u130d\u122d\u129b",countryCallingCode:"291",areaCodes:[],region:"Africa",flag:"\ud83c\uddea\ud83c\uddf7"},{countryNameEn:"Spain",countryNameLocal:"Espa\xf1a",countryCode:"ES",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"NIF (CIF)",tinName:"N\xfamero de Identificaci\xf3n Fiscal (formerly named C\xf3digo de Identificaci\xf3n Fiscal)",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"34",areaCodes:[],region:"Europe",flag:"\ud83c\uddea\ud83c\uddf8"},{countryNameEn:"Ethiopia",countryNameLocal:"\u12a2\u1275\u12ee\u1335\u12eb, Itoophiyaa",countryCode:"ET",currencyCode:"ETB",currencyNameEn:"Ethiopian birr",tinType:"",tinName:"",officialLanguageCode:"am",officialLanguageNameEn:"Amharic",officialLanguageNameLocal:"\u12a0\u121b\u122d\u129b",countryCallingCode:"251",areaCodes:[],region:"Africa",flag:"\ud83c\uddea\ud83c\uddf9"},{countryNameEn:"Finland",countryNameLocal:"Suomi",countryCode:"FI",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"ALV nro",tinName:"Arvonlis\xe4veronumero",officialLanguageCode:"fi",officialLanguageNameEn:"Finnish",officialLanguageNameLocal:"suomi, suomen kieli",countryCallingCode:"358",areaCodes:[],region:"Europe",flag:"\ud83c\uddeb\ud83c\uddee"},{countryNameEn:"Fiji",countryNameLocal:"Fiji",countryCode:"FJ",currencyCode:"FJD",currencyNameEn:"Fiji dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"679",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddeb\ud83c\uddef"},{countryNameEn:"Micronesia (Federated States of)",countryNameLocal:"Micronesia",countryCode:"FM",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"691",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddeb\ud83c\uddf2"},{countryNameEn:"France",countryNameLocal:"France",countryCode:"FR",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"n\xb0 TVA",tinName:"Num\xe9ro d'identification \xe0 la taxe sur la valeur ajout\xe9e / Num\xe9ro de TVA intracommunautaire",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"33",areaCodes:[],region:"Europe",flag:"\ud83c\uddeb\ud83c\uddf7"},{countryNameEn:"Gabon",countryNameLocal:"Gabon",countryCode:"GA",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"241",areaCodes:[],region:"Africa",flag:"\ud83c\uddec\ud83c\udde6"},{countryNameEn:"Grenada",countryNameLocal:"Grenada",countryCode:"GD",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1473",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddec\ud83c\udde9"},{countryNameEn:"Georgia",countryNameLocal:"\u10e1\u10d0\u10e5\u10d0\u10e0\u10d7\u10d5\u10d4\u10da\u10dd",countryCode:"GE",currencyCode:"GEL",currencyNameEn:"Georgian lari",tinType:"",tinName:"",officialLanguageCode:"ka",officialLanguageNameEn:"Georgian",officialLanguageNameLocal:"\u10e5\u10d0\u10e0\u10d7\u10e3\u10da\u10d8",countryCallingCode:"995",areaCodes:[],region:"Europe",flag:"\ud83c\uddec\ud83c\uddea"},{countryNameEn:"French Guiana",countryNameLocal:"Guyane fran\xe7aise",countryCode:"GF",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"594",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddec\ud83c\uddeb"},{countryNameEn:"Guernsey",countryNameLocal:"Guernsey",countryCode:"GG",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:"\ud83c\uddec\ud83c\uddec"},{countryNameEn:"Ghana",countryNameLocal:"Ghana",countryCode:"GH",currencyCode:"GHS",currencyNameEn:"Ghanaian cedi",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"233",areaCodes:[],region:"Africa",flag:"\ud83c\uddec\ud83c\udded"},{countryNameEn:"Gibraltar",countryNameLocal:"Gibraltar",countryCode:"GI",currencyCode:"GIP",currencyNameEn:"Gibraltar pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"350",areaCodes:[],region:"Europe",flag:"\ud83c\uddec\ud83c\uddee"},{countryNameEn:"Greenland",countryNameLocal:"Kalaallit Nunaat, Gr\xf8nland",countryCode:"GL",currencyCode:"DKK",currencyNameEn:"Danish krone",tinType:"",tinName:"",officialLanguageCode:"kl",officialLanguageNameEn:"Kalaallisut, Greenlandic",officialLanguageNameLocal:"kalaallisut, kalaallit oqaasii",countryCallingCode:"299",areaCodes:[],region:"Europe",flag:"\ud83c\uddec\ud83c\uddf1"},{countryNameEn:"Guinea",countryNameLocal:"Guin\xe9e",countryCode:"GN",currencyCode:"GNF",currencyNameEn:"Guinean franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"224",areaCodes:[],region:"Africa",flag:"\ud83c\uddec\ud83c\uddf3"},{countryNameEn:"Guadeloupe",countryNameLocal:"Guadeloupe",countryCode:"GP",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"590",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddec\ud83c\uddf5"},{countryNameEn:"Equatorial Guinea",countryNameLocal:"Guiena ecuatorial, Guin\xe9e \xe9quatoriale, Guin\xe9 Equatorial",countryCode:"GQ",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"240",areaCodes:[],region:"Africa",flag:"\ud83c\uddec\ud83c\uddf6"},{countryNameEn:"Greece",countryNameLocal:"\u0395\u03bb\u03bb\u03ac\u03b4\u03b1",countryCode:"GR",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"el",officialLanguageNameEn:"Greek, Modern (1453-)",officialLanguageNameLocal:"\u03b5\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",countryCallingCode:"30",areaCodes:[],region:"Europe",flag:"\ud83c\uddec\ud83c\uddf7"},{countryNameEn:"South Georgia and the South Sandwich Islands",countryNameLocal:"South Georgia and the South Sandwich Islands",countryCode:"GS",currencyCode:"",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"500",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddec\ud83c\uddf8"},{countryNameEn:"Guatemala",countryNameLocal:"Guatemala",countryCode:"GT",currencyCode:"GTQ",currencyNameEn:"Guatemalan quetzal",tinType:"NIT",tinName:"N\xfamero de Identificaci\xf3n Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"502",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddec\ud83c\uddf9"},{countryNameEn:"Guam",countryNameLocal:"Guam, Gu\xe5h\xe5n",countryCode:"GU",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddec\ud83c\uddfa"},{countryNameEn:"Guinea-Bissau",countryNameLocal:"Guin\xe9-Bissau",countryCode:"GW",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugu\xeas",countryCallingCode:"245",areaCodes:[],region:"Africa",flag:"\ud83c\uddec\ud83c\uddfc"},{countryNameEn:"Guyana",countryNameLocal:"Guyana",countryCode:"GY",currencyCode:"GYD",currencyNameEn:"Guyanese dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"592",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddec\ud83c\uddfe"},{countryNameEn:"Hong Kong",countryNameLocal:"\u9999\u6e2f, Hong Kong",countryCode:"HK",currencyCode:"HKD",currencyNameEn:"Hong Kong dollar",tinType:"",tinName:"",officialLanguageCode:"zh-hant",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"852",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\udded\ud83c\uddf0"},{countryNameEn:"Honduras",countryNameLocal:"Honduras",countryCode:"HN",currencyCode:"HNL",currencyNameEn:"Honduran lempira",tinType:"RTN",tinName:"Registro Tributario Nacional",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"504",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udded\ud83c\uddf3"},{countryNameEn:"Croatia",countryNameLocal:"Hrvatska",countryCode:"HR",currencyCode:"HRK",currencyNameEn:"Croatian kuna",tinType:"PDV-ID; OIB",tinName:"PDV Id. Broj OIB",officialLanguageCode:"hr",officialLanguageNameEn:"Croatian",officialLanguageNameLocal:"hrvatski jezik",countryCallingCode:"385",areaCodes:[],region:"Europe",flag:"\ud83c\udded\ud83c\uddf7"},{countryNameEn:"Haiti",countryNameLocal:"Ha\xefti, Ayiti",countryCode:"HT",currencyCode:"HTG",currencyNameEn:"Haitian gourde",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"509",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udded\ud83c\uddf9"},{countryNameEn:"Hungary",countryNameLocal:"Magyarorsz\xe1g",countryCode:"HU",currencyCode:"HUF",currencyNameEn:"Hungarian forint",tinType:"ANUM",tinName:"K\xf6z\xf6ss\xe9gi ad\xf3sz\xe1m",officialLanguageCode:"hu",officialLanguageNameEn:"Hungarian",officialLanguageNameLocal:"magyar",countryCallingCode:"36",areaCodes:[],region:"Europe",flag:"\ud83c\udded\ud83c\uddfa"},{countryNameEn:"Indonesia",countryNameLocal:"Indonesia",countryCode:"ID",currencyCode:"IDR",currencyNameEn:"Indonesian rupiah",tinType:"NPWP",tinName:"Nomor Pokok Wajib Pajak",officialLanguageCode:"id",officialLanguageNameEn:"Indonesian",officialLanguageNameLocal:"Bahasa Indonesia",countryCallingCode:"62",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddee\ud83c\udde9"},{countryNameEn:"Ireland",countryNameLocal:"Ireland, \xc9ire",countryCode:"IE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"VAT or CBL",tinName:"Value added tax identification no.",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"353",areaCodes:[],region:"Europe",flag:"\ud83c\uddee\ud83c\uddea"},{countryNameEn:"Israel",countryNameLocal:"\u05d9\u05e9\u05e8\u05d0\u05dc",countryCode:"IL",currencyCode:"ILS",currencyNameEn:"Israeli new shekel",tinType:"",tinName:"\u05de\u05e1' \u05e2\u05d5\u05e1\u05e7 \u05de\u05d5\u05e8\u05e9\u05d4 / \u05d7\"\u05e4",officialLanguageCode:"he",officialLanguageNameEn:"Hebrew",officialLanguageNameLocal:"\u05e2\u05d1\u05e8\u05d9\u05ea",countryCallingCode:"972",areaCodes:[],region:"Europe",flag:"\ud83c\uddee\ud83c\uddf1"},{countryNameEn:"Isle of Man",countryNameLocal:"Isle of Man",countryCode:"IM",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:"\ud83c\uddee\ud83c\uddf2"},{countryNameEn:"India",countryNameLocal:"\u092d\u093e\u0930\u0924, India",countryCode:"IN",currencyCode:"INR",currencyNameEn:"Indian rupee",tinType:"VAT TIN / CST TIN",tinName:"Value Added Tax - Taxpayer Identification Number / Central Sales Tax - Taxpayer Identification Number (In most states)Not applicable",officialLanguageCode:"hi",officialLanguageNameEn:"Hindi",officialLanguageNameLocal:"\u0939\u093f\u0928\u094d\u0926\u0940, \u0939\u093f\u0902\u0926\u0940",countryCallingCode:"91",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddee\ud83c\uddf3"},{countryNameEn:"British Indian Ocean Territories",countryNameLocal:"British Indian Ocean Territories",countryCode:"IO",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"246",areaCodes:[],region:"Indian Ocean",flag:"\ud83c\uddee\ud83c\uddf4"},{countryNameEn:"Iraq",countryNameLocal:"\u0627\u0644\u0639\u0631\u0627\u0642, Iraq",countryCode:"IQ",currencyCode:"IQD",currencyNameEn:"Iraqi dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"964",areaCodes:[],region:"Arab States",flag:"\ud83c\uddee\ud83c\uddf6"},{countryNameEn:"Iran (Islamic Republic of)",countryNameLocal:"\u0627\u06cc\u0631\u0627\u0646",countryCode:"IR",currencyCode:"IRR",currencyNameEn:"Iranian rial",tinType:"",tinName:"",officialLanguageCode:"fa",officialLanguageNameEn:"Persian",officialLanguageNameLocal:"\u0641\u0627\u0631\u0633\u06cc",countryCallingCode:"98",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddee\ud83c\uddf7"},{countryNameEn:"Iceland",countryNameLocal:"\xcdsland",countryCode:"IS",currencyCode:"ISK",currencyNameEn:"Icelandic kr\xf3na",tinType:"VSK / VASK",tinName:"Vir\xf0isaukaskattsn\xfamer",officialLanguageCode:"is",officialLanguageNameEn:"Icelandic",officialLanguageNameLocal:"\xcdslenska",countryCallingCode:"354",areaCodes:[],region:"Europe",flag:"\ud83c\uddee\ud83c\uddf8"},{countryNameEn:"Italy",countryNameLocal:"Italia",countryCode:"IT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"P.IVA",tinName:"Partita IVA(IVA = Imposta sul Valore Aggiunto)",officialLanguageCode:"it",officialLanguageNameEn:"Italian",officialLanguageNameLocal:"Italiano",countryCallingCode:"39",areaCodes:[],region:"Europe",flag:"\ud83c\uddee\ud83c\uddf9"},{countryNameEn:"Jersey",countryNameLocal:"Jersey",countryCode:"JE",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:"\ud83c\uddef\ud83c\uddea"},{countryNameEn:"Jamaica",countryNameLocal:"Jamaica",countryCode:"JM",currencyCode:"JMD",currencyNameEn:"Jamaican dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"876",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddef\ud83c\uddf2"},{countryNameEn:"Jordan",countryNameLocal:"\u0627\u0644\u0623\u064f\u0631\u0652\u062f\u064f\u0646",countryCode:"JO",currencyCode:"JOD",currencyNameEn:"Jordanian dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"962",areaCodes:[],region:"Arab States",flag:"\ud83c\uddef\ud83c\uddf4"},{countryNameEn:"Japan",countryNameLocal:"\u65e5\u672c",countryCode:"JP",currencyCode:"JPY",currencyNameEn:"Japanese yen",tinType:"",tinName:"",officialLanguageCode:"ja",officialLanguageNameEn:"Japanese",officialLanguageNameLocal:"\u65e5\u672c\u8a9e (\u306b\u307b\u3093\u3054)",countryCallingCode:"81",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddef\ud83c\uddf5"},{countryNameEn:"Kenya",countryNameLocal:"Kenya",countryCode:"KE",currencyCode:"KES",currencyNameEn:"Kenyan shilling",tinType:"",tinName:"",officialLanguageCode:"sw",officialLanguageNameEn:"Swahili",officialLanguageNameLocal:"Kiswahili",countryCallingCode:"254",areaCodes:[],region:"Africa",flag:"\ud83c\uddf0\ud83c\uddea"},{countryNameEn:"Kyrgyzstan",countryNameLocal:"\u041a\u044b\u0440\u0433\u044b\u0437\u0441\u0442\u0430\u043d, \u041a\u0438\u0440\u0433\u0438\u0437\u0438\u044f",countryCode:"KG",currencyCode:"KGS",currencyNameEn:"Kyrgyzstani som",tinType:"",tinName:"",officialLanguageCode:"ky",officialLanguageNameEn:"Kirghiz, Kyrgyz",officialLanguageNameLocal:"\u041a\u044b\u0440\u0433\u044b\u0437\u0447\u0430, \u041a\u044b\u0440\u0433\u044b\u0437 \u0442\u0438\u043b\u0438",countryCallingCode:"996",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf0\ud83c\uddec"},{countryNameEn:"Cambodia",countryNameLocal:"\u1780\u1798\u17d2\u1796\u17bb\u1787\u17b6",countryCode:"KH",currencyCode:"KHR",currencyNameEn:"Cambodian riel",tinType:"",tinName:"",officialLanguageCode:"km",officialLanguageNameEn:"Central Khmer",officialLanguageNameLocal:"\u1781\u17d2\u1798\u17c2\u179a, \u1781\u17c1\u1798\u179a\u1797\u17b6\u179f\u17b6, \u1797\u17b6\u179f\u17b6\u1781\u17d2\u1798\u17c2\u179a",countryCallingCode:"855",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf0\ud83c\udded"},{countryNameEn:"North Korea",countryNameLocal:"\uc870\uc120\ubbfc\uc8fc\uc8fc\uc758\uc778\ubbfc\uacf5\ud654\uad6d",countryCode:"KP",currencyCode:"KPW",currencyNameEn:"North Korean won",tinType:"",tinName:"",officialLanguageCode:"ko",officialLanguageNameEn:"Korean",officialLanguageNameLocal:"\uc870\uc120\uc5b4",countryCallingCode:"850",areaCodes:[],region:"Asia",flag:"\ud83c\uddf0\ud83c\uddf5"},{countryNameEn:"South Korea",countryNameLocal:"\ub300\ud55c\ubbfc\uad6d",countryCode:"KR",currencyCode:"KRW",currencyNameEn:"South Korean won",tinType:"",tinName:"",officialLanguageCode:"ko",officialLanguageNameEn:"Korean",officialLanguageNameLocal:"\ud55c\uad6d\uc5b4",countryCallingCode:"82",areaCodes:[],region:"Asia",flag:"\ud83c\uddf0\ud83c\uddf7"},{countryNameEn:"Kiribati",countryNameLocal:"Kiribati",countryCode:"KI",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"686",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf0\ud83c\uddee"},{countryNameEn:"Saint Kitts and Nevis",countryNameLocal:"Saint Kitts and Nevis",countryCode:"KN",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1869",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf0\ud83c\uddf3"},{countryNameEn:"Kuwait",countryNameLocal:"\u0627\u0644\u0643\u0648\u064a\u062a",countryCode:"KW",currencyCode:"KWD",currencyNameEn:"Kuwaiti dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"965",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf0\ud83c\uddfc"},{countryNameEn:"Kazakhstan",countryNameLocal:"\u049a\u0430\u0437\u0430\u049b\u0441\u0442\u0430\u043d, \u041a\u0430\u0437\u0430\u0445\u0441\u0442\u0430\u043d",countryCode:"KZ",currencyCode:"KZT",currencyNameEn:"Kazakhstani tenge",tinType:"",tinName:"",officialLanguageCode:"kk",officialLanguageNameEn:"Kazakh",officialLanguageNameLocal:"\u049b\u0430\u0437\u0430\u049b \u0442\u0456\u043b\u0456",countryCallingCode:"7",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf0\ud83c\uddff"},{countryNameEn:"Lebanon",countryNameLocal:"\u0644\u0628\u0646\u0627\u0646, Liban",countryCode:"LB",currencyCode:"LBP",currencyNameEn:"Lebanese pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"961",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf1\ud83c\udde7"},{countryNameEn:"Saint Lucia",countryNameLocal:"Saint Lucia",countryCode:"LC",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1758",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf1\ud83c\udde8"},{countryNameEn:"Liechtenstein",countryNameLocal:"Liechtenstein",countryCode:"LI",currencyCode:"CHF",currencyNameEn:"Swiss franc",tinType:"",tinName:"",officialLanguageCode:"de",officialLanguageNameEn:"German",officialLanguageNameLocal:"Deutsch",countryCallingCode:"423",areaCodes:[],region:"Europe",flag:"\ud83c\uddf1\ud83c\uddee"},{countryNameEn:"Sri Lanka",countryNameLocal:"\u0dc1\u0dca\u200d\u0dbb\u0dd3 \u0dbd\u0d82\u0d9a\u0dcf, \u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8",countryCode:"LK",currencyCode:"LKR",currencyNameEn:"Sri Lankan rupee",tinType:"",tinName:"",officialLanguageCode:"si",officialLanguageNameEn:"Sinhala, Sinhalese",officialLanguageNameLocal:"\u0dc3\u0dd2\u0d82\u0dc4\u0dbd",countryCallingCode:"94",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf1\ud83c\uddf0"},{countryNameEn:"Liberia",countryNameLocal:"Liberia",countryCode:"LR",currencyCode:"LRD",currencyNameEn:"Liberian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"231",areaCodes:[],region:"Africa",flag:"\ud83c\uddf1\ud83c\uddf7"},{countryNameEn:"Lesotho",countryNameLocal:"Lesotho",countryCode:"LS",currencyCode:"LSL",currencyNameEn:"Lesotho loti",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"266",areaCodes:[],region:"Africa",flag:"\ud83c\uddf1\ud83c\uddf8"},{countryNameEn:"Lithuania",countryNameLocal:"Lietuva",countryCode:"LT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"PVM kodas",tinName:"PVM (abbrev. Prid\u0117tin\u0117s vert\u0117s mokestis) mok\u0117tojo kodas",officialLanguageCode:"lt",officialLanguageNameEn:"Lithuanian",officialLanguageNameLocal:"lietuvi\u0173 kalba",countryCallingCode:"370",areaCodes:[],region:"Europe",flag:"\ud83c\uddf1\ud83c\uddf9"},{countryNameEn:"Luxembourg",countryNameLocal:"L\xebtzebuerg, Luxembourg, Luxemburg",countryCode:"LU",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"No. TVA",tinName:"Num\xe9ro d'identification \xe0 la taxe sur la valeur ajout\xe9e",officialLanguageCode:"lb",officialLanguageNameEn:"Luxembourgish, Letzeburgesch",officialLanguageNameLocal:"L\xebtzebuergesch",countryCallingCode:"352",areaCodes:[],region:"Europe",flag:"\ud83c\uddf1\ud83c\uddfa"},{countryNameEn:"Latvia",countryNameLocal:"Latvija",countryCode:"LV",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"PVN",tinName:"Pievienot\u0101s v\u0113rt\u012bbas nodok\u013ca (PVN) re\u0123istr\u0101cijas numurs",officialLanguageCode:"lv",officialLanguageNameEn:"Latvian",officialLanguageNameLocal:"latvie\u0161u valoda",countryCallingCode:"371",areaCodes:[],region:"Europe",flag:"\ud83c\uddf1\ud83c\uddfb"},{countryNameEn:"Libya",countryNameLocal:"\u0644\u064a\u0628\u064a\u0627",countryCode:"LY",currencyCode:"LYD",currencyNameEn:"Libyan dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"218",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf1\ud83c\uddfe"},{countryNameEn:"Morocco",countryNameLocal:"Maroc, \u2d4d\u2d4e\u2d56\u2d54\u2d49\u2d31, \u0627\u0644\u0645\u063a\u0631\u0628",countryCode:"MA",currencyCode:"MAD",currencyNameEn:"Moroccan dirham",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"212",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf2\ud83c\udde6"},{countryNameEn:"Monaco",countryNameLocal:"Monaco",countryCode:"MC",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"377",areaCodes:[],region:"Europe",flag:"\ud83c\uddf2\ud83c\udde8"},{countryNameEn:"Montenegro",countryNameLocal:"Crna Gora, \u0426\u0440\u043d\u0430 \u0413\u043e\u0440\u0430",countryCode:"ME",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"srp",officialLanguageNameEn:"\u0441\u0440\u043f\u0441\u043a\u0438 \u0458\u0435\u0437\u0438\u043a",officialLanguageNameLocal:"",countryCallingCode:"382",areaCodes:[],region:"Europe",flag:"\ud83c\uddf2\ud83c\uddea"},{countryNameEn:"Saint Martin (French part)",countryNameLocal:"Saint-Martin",countryCode:"MF",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"590",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf2\ud83c\uddeb"},{countryNameEn:"Madagascar",countryNameLocal:"Madagasikara, Madagascar",countryCode:"MG",currencyCode:"MGA",currencyNameEn:"Malagasy ariary",tinType:"",tinName:"",officialLanguageCode:"mg",officialLanguageNameEn:"Malagasy",officialLanguageNameLocal:"fiteny malagasy",countryCallingCode:"261",areaCodes:[],region:"Africa",flag:"\ud83c\uddf2\ud83c\uddec"},{countryNameEn:"Mali",countryNameLocal:"Mali",countryCode:"ML",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"223",areaCodes:[],region:"Africa",flag:"\ud83c\uddf2\ud83c\uddf1"},{countryNameEn:"Myanmar",countryNameLocal:"\u1019\u103c\u1014\u103a\u1019\u102c",countryCode:"MM",currencyCode:"MMK",currencyNameEn:"Myanmar kyat",tinType:"",tinName:"",officialLanguageCode:"my",officialLanguageNameEn:"Burmese",officialLanguageNameLocal:"\u1017\u1019\u102c\u1005\u102c",countryCallingCode:"95",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf2\ud83c\uddf2"},{countryNameEn:"Mongolia",countryNameLocal:"\u041c\u043e\u043d\u0433\u043e\u043b \u0423\u043b\u0441",countryCode:"MN",currencyCode:"MNT",currencyNameEn:"Mongolian t\xf6gr\xf6g",tinType:"",tinName:"",officialLanguageCode:"mn",officialLanguageNameEn:"Mongolian",officialLanguageNameLocal:"\u041c\u043e\u043d\u0433\u043e\u043b \u0445\u044d\u043b",countryCallingCode:"976",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf2\ud83c\uddf3"},{countryNameEn:"Macao",countryNameLocal:"\u6fb3\u9580, Macau",countryCode:"MO",currencyCode:"MOP",currencyNameEn:"Macanese pataca",tinType:"",tinName:"",officialLanguageCode:"zh-hant",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"853",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf2\ud83c\uddf4"},{countryNameEn:"Martinique",countryNameLocal:"Martinique",countryCode:"MQ",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"596",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf2\ud83c\uddf6"},{countryNameEn:"Mauritania",countryNameLocal:"\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627, Mauritanie",countryCode:"MR",currencyCode:"MRU",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"222",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf2\ud83c\uddf7"},{countryNameEn:"Montserrat",countryNameLocal:"Montserrat",countryCode:"MS",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1664",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf2\ud83c\uddf8"},{countryNameEn:"Malta",countryNameLocal:"Malta",countryCode:"MT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"Vat No.",tinName:"Vat reg. no.",officialLanguageCode:"mt",officialLanguageNameEn:"Maltese",officialLanguageNameLocal:"Malti",countryCallingCode:"356",areaCodes:[],region:"Europe",flag:"\ud83c\uddf2\ud83c\uddf9"},{countryNameEn:"Mauritius",countryNameLocal:"Maurice, Mauritius",countryCode:"MU",currencyCode:"MUR",currencyNameEn:"Mauritian rupee",tinType:"",tinName:"",officialLanguageCode:"mfe",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"230",areaCodes:[],region:"Africa",flag:"\ud83c\uddf2\ud83c\uddfa"},{countryNameEn:"Maldives",countryNameLocal:"",countryCode:"MV",currencyCode:"MVR",currencyNameEn:"Maldivian rufiyaa",tinType:"",tinName:"",officialLanguageCode:"dv",officialLanguageNameEn:"Divehi, Dhivehi, Maldivian",officialLanguageNameLocal:"\u078b\u07a8\u0788\u07ac\u0780\u07a8",countryCallingCode:"960",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf2\ud83c\uddfb"},{countryNameEn:"Malawi",countryNameLocal:"Malawi",countryCode:"MW",currencyCode:"MWK",currencyNameEn:"Malawian kwacha",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"265",areaCodes:[],region:"Africa",flag:"\ud83c\uddf2\ud83c\uddfc"},{countryNameEn:"Mexico",countryNameLocal:"M\xe9xico",countryCode:"MX",currencyCode:"MXN",currencyNameEn:"Mexican peso",tinType:"RFC",tinName:"Registro Federal de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"52",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf2\ud83c\uddfd"},{countryNameEn:"Malaysia",countryNameLocal:"",countryCode:"MY",currencyCode:"MYR",currencyNameEn:"Malaysian ringgit",tinType:"",tinName:"",officialLanguageCode:"ms",officialLanguageNameEn:"Malay",officialLanguageNameLocal:"Bahasa Melayu, \u0628\u0647\u0627\u0633 \u0645\u0644\u0627\u064a\u0648\u200e",countryCallingCode:"60",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf2\ud83c\uddfe"},{countryNameEn:"Mozambique",countryNameLocal:"Mozambique",countryCode:"MZ",currencyCode:"MZN",currencyNameEn:"Mozambican metical",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugu\xeas",countryCallingCode:"258",areaCodes:[],region:"Africa",flag:"\ud83c\uddf2\ud83c\uddff"},{countryNameEn:"Namibia",countryNameLocal:"Namibia",countryCode:"NA",currencyCode:"NAD",currencyNameEn:"Namibian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"264",areaCodes:[],region:"Africa",flag:"\ud83c\uddf3\ud83c\udde6"},{countryNameEn:"New Caledonia",countryNameLocal:"Nouvelle-Cal\xe9donie",countryCode:"NC",currencyCode:"XPF",currencyNameEn:"CFP franc (franc Pacifique)",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"687",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf3\ud83c\udde8"},{countryNameEn:"Norfolk Island",countryNameLocal:"Norfolk Island",countryCode:"NF",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"672",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf3\ud83c\uddeb"},{countryNameEn:"Nigeria",countryNameLocal:"Nigeria",countryCode:"NG",currencyCode:"NGN",currencyNameEn:"Nigerian naira",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"234",areaCodes:[],region:"Africa",flag:"\ud83c\uddf3\ud83c\uddec"},{countryNameEn:"Nicaragua",countryNameLocal:"Nicaragua",countryCode:"NI",currencyCode:"NIO",currencyNameEn:"Nicaraguan c\xf3rdoba",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"505",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf3\ud83c\uddee"},{countryNameEn:"Norway",countryNameLocal:"Norge, Noreg",countryCode:"NO",currencyCode:"NOK",currencyNameEn:"Norwegian krone",tinType:"Orgnr",tinName:"Organisasjonsnummer",officialLanguageCode:"nb",officialLanguageNameEn:"Norwegian Bokm\xe5l",officialLanguageNameLocal:"Norsk Bokm\xe5l",countryCallingCode:"47",areaCodes:[],region:"Europe",flag:"\ud83c\uddf3\ud83c\uddf4"},{countryNameEn:"Nepal",countryNameLocal:"",countryCode:"NP",currencyCode:"NPR",currencyNameEn:"Nepalese rupee",tinType:"",tinName:"",officialLanguageCode:"ne",officialLanguageNameEn:"Nepali",officialLanguageNameLocal:"\u0928\u0947\u092a\u093e\u0932\u0940",countryCallingCode:"977",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf3\ud83c\uddf5"},{countryNameEn:"Nauru",countryNameLocal:"Nauru",countryCode:"NR",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"na",officialLanguageNameEn:"Nauru",officialLanguageNameLocal:"Dorerin Naoero",countryCallingCode:"674",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf3\ud83c\uddf7"},{countryNameEn:"Niue",countryNameLocal:"Niue",countryCode:"NU",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"niu",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"683",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf3\ud83c\uddfa"},{countryNameEn:"New Zealand",countryNameLocal:"New Zealand",countryCode:"NZ",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"NZBN",tinName:"NZ Business Number",officialLanguageCode:"mi",officialLanguageNameEn:"Maori",officialLanguageNameLocal:"te reo M\u0101ori",countryCallingCode:"64",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf3\ud83c\uddff"},{countryNameEn:"Oman",countryNameLocal:"\u0633\u0644\u0637\u0646\u0629 \u0639\u064f\u0645\u0627\u0646",countryCode:"OM",currencyCode:"OMR",currencyNameEn:"Omani rial",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"968",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf4\ud83c\uddf2"},{countryNameEn:"Panama",countryNameLocal:"Panama",countryCode:"PA",currencyCode:"PAB",currencyNameEn:"Panamanian balboa",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"507",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf5\ud83c\udde6"},{countryNameEn:"Peru",countryNameLocal:"Per\xfa",countryCode:"PE",currencyCode:"PEN",currencyNameEn:"Peruvian sol",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"51",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf5\ud83c\uddea"},{countryNameEn:"French Polynesia",countryNameLocal:"Polyn\xe9sie fran\xe7aise",countryCode:"PF",currencyCode:"XPF",currencyNameEn:"CFP franc (franc Pacifique)",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"689",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf5\ud83c\uddeb"},{countryNameEn:"Papua New Guinea",countryNameLocal:"Papua New Guinea",countryCode:"PG",currencyCode:"PGK",currencyNameEn:"Papua New Guinean kina",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"675",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf5\ud83c\uddec"},{countryNameEn:"Pakistan",countryNameLocal:"\u067e\u0627\u06a9\u0633\u062a\u0627\u0646",countryCode:"PK",currencyCode:"PKR",currencyNameEn:"Pakistani rupee",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"92",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf5\ud83c\uddf0"},{countryNameEn:"Poland",countryNameLocal:"Polska",countryCode:"PL",currencyCode:"PLN",currencyNameEn:"Polish z\u0142oty",tinType:"NIP",tinName:"numer identyfikacji podatkowej",officialLanguageCode:"pl",officialLanguageNameEn:"Polish",officialLanguageNameLocal:"j\u0119zyk polski, polszczyzna",countryCallingCode:"48",areaCodes:[],region:"Europe",flag:"\ud83c\uddf5\ud83c\uddf1"},{countryNameEn:"Saint Pierre and Miquelon",countryNameLocal:"Saint-Pierre-et-Miquelon",countryCode:"PM",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"508",areaCodes:[],region:"North America",flag:"\ud83c\uddf5\ud83c\uddf2"},{countryNameEn:"Pitcairn",countryNameLocal:"Pitcairn",countryCode:"PN",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"64",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf5\ud83c\uddf3"},{countryNameEn:"Puerto Rico",countryNameLocal:"Puerto Rico",countryCode:"PR",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"1",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf5\ud83c\uddf7"},{countryNameEn:"Palestine, State of",countryNameLocal:"Palestinian Territory",countryCode:"PS",currencyCode:"",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"970",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf5\ud83c\uddf8"},{countryNameEn:"Portugal",countryNameLocal:"Portugal",countryCode:"PT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"NIPC",tinName:"N\xfamero de Identifica\xe7\xe3o de Pessoa Coletiva (NIPC)",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugu\xeas",countryCallingCode:"351",areaCodes:[],region:"Europe",flag:"\ud83c\uddf5\ud83c\uddf9"},{countryNameEn:"Palau",countryNameLocal:"Palau",countryCode:"PW",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"680",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf5\ud83c\uddfc"},{countryNameEn:"Paraguay",countryNameLocal:"Paraguay",countryCode:"PY",currencyCode:"PYG",currencyNameEn:"Paraguayan guaran\xed",tinType:"RUC",tinName:"Registro Unico de Contribuyentes",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"595",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf5\ud83c\uddfe"},{countryNameEn:"Qatar",countryNameLocal:"\u0642\u0637\u0631",countryCode:"QA",currencyCode:"QAR",currencyNameEn:"Qatari riyal",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"974",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf6\ud83c\udde6"},{countryNameEn:"R\xe9union",countryNameLocal:"La R\xe9union",countryCode:"RE",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"262",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf7\ud83c\uddea"},{countryNameEn:"Romania",countryNameLocal:"Rom\xe2nia",countryCode:"RO",currencyCode:"RON",currencyNameEn:"Romanian leu",tinType:"CIF",tinName:"Codul de identificare fiscal\u0103",officialLanguageCode:"ro",officialLanguageNameEn:"Romanian, Moldavian, Moldovan",officialLanguageNameLocal:"Rom\xe2n\u0103",countryCallingCode:"40",areaCodes:[],region:"Europe",flag:"\ud83c\uddf7\ud83c\uddf4"},{countryNameEn:"Serbia",countryNameLocal:"\u0421\u0440\u0431\u0438\u0458\u0430",countryCode:"RS",currencyCode:"RSD",currencyNameEn:"Serbian dinar",tinType:"PIB",tinName:"Poreski identifikacioni broj",officialLanguageCode:"sr",officialLanguageNameEn:"Serbian",officialLanguageNameLocal:"\u0441\u0440\u043f\u0441\u043a\u0438 \u0458\u0435\u0437\u0438\u043a",countryCallingCode:"381",areaCodes:[],region:"Europe",flag:"\ud83c\uddf7\ud83c\uddf8"},{countryNameEn:"Russia",countryNameLocal:"\u0420\u043e\u0441\u0441\u0438\u044f",countryCode:"RU",currencyCode:"RUB",currencyNameEn:"Russian ruble",tinType:"\u0418\u041d\u041d",tinName:"\u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u043d\u0430\u043b\u043e\u0433\u043e\u043f\u043b\u0430\u0442\u0435\u043b\u044c\u0449\u0438\u043a\u0430",officialLanguageCode:"ru",officialLanguageNameEn:"Russian",officialLanguageNameLocal:"\u0440\u0443\u0441\u0441\u043a\u0438\u0439",countryCallingCode:"7",areaCodes:[],region:"Europe",flag:"\ud83c\uddf7\ud83c\uddfa"},{countryNameEn:"Rwanda",countryNameLocal:"Rwanda",countryCode:"RW",currencyCode:"RWF",currencyNameEn:"Rwandan franc",tinType:"",tinName:"",officialLanguageCode:"rw",officialLanguageNameEn:"Kinyarwanda",officialLanguageNameLocal:"Ikinyarwanda",countryCallingCode:"250",areaCodes:[],region:"Africa",flag:"\ud83c\uddf7\ud83c\uddfc"},{countryNameEn:"Saudi Arabia",countryNameLocal:"\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629",countryCode:"SA",currencyCode:"SAR",currencyNameEn:"Saudi riyal",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"966",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf8\ud83c\udde6"},{countryNameEn:"Solomon Islands",countryNameLocal:"Solomon Islands",countryCode:"SB",currencyCode:"SBD",currencyNameEn:"Solomon Islands dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"677",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf8\ud83c\udde7"},{countryNameEn:"Seychelles",countryNameLocal:"Seychelles",countryCode:"SC",currencyCode:"SCR",currencyNameEn:"Seychelles rupee",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"248",areaCodes:[],region:"Africa",flag:"\ud83c\uddf8\ud83c\udde8"},{countryNameEn:"Sweden",countryNameLocal:"Sverige",countryCode:"SE",currencyCode:"SEK",currencyNameEn:"Swedish krona/kronor",tinType:"Momsnr.",tinName:"VAT-nummer",officialLanguageCode:"sv",officialLanguageNameEn:"Swedish",officialLanguageNameLocal:"Svenska",countryCallingCode:"46",areaCodes:[],region:"Europe",flag:"\ud83c\uddf8\ud83c\uddea"},{countryNameEn:"Singapore",countryNameLocal:"Singapore",countryCode:"SG",currencyCode:"SGD",currencyNameEn:"Singapore dollar",tinType:"",tinName:"",officialLanguageCode:"zh-hans",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"65",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf8\ud83c\uddec"},{countryNameEn:"Saint Helena, Ascension and Tristan da Cunha",countryNameLocal:"Saint Helena",countryCode:"SH",currencyCode:"SHP",currencyNameEn:"Saint Helena pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"290",areaCodes:[],region:"Africa",flag:"\ud83c\uddf8\ud83c\udded"},{countryNameEn:"Slovenia",countryNameLocal:"Slovenija",countryCode:"SI",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"ID za DDV",tinName:"Dav\u010dna \u0161tevilka",officialLanguageCode:"sl",officialLanguageNameEn:"Slovenian",officialLanguageNameLocal:"Slovenski Jezik, Sloven\u0161\u010dina",countryCallingCode:"386",areaCodes:[],region:"Europe",flag:"\ud83c\uddf8\ud83c\uddee"},{countryNameEn:"Svalbard and Jan Mayen",countryNameLocal:"Svalbard and Jan Mayen",countryCode:"SJ",currencyCode:"NOK",currencyNameEn:"Norwegian krone",tinType:"",tinName:"",officialLanguageCode:"no",officialLanguageNameEn:"Norwegian",officialLanguageNameLocal:"Norsk",countryCallingCode:"4779",areaCodes:[],region:"Europe",flag:"\ud83c\uddf8\ud83c\uddef"},{countryNameEn:"Slovakia",countryNameLocal:"Slovensko",countryCode:"SK",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"I\u010c DPH",tinName:"Identifika\u010dn\xe9 \u010d\xedslo pre da\u0148 z pridanej hodnoty",officialLanguageCode:"sk",officialLanguageNameEn:"Slovak",officialLanguageNameLocal:"Sloven\u010dina, Slovensk\xfd Jazyk",countryCallingCode:"421",areaCodes:[],region:"Europe",flag:"\ud83c\uddf8\ud83c\uddf0"},{countryNameEn:"Sierra Leone",countryNameLocal:"Sierra Leone",countryCode:"SL",currencyCode:"SLL",currencyNameEn:"Sierra Leonean leone",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"232",areaCodes:[],region:"Africa",flag:"\ud83c\uddf8\ud83c\uddf1"},{countryNameEn:"Republic of San Marino",countryNameLocal:"Repubblica di San Marino",countryCode:"SM",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"C.O.E.",tinName:"Codice operatore economico",officialLanguageCode:"it",officialLanguageNameEn:"Italian",officialLanguageNameLocal:"Italiano",countryCallingCode:"378",areaCodes:[],region:"Europe",flag:"\ud83c\uddf8\ud83c\uddf2"},{countryNameEn:"Senegal",countryNameLocal:"S\xe9n\xe9gal",countryCode:"SN",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"221",areaCodes:[],region:"Africa",flag:"\ud83c\uddf8\ud83c\uddf3"},{countryNameEn:"Somalia",countryNameLocal:"Somalia, \u0627\u0644\u0635\u0648\u0645\u0627\u0644",countryCode:"SO",currencyCode:"SOS",currencyNameEn:"Somali shilling",tinType:"",tinName:"",officialLanguageCode:"so",officialLanguageNameEn:"Somali",officialLanguageNameLocal:"Soomaaliga, af Soomaali",countryCallingCode:"252",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf8\ud83c\uddf4"},{countryNameEn:"Suriname",countryNameLocal:"Suriname",countryCode:"SR",currencyCode:"SRD",currencyNameEn:"Surinamese dollar",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"597",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf8\ud83c\uddf7"},{countryNameEn:"South Sudan",countryNameLocal:"South Sudan",countryCode:"SS",currencyCode:"SSP",currencyNameEn:"South Sudanese pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"211",areaCodes:[],region:"Africa",flag:"\ud83c\uddf8\ud83c\uddf8"},{countryNameEn:"Sao Tome and Principe",countryNameLocal:"S\xe3o Tom\xe9 e Pr\xedncipe",countryCode:"ST",currencyCode:"STN",currencyNameEn:"",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugu\xeas",countryCallingCode:"239",areaCodes:[],region:"Africa",flag:"\ud83c\uddf8\ud83c\uddf9"},{countryNameEn:"El Salvador",countryNameLocal:"El Salvador",countryCode:"SV",currencyCode:"SVC",currencyNameEn:"Salvadoran col\xf3n",tinType:"NIT",tinName:"N\xfamero de Identificaci\xf3n Tributaria",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"503",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf8\ud83c\uddfb"},{countryNameEn:"Sint Maarten (Dutch part)",countryNameLocal:"Sint Maarten",countryCode:"SX",currencyCode:"ANG",currencyNameEn:"Netherlands Antillean guilder",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"1721",areaCodes:[],region:"Unknown",flag:"\ud83c\uddf8\ud83c\uddfd"},{countryNameEn:"Syrian Arab Republic",countryNameLocal:"\u0633\u0648\u0631\u064a\u0627, S\u016briyya",countryCode:"SY",currencyCode:"SYP",currencyNameEn:"Syrian pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"963",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf8\ud83c\uddfe"},{countryNameEn:"Chad",countryNameLocal:"Tchad, \u062a\u0634\u0627\u062f",countryCode:"TD",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"235",areaCodes:[],region:"Africa",flag:"\ud83c\uddf9\ud83c\udde9"},{countryNameEn:"Togo",countryNameLocal:"Togo",countryCode:"TG",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"228",areaCodes:[],region:"Africa",flag:"\ud83c\uddf9\ud83c\uddec"},{countryNameEn:"Thailand",countryNameLocal:"\u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28\u0e44\u0e17\u0e22",countryCode:"TH",currencyCode:"THB",currencyNameEn:"Thai baht",tinType:"",tinName:"",officialLanguageCode:"th",officialLanguageNameEn:"Thai",officialLanguageNameLocal:"\u0e44\u0e17\u0e22",countryCallingCode:"66",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf9\ud83c\udded"},{countryNameEn:"Tajikistan",countryNameLocal:",",countryCode:"TJ",currencyCode:"TJS",currencyNameEn:"Tajikistani somoni",tinType:"",tinName:"",officialLanguageCode:"tg",officialLanguageNameEn:"Tajik",officialLanguageNameLocal:"\u0442\u043e\u04b7\u0438\u043a\u04e3, to\xe7ik\u012b, \u062a\u0627\u062c\u06cc\u06a9\u06cc\u200e",countryCallingCode:"992",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf9\ud83c\uddef"},{countryNameEn:"Tokelau",countryNameLocal:"Tokelau",countryCode:"TK",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"tkl",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"690",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf9\ud83c\uddf0"},{countryNameEn:"Timor-Leste",countryNameLocal:"Timor-Leste, Timor Lorosa'e",countryCode:"TL",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"pt",officialLanguageNameEn:"Portuguese",officialLanguageNameLocal:"Portugu\xeas",countryCallingCode:"670",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf9\ud83c\uddf1"},{countryNameEn:"Turkmenistan",countryNameLocal:"T\xfcrkmenistan",countryCode:"TM",currencyCode:"TMT",currencyNameEn:"Turkmenistan manat",tinType:"",tinName:"",officialLanguageCode:"tk",officialLanguageNameEn:"Turkmen",officialLanguageNameLocal:"T\xfcrkmen, \u0422\u04af\u0440\u043a\u043c\u0435\u043d",countryCallingCode:"993",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf9\ud83c\uddf2"},{countryNameEn:"Tunisia",countryNameLocal:"\u062a\u0648\u0646\u0633, Tunisie",countryCode:"TN",currencyCode:"TND",currencyNameEn:"Tunisian dinar",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"216",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf9\ud83c\uddf3"},{countryNameEn:"Tonga",countryNameLocal:"Tonga",countryCode:"TO",currencyCode:"TOP",currencyNameEn:"Tongan pa\u02bbanga",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"676",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf9\ud83c\uddf4"},{countryNameEn:"Turkey",countryNameLocal:"T\xfcrkiye",countryCode:"TR",currencyCode:"TRY",currencyNameEn:"Turkish lira",tinType:"KDV",tinName:"Vergi Kimlik Numaras\u0131",officialLanguageCode:"tr",officialLanguageNameEn:"Turkish",officialLanguageNameLocal:"T\xfcrk\xe7e",countryCallingCode:"90",areaCodes:[],region:"Europe",flag:"\ud83c\uddf9\ud83c\uddf7"},{countryNameEn:"Trinidad and Tobago",countryNameLocal:"Trinidad and Tobago",countryCode:"TT",currencyCode:"TTD",currencyNameEn:"Trinidad and Tobago dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"868",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddf9\ud83c\uddf9"},{countryNameEn:"Tuvalu",countryNameLocal:"Tuvalu",countryCode:"TV",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"688",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf9\ud83c\uddfb"},{countryNameEn:"United Republic of Tanzania",countryNameLocal:"Tanzania",countryCode:"TZ",currencyCode:"TZS",currencyNameEn:"Tanzanian shilling",tinType:"",tinName:"",officialLanguageCode:"sw",officialLanguageNameEn:"Swahili",officialLanguageNameLocal:"Kiswahili",countryCallingCode:"255",areaCodes:[],region:"Africa",flag:"\ud83c\uddf9\ud83c\uddff"},{countryNameEn:"Ukraine",countryNameLocal:"\u0423\u043a\u0440\u0430\u0457\u043d\u0430",countryCode:"UA",currencyCode:"UAH",currencyNameEn:"Ukrainian hryvnia",tinType:"\u0406\u041d\u041f\u041f",tinName:"\u0406\u0434\u0435\u043d\u0442\u0438\u0444\u0456\u043a\u0430\u0446\u0456\u0439\u043d\u0438\u0439 \u043d\u043e\u043c\u0435\u0440 \u043f\u043b\u0430\u0442\u043d\u0438\u043a\u0430 \u043f\u043e\u0434\u0430\u0442\u043a\u0456\u0432",officialLanguageCode:"uk",officialLanguageNameEn:"Ukrainian",officialLanguageNameLocal:"\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430",countryCallingCode:"380",areaCodes:[],region:"Europe",flag:"\ud83c\uddfa\ud83c\udde6"},{countryNameEn:"Uganda",countryNameLocal:"Uganda",countryCode:"UG",currencyCode:"UGX",currencyNameEn:"Ugandan shilling",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"256",areaCodes:[],region:"Africa",flag:"\ud83c\uddfa\ud83c\uddec"},{countryNameEn:"United States of America",countryNameLocal:"United States of America",countryCode:"US",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"EIN",tinName:"Tax Identification Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:[],region:"North America",flag:"\ud83c\uddfa\ud83c\uddf8"},{countryNameEn:"Uruguay",countryNameLocal:"Uruguay",countryCode:"UY",currencyCode:"UYU",currencyNameEn:"Uruguayan peso",tinType:"RUT",tinName:"Registro \xdanico Tributario",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"598",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddfa\ud83c\uddfe"},{countryNameEn:"Uzbekistan",countryNameLocal:"",countryCode:"UZ",currencyCode:"UZS",currencyNameEn:"Uzbekistan som",tinType:"\u0421\u0422\u0418\u0420",tinName:"\u0421\u043e\u043b\u0438\u049b \u0442\u045e\u043b\u043e\u0432\u0447\u0438\u043b\u0430\u0440\u043d\u0438\u043d\u0433 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0440\u0430\u049b\u0430\u043c\u0438",officialLanguageCode:"uz",officialLanguageNameEn:"Uzbek",officialLanguageNameLocal:"O\u02bbzbek, \u040e\u0437\u0431\u0435\u043a, \u0623\u06c7\u0632\u0628\u06d0\u0643\u200e",countryCallingCode:"998",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddfa\ud83c\uddff"},{countryNameEn:"Saint Vincent and the Grenadines",countryNameLocal:"Saint Vincent and the Grenadines",countryCode:"VC",currencyCode:"XCD",currencyNameEn:"East Caribbean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1784",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddfb\ud83c\udde8"},{countryNameEn:"Venezuela (Bolivarian Republic of)",countryNameLocal:"Venezuela",countryCode:"VE",currencyCode:"VES",currencyNameEn:"",tinType:"RIF",tinName:"Registro de Informacion Fiscal",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"58",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddfb\ud83c\uddea"},{countryNameEn:"Virgin Islands (British)",countryNameLocal:"British Virgin Islands",countryCode:"VG",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1284",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddfb\ud83c\uddec"},{countryNameEn:"Virgin Islands (U.S.)",countryNameLocal:"United States Virgin Islands",countryCode:"VI",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1340",areaCodes:[],region:"South/Latin America",flag:"\ud83c\uddfb\ud83c\uddee"},{countryNameEn:"Vietnam",countryNameLocal:"Vi\u1ec7t Nam",countryCode:"VN",currencyCode:"VND",currencyNameEn:"Vietnamese \u0111\u1ed3ng",tinType:"",tinName:"",officialLanguageCode:"vi",officialLanguageNameEn:"Vietnamese",officialLanguageNameLocal:"Ti\u1ebfng Vi\u1ec7t",countryCallingCode:"84",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddfb\ud83c\uddf3"},{countryNameEn:"Vanuatu",countryNameLocal:"Vanuatu",countryCode:"VU",currencyCode:"VUV",currencyNameEn:"Vanuatu vatu",tinType:"",tinName:"",officialLanguageCode:"bi",officialLanguageNameEn:"Bislama",officialLanguageNameLocal:"Bislama",countryCallingCode:"678",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddfb\ud83c\uddfa"},{countryNameEn:"Wallis and Futuna",countryNameLocal:"Wallis-et-Futuna",countryCode:"WF",currencyCode:"XPF",currencyNameEn:"CFP franc (franc Pacifique)",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"681",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddfc\ud83c\uddeb"},{countryNameEn:"Samoa",countryNameLocal:"Samoa",countryCode:"WS",currencyCode:"WST",currencyNameEn:"Samoan tala",tinType:"",tinName:"",officialLanguageCode:"sm",officialLanguageNameEn:"Samoan",officialLanguageNameLocal:"gagana fa'a Samoa",countryCallingCode:"685",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddfc\ud83c\uddf8"},{countryNameEn:"Yemen",countryNameLocal:"\u0627\u0644\u064a\u064e\u0645\u064e\u0646",countryCode:"YE",currencyCode:"YER",currencyNameEn:"Yemeni rial",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"967",areaCodes:[],region:"Arab States",flag:"\ud83c\uddfe\ud83c\uddea"},{countryNameEn:"Mayotte",countryNameLocal:"Mayotte",countryCode:"YT",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"262",areaCodes:[],region:"Africa",flag:"\ud83c\uddfe\ud83c\uddf9"},{countryNameEn:"South Africa",countryNameLocal:"South Africa",countryCode:"ZA",currencyCode:"ZAR",currencyNameEn:"South African rand",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"27",areaCodes:[],region:"Africa",flag:"\ud83c\uddff\ud83c\udde6"},{countryNameEn:"Zambia",countryNameLocal:"Zambia",countryCode:"ZM",currencyCode:"ZMW",currencyNameEn:"Zambian kwacha",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"260",areaCodes:[],region:"Africa",flag:"\ud83c\uddff\ud83c\uddf2"},{countryNameEn:"Zimbabwe",countryNameLocal:"Zimbabwe",countryCode:"ZW",currencyCode:"ZWL",currencyNameEn:"Zimbabwean dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"263",areaCodes:[],region:"Africa",flag:"\ud83c\uddff\ud83c\uddfc"},{countryNameEn:"Eswatini",countryNameLocal:"Swaziland",countryCode:"SZ",currencyCode:"SZL",currencyNameEn:"Swazi lilangeni",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"268",areaCodes:[],region:"Africa",flag:"\ud83c\uddf8\ud83c\uddff"},{countryNameEn:"North Macedonia",countryNameLocal:"\u041c\u0430\u043a\u0435\u0434\u043e\u043d\u0438\u0458\u0430",countryCode:"MK",currencyCode:"MKD",currencyNameEn:"Macedonian denar",tinType:"",tinName:"",officialLanguageCode:"mk",officialLanguageNameEn:"Macedonian",officialLanguageNameLocal:"\u043c\u0430\u043a\u0435\u0434\u043e\u043d\u0441\u043a\u0438 \u0458\u0430\u0437\u0438\u043a",countryCallingCode:"389",areaCodes:[],region:"Europe",flag:"\ud83c\uddf2\ud83c\uddf0"},{countryNameEn:"Philippines",countryNameLocal:"Philippines",countryCode:"PH",currencyCode:"PHP",currencyNameEn:"Philippine peso",tinType:"TIN",tinName:"Tax Identification Number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"63",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf5\ud83c\udded"},{countryNameEn:"Netherlands",countryNameLocal:"Nederland",countryCode:"NL",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"Btw-nr.",tinName:"Btw-nummer",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"31",areaCodes:[],region:"Europe",flag:"\ud83c\uddf3\ud83c\uddf1"},{countryNameEn:"United Arab Emirates",countryNameLocal:"\u062f\u0648\u0644\u0629 \u0627\u0644\u0625\u0645\u0627\u0631\u0627\u062a \u0627\u0644\u0639\u0631\u0628\u064a\u0651\u0629 \u0627\u0644\u0645\u062a\u0651\u062d\u062f\u0629",countryCode:"AE",currencyCode:"AED",currencyNameEn:"United Arab Emirates dirham",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"971",areaCodes:[],region:"Arab States",flag:"\ud83c\udde6\ud83c\uddea"},{countryNameEn:"Republic of Moldova",countryNameLocal:"Moldova, \u041c\u043e\u043b\u0434\u0430\u0432\u0438\u044f",countryCode:"MD",currencyCode:"MDL",currencyNameEn:"Moldovan leu",tinType:"",tinName:"",officialLanguageCode:"ro",officialLanguageNameEn:"Romanian, Moldavian, Moldovan",officialLanguageNameLocal:"Rom\xe2n\u0103",countryCallingCode:"373",areaCodes:[],region:"Europe",flag:"\ud83c\uddf2\ud83c\udde9"},{countryNameEn:"Gambia",countryNameLocal:"The Gambia",countryCode:"GM",currencyCode:"GMD",currencyNameEn:"Gambian dalasi",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"220",areaCodes:[],region:"Africa",flag:"\ud83c\uddec\ud83c\uddf2"},{countryNameEn:"Dominican Republic",countryNameLocal:"Rep\xfablica Dominicana",countryCode:"DO",currencyCode:"DOP",currencyNameEn:"Dominican peso",tinType:"RNC",tinName:"Registro Nacional del Contribuyente",officialLanguageCode:"es",officialLanguageNameEn:"Spanish, Castilian",officialLanguageNameLocal:"Espa\xf1ol",countryCallingCode:"1",areaCodes:[],region:"South/Latin America",flag:"\ud83c\udde9\ud83c\uddf4"},{countryNameEn:"Sudan",countryNameLocal:"\u0627\u0644\u0633\u0648\u062f\u0627\u0646",countryCode:"SD",currencyCode:"SDG",currencyNameEn:"Sudanese pound",tinType:"",tinName:"",officialLanguageCode:"ar",officialLanguageNameEn:"Arabic",officialLanguageNameLocal:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",countryCallingCode:"249",areaCodes:[],region:"Arab States",flag:"\ud83c\uddf8\ud83c\udde9"},{countryNameEn:"Lao People's Democratic Republic",countryNameLocal:"\u0e9b\u0eb0\u0e8a\u0eb2\u0e8a\u0ebb\u0e99\u0ea5\u0eb2\u0ea7",countryCode:"LA",currencyCode:"LAK",currencyNameEn:"Lao kip",tinType:"",tinName:"",officialLanguageCode:"lo",officialLanguageNameEn:"Lao",officialLanguageNameLocal:"\u0e9e\u0eb2\u0eaa\u0eb2\u0ea5\u0eb2\u0ea7",countryCallingCode:"856",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf1\ud83c\udde6"},{countryNameEn:"Taiwan, Province of China",countryNameLocal:"Taiwan",countryCode:"TW",currencyCode:"TWD",currencyNameEn:"New Taiwan dollar",tinType:"",tinName:"",officialLanguageCode:"zh-hant",officialLanguageNameEn:"",officialLanguageNameLocal:"",countryCallingCode:"886",areaCodes:[],region:"Asia & Pacific",flag:"\ud83c\uddf9\ud83c\uddfc"},{countryNameEn:"Republic of the Congo",countryNameLocal:"R\xe9publique du Congo",countryCode:"CG",currencyCode:"XAF",currencyNameEn:"CFA franc BEAC",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"242",areaCodes:[],region:"Africa",flag:"\ud83c\udde8\ud83c\uddec"},{countryNameEn:"Czechia",countryNameLocal:"\u010cesk\xe1 republika",countryCode:"CZ",currencyCode:"CZK",currencyNameEn:"Czech koruna",tinType:"DI\u010c",tinName:"Da\u0148ov\xe9 identifika\u010dn\xed \u010d\xedslo",officialLanguageCode:"cs",officialLanguageNameEn:"Czech",officialLanguageNameLocal:"\u010ce\u0161tina",countryCallingCode:"420",areaCodes:[],region:"Europe",flag:"\ud83c\udde8\ud83c\uddff"},{countryNameEn:"United Kingdom",countryNameLocal:"Great Britain",countryCode:"GB",currencyCode:"GBP",currencyNameEn:"Pound sterling",tinType:"VAT Reg No",tinName:"Value added tax registration number",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"44",areaCodes:[],region:"Europe",flag:"\ud83c\uddec\ud83c\udde7"},{countryNameEn:"Niger",countryNameLocal:"Niger",countryCode:"NE",currencyCode:"XOF",currencyNameEn:"CFA franc BCEAO",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"227",areaCodes:[],region:"Africa",flag:"\ud83c\uddf3\ud83c\uddea"},{countryNameEn:"Democratic Republic of the Congo",countryNameLocal:"Democratic Republic of the Congo",countryCode:"CD",currencyCode:"CDF",currencyNameEn:"Congolese franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"243",areaCodes:[],region:"Africa",flag:"\ud83c\udde8\ud83c\udde9"},{countryNameEn:"Commonwealth of The Bahamas",countryNameLocal:"Commonwealth of The Bahamas",countryCode:"BS",currencyCode:"BSD",currencyNameEn:"Bahamian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 242",areaCodes:[],region:"Caribbean",flag:"\ud83c\udde7\ud83c\uddf8"},{countryNameEn:"Cocos (Keeling) Islands",countryNameLocal:"Pulu Kokos (Keeling)",countryCode:"CC",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"61 891",areaCodes:[],region:"Australia",flag:"\ud83c\udde8\ud83c\udde8"},{countryNameEn:"Central African Republic",countryNameLocal:"R\xe9publique centrafricaine",countryCode:"CF",currencyCode:"XAF",currencyNameEn:"Central African CFA",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"236",areaCodes:[],region:"Africa",flag:"\ud83c\udde8\ud83c\uddeb"},{countryNameEn:"Cook Islands",countryNameLocal:"K\u016bki '\u0100irani",countryCode:"CK",currencyCode:"NZD",currencyNameEn:"New Zealand dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"682",areaCodes:[],region:"South Pacific Ocean",flag:"\ud83c\udde8\ud83c\uddf0"},{countryNameEn:"Falkland Islands",countryNameLocal:"Falkland Islands",countryCode:"FK",currencyCode:"FKP",currencyNameEn:"Falklands pound",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"500",areaCodes:[],region:"South Atlantic Ocean",flag:"\ud83c\uddeb\ud83c\uddf0"},{countryNameEn:"Faroe Islands",countryNameLocal:"F\xe6r\xf8erne",countryCode:"FO",currencyCode:"DKK",currencyNameEn:"Faroese kr\xf3na",tinType:"",tinName:"",officialLanguageCode:"da",officialLanguageNameEn:"Danish",officialLanguageNameLocal:"dansk",countryCallingCode:"298",areaCodes:[],region:"Europe",flag:"\ud83c\uddeb\ud83c\uddf4"},{countryNameEn:"Territory of Heard Island and McDonald Islands",countryNameLocal:"Territory of Heard Island and McDonald Islands",countryCode:"HM",currencyCode:"AUD",currencyNameEn:"Australian dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"672",areaCodes:[],region:"Indian Ocean",flag:"\ud83c\udded\ud83c\uddf2"},{countryNameEn:"British Indian Ocean Territory",countryNameLocal:"British Indian Ocean Territory",countryCode:"IO",currencyCode:"USD",currencyNameEn:"United States Dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"246",areaCodes:[],region:"Indian Ocean",flag:"\ud83c\uddee\ud83c\uddf4"},{countryNameEn:"Comoros",countryNameLocal:"Umoja wa Komori",countryCode:"KM",currencyCode:"KMF",currencyNameEn:"Comorian franc",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"269",areaCodes:[],region:"Indian Ocean",flag:"\ud83c\uddf0\ud83c\uddf2"},{countryNameEn:"Cayman Islands",countryNameLocal:"Cayman Islands",countryCode:"KY",currencyCode:"KYD",currencyNameEn:"Cayman Islands dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 345",areaCodes:[],region:"Caribbean Sea",flag:"\ud83c\uddf0\ud83c\uddfe"},{countryNameEn:"Republic of the Marshall Islands",countryNameLocal:"Aolep\u0101n Aor\u014dkin \u1e42aje\u1e37",countryCode:"MH",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"692",areaCodes:[],region:"Pacific Ocean",flag:"\ud83c\uddf2\ud83c\udded"},{countryNameEn:"Commonwealth of the Northern Mariana Islands",countryNameLocal:"Sankattan Siha Na Islas Mari\xe5nas",countryCode:"MP",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 670",areaCodes:[],region:"Pacific Ocean",flag:"\ud83c\uddf2\ud83c\uddf5"},{countryNameEn:"Turks and Caicos Islands",countryNameLocal:"Turks and Caicos Islands",countryCode:"TC",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1 649",areaCodes:[],region:"Atlantic Ocean",flag:"\ud83c\uddf9\ud83c\udde8"},{countryNameEn:"French Southern and Antarctic Lands",countryNameLocal:"Terres australes et antarctiques fran\xe7aises",countryCode:"TF",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"fr",officialLanguageNameEn:"French",officialLanguageNameLocal:"Fran\xe7ais",countryCallingCode:"672",areaCodes:[],region:"Indian Ocean",flag:"\ud83c\uddf9\ud83c\uddeb"},{countryNameEn:"United States Minor Outlying Islands",countryNameLocal:"United States Minor Outlying Islands",countryCode:"UM",currencyCode:"USD",currencyNameEn:"United States dollar",tinType:"",tinName:"",officialLanguageCode:"en",officialLanguageNameEn:"English",officialLanguageNameLocal:"English",countryCallingCode:"1",areaCodes:[],region:"Pacific Ocean",flag:"\ud83c\uddfa\ud83c\uddf2"},{countryNameEn:"Holy See",countryNameLocal:"Sancta Sedes",countryCode:"VA",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"la",officialLanguageNameEn:"Latin",officialLanguageNameLocal:"lingua lat\u012bna",countryCallingCode:"39",areaCodes:[],region:"Europe",flag:"\ud83c\uddfb\ud83c\udde6"},{countryNameEn:"Republic of Kosovo",countryNameLocal:"Republika e Kosov\xebs",countryCode:"XK",currencyCode:"EUR",currencyNameEn:"Euro",tinType:"",tinName:"",officialLanguageCode:"sq",officialLanguageNameEn:"Albanian",officialLanguageNameLocal:"Shqip",countryCallingCode:"383",region:"Europe",flag:"\ud83c\uddfd\ud83c\uddf0"},{countryNameEn:"Netherlands Antilles",countryNameLocal:"Nederlandse Antillen",countryCode:"AN",currencyCode:"ANG",currencyNameEn:"Netherlands Antillean guilder",tinType:"",tinName:"",officialLanguageCode:"nl",officialLanguageNameEn:"Dutch, Flemish",officialLanguageNameLocal:"Nederlands, Vlaams",countryCallingCode:"599",region:"Europe",flag:"\ud83c\udde7\ud83c\uddf6"}]},62658:function(e){e.exports=function(){"use strict";return function(e,t,n){n.updateLocale=function(e,t){var i=n.Ls[e];if(i)return(t?Object.keys(t):[]).forEach((function(e){i[e]=t[e]})),i}}}()},62983:(e,t,n)=>{"use strict";n.d(t,{A:()=>VC});var i={};n.r(i),n.d(i,{identity:()=>Ts});var r={};n.r(r),n.d(r,{base2:()=>Ps});var s={};n.r(s),n.d(s,{base8:()=>Ms});var a={};n.r(a),n.d(a,{base10:()=>Ns});var o={};n.r(o),n.d(o,{base16:()=>Is,base16upper:()=>Os});var l={};n.r(l),n.d(l,{base32:()=>Ds,base32hex:()=>Bs,base32hexpad:()=>zs,base32hexpadupper:()=>Fs,base32hexupper:()=>Us,base32pad:()=>Rs,base32padupper:()=>ks,base32upper:()=>Ls,base32z:()=>js});var c={};n.r(c),n.d(c,{base36:()=>Vs,base36upper:()=>Hs});var h={};n.r(h),n.d(h,{base58btc:()=>Ws,base58flickr:()=>Gs});var u={};n.r(u),n.d(u,{base64:()=>qs,base64pad:()=>Ks,base64url:()=>Ys,base64urlpad:()=>Qs});var d={};n.r(d),n.d(d,{base256emoji:()=>$s});var p={};n.r(p),n.d(p,{sha256:()=>Aa,sha512:()=>Sa});var f={};n.r(f),n.d(f,{identity:()=>Ta});var m={};n.r(m),n.d(m,{code:()=>Ma,decode:()=>Ia,encode:()=>Na,name:()=>Pa});var g={};n.r(g),n.d(g,{code:()=>Ra,decode:()=>Ba,encode:()=>ka,name:()=>La});var v=n(27284),y=n.n(v),b=n(33901);class w{}class x extends w{constructor(e){super()}}const E=b.FIVE_SECONDS,C="heartbeat_pulse";class A extends x{constructor(e){super(e),this.events=new v.EventEmitter,this.interval=E,this.interval=e?.interval||E}static async init(e){const t=new A(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval((()=>this.pulse()),(0,b.toMiliseconds)(this.interval))}pulse(){this.events.emit(C)}}const S=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,_=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,T=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function P(e,t){if(!("__proto__"===e||"constructor"===e&&t&&"object"===typeof t&&"prototype"in t))return t;!function(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}(e)}function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!==typeof e)return e;if('"'===e[0]&&'"'===e[e.length-1]&&-1===e.indexOf("\\"))return e.slice(1,-1);const n=e.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!T.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(S.test(e)||_.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,P)}return JSON.parse(e)}catch(i){if(t.strict)throw i;return e}}function N(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return(r=e(...n))&&"function"===typeof r.then?r:Promise.resolve(r)}catch(s){return Promise.reject(s)}var r}function I(e){if(function(e){const t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"===typeof e.toJSON)return I(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const O="base64:";function D(e){return"string"===typeof e?e:O+function(e){if(globalThis.Buffer)return Buffer.from(e).toString("base64");return globalThis.btoa(String.fromCodePoint(...e))}(e)}function L(e){return"string"!==typeof e?e:e.startsWith(O)?function(e){if(globalThis.Buffer)return Buffer.from(e,"base64");return Uint8Array.from(globalThis.atob(e),(e=>e.codePointAt(0)))}(e.slice(7)):e}function R(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function k(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return R(t.join(":"))}function B(e){return(e=R(e))?e+":":""}const U=()=>{const e=new Map;return{name:"memory",getInstance:()=>e,hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,n){e.set(t,n)},setItemRaw(t,n){e.set(t,n)},removeItem(t){e.delete(t)},getKeys:()=>[...e.keys()],clear(){e.clear()},dispose(){e.clear()}}};function z(){const e={mounts:{"":(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).driver||U()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=t=>{for(const n of e.mountpoints)if(t.startsWith(n))return{base:n,relativeKey:t.slice(n.length),driver:e.mounts[n]};return{base:"",relativeKey:t,driver:e.mounts[""]}},n=(t,n)=>e.mountpoints.filter((e=>e.startsWith(t)||n&&t.startsWith(e))).map((n=>({relativeBase:t.length>n.length?t.slice(n.length):void 0,mountpoint:n,driver:e.mounts[n]}))),i=(t,n)=>{if(e.watching){n=R(n);for(const i of e.watchListeners)i(t,n)}},r=async()=>{if(e.watching){for(const t in e.unwatch)await e.unwatch[t]();e.unwatch={},e.watching=!1}},s=(e,n,i)=>{const r=new Map,s=e=>{let t=r.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},r.set(e.base,t)),t};for(const a of e){const e="string"===typeof a,i=R(e?a:a.key),r=e?void 0:a.value,o=e||!a.options?n:{...n,...a.options},l=t(i);s(l).items.push({key:i,value:r,relativeKey:l.relativeKey,options:o})}return Promise.all([...r.values()].map((e=>i(e)))).then((e=>e.flat()))},a={hasItem(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=R(e);const{relativeKey:i,driver:r}=t(e);return N(r.hasItem,i,n)},getItem(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=R(e);const{relativeKey:i,driver:r}=t(e);return N(r.getItem,i,n).then((e=>M(e)))},getItems(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(e,t,(e=>e.driver.getItems?N(e.driver.getItems,e.items.map((e=>({key:e.relativeKey,options:e.options}))),t).then((t=>t.map((t=>({key:k(e.base,t.key),value:M(t.value)}))))):Promise.all(e.items.map((t=>N(e.driver.getItem,t.relativeKey,t.options).then((e=>({key:t.key,value:M(e)}))))))))},getItemRaw(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=R(e);const{relativeKey:i,driver:r}=t(e);return r.getItemRaw?N(r.getItemRaw,i,n):N(r.getItem,i,n).then((e=>L(e)))},async setItem(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(void 0===n)return a.removeItem(e);e=R(e);const{relativeKey:s,driver:o}=t(e);o.setItem&&(await N(o.setItem,s,I(n),r),o.watch||i("update",e))},async setItems(e,t){await s(e,t,(async e=>{if(e.driver.setItems)return N(e.driver.setItems,e.items.map((e=>({key:e.relativeKey,value:I(e.value),options:e.options}))),t);e.driver.setItem&&await Promise.all(e.items.map((t=>N(e.driver.setItem,t.relativeKey,I(t.value),t.options))))}))},async setItemRaw(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(void 0===n)return a.removeItem(e,r);e=R(e);const{relativeKey:s,driver:o}=t(e);if(o.setItemRaw)await N(o.setItemRaw,s,n,r);else{if(!o.setItem)return;await N(o.setItem,s,D(n),r)}o.watch||i("update",e)},async removeItem(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"===typeof n&&(n={removeMeta:n}),e=R(e);const{relativeKey:r,driver:s}=t(e);s.removeItem&&(await N(s.removeItem,r,n),(n.removeMeta||n.removeMata)&&await N(s.removeItem,r+"$",n),s.watch||i("remove",e))},async getMeta(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"===typeof n&&(n={nativeOnly:n}),e=R(e);const{relativeKey:i,driver:r}=t(e),s=Object.create(null);if(r.getMeta&&Object.assign(s,await N(r.getMeta,i,n)),!n.nativeOnly){const e=await N(r.getItem,i+"$",n).then((e=>M(e)));e&&"object"===typeof e&&("string"===typeof e.atime&&(e.atime=new Date(e.atime)),"string"===typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(s,e))}return s},setMeta(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setItem(e+"$",t,n)},removeMeta(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.removeItem(e+"$",t)},async getKeys(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=B(e);const i=n(e,!0);let r=[];const s=[];let a=!0;for(const n of i){n.driver.flags?.maxDepth||(a=!1);const e=await N(n.driver.getKeys,n.relativeBase,t);for(const t of e){const e=n.mountpoint+R(t);r.some((t=>e.startsWith(t)))||s.push(e)}r=[n.mountpoint,...r.filter((e=>!e.startsWith(n.mountpoint)))]}const o=void 0!==t.maxDepth&&!a;return s.filter((n=>(!o||function(e,t){if(void 0===t)return!0;let n=0,i=e.indexOf(":");for(;i>-1;)n++,i=e.indexOf(":",i+1);return n<=t}(n,t.maxDepth))&&function(e,t){return t?e.startsWith(t)&&"$"!==e[e.length-1]:"$"!==e[e.length-1]}(n,e)))},async clear(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=B(e),await Promise.all(n(e,!1).map((async e=>{if(e.driver.clear)return N(e.driver.clear,e.relativeBase,t);if(e.driver.removeItem){const n=await e.driver.getKeys(e.relativeBase||"",t);return Promise.all(n.map((n=>e.driver.removeItem(n,t))))}})))},async dispose(){await Promise.all(Object.values(e.mounts).map((e=>j(e))))},watch:async t=>(await(async()=>{if(!e.watching){e.watching=!0;for(const t in e.mounts)e.unwatch[t]=await F(e.mounts[t],i,t)}})(),e.watchListeners.push(t),async()=>{e.watchListeners=e.watchListeners.filter((e=>e!==t)),0===e.watchListeners.length&&await r()}),async unwatch(){e.watchListeners=[],await r()},mount(t,n){if((t=B(t))&&e.mounts[t])throw new Error(`already mounted at ${t}`);return t&&(e.mountpoints.push(t),e.mountpoints.sort(((e,t)=>t.length-e.length))),e.mounts[t]=n,e.watching&&Promise.resolve(F(n,i,t)).then((n=>{e.unwatch[t]=n})).catch(console.error),a},async unmount(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(t=B(t))&&e.mounts[t]&&(e.watching&&t in e.unwatch&&(e.unwatch[t]?.(),delete e.unwatch[t]),n&&await j(e.mounts[t]),e.mountpoints=e.mountpoints.filter((e=>e!==t)),delete e.mounts[t])},getMount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e=R(e)+":";const n=t(e);return{driver:n.driver,base:n.base}},getMounts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=R(e);return n(e,t.parents).map((e=>({driver:e.driver,base:e.mountpoint})))},keys:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.getKeys(e,t)},get:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.getItem(e,t)},set:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a.setItem(e,t,n)},has:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.hasItem(e,t)},del:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.removeItem(e,t)},remove:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.removeItem(e,t)}};return a}function F(e,t,n){return e.watch?e.watch(((e,i)=>t(e,n+i))):()=>{}}async function j(e){"function"===typeof e.dispose&&await N(e.dispose)}function V(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function H(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const i=V(n);return(e,n)=>i.then((i=>n(i.transaction(t,e).objectStore(t))))}let W;function G(){return W||(W=H("keyval-store","keyval")),W}function q(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:G())("readonly",(t=>V(t.get(e))))}function K(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},V(e.transaction)}var Y=n(48661);var Q=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.base&&e.base.length>0?`${e.base}:`:"",n=e=>t+e;let i;return e.dbName&&e.storeName&&(i=H(e.dbName,e.storeName)),{name:"idb-keyval",options:e,hasItem:async e=>!(typeof await q(n(e),i)>"u"),getItem:async e=>await q(n(e),i)??null,setItem:(e,t)=>function(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:G())("readwrite",(n=>(n.put(t,e),V(n.transaction))))}(n(e),t,i),removeItem:e=>function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:G())("readwrite",(t=>(t.delete(e),V(t.transaction))))}(n(e),i),getKeys:()=>function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:G())("readonly",(e=>{if(e.getAllKeys)return V(e.getAllKeys());const t=[];return K(e,(e=>t.push(e.key))).then((()=>t))}))}(i),clear:()=>function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:G())("readwrite",(e=>(e.clear(),V(e.transaction))))}(i)}};class X{constructor(){this.indexedDb=z({driver:Q({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map((e=>[e.key,e.value]))}async getItem(e){const t=await this.indexedDb.getItem(e);if(null!==t)return t}async setItem(e,t){await this.indexedDb.setItem(e,(0,Y.h)(t))}async removeItem(e){await this.indexedDb.removeItem(e)}}var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof n.g<"u"?n.g:typeof self<"u"?self:{},J={exports:{}};function $(e){var t;return[e[0],(0,Y.j)(null!=(t=e[1])?t:"")]}!function(){let e;function t(){}e=t,e.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){const e=this;Object.keys(e).forEach((function(t){e[t]=void 0,delete e[t]}))},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",(function(){return Object.keys(this).length})),typeof Z<"u"&&Z.localStorage?J.exports=Z.localStorage:typeof window<"u"&&window.localStorage?J.exports=window.localStorage:J.exports=new t}();class ee{constructor(){this.localStorage=J.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map($)}async getItem(e){const t=this.localStorage.getItem(e);if(null!==t)return(0,Y.j)(t)}async setItem(e,t){this.localStorage.setItem(e,(0,Y.h)(t))}async removeItem(e){this.localStorage.removeItem(e)}}const te=async(e,t)=>{t.length&&t.forEach((async t=>{await e.removeItem(t)}))};class ne{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};const e=new ee;this.storage=e;try{(async(e,t,n)=>{const i="wc_storage_version",r=await t.getItem(i);if(r&&r>=1)return void n(t);const s=await e.getKeys();if(!s.length)return void n(t);const a=[];for(;s.length;){const n=s.shift();if(!n)continue;const i=n.toLowerCase();if(i.includes("wc@")||i.includes("walletconnect")||i.includes("wc_")||i.includes("wallet_connect")){const i=await e.getItem(n);await t.setItem(n,i),a.push(n)}}await t.setItem(i,1),n(t),te(e,a)})(e,new X,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise((e=>{const t=setInterval((()=>{this.initialized&&(clearInterval(t),e())}),20)}))}}var ie=n(69397),re=Object.defineProperty,se=(e,t,n)=>((e,t,n)=>t in e?re(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class ae extends w{constructor(e){super(),this.opts=e,se(this,"protocol","wc"),se(this,"version",2)}}var oe=Object.defineProperty,le=(e,t,n)=>((e,t,n)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class ce extends w{constructor(e,t){super(),this.core=e,this.logger=t,le(this,"records",new Map)}}class he{constructor(e,t){this.logger=e,this.core=t}}class ue extends w{constructor(e,t){super(),this.relayer=e,this.logger=t}}class de extends w{constructor(e){super()}}class pe{constructor(e,t,n,i){this.core=e,this.logger=t,this.name=n}}Object.defineProperty;class fe extends w{constructor(e,t){super(),this.relayer=e,this.logger=t}}class me extends w{constructor(e,t){super(),this.core=e,this.logger=t}}class ge{constructor(e,t,n){this.core=e,this.logger=t,this.store=n}}class ve{constructor(e,t){this.projectId=e,this.logger=t}}class ye{constructor(e,t,n){this.core=e,this.logger=t,this.telemetryEnabled=n}}var be=Object.defineProperty,we=(e,t,n)=>((e,t,n)=>t in e?be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);y();class xe{constructor(e){this.opts=e,we(this,"protocol","wc"),we(this,"version",2)}}v.EventEmitter;class Ee{constructor(e){this.client=e}}function Ce(e){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function Ae(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}const Se="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,_e=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function Te(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),Ce(e),e}class Pe{clone(){return this._cloneInto()}}function Me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(Se&&"function"==typeof Se.getRandomValues)return Se.getRandomValues(new Uint8Array(e));if(Se&&"function"==typeof Se.randomBytes)return Se.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}class Ne extends Pe{constructor(e,t,n,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=_e(this.buffer)}update(e){Ae(this);const{view:t,buffer:n,blockLen:i}=this,r=(e=Te(e)).length;for(let s=0;s<r;){const a=Math.min(i-this.pos,r-s);if(a!==i)n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0);else{const t=_e(e);for(;i<=r-s;s+=i)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ae(this),function(e,t){Ce(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:r}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)t[h]=0;(function(e,t,n,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,i);const r=BigInt(32),s=BigInt(4294967295),a=Number(n>>r&s),o=Number(n&s),l=i?4:0,c=i?0:4;e.setUint32(t+l,a,i),e.setUint32(t+c,o,i)})(n,i-8,BigInt(8*this.length),r),this.process(n,0);const a=_e(e),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=o/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,c[h],r)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:r,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=r,e.destroyed=s,i%t&&e.buffer.set(n),e}}const Ie=BigInt(2**32-1),Oe=BigInt(32);function De(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&Ie),l:Number(e>>Oe&Ie)}:{h:0|Number(e>>Oe&Ie),l:0|Number(e&Ie)}}const Le={fromBig:De,split:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let r=0;r<e.length;r++){const{h:s,l:a}=De(e[r],t);[n[r],i[r]]=[s,a]}return[n,i]},toBig:(e,t)=>BigInt(e>>>0)<<Oe|BigInt(t>>>0),shrSH:(e,t,n)=>e>>>n,shrSL:(e,t,n)=>e<<32-n|t>>>n,rotrSH:(e,t,n)=>e>>>n|t<<32-n,rotrSL:(e,t,n)=>e<<32-n|t>>>n,rotrBH:(e,t,n)=>e<<64-n|t>>>n-32,rotrBL:(e,t,n)=>e>>>n-32|t<<64-n,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:(e,t,n)=>e<<n|t>>>32-n,rotlSL:(e,t,n)=>t<<n|e>>>32-n,rotlBH:(e,t,n)=>t<<n-32|e>>>64-n,rotlBL:(e,t,n)=>e<<n-32|t>>>64-n,add:function(e,t,n,i){const r=(t>>>0)+(i>>>0);return{h:e+n+(r/2**32|0)|0,l:0|r}},add3L:(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H:(e,t,n,i)=>t+n+i+(e/2**32|0)|0,add4L:(e,t,n,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),add4H:(e,t,n,i,r)=>t+n+i+r+(e/2**32|0)|0,add5H:(e,t,n,i,r,s)=>t+n+i+r+s+(e/2**32|0)|0,add5L:(e,t,n,i,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0)+(r>>>0)},[Re,ke]=Le.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))),Be=new Uint32Array(80),Ue=new Uint32Array(80);class ze extends Ne{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:i,Ch:r,Cl:s,Dh:a,Dl:o,Eh:l,El:c,Fh:h,Fl:u,Gh:d,Gl:p,Hh:f,Hl:m}=this;return[e,t,n,i,r,s,a,o,l,c,h,u,d,p,f,m]}set(e,t,n,i,r,s,a,o,l,c,h,u,d,p,f,m){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|i,this.Ch=0|r,this.Cl=0|s,this.Dh=0|a,this.Dl=0|o,this.Eh=0|l,this.El=0|c,this.Fh=0|h,this.Fl=0|u,this.Gh=0|d,this.Gl=0|p,this.Hh=0|f,this.Hl=0|m}process(e,t){for(let y=0;y<16;y++,t+=4)Be[y]=e.getUint32(t),Ue[y]=e.getUint32(t+=4);for(let y=16;y<80;y++){const e=0|Be[y-15],t=0|Ue[y-15],n=Le.rotrSH(e,t,1)^Le.rotrSH(e,t,8)^Le.shrSH(e,t,7),i=Le.rotrSL(e,t,1)^Le.rotrSL(e,t,8)^Le.shrSL(e,t,7),r=0|Be[y-2],s=0|Ue[y-2],a=Le.rotrSH(r,s,19)^Le.rotrBH(r,s,61)^Le.shrSH(r,s,6),o=Le.rotrSL(r,s,19)^Le.rotrBL(r,s,61)^Le.shrSL(r,s,6),l=Le.add4L(i,o,Ue[y-7],Ue[y-16]),c=Le.add4H(l,n,a,Be[y-7],Be[y-16]);Be[y]=0|c,Ue[y]=0|l}let{Ah:n,Al:i,Bh:r,Bl:s,Ch:a,Cl:o,Dh:l,Dl:c,Eh:h,El:u,Fh:d,Fl:p,Gh:f,Gl:m,Hh:g,Hl:v}=this;for(let y=0;y<80;y++){const e=Le.rotrSH(h,u,14)^Le.rotrSH(h,u,18)^Le.rotrBH(h,u,41),t=Le.rotrSL(h,u,14)^Le.rotrSL(h,u,18)^Le.rotrBL(h,u,41),b=h&d^~h&f,w=u&p^~u&m,x=Le.add5L(v,t,w,ke[y],Ue[y]),E=Le.add5H(x,g,e,b,Re[y],Be[y]),C=0|x,A=Le.rotrSH(n,i,28)^Le.rotrBH(n,i,34)^Le.rotrBH(n,i,39),S=Le.rotrSL(n,i,28)^Le.rotrBL(n,i,34)^Le.rotrBL(n,i,39),_=n&r^n&a^r&a,T=i&s^i&o^s&o;g=0|f,v=0|m,f=0|d,m=0|p,d=0|h,p=0|u,({h:h,l:u}=Le.add(0|l,0|c,0|E,0|C)),l=0|a,c=0|o,a=0|r,o=0|s,r=0|n,s=0|i;const P=Le.add3L(C,S,T);n=Le.add3H(P,E,A,_),i=0|P}({h:n,l:i}=Le.add(0|this.Ah,0|this.Al,0|n,0|i)),({h:r,l:s}=Le.add(0|this.Bh,0|this.Bl,0|r,0|s)),({h:a,l:o}=Le.add(0|this.Ch,0|this.Cl,0|a,0|o)),({h:l,l:c}=Le.add(0|this.Dh,0|this.Dl,0|l,0|c)),({h:h,l:u}=Le.add(0|this.Eh,0|this.El,0|h,0|u)),({h:d,l:p}=Le.add(0|this.Fh,0|this.Fl,0|d,0|p)),({h:f,l:m}=Le.add(0|this.Gh,0|this.Gl,0|f,0|m)),({h:g,l:v}=Le.add(0|this.Hh,0|this.Hl,0|g,0|v)),this.set(n,i,r,s,a,o,l,c,h,u,d,p,f,m,g,v)}roundClean(){Be.fill(0),Ue.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Fe=function(e){const t=t=>e().update(Te(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}((()=>new ze)),je=BigInt(0),Ve=BigInt(1),He=BigInt(2);function We(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Ge(e){if(!We(e))throw new Error("Uint8Array expected")}function qe(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}const Ke=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Ye(e){Ge(e);let t="";for(let n=0;n<e.length;n++)t+=Ke[e[n]];return t}function Qe(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?je:BigInt("0x"+e)}const Xe=48,Ze=57,Je=65,$e=70,et=97,tt=102;function nt(e){return e>=Xe&&e<=Ze?e-Xe:e>=Je&&e<=$e?e-(Je-10):e>=et&&e<=tt?e-(et-10):void 0}function it(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const i=new Uint8Array(n);for(let r=0,s=0;r<n;r++,s+=2){const t=nt(e.charCodeAt(s)),n=nt(e.charCodeAt(s+1));if(void 0===t||void 0===n){const t=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+s)}i[r]=16*t+n}return i}function rt(e){return Ge(e),Qe(Ye(Uint8Array.from(e).reverse()))}function st(e,t){return it(e.toString(16).padStart(2*t,"0"))}function at(e,t){return st(e,t).reverse()}function ot(e,t,n){let i;if("string"==typeof t)try{i=it(t)}catch(E){throw new Error(e+" must be hex string or Uint8Array, cause: "+E)}else{if(!We(t))throw new Error(e+" must be hex string or Uint8Array");i=Uint8Array.from(t)}const r=i.length;if("number"==typeof n&&r!==n)throw new Error(e+" of length "+n+" expected, got "+r);return i}function lt(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];Ge(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,i=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,i),i+=e.length}return t}const ct=e=>"bigint"==typeof e&&je<=e;function ht(e,t,n,i){if(!function(e,t,n){return ct(e)&&ct(t)&&ct(n)&&t<=e&&e<n}(t,n,i))throw new Error("expected valid "+e+": "+n+" <= n < "+i+", got "+t)}const ut=e=>(He<<BigInt(e-1))-Ve,dt={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||We(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function pt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=(t,n,i)=>{const r=dt[n];if("function"!=typeof r)throw new Error("invalid validator function");const s=e[t];if((!i||void 0!==s)&&!r(s,e))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+s)};for(const[r,s]of Object.entries(t))i(r,s,!1);for(const[r,s]of Object.entries(n))i(r,s,!0);return e}function ft(e){const t=new WeakMap;return function(n){const i=t.get(n);if(void 0!==i)return i;for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const o=e(n,...s);return t.set(n,o),o}}const mt=BigInt(0),gt=BigInt(1),vt=BigInt(2),yt=BigInt(3),bt=BigInt(4),wt=BigInt(5),xt=BigInt(8);function Et(e,t){const n=e%t;return n>=mt?n:t+n}function Ct(e,t,n){if(t<mt)throw new Error("invalid exponent, negatives unsupported");if(n<=mt)throw new Error("invalid modulus");if(n===gt)return mt;let i=gt;for(;t>mt;)t&gt&&(i=i*e%n),e=e*e%n,t>>=gt;return i}function At(e,t,n){let i=e;for(;t-- >mt;)i*=i,i%=n;return i}function St(e,t){if(e===mt)throw new Error("invert: expected non-zero number");if(t<=mt)throw new Error("invert: expected positive modulus, got "+t);let n=Et(e,t),i=t,r=mt,s=gt;for(;n!==mt;){const e=i%n,t=r-s*(i/n);i=n,n=e,r=s,s=t}if(i!==gt)throw new Error("invert: does not exist");return Et(r,t)}function _t(e){if(e%bt===yt){const t=(e+gt)/bt;return function(e,n){const i=e.pow(n,t);if(!e.eql(e.sqr(i),n))throw new Error("Cannot find square root");return i}}if(e%xt===wt){const t=(e-wt)/xt;return function(e,n){const i=e.mul(n,vt),r=e.pow(i,t),s=e.mul(n,r),a=e.mul(e.mul(s,vt),r),o=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),n))throw new Error("Cannot find square root");return o}}return function(e){const t=(e-gt)/vt;let n,i,r;for(n=e-gt,i=0;n%vt===mt;n/=vt,i++);for(r=vt;r<e&&Ct(r,t,e)!==e-gt;r++)if(r>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===i){const t=(e+gt)/bt;return function(e,n){const i=e.pow(n,t);if(!e.eql(e.sqr(i),n))throw new Error("Cannot find square root");return i}}const s=(n+gt)/vt;return function(e,a){if(e.pow(a,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let o=i,l=e.pow(e.mul(e.ONE,r),n),c=e.pow(a,s),h=e.pow(a,n);for(;!e.eql(h,e.ONE);){if(e.eql(h,e.ZERO))return e.ZERO;let t=1;for(let i=e.sqr(h);t<o&&!e.eql(i,e.ONE);t++)i=e.sqr(i);const n=e.pow(l,gt<<BigInt(o-t-1));l=e.sqr(n),c=e.mul(c,n),h=e.mul(h,l),o=t}return c}}(e)}const Tt=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Pt(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function Mt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=mt)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:r,nByteLength:s}=Pt(e,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let a;const o=Object.freeze({ORDER:e,isLE:n,BITS:r,BYTES:s,MASK:ut(r),ZERO:mt,ONE:gt,create:t=>Et(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return mt<=t&&t<e},is0:e=>e===mt,isOdd:e=>(e&gt)===gt,neg:t=>Et(-t,e),eql:(e,t)=>e===t,sqr:t=>Et(t*t,e),add:(t,n)=>Et(t+n,e),sub:(t,n)=>Et(t-n,e),mul:(t,n)=>Et(t*n,e),pow:(e,t)=>function(e,t,n){if(n<mt)throw new Error("invalid exponent, negatives unsupported");if(n===mt)return e.ONE;if(n===gt)return t;let i=e.ONE,r=t;for(;n>mt;)n&gt&&(i=e.mul(i,r)),r=e.sqr(r),n>>=gt;return i}(o,e,t),div:(t,n)=>Et(t*St(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>St(t,e),sqrt:i.sqrt||(t=>(a||(a=_t(e)),a(o,t))),invertBatch:e=>function(e,t){const n=new Array(t.length),i=t.reduce(((t,i,r)=>e.is0(i)?t:(n[r]=t,e.mul(t,i))),e.ONE),r=e.inv(i);return t.reduceRight(((t,i,r)=>e.is0(i)?t:(n[r]=e.mul(t,n[r]),e.mul(t,i))),r),n}(o,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?at(e,s):st(e,s),fromBytes:e=>{if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return n?rt(e):function(e){return Qe(Ye(e))}(e)}});return Object.freeze(o)}const Nt=BigInt(0),It=BigInt(1);function Ot(e,t){const n=t.negate();return e?n:t}function Dt(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Lt(e,t){Dt(e,t);return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}const Rt=new WeakMap,kt=new WeakMap;function Bt(e){return kt.get(e)||1}function Ut(e,t,n,i){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)}))}(n,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)}))}(i,t),n.length!==i.length)throw new Error("arrays of points and scalars must have equal length");const r=e.ZERO,s=function(e){let t;for(t=0;e>je;e>>=Ve,t+=1);return t}(BigInt(n.length)),a=s>12?s-3:s>4?s-2:s?2:1,o=(1<<a)-1,l=new Array(o+1).fill(r);let c=r;for(let h=Math.floor((t.BITS-1)/a)*a;h>=0;h-=a){l.fill(r);for(let t=0;t<i.length;t++){const e=i[t],r=Number(e>>BigInt(h)&BigInt(o));l[r]=l[r].add(n[t])}let e=r;for(let t=l.length-1,n=r;t>0;t--)n=n.add(l[t]),e=e.add(n);if(c=c.add(e),0!==h)for(let t=0;t<a;t++)c=c.double()}return c}function zt(e){return function(e){const t=Tt.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});pt(e,t)}(e.Fp),pt(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Pt(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const Ft=BigInt(0),jt=BigInt(1),Vt=BigInt(2),Ht=BigInt(8),Wt={zip215:!0};function Gt(e){const t=function(e){const t=zt(e);return pt(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:n,n:i,prehash:r,hash:s,randomBytes:a,nByteLength:o,h:l}=t,c=Vt<<BigInt(8*o)-jt,h=n.create,u=Mt(t.n,t.nBitLength),d=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:n.sqrt(e*n.inv(t))}}catch{return{isValid:!1,value:Ft}}}),p=t.adjustScalarBytes||(e=>e),f=t.domain||((e,t,n)=>{if(qe("phflag",n),t.length||n)throw new Error("Contexts/pre-hash are not supported");return e});function m(e,t){ht("coordinate "+e,t,Ft,c)}function g(e){if(!(e instanceof b))throw new Error("ExtendedPoint expected")}const v=ft(((e,t)=>{const{ex:i,ey:r,ez:s}=e,a=e.is0();null==t&&(t=a?Ht:n.inv(s));const o=h(i*t),l=h(r*t),c=h(s*t);if(a)return{x:Ft,y:jt};if(c!==jt)throw new Error("invZ was invalid");return{x:o,y:l}})),y=ft((e=>{const{a:n,d:i}=t;if(e.is0())throw new Error("bad point: ZERO");const{ex:r,ey:s,ez:a,et:o}=e,l=h(r*r),c=h(s*s),u=h(a*a),d=h(u*u),p=h(l*n);if(h(u*h(p+c))!==h(d+h(i*h(l*c))))throw new Error("bad point: equation left != right (1)");if(h(r*s)!==h(a*o))throw new Error("bad point: equation left != right (2)");return!0}));class b{constructor(e,t,n,i){this.ex=e,this.ey=t,this.ez=n,this.et=i,m("x",e),m("y",t),m("z",n),m("t",i),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof b)throw new Error("extended point not allowed");const{x:t,y:n}=e||{};return m("x",t),m("y",n),new b(t,n,jt,h(t*n))}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.ez)));return e.map(((e,n)=>e.toAffine(t[n]))).map(b.fromAffine)}static msm(e,t){return Ut(b,u,e,t)}_setWindowSize(e){E.setWindowSize(this,e)}assertValidity(){y(this)}equals(e){g(e);const{ex:t,ey:n,ez:i}=this,{ex:r,ey:s,ez:a}=e,o=h(t*a),l=h(r*i),c=h(n*a),u=h(s*i);return o===l&&c===u}is0(){return this.equals(b.ZERO)}negate(){return new b(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){const{a:e}=t,{ex:n,ey:i,ez:r}=this,s=h(n*n),a=h(i*i),o=h(Vt*h(r*r)),l=h(e*s),c=n+i,u=h(h(c*c)-s-a),d=l+a,p=d-o,f=l-a,m=h(u*p),g=h(d*f),v=h(u*f),y=h(p*d);return new b(m,g,y,v)}add(e){g(e);const{a:n,d:i}=t,{ex:r,ey:s,ez:a,et:o}=this,{ex:l,ey:c,ez:u,et:d}=e;if(n===BigInt(-1)){const e=h((s-r)*(c+l)),t=h((s+r)*(c-l)),n=h(t-e);if(n===Ft)return this.double();const i=h(a*Vt*d),p=h(o*Vt*u),f=p+i,m=t+e,g=p-i,v=h(f*n),y=h(m*g),w=h(f*g),x=h(n*m);return new b(v,y,x,w)}const p=h(r*l),f=h(s*c),m=h(o*i*d),v=h(a*u),y=h((r+s)*(l+c)-p-f),w=v-m,x=v+m,E=h(f-n*p),C=h(y*w),A=h(x*E),S=h(y*E),_=h(w*x);return new b(C,A,_,S)}subtract(e){return this.add(e.negate())}wNAF(e){return E.wNAFCached(this,e,b.normalizeZ)}multiply(e){const t=e;ht("scalar",t,jt,i);const{p:n,f:r}=this.wNAF(t);return b.normalizeZ([n,r])[0]}multiplyUnsafe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.ZERO;const n=e;return ht("scalar",n,Ft,i),n===Ft?x:this.is0()||n===jt?this:E.wNAFCachedUnsafe(this,n,b.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return E.unsafeLadder(this,i).is0()}toAffine(e){return v(this,e)}clearCofactor(){const{h:e}=t;return e===jt?this:this.multiplyUnsafe(e)}static fromHex(e){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{d:r,a:s}=t,a=n.BYTES;e=ot("pointHex",e,a),qe("zip215",i);const o=e.slice(),l=e[a-1];o[a-1]=-129&l;const u=rt(o),p=i?c:n.ORDER;ht("pointHex.y",u,Ft,p);const f=h(u*u),m=h(f-jt),g=h(r*f-s);let{isValid:v,value:y}=d(m,g);if(!v)throw new Error("Point.fromHex: invalid y coordinate");const w=(y&jt)===jt,x=0!==(128&l);if(!i&&y===Ft&&x)throw new Error("Point.fromHex: x=0 and x_0=1");return x!==w&&(y=h(-y)),b.fromAffine({x:y,y:u})}static fromPrivateKey(e){return S(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),i=at(t,n.BYTES);return i[i.length-1]|=e&jt?128:0,i}toHex(){return Ye(this.toRawBytes())}}b.BASE=new b(t.Gx,t.Gy,jt,h(t.Gx*t.Gy)),b.ZERO=new b(Ft,jt,jt,Ft);const{BASE:w,ZERO:x}=b,E=function(e,t){return{constTimeNegate:Ot,hasPrecomputes:e=>1!==Bt(e),unsafeLadder(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ZERO,r=t;for(;n>Nt;)n&It&&(i=i.add(r)),r=r.double(),n>>=It;return i},precomputeWindow(e,n){const{windows:i,windowSize:r}=Lt(n,t),s=[];let a=e,o=a;for(let t=0;t<i;t++){o=a,s.push(o);for(let e=1;e<r;e++)o=o.add(a),s.push(o);a=o.double()}return s},wNAF(n,i,r){const{windows:s,windowSize:a}=Lt(n,t);let o=e.ZERO,l=e.BASE;const c=BigInt(2**n-1),h=2**n,u=BigInt(n);for(let e=0;e<s;e++){const t=e*a;let n=Number(r&c);r>>=u,n>a&&(n-=h,r+=It);const s=t,d=t+Math.abs(n)-1,p=e%2!==0,f=n<0;0===n?l=l.add(Ot(p,i[s])):o=o.add(Ot(f,i[d]))}return{p:o,f:l}},wNAFUnsafe(n,i,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.ZERO;const{windows:a,windowSize:o}=Lt(n,t),l=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let e=0;e<a;e++){const t=e*o;if(r===Nt)break;let n=Number(r&l);if(r>>=h,n>o&&(n-=c,r+=It),0===n)continue;let a=i[t+Math.abs(n)-1];n<0&&(a=a.negate()),s=s.add(a)}return s},getPrecomputes(e,t,n){let i=Rt.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&Rt.set(t,n(i))),i},wNAFCached(e,t,n){const i=Bt(e);return this.wNAF(i,this.getPrecomputes(i,e,n),t)},wNAFCachedUnsafe(e,t,n,i){const r=Bt(e);return 1===r?this.unsafeLadder(e,t,i):this.wNAFUnsafe(r,this.getPrecomputes(r,e,n),t,i)},setWindowSize(e,n){Dt(n,t),kt.set(e,n),Rt.delete(e)}}}(b,8*o);function C(e){return Et(e,i)}function A(e){return C(rt(e))}function S(e){const t=n.BYTES;e=ot("private key",e,t);const i=ot("hashed private key",s(e),2*t),r=p(i.slice(0,t)),a=i.slice(t,2*t),o=A(r),l=w.multiply(o),c=l.toRawBytes();return{head:r,prefix:a,scalar:o,point:l,pointBytes:c}}function _(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array;for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const a=lt(...n);return A(s(f(a,ot("context",e),!!r)))}const T=Wt;return w._setWindowSize(8),{CURVE:t,getPublicKey:function(e){return S(e).pointBytes},sign:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=ot("message",e),r&&(e=r(e));const{prefix:a,scalar:o,pointBytes:l}=S(t),c=_(s.context,a,e),h=w.multiply(c).toRawBytes(),u=C(c+_(s.context,h,l,e)*o);return ht("signature.s",u,Ft,i),ot("result",lt(h,at(u,n.BYTES)),2*n.BYTES)},verify:function(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T;const{context:a,zip215:o}=s,l=n.BYTES;e=ot("signature",e,2*l),t=ot("message",t),i=ot("publicKey",i,l),void 0!==o&&qe("zip215",o),r&&(t=r(t));const c=rt(e.slice(l,2*l));let h,u,d;try{h=b.fromHex(i,o),u=b.fromHex(e.slice(0,l),o),d=w.multiplyUnsafe(c)}catch{return!1}if(!o&&h.isSmallOrder())return!1;const p=_(a,u.toRawBytes(),h.toRawBytes(),t);return u.add(h.multiplyUnsafe(p)).subtract(d).clearCofactor().equals(b.ZERO)},ExtendedPoint:b,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>a(n.BYTES),precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}}}}BigInt(0),BigInt(1);const qt=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Kt=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Yt=BigInt(1),Qt=BigInt(2);BigInt(3);const Xt=BigInt(5),Zt=BigInt(8);function Jt(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function $t(e,t){const n=qt,i=Et(t*t*t,n),r=function(e){const t=BigInt(10),n=BigInt(20),i=BigInt(40),r=BigInt(80),s=qt,a=e*e%s*e%s,o=At(a,Qt,s)*a%s,l=At(o,Yt,s)*e%s,c=At(l,Xt,s)*l%s,h=At(c,t,s)*c%s,u=At(h,n,s)*h%s,d=At(u,i,s)*u%s,p=At(d,r,s)*d%s,f=At(p,r,s)*d%s,m=At(f,t,s)*c%s;return{pow_p_5_8:At(m,Qt,s)*e%s,b2:a}}(e*Et(i*i*t,n)).pow_p_5_8;let s=Et(e*i*r,n);const a=Et(t*s*s,n),o=s,l=Et(s*Kt,n),c=a===e,h=a===Et(-e,n),u=a===Et(-e*Kt,n);return c&&(s=o),(h||u)&&(s=l),((e,t)=>(Et(e,t)&gt)===gt)(s,n)&&(s=Et(-s,n)),{isValid:c||h,value:s}}const en=Mt(qt,void 0,!0),tn=Gt({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:en,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Zt,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Fe,randomBytes:Me,adjustScalarBytes:Jt,uvRatio:$t}),nn="EdDSA",rn=".",sn="base64url",an="utf8",on="utf8",ln="did",cn="key",hn="base58btc";function un(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function dn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?un(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function pn(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const n=dn(t);let i=0;for(const r of e)n.set(r,i),i+=r.length;return un(n)}var fn=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),i=0;i<n.length;i++)n[i]=255;for(var r=0;r<e.length;r++){var s=e.charAt(r),a=s.charCodeAt(0);if(255!==n[a])throw new TypeError(s+" is ambiguous");n[a]=r}var o=e.length,l=e.charAt(0),c=Math.log(o)/Math.log(256),h=Math.log(256)/Math.log(o);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var i=0,r=0;e[t]===l;)i++,t++;for(var s=(e.length-t)*c+1>>>0,a=new Uint8Array(s);e[t];){var h=n[e.charCodeAt(t)];if(255===h)return;for(var u=0,d=s-1;(0!==h||u<r)&&-1!==d;d--,u++)h+=o*a[d]>>>0,a[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");r=u,t++}if(" "!==e[t]){for(var p=s-r;p!==s&&0===a[p];)p++;for(var f=new Uint8Array(i+(s-p)),m=i;p!==s;)f[m++]=a[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,i=0,r=0,s=t.length;r!==s&&0===t[r];)r++,n++;for(var a=(s-r)*h+1>>>0,c=new Uint8Array(a);r!==s;){for(var u=t[r],d=0,p=a-1;(0!==u||d<i)&&-1!==p;p--,d++)u+=256*c[p]>>>0,c[p]=u%o>>>0,u=u/o>>>0;if(0!==u)throw new Error("Non-zero carry");i=d,r++}for(var f=a-i;f!==a&&0===c[f];)f++;for(var m=l.repeat(n);f<a;++f)m+=e.charAt(c[f]);return m},decodeUnsafe:u,decode:function(e){var n=u(e);if(n)return n;throw new Error(`Non-${t} character`)}}},mn=fn;const gn=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class vn{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class yn{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return wn(this,e)}}class bn{constructor(e){this.decoders=e}or(e){return wn(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const wn=(e,t)=>new bn({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class xn{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new vn(e,t,n),this.decoder=new yn(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const En=e=>{let{name:t,prefix:n,encode:i,decode:r}=e;return new xn(t,n,i,r)},Cn=e=>{let{prefix:t,name:n,alphabet:i}=e;const{encode:r,decode:s}=mn(i,n);return En({prefix:t,name:n,encode:r,decode:e=>gn(s(e))})},An=e=>{let{name:t,prefix:n,bitsPerChar:i,alphabet:r}=e;return En({prefix:n,name:t,encode:e=>((e,t,n)=>{const i="="===t[t.length-1],r=(1<<n)-1;let s="",a=0,o=0;for(let l=0;l<e.length;++l)for(o=o<<8|e[l],a+=8;a>n;)a-=n,s+=t[r&o>>a];if(a&&(s+=t[r&o<<n-a]),i)for(;s.length*n&7;)s+="=";return s})(e,r,i),decode:e=>((e,t,n,i)=>{const r={};for(let h=0;h<t.length;++h)r[t[h]]=h;let s=e.length;for(;"="===e[s-1];)--s;const a=new Uint8Array(s*n/8|0);let o=0,l=0,c=0;for(let h=0;h<s;++h){const t=r[e[h]];if(void 0===t)throw new SyntaxError(`Non-${i} character`);l=l<<n|t,o+=n,o>=8&&(o-=8,a[c++]=255&l>>o)}if(o>=n||255&l<<8-o)throw new SyntaxError("Unexpected end of data");return a})(e,r,i,t)})},Sn=En({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var _n=Object.freeze({__proto__:null,identity:Sn});const Tn=An({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Pn=Object.freeze({__proto__:null,base2:Tn});const Mn=An({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Nn=Object.freeze({__proto__:null,base8:Mn});const In=Cn({prefix:"9",name:"base10",alphabet:"0123456789"});var On=Object.freeze({__proto__:null,base10:In});const Dn=An({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ln=An({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Rn=Object.freeze({__proto__:null,base16:Dn,base16upper:Ln});const kn=An({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Bn=An({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Un=An({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zn=An({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fn=An({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),jn=An({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Vn=An({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Hn=An({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Wn=An({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Gn=Object.freeze({__proto__:null,base32:kn,base32upper:Bn,base32pad:Un,base32padupper:zn,base32hex:Fn,base32hexupper:jn,base32hexpad:Vn,base32hexpadupper:Hn,base32z:Wn});const qn=Cn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Kn=Cn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Yn=Object.freeze({__proto__:null,base36:qn,base36upper:Kn});const Qn=Cn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Xn=Cn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Zn=Object.freeze({__proto__:null,base58btc:Qn,base58flickr:Xn});const Jn=An({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$n=An({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ei=An({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ti=An({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ni=Object.freeze({__proto__:null,base64:Jn,base64pad:$n,base64url:ei,base64urlpad:ti});const ii=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),ri=ii.reduce(((e,t,n)=>(e[n]=t,e)),[]),si=ii.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const ai=En({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=ri[t]),"")},decode:function(e){const t=[];for(const n of e){const e=si[n.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${n}`);t.push(e)}return new Uint8Array(t)}});var oi=Object.freeze({__proto__:null,base256emoji:ai}),li=function e(t,n,i){n=n||[];for(var r=i=i||0;t>=ui;)n[i++]=255&t|ci,t/=128;for(;t&hi;)n[i++]=255&t|ci,t>>>=7;return n[i]=0|t,e.bytes=i-r+1,n},ci=128,hi=-128,ui=Math.pow(2,31);var di=function e(t,n){var i,r=0,s=(n=n||0,0),a=n,o=t.length;do{if(a>=o)throw e.bytes=0,new RangeError("Could not decode varint");i=t[a++],r+=s<28?(i&fi)<<s:(i&fi)*Math.pow(2,s),s+=7}while(i>=pi);return e.bytes=a-n,r},pi=128,fi=127;var mi=Math.pow(2,7),gi=Math.pow(2,14),vi=Math.pow(2,21),yi=Math.pow(2,28),bi=Math.pow(2,35),wi=Math.pow(2,42),xi=Math.pow(2,49),Ei=Math.pow(2,56),Ci=Math.pow(2,63),Ai={encode:li,decode:di,encodingLength:function(e){return e<mi?1:e<gi?2:e<vi?3:e<yi?4:e<bi?5:e<wi?6:e<xi?7:e<Ei?8:e<Ci?9:10}},Si=Ai;const _i=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Si.encode(e,t,n),t},Ti=e=>Si.encodingLength(e),Pi=(e,t)=>{const n=t.byteLength,i=Ti(e),r=i+Ti(n),s=new Uint8Array(r+n);return _i(e,s,0),_i(n,s,i),s.set(t,r),new Mi(e,n,t,s)};class Mi{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}}const Ni=e=>{let{name:t,code:n,encode:i}=e;return new Ii(t,n,i)};class Ii{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Pi(this.code,t):t.then((e=>Pi(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Oi=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Di=Ni({name:"sha2-256",code:18,encode:Oi("SHA-256")}),Li=Ni({name:"sha2-512",code:19,encode:Oi("SHA-512")});Object.freeze({__proto__:null,sha256:Di,sha512:Li});const Ri=gn,ki={code:0,name:"identity",encode:Ri,digest:e=>Pi(0,Ri(e))};Object.freeze({__proto__:null,identity:ki});new TextEncoder,new TextDecoder;const Bi={..._n,...Pn,...Nn,...On,...Rn,...Gn,...Yn,...Zn,...ni,...oi};function Ui(e,t,n,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:i}}}const zi=Ui("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Fi=Ui("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{const t=dn((e=e.substring(1)).length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),ji={utf8:zi,"utf-8":zi,hex:Bi.base16,latin1:Fi,ascii:Fi,binary:Fi,...Bi};function Vi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=ji[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function Hi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=ji[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):un(globalThis.Buffer.from(e,"utf-8"))}function Wi(e){return(0,Y.j)(Vi(Hi(e,sn),an))}function Gi(e){return Vi(Hi((0,Y.h)(e),an),sn)}function qi(e){const t="z"+Vi(pn([Hi("K36",hn),e]),hn);return[ln,cn,t].join(":")}function Ki(e){return Vi(e,sn)}function Yi(e){const t=e.split(rn),n=Wi(t[0]),i=Wi(t[1]),r=function(e){return Hi(e,sn)}(t[2]);return{header:n,payload:i,signature:r,data:Hi(t.slice(0,2).join(rn),on)}}function Qi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Me(32);const t=tn.getPublicKey(e);return{secretKey:pn([e,t]),publicKey:t}}async function Xi(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,b.fromMiliseconds)(Date.now());const s={alg:nn,typ:"JWT"},a={iss:qi(i.publicKey),sub:e,aud:t,iat:r,exp:r+n},o=function(e){return Hi([Gi(e.header),Gi(e.payload)].join(rn),on)}({header:s,payload:a});return function(e){return[Gi(e.header),Gi(e.payload),Ki(e.signature)].join(rn)}({header:s,payload:a,signature:tn.sign(o,i.secretKey.slice(0,32))})}var Zi=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,s=t.length;r<s;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Ji=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},$i=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},er=function(e,t,n,i){this.name=e,this.version=t,this.os=n,this.bot=i,this.type="bot-device"},tr=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},nr=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},ir=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,rr=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],sr=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ar(e){return e?lr(e):"undefined"===typeof document&&"undefined"!==typeof navigator&&"ReactNative"===navigator.product?new nr:"undefined"!==typeof navigator?lr(navigator.userAgent):"undefined"!==typeof process&&process.version?new $i(process.version.slice(1)):null}function or(e){return""!==e&&rr.reduce((function(t,n){var i=n[0],r=n[1];if(t)return t;var s=r.exec(e);return!!s&&[i,s]}),!1)}function lr(e){var t=or(e);if(!t)return null;var n=t[0],i=t[1];if("searchbot"===n)return new tr;var r=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);r?r.length<3&&(r=Zi(Zi([],r,!0),function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(3-r.length),!0)):r=[];var s=r.join("."),a=function(e){for(var t=0,n=sr.length;t<n;t++){var i=sr[t],r=i[0];if(i[1].exec(e))return r}return null}(e),o=ir.exec(e);return o&&o[1]?new er(n,s,a,o[1]):new Ji(n,s,a)}var cr=n(20033),hr=n(39332);const ur="2.23.2";let dr={getDocsUrl:e=>{let{docsBaseUrl:t,docsPath:n="",docsSlug:i}=e;return n?`${t??"https://viem.sh"}${n}${i?`#${i}`:""}`:void 0},version:`viem@${ur}`};class pr extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.cause instanceof pr?t.cause.details:t.cause?.message?t.cause.message:t.details,i=t.cause instanceof pr&&t.cause.docsPath||t.docsPath,r=dr.getDocsUrl?.({...t,docsPath:i});super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...r?[`Docs: ${r}`]:[],...n?[`Details: ${n}`]:[],...dr.version?[`Version: ${dr.version}`]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=i,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=ur}walk(e){return fr(this,e)}}function fr(e,t){return t?.(e)?e:e&&"object"===typeof e&&"cause"in e&&void 0!==e.cause?fr(e.cause,t):t?null:e}function mr(e){let{strict:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!!e&&("string"===typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")))}class gr extends pr{constructor(e){let{size:t,targetSize:n,type:i}=e;super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} size (${t}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function vr(e){let{dir:t,size:n=32}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"===typeof e?function(e){let{dir:t,size:n=32}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null===n)return e;const i=e.replace("0x","");if(i.length>2*n)throw new gr({size:Math.ceil(i.length/2),targetSize:n,type:"hex"});return`0x${i["right"===t?"padEnd":"padStart"](2*n,"0")}`}(e,{dir:t,size:n}):function(e){let{dir:t,size:n=32}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null===n)return e;if(e.length>n)throw new gr({size:e.length,targetSize:n,type:"bytes"});const i=new Uint8Array(n);for(let r=0;r<n;r++){const s="right"===t;i[s?r:n-r-1]=e[s?r:e.length-r-1]}return i}(e,{dir:t,size:n})}class yr extends pr{constructor(e){let{max:t,min:n,signed:i,size:r,value:s}=e;super(`Number "${s}" is not in safe ${r?`${8*r}-bit ${i?"signed":"unsigned"} `:""}integer range ${t?`(${n} to ${t})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class br extends pr{constructor(e){let{givenSize:t,maxSize:n}=e;super(`Size cannot exceed ${n} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}}function wr(e){return mr(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}function xr(e,t){let{size:n}=t;if(wr(e)>n)throw new br({givenSize:wr(e),maxSize:n})}function Er(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{signed:n}=t;t.size&&xr(e,{size:t.size});const i=BigInt(e);if(!n)return i;const r=(e.length-2)/2;return i<=(1n<<8n*BigInt(r)-1n)-1n?i:i-BigInt(`0x${"f".padStart(2*r,"f")}`)-1n}function Cr(e){return Number(Er(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}const Ar=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Sr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"number"===typeof e||"bigint"===typeof e?Tr(e,t):"string"===typeof e?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Pr.encode(e);return _r(n,t)}(e,t):"boolean"===typeof e?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=`0x${Number(e)}`;if("number"===typeof t.size)return xr(n,{size:t.size}),vr(n,{size:t.size});return n}(e,t):_r(e,t)}function _r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="";for(let r=0;r<e.length;r++)n+=Ar[e[r]];const i=`0x${n}`;return"number"===typeof t.size?(xr(i,{size:t.size}),vr(i,{dir:"right",size:t.size})):i}function Tr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{signed:n,size:i}=t,r=BigInt(e);let s;i?s=n?(1n<<8n*BigInt(i)-1n)-1n:2n**(8n*BigInt(i))-1n:"number"===typeof e&&(s=BigInt(Number.MAX_SAFE_INTEGER));const a="bigint"===typeof s&&n?-s-1n:0;if(s&&r>s||r<a){const t="bigint"===typeof e?"n":"";throw new yr({max:s?`${s}${t}`:void 0,min:`${a}${t}`,signed:n,size:i,value:`${e}${t}`})}const o=`0x${(n&&r<0?(1n<<BigInt(8*i))+BigInt(r):r).toString(16)}`;return i?vr(o,{size:i}):o}const Pr=new TextEncoder;const Mr=new TextEncoder;function Nr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"number"===typeof e||"bigint"===typeof e?function(e,t){const n=Tr(e,t);return Dr(n)}(e,t):"boolean"===typeof e?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new Uint8Array(1);if(n[0]=Number(e),"number"===typeof t.size)return xr(n,{size:t.size}),vr(n,{size:t.size});return n}(e,t):mr(e)?Dr(e,t):Lr(e,t)}const Ir={zero:48,nine:57,A:65,F:70,a:97,f:102};function Or(e){return e>=Ir.zero&&e<=Ir.nine?e-Ir.zero:e>=Ir.A&&e<=Ir.F?e-(Ir.A-10):e>=Ir.a&&e<=Ir.f?e-(Ir.a-10):void 0}function Dr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;t.size&&(xr(n,{size:t.size}),n=vr(n,{dir:"right",size:t.size}));let i=n.slice(2);i.length%2&&(i=`0${i}`);const r=i.length/2,s=new Uint8Array(r);for(let a=0,o=0;a<r;a++){const e=Or(i.charCodeAt(o++)),t=Or(i.charCodeAt(o++));if(void 0===e||void 0===t)throw new pr(`Invalid byte sequence ("${i[o-2]}${i[o-1]}" in "${i}").`);s[a]=16*e+t}return s}function Lr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Mr.encode(e);return"number"===typeof t.size?(xr(n,{size:t.size}),vr(n,{dir:"right",size:t.size})):n}var Rr=n(4498);const kr=BigInt(2**32-1),Br=BigInt(32);function Ur(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&kr),l:Number(e>>Br&kr)}:{h:0|Number(e>>Br&kr),l:0|Number(e&kr)}}function zr(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let r=0;r<e.length;r++){const{h:s,l:a}=Ur(e[r],t);[n[r],i[r]]=[s,a]}return[n,i]}const Fr=(e,t,n)=>e<<n|t>>>32-n,jr=(e,t,n)=>t<<n|e>>>32-n,Vr=(e,t,n)=>t<<n-32|e>>>64-n,Hr=(e,t,n)=>e<<n-32|t>>>64-n;var Wr=n(52461);const Gr=[],qr=[],Kr=[],Yr=BigInt(0),Qr=BigInt(1),Xr=BigInt(2),Zr=BigInt(7),Jr=BigInt(256),$r=BigInt(113);for(let HC=0,WC=Qr,GC=1,qC=0;HC<24;HC++){[GC,qC]=[qC,(2*GC+3*qC)%5],Gr.push(2*(5*qC+GC)),qr.push((HC+1)*(HC+2)/2%64);let e=Yr;for(let t=0;t<7;t++)WC=(WC<<Qr^(WC>>Zr)*$r)%Jr,WC&Xr&&(e^=Qr<<(Qr<<BigInt(t))-Qr);Kr.push(e)}const[es,ts]=zr(Kr,!0),ns=(e,t,n)=>n>32?Vr(e,t,n):Fr(e,t,n),is=(e,t,n)=>n>32?Hr(e,t,n):jr(e,t,n);class rs extends Wr.Vw{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=i,this.rounds=r,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,Rr.Fe)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,Wr.DH)(this.state)}keccak(){Wr.qv||(0,Wr.Fc)(this.state32),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;const n=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){const t=(i+8)%10,r=(i+2)%10,s=n[r],a=n[r+1],o=ns(s,a,1)^n[t],l=is(s,a,1)^n[t+1];for(let n=0;n<50;n+=10)e[i+n]^=o,e[i+n+1]^=l}let t=e[2],r=e[3];for(let n=0;n<24;n++){const i=qr[n],s=ns(t,r,i),a=is(t,r,i),o=Gr[n];t=e[o],r=e[o+1],e[o]=s,e[o+1]=a}for(let i=0;i<50;i+=10){for(let t=0;t<10;t++)n[t]=e[i+t];for(let t=0;t<10;t++)e[i+t]^=~n[(t+2)%10]&n[(t+4)%10]}e[0]^=es[i],e[1]^=ts[i]}n.fill(0)}(this.state32,this.rounds),Wr.qv||(0,Wr.Fc)(this.state32),this.posOut=0,this.pos=0}update(e){(0,Rr.CC)(this);const{blockLen:t,state:n}=this,i=(e=(0,Wr.ZJ)(e)).length;for(let r=0;r<i;){const s=Math.min(t-this.pos,i-r);for(let t=0;t<s;t++)n[this.pos++]^=e[r++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:i}=this;e[n]^=t,0!==(128&t)&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){(0,Rr.CC)(this,!1),(0,Rr.DO)(e),this.finish();const t=this.state,{blockLen:n}=this;for(let i=0,r=e.length;i<r;){this.posOut>=n&&this.keccak();const s=Math.min(n-this.posOut,r-i);e.set(t.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,Rr.Fe)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,Rr.Ht)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:i,rounds:r,enableXOF:s}=this;return e||(e=new rs(t,n,i,s,r)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=r,e.suffix=n,e.outputLen=i,e.enableXOF=s,e.destroyed=this.destroyed,e}}const ss=(e,t,n)=>(0,Wr.ld)((()=>new rs(t,e,n))),as=ss(1,136,32);function os(e,t){const n=t||"hex",i=as(mr(e,{strict:!1})?Nr(e):e);return"bytes"===n?i:Sr(i)}class ls extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const e=this.keys().next().value;e&&this.delete(e)}return this}}const cs=new ls(8192);function hs(e,t){if(cs.has(`${e}.${t}`))return cs.get(`${e}.${t}`);const n=t?`${t}${e.toLowerCase()}`:e.substring(2).toLowerCase(),i=os(Lr(n),"bytes"),r=(t?n.substring(`${t}0x`.length):n).split("");for(let a=0;a<40;a+=2)i[a>>1]>>4>=8&&r[a]&&(r[a]=r[a].toUpperCase()),(15&i[a>>1])>=8&&r[a+1]&&(r[a+1]=r[a+1].toUpperCase());const s=`0x${r.join("")}`;return cs.set(`${e}.${t}`,s),s}function us(e){if(0===e||1===e)return e;if(27===e)return 0;if(28===e)return 1;throw new Error("Invalid yParityOrV value")}async function ds(e){let{hash:t,signature:i}=e;return r=await async function(e){let{hash:t,signature:i}=e;const r=mr(t)?t:Sr(t),{secp256k1:s}=await n.e(2416).then(n.bind(n,22416)),a=(()=>{if("object"===typeof i&&"r"in i&&"s"in i){const{r:e,s:t,v:n,yParity:r}=i,a=us(Number(r??n));return new s.Signature(Er(e),Er(t)).addRecoveryBit(a)}const e=mr(i)?i:Sr(i),t=us(Cr(`0x${e.slice(130)}`));return s.Signature.fromCompact(e.substring(2,130)).addRecoveryBit(t)})();return`0x${a.recoverPublicKey(r.substring(2)).toHex(!1)}`}({hash:t,signature:i}),hs(`0x${os(`0x${r.substring(4)}`).substring(26)}`);var r}var ps=n(31666);function fs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function ms(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const n=fs(t);let i=0;for(const r of e)n.set(r,i),i+=r.length;return n}var gs=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),i=0;i<n.length;i++)n[i]=255;for(var r=0;r<e.length;r++){var s=e.charAt(r),a=s.charCodeAt(0);if(255!==n[a])throw new TypeError(s+" is ambiguous");n[a]=r}var o=e.length,l=e.charAt(0),c=Math.log(o)/Math.log(256),h=Math.log(256)/Math.log(o);function u(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var i=0,r=0;e[t]===l;)i++,t++;for(var s=(e.length-t)*c+1>>>0,a=new Uint8Array(s);e[t];){var h=n[e.charCodeAt(t)];if(255===h)return;for(var u=0,d=s-1;(0!==h||u<r)&&-1!==d;d--,u++)h+=o*a[d]>>>0,a[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");r=u,t++}if(" "!==e[t]){for(var p=s-r;p!==s&&0===a[p];)p++;for(var f=new Uint8Array(i+(s-p)),m=i;p!==s;)f[m++]=a[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,i=0,r=0,s=t.length;r!==s&&0===t[r];)r++,n++;for(var a=(s-r)*h+1>>>0,c=new Uint8Array(a);r!==s;){for(var u=t[r],d=0,p=a-1;(0!==u||d<i)&&-1!==p;p--,d++)u+=256*c[p]>>>0,c[p]=u%o>>>0,u=u/o>>>0;if(0!==u)throw new Error("Non-zero carry");i=d,r++}for(var f=a-i;f!==a&&0===c[f];)f++;for(var m=l.repeat(n);f<a;++f)m+=e.charAt(c[f]);return m},decodeUnsafe:u,decode:function(e){var n=u(e);if(n)return n;throw new Error(`Non-${t} character`)}}};const vs=gs,ys=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class bs{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ws{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Es(this,e)}}class xs{constructor(e){this.decoders=e}or(e){return Es(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Es=(e,t)=>new xs({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Cs{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new bs(e,t,n),this.decoder=new ws(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const As=e=>{let{name:t,prefix:n,encode:i,decode:r}=e;return new Cs(t,n,i,r)},Ss=e=>{let{prefix:t,name:n,alphabet:i}=e;const{encode:r,decode:s}=vs(i,n);return As({prefix:t,name:n,encode:r,decode:e=>ys(s(e))})},_s=e=>{let{name:t,prefix:n,bitsPerChar:i,alphabet:r}=e;return As({prefix:n,name:t,encode:e=>((e,t,n)=>{const i="="===t[t.length-1],r=(1<<n)-1;let s="",a=0,o=0;for(let l=0;l<e.length;++l)for(o=o<<8|e[l],a+=8;a>n;)a-=n,s+=t[r&o>>a];if(a&&(s+=t[r&o<<n-a]),i)for(;s.length*n&7;)s+="=";return s})(e,r,i),decode:e=>((e,t,n,i)=>{const r={};for(let h=0;h<t.length;++h)r[t[h]]=h;let s=e.length;for(;"="===e[s-1];)--s;const a=new Uint8Array(s*n/8|0);let o=0,l=0,c=0;for(let h=0;h<s;++h){const t=r[e[h]];if(void 0===t)throw new SyntaxError(`Non-${i} character`);l=l<<n|t,o+=n,o>=8&&(o-=8,a[c++]=255&l>>o)}if(o>=n||255&l<<8-o)throw new SyntaxError("Unexpected end of data");return a})(e,r,i,t)})},Ts=As({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Ps=_s({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ms=_s({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Ns=Ss({prefix:"9",name:"base10",alphabet:"0123456789"}),Is=_s({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Os=_s({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Ds=_s({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ls=_s({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Rs=_s({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ks=_s({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Bs=_s({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Us=_s({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),zs=_s({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Fs=_s({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),js=_s({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Vs=Ss({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Hs=Ss({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Ws=Ss({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Gs=Ss({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),qs=_s({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ks=_s({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ys=_s({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Qs=_s({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Xs=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),Zs=Xs.reduce(((e,t,n)=>(e[n]=t,e)),[]),Js=Xs.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const $s=As({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=Zs[t]),"")},decode:function(e){const t=[];for(const n of e){const e=Js[n.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${n}`);t.push(e)}return new Uint8Array(t)}});var ea=function e(t,n,i){n=n||[];var r=i=i||0;for(;t>=ia;)n[i++]=255&t|ta,t/=128;for(;t&na;)n[i++]=255&t|ta,t>>>=7;return n[i]=0|t,e.bytes=i-r+1,n},ta=128,na=-128,ia=Math.pow(2,31);var ra=function e(t,n){var i,r=0,s=0,a=n=n||0,o=t.length;do{if(a>=o)throw e.bytes=0,new RangeError("Could not decode varint");i=t[a++],r+=s<28?(i&aa)<<s:(i&aa)*Math.pow(2,s),s+=7}while(i>=sa);return e.bytes=a-n,r},sa=128,aa=127;var oa=Math.pow(2,7),la=Math.pow(2,14),ca=Math.pow(2,21),ha=Math.pow(2,28),ua=Math.pow(2,35),da=Math.pow(2,42),pa=Math.pow(2,49),fa=Math.pow(2,56),ma=Math.pow(2,63);const ga={encode:ea,decode:ra,encodingLength:function(e){return e<oa?1:e<la?2:e<ca?3:e<ha?4:e<ua?5:e<da?6:e<pa?7:e<fa?8:e<ma?9:10}},va=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ga.encode(e,t,n),t},ya=e=>ga.encodingLength(e),ba=(e,t)=>{const n=t.byteLength,i=ya(e),r=i+ya(n),s=new Uint8Array(r+n);return va(e,s,0),va(n,s,i),s.set(t,r),new wa(e,n,t,s)};class wa{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}}const xa=e=>{let{name:t,code:n,encode:i}=e;return new Ea(t,n,i)};class Ea{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ba(this.code,t):t.then((e=>ba(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Ca=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Aa=xa({name:"sha2-256",code:18,encode:Ca("SHA-256")}),Sa=xa({name:"sha2-512",code:19,encode:Ca("SHA-512")}),_a=ys,Ta={code:0,name:"identity",encode:_a,digest:e=>ba(0,_a(e))},Pa="raw",Ma=85,Na=e=>ys(e),Ia=e=>ys(e),Oa=new TextEncoder,Da=new TextDecoder,La="json",Ra=512,ka=e=>Oa.encode(JSON.stringify(e)),Ba=e=>JSON.parse(Da.decode(e));Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom");Symbol.for("@ipld/js-cid/CID");const Ua={...i,...r,...s,...a,...o,...l,...c,...h,...u,...d};function za(e,t,n,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:i}}}const Fa=za("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),ja=za("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{const t=fs((e=e.substring(1)).length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),Va={utf8:Fa,"utf-8":Fa,hex:Ua.base16,latin1:ja,ascii:ja,binary:ja,...Ua};function Ha(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=Va[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):globalThis.Buffer.from(e,"utf8")}function Wa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=Va[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const Ga={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},qa=":";function Ka(e){const[t,n]=e.split(qa);return{namespace:t,reference:n}}function Ya(e,t){return e.includes(":")?[e]:t.chains||[]}var Qa=Object.defineProperty,Xa=Object.defineProperties,Za=Object.getOwnPropertyDescriptors,Ja=Object.getOwnPropertySymbols,$a=Object.prototype.hasOwnProperty,eo=Object.prototype.propertyIsEnumerable,to=(e,t,n)=>t in e?Qa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,no=(e,t)=>{for(var n in t||(t={}))$a.call(t,n)&&to(e,n,t[n]);if(Ja)for(var n of Ja(t))eo.call(t,n)&&to(e,n,t[n]);return e};const io="react-native",ro="node",so="browser",ao="unknown",oo="js";function lo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function co(){return!(0,cr.getDocument)()&&!!(0,cr.getNavigator)()&&"ReactNative"===navigator.product}function ho(){return!lo()&&!!(0,cr.getNavigator)()&&!!(0,cr.getDocument)()}function uo(){return co()?io:lo()?ro:ho()?so:ao}function po(){var e;try{return co()&&typeof n.g<"u"&&typeof(null==n.g?void 0:n.g.Application)<"u"?null==(e=n.g.Application)?void 0:e.applicationId:void 0}catch{return}}function fo(e){var t,n;const i=mo();try{return null!=e&&e.url&&i.url&&e.url!==i.url&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${i.url}. This is probably unintended and can lead to issues.`),e.url=i.url),null!=(t=e?.icons)&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter((e=>""!==e))),((e,t)=>Xa(e,Za(t)))(no(no({},i),e),{url:e?.url||i.url,name:e?.name||i.name,description:e?.description||i.description,icons:null!=(n=e?.icons)&&n.length&&e.icons.length>0?e.icons:i.icons})}catch(r){return console.warn("Error populating app metadata",r),e||i}}function mo(){return(0,hr.g)()||{name:"",description:"",url:"",icons:[""]}}function go(e,t,i){const r=function(){if(uo()===io&&typeof n.g<"u"&&typeof(null==n.g?void 0:n.g.Platform)<"u"){const{OS:e,Version:t}=n.g.Platform;return[e,t].join("-")}const e=ar();if(null===e)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),s=function(){var e;const t=uo();return t===so?[t,(null==(e=(0,cr.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),[oo,i].join("-"),r,s].join("/")}function vo(e){let{protocol:t,version:n,relayUrl:i,sdkVersion:r,auth:s,projectId:a,useOnCloseEvent:o,bundleId:l,packageName:c}=e;const h=i.split("?"),u={auth:s,ua:go(t,n,r),projectId:a,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:l||void 0},d=function(e,t){const n=new URLSearchParams(e);for(const i of Object.keys(t).sort())if(t.hasOwnProperty(i)){const e=t[i];void 0!==e&&n.set(i,e)}return n.toString()}(h[1]||"",u);return h[0]+"?"+d}function yo(e,t){return e.filter((e=>t.includes(e))).length===e.length}function bo(e){return Object.fromEntries(e.entries())}function wo(e){return new Map(Object.entries(e))}function xo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.FIVE_MINUTES,t=arguments.length>1?arguments[1]:void 0;const n=(0,b.toMiliseconds)(e||b.FIVE_MINUTES);let i,r,s,a;return{resolve:e=>{s&&i&&(clearTimeout(s),i(e),a=Promise.resolve(e))},reject:e=>{s&&r&&(clearTimeout(s),r(e))},done:()=>new Promise(((e,o)=>{if(a)return e(a);s=setTimeout((()=>{const e=new Error(t);a=Promise.reject(e),o(e)}),n),i=e,r=o}))}}function Eo(e,t,n){return new Promise((async(i,r)=>{const s=setTimeout((()=>r(new Error(n))),t);try{i(await e)}catch(E){r(E)}clearTimeout(s)}))}function Co(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Ao(e){const[t,n]=e.split(":"),i={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof n)i.topic=n;else{if("id"!==t||!Number.isInteger(Number(n)))throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${n}`);i.id=Number(n)}return i}function So(e,t){return(0,b.fromMiliseconds)((t||Date.now())+(0,b.toMiliseconds)(e))}function _o(e){return Date.now()>=(0,b.toMiliseconds)(e)}function To(e,t){return`${e}${t?`:${t}`:""}`}function Po(){return[...new Set([...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],...arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]])]}async function Mo(e){let{id:t,topic:i,wcDeepLink:r}=e;var s;try{if(!r)return;const e="string"==typeof r?JSON.parse(r):r,a=e?.href;if("string"!=typeof a)return;const o=function(e,t,n){const i=`requestId=${t}&sessionTopic=${n}`;e.endsWith("/")&&(e=e.slice(0,-1));let r=`${e}`;if(e.startsWith("https://t.me")){r=`${r}${e.includes("?")?"&startapp=":"?startapp="}${function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Buffer.from(e).toString("base64");return t?n.replace(/[=]/g,""):n}(i,!0)}`}else r=`${r}/wc?${i}`;return r}(a,t,i),l=uo();if(l===so){if(null==(s=(0,cr.getDocument)())||!s.hasFocus())return void console.warn("Document does not have focus, skipping deeplink.");!function(e){let t="_self";!function(){try{return window.self!==window.top}catch{return!1}}()?(typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"):t="_top",window.open(e,t,"noreferrer noopener")}(o)}else l===io&&typeof(null==n.g?void 0:n.g.Linking)<"u"&&await n.g.Linking.openURL(o)}catch(a){console.error(a)}}function No(e,t){if(!e.includes(t))return null;const n=e.split(/([&,?,=])/),i=n.indexOf(t);return n[i+2]}function Io(){return typeof crypto<"u"&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function Oo(){return typeof process<"u"&&"true"==={NODE_ENV:"production",PUBLIC_URL:"/build",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PROJECT_ID:"bb8edcd28daf7c13ce0a49cafab2782d"}.IS_VITEST}function Do(e){return Buffer.from(e,"base64").toString("utf-8")}function Lo(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Ro(e){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function ko(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Lo(e.outputLen),Lo(e.blockLen)}function Bo(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Uo(e,t){Ro(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const zo=BigInt(2**32-1),Fo=BigInt(32);function jo(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&zo),l:Number(e>>Fo&zo)}:{h:0|Number(e>>Fo&zo),l:0|Number(e&zo)}}const Vo="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function Ho(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Wo(e,t){return e<<32-t|e>>>t}const Go=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function qo(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Ko(e){for(let t=0;t<e.length;t++)e[t]=qo(e[t])}function Yo(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),Ro(e),e}class Qo{clone(){return this._cloneInto()}}function Xo(e){const t=t=>e().update(Yo(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Zo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(Vo&&"function"==typeof Vo.getRandomValues)return Vo.getRandomValues(new Uint8Array(e));if(Vo&&"function"==typeof Vo.randomBytes)return Vo.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}const Jo=[],$o=[],el=[],tl=BigInt(0),nl=BigInt(1),il=BigInt(2),rl=BigInt(7),sl=BigInt(256),al=BigInt(113);for(let HC=0,WC=nl,GC=1,qC=0;HC<24;HC++){[GC,qC]=[qC,(2*GC+3*qC)%5],Jo.push(2*(5*qC+GC)),$o.push((HC+1)*(HC+2)/2%64);let e=tl;for(let t=0;t<7;t++)WC=(WC<<nl^(WC>>rl)*al)%sl,WC&il&&(e^=nl<<(nl<<BigInt(t))-nl);el.push(e)}const[ol,ll]=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let r=0;r<e.length;r++){const{h:s,l:a}=jo(e[r],t);[n[r],i[r]]=[s,a]}return[n,i]}(el,!0),cl=(e,t,n)=>n>32?((e,t,n)=>t<<n-32|e>>>64-n)(e,t,n):((e,t,n)=>e<<n|t>>>32-n)(e,t,n),hl=(e,t,n)=>n>32?((e,t,n)=>e<<n-32|t>>>64-n)(e,t,n):((e,t,n)=>t<<n|e>>>32-n)(e,t,n);class ul extends Qo{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=i,this.rounds=r,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Lo(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");var s;this.state=new Uint8Array(200),this.state32=(s=this.state,new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)))}keccak(){Go||Ko(this.state32),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;const n=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){const t=(i+8)%10,r=(i+2)%10,s=n[r],a=n[r+1],o=cl(s,a,1)^n[t],l=hl(s,a,1)^n[t+1];for(let n=0;n<50;n+=10)e[i+n]^=o,e[i+n+1]^=l}let t=e[2],r=e[3];for(let n=0;n<24;n++){const i=$o[n],s=cl(t,r,i),a=hl(t,r,i),o=Jo[n];t=e[o],r=e[o+1],e[o]=s,e[o+1]=a}for(let i=0;i<50;i+=10){for(let t=0;t<10;t++)n[t]=e[i+t];for(let t=0;t<10;t++)e[i+t]^=~n[(t+2)%10]&n[(t+4)%10]}e[0]^=ol[i],e[1]^=ll[i]}n.fill(0)}(this.state32,this.rounds),Go||Ko(this.state32),this.posOut=0,this.pos=0}update(e){Bo(this);const{blockLen:t,state:n}=this,i=(e=Yo(e)).length;for(let r=0;r<i;){const s=Math.min(t-this.pos,i-r);for(let t=0;t<s;t++)n[this.pos++]^=e[r++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:i}=this;e[n]^=t,0!==(128&t)&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Bo(this,!1),Ro(e),this.finish();const t=this.state,{blockLen:n}=this;for(let i=0,r=e.length;i<r;){this.posOut>=n&&this.keccak();const s=Math.min(n-this.posOut,r-i);e.set(t.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Lo(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Uo(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:i,rounds:r,enableXOF:s}=this;return e||(e=new ul(t,n,i,s,r)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=r,e.suffix=n,e.outputLen=i,e.enableXOF=s,e.destroyed=this.destroyed,e}}const dl=((e,t,n)=>Xo((()=>new ul(t,e,n))))(1,136,32),pl="https://rpc.walletconnect.org/v1";function fl(e){const t=`\x19Ethereum Signed Message:\n${e.length}`,n=(new TextEncoder).encode(t+e);return"0x"+Buffer.from(dl(n)).toString("hex")}async function ml(e,t,n,i,r,s){switch(n.t){case"eip191":return await async function(e,t,n){return(await ds({hash:fl(t),signature:n})).toLowerCase()===e.toLowerCase()}(e,t,n.s);case"eip1271":return await async function(e,t,n,i,r,s){const a=Ka(i);if(!a.namespace||!a.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{const a="0x1626ba7e",o="0000000000000000000000000000000000000000000000000000000000000040",l="0000000000000000000000000000000000000000000000000000000000000041",c=n.substring(2),h=a+fl(t).substring(2)+o+l+c,u=await fetch(`${s||pl}/?chainId=${i}&projectId=${r}`,{method:"POST",body:JSON.stringify({id:gl(),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:h},"latest"]})}),{result:d}=await u.json();return!!d&&d.slice(0,a.length).toLowerCase()===a.toLowerCase()}catch(J){return console.error("isValidEip1271Signature: ",J),!1}}(e,t,n.s,i,r,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}function gl(){return Date.now()+Math.floor(1e3*Math.random())}var vl=Object.defineProperty,yl=Object.defineProperties,bl=Object.getOwnPropertyDescriptors,wl=Object.getOwnPropertySymbols,xl=Object.prototype.hasOwnProperty,El=Object.prototype.propertyIsEnumerable,Cl=(e,t,n)=>t in e?vl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Al=(e,t)=>{for(var n in t||(t={}))xl.call(t,n)&&Cl(e,n,t[n]);if(wl)for(var n of wl(t))El.call(t,n)&&Cl(e,n,t[n]);return e},Sl=(e,t)=>yl(e,bl(t));const _l=e=>e?.split(":"),Tl=e=>{const t=e&&_l(e);if(t)return t[2]+":"+t[3]},Pl=e=>{const t=e&&_l(e);if(t)return t.pop()};async function Ml(e){const{cacao:t,projectId:n}=e,{s:i,p:r}=t,s=Nl(r,r.iss),a=Pl(r.iss);return await ml(a,s,i,Tl(r.iss),n)}const Nl=(e,t)=>{const n=`${e.domain} wants you to sign in with your Ethereum account:`,i=Pl(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let r=e.statement||void 0;const s=`URI: ${e.aud||e.uri}`,a=`Version: ${e.version}`,o=`Chain ID: ${(e=>{const t=e&&_l(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]})(t)}`,l=`Nonce: ${e.nonce}`,c=`Issued At: ${e.iat}`,h=e.exp?`Expiration Time: ${e.exp}`:void 0,u=e.nbf?`Not Before: ${e.nbf}`:void 0,d=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map((e=>`\n- ${e}`)).join("")}`:void 0,f=jl(e.resources);if(f){r=Ul(r,Ll(f))}return[n,i,"",r,"",s,a,o,l,c,h,u,d,p].filter((e=>null!=e)).join("\n")};function Il(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");const t=Object.keys(e.att);if(null==t||!t.length)throw new Error("No resources found in `att` property");t.forEach((t=>{const n=e.att[t];if(Array.isArray(n))throw new Error(`Resource must be an object: ${t}`);if("object"!=typeof n)throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(n).forEach((e=>{const t=n[e];if(!Array.isArray(t))throw new Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw new Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach((t=>{if("object"!=typeof t)throw new Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)}))}))}))}function Ol(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=t?.sort(((e,t)=>e.localeCompare(t)));const i=t.map((t=>({[`${e}/${t}`]:[n]})));return Object.assign({},...i)}function Dl(e){return Il(e),`urn:recap:${function(e){return Buffer.from(JSON.stringify(e)).toString("base64")}(e).replace(/=/g,"")}`}function Ll(e){const t=function(e){return JSON.parse(Buffer.from(e,"base64").toString("utf-8"))}(e.replace("urn:recap:",""));return Il(t),t}function Rl(e,t,n){const i=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n?.sort(((e,t)=>e.localeCompare(t))),{att:{[e]:Ol(t,n,i)}}}(e,t,n);return Dl(i)}function kl(e){return e&&e.includes("urn:recap:")}function Bl(e,t){const n=function(e,t){Il(e),Il(t);const n=Object.keys(e.att).concat(Object.keys(t.att)).sort(((e,t)=>e.localeCompare(t))),i={att:{}};return n.forEach((n=>{var r,s;Object.keys((null==(r=e.att)?void 0:r[n])||{}).concat(Object.keys((null==(s=t.att)?void 0:s[n])||{})).sort(((e,t)=>e.localeCompare(t))).forEach((r=>{var s,a;i.att[n]=Sl(Al({},i.att[n]),{[r]:(null==(s=e.att[n])?void 0:s[r])||(null==(a=t.att[n])?void 0:a[r])})}))})),i}(Ll(e),Ll(t));return Dl(n)}function Ul(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;Il(t);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(n))return e;const i=[];let r=0;Object.keys(t.att).forEach((e=>{const n=Object.keys(t.att[e]).map((e=>({ability:e.split("/")[0],action:e.split("/")[1]})));n.sort(((e,t)=>e.action.localeCompare(t.action)));const s={};n.forEach((e=>{s[e.ability]||(s[e.ability]=[]),s[e.ability].push(e.action)}));const a=Object.keys(s).map((t=>(r++,`(${r}) '${t}': '${s[t].join("', '")}' for '${e}'.`)));i.push(a.join(", ").replace(".,","."))}));return`${e?e+" ":""}${`${n}${i.join(" ")}`}`}function zl(e){var t;const n=Ll(e);Il(n);const i=null==(t=n.att)?void 0:t.eip155;return i?Object.keys(i).map((e=>e.split("/")[1])):[]}function Fl(e){const t=Ll(e);Il(t);const n=[];return Object.values(t.att).forEach((e=>{Object.values(e).forEach((e=>{var t;null!=(t=e?.[0])&&t.chains&&n.push(e[0].chains)}))})),[...new Set(n.flat())]}function jl(e){if(!e)return;const t=e?.[e.length-1];return kl(t)?t:void 0}function Vl(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Hl(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Wl(e){if(!Hl(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function Gl(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ql(e){if("boolean"!=typeof e)throw new Error(`boolean expected, not ${e}`)}const Kl=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function Yl(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!Hl(e))throw new Error("Uint8Array expected, got "+typeof e);e=Zl(e)}return e}function Ql(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!function(e){return e.byteOffset%4===0}(t))throw new Error("invalid output, must be aligned");return t}function Xl(e,t,n,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,i);const r=BigInt(32),s=BigInt(4294967295),a=Number(n>>r&s),o=Number(n&s),l=i?4:0,c=i?0:4;e.setUint32(t+l,a,i),e.setUint32(t+c,o,i)}function Zl(e){return Uint8Array.from(e)}function Jl(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<t.length;i++)t[i].fill(0)}const $l=e=>Uint8Array.from(e.split("").map((e=>e.charCodeAt(0)))),ec=$l("expand 16-byte k"),tc=$l("expand 32-byte k"),nc=Kl(ec),ic=Kl(tc);function rc(e,t){return e<<t|e>>>32-t}function sc(e){return e.byteOffset%4===0}const ac=2**32-1,oc=new Uint32Array;const lc=(e,t)=>255&e[t++]|(255&e[t++])<<8;class cc{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,Wl(e=Yl(e),32);const t=lc(e,0),n=lc(e,2),i=lc(e,4),r=lc(e,6),s=lc(e,8),a=lc(e,10),o=lc(e,12),l=lc(e,14);this.r[0]=8191&t,this.r[1]=8191&(t>>>13|n<<3),this.r[2]=7939&(n>>>10|i<<6),this.r[3]=8191&(i>>>7|r<<9),this.r[4]=255&(r>>>4|s<<12),this.r[5]=s>>>1&8190,this.r[6]=8191&(s>>>14|a<<2),this.r[7]=8065&(a>>>11|o<<5),this.r[8]=8191&(o>>>8|l<<8),this.r[9]=l>>>5&127;for(let c=0;c<8;c++)this.pad[c]=lc(e,16+2*c)}process(e,t){const n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?0:2048,{h:i,r:r}=this,s=r[0],a=r[1],o=r[2],l=r[3],c=r[4],h=r[5],u=r[6],d=r[7],p=r[8],f=r[9],m=lc(e,t+0),g=lc(e,t+2),v=lc(e,t+4),y=lc(e,t+6),b=lc(e,t+8),w=lc(e,t+10),x=lc(e,t+12),E=lc(e,t+14);let C=i[0]+(8191&m),A=i[1]+(8191&(m>>>13|g<<3)),S=i[2]+(8191&(g>>>10|v<<6)),_=i[3]+(8191&(v>>>7|y<<9)),T=i[4]+(8191&(y>>>4|b<<12)),P=i[5]+(b>>>1&8191),M=i[6]+(8191&(b>>>14|w<<2)),N=i[7]+(8191&(w>>>11|x<<5)),I=i[8]+(8191&(x>>>8|E<<8)),O=i[9]+(E>>>5|n),D=0,L=D+C*s+A*(5*f)+S*(5*p)+_*(5*d)+T*(5*u);D=L>>>13,L&=8191,L+=P*(5*h)+M*(5*c)+N*(5*l)+I*(5*o)+O*(5*a),D+=L>>>13,L&=8191;let R=D+C*a+A*s+S*(5*f)+_*(5*p)+T*(5*d);D=R>>>13,R&=8191,R+=P*(5*u)+M*(5*h)+N*(5*c)+I*(5*l)+O*(5*o),D+=R>>>13,R&=8191;let k=D+C*o+A*a+S*s+_*(5*f)+T*(5*p);D=k>>>13,k&=8191,k+=P*(5*d)+M*(5*u)+N*(5*h)+I*(5*c)+O*(5*l),D+=k>>>13,k&=8191;let B=D+C*l+A*o+S*a+_*s+T*(5*f);D=B>>>13,B&=8191,B+=P*(5*p)+M*(5*d)+N*(5*u)+I*(5*h)+O*(5*c),D+=B>>>13,B&=8191;let U=D+C*c+A*l+S*o+_*a+T*s;D=U>>>13,U&=8191,U+=P*(5*f)+M*(5*p)+N*(5*d)+I*(5*u)+O*(5*h),D+=U>>>13,U&=8191;let z=D+C*h+A*c+S*l+_*o+T*a;D=z>>>13,z&=8191,z+=P*s+M*(5*f)+N*(5*p)+I*(5*d)+O*(5*u),D+=z>>>13,z&=8191;let F=D+C*u+A*h+S*c+_*l+T*o;D=F>>>13,F&=8191,F+=P*a+M*s+N*(5*f)+I*(5*p)+O*(5*d),D+=F>>>13,F&=8191;let j=D+C*d+A*u+S*h+_*c+T*l;D=j>>>13,j&=8191,j+=P*o+M*a+N*s+I*(5*f)+O*(5*p),D+=j>>>13,j&=8191;let V=D+C*p+A*d+S*u+_*h+T*c;D=V>>>13,V&=8191,V+=P*l+M*o+N*a+I*s+O*(5*f),D+=V>>>13,V&=8191;let H=D+C*f+A*p+S*d+_*u+T*h;D=H>>>13,H&=8191,H+=P*c+M*l+N*o+I*a+O*s,D+=H>>>13,H&=8191,D=(D<<2)+D|0,D=D+L|0,L=8191&D,D>>>=13,R+=D,i[0]=L,i[1]=R,i[2]=k,i[3]=B,i[4]=U,i[5]=z,i[6]=F,i[7]=j,i[8]=V,i[9]=H}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let r=(1^i)-1;for(let a=0;a<10;a++)n[a]&=r;r=~r;for(let a=0;a<10;a++)e[a]=e[a]&r|n[a];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let s=e[0]+t[0];e[0]=65535&s;for(let a=1;a<8;a++)s=(e[a]+t[a]|0)+(s>>>16)|0,e[a]=65535&s;Jl(n)}update(e){Gl(this);const{buffer:t,blockLen:n}=this,i=(e=Yl(e)).length;for(let r=0;r<i;){const s=Math.min(n-this.pos,i-r);if(s!==n)t.set(e.subarray(r,r+s),this.pos),this.pos+=s,r+=s,this.pos===n&&(this.process(t,0,!1),this.pos=0);else for(;n<=i-r;r+=n)this.process(e,r)}return this}destroy(){Jl(this.h,this.r,this.buffer,this.pad)}digestInto(e){Gl(this),function(e,t){Wl(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let r=0;for(let s=0;s<8;s++)e[r++]=n[s]>>>0,e[r++]=n[s]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}const hc=function(e){const t=(t,n)=>e(n).update(Yl(t)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t}((e=>new cc(e)));const uc=function(e,t){const{allowShortKeys:n,extendNonceFn:i,counterLength:r,counterRight:s,rounds:a}=function(e,t){if(null==t||"object"!=typeof t)throw new Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw new Error("core must be a function");return Vl(r),Vl(a),ql(s),ql(n),function(t,o,l,c){let h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Wl(t),Wl(o),Wl(l);const u=l.length;if(void 0===c&&(c=new Uint8Array(u)),Wl(c),Vl(h),h<0||h>=ac)throw new Error("arx: counter overflow");if(c.length<u)throw new Error(`arx: output (${c.length}) is shorter than data (${u})`);const d=[];let p,f,m=t.length;if(32===m)d.push(p=Zl(t)),f=ic;else{if(16!==m||!n)throw new Error(`arx: invalid 32-byte key, got length=${m}`);p=new Uint8Array(32),p.set(t),p.set(t,16),f=nc,d.push(p)}sc(o)||d.push(o=Zl(o));const g=Kl(p);if(i){if(24!==o.length)throw new Error("arx: extended nonce must be 24 bytes");i(f,g,Kl(o.subarray(0,16)),g),o=o.subarray(16)}const v=16-r;if(v!==o.length)throw new Error(`arx: nonce must be ${v} or 16 bytes`);if(12!==v){const e=new Uint8Array(12);e.set(o,s?0:12-o.length),o=e,d.push(o)}const y=Kl(o);return function(e,t,n,i,r,s,a,o){const l=r.length,c=new Uint8Array(64),h=Kl(c),u=sc(r)&&sc(s),d=u?Kl(r):oc,p=u?Kl(s):oc;for(let f=0;f<l;a++){if(e(t,n,i,h,a,o),a>=ac)throw new Error("arx: counter overflow");const m=Math.min(64,l-f);if(u&&64===m){const e=f/4;if(f%4!==0)throw new Error("arx: invalid block position");for(let t,n=0;n<16;n++)t=e+n,p[t]=d[t]^h[n];f+=64}else{for(let e,t=0;t<m;t++)e=f+t,s[e]=r[e]^c[t];f+=m}}}(e,f,g,y,l,c,h,a),Jl(...d),c}}((function(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,a=e[0],o=e[1],l=e[2],c=e[3],h=t[0],u=t[1],d=t[2],p=t[3],f=t[4],m=t[5],g=t[6],v=t[7],y=r,b=n[0],w=n[1],x=n[2],E=a,C=o,A=l,S=c,_=h,T=u,P=d,M=p,N=f,I=m,O=g,D=v,L=y,R=b,k=w,B=x;for(let z=0;z<s;z+=2)E=E+_|0,L=rc(L^E,16),N=N+L|0,_=rc(_^N,12),E=E+_|0,L=rc(L^E,8),N=N+L|0,_=rc(_^N,7),C=C+T|0,R=rc(R^C,16),I=I+R|0,T=rc(T^I,12),C=C+T|0,R=rc(R^C,8),I=I+R|0,T=rc(T^I,7),A=A+P|0,k=rc(k^A,16),O=O+k|0,P=rc(P^O,12),A=A+P|0,k=rc(k^A,8),O=O+k|0,P=rc(P^O,7),S=S+M|0,B=rc(B^S,16),D=D+B|0,M=rc(M^D,12),S=S+M|0,B=rc(B^S,8),D=D+B|0,M=rc(M^D,7),E=E+T|0,B=rc(B^E,16),O=O+B|0,T=rc(T^O,12),E=E+T|0,B=rc(B^E,8),O=O+B|0,T=rc(T^O,7),C=C+P|0,L=rc(L^C,16),D=D+L|0,P=rc(P^D,12),C=C+P|0,L=rc(L^C,8),D=D+L|0,P=rc(P^D,7),A=A+M|0,R=rc(R^A,16),N=N+R|0,M=rc(M^N,12),A=A+M|0,R=rc(R^A,8),N=N+R|0,M=rc(M^N,7),S=S+_|0,k=rc(k^S,16),I=I+k|0,_=rc(_^I,12),S=S+_|0,k=rc(k^S,8),I=I+k|0,_=rc(_^I,7);let U=0;i[U++]=a+E|0,i[U++]=o+C|0,i[U++]=l+A|0,i[U++]=c+S|0,i[U++]=h+_|0,i[U++]=u+T|0,i[U++]=d+P|0,i[U++]=p+M|0,i[U++]=f+N|0,i[U++]=m+I|0,i[U++]=g+O|0,i[U++]=v+D|0,i[U++]=y+L|0,i[U++]=b+R|0,i[U++]=w+k|0,i[U++]=x+B|0}),{counterRight:!1,counterLength:4,allowShortKeys:!1}),dc=new Uint8Array(16),pc=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(dc.subarray(n))},fc=new Uint8Array(32);function mc(e,t,n,i,r){const s=e(t,n,fc),a=hc.create(s);r&&pc(a,r),pc(a,i);const o=new Uint8Array(16),l=(e=>new DataView(e.buffer,e.byteOffset,e.byteLength))(o);Xl(l,0,BigInt(r?r.length:0),!0),Xl(l,8,BigInt(i.length),!0),a.update(o);const c=a.digest();return Jl(s,o),c}const gc=((e,t)=>{function n(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];if(Wl(n),void 0!==e.nonceLength){const t=r[0];if(!t)throw new Error("nonce / iv required");e.varSizeNonce?Wl(t):Wl(t,e.nonceLength)}const a=e.tagLength;a&&void 0!==r[1]&&Wl(r[1]);const o=t(n,...r),l=(e,t)=>{if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");Wl(t)}};let c=!1;return{encrypt(e,t){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,Wl(e),l(o.encrypt.length,t),o.encrypt(e,t)},decrypt(e,t){if(Wl(e),a&&e.length<a)throw new Error("invalid ciphertext length: smaller than tagLength="+a);return l(o.decrypt.length,t),o.decrypt(e,t)}}}return Object.assign(n,e),n})({blockSize:64,nonceLength:12,tagLength:16},(vc=uc,(e,t,n)=>({encrypt(i,r){const s=i.length;(r=Ql(s+16,r,!1)).set(i);const a=r.subarray(0,-16);vc(e,t,a,a,1);const o=mc(vc,e,t,a,n);return r.set(o,s),Jl(o),r},decrypt(i,r){r=Ql(i.length-16,r,!1);const s=i.subarray(0,-16),a=i.subarray(-16),o=mc(vc,e,t,s,n);if(!function(e,t){if(e.length!==t.length)return!1;let n=0;for(let i=0;i<e.length;i++)n|=e[i]^t[i];return 0===n}(a,o))throw new Error("invalid tag");return r.set(i.subarray(0,-16)),vc(e,t,r,r,1),Jl(o),r}})));var vc;class yc extends Qo{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ko(e);const n=Yo(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,r=new Uint8Array(i);r.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<r.length;s++)r[s]^=54;this.iHash.update(r),this.oHash=e.create();for(let s=0;s<r.length;s++)r[s]^=106;this.oHash.update(r),r.fill(0)}update(e){return Bo(this),this.iHash.update(e),this}digestInto(e){Bo(this),Ro(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:i,destroyed:r,blockLen:s,outputLen:a}=this;return e.finished=i,e.destroyed=r,e.blockLen=s,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const bc=(e,t,n)=>new yc(e,t).update(n).digest();bc.create=(e,t)=>new yc(e,t);const wc=new Uint8Array([0]),xc=new Uint8Array;const Ec=(e,t,n,i,r)=>function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32;if(ko(e),Lo(i),i>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const r=Math.ceil(i/e.outputLen);void 0===n&&(n=xc);const s=new Uint8Array(r*e.outputLen),a=bc.create(e,t),o=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let c=0;c<r;c++)wc[0]=c+1,o.update(0===c?xc:l).update(n).update(wc).digestInto(l),s.set(l,e.outputLen*c),a._cloneInto(o);return a.destroy(),o.destroy(),l.fill(0),wc.fill(0),s.slice(0,i)}(e,function(e,t,n){return ko(e),void 0===n&&(n=new Uint8Array(e.outputLen)),bc(e,Yo(n),Yo(t))}(e,t,n),i,r);function Cc(e,t,n){return e&t^~e&n}function Ac(e,t,n){return e&t^e&n^t&n}class Sc extends Qo{constructor(e,t,n,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ho(this.buffer)}update(e){Bo(this);const{view:t,buffer:n,blockLen:i}=this,r=(e=Yo(e)).length;for(let s=0;s<r;){const a=Math.min(i-this.pos,r-s);if(a!==i)n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0);else{const t=Ho(e);for(;i<=r-s;s+=i)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Bo(this),Uo(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:r}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)t[h]=0;(function(e,t,n,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,i);const r=BigInt(32),s=BigInt(4294967295),a=Number(n>>r&s),o=Number(n&s),l=i?4:0,c=i?0:4;e.setUint32(t+l,a,i),e.setUint32(t+c,o,i)})(n,i-8,BigInt(8*this.length),r),this.process(n,0);const a=Ho(e),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=o/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,c[h],r)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:r,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=r,e.destroyed=s,i%t&&e.buffer.set(n),e}}const _c=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Tc=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Pc=new Uint32Array(64);class Mc extends Sc{constructor(){super(64,32,8,!1),this.A=0|Tc[0],this.B=0|Tc[1],this.C=0|Tc[2],this.D=0|Tc[3],this.E=0|Tc[4],this.F=0|Tc[5],this.G=0|Tc[6],this.H=0|Tc[7]}get(){const{A:e,B:t,C:n,D:i,E:r,F:s,G:a,H:o}=this;return[e,t,n,i,r,s,a,o]}set(e,t,n,i,r,s,a,o){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|i,this.E=0|r,this.F=0|s,this.G=0|a,this.H=0|o}process(e,t){for(let h=0;h<16;h++,t+=4)Pc[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const e=Pc[h-15],t=Pc[h-2],n=Wo(e,7)^Wo(e,18)^e>>>3,i=Wo(t,17)^Wo(t,19)^t>>>10;Pc[h]=i+Pc[h-7]+n+Pc[h-16]|0}let{A:n,B:i,C:r,D:s,E:a,F:o,G:l,H:c}=this;for(let h=0;h<64;h++){const e=c+(Wo(a,6)^Wo(a,11)^Wo(a,25))+Cc(a,o,l)+_c[h]+Pc[h]|0,t=(Wo(n,2)^Wo(n,13)^Wo(n,22))+Ac(n,i,r)|0;c=l,l=o,o=a,a=s+e|0,s=r,r=i,i=n,n=e+t|0}n=n+this.A|0,i=i+this.B|0,r=r+this.C|0,s=s+this.D|0,a=a+this.E|0,o=o+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,i,r,s,a,o,l,c)}roundClean(){Pc.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Nc=Xo((()=>new Mc)),Ic=BigInt(0),Oc=BigInt(1),Dc=BigInt(2);function Lc(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Rc(e){if(!Lc(e))throw new Error("Uint8Array expected")}function kc(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}const Bc=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Uc(e){Rc(e);let t="";for(let n=0;n<e.length;n++)t+=Bc[e[n]];return t}function zc(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function Fc(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?Ic:BigInt("0x"+e)}const jc=48,Vc=57,Hc=65,Wc=70,Gc=97,qc=102;function Kc(e){return e>=jc&&e<=Vc?e-jc:e>=Hc&&e<=Wc?e-(Hc-10):e>=Gc&&e<=qc?e-(Gc-10):void 0}function Yc(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const i=new Uint8Array(n);for(let r=0,s=0;r<n;r++,s+=2){const t=Kc(e.charCodeAt(s)),n=Kc(e.charCodeAt(s+1));if(void 0===t||void 0===n){const t=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+s)}i[r]=16*t+n}return i}function Qc(e){return Fc(Uc(e))}function Xc(e){return Rc(e),Fc(Uc(Uint8Array.from(e).reverse()))}function Zc(e,t){return Yc(e.toString(16).padStart(2*t,"0"))}function Jc(e,t){return Zc(e,t).reverse()}function $c(e,t,n){let i;if("string"==typeof t)try{i=Yc(t)}catch(we){throw new Error(e+" must be hex string or Uint8Array, cause: "+we)}else{if(!Lc(t))throw new Error(e+" must be hex string or Uint8Array");i=Uint8Array.from(t)}const r=i.length;if("number"==typeof n&&r!==n)throw new Error(e+" of length "+n+" expected, got "+r);return i}function eh(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];Rc(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,i=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,i),i+=e.length}return t}const th=e=>"bigint"==typeof e&&Ic<=e;function nh(e,t,n){return th(e)&&th(t)&&th(n)&&t<=e&&e<n}function ih(e,t,n,i){if(!nh(t,n,i))throw new Error("expected valid "+e+": "+n+" <= n < "+i+", got "+t)}function rh(e){let t;for(t=0;e>Ic;e>>=Oc,t+=1);return t}const sh=e=>(Dc<<BigInt(e-1))-Oc,ah=e=>new Uint8Array(e),oh=e=>Uint8Array.from(e);function lh(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let i=ah(e),r=ah(e),s=0;const a=()=>{i.fill(1),r.fill(0),s=0},o=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return n(r,i,...t)},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ah();r=o(oh([0]),e),i=o(),0!==e.length&&(r=o(oh([1]),e),i=o())},c=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){i=o();const t=i.slice();n.push(t),e+=i.length}return eh(...n)};return(e,t)=>{let n;for(a(),l(e);!(n=t(c()));)l();return a(),n}}const ch={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||Lc(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function hh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=(t,n,i)=>{const r=ch[n];if("function"!=typeof r)throw new Error("invalid validator function");const s=e[t];if((!i||void 0!==s)&&!r(s,e))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+s)};for(const[r,s]of Object.entries(t))i(r,s,!1);for(const[r,s]of Object.entries(n))i(r,s,!0);return e}function uh(e){const t=new WeakMap;return function(n){const i=t.get(n);if(void 0!==i)return i;for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const o=e(n,...s);return t.set(n,o),o}}var dh=Object.freeze({__proto__:null,isBytes:Lc,abytes:Rc,abool:kc,bytesToHex:Uc,numberToHexUnpadded:zc,hexToNumber:Fc,hexToBytes:Yc,bytesToNumberBE:Qc,bytesToNumberLE:Xc,numberToBytesBE:Zc,numberToBytesLE:Jc,numberToVarBytesBE:function(e){return Yc(zc(e))},ensureBytes:$c,concatBytes:eh,equalBytes:function(e,t){if(e.length!==t.length)return!1;let n=0;for(let i=0;i<e.length;i++)n|=e[i]^t[i];return 0===n},utf8ToBytes:function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))},inRange:nh,aInRange:ih,bitLen:rh,bitGet:function(e,t){return e>>BigInt(t)&Oc},bitSet:function(e,t,n){return e|(n?Oc:Ic)<<BigInt(t)},bitMask:sh,createHmacDrbg:lh,validateObject:hh,notImplemented:()=>{throw new Error("not implemented")},memoized:uh});const ph=BigInt(0),fh=BigInt(1),mh=BigInt(2),gh=BigInt(3),vh=BigInt(4),yh=BigInt(5),bh=BigInt(8);function wh(e,t){const n=e%t;return n>=ph?n:t+n}function xh(e,t,n){if(t<ph)throw new Error("invalid exponent, negatives unsupported");if(n<=ph)throw new Error("invalid modulus");if(n===fh)return ph;let i=fh;for(;t>ph;)t&fh&&(i=i*e%n),e=e*e%n,t>>=fh;return i}function Eh(e,t,n){let i=e;for(;t-- >ph;)i*=i,i%=n;return i}function Ch(e,t){if(e===ph)throw new Error("invert: expected non-zero number");if(t<=ph)throw new Error("invert: expected positive modulus, got "+t);let n=wh(e,t),i=t,r=ph,s=fh;for(;n!==ph;){const e=i%n,t=r-s*(i/n);i=n,n=e,r=s,s=t}if(i!==fh)throw new Error("invert: does not exist");return wh(r,t)}function Ah(e){if(e%vh===gh){const t=(e+fh)/vh;return function(e,n){const i=e.pow(n,t);if(!e.eql(e.sqr(i),n))throw new Error("Cannot find square root");return i}}if(e%bh===yh){const t=(e-yh)/bh;return function(e,n){const i=e.mul(n,mh),r=e.pow(i,t),s=e.mul(n,r),a=e.mul(e.mul(s,mh),r),o=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),n))throw new Error("Cannot find square root");return o}}return function(e){const t=(e-fh)/mh;let n,i,r;for(n=e-fh,i=0;n%mh===ph;n/=mh,i++);for(r=mh;r<e&&xh(r,t,e)!==e-fh;r++)if(r>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===i){const t=(e+fh)/vh;return function(e,n){const i=e.pow(n,t);if(!e.eql(e.sqr(i),n))throw new Error("Cannot find square root");return i}}const s=(n+fh)/mh;return function(e,a){if(e.pow(a,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let o=i,l=e.pow(e.mul(e.ONE,r),n),c=e.pow(a,s),h=e.pow(a,n);for(;!e.eql(h,e.ONE);){if(e.eql(h,e.ZERO))return e.ZERO;let t=1;for(let i=e.sqr(h);t<o&&!e.eql(i,e.ONE);t++)i=e.sqr(i);const n=e.pow(l,fh<<BigInt(o-t-1));l=e.sqr(n),c=e.mul(c,n),h=e.mul(h,l),o=t}return c}}(e)}const Sh=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function _h(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function Th(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=ph)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:r,nByteLength:s}=_h(e,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let a;const o=Object.freeze({ORDER:e,isLE:n,BITS:r,BYTES:s,MASK:sh(r),ZERO:ph,ONE:fh,create:t=>wh(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return ph<=t&&t<e},is0:e=>e===ph,isOdd:e=>(e&fh)===fh,neg:t=>wh(-t,e),eql:(e,t)=>e===t,sqr:t=>wh(t*t,e),add:(t,n)=>wh(t+n,e),sub:(t,n)=>wh(t-n,e),mul:(t,n)=>wh(t*n,e),pow:(e,t)=>function(e,t,n){if(n<ph)throw new Error("invalid exponent, negatives unsupported");if(n===ph)return e.ONE;if(n===fh)return t;let i=e.ONE,r=t;for(;n>ph;)n&fh&&(i=e.mul(i,r)),r=e.sqr(r),n>>=fh;return i}(o,e,t),div:(t,n)=>wh(t*Ch(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>Ch(t,e),sqrt:i.sqrt||(t=>(a||(a=Ah(e)),a(o,t))),invertBatch:e=>function(e,t){const n=new Array(t.length),i=t.reduce(((t,i,r)=>e.is0(i)?t:(n[r]=t,e.mul(t,i))),e.ONE),r=e.inv(i);return t.reduceRight(((t,i,r)=>e.is0(i)?t:(n[r]=e.mul(t,n[r]),e.mul(t,i))),r),n}(o,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?Jc(e,s):Zc(e,s),fromBytes:e=>{if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return n?Xc(e):Qc(e)}});return Object.freeze(o)}function Ph(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Mh(e){const t=Ph(e);return t+Math.ceil(t/2)}const Nh=BigInt(0),Ih=BigInt(1);function Oh(e,t){const n=t.negate();return e?n:t}function Dh(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Lh(e,t){Dh(e,t);return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}const Rh=new WeakMap,kh=new WeakMap;function Bh(e){return kh.get(e)||1}function Uh(e,t,n,i){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)}))}(n,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)}))}(i,t),n.length!==i.length)throw new Error("arrays of points and scalars must have equal length");const r=e.ZERO,s=rh(BigInt(n.length)),a=s>12?s-3:s>4?s-2:s?2:1,o=(1<<a)-1,l=new Array(o+1).fill(r);let c=r;for(let h=Math.floor((t.BITS-1)/a)*a;h>=0;h-=a){l.fill(r);for(let t=0;t<i.length;t++){const e=i[t],r=Number(e>>BigInt(h)&BigInt(o));l[r]=l[r].add(n[t])}let e=r;for(let t=l.length-1,n=r;t>0;t--)n=n.add(l[t]),e=e.add(n);if(c=c.add(e),0!==h)for(let t=0;t<a;t++)c=c.double()}return c}function zh(e){return function(e){const t=Sh.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});hh(e,t)}(e.Fp),hh(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({..._h(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Fh=BigInt(0),jh=BigInt(1);const Vh=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const Hh=BigInt(1),Wh=BigInt(2),Gh=BigInt(3),qh=BigInt(5);BigInt(8);const Kh=function(e){const t=function(e){return hh(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}(e),{P:n}=t,i=e=>wh(e,n),r=t.montgomeryBits,s=Math.ceil(r/8),a=t.nByteLength,o=t.adjustScalarBytes||(e=>e),l=t.powPminus2||(e=>xh(e,n-BigInt(2),n));function c(e,t,n){const r=i(e*(t-n));return[t=i(t-r),n=i(n+r)]}const h=(t.a-BigInt(2))/BigInt(4);function u(e){return Jc(i(e),s)}function d(e,t){const d=function(e){const t=$c("u coordinate",e,s);return 32===a&&(t[31]&=127),Xc(t)}(t),p=function(e){const t=$c("scalar",e),n=t.length;if(n!==s&&n!==a)throw new Error("invalid scalar, expected "+s+" or "+a+" bytes, got "+n);return Xc(o(t))}(e),f=function(e,t){ih("u",e,Fh,n),ih("scalar",t,Fh,n);const s=t,a=e;let o,u=jh,d=Fh,p=e,f=jh,m=Fh;for(let n=BigInt(r-1);n>=Fh;n--){const e=s>>n&jh;m^=e,o=c(m,u,p),u=o[0],p=o[1],o=c(m,d,f),d=o[0],f=o[1],m=e;const t=u+d,r=i(t*t),l=u-d,g=i(l*l),v=r-g,y=p+f,b=i((p-f)*t),w=i(y*l),x=b+w,E=b-w;p=i(x*x),f=i(a*i(E*E)),u=i(r*g),d=i(v*(r+i(h*v)))}o=c(m,u,p),u=o[0],p=o[1],o=c(m,d,f),d=o[0],f=o[1];const g=l(d);return i(u*g)}(d,p);if(f===Fh)throw new Error("invalid private or public key received");return u(f)}const p=u(t.Gu);function f(e){return d(e,p)}return{scalarMult:d,scalarMultBase:f,getSharedSecret:(e,t)=>d(e,t),getPublicKey:e=>f(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:p}}({P:Vh,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{const t=Vh,{pow_p_5_8:n,b2:i}=function(e){const t=BigInt(10),n=BigInt(20),i=BigInt(40),r=BigInt(80),s=Vh,a=e*e%s*e%s,o=Eh(a,Wh,s)*a%s,l=Eh(o,Hh,s)*e%s,c=Eh(l,qh,s)*l%s,h=Eh(c,t,s)*c%s,u=Eh(h,n,s)*h%s,d=Eh(u,i,s)*u%s,p=Eh(d,r,s)*d%s,f=Eh(p,r,s)*d%s,m=Eh(f,t,s)*c%s;return{pow_p_5_8:Eh(m,Wh,s)*e%s,b2:a}}(e);return wh(Eh(n,Gh,t)*i,t)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:Zo});function Yh(e){void 0!==e.lowS&&kc("lowS",e.lowS),void 0!==e.prehash&&kc("prehash",e.prehash)}const{bytesToNumberBE:Qh,hexToBytes:Xh}=dh;class Zh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}}const Jh={Err:Zh,_tlv:{encode:(e,t)=>{const{Err:n}=Jh;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&t.length)throw new n("tlv.encode: unpadded data");const i=t.length/2,r=zc(i);if(r.length/2&128)throw new n("tlv.encode: long form length too big");const s=i>127?zc(r.length/2|128):"";return zc(e)+s+r+t},decode(e,t){const{Err:n}=Jh;let i=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new n("tlv.decode: wrong tlv");const r=t[i++];let s=0;if(!!(128&r)){const e=127&r;if(!e)throw new n("tlv.decode(long): indefinite length not supported");if(e>4)throw new n("tlv.decode(long): byte length is too big");const a=t.subarray(i,i+e);if(a.length!==e)throw new n("tlv.decode: length bytes not complete");if(0===a[0])throw new n("tlv.decode(long): zero leftmost byte");for(const t of a)s=s<<8|t;if(i+=e,s<128)throw new n("tlv.decode(long): not minimal encoding")}else s=r;const a=t.subarray(i,i+s);if(a.length!==s)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(i+s)}}},_int:{encode(e){const{Err:t}=Jh;if(e<$h)throw new t("integer: negative integers are not allowed");let n=zc(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=Jh;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return Qh(e)}},toSig(e){const{Err:t,_int:n,_tlv:i}=Jh,r="string"==typeof e?Xh(e):e;Rc(r);const{v:s,l:a}=i.decode(48,r);if(a.length)throw new t("invalid signature: left bytes after parsing");const{v:o,l:l}=i.decode(2,s),{v:c,l:h}=i.decode(2,l);if(h.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(o),s:n.decode(c)}},hexFromSig(e){const{_tlv:t,_int:n}=Jh,i=t.encode(2,n.encode(e.r))+t.encode(2,n.encode(e.s));return t.encode(48,i)}},$h=BigInt(0),eu=BigInt(1);BigInt(2);const tu=BigInt(3);function nu(e){const t=function(e){const t=zh(e);hh(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:i,a:r}=t;if(n){if(!i.eql(r,i.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:n}=t,i=Th(t.n,t.nBitLength),r=t.toBytes||((e,t,i)=>{const r=t.toAffine();return eh(Uint8Array.from([4]),n.toBytes(r.x),n.toBytes(r.y))}),s=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function a(e){const{a:i,b:r}=t,s=n.sqr(e),a=n.mul(s,e);return n.add(n.add(a,n.mul(e,i)),r)}if(!n.eql(n.sqr(t.Gy),a(t.Gx)))throw new Error("bad generator point: equation left != right");function o(e){const{allowedPrivateKeyLengths:n,nByteLength:i,wrapPrivateKey:r,n:s}=t;if(n&&"bigint"!=typeof e){if(Lc(e)&&(e=Uc(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*i,"0")}let a;try{a="bigint"==typeof e?e:Qc($c("private key",e,i))}catch{throw new Error("invalid private key, expected hex or "+i+" bytes, got "+typeof e)}return r&&(a=wh(a,s)),ih("private key",a,eu,s),a}function l(e){if(!(e instanceof u))throw new Error("ProjectivePoint expected")}const c=uh(((e,t)=>{const{px:i,py:r,pz:s}=e;if(n.eql(s,n.ONE))return{x:i,y:r};const a=e.is0();null==t&&(t=a?n.ONE:n.inv(s));const o=n.mul(i,t),l=n.mul(r,t),c=n.mul(s,t);if(a)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:o,y:l}})),h=uh((e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:i,y:r}=e.toAffine();if(!n.isValid(i)||!n.isValid(r))throw new Error("bad point: x or y not FE");const s=n.sqr(r),o=a(i);if(!n.eql(s,o))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class u{constructor(e,t,i){if(this.px=e,this.py=t,this.pz=i,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==i||!n.isValid(i))throw new Error("z required");Object.freeze(this)}static fromAffine(e){const{x:t,y:i}=e||{};if(!e||!n.isValid(t)||!n.isValid(i))throw new Error("invalid affine point");if(e instanceof u)throw new Error("projective point not allowed");const r=e=>n.eql(e,n.ZERO);return r(t)&&r(i)?u.ZERO:new u(t,i,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(u.fromAffine)}static fromHex(e){const t=u.fromAffine(s($c("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return u.BASE.multiply(o(e))}static msm(e,t){return Uh(u,i,e,t)}_setWindowSize(e){p.setWindowSize(this,e)}assertValidity(){h(this)}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){l(e);const{px:t,py:i,pz:r}=this,{px:s,py:a,pz:o}=e,c=n.eql(n.mul(t,o),n.mul(s,r)),h=n.eql(n.mul(i,o),n.mul(a,r));return c&&h}negate(){return new u(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:i}=t,r=n.mul(i,tu),{px:s,py:a,pz:o}=this;let l=n.ZERO,c=n.ZERO,h=n.ZERO,d=n.mul(s,s),p=n.mul(a,a),f=n.mul(o,o),m=n.mul(s,a);return m=n.add(m,m),h=n.mul(s,o),h=n.add(h,h),l=n.mul(e,h),c=n.mul(r,f),c=n.add(l,c),l=n.sub(p,c),c=n.add(p,c),c=n.mul(l,c),l=n.mul(m,l),h=n.mul(r,h),f=n.mul(e,f),m=n.sub(d,f),m=n.mul(e,m),m=n.add(m,h),h=n.add(d,d),d=n.add(h,d),d=n.add(d,f),d=n.mul(d,m),c=n.add(c,d),f=n.mul(a,o),f=n.add(f,f),d=n.mul(f,m),l=n.sub(l,d),h=n.mul(f,p),h=n.add(h,h),h=n.add(h,h),new u(l,c,h)}add(e){l(e);const{px:i,py:r,pz:s}=this,{px:a,py:o,pz:c}=e;let h=n.ZERO,d=n.ZERO,p=n.ZERO;const f=t.a,m=n.mul(t.b,tu);let g=n.mul(i,a),v=n.mul(r,o),y=n.mul(s,c),b=n.add(i,r),w=n.add(a,o);b=n.mul(b,w),w=n.add(g,v),b=n.sub(b,w),w=n.add(i,s);let x=n.add(a,c);return w=n.mul(w,x),x=n.add(g,y),w=n.sub(w,x),x=n.add(r,s),h=n.add(o,c),x=n.mul(x,h),h=n.add(v,y),x=n.sub(x,h),p=n.mul(f,w),h=n.mul(m,y),p=n.add(h,p),h=n.sub(v,p),p=n.add(v,p),d=n.mul(h,p),v=n.add(g,g),v=n.add(v,g),y=n.mul(f,y),w=n.mul(m,w),v=n.add(v,y),y=n.sub(g,y),y=n.mul(f,y),w=n.add(w,y),g=n.mul(v,w),d=n.add(d,g),g=n.mul(x,w),h=n.mul(b,h),h=n.sub(h,g),g=n.mul(b,v),p=n.mul(x,p),p=n.add(p,g),new u(h,d,p)}subtract(e){return this.add(e.negate())}is0(){return this.equals(u.ZERO)}wNAF(e){return p.wNAFCached(this,e,u.normalizeZ)}multiplyUnsafe(e){const{endo:i,n:r}=t;ih("scalar",e,$h,r);const s=u.ZERO;if(e===$h)return s;if(this.is0()||e===eu)return this;if(!i||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,e,u.normalizeZ);let{k1neg:a,k1:o,k2neg:l,k2:c}=i.splitScalar(e),h=s,d=s,f=this;for(;o>$h||c>$h;)o&eu&&(h=h.add(f)),c&eu&&(d=d.add(f)),f=f.double(),o>>=eu,c>>=eu;return a&&(h=h.negate()),l&&(d=d.negate()),d=new u(n.mul(d.px,i.beta),d.py,d.pz),h.add(d)}multiply(e){const{endo:i,n:r}=t;let s,a;if(ih("scalar",e,eu,r),i){const{k1neg:t,k1:r,k2neg:o,k2:l}=i.splitScalar(e);let{p:c,f:h}=this.wNAF(r),{p:d,f:f}=this.wNAF(l);c=p.constTimeNegate(t,c),d=p.constTimeNegate(o,d),d=new u(n.mul(d.px,i.beta),d.py,d.pz),s=c.add(d),a=h.add(f)}else{const{p:t,f:n}=this.wNAF(e);s=t,a=n}return u.normalizeZ([s,a])[0]}multiplyAndAddUnsafe(e,t,n){const i=u.BASE,r=(e,t)=>t!==$h&&t!==eu&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t),s=r(this,t).add(r(e,n));return s.is0()?void 0:s}toAffine(e){return c(this,e)}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===eu)return!0;if(n)return n(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===eu?this:n?n(u,this):this.multiplyUnsafe(t.h)}toRawBytes(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return kc("isCompressed",e),this.assertValidity(),r(u,this,e)}toHex(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return kc("isCompressed",e),Uc(this.toRawBytes(e))}}u.BASE=new u(t.Gx,t.Gy,n.ONE),u.ZERO=new u(n.ZERO,n.ONE,n.ZERO);const d=t.nBitLength,p=function(e,t){return{constTimeNegate:Oh,hasPrecomputes:e=>1!==Bh(e),unsafeLadder(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ZERO,r=t;for(;n>Nh;)n&Ih&&(i=i.add(r)),r=r.double(),n>>=Ih;return i},precomputeWindow(e,n){const{windows:i,windowSize:r}=Lh(n,t),s=[];let a=e,o=a;for(let t=0;t<i;t++){o=a,s.push(o);for(let e=1;e<r;e++)o=o.add(a),s.push(o);a=o.double()}return s},wNAF(n,i,r){const{windows:s,windowSize:a}=Lh(n,t);let o=e.ZERO,l=e.BASE;const c=BigInt(2**n-1),h=2**n,u=BigInt(n);for(let e=0;e<s;e++){const t=e*a;let n=Number(r&c);r>>=u,n>a&&(n-=h,r+=Ih);const s=t,d=t+Math.abs(n)-1,p=e%2!==0,f=n<0;0===n?l=l.add(Oh(p,i[s])):o=o.add(Oh(f,i[d]))}return{p:o,f:l}},wNAFUnsafe(n,i,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.ZERO;const{windows:a,windowSize:o}=Lh(n,t),l=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let e=0;e<a;e++){const t=e*o;if(r===Nh)break;let n=Number(r&l);if(r>>=h,n>o&&(n-=c,r+=Ih),0===n)continue;let a=i[t+Math.abs(n)-1];n<0&&(a=a.negate()),s=s.add(a)}return s},getPrecomputes(e,t,n){let i=Rh.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&Rh.set(t,n(i))),i},wNAFCached(e,t,n){const i=Bh(e);return this.wNAF(i,this.getPrecomputes(i,e,n),t)},wNAFCachedUnsafe(e,t,n,i){const r=Bh(e);return 1===r?this.unsafeLadder(e,t,i):this.wNAFUnsafe(r,this.getPrecomputes(r,e,n),t,i)},setWindowSize(e,n){Dh(n,t),kh.set(e,n),Rh.delete(e)}}}(u,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:u,normPrivateKeyToScalar:o,weierstrassEquation:a,isWithinCurveOrder:function(e){return nh(e,eu,t.n)}}}function iu(e){const t=function(e){const t=zh(e);return hh(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:n,n:i}=t,r=n.BYTES+1,s=2*n.BYTES+1;function a(e){return wh(e,i)}function o(e){return Ch(e,i)}const{ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:h,isWithinCurveOrder:u}=nu({...t,toBytes(e,t,i){const r=t.toAffine(),s=n.toBytes(r.x),a=eh;return kc("isCompressed",i),i?a(Uint8Array.from([t.hasEvenY()?2:3]),s):a(Uint8Array.from([4]),s,n.toBytes(r.y))},fromBytes(e){const t=e.length,i=e[0],a=e.subarray(1);if(t!==r||2!==i&&3!==i){if(t===s&&4===i){return{x:n.fromBytes(a.subarray(0,n.BYTES)),y:n.fromBytes(a.subarray(n.BYTES,2*n.BYTES))}}throw new Error("invalid Point, expected length of "+r+", or uncompressed "+s+", got "+t)}{const e=Qc(a);if(!nh(e,eu,n.ORDER))throw new Error("Point is not on curve");const t=h(e);let r;try{r=n.sqrt(t)}catch(ge){const t=ge instanceof Error?": "+ge.message:"";throw new Error("Point is not on curve"+t)}return 1===(1&i)!==((r&eu)===eu)&&(r=n.neg(r)),{x:e,y:r}}}}),d=e=>Uc(Zc(e,t.nByteLength));function p(e){return e>i>>eu}const f=(e,t,n)=>Qc(e.slice(t,n));class m{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=$c("compactSignature",e,2*n),new m(f(e,0,n),f(e,n,2*n))}static fromDER(e){const{r:t,s:n}=Jh.toSig($c("DER",e));return new m(t,n)}assertValidity(){ih("r",this.r,eu,i),ih("s",this.s,eu,i)}addRecoveryBit(e){return new m(this.r,this.s,e)}recoverPublicKey(e){const{r:i,s:r,recovery:s}=this,c=b($c("msgHash",e));if(null==s||![0,1,2,3].includes(s))throw new Error("recovery id invalid");const h=2===s||3===s?i+t.n:i;if(h>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const u=0===(1&s)?"02":"03",p=l.fromHex(u+d(h)),f=o(h),m=a(-c*f),g=a(r*f),v=l.BASE.multiplyAndAddUnsafe(p,m,g);if(!v)throw new Error("point at infinify");return v.assertValidity(),v}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Yc(this.toDERHex())}toDERHex(){return Jh.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Yc(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const g={isValidPrivateKey(e){try{return c(e),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{const e=Mh(t.n);return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.length,r=Ph(t),s=Mh(t);if(i<16||i<s||i>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+i);const a=wh(n?Xc(e):Qc(e),t-fh)+fh;return n?Jc(a,r):Zc(a,r)}(t.randomBytes(e),t.n)},precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function v(e){const t=Lc(e),n="string"==typeof e,i=(t||n)&&e.length;return t?i===r||i===s:n?i===2*r||i===2*s:e instanceof l}const y=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const n=Qc(e),i=8*e.length-t.nBitLength;return i>0?n>>BigInt(i):n},b=t.bits2int_modN||function(e){return a(y(e))},w=sh(t.nBitLength);function x(e){return ih("num < 2^"+t.nBitLength,e,$h,w),Zc(e,t.nByteLength)}function E(e,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C;if(["recovered","canonical"].some((e=>e in r)))throw new Error("sign() legacy options not supported");const{hash:s,randomBytes:h}=t;let{lowS:d,prehash:f,extraEntropy:g}=r;null==d&&(d=!0),e=$c("msgHash",e),Yh(r),f&&(e=$c("prehashed msgHash",s(e)));const v=b(e),w=c(i),E=[x(w),x(v)];if(null!=g&&!1!==g){const e=!0===g?h(n.BYTES):g;E.push($c("extraEntropy",e))}const A=eh(...E),S=v;return{seed:A,k2sig:function(e){const t=y(e);if(!u(t))return;const n=o(t),i=l.BASE.multiply(t).toAffine(),r=a(i.x);if(r===$h)return;const s=a(n*a(S+r*w));if(s===$h)return;let c=(i.x===r?0:2)|Number(i.y&eu),h=s;return d&&p(s)&&(h=function(e){return p(e)?a(-e):e}(s),c^=1),new m(r,h,c)}}}const C={lowS:t.lowS,prehash:!1},A={lowS:t.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(v(e))throw new Error("first arg must be private key");if(!v(t))throw new Error("second arg must be public key");return l.fromHex(t).multiply(c(e)).toRawBytes(n)},sign:function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C;const{seed:r,k2sig:s}=E(e,n,i),a=t;return lh(a.hash.outputLen,a.nByteLength,a.hmac)(r,s)},verify:function(e,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:A;const s=e;n=$c("msgHash",n),i=$c("publicKey",i);const{lowS:c,prehash:h,format:u}=r;if(Yh(r),"strict"in r)throw new Error("options.strict was renamed to lowS");if(void 0!==u&&"compact"!==u&&"der"!==u)throw new Error("format must be compact or der");const d="string"==typeof s||Lc(s),p=!d&&!u&&"object"==typeof s&&null!==s&&"bigint"==typeof s.r&&"bigint"==typeof s.s;if(!d&&!p)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let f,g;try{if(p&&(f=new m(s.r,s.s)),d){try{"compact"!==u&&(f=m.fromDER(s))}catch(Ge){if(!(Ge instanceof Jh.Err))throw Ge}!f&&"der"!==u&&(f=m.fromCompact(s))}g=l.fromHex(i)}catch{return!1}if(!f||c&&f.hasHighS())return!1;h&&(n=t.hash(n));const{r:v,s:y}=f,w=b(n),x=o(y),E=a(w*x),C=a(v*x),S=l.BASE.multiplyAndAddUnsafe(g,E,C)?.toAffine();return!!S&&a(S.x)===v},ProjectivePoint:l,Signature:m,utils:g}}function ru(e){return{hash:e,hmac:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return bc(e,t,function(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];Ro(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,i=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,i),i+=e.length}return t}(...i))},randomBytes:Zo}}BigInt(4);const su=Th(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),au=function(e,t){const n=t=>iu({...e,...ru(t)});return{...n(t),create:n}}({a:su.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:su,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Nc),ou="base10",lu="base16",cu="base64pad",hu="base64url",uu="utf8";function du(){return Wa(Zo(32),lu)}function pu(e){return Wa(Nc(Ha(e,lu)),lu)}function fu(e){return Wa(Nc(Ha(e,uu)),lu)}function mu(e){return Ha(`${e}`,ou)}function gu(e){return Number(Wa(e,ou))}function vu(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function yu(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=(4-t.length%4)%4;return t+"=".repeat(n)}function bu(e){if(2===gu(e.type))return Wa(ms([e.type,e.sealed]),cu);if(1===gu(e.type)){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Wa(ms([e.type,e.senderPublicKey,e.iv,e.sealed]),cu)}return Wa(ms([e.type,e.iv,e.sealed]),cu)}function wu(e){const t=Ha((e.encoding||cu)===hu?yu(e.encoded):e.encoded,cu),n=t.slice(0,1);if(1===gu(n)){const e=33,i=e+12,r=t.slice(1,e),s=t.slice(e,i);return{type:n,sealed:t.slice(i),iv:s,senderPublicKey:r}}if(2===gu(n)){return{type:n,sealed:t.slice(1),iv:Zo(12)}}const i=t.slice(1,13);return{type:n,sealed:t.slice(13),iv:i}}function xu(e){const t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function Eu(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function Cu(e){return 2===e.type}function Au(e,t){const[n,i,r]=e.split("."),s=Buffer.from(yu(r),"base64");if(64!==s.length)throw new Error("Invalid signature length");const a=s.slice(0,32),o=s.slice(32,64),l=Nc(`${n}.${i}`),c=function(e){const t=Buffer.from(e.x,"base64"),n=Buffer.from(e.y,"base64");return ms([new Uint8Array([4]),t,n])}(t);if(!au.verify(ms([a,o]),l,c))throw new Error("Invalid signature");return Yi(e).payload}function Su(e){return e?.relay||{protocol:"irn"}}function _u(e){const t=Ga[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}function Tu(e){const t={},n="relay"+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-");return Object.keys(e).forEach((i=>{if(i.startsWith(n)){const r=i.replace(n,""),s=e[i];t[r]=s}})),t}function Pu(e){if(!e.includes("wc:")){const t=Do(e);null!=t&&t.includes("wc:")&&(e=t)}const t=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),n=-1!==e.indexOf("?")?e.indexOf("?"):void 0,i=e.substring(0,t),r=e.substring(t+1,n).split("@"),s=typeof n<"u"?e.substring(n):"",a=new URLSearchParams(s),o={};a.forEach(((e,t)=>{o[t]=e}));const l="string"==typeof o.methods?o.methods.split(","):void 0;return{protocol:i,topic:Mu(r[0]),version:parseInt(r[1],10),symKey:o.symKey,relay:Tu(o),methods:l,expiryTimestamp:o.expiryTimestamp?parseInt(o.expiryTimestamp,10):void 0}}function Mu(e){return e.startsWith("//")?e.substring(2):e}function Nu(e){const t=new URLSearchParams,n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";const n={};return Object.keys(e).forEach((i=>{const r=i,s="relay"+t+r;e[r]&&(n[s]=e[r])})),n}(e.relay);Object.keys(n).sort().forEach((e=>{t.set(e,n[e])})),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));const i=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${i}`}function Iu(e,t,n){return`${e}?wc_ev=${n}&topic=${t}`}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function Ou(e){const t=[];return e.forEach((e=>{const[n,i]=e.split(":");t.push(`${n}:${i}`)})),t}function Du(e,t){t=t.map((e=>e.replace("did:pkh:","")));const n=function(e){const t={};return e?.forEach((e=>{var n;const[i,r]=e.split(":");t[i]||(t[i]={accounts:[],chains:[],events:[],methods:[]}),t[i].accounts.push(e),null==(n=t[i].chains)||n.push(`${i}:${r}`)})),t}(t);for(const[i,r]of Object.entries(n))r.methods?r.methods=Po(r.methods,e):r.methods=e,r.events=["chainChanged","accountsChanged"];return n}const Lu={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ru={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ku(e,t){const{message:n,code:i}=Ru[e];return{message:t?`${n} ${t}`:n,code:i}}function Bu(e,t){const{message:n,code:i}=Lu[e];return{message:t?`${n} ${t}`:n,code:i}}function Uu(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function zu(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function Fu(e){return typeof e>"u"}function ju(e,t){return!(!t||!Fu(e))||"string"==typeof e&&!!e.trim().length}function Vu(e,t){return!(!t||!Fu(e))||"number"==typeof e&&!isNaN(e)}function Hu(e){return!(!ju(e,!1)||!e.includes(":"))&&2===e.split(":").length}function Wu(e){let t=!0;return Uu(e)?e.length&&(t=e.every((e=>ju(e,!1)))):t=!1,t}function Gu(e,t,n){let i=null;return Object.entries(e).forEach((e=>{let[r,s]=e;if(i)return;const a=function(e,t,n){let i=null;return Uu(t)&&t.length?t.forEach((e=>{i||Hu(e)||(i=Bu("UNSUPPORTED_CHAINS",`${n}, chain ${e} should be a string and conform to "namespace:chainId" format`))})):Hu(e)||(i=Bu("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}(r,Ya(r,s),`${t} ${n}`);a&&(i=a)})),i}function qu(e,t){let n=null;return Uu(e)?e.forEach((e=>{n||function(e){if(ju(e,!1)&&e.includes(":")){const t=e.split(":");if(3===t.length){const e=t[0]+":"+t[1];return!!t[2]&&Hu(e)}}return!1}(e)||(n=Bu("UNSUPPORTED_ACCOUNTS",`${t}, account ${e} should be a string and conform to "namespace:chainId:address" format`))})):n=Bu("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function Ku(e,t){let n=null;return Object.values(e).forEach((e=>{if(n)return;const i=function(e,t){let n=null;return Wu(e?.methods)?Wu(e?.events)||(n=Bu("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):n=Bu("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),n}(e,`${t}, namespace`);i&&(n=i)})),n}function Yu(e,t){let n=null;if(e&&zu(e)){const i=Ku(e,t);i&&(n=i);const r=function(e,t){let n=null;return Object.values(e).forEach((e=>{if(n)return;const i=qu(e?.accounts,`${t} namespace`);i&&(n=i)})),n}(e,t);r&&(n=r)}else n=ku("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return n}function Qu(e){return ju(e.protocol,!0)}function Xu(e){return typeof e<"u"&&null!==typeof e}function Zu(e,t){return!(!Hu(t)||!function(e){const t=[];return Object.values(e).forEach((e=>{t.push(...Ou(e.accounts))})),t}(e).includes(t))}function Ju(e,t,n){return!!ju(n,!1)&&function(e,t){const n=[];return Object.values(e).forEach((e=>{Ou(e.accounts).includes(t)&&n.push(...e.methods)})),n}(e,t).includes(n)}function $u(e,t,n){return!!ju(n,!1)&&function(e,t){const n=[];return Object.values(e).forEach((e=>{Ou(e.accounts).includes(t)&&n.push(...e.events)})),n}(e,t).includes(n)}function ed(e,t,n){let i=null;const r=function(e){const t={};return Object.keys(e).forEach((n=>{var i;n.includes(":")?t[n]=e[n]:null==(i=e[n].chains)||i.forEach((i=>{t[i]={methods:e[n].methods,events:e[n].events}}))})),t}(e),s=function(e){const t={};return Object.keys(e).forEach((n=>{if(n.includes(":"))t[n]=e[n];else{const i=Ou(e[n].accounts);i?.forEach((i=>{t[i]={accounts:e[n].accounts.filter((e=>e.includes(`${i}:`))),methods:e[n].methods,events:e[n].events}}))}})),t}(t),a=Object.keys(r),o=Object.keys(s),l=td(Object.keys(e)),c=td(Object.keys(t)),h=l.filter((e=>!c.includes(e)));return h.length&&(i=ku("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.\n      Required: ${h.toString()}\n      Received: ${Object.keys(t).toString()}`)),yo(a,o)||(i=ku("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.\n      Required: ${a.toString()}\n      Approved: ${o.toString()}`)),Object.keys(t).forEach((e=>{if(!e.includes(":")||i)return;const r=Ou(t[e].accounts);r.includes(e)||(i=ku("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${e}\n        Required: ${e}\n        Approved: ${r.toString()}`))})),a.forEach((e=>{i||(yo(r[e].methods,s[e].methods)?yo(r[e].events,s[e].events)||(i=ku("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${e}`)):i=ku("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${e}`))})),i}function td(e){return[...new Set(e.map((e=>e.includes(":")?e.split(":")[0]:e)))]}function nd(){const e=uo();return new Promise((t=>{switch(e){case so:t(ho()&&navigator?.onLine);break;case io:t(async function(){if(co()&&typeof n.g<"u"&&null!=n.g&&n.g.NetInfo){const e=await(null==n.g?void 0:n.g.NetInfo.fetch());return e?.isConnected}return!0}());break;default:t(!0)}}))}function id(e){switch(uo()){case so:!function(e){!co()&&ho()&&(window.addEventListener("online",(()=>e(!0))),window.addEventListener("offline",(()=>e(!1))))}(e);break;case io:!function(e){co()&&typeof n.g<"u"&&null!=n.g&&n.g.NetInfo&&n.g?.NetInfo.addEventListener((t=>e(t?.isConnected)))}(e)}}const rd={};class sd{static get(e){return rd[e]}static set(e,t){rd[e]=t}static delete(e){delete rd[e]}}const ad="PARSE_ERROR",od="INVALID_REQUEST",ld="METHOD_NOT_FOUND",cd="INVALID_PARAMS",hd="INTERNAL_ERROR",ud="SERVER_ERROR",dd=[-32700,-32600,-32601,-32602,-32603],pd={[ad]:{code:-32700,message:"Parse error"},[od]:{code:-32600,message:"Invalid Request"},[ld]:{code:-32601,message:"Method not found"},[cd]:{code:-32602,message:"Invalid params"},[hd]:{code:-32603,message:"Internal error"},[ud]:{code:-32e3,message:"Server error"}},fd=ud;function md(e){return dd.includes(e)}function gd(e){return Object.keys(pd).includes(e)?pd[e]:pd[fd]}function vd(e){const t=Object.values(pd).find((t=>t.code===e));return t||pd[fd]}function yd(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${t}`):e}var bd=n(8129);function wd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function xd(){return BigInt(wd(arguments.length>0&&void 0!==arguments[0]?arguments[0]:6))}function Ed(e,t,n){return{id:n||wd(),jsonrpc:"2.0",method:e,params:t}}function Cd(e,t){return{id:e,jsonrpc:"2.0",result:t}}function Ad(e,t,n){return{id:e,jsonrpc:"2.0",error:Sd(t,n)}}function Sd(e,t){return"undefined"===typeof e?gd(hd):("string"===typeof e&&(e=Object.assign(Object.assign({},gd(ud)),{message:e})),"undefined"!==typeof t&&(e.data=t),md(e.code)&&(e=vd(e.code)),e)}class _d{}class Td extends _d{constructor(){super()}}class Pd extends Td{constructor(e){super()}}function Md(e,t){const n=function(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return"undefined"!==typeof n&&new RegExp(t).test(n)}function Nd(e){return Md(e,"^https?:")}function Id(e){return Md(e,"^wss?:")}function Od(e){return"object"===typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function Dd(e){return Od(e)&&"method"in e}function Ld(e){return Od(e)&&(Rd(e)||kd(e))}function Rd(e){return"result"in e}function kd(e){return"error"in e}class Bd extends Pd{constructor(e){super(e),this.events=new v.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.connection;await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Ed(e.method,e.params||[],e.id||xd().toString()),t)}async requestStrict(e,t){return new Promise((async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(x){i(x)}this.events.on(`${e.id}`,(e=>{kd(e)?i(e.error):n(e.result)}));try{await this.connection.send(e,t)}catch(x){i(x)}}))}setConnection(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.connection}onPayload(e){this.events.emit("payload",e),Ld(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.connection;this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",(e=>this.onPayload(e))),this.connection.on("close",(e=>this.onClose(e))),this.connection.on("error",(e=>this.events.emit("error",e))),this.connection.on("register_error",(e=>this.onClose())),this.hasRegisteredEventListeners=!0)}}const Ud=e=>e.split("?")[0],zd=typeof WebSocket<"u"?WebSocket:typeof n.g<"u"&&typeof n.g.WebSocket<"u"?n.g.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:n(61198);class Fd{constructor(e){if(this.url=e,this.events=new v.EventEmitter,this.registering=!1,!Id(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url;await this.register(e)}async close(){return new Promise(((e,t)=>{typeof this.socket>"u"?t(new Error("Connection already closed")):(this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close())}))}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send((0,Y.h)(e))}catch(vc){this.onError(e.id,vc)}}register(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url;if(!Id(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise(((e,t)=>{this.events.once("register_error",(e=>{this.resetMaxListeners(),t(e)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return t(new Error("WebSocket connection is missing or invalid"));e(this.socket)}))}))}return this.url=e,this.registering=!0,new Promise(((t,i)=>{const r=(0,bd.isReactNative)()?void 0:{rejectUnauthorized:(a=e,!new RegExp("wss?://localhost(:d{2,5})?").test(a))},s=new zd(e,[],r);var a;typeof WebSocket<"u"||typeof n.g<"u"&&typeof n.g.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u"?s.onerror=e=>{const t=e;i(this.emitError(t.error))}:s.on("error",(e=>{i(this.emitError(e))})),s.onopen=()=>{this.onOpen(s),t(s)}}))}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?(0,Y.j)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),i=Ad(e,n.message||n.toString());this.events.emit("payload",i)}parseError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.url;return yd(e,Ud(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${Ud(this.url)}`));return this.events.emit("register_error",t),t}}const jd="core",Vd=`wc@2:${jd}:`,Hd="error",Wd={database:":memory:"},Gd="client_ed25519_seed",qd=b.ONE_DAY,Kd=b.SIX_HOURS,Yd="wss://relay.walletconnect.org",Qd="relayer_message",Xd="relayer_message_ack",Zd="relayer_connect",Jd="relayer_disconnect",$d="relayer_error",ep="relayer_connection_stalled",tp="relayer_publish",np="payload",ip="connect",rp="disconnect",sp="error",ap="2.19.2",op={link_mode:"link_mode",relay:"relay"},lp="inbound",cp="outbound",hp="WALLETCONNECT_LINK_MODE_APPS",up="subscription_created",dp="subscription_deleted",pp="subscription_sync",fp="subscription_resubscribed",mp=(b.FIVE_SECONDS,{wc_pairingDelete:{req:{ttl:b.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:b.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:b.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:b.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:b.ONE_DAY,prompt:!1,tag:0},res:{ttl:b.ONE_DAY,prompt:!1,tag:0}}}),gp="pairing_create",vp="pairing_expire",yp="pairing_delete",bp="pairing_ping",wp="history_created",xp="history_updated",Ep="history_deleted",Cp="history_sync",Ap="expirer_created",Sp="expirer_deleted",_p="expirer_expired",Tp="expirer_sync",Pp="https://verify.walletconnect.org",Mp=Pp,Np=`${Mp}/v3`,Ip=["https://verify.walletconnect.com",Pp],Op="pairing_started",Dp="pairing_uri_validation_success",Lp="pairing_uri_not_expired",Rp="store_new_pairing",kp="subscribing_pairing_topic",Bp="subscribe_pairing_topic_success",Up="existing_pairing",zp="pairing_not_expired",Fp="emit_inactive_pairing",jp="emit_session_proposal",Vp="no_internet_connection",Hp="malformed_pairing_uri",Wp="active_pairing_already_exists",Gp="subscribe_pairing_topic_failure",qp="pairing_expired",Kp="proposal_listener_not_found",Yp="session_approve_started",Qp="session_namespaces_validation_success",Xp="subscribing_session_topic",Zp="subscribe_session_topic_success",Jp="publishing_session_approve",$p="session_approve_publish_success",ef="store_session",tf="publishing_session_settle",nf="session_settle_publish_success",rf="no_internet_connection",sf="proposal_expired",af="subscribe_session_topic_failure",of="session_approve_publish_failure",lf="session_settle_publish_failure",cf="session_approve_namespace_validation_failure",hf="proposal_not_found",uf="authenticated_session_approve_started",df="create_authenticated_session_topic",pf="cacaos_verified",ff="store_authenticated_session",mf="subscribing_authenticated_session_topic",gf="subscribe_authenticated_session_topic_success",vf="publishing_authenticated_session_approve",yf="no_internet_connection",bf="invalid_cacao",wf="subscribe_authenticated_session_topic_failure",xf="authenticated_session_approve_publish_failure",Ef="authenticated_session_pending_request_not_found";var Cf=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),i=0;i<n.length;i++)n[i]=255;for(var r=0;r<e.length;r++){var s=e.charAt(r),a=s.charCodeAt(0);if(255!==n[a])throw new TypeError(s+" is ambiguous");n[a]=r}var o=e.length,l=e.charAt(0),c=Math.log(o)/Math.log(256),h=Math.log(256)/Math.log(o);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var i=0,r=0;e[t]===l;)i++,t++;for(var s=(e.length-t)*c+1>>>0,a=new Uint8Array(s);e[t];){var h=n[e.charCodeAt(t)];if(255===h)return;for(var u=0,d=s-1;(0!==h||u<r)&&-1!==d;d--,u++)h+=o*a[d]>>>0,a[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");r=u,t++}if(" "!==e[t]){for(var p=s-r;p!==s&&0===a[p];)p++;for(var f=new Uint8Array(i+(s-p)),m=i;p!==s;)f[m++]=a[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,i=0,r=0,s=t.length;r!==s&&0===t[r];)r++,n++;for(var a=(s-r)*h+1>>>0,c=new Uint8Array(a);r!==s;){for(var u=t[r],d=0,p=a-1;(0!==u||d<i)&&-1!==p;p--,d++)u+=256*c[p]>>>0,c[p]=u%o>>>0,u=u/o>>>0;if(0!==u)throw new Error("Non-zero carry");i=d,r++}for(var f=a-i;f!==a&&0===c[f];)f++;for(var m=l.repeat(n);f<a;++f)m+=e.charAt(c[f]);return m},decodeUnsafe:u,decode:function(e){var n=u(e);if(n)return n;throw new Error(`Non-${t} character`)}}},Af=Cf;const Sf=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class _f{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Tf{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Mf(this,e)}}class Pf{constructor(e){this.decoders=e}or(e){return Mf(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Mf=(e,t)=>new Pf({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Nf{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new _f(e,t,n),this.decoder=new Tf(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const If=e=>{let{name:t,prefix:n,encode:i,decode:r}=e;return new Nf(t,n,i,r)},Of=e=>{let{prefix:t,name:n,alphabet:i}=e;const{encode:r,decode:s}=Af(i,n);return If({prefix:t,name:n,encode:r,decode:e=>Sf(s(e))})},Df=e=>{let{name:t,prefix:n,bitsPerChar:i,alphabet:r}=e;return If({prefix:n,name:t,encode:e=>((e,t,n)=>{const i="="===t[t.length-1],r=(1<<n)-1;let s="",a=0,o=0;for(let l=0;l<e.length;++l)for(o=o<<8|e[l],a+=8;a>n;)a-=n,s+=t[r&o>>a];if(a&&(s+=t[r&o<<n-a]),i)for(;s.length*n&7;)s+="=";return s})(e,r,i),decode:e=>((e,t,n,i)=>{const r={};for(let h=0;h<t.length;++h)r[t[h]]=h;let s=e.length;for(;"="===e[s-1];)--s;const a=new Uint8Array(s*n/8|0);let o=0,l=0,c=0;for(let h=0;h<s;++h){const t=r[e[h]];if(void 0===t)throw new SyntaxError(`Non-${i} character`);l=l<<n|t,o+=n,o>=8&&(o-=8,a[c++]=255&l>>o)}if(o>=n||255&l<<8-o)throw new SyntaxError("Unexpected end of data");return a})(e,r,i,t)})},Lf=If({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var Rf=Object.freeze({__proto__:null,identity:Lf});const kf=Df({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Bf=Object.freeze({__proto__:null,base2:kf});const Uf=Df({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var zf=Object.freeze({__proto__:null,base8:Uf});const Ff=Of({prefix:"9",name:"base10",alphabet:"0123456789"});var jf=Object.freeze({__proto__:null,base10:Ff});const Vf=Df({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Hf=Df({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Wf=Object.freeze({__proto__:null,base16:Vf,base16upper:Hf});const Gf=Df({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qf=Df({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Kf=Df({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Yf=Df({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Qf=Df({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Xf=Df({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Zf=Df({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Jf=Df({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$f=Df({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var em=Object.freeze({__proto__:null,base32:Gf,base32upper:qf,base32pad:Kf,base32padupper:Yf,base32hex:Qf,base32hexupper:Xf,base32hexpad:Zf,base32hexpadupper:Jf,base32z:$f});const tm=Of({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),nm=Of({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var im=Object.freeze({__proto__:null,base36:tm,base36upper:nm});const rm=Of({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),sm=Of({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var am=Object.freeze({__proto__:null,base58btc:rm,base58flickr:sm});const om=Df({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),lm=Df({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),cm=Df({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),hm=Df({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var um=Object.freeze({__proto__:null,base64:om,base64pad:lm,base64url:cm,base64urlpad:hm});const dm=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),pm=dm.reduce(((e,t,n)=>(e[n]=t,e)),[]),fm=dm.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const mm=If({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=pm[t]),"")},decode:function(e){const t=[];for(const n of e){const e=fm[n.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${n}`);t.push(e)}return new Uint8Array(t)}});var gm=Object.freeze({__proto__:null,base256emoji:mm}),vm=function e(t,n,i){n=n||[];for(var r=i=i||0;t>=wm;)n[i++]=255&t|ym,t/=128;for(;t&bm;)n[i++]=255&t|ym,t>>>=7;return n[i]=0|t,e.bytes=i-r+1,n},ym=128,bm=-128,wm=Math.pow(2,31);var xm=function e(t,n){var i,r=0,s=(n=n||0,0),a=n,o=t.length;do{if(a>=o)throw e.bytes=0,new RangeError("Could not decode varint");i=t[a++],r+=s<28?(i&Cm)<<s:(i&Cm)*Math.pow(2,s),s+=7}while(i>=Em);return e.bytes=a-n,r},Em=128,Cm=127;var Am=Math.pow(2,7),Sm=Math.pow(2,14),_m=Math.pow(2,21),Tm=Math.pow(2,28),Pm=Math.pow(2,35),Mm=Math.pow(2,42),Nm=Math.pow(2,49),Im=Math.pow(2,56),Om=Math.pow(2,63),Dm={encode:vm,decode:xm,encodingLength:function(e){return e<Am?1:e<Sm?2:e<_m?3:e<Tm?4:e<Pm?5:e<Mm?6:e<Nm?7:e<Im?8:e<Om?9:10}},Lm=Dm;const Rm=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Lm.encode(e,t,n),t},km=e=>Lm.encodingLength(e),Bm=(e,t)=>{const n=t.byteLength,i=km(e),r=i+km(n),s=new Uint8Array(r+n);return Rm(e,s,0),Rm(n,s,i),s.set(t,r),new Um(e,n,t,s)};class Um{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}}const zm=e=>{let{name:t,code:n,encode:i}=e;return new Fm(t,n,i)};class Fm{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Bm(this.code,t):t.then((e=>Bm(this.code,e)))}throw Error("Unknown type, must be binary type")}}const jm=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Vm=zm({name:"sha2-256",code:18,encode:jm("SHA-256")}),Hm=zm({name:"sha2-512",code:19,encode:jm("SHA-512")});Object.freeze({__proto__:null,sha256:Vm,sha512:Hm});const Wm=Sf,Gm={code:0,name:"identity",encode:Wm,digest:e=>Bm(0,Wm(e))};Object.freeze({__proto__:null,identity:Gm});new TextEncoder,new TextDecoder;const qm={...Rf,...Bf,...zf,...jf,...Wf,...em,...im,...am,...um,...gm};function Km(e,t,n,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:i}}}const Ym=Km("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Qm=Km("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{const t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}((e=e.substring(1)).length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),Xm={utf8:Ym,"utf-8":Ym,hex:qm.base16,latin1:Qm,ascii:Qm,binary:Qm,...qm};var Zm=Object.defineProperty,Jm=(e,t,n)=>((e,t,n)=>t in e?Zm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class $m{constructor(e,t){this.core=e,this.logger=t,Jm(this,"keychain",new Map),Jm(this,"name","keychain"),Jm(this,"version","0.3"),Jm(this,"initialized",!1),Jm(this,"storagePrefix",Vd),Jm(this,"init",(async()=>{if(!this.initialized){const e=await this.getKeyChain();typeof e<"u"&&(this.keychain=e),this.initialized=!0}})),Jm(this,"has",(e=>(this.isInitialized(),this.keychain.has(e)))),Jm(this,"set",(async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()})),Jm(this,"get",(e=>{this.isInitialized();const t=this.keychain.get(e);if(typeof t>"u"){const{message:t}=ku("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t})),Jm(this,"del",(async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()})),this.core=e,this.logger=(0,ie.U5)(t,this.name)}get context(){return(0,ie.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,bo(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?wo(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ku("NOT_INITIALIZED",this.name);throw new Error(e)}}}var eg=Object.defineProperty,tg=(e,t,n)=>((e,t,n)=>t in e?eg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class ng{constructor(e,t,n){this.core=e,this.logger=t,tg(this,"name","crypto"),tg(this,"keychain"),tg(this,"randomSessionIdentifier",du()),tg(this,"initialized",!1),tg(this,"init",(async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)})),tg(this,"hasKeys",(e=>(this.isInitialized(),this.keychain.has(e)))),tg(this,"getClientId",(async()=>{this.isInitialized();return qi(Qi(await this.getClientSeed()).publicKey)})),tg(this,"generateKeyPair",(()=>{this.isInitialized();const e=function(){const e=Kh.utils.randomPrivateKey(),t=Kh.getPublicKey(e);return{privateKey:Wa(e,lu),publicKey:Wa(t,lu)}}();return this.setPrivateKey(e.publicKey,e.privateKey)})),tg(this,"signJWT",(async e=>{this.isInitialized();const t=Qi(await this.getClientSeed()),n=this.randomSessionIdentifier,i=qd;return await Xi(n,e,i,t)})),tg(this,"generateSharedKey",((e,t,n)=>{this.isInitialized();const i=function(e,t){const n=Kh.getSharedSecret(Ha(e,lu),Ha(t,lu));return Wa(Ec(Nc,n,void 0,void 0,32),lu)}(this.getPrivateKey(e),t);return this.setSymKey(i,n)})),tg(this,"setSymKey",(async(e,t)=>{this.isInitialized();const n=t||pu(e);return await this.keychain.set(n,e),n})),tg(this,"deleteKeyPair",(async e=>{this.isInitialized(),await this.keychain.del(e)})),tg(this,"deleteSymKey",(async e=>{this.isInitialized(),await this.keychain.del(e)})),tg(this,"encode",(async(e,t,n)=>{this.isInitialized();const i=xu(n),r=(0,Y.h)(t);if(Cu(i))return function(e,t){const n=mu(2),i=Zo(12),r=bu({type:n,sealed:Ha(e,uu),iv:i});return t===hu?vu(r):r}(r,n?.encoding);if(Eu(i)){const t=i.senderPublicKey,n=i.receiverPublicKey;e=await this.generateSharedKey(t,n)}const s=this.getSymKey(e),{type:a,senderPublicKey:o}=i;return function(e){const t=mu(typeof e.type<"u"?e.type:0);if(1===gu(t)&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof e.senderPublicKey<"u"?Ha(e.senderPublicKey,lu):void 0,i=typeof e.iv<"u"?Ha(e.iv,lu):Zo(12),r=Ha(e.symKey,lu),s=bu({type:t,sealed:gc(r,i).encrypt(Ha(e.message,uu)),iv:i,senderPublicKey:n});return e.encoding===hu?vu(s):s}({type:a,symKey:s,message:r,senderPublicKey:o,encoding:n?.encoding})})),tg(this,"decode",(async(e,t,n)=>{this.isInitialized();const i=function(e,t){const n=wu({encoded:e,encoding:t?.encoding});return xu({type:gu(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?Wa(n.senderPublicKey,lu):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,n);if(Cu(i)){const e=function(e,t){const{sealed:n}=wu({encoded:e,encoding:t});return Wa(n,uu)}(t,n?.encoding);return(0,Y.j)(e)}if(Eu(i)){const t=i.receiverPublicKey,n=i.senderPublicKey;e=await this.generateSharedKey(t,n)}try{const i=function(e){const t=Ha(e.symKey,lu),{sealed:n,iv:i}=wu({encoded:e.encoded,encoding:e.encoding}),r=gc(t,i).decrypt(n);if(null===r)throw new Error("Failed to decrypt");return Wa(r,uu)}({symKey:this.getSymKey(e),encoded:t,encoding:n?.encoding});return(0,Y.j)(i)}catch(J){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(J)}})),tg(this,"getPayloadType",(function(e){return gu(wu({encoded:e,encoding:arguments.length>1&&void 0!==arguments[1]?arguments[1]:cu}).type)})),tg(this,"getPayloadSenderPublicKey",(function(e){const t=wu({encoded:e,encoding:arguments.length>1&&void 0!==arguments[1]?arguments[1]:cu});return t.senderPublicKey?Wa(t.senderPublicKey,lu):void 0})),this.core=e,this.logger=(0,ie.U5)(t,this.name),this.keychain=n||new $m(this.core,this.logger)}get context(){return(0,ie.oI)(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Gd)}catch{e=du(),await this.keychain.set(Gd,e)}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=Xm[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):globalThis.Buffer.from(e,"utf8")}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ku("NOT_INITIALIZED",this.name);throw new Error(e)}}}var ig=Object.defineProperty,rg=Object.defineProperties,sg=Object.getOwnPropertyDescriptors,ag=Object.getOwnPropertySymbols,og=Object.prototype.hasOwnProperty,lg=Object.prototype.propertyIsEnumerable,cg=(e,t,n)=>t in e?ig(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,hg=(e,t,n)=>cg(e,"symbol"!=typeof t?t+"":t,n);class ug extends he{constructor(e,t){super(e,t),this.logger=e,this.core=t,hg(this,"messages",new Map),hg(this,"messagesWithoutClientAck",new Map),hg(this,"name","messages"),hg(this,"version","0.3"),hg(this,"initialized",!1),hg(this,"storagePrefix",Vd),hg(this,"init",(async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const e=await this.getRelayerMessages();typeof e<"u"&&(this.messages=e);const t=await this.getRelayerMessagesWithoutClientAck();typeof t<"u"&&(this.messagesWithoutClientAck=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(we){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(we)}finally{this.initialized=!0}}})),hg(this,"set",(async(e,t,n)=>{this.isInitialized();const i=fu(t);let r=this.messages.get(e);if(typeof r>"u"&&(r={}),typeof r[i]<"u")return i;if(r[i]=t,this.messages.set(e,r),n===lp){const n=this.messagesWithoutClientAck.get(e)||{};this.messagesWithoutClientAck.set(e,((e,t)=>rg(e,sg(t)))(((e,t)=>{for(var n in t||(t={}))og.call(t,n)&&cg(e,n,t[n]);if(ag)for(var n of ag(t))lg.call(t,n)&&cg(e,n,t[n]);return e})({},n),{[i]:t}))}return await this.persist(),i})),hg(this,"get",(e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t})),hg(this,"getWithoutAck",(e=>{this.isInitialized();const t={};for(const n of e){const e=this.messagesWithoutClientAck.get(n)||{};t[n]=Object.values(e)}return t})),hg(this,"has",((e,t)=>{this.isInitialized();return typeof this.get(e)[fu(t)]<"u"})),hg(this,"ack",(async(e,t)=>{this.isInitialized();const n=this.messagesWithoutClientAck.get(e);if(typeof n>"u")return;delete n[fu(t)],0===Object.keys(n).length?this.messagesWithoutClientAck.delete(e):this.messagesWithoutClientAck.set(e,n),await this.persist()})),hg(this,"del",(async e=>{this.isInitialized(),this.messages.delete(e),this.messagesWithoutClientAck.delete(e),await this.persist()})),this.logger=(0,ie.U5)(e,this.name),this.core=t}get context(){return(0,ie.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,bo(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,bo(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?wo(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?wo(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=ku("NOT_INITIALIZED",this.name);throw new Error(e)}}}var dg=Object.defineProperty,pg=Object.defineProperties,fg=Object.getOwnPropertyDescriptors,mg=Object.getOwnPropertySymbols,gg=Object.prototype.hasOwnProperty,vg=Object.prototype.propertyIsEnumerable,yg=(e,t,n)=>t in e?dg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,bg=(e,t)=>{for(var n in t||(t={}))gg.call(t,n)&&yg(e,n,t[n]);if(mg)for(var n of mg(t))vg.call(t,n)&&yg(e,n,t[n]);return e},wg=(e,t)=>pg(e,fg(t)),xg=(e,t,n)=>yg(e,"symbol"!=typeof t?t+"":t,n);class Eg extends ue{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,xg(this,"events",new v.EventEmitter),xg(this,"name","publisher"),xg(this,"queue",new Map),xg(this,"publishTimeout",(0,b.toMiliseconds)(b.ONE_MINUTE)),xg(this,"initialPublishTimeout",(0,b.toMiliseconds)(15*b.ONE_SECOND)),xg(this,"needsTransportRestart",!1),xg(this,"publish",(async(e,t,n)=>{var i;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:n}});const r=n?.ttl||Kd,s=Su(n),a=n?.prompt||!1,o=n?.tag||0,l=n?.id||xd().toString(),c={topic:e,message:t,opts:{ttl:r,relay:s,prompt:a,tag:o,id:l,attestation:n?.attestation,tvf:n?.tvf}},h=`Failed to publish payload, please try again. id:${l} tag:${o}`;try{const i=new Promise((async i=>{const s=e=>{let{id:t}=e;c.opts.id===t&&(this.removeRequestFromQueue(t),this.relayer.events.removeListener(tp,s),i(c))};this.relayer.events.on(tp,s);const h=Eo(new Promise(((i,s)=>{this.rpcPublish({topic:e,message:t,ttl:r,prompt:a,tag:o,id:l,attestation:n?.attestation,tvf:n?.tvf}).then(i).catch((e=>{this.logger.warn(e,e?.message),s(e)}))})),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${l} tag:${o}`);try{await h,this.events.removeListener(tp,s)}catch(u){this.queue.set(l,wg(bg({},c),{attempt:1})),this.logger.warn(u,u?.message)}}));this.logger.trace({type:"method",method:"publish",params:{id:l,topic:e,message:t,opts:n}}),await Eo(i,this.publishTimeout,h)}catch(u){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(u),null!=(i=n?.internal)&&i.throwOnFailedPublish)throw u}finally{this.queue.delete(l)}})),xg(this,"on",((e,t)=>{this.events.on(e,t)})),xg(this,"once",((e,t)=>{this.events.once(e,t)})),xg(this,"off",((e,t)=>{this.events.off(e,t)})),xg(this,"removeListener",((e,t)=>{this.events.removeListener(e,t)})),this.relayer=e,this.logger=(0,ie.U5)(t,this.name),this.registerEventListeners()}get context(){return(0,ie.oI)(this.logger)}async rpcPublish(e){var t,n,i,r;const{topic:s,message:a,ttl:o=Kd,prompt:l,tag:c,id:h,attestation:u,tvf:d}=e,p={method:_u(Su().protocol).publish,params:bg({topic:s,message:a,ttl:o,prompt:l,tag:c,attestation:u},d),id:h};Fu(null==(t=p.params)?void 0:t.prompt)&&(null==(n=p.params)||delete n.prompt),Fu(null==(i=p.params)?void 0:i.tag)&&(null==(r=p.params)||delete r.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});const f=await this.relayer.request(p);return this.relayer.events.emit(tp,e),this.logger.debug("Successfully Published Payload"),f}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach((async(e,t)=>{const n=e.attempt+1;this.queue.set(t,wg(bg({},e),{attempt:n}));const{topic:i,message:r,opts:s,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(wg(bg({},e),{topic:i,message:r,ttl:s.ttl,prompt:s.prompt,tag:s.tag,id:s.id,attestation:a,tvf:s.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)}))}registerEventListeners(){this.relayer.core.heartbeat.on(C,(()=>{if(this.needsTransportRestart)return this.needsTransportRestart=!1,void this.relayer.events.emit(ep);this.checkQueue()})),this.relayer.on(Xd,(e=>{this.removeRequestFromQueue(e.id.toString())}))}}var Cg=Object.defineProperty,Ag=(e,t,n)=>((e,t,n)=>t in e?Cg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class Sg{constructor(){Ag(this,"map",new Map),Ag(this,"set",((e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])})),Ag(this,"get",(e=>this.map.get(e)||[])),Ag(this,"exists",((e,t)=>this.get(e).includes(t))),Ag(this,"delete",((e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const i=n.filter((e=>e!==t));i.length?this.map.set(e,i):this.map.delete(e)})),Ag(this,"clear",(()=>{this.map.clear()}))}get topics(){return Array.from(this.map.keys())}}var _g=Object.defineProperty,Tg=Object.defineProperties,Pg=Object.getOwnPropertyDescriptors,Mg=Object.getOwnPropertySymbols,Ng=Object.prototype.hasOwnProperty,Ig=Object.prototype.propertyIsEnumerable,Og=(e,t,n)=>t in e?_g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Dg=(e,t)=>{for(var n in t||(t={}))Ng.call(t,n)&&Og(e,n,t[n]);if(Mg)for(var n of Mg(t))Ig.call(t,n)&&Og(e,n,t[n]);return e},Lg=(e,t)=>Tg(e,Pg(t)),Rg=(e,t,n)=>Og(e,"symbol"!=typeof t?t+"":t,n);class kg extends fe{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Rg(this,"subscriptions",new Map),Rg(this,"topicMap",new Sg),Rg(this,"events",new v.EventEmitter),Rg(this,"name","subscription"),Rg(this,"version","0.3"),Rg(this,"pending",new Map),Rg(this,"cached",[]),Rg(this,"initialized",!1),Rg(this,"storagePrefix",Vd),Rg(this,"subscribeTimeout",(0,b.toMiliseconds)(b.ONE_MINUTE)),Rg(this,"initialSubscribeTimeout",(0,b.toMiliseconds)(15*b.ONE_SECOND)),Rg(this,"clientId"),Rg(this,"batchSubscribeTopicsLimit",500),Rg(this,"init",(async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0})),Rg(this,"subscribe",(async(e,t)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{const n=Su(t),i={topic:e,relay:n,transportType:t?.transportType};this.pending.set(e,i);const r=await this.rpcSubscribe(e,n,t);return"string"==typeof r&&(this.onSubscribe(r,i),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),r}catch(x){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(x),x}})),Rg(this,"unsubscribe",(async(e,t)=>{this.isInitialized(),typeof t?.id<"u"?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)})),Rg(this,"isSubscribed",(e=>new Promise((t=>{t(this.topicMap.topics.includes(e))})))),Rg(this,"isKnownTopic",(e=>new Promise((t=>{t(this.topicMap.topics.includes(e)||this.pending.has(e)||this.cached.some((t=>t.topic===e)))})))),Rg(this,"on",((e,t)=>{this.events.on(e,t)})),Rg(this,"once",((e,t)=>{this.events.once(e,t)})),Rg(this,"off",((e,t)=>{this.events.off(e,t)})),Rg(this,"removeListener",((e,t)=>{this.events.removeListener(e,t)})),Rg(this,"start",(async()=>{await this.onConnect()})),Rg(this,"stop",(async()=>{await this.onDisconnect()})),Rg(this,"restart",(async()=>{await this.restore(),await this.onRestart()})),Rg(this,"checkPending",(async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;const e=[];this.pending.forEach((t=>{e.push(t)})),await this.batchSubscribe(e)})),Rg(this,"registerEventListeners",(()=>{this.relayer.core.heartbeat.on(C,(async()=>{await this.checkPending()})),this.events.on(up,(async e=>{const t=up;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})),this.events.on(dp,(async e=>{const t=dp;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}))})),this.relayer=e,this.logger=(0,ie.U5)(t,this.name),this.clientId=""}get context(){return(0,ie.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map((async n=>await this.unsubscribeById(e,n,t))))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const i=Su(n);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);const r=Bu("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,r),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(E){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(E),E}}async rpcSubscribe(e,t,n){var i;(!n||n?.transportType===op.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const r={method:_u(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});const s=null==(i=n?.internal)?void 0:i.throwOnFailedPublish;try{const t=await this.getSubscriptionId(e);if(n?.transportType===op.link_mode)return setTimeout((()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(r).catch((e=>this.logger.warn(e)))}),(0,b.toMiliseconds)(b.ONE_SECOND)),t;const i=new Promise((async t=>{const n=i=>{i.topic===e&&(this.events.removeListener(up,n),t(i.id))};this.events.on(up,n);try{const i=await Eo(new Promise(((e,t)=>{this.relayer.request(r).catch((e=>{this.logger.warn(e,e?.message),t(e)})).then(e)})),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(up,n),t(i)}catch{}})),a=await Eo(i,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!a&&s)throw new Error(`Subscribing to ${e} failed, please try again`);return a?t:null}catch(re){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(ep),s)throw re}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t={method:_u(e[0].relay.protocol).batchSubscribe,params:{topics:e.map((e=>e.topic))}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await Eo(new Promise((e=>{this.relayer.request(t).catch((e=>this.logger.warn(e))).then(e)})),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(ep)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t={method:_u(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map((e=>e.topic))}};let n;this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{n=await await Eo(new Promise(((e,n)=>{this.relayer.request(t).catch((e=>{this.logger.warn(e),n(e)})).then(e)})),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(ep)}return n}rpcUnsubscribe(e,t,n){const i={method:_u(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,Lg(Dg({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach((e=>{this.setSubscription(e.id,Dg({},e)),this.pending.delete(e.topic)}))}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Dg({},t)),this.topicMap.set(t.topic,e),this.events.emit(up,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:t}=ku("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(dp,Lg(Dg({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(pp)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit(fp)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:e}=ku("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map((async e=>Lg(Dg({},e),{id:await this.getSubscriptionId(e.topic)}))))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await function(e){return new Promise((t=>setTimeout(t,e)))}((0,b.toMiliseconds)(b.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=ku("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return fu(e+await this.getClientId())}}var Bg=Object.defineProperty,Ug=Object.getOwnPropertySymbols,zg=Object.prototype.hasOwnProperty,Fg=Object.prototype.propertyIsEnumerable,jg=(e,t,n)=>t in e?Bg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Vg=(e,t)=>{for(var n in t||(t={}))zg.call(t,n)&&jg(e,n,t[n]);if(Ug)for(var n of Ug(t))Fg.call(t,n)&&jg(e,n,t[n]);return e},Hg=(e,t,n)=>jg(e,"symbol"!=typeof t?t+"":t,n);class Wg extends de{constructor(e){super(e),Hg(this,"protocol","wc"),Hg(this,"version",2),Hg(this,"core"),Hg(this,"logger"),Hg(this,"events",new v.EventEmitter),Hg(this,"provider"),Hg(this,"messages"),Hg(this,"subscriber"),Hg(this,"publisher"),Hg(this,"name","relayer"),Hg(this,"transportExplicitlyClosed",!1),Hg(this,"initialized",!1),Hg(this,"connectionAttemptInProgress",!1),Hg(this,"relayUrl"),Hg(this,"projectId"),Hg(this,"packageName"),Hg(this,"bundleId"),Hg(this,"hasExperiencedNetworkDisruption",!1),Hg(this,"pingTimeout"),Hg(this,"heartBeatTimeout",(0,b.toMiliseconds)(b.THIRTY_SECONDS+b.FIVE_SECONDS)),Hg(this,"reconnectTimeout"),Hg(this,"connectPromise"),Hg(this,"reconnectInProgress",!1),Hg(this,"requestsInFlight",[]),Hg(this,"connectTimeout",(0,b.toMiliseconds)(15*b.ONE_SECOND)),Hg(this,"request",(async e=>{var t,n;this.logger.debug("Publishing Request Payload");const i=e.id||xd().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");const r=`${i}:${(null==(n=e.params)?void 0:n.tag)||""}`;this.requestsInFlight.push(r);const s=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter((e=>e!==r)),s}catch(r){throw this.logger.debug(`Failed to Publish Request: ${i}`),r}})),Hg(this,"resetPingTimeout",(()=>{lo()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout((()=>{var e,t,n,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(i=null==(n=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:n.terminate)||i.call(n)}catch(r){this.logger.warn(r,r?.message)}}),this.heartBeatTimeout))})),Hg(this,"onPayloadHandler",(e=>{this.onProviderPayload(e),this.resetPingTimeout()})),Hg(this,"onConnectHandler",(()=>{this.logger.warn({},"Relayer connected \ud83d\udedc"),this.startPingTimeout(),this.events.emit(Zd)})),Hg(this,"onDisconnectHandler",(()=>{this.logger.warn({},"Relayer disconnected \ud83d\uded1"),this.requestsInFlight=[],this.onProviderDisconnect()})),Hg(this,"onProviderErrorHandler",(e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit($d,e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()})),Hg(this,"registerProviderListeners",(()=>{this.provider.on(np,this.onPayloadHandler),this.provider.on(ip,this.onConnectHandler),this.provider.on(rp,this.onDisconnectHandler),this.provider.on(sp,this.onProviderErrorHandler)})),this.core=e.core,this.logger=typeof e.logger<"u"&&"string"!=typeof e.logger?(0,ie.U5)(e.logger,this.name):(0,ie.h6)((0,ie.iP)({level:e.logger||"error"})),this.messages=new ug(this.logger,e.core),this.subscriber=new kg(this,this.logger),this.publisher=new Eg(this,this.logger),this.relayUrl=e?.relayUrl||Yd,this.projectId=e.projectId,co()&&typeof n.g<"u"&&typeof(null==n.g?void 0:n.g.Platform)<"u"&&"android"===(null==n.g?void 0:n.g.Platform.OS)?this.packageName=po():co()&&typeof n.g<"u"&&typeof(null==n.g?void 0:n.g.Platform)<"u"&&"ios"===(null==n.g?void 0:n.g.Platform.OS)&&(this.bundleId=po()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return(0,ie.oI)(this.logger)}get connected(){var e,t,n;return 1===(null==(n=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:n.readyState)||!1}get connecting(){var e,t,n;return 0===(null==(n=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:n.readyState)||void 0!==this.connectPromise||!1}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:op.relay},cp)}async subscribe(e,t){var n,i,r;this.isInitialized(),(null==t||!t.transportType||"relay"===t?.transportType)&&await this.toEstablishConnection();const s=typeof(null==(n=t?.internal)?void 0:n.throwOnFailedPublish)>"u"||(null==(i=t?.internal)?void 0:i.throwOnFailedPublish);let a,o=(null==(r=this.subscriber.topicMap.get(e))?void 0:r[0])||"";const l=t=>{t.topic===e&&(this.subscriber.off(up,l),a())};return await Promise.all([new Promise((e=>{a=e,this.subscriber.on(up,l)})),new Promise((async(n,i)=>{o=await this.subscriber.subscribe(e,Vg({internal:{throwOnFailedPublish:s}},t)).catch((e=>{s&&i(e)}))||o,n()}))]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Eo(this.provider.disconnect(),2e3,"provider.disconnect()").catch((()=>this.onProviderDisconnect())):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(this.subscriber.hasAnyTopics){if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise((async(t,n)=>{await this.connect(e).then(t).catch(n).finally((()=>{this.connectPromise=void 0}))})),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}else this.logger.warn("Starting WS connection skipped because the client has no topics to work with.")}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await nd())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(0===e?.length)return void this.logger.trace("Batch message events is empty. Ignoring...");const t=e.sort(((e,t)=>e.publishedAt-t.publishedAt));this.logger.debug(`Batch of ${t.length} message events sorted`);for(const n of t)try{await this.onMessageEvent(n)}catch(E){this.logger.warn(E,"Error while processing batch message event: "+E?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:n}=e;if(!t.sessionExists){const e={topic:n,expiry:So(b.FIVE_MINUTES),relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,e)}this.events.emit(Qd,e),await this.recordMessageEvent(e,lp)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise((async(e,t)=>{const n=()=>{t(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(rp,n),await Eo(new Promise(((e,t)=>{this.provider.connect().then(e).catch(t)})),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch((e=>{t(e)})).finally((()=>{this.provider.off(rp,n),clearTimeout(this.reconnectTimeout)})),await new Promise((async(e,t)=>{const n=()=>{t(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(rp,n),await this.subscriber.start().then(e).catch(t).finally((()=>{this.provider.off(rp,n)}))})),this.hasExperiencedNetworkDisruption=!1,e()}))}catch(we){await this.subscriber.stop();const t=we;this.logger.warn({},t.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise((e=>setTimeout(e,(0,b.toMiliseconds)(1*t)))),t++}}startPingTimeout(){var e,t,n,i,r;if(lo())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(r=null==(i=null==(n=this.provider)?void 0:n.connection)?void 0:i.socket)||r.on("ping",(()=>{this.resetPingTimeout()}))),this.resetPingTimeout()}catch(s){this.logger.warn(s,s?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Bd(new Fd(vo({sdkVersion:ap,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:n,message:i}=e;await this.messages.set(n,i,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;if(!n||0===n.length)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const i=this.messages.has(t,n);return i&&this.logger.warn(`Ignoring duplicate message: ${n}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Dd(e)){if(!e.method.endsWith("_subscription"))return;const t=e.params,{topic:n,message:i,publishedAt:r,attestation:s}=t.data,a={topic:n,message:i,publishedAt:r,transportType:op.relay,attestation:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Vg({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Ld(e)&&this.events.emit(Xd,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,lp),this.events.emit(Qd,e))}async acknowledgePayload(e){const t=Cd(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(np,this.onPayloadHandler),this.provider.off(ip,this.onConnectHandler),this.provider.off(rp,this.onDisconnectHandler),this.provider.off(sp,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await nd();id((async t=>{e!==t&&(e=t,t?await this.transportOpen().catch((e=>this.logger.error(e,e?.message))):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}))}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Jd),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout((async()=>{await this.transportOpen().catch((e=>this.logger.error(e,e?.message))),this.reconnectTimeout=void 0,this.reconnectInProgress=!1}),(0,b.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){const{message:e}=ku("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.connect()}}function Gg(){}function qg(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function Kg(e){return Object.getOwnPropertySymbols(e).filter((t=>Object.prototype.propertyIsEnumerable.call(e,t)))}function Yg(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Qg="[object Arguments]",Xg="[object Object]";function Zg(e,t,n,i,r,s,a){const o=a(e,t,n,i,r,s);if(void 0!==o)return o;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return e===t;case"number":return e===t||Object.is(e,t);case"object":return Jg(e,t,s,a)}return Jg(e,t,s,a)}function Jg(e,t,n,i){if(Object.is(e,t))return!0;let r=Yg(e),s=Yg(t);if(r===Qg&&(r=Xg),s===Qg&&(s=Xg),r!==s)return!1;switch(r){case"[object String]":return e.toString()===t.toString();case"[object Number]":return function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}(e.valueOf(),t.valueOf());case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(e.valueOf(),t.valueOf());case"[object RegExp]":return e.source===t.source&&e.flags===t.flags;case"[object Function]":return e===t}const a=(n=n??new Map).get(e),o=n.get(t);if(null!=a&&null!=o)return a===t;n.set(e,t),n.set(t,e);try{switch(r){case"[object Map]":if(e.size!==t.size)return!1;for(const[r,s]of e.entries())if(!t.has(r)||!Zg(s,t.get(r),r,e,t,n,i))return!1;return!0;case"[object Set]":{if(e.size!==t.size)return!1;const r=Array.from(e.values()),s=Array.from(t.values());for(let a=0;a<r.length;a++){const o=r[a],l=s.findIndex((r=>Zg(o,r,void 0,e,t,n,i)));if(-1===l)return!1;s.splice(l,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if(typeof Buffer<"u"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!Zg(e[r],t[r],r,e,t,n,i))return!1;return!0;case"[object ArrayBuffer]":return e.byteLength===t.byteLength&&Jg(new Uint8Array(e),new Uint8Array(t),n,i);case"[object DataView]":return e.byteLength===t.byteLength&&e.byteOffset===t.byteOffset&&Jg(new Uint8Array(e),new Uint8Array(t),n,i);case"[object Error]":return e.name===t.name&&e.message===t.message;case Xg:{if(!(Jg(e.constructor,t.constructor,n,i)||qg(e)&&qg(t)))return!1;const r=[...Object.keys(e),...Kg(e)],s=[...Object.keys(t),...Kg(t)];if(r.length!==s.length)return!1;for(let a=0;a<r.length;a++){const s=r[a],o=e[s];if(!Object.hasOwn(t,s))return!1;if(!Zg(o,t[s],s,e,t,n,i))return!1}return!0}default:return!1}}finally{n.delete(e),n.delete(t)}}function $g(e,t){return function(e,t,n){return Zg(e,t,void 0,void 0,void 0,void 0,n)}(e,t,Gg)}var ev=Object.defineProperty,tv=Object.getOwnPropertySymbols,nv=Object.prototype.hasOwnProperty,iv=Object.prototype.propertyIsEnumerable,rv=(e,t,n)=>t in e?ev(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,sv=(e,t)=>{for(var n in t||(t={}))nv.call(t,n)&&rv(e,n,t[n]);if(tv)for(var n of tv(t))iv.call(t,n)&&rv(e,n,t[n]);return e},av=(e,t,n)=>rv(e,"symbol"!=typeof t?t+"":t,n);class ov extends pe{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Vd,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;super(e,t,n,i),this.core=e,this.logger=t,this.name=n,av(this,"map",new Map),av(this,"version","0.3"),av(this,"cached",[]),av(this,"initialized",!1),av(this,"getKey"),av(this,"storagePrefix",Vd),av(this,"recentlyDeleted",[]),av(this,"recentlyDeletedLimit",200),av(this,"init",(async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>{this.getKey&&null!==e&&!Fu(e)?this.map.set(this.getKey(e),e):function(e){var t;return null==(t=e?.proposer)?void 0:t.publicKey}(e)?this.map.set(e.id,e):function(e){return e?.topic}(e)&&this.map.set(e.topic,e)})),this.cached=[],this.initialized=!0)})),av(this,"set",(async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())})),av(this,"get",(e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e)))),av(this,"getAll",(e=>(this.isInitialized(),e?this.values.filter((t=>Object.keys(e).every((n=>$g(t[n],e[n]))))):this.values))),av(this,"update",(async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});const n=sv(sv({},this.getData(e)),t);this.map.set(e,n),await this.persist()})),av(this,"delete",(async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())})),this.logger=(0,ie.U5)(t,this.name),this.storagePrefix=i,this.getKey=r}get context(){return(0,ie.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:t}=ku("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}const{message:t}=ku("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:e}=ku("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ku("NOT_INITIALIZED",this.name);throw new Error(e)}}}var lv=Object.defineProperty,cv=(e,t,n)=>((e,t,n)=>t in e?lv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class hv{constructor(e,t){this.core=e,this.logger=t,cv(this,"name","pairing"),cv(this,"version","0.3"),cv(this,"events",new(y())),cv(this,"pairings"),cv(this,"initialized",!1),cv(this,"storagePrefix",Vd),cv(this,"ignoredPayloadTypes",[1]),cv(this,"registeredMethods",[]),cv(this,"init",(async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))})),cv(this,"register",(e=>{let{methods:t}=e;this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...t])]})),cv(this,"create",(async e=>{this.isInitialized();const t=du(),n=await this.core.crypto.setSymKey(t),i=So(b.FIVE_MINUTES),r={protocol:"irn"},s={topic:n,expiry:i,relay:r,active:!1,methods:e?.methods},a=Nu({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:t,relay:r,expiryTimestamp:i,methods:e?.methods});return this.events.emit(gp,s),this.core.expirer.set(n,i),await this.pairings.set(n,s),await this.core.relayer.subscribe(n,{transportType:e?.transportType}),{topic:n,uri:a}})),cv(this,"pair",(async e=>{this.isInitialized();const t=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:[Op]}});this.isValidPair(e,t);const{topic:n,symKey:i,relay:r,expiryTimestamp:s,methods:a}=Pu(e.uri);let o;if(t.props.properties.topic=n,t.addTrace(Dp),t.addTrace(Lp),this.pairings.keys.includes(n)){if(o=this.pairings.get(n),t.addTrace(Up),o.active)throw t.setError(Wp),new Error(`Pairing already exists: ${n}. Please try again with a new connection URI.`);t.addTrace(zp)}const l=s||So(b.FIVE_MINUTES),c={topic:n,relay:r,expiry:l,active:!1,methods:a};this.core.expirer.set(n,l),await this.pairings.set(n,c),t.addTrace(Rp),e.activatePairing&&await this.activate({topic:n}),this.events.emit(gp,c),t.addTrace(Fp),this.core.crypto.keychain.has(n)||await this.core.crypto.setSymKey(i,n),t.addTrace(kp);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{t.setError(Vp)}try{await this.core.relayer.subscribe(n,{relay:r})}catch(X){throw t.setError(Gp),X}return t.addTrace(Bp),c})),cv(this,"activate",(async e=>{let{topic:t}=e;this.isInitialized();const n=So(b.FIVE_MINUTES);this.core.expirer.set(t,n),await this.pairings.update(t,{active:!0,expiry:n})})),cv(this,"ping",(async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:t}=e;if(this.pairings.keys.includes(t)){const e=await this.sendRequest(t,"wc_pairingPing",{}),{done:n,resolve:i,reject:r}=xo();this.events.once(To("pairing_ping",e),(e=>{let{error:t}=e;t?r(t):i()})),await n()}})),cv(this,"updateExpiry",(async e=>{let{topic:t,expiry:n}=e;this.isInitialized(),await this.pairings.update(t,{expiry:n})})),cv(this,"updateMetadata",(async e=>{let{topic:t,metadata:n}=e;this.isInitialized(),await this.pairings.update(t,{peerMetadata:n})})),cv(this,"getPairings",(()=>(this.isInitialized(),this.pairings.values))),cv(this,"disconnect",(async e=>{this.isInitialized(),await this.isValidDisconnect(e);const{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",Bu("USER_DISCONNECTED")),await this.deletePairing(t))})),cv(this,"formatUriFromPairing",(e=>{this.isInitialized();const{topic:t,relay:n,expiry:i,methods:r}=e,s=this.core.crypto.keychain.get(t);return Nu({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:s,relay:n,expiryTimestamp:i,methods:r})})),cv(this,"sendRequest",(async(e,t,n)=>{const i=Ed(t,n),r=await this.core.crypto.encode(e,i),s=mp[t].req;return this.core.history.set(e,i),this.core.relayer.publish(e,r,s),i.id})),cv(this,"sendResult",(async(e,t,n)=>{const i=Cd(e,n),r=await this.core.crypto.encode(t,i),s=(await this.core.history.get(t,e)).request.method,a=mp[s].res;await this.core.relayer.publish(t,r,a),await this.core.history.resolve(i)})),cv(this,"sendError",(async(e,t,n)=>{const i=Ad(e,n),r=await this.core.crypto.encode(t,i),s=(await this.core.history.get(t,e)).request.method,a=mp[s]?mp[s].res:mp.unregistered_method.res;await this.core.relayer.publish(t,r,a),await this.core.history.resolve(i)})),cv(this,"deletePairing",(async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,Bu("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])})),cv(this,"cleanup",(async()=>{const e=this.pairings.getAll().filter((e=>_o(e.expiry)));await Promise.all(e.map((e=>this.deletePairing(e.topic))))})),cv(this,"onRelayEventRequest",(async e=>{const{topic:t,payload:n}=e;switch(n.method){case"wc_pairingPing":return await this.onPairingPingRequest(t,n);case"wc_pairingDelete":return await this.onPairingDeleteRequest(t,n);default:return await this.onUnknownRpcMethodRequest(t,n)}})),cv(this,"onRelayEventResponse",(async e=>{const{topic:t,payload:n}=e,i=(await this.core.history.get(t,n.id)).request.method;return"wc_pairingPing"===i?this.onPairingPingResponse(t,n):this.onUnknownRpcMethodResponse(i)})),cv(this,"onPairingPingRequest",(async(e,t)=>{const{id:n}=t;try{this.isValidPing({topic:e}),await this.sendResult(n,e,!0),this.events.emit(bp,{id:n,topic:e})}catch(i){await this.sendError(n,e,i),this.logger.error(i)}})),cv(this,"onPairingPingResponse",((e,t)=>{const{id:n}=t;setTimeout((()=>{Rd(t)?this.events.emit(To("pairing_ping",n),{}):kd(t)&&this.events.emit(To("pairing_ping",n),{error:t.error})}),500)})),cv(this,"onPairingDeleteRequest",(async(e,t)=>{const{id:n}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(yp,{id:n,topic:e})}catch(i){await this.sendError(n,e,i),this.logger.error(i)}})),cv(this,"onUnknownRpcMethodRequest",(async(e,t)=>{const{id:n,method:i}=t;try{if(this.registeredMethods.includes(i))return;const t=Bu("WC_METHOD_UNSUPPORTED",i);await this.sendError(n,e,t),this.logger.error(t)}catch(re){await this.sendError(n,e,re),this.logger.error(re)}})),cv(this,"onUnknownRpcMethodResponse",(e=>{this.registeredMethods.includes(e)||this.logger.error(Bu("WC_METHOD_UNSUPPORTED",e))})),cv(this,"isValidPair",((e,t)=>{var n;if(!Xu(e)){const{message:n}=ku("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(Hp),new Error(n)}if(!function(e){function t(e){try{return typeof new URL(e)<"u"}catch{return!1}}try{if(ju(e,!1))return!!t(e)||t(Do(e))}catch{}return!1}(e.uri)){const{message:n}=ku("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(Hp),new Error(n)}const i=Pu(e?.uri);if(null==(n=i?.relay)||!n.protocol){const{message:e}=ku("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(Hp),new Error(e)}if(null==i||!i.symKey){const{message:e}=ku("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(Hp),new Error(e)}if(null!=i&&i.expiryTimestamp&&(0,b.toMiliseconds)(i?.expiryTimestamp)<Date.now()){t.setError(qp);const{message:e}=ku("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(e)}})),cv(this,"isValidPing",(async e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)})),cv(this,"isValidDisconnect",(async e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)})),cv(this,"isValidPairingTopic",(async e=>{if(!ju(e,!1)){const{message:t}=ku("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.pairings.keys.includes(e)){const{message:t}=ku("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(_o(this.pairings.get(e).expiry)){await this.deletePairing(e);const{message:t}=ku("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}})),this.core=e,this.logger=(0,ie.U5)(t,this.name),this.pairings=new ov(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,ie.oI)(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ku("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Qd,(async e=>{const{topic:t,message:n,transportType:i}=e;if(this.pairings.keys.includes(t)&&i!==op.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const e=await this.core.crypto.decode(t,n);Dd(e)?(this.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e})):Ld(e)&&(await this.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e}),this.core.history.delete(t,e.id)),await this.core.relayer.messages.ack(t,n)}catch(x){this.logger.error(x)}}))}registerExpirerEvents(){this.core.expirer.on(_p,(async e=>{const{topic:t}=Ao(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(vp,{topic:t}))}))}}var uv=Object.defineProperty,dv=(e,t,n)=>((e,t,n)=>t in e?uv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class pv extends ce{constructor(e,t){super(e,t),this.core=e,this.logger=t,dv(this,"records",new Map),dv(this,"events",new v.EventEmitter),dv(this,"name","history"),dv(this,"version","0.3"),dv(this,"cached",[]),dv(this,"initialized",!1),dv(this,"storagePrefix",Vd),dv(this,"init",(async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>this.records.set(e.id,e))),this.cached=[],this.registerEventListeners(),this.initialized=!0)})),dv(this,"set",((e,t,n)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:n}),this.records.has(t.id))return;const i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:n,expiry:So(b.THIRTY_DAYS)};this.records.set(i.id,i),this.persist(),this.events.emit(wp,i)})),dv(this,"resolve",(async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;const t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=kd(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(xp,t))})),dv(this,"get",(async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t)))),dv(this,"delete",((e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach((n=>{if(n.topic===e){if(typeof t<"u"&&n.id!==t)return;this.records.delete(n.id),this.events.emit(Ep,n)}})),this.persist()})),dv(this,"exists",(async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e))),dv(this,"on",((e,t)=>{this.events.on(e,t)})),dv(this,"once",((e,t)=>{this.events.once(e,t)})),dv(this,"off",((e,t)=>{this.events.off(e,t)})),dv(this,"removeListener",((e,t)=>{this.events.removeListener(e,t)})),this.logger=(0,ie.U5)(t,this.name)}get context(){return(0,ie.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach((t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:Ed(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)})),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:t}=ku("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Cp)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:e}=ku("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(wp,(e=>{const t=wp;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})})),this.events.on(xp,(e=>{const t=xp;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})})),this.events.on(Ep,(e=>{const t=Ep;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})})),this.core.heartbeat.on(C,(()=>{this.cleanup()}))}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach((t=>{(0,b.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(Ep,t,!1),e=!0)})),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ku("NOT_INITIALIZED",this.name);throw new Error(e)}}}var fv=Object.defineProperty,mv=(e,t,n)=>((e,t,n)=>t in e?fv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class gv extends me{constructor(e,t){super(e,t),this.core=e,this.logger=t,mv(this,"expirations",new Map),mv(this,"events",new v.EventEmitter),mv(this,"name","expirer"),mv(this,"version","0.3"),mv(this,"cached",[]),mv(this,"initialized",!1),mv(this,"storagePrefix",Vd),mv(this,"init",(async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((e=>this.expirations.set(e.target,e))),this.cached=[],this.registerEventListeners(),this.initialized=!0)})),mv(this,"has",(e=>{try{const t=this.formatTarget(e);return typeof this.getExpiration(t)<"u"}catch{return!1}})),mv(this,"set",((e,t)=>{this.isInitialized();const n=this.formatTarget(e),i={target:n,expiry:t};this.expirations.set(n,i),this.checkExpiry(n,i),this.events.emit(Ap,{target:n,expiration:i})})),mv(this,"get",(e=>{this.isInitialized();const t=this.formatTarget(e);return this.getExpiration(t)})),mv(this,"del",(e=>{if(this.isInitialized(),this.has(e)){const t=this.formatTarget(e),n=this.getExpiration(t);this.expirations.delete(t),this.events.emit(Sp,{target:t,expiration:n})}})),mv(this,"on",((e,t)=>{this.events.on(e,t)})),mv(this,"once",((e,t)=>{this.events.once(e,t)})),mv(this,"off",((e,t)=>{this.events.off(e,t)})),mv(this,"removeListener",((e,t)=>{this.events.removeListener(e,t)})),this.logger=(0,ie.U5)(t,this.name)}get context(){return(0,ie.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return function(e){return Co("topic",e)}(e);if("number"==typeof e)return function(e){return Co("id",e)}(e);const{message:t}=ku("UNKNOWN_TYPE","Target type: "+typeof e);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Tp)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:e}=ku("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:t}=ku("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),new Error(t)}return t}checkExpiry(e,t){const{expiry:n}=t;(0,b.toMiliseconds)(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(_p,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach(((e,t)=>this.checkExpiry(t,e)))}registerEventListeners(){this.core.heartbeat.on(C,(()=>this.checkExpirations())),this.events.on(Ap,(e=>{const t=Ap;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})),this.events.on(_p,(e=>{const t=_p;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})),this.events.on(Sp,(e=>{const t=Sp;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}))}isInitialized(){if(!this.initialized){const{message:e}=ku("NOT_INITIALIZED",this.name);throw new Error(e)}}}var vv=Object.defineProperty,yv=(e,t,n)=>((e,t,n)=>t in e?vv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class bv extends ge{constructor(e,t,n){super(e,t,n),this.core=e,this.logger=t,this.store=n,yv(this,"name","verify-api"),yv(this,"abortController"),yv(this,"isDevEnv"),yv(this,"verifyUrlV3",Np),yv(this,"storagePrefix",Vd),yv(this,"version",2),yv(this,"publicKey"),yv(this,"fetchPromise"),yv(this,"init",(async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,b.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))})),yv(this,"register",(async e=>{if(!ho()||this.isDevEnv)return;const t=window.location.origin,{id:n,decryptedId:i}=e,r=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${n}&decryptedId=${i}`;try{const e=(0,cr.getDocument)(),t=this.startAbortTimer(5*b.ONE_SECOND),i=await new Promise(((i,s)=>{const a=()=>{window.removeEventListener("message",l),e.body.removeChild(o),s("attestation aborted")};this.abortController.signal.addEventListener("abort",a);const o=e.createElement("iframe");o.src=r,o.style.display="none",o.addEventListener("error",a,{signal:this.abortController.signal});const l=r=>{if(r.data&&"string"==typeof r.data)try{const s=JSON.parse(r.data);if("verify_attestation"===s.type){if(Yi(s.attestation).payload.id!==n)return;clearInterval(t),e.body.removeChild(o),this.abortController.signal.removeEventListener("abort",a),window.removeEventListener("message",l),i(null===s.attestation?"":s.attestation)}}catch(s){this.logger.warn(s)}};e.body.appendChild(o),window.addEventListener("message",l,{signal:this.abortController.signal})}));return this.logger.debug("jwt attestation",i),i}catch(ne){this.logger.warn(ne)}return""})),yv(this,"resolve",(async e=>{if(this.isDevEnv)return"";const{attestationId:t,hash:n,encryptedId:i}=e;if(""===t)return void this.logger.debug("resolve: attestationId is empty, skipping");if(t){if(Yi(t).payload.id!==i)return;const e=await this.isValidJwtAttestation(t);if(e)return e.isVerified?e:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!n)return;const r=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(n,r)})),yv(this,"fetchAttestation",(async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);const n=this.startAbortTimer(5*b.ONE_SECOND),i=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(n),200===i.status?await i.json():void 0})),yv(this,"getVerifyUrl",(e=>{let t=e||Mp;return Ip.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${Mp}`),t=Mp),t})),yv(this,"fetchPublicKey",(async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const e=this.startAbortTimer(b.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(E){this.logger.warn(E)}})),yv(this,"persistPublicKey",(async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e})),yv(this,"removePublicKey",(async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0})),yv(this,"isValidJwtAttestation",(async e=>{const t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(re){this.logger.error(re),this.logger.warn("error validating attestation")}const n=await this.fetchAndPersistPublicKey();try{if(n)return this.validateAttestation(e,n)}catch(re){this.logger.error(re),this.logger.warn("error validating attestation")}})),yv(this,"getPublicKey",(async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey())),yv(this,"fetchAndPersistPublicKey",(async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise((async e=>{const t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))}));const e=await this.fetchPromise;return this.fetchPromise=void 0,e})),yv(this,"validateAttestation",((e,t)=>{const n=Au(e,t.publicKey),i={hasExpired:(0,b.toMiliseconds)(n.exp)<Date.now(),payload:n};if(i.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:i.payload.origin,isScam:i.payload.isScam,isVerified:i.payload.isVerified}})),this.logger=(0,ie.U5)(t,this.name),this.abortController=new AbortController,this.isDevEnv=Oo(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return(0,ie.oI)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout((()=>this.abortController.abort()),(0,b.toMiliseconds)(e))}}var wv=Object.defineProperty,xv=(e,t,n)=>((e,t,n)=>t in e?wv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class Ev extends ve{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,xv(this,"context","echo"),xv(this,"registerDeviceToken",(async e=>{const{clientId:t,token:n,notificationType:i,enableEncrypted:r=!1}=e,s=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:i,token:n,always_raw:r})})})),this.logger=(0,ie.U5)(t,this.context)}}var Cv=Object.defineProperty,Av=Object.getOwnPropertySymbols,Sv=Object.prototype.hasOwnProperty,_v=Object.prototype.propertyIsEnumerable,Tv=(e,t,n)=>t in e?Cv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pv=(e,t)=>{for(var n in t||(t={}))Sv.call(t,n)&&Tv(e,n,t[n]);if(Av)for(var n of Av(t))_v.call(t,n)&&Tv(e,n,t[n]);return e},Mv=(e,t,n)=>Tv(e,"symbol"!=typeof t?t+"":t,n);class Nv extends ye{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,t,n),this.core=e,this.logger=t,Mv(this,"context","event-client"),Mv(this,"storagePrefix",Vd),Mv(this,"storageVersion",.1),Mv(this,"events",new Map),Mv(this,"shouldPersist",!1),Mv(this,"init",(async()=>{if(!Oo())try{const e={eventId:Io(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:go(this.core.relayer.protocol,this.core.relayer.version,ap)}}};await this.sendEvent([e])}catch(E){this.logger.warn(E)}})),Mv(this,"createEvent",(e=>{const{event:t="ERROR",type:n="",properties:{topic:i,trace:r}}=e,s=Io(),a=this.core.projectId||"",o=Date.now(),l=Pv({eventId:s,timestamp:o,props:{event:t,type:n,properties:{topic:i,trace:r}},bundleId:a,domain:this.getAppDomain()},this.setMethods(s));return this.telemetryEnabled&&(this.events.set(s,l),this.shouldPersist=!0),l})),Mv(this,"getEvent",(e=>{const{eventId:t,topic:n}=e;if(t)return this.events.get(t);const i=Array.from(this.events.values()).find((e=>e.props.properties.topic===n));return i?Pv(Pv({},i),this.setMethods(i.eventId)):void 0})),Mv(this,"deleteEvent",(e=>{const{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0})),Mv(this,"setEventListeners",(()=>{this.core.heartbeat.on(C,(async()=>{this.shouldPersist&&await this.persist(),this.events.forEach((e=>{(0,b.fromMiliseconds)(Date.now())-(0,b.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)}))}))})),Mv(this,"setMethods",(e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)}))),Mv(this,"addTrace",((e,t)=>{const n=this.events.get(e);n&&(n.props.properties.trace.push(t),this.events.set(e,n),this.shouldPersist=!0)})),Mv(this,"setError",((e,t)=>{const n=this.events.get(e);n&&(n.props.type=t,n.timestamp=Date.now(),this.events.set(e,n),this.shouldPersist=!0)})),Mv(this,"persist",(async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1})),Mv(this,"restore",(async()=>{try{const e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach((e=>{this.events.set(e.eventId,Pv(Pv({},e),this.setMethods(e.eventId)))}))}catch(E){this.logger.warn(E)}})),Mv(this,"submit",(async()=>{if(!this.telemetryEnabled||0===this.events.size)return;const e=[];for(const[t,n]of this.events)n.props.type&&e.push(n);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(const t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(x){this.logger.warn(x)}})),Mv(this,"sendEvent",(async e=>{const t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${ap}${t}`,{method:"POST",body:JSON.stringify(e)})})),Mv(this,"getAppDomain",(()=>mo().url)),this.logger=(0,ie.U5)(t,this.context),this.telemetryEnabled=n,n?this.restore().then((async()=>{await this.submit(),this.setEventListeners()})):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var Iv=Object.defineProperty,Ov=Object.getOwnPropertySymbols,Dv=Object.prototype.hasOwnProperty,Lv=Object.prototype.propertyIsEnumerable,Rv=(e,t,n)=>t in e?Iv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,kv=(e,t)=>{for(var n in t||(t={}))Dv.call(t,n)&&Rv(e,n,t[n]);if(Ov)for(var n of Ov(t))Lv.call(t,n)&&Rv(e,n,t[n]);return e},Bv=(e,t,n)=>Rv(e,"symbol"!=typeof t?t+"":t,n);class Uv extends ae{constructor(e){var t;super(e),Bv(this,"protocol","wc"),Bv(this,"version",2),Bv(this,"name",jd),Bv(this,"relayUrl"),Bv(this,"projectId"),Bv(this,"customStoragePrefix"),Bv(this,"events",new v.EventEmitter),Bv(this,"logger"),Bv(this,"heartbeat"),Bv(this,"relayer"),Bv(this,"crypto"),Bv(this,"storage"),Bv(this,"history"),Bv(this,"expirer"),Bv(this,"pairing"),Bv(this,"verify"),Bv(this,"echoClient"),Bv(this,"linkModeSupportedApps"),Bv(this,"eventClient"),Bv(this,"initialized",!1),Bv(this,"logChunkController"),Bv(this,"on",((e,t)=>this.events.on(e,t))),Bv(this,"once",((e,t)=>this.events.once(e,t))),Bv(this,"off",((e,t)=>this.events.off(e,t))),Bv(this,"removeListener",((e,t)=>this.events.removeListener(e,t))),Bv(this,"dispatchEnvelope",(e=>{let{topic:t,message:n,sessionExists:i}=e;if(!t||!n)return;const r={topic:t,message:n,publishedAt:Date.now(),transportType:op.link_mode};this.relayer.onLinkMessageEvent(r,{sessionExists:i})}));const n=this.getGlobalCore(e?.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(re){console.warn("Failed to copy global core",re)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Yd,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=(0,ie.iP)({level:"string"==typeof e?.logger&&e.logger?e.logger:Hd,name:jd}),{logger:r,chunkLoggerController:s}=(0,ie.D5)({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=s,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,ie.U5)(r,this.name),this.heartbeat=new A,this.crypto=new ng(this,this.logger,e?.keychain),this.history=new pv(this,this.logger),this.expirer=new gv(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new ne(kv(kv({},Wd),e?.storageOptions)),this.relayer=new Wg({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new hv(this,this.logger),this.verify=new bv(this,this.logger,this.storage),this.echoClient=new Ev(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Nv(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new Uv(e);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",n),t}get context(){return(0,ie.oI)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(hp,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(hp)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,n=`${t}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[t]}catch(vc){return void console.warn("Failed to get global WalletConnect core",vc)}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${(null==(t=e.opts)?void 0:t.customStoragePrefix)||""}`;globalThis[n]=e}catch(we){console.warn("Failed to set global WalletConnect core",we)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&"true"==={NODE_ENV:"production",PUBLIC_URL:"/build",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PROJECT_ID:"bb8edcd28daf7c13ce0a49cafab2782d"}.DISABLE_GLOBAL_CORE}catch{return!0}}}const zv=Uv,Fv="client",jv=`wc@2:${Fv}:`,Vv=Fv,Hv="error",Wv="WALLETCONNECT_DEEPLINK_CHOICE",Gv="Proposal expired",qv=b.SEVEN_DAYS,Kv={wc_sessionPropose:{req:{ttl:b.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:b.ONE_DAY,prompt:!1,tag:1104},res:{ttl:b.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:b.ONE_DAY,prompt:!1,tag:1106},res:{ttl:b.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:b.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:b.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:b.ONE_DAY,prompt:!1,tag:1112},res:{ttl:b.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:b.ONE_DAY,prompt:!1,tag:1114},res:{ttl:b.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:b.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:b.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1119}}},Yv={min:b.FIVE_MINUTES,max:b.SEVEN_DAYS},Qv="IDLE",Xv="ACTIVE",Zv={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},Jv=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],$v="wc@1.5:auth:",ey=`${$v}:PUB_KEY`;var ty=Object.defineProperty,ny=Object.defineProperties,iy=Object.getOwnPropertyDescriptors,ry=Object.getOwnPropertySymbols,sy=Object.prototype.hasOwnProperty,ay=Object.prototype.propertyIsEnumerable,oy=(e,t,n)=>t in e?ty(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ly=(e,t)=>{for(var n in t||(t={}))sy.call(t,n)&&oy(e,n,t[n]);if(ry)for(var n of ry(t))ay.call(t,n)&&oy(e,n,t[n]);return e},cy=(e,t)=>ny(e,iy(t)),hy=(e,t,n)=>oy(e,"symbol"!=typeof t?t+"":t,n);class uy extends Ee{constructor(e){var t;super(e),t=this,hy(this,"name","engine"),hy(this,"events",new(y())),hy(this,"initialized",!1),hy(this,"requestQueue",{state:Qv,queue:[]}),hy(this,"sessionRequestQueue",{state:Qv,queue:[]}),hy(this,"requestQueueDelay",b.ONE_SECOND),hy(this,"expectedPairingMethodMap",new Map),hy(this,"recentlyDeletedMap",new Map),hy(this,"recentlyDeletedLimit",200),hy(this,"relayMessageCache",[]),hy(this,"pendingSessions",new Map),hy(this,"init",(async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Kv)}),this.initialized=!0,setTimeout((async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()}),(0,b.toMiliseconds)(this.requestQueueDelay)))})),hy(this,"connect",(async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const t=cy(ly({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t);const{pairingTopic:n,requiredNamespaces:i,optionalNamespaces:r,sessionProperties:s,scopedProperties:a,relays:o}=t;let l,c=n,h=!1;try{if(c){const e=this.client.core.pairing.pairings.get(c);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=e.active}}catch(be){throw this.client.logger.error(`connect() -> pairing.get(${c}) failed`),be}if(!c||!h){const{topic:e,uri:t}=await this.client.core.pairing.create();c=e,l=t}if(!c){const{message:e}=ku("NO_MATCHING_KEY",`connect() pairing topic: ${c}`);throw new Error(e)}const u=await this.client.core.crypto.generateKeyPair(),d=Kv.wc_sessionPropose.req.ttl||b.FIVE_MINUTES,p=So(d),f=cy(ly(ly({requiredNamespaces:i,optionalNamespaces:r,relays:o??[{protocol:"irn"}],proposer:{publicKey:u,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:c},s&&{sessionProperties:s}),a&&{scopedProperties:a}),{id:wd()}),m=To("session_connect",f.id),{reject:g,resolve:v,done:y}=xo(d,Gv),w=e=>{let{id:t}=e;t===f.id&&(this.client.events.off("proposal_expire",w),this.pendingSessions.delete(f.id),this.events.emit(m,{error:{message:Gv,code:0}}))};return this.client.events.on("proposal_expire",w),this.events.once(m,(e=>{let{error:t,session:n}=e;this.client.events.off("proposal_expire",w),t?g(t):n&&v(n)})),await this.sendRequest({topic:c,method:"wc_sessionPropose",params:f,throwOnFailedPublish:!0,clientRpcId:f.id}),await this.setProposal(f.id,f),{uri:l,approval:y}})),hy(this,"pair",(async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(vc){throw this.client.logger.error("pair() failed"),vc}})),hy(this,"approve",(async e=>{var t,n,i;const r=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[Yp]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(C){throw r.setError(rf),C}try{await this.isValidProposalId(e?.id)}catch(C){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),r.setError(hf),C}try{await this.isValidApprove(e)}catch(C){throw this.client.logger.error("approve() -> isValidApprove() failed"),r.setError(cf),C}const{id:s,relayProtocol:a,namespaces:o,sessionProperties:l,scopedProperties:c,sessionConfig:h}=e,u=this.client.proposal.get(s);this.client.core.eventClient.deleteEvent({eventId:r.eventId});const{pairingTopic:d,proposer:p,requiredNamespaces:f,optionalNamespaces:m}=u;let g=null==(n=this.client.core.eventClient)?void 0:n.getEvent({topic:d});g||(g=null==(i=this.client.core.eventClient)?void 0:i.createEvent({type:Yp,properties:{topic:d,trace:[Yp,Qp]}}));const v=await this.client.core.crypto.generateKeyPair(),y=p.publicKey,b=await this.client.core.crypto.generateSharedKey(v,y),w=ly(ly(ly({relay:{protocol:a??"irn"},namespaces:o,controller:{publicKey:v,metadata:this.client.metadata},expiry:So(qv)},l&&{sessionProperties:l}),c&&{scopedProperties:c}),h&&{sessionConfig:h}),x=op.relay;g.addTrace(Xp);try{await this.client.core.relayer.subscribe(b,{transportType:x})}catch(C){throw g.setError(af),C}g.addTrace(Zp);const E=cy(ly({},w),{topic:b,requiredNamespaces:f,optionalNamespaces:m,pairingTopic:d,acknowledged:!1,self:w.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:v,transportType:op.relay});await this.client.session.set(b,E),g.addTrace(ef);try{g.addTrace(tf),await this.sendRequest({topic:b,method:"wc_sessionSettle",params:w,throwOnFailedPublish:!0}).catch((e=>{throw g?.setError(lf),e})),g.addTrace(nf),g.addTrace(Jp),await this.sendResult({id:s,topic:d,result:{relay:{protocol:a??"irn"},responderPublicKey:v},throwOnFailedPublish:!0}).catch((e=>{throw g?.setError(of),e})),g.addTrace($p)}catch(C){throw this.client.logger.error(C),this.client.session.delete(b,Bu("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(b),C}return this.client.core.eventClient.deleteEvent({eventId:g.eventId}),await this.client.core.pairing.updateMetadata({topic:d,metadata:p.metadata}),await this.client.proposal.delete(s,Bu("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:d}),await this.setExpiry(b,So(qv)),{topic:b,acknowledged:()=>Promise.resolve(this.client.session.get(b))}})),hy(this,"reject",(async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(r){throw this.client.logger.error("reject() -> isValidReject() failed"),r}const{id:t,reason:n}=e;let i;try{i=this.client.proposal.get(t).pairingTopic}catch(r){throw this.client.logger.error(`reject() -> proposal.get(${t}) failed`),r}i&&(await this.sendError({id:t,topic:i,error:n,rpcOpts:Kv.wc_sessionPropose.reject}),await this.client.proposal.delete(t,Bu("USER_DISCONNECTED")))})),hy(this,"update",(async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(ne){throw this.client.logger.error("update() -> isValidUpdate() failed"),ne}const{topic:t,namespaces:n}=e,{done:i,resolve:r,reject:s}=xo(),a=wd(),o=xd().toString(),l=this.client.session.get(t).namespaces;return this.events.once(To("session_update",a),(e=>{let{error:t}=e;t?s(t):r()})),await this.client.session.update(t,{namespaces:n}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:n},throwOnFailedPublish:!0,clientRpcId:a,relayRpcId:o}).catch((e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:l}),s(e)})),{acknowledged:i}})),hy(this,"extend",(async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(re){throw this.client.logger.error("extend() -> isValidExtend() failed"),re}const{topic:t}=e,n=wd(),{done:i,resolve:r,reject:s}=xo();return this.events.once(To("session_extend",n),(e=>{let{error:t}=e;t?s(t):r()})),await this.setExpiry(t,So(qv)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:n,throwOnFailedPublish:!0}).catch((e=>{s(e)})),{acknowledged:i}})),hy(this,"request",(async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(X){throw this.client.logger.error("request() -> isValidRequest() failed"),X}const{chainId:t,request:n,topic:i,expiry:r=Kv.wc_sessionRequest.req.ttl}=e,s=this.client.session.get(i);s?.transportType===op.relay&&await this.confirmOnlineStateOrThrow();const a=wd(),o=xd().toString(),{done:l,resolve:c,reject:h}=xo(r,"Request expired. Please try again.");this.events.once(To("session_request",a),(e=>{let{error:t,result:n}=e;t?h(t):c(n)}));const u="wc_sessionRequest",d=this.getAppLinkIfEnabled(s.peer.metadata,s.transportType);if(d)return await this.sendRequest({clientRpcId:a,relayRpcId:o,topic:i,method:u,params:{request:cy(ly({},n),{expiryTimestamp:So(r)}),chainId:t},expiry:r,throwOnFailedPublish:!0,appLink:d}).catch((e=>h(e))),this.client.events.emit("session_request_sent",{topic:i,request:n,chainId:t,id:a}),await l();const p={request:cy(ly({},n),{expiryTimestamp:So(r)}),chainId:t},f=this.shouldSetTVF(u,p);return await Promise.all([new Promise((async e=>{await this.sendRequest(ly({clientRpcId:a,relayRpcId:o,topic:i,method:u,params:p,expiry:r,throwOnFailedPublish:!0},f&&{tvf:this.getTVFParams(a,p)})).catch((e=>h(e))),this.client.events.emit("session_request_sent",{topic:i,request:n,chainId:t,id:a}),e()})),new Promise((async e=>{var t;if(null==(t=s.sessionConfig)||!t.disableDeepLink){const e=await async function(e,t){let n="";try{if(ho()&&(n=localStorage.getItem(t),n))return n;n=await e.getItem(t)}catch(r){console.error(r)}return n}(this.client.core.storage,Wv);await Mo({id:a,topic:i,wcDeepLink:e})}e()})),l()]).then((e=>e[2]))})),hy(this,"respond",(async e=>{this.isInitialized(),await this.isValidRespond(e);const{topic:t,response:n}=e,{id:i}=n,r=this.client.session.get(t);r.transportType===op.relay&&await this.confirmOnlineStateOrThrow();const s=this.getAppLinkIfEnabled(r.peer.metadata,r.transportType);Rd(n)?await this.sendResult({id:i,topic:t,result:n.result,throwOnFailedPublish:!0,appLink:s}):kd(n)&&await this.sendError({id:i,topic:t,error:n.error,appLink:s}),this.cleanupAfterResponse(e)})),hy(this,"ping",(async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(E){throw this.client.logger.error("ping() -> isValidPing() failed"),E}const{topic:t}=e;if(this.client.session.keys.includes(t)){const e=wd(),n=xd().toString(),{done:i,resolve:r,reject:s}=xo();this.events.once(To("session_ping",e),(e=>{let{error:t}=e;t?s(t):r()})),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:n}),i()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))})),hy(this,"emit",(async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);const{topic:t,event:n,chainId:i}=e,r=xd().toString(),s=wd();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:n,chainId:i},throwOnFailedPublish:!0,relayRpcId:r,clientRpcId:s})})),hy(this,"disconnect",(async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);const{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:Bu("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else{if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=ku("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw new Error(e)}await this.client.core.pairing.disconnect({topic:t})}})),hy(this,"find",(e=>(this.isInitialized(),this.client.session.getAll().filter((t=>function(e,t){const{requiredNamespaces:n}=t,i=Object.keys(e.namespaces),r=Object.keys(n);let s=!0;return!!yo(r,i)&&(i.forEach((t=>{const{accounts:i,methods:r,events:a}=e.namespaces[t],o=Ou(i),l=n[t];(!yo(Ya(t,l),o)||!yo(l.methods,r)||!yo(l.events,a))&&(s=!1)})),s)}(t,e)))))),hy(this,"getPendingSessionRequests",(()=>this.client.pendingRequest.getAll())),hy(this,"authenticate",(async(e,t)=>{var n;this.isInitialized(),this.isValidAuthenticate(e);const i=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(n=this.client.metadata.redirect)?void 0:n.linkMode),r=i?op.link_mode:op.relay;r===op.relay&&await this.confirmOnlineStateOrThrow();const{chains:s,statement:a="",uri:o,domain:l,nonce:c,type:h,exp:u,nbf:d,methods:p=[],expiry:f}=e,m=[...e.resources||[]],{topic:g,uri:v}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:r});this.client.logger.info({message:"Generated new pairing",pairing:{topic:g,uri:v}});const y=await this.client.core.crypto.generateKeyPair(),b=pu(y);if(await Promise.all([this.client.auth.authKeys.set(ey,{responseTopic:b,publicKey:y}),this.client.auth.pairingTopics.set(b,{topic:b,pairingTopic:g})]),await this.client.core.relayer.subscribe(b,{transportType:r}),this.client.logger.info(`sending request to new pairing topic: ${g}`),p.length>0){const{namespace:e}=Ka(s[0]);let t=Rl(e,"request",p);jl(m)&&(t=Bl(t,m.pop())),m.push(t)}const w=f&&f>Kv.wc_sessionAuthenticate.req.ttl?f:Kv.wc_sessionAuthenticate.req.ttl,x={authPayload:{type:h??"caip122",chains:s,statement:a,aud:o,domain:l,version:"1",nonce:c,iat:(new Date).toISOString(),exp:u,nbf:d,resources:m},requester:{publicKey:y,metadata:this.client.metadata},expiryTimestamp:So(w)},E={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:s,methods:[...new Set(["personal_sign",...p])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:g,proposer:{publicKey:y,metadata:this.client.metadata},expiryTimestamp:So(Kv.wc_sessionPropose.req.ttl),id:wd()},{done:C,resolve:A,reject:S}=xo(w,"Request expired"),_=wd(),T=To("session_connect",E.id),P=To("session_request",_),M=async e=>{let{error:t,session:n}=e;this.events.off(P,N),t?S(t):n&&A({session:n})},N=async e=>{var n,i,s;if(await this.deletePendingAuthRequest(_,{message:"fulfilled",code:0}),e.error){const t=Bu("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(T,M),S(e.error.message))}await this.deleteProposal(E.id),this.events.off(T,M);const{cacaos:a,responder:o}=e.result,l=[],c=[];for(const t of a){await Ml({cacao:t,projectId:this.client.core.projectId})||(this.client.logger.error(t,"Signature verification failed"),S(Bu("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:e}=t,n=jl(e.resources),i=[Tl(e.iss)],r=Pl(e.iss);if(n){const e=zl(n),t=Fl(n);l.push(...e),i.push(...t)}for(const t of i)c.push(`${t}:${r}`)}const h=await this.client.core.crypto.generateSharedKey(y,o.publicKey);let u;l.length>0&&(u={topic:h,acknowledged:!0,self:{publicKey:y,metadata:this.client.metadata},peer:o,controller:o.publicKey,expiry:So(qv),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:g,namespaces:Du([...new Set(l)],[...new Set(c)]),transportType:r},await this.client.core.relayer.subscribe(h,{transportType:r}),await this.client.session.set(h,u),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:o.metadata}),u=this.client.session.get(h)),null!=(n=this.client.metadata.redirect)&&n.linkMode&&null!=(i=o.metadata.redirect)&&i.linkMode&&null!=(s=o.metadata.redirect)&&s.universal&&t&&(this.client.core.addLinkModeSupportedApp(o.metadata.redirect.universal),this.client.session.update(h,{transportType:op.link_mode})),A({auths:a,session:u})};let I;this.events.once(T,M),this.events.once(P,N);try{if(i){const e=Ed("wc_sessionAuthenticate",x,_);this.client.core.history.set(g,e);const n=await this.client.core.crypto.encode("",e,{type:2,encoding:hu});I=Iu(t,g,n)}else await Promise.all([this.sendRequest({topic:g,method:"wc_sessionAuthenticate",params:x,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:_}),this.sendRequest({topic:g,method:"wc_sessionPropose",params:E,expiry:Kv.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:E.id})])}catch(O){throw this.events.off(T,M),this.events.off(P,N),O}return await this.setProposal(E.id,E),await this.setAuthRequest(_,{request:cy(ly({},x),{verifyContext:{}}),pairingTopic:g,transportType:r}),{uri:I??v,response:C}})),hy(this,"approveSessionAuthenticate",(async e=>{const{id:t,auths:n}=e,i=this.client.core.eventClient.createEvent({properties:{topic:t.toString(),trace:[uf]}});try{this.isInitialized()}catch(pe){throw i.setError(yf),pe}const r=this.getPendingAuthRequest(t);if(!r)throw i.setError(Ef),new Error(`Could not find pending auth request with id ${t}`);const s=r.transportType||op.relay;s===op.relay&&await this.confirmOnlineStateOrThrow();const a=r.requester.publicKey,o=await this.client.core.crypto.generateKeyPair(),l=pu(a),c={type:1,receiverPublicKey:a,senderPublicKey:o},h=[],u=[];for(const f of n){if(!await Ml({cacao:f,projectId:this.client.core.projectId})){i.setError(bf);const e=Bu("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:t,topic:l,error:e,encodeOpts:c}),new Error(e.message)}i.addTrace(pf);const{p:e}=f,n=jl(e.resources),r=[Tl(e.iss)],s=Pl(e.iss);if(n){const e=zl(n),t=Fl(n);h.push(...e),r.push(...t)}for(const t of r)u.push(`${t}:${s}`)}const d=await this.client.core.crypto.generateSharedKey(o,a);let p;if(i.addTrace(df),h?.length>0){p={topic:d,acknowledged:!0,self:{publicKey:o,metadata:this.client.metadata},peer:{publicKey:a,metadata:r.requester.metadata},controller:a,expiry:So(qv),authentication:n,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:r.pairingTopic,namespaces:Du([...new Set(h)],[...new Set(u)]),transportType:s},i.addTrace(mf);try{await this.client.core.relayer.subscribe(d,{transportType:s})}catch(pe){throw i.setError(wf),pe}i.addTrace(gf),await this.client.session.set(d,p),i.addTrace(ff),await this.client.core.pairing.updateMetadata({topic:r.pairingTopic,metadata:r.requester.metadata})}i.addTrace(vf);try{await this.sendResult({topic:l,id:t,result:{cacaos:n,responder:{publicKey:o,metadata:this.client.metadata}},encodeOpts:c,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(r.requester.metadata,s)})}catch(pe){throw i.setError(xf),pe}return await this.client.auth.requests.delete(t,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:r.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:p}})),hy(this,"rejectSessionAuthenticate",(async e=>{this.isInitialized();const{id:t,reason:n}=e,i=this.getPendingAuthRequest(t);if(!i)throw new Error(`Could not find pending auth request with id ${t}`);i.transportType===op.relay&&await this.confirmOnlineStateOrThrow();const r=i.requester.publicKey,s=await this.client.core.crypto.generateKeyPair(),a=pu(r),o={type:1,receiverPublicKey:r,senderPublicKey:s};await this.sendError({id:t,topic:a,error:n,encodeOpts:o,rpcOpts:Kv.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.client.proposal.delete(t,Bu("USER_DISCONNECTED"))})),hy(this,"formatAuthMessage",(e=>{this.isInitialized();const{request:t,iss:n}=e;return Nl(t,n)})),hy(this,"processRelayMessageCache",(()=>{setTimeout((async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{const e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}}),50)})),hy(this,"cleanupDuplicatePairings",(async e=>{if(e.pairingTopic)try{const t=this.client.core.pairing.pairings.get(e.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter((n=>{var i,r;return(null==(i=n.peerMetadata)?void 0:i.url)&&(null==(r=n.peerMetadata)?void 0:r.url)===e.peer.metadata.url&&n.topic&&n.topic!==t.topic}));if(0===n.length)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map((e=>this.client.core.pairing.disconnect({topic:e.topic})))),this.client.logger.info("Duplicate pairings clean up finished")}catch(vc){this.client.logger.error(vc)}})),hy(this,"deleteSession",(async e=>{var t;const{topic:n,expirerHasDeleted:i=!1,emitEvent:r=!0,id:s=0}=e,{self:a}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),await this.client.session.delete(n,Bu("USER_DISCONNECTED")),this.addToRecentlyDeleted(n,"session"),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),i||this.client.core.expirer.del(n),this.client.core.storage.removeItem(Wv).catch((e=>this.client.logger.warn(e))),this.getPendingSessionRequests().forEach((e=>{e.topic===n&&this.deletePendingSessionRequest(e.id,Bu("USER_DISCONNECTED"))})),n===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=Qv),r&&this.client.events.emit("session_delete",{id:s,topic:n})})),hy(this,"deleteProposal",(async(e,t)=>{if(t)try{const t=this.client.proposal.get(e),n=this.client.core.eventClient.getEvent({topic:t.pairingTopic});n?.setError(sf)}catch{}await Promise.all([this.client.proposal.delete(e,Bu("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")})),hy(this,"deletePendingSessionRequest",(async function(e,n){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];await Promise.all([t.client.pendingRequest.delete(e,n),i?Promise.resolve():t.client.core.expirer.del(e)]),t.addToRecentlyDeleted(e,"request"),t.sessionRequestQueue.queue=t.sessionRequestQueue.queue.filter((t=>t.id!==e)),i&&(t.sessionRequestQueue.state=Qv,t.client.events.emit("session_request_expire",{id:e}))})),hy(this,"deletePendingAuthRequest",(async function(e,n){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];await Promise.all([t.client.auth.requests.delete(e,n),i?Promise.resolve():t.client.core.expirer.del(e)])})),hy(this,"setExpiry",(async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))})),hy(this,"setProposal",(async(e,t)=>{this.client.core.expirer.set(e,So(Kv.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)})),hy(this,"setAuthRequest",(async(e,t)=>{const{request:n,pairingTopic:i,transportType:r=op.relay}=t;this.client.core.expirer.set(e,n.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:n.authPayload,requester:n.requester,expiryTimestamp:n.expiryTimestamp,id:e,pairingTopic:i,verifyContext:n.verifyContext,transportType:r})})),hy(this,"setPendingSessionRequest",(async e=>{const{id:t,topic:n,params:i,verifyContext:r}=e,s=i.request.expiryTimestamp||So(Kv.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,s),await this.client.pendingRequest.set(t,{id:t,topic:n,params:i,verifyContext:r})})),hy(this,"sendRequest",(async e=>{const{topic:t,method:i,params:r,expiry:s,relayRpcId:a,clientRpcId:o,throwOnFailedPublish:l,appLink:c,tvf:h}=e,u=Ed(i,r,o);let d;const p=!!c;try{const e=p?hu:cu;d=await this.client.core.crypto.encode(t,u,{encoding:e})}catch(X){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${t} failed`),X}let f;if(Jv.includes(i)){const e=fu(JSON.stringify(u)),t=fu(d);f=await this.client.core.verify.register({id:t,decryptedId:e})}const m=Kv[i].req;if(m.attestation=f,s&&(m.ttl=s),a&&(m.id=a),this.client.core.history.set(t,u),p){const e=Iu(c,t,d);await n.g.Linking.openURL(e,this.client.name)}else{const e=Kv[i].req;s&&(e.ttl=s),a&&(e.id=a),e.tvf=cy(ly({},h),{correlationId:u.id}),l?(e.internal=cy(ly({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(t,d,e)):this.client.core.relayer.publish(t,d,e).catch((e=>this.client.logger.error(e)))}return u.id})),hy(this,"sendResult",(async e=>{const{id:t,topic:i,result:r,throwOnFailedPublish:s,encodeOpts:a,appLink:o}=e,l=Cd(t,r);let c;const h=o&&typeof(null==n.g?void 0:n.g.Linking)<"u";try{const e=h?hu:cu;c=await this.client.core.crypto.encode(i,l,cy(ly({},a||{}),{encoding:e}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${i} failed`),p}let u,d;try{u=await this.client.core.history.get(i,t);const e=u.request;try{this.shouldSetTVF(e.method,e.params)&&(d=this.getTVFParams(t,e.params,r))}catch(ue){this.client.logger.warn("sendResult() -> getTVFParams() failed",ue)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${i}, ${t}) failed`),p}if(h){const e=Iu(o,i,c);await n.g.Linking.openURL(e,this.client.name)}else{const e=u.request.method,n=Kv[e].res;n.tvf=cy(ly({},d),{correlationId:t}),s?(n.internal=cy(ly({},n.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,c,n)):this.client.core.relayer.publish(i,c,n).catch((e=>this.client.logger.error(e)))}await this.client.core.history.resolve(l)})),hy(this,"sendError",(async e=>{const{id:t,topic:i,error:r,encodeOpts:s,rpcOpts:a,appLink:o}=e,l=Ad(t,r);let c;const h=o&&typeof(null==n.g?void 0:n.g.Linking)<"u";try{const e=h?hu:cu;c=await this.client.core.crypto.encode(i,l,cy(ly({},s||{}),{encoding:e}))}catch(de){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${i} failed`),de}let u;try{u=await this.client.core.history.get(i,t)}catch(de){throw this.client.logger.error(`sendError() -> history.get(${i}, ${t}) failed`),de}if(h){const e=Iu(o,i,c);await n.g.Linking.openURL(e,this.client.name)}else{const e=u.request.method,t=a||Kv[e].res;this.client.core.relayer.publish(i,c,t)}await this.client.core.history.resolve(l)})),hy(this,"cleanup",(async()=>{const e=[],t=[];this.client.session.getAll().forEach((t=>{let n=!1;_o(t.expiry)&&(n=!0),this.client.core.crypto.keychain.has(t.topic)||(n=!0),n&&e.push(t.topic)})),this.client.proposal.getAll().forEach((e=>{_o(e.expiryTimestamp)&&t.push(e.id)})),await Promise.all([...e.map((e=>this.deleteSession({topic:e}))),...t.map((e=>this.deleteProposal(e)))])})),hy(this,"onProviderMessageEvent",(async e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):await this.onRelayMessage(e)})),hy(this,"onRelayEventRequest",(async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()})),hy(this,"processRequestsQueue",(async()=>{if(this.requestQueue.state!==Xv){for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Xv;const e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(vc){this.client.logger.warn(vc)}}this.requestQueue.state=Qv}else this.client.logger.info("Request queue already active, skipping...")})),hy(this,"processRequest",(async e=>{const{topic:t,payload:n,attestation:i,transportType:r,encryptedId:s}=e,a=n.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:a}))switch(a){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:n,attestation:i,encryptedId:s});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,n);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,n);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,n);case"wc_sessionPing":return await this.onSessionPingRequest(t,n);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,n);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:n,attestation:i,encryptedId:s,transportType:r});case"wc_sessionEvent":return await this.onSessionEventRequest(t,n);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:n,attestation:i,encryptedId:s,transportType:r});default:return this.client.logger.info(`Unsupported request method ${a}`)}})),hy(this,"onRelayEventResponse",(async e=>{const{topic:t,payload:n,transportType:i}=e,r=(await this.client.core.history.get(t,n.id)).request.method;switch(r){case"wc_sessionPropose":return this.onSessionProposeResponse(t,n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(t,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,n);case"wc_sessionExtend":return this.onSessionExtendResponse(t,n);case"wc_sessionPing":return this.onSessionPingResponse(t,n);case"wc_sessionRequest":return this.onSessionRequestResponse(t,n);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,n);default:return this.client.logger.info(`Unsupported response method ${r}`)}})),hy(this,"onRelayEventUnknownPayload",(e=>{const{topic:t}=e,{message:n}=ku("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)})),hy(this,"shouldIgnorePairingRequest",(e=>{const{topic:t,requestMethod:n}=e,i=this.expectedPairingMethodMap.get(t);return!(!i||i.includes(n))&&!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)})),hy(this,"onSessionProposeRequest",(async e=>{const{topic:t,payload:n,attestation:i,encryptedId:r}=e,{params:s,id:a}=n;try{const e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError(Kp)),this.isValidConnect(ly({},n.params));const o=s.expiryTimestamp||So(Kv.wc_sessionPropose.req.ttl),l=ly({id:a,pairingTopic:t,expiryTimestamp:o},s);await this.setProposal(a,l);const c=await this.getVerifyContext({attestationId:i,hash:fu(JSON.stringify(n)),encryptedId:r,metadata:l.proposer.metadata});e?.addTrace(jp),this.client.events.emit("session_proposal",{id:a,params:l,verifyContext:c})}catch(Z){await this.sendError({id:a,topic:t,error:Z,rpcOpts:Kv.wc_sessionPropose.autoReject}),this.client.logger.error(Z)}})),hy(this,"onSessionProposeResponse",(async(e,t,n)=>{const{id:i}=t;if(Rd(t)){const{result:r}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:r});const s=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:s});const a=s.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});const o=r.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:o});const l=await this.client.core.crypto.generateSharedKey(a,o);this.pendingSessions.set(i,{sessionTopic:l,pairingTopic:e,proposalId:i,publicKey:a});const c=await this.client.core.relayer.subscribe(l,{transportType:n});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:c}),await this.client.core.pairing.activate({topic:e})}else if(kd(t)){await this.client.proposal.delete(i,Bu("USER_DISCONNECTED"));const e=To("session_connect",i);if(0===this.events.listenerCount(e))throw new Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}})),hy(this,"onSessionSettleRequest",(async(e,t)=>{const{id:n,params:i}=t;try{this.isValidSessionSettleRequest(i);const{relay:n,controller:r,expiry:s,namespaces:a,sessionProperties:o,scopedProperties:l,sessionConfig:c}=t.params,h=[...this.pendingSessions.values()].find((t=>t.sessionTopic===e));if(!h)return this.client.logger.error(`Pending session not found for topic ${e}`);const u=this.client.proposal.get(h.proposalId),d=cy(ly(ly(ly({topic:e,relay:n,expiry:s,namespaces:a,acknowledged:!0,pairingTopic:h.pairingTopic,requiredNamespaces:u.requiredNamespaces,optionalNamespaces:u.optionalNamespaces,controller:r.publicKey,self:{publicKey:h.publicKey,metadata:this.client.metadata},peer:{publicKey:r.publicKey,metadata:r.metadata}},o&&{sessionProperties:o}),l&&{scopedProperties:l}),c&&{sessionConfig:c}),{transportType:op.relay});await this.client.session.set(d.topic,d),await this.setExpiry(d.topic,d.expiry),await this.client.core.pairing.updateMetadata({topic:h.pairingTopic,metadata:d.peer.metadata}),this.client.events.emit("session_connect",{session:d}),this.events.emit(To("session_connect",h.proposalId),{session:d}),this.pendingSessions.delete(h.proposalId),this.deleteProposal(h.proposalId,!1),this.cleanupDuplicatePairings(d),await this.sendResult({id:t.id,topic:e,result:!0,throwOnFailedPublish:!0})}catch(r){await this.sendError({id:n,topic:e,error:r}),this.client.logger.error(r)}})),hy(this,"onSessionSettleResponse",(async(e,t)=>{const{id:n}=t;Rd(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(To("session_approve",n),{})):kd(t)&&(await this.client.session.delete(e,Bu("USER_DISCONNECTED")),this.events.emit(To("session_approve",n),{error:t.error}))})),hy(this,"onSessionUpdateRequest",(async(e,t)=>{const{params:n,id:i}=t;try{const t=`${e}_session_update`,r=sd.get(t);if(r&&this.isRequestOutOfSync(r,i))return this.client.logger.warn(`Discarding out of sync request - ${i}`),void this.sendError({id:i,topic:e,error:Bu("INVALID_UPDATE_REQUEST")});this.isValidUpdate(ly({topic:e},n));try{sd.set(t,i),await this.client.session.update(e,{namespaces:n.namespaces}),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0})}catch(re){throw sd.delete(t),re}this.client.events.emit("session_update",{id:i,topic:e,params:n})}catch(r){await this.sendError({id:i,topic:e,error:r}),this.client.logger.error(r)}})),hy(this,"isRequestOutOfSync",((e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3))),hy(this,"onSessionUpdateResponse",((e,t)=>{const{id:n}=t,i=To("session_update",n);if(0===this.events.listenerCount(i))throw new Error(`emitting ${i} without any listeners`);Rd(t)?this.events.emit(To("session_update",n),{}):kd(t)&&this.events.emit(To("session_update",n),{error:t.error})})),hy(this,"onSessionExtendRequest",(async(e,t)=>{const{id:n}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,So(qv)),await this.sendResult({id:n,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:n,topic:e})}catch(we){await this.sendError({id:n,topic:e,error:we}),this.client.logger.error(we)}})),hy(this,"onSessionExtendResponse",((e,t)=>{const{id:n}=t,i=To("session_extend",n);if(0===this.events.listenerCount(i))throw new Error(`emitting ${i} without any listeners`);Rd(t)?this.events.emit(To("session_extend",n),{}):kd(t)&&this.events.emit(To("session_extend",n),{error:t.error})})),hy(this,"onSessionPingRequest",(async(e,t)=>{const{id:n}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:n,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:n,topic:e})}catch(we){await this.sendError({id:n,topic:e,error:we}),this.client.logger.error(we)}})),hy(this,"onSessionPingResponse",((e,t)=>{const{id:n}=t,i=To("session_ping",n);setTimeout((()=>{if(0===this.events.listenerCount(i))throw new Error(`emitting ${i} without any listeners 2176`);Rd(t)?this.events.emit(To("session_ping",n),{}):kd(t)&&this.events.emit(To("session_ping",n),{error:t.error})}),500)})),hy(this,"onSessionDeleteRequest",(async(e,t)=>{const{id:n}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),Promise.all([new Promise((t=>{this.client.core.relayer.once(tp,(async()=>{t(await this.deleteSession({topic:e,id:n}))}))})),this.sendResult({id:n,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:Bu("USER_DISCONNECTED")})]).catch((e=>this.client.logger.error(e)))}catch(we){this.client.logger.error(we)}})),hy(this,"onSessionRequest",(async e=>{var t,n,i;const{topic:r,payload:s,attestation:a,encryptedId:o,transportType:l}=e,{id:c,params:h}=s;try{await this.isValidRequest(ly({topic:r},h));const e=this.client.session.get(r),s={id:c,topic:r,params:h,verifyContext:await this.getVerifyContext({attestationId:a,hash:fu(JSON.stringify(Ed("wc_sessionRequest",h,c))),encryptedId:o,metadata:e.peer.metadata,transportType:l})};await this.setPendingSessionRequest(s),l===op.link_mode&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(n=e.peer.metadata.redirect)?void 0:n.universal),null!=(i=this.client.signConfig)&&i.disableRequestQueue?this.emitSessionRequest(s):(this.addSessionRequestToSessionRequestQueue(s),this.processSessionRequestQueue())}catch(de){await this.sendError({id:c,topic:r,error:de}),this.client.logger.error(de)}})),hy(this,"onSessionRequestResponse",((e,t)=>{const{id:n}=t,i=To("session_request",n);if(0===this.events.listenerCount(i))throw new Error(`emitting ${i} without any listeners`);Rd(t)?this.events.emit(To("session_request",n),{result:t.result}):kd(t)&&this.events.emit(To("session_request",n),{error:t.error})})),hy(this,"onSessionEventRequest",(async(e,t)=>{const{id:n,params:i}=t;try{const t=`${e}_session_event_${i.event.name}`,r=sd.get(t);if(r&&this.isRequestOutOfSync(r,n))return void this.client.logger.info(`Discarding out of sync request - ${n}`);this.isValidEmit(ly({topic:e},i)),this.client.events.emit("session_event",{id:n,topic:e,params:i}),sd.set(t,n)}catch(r){await this.sendError({id:n,topic:e,error:r}),this.client.logger.error(r)}})),hy(this,"onSessionAuthenticateResponse",((e,t)=>{const{id:n}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),Rd(t)?this.events.emit(To("session_request",n),{result:t.result}):kd(t)&&this.events.emit(To("session_request",n),{error:t.error})})),hy(this,"onSessionAuthenticateRequest",(async e=>{var t;const{topic:n,payload:i,attestation:r,encryptedId:s,transportType:a}=e;try{const{requester:e,authPayload:o,expiryTimestamp:l}=i.params,c=await this.getVerifyContext({attestationId:r,hash:fu(JSON.stringify(i)),encryptedId:s,metadata:e.metadata,transportType:a}),h={requester:e,pairingTopic:n,id:i.id,authPayload:o,verifyContext:c,expiryTimestamp:l};await this.setAuthRequest(i.id,{request:h,pairingTopic:n,transportType:a}),a===op.link_mode&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:n,params:i.params,id:i.id,verifyContext:c})}catch(Z){this.client.logger.error(Z);const t=i.params.requester.publicKey,r=await this.client.core.crypto.generateKeyPair(),s=this.getAppLinkIfEnabled(i.params.requester.metadata,a),o={type:1,receiverPublicKey:t,senderPublicKey:r};await this.sendError({id:i.id,topic:n,error:Z,encodeOpts:o,rpcOpts:Kv.wc_sessionAuthenticate.autoReject,appLink:s})}})),hy(this,"addSessionRequestToSessionRequestQueue",(e=>{this.sessionRequestQueue.queue.push(e)})),hy(this,"cleanupAfterResponse",(e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout((()=>{this.sessionRequestQueue.state=Qv,this.processSessionRequestQueue()}),(0,b.toMiliseconds)(this.requestQueueDelay))})),hy(this,"cleanupPendingSentRequestsForTopic",(e=>{let{topic:t,error:n}=e;const i=this.client.core.history.pending;i.length>0&&i.filter((e=>e.topic===t&&"wc_sessionRequest"===e.request.method)).forEach((e=>{const t=To("session_request",e.request.id);if(0===this.events.listenerCount(t))throw new Error(`emitting ${t} without any listeners`);this.events.emit(To("session_request",e.request.id),{error:n})}))})),hy(this,"processSessionRequestQueue",(()=>{if(this.sessionRequestQueue.state===Xv)return void this.client.logger.info("session request queue is already active.");const e=this.sessionRequestQueue.queue[0];if(e)try{this.sessionRequestQueue.state=Xv,this.emitSessionRequest(e)}catch(vc){this.client.logger.error(vc)}else this.client.logger.info("session request queue is empty.")})),hy(this,"emitSessionRequest",(e=>{this.client.events.emit("session_request",e)})),hy(this,"onPairingCreated",(e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;const t=this.client.proposal.getAll().find((t=>t.pairingTopic===e.topic));t&&this.onSessionProposeRequest({topic:e.topic,payload:Ed("wc_sessionPropose",cy(ly({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id)})})),hy(this,"isValidConnect",(async e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(t)}const{pairingTopic:t,requiredNamespaces:n,optionalNamespaces:i,sessionProperties:r,scopedProperties:s,relays:a}=e;if(Fu(t)||await this.isValidPairingTopic(t),!function(e,t){let n=!1;return t&&!e?n=!0:e&&Uu(e)&&e.length&&e.forEach((e=>{n=Qu(e)})),n}(a,!0)){const{message:e}=ku("MISSING_OR_INVALID",`connect() relays: ${a}`);throw new Error(e)}if(!Fu(n)&&0!==zu(n)&&this.validateNamespaces(n,"requiredNamespaces"),!Fu(i)&&0!==zu(i)&&this.validateNamespaces(i,"optionalNamespaces"),Fu(r)||this.validateSessionProps(r,"sessionProperties"),!Fu(s)){this.validateSessionProps(s,"scopedProperties");const e=Object.keys(n||{}).concat(Object.keys(i||{}));if(!Object.keys(s).every((t=>e.includes(t))))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(s)}, required/optional namespaces: ${JSON.stringify(e)}`)}})),hy(this,"validateNamespaces",((e,t)=>{const n=function(e,t,n){let i=null;if(e&&zu(e)){const r=Ku(e,t);r&&(i=r);const s=Gu(e,t,n);s&&(i=s)}else i=ku("MISSING_OR_INVALID",`${t}, ${n} should be an object with data`);return i}(e,"connect()",t);if(n)throw new Error(n.message)})),hy(this,"isValidApprove",(async e=>{if(!Xu(e))throw new Error(ku("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:t,namespaces:n,relayProtocol:i,sessionProperties:r,scopedProperties:s}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);const a=this.client.proposal.get(t),o=Yu(n,"approve()");if(o)throw new Error(o.message);const l=ed(a.requiredNamespaces,n,"approve()");if(l)throw new Error(l.message);if(!ju(i,!0)){const{message:e}=ku("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(e)}if(Fu(r)||this.validateSessionProps(r,"sessionProperties"),!Fu(s)){this.validateSessionProps(s,"scopedProperties");const e=new Set(Object.keys(n));if(!Object.keys(s).every((t=>e.has(t))))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(s)}, approved namespaces: ${Array.from(e).join(", ")}`)}})),hy(this,"isValidReject",(async e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(t)}const{id:t,reason:n}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!function(e){return!(!e||"object"!=typeof e||!e.code||!Vu(e.code,!1)||!e.message||!ju(e.message,!1))}(n)){const{message:e}=ku("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(e)}})),hy(this,"isValidSessionSettleRequest",(e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(t)}const{relay:t,controller:n,namespaces:i,expiry:r}=e;if(!Qu(t)){const{message:e}=ku("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(e)}const s=function(e,t){let n=null;return ju(e?.publicKey,!1)||(n=ku("MISSING_OR_INVALID",`${t} controller public key should be a string`)),n}(n,"onSessionSettleRequest()");if(s)throw new Error(s.message);const a=Yu(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);if(_o(r)){const{message:e}=ku("EXPIRED","onSessionSettleRequest()");throw new Error(e)}})),hy(this,"isValidUpdate",(async e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(t)}const{topic:t,namespaces:n}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);const i=this.client.session.get(t),r=Yu(n,"update()");if(r)throw new Error(r.message);const s=ed(i.requiredNamespaces,n,"update()");if(s)throw new Error(s.message)})),hy(this,"isValidExtend",(async e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(t)}const{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)})),hy(this,"isValidRequest",(async e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(t)}const{topic:t,request:n,chainId:i,expiry:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);const{namespaces:s}=this.client.session.get(t);if(!Zu(s,i)){const{message:e}=ku("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(e)}if(!function(e){return!(Fu(e)||!ju(e.method,!1))}(n)){const{message:e}=ku("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(e)}if(!Ju(s,i,n.method)){const{message:e}=ku("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(e)}if(r&&!function(e,t){return Vu(e,!1)&&e<=t.max&&e>=t.min}(r,Yv)){const{message:e}=ku("MISSING_OR_INVALID",`request() expiry: ${r}. Expiry must be a number (in seconds) between ${Yv.min} and ${Yv.max}`);throw new Error(e)}})),hy(this,"isValidRespond",(async e=>{var t;if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(t)}const{topic:n,response:i}=e;try{await this.isValidSessionTopic(n)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(!function(e){return!(Fu(e)||Fu(e.result)&&Fu(e.error)||!Vu(e.id,!1)||!ju(e.jsonrpc,!1))}(i)){const{message:e}=ku("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(e)}})),hy(this,"isValidPing",(async e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)})),hy(this,"isValidEmit",(async e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(t)}const{topic:t,event:n,chainId:i}=e;await this.isValidSessionTopic(t);const{namespaces:r}=this.client.session.get(t);if(!Zu(r,i)){const{message:e}=ku("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(e)}if(!function(e){return!(Fu(e)||!ju(e.name,!1))}(n)){const{message:e}=ku("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(e)}if(!$u(r,i,n.name)){const{message:e}=ku("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(e)}})),hy(this,"isValidDisconnect",(async e=>{if(!Xu(e)){const{message:t}=ku("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)})),hy(this,"isValidAuthenticate",(e=>{const{chains:t,uri:n,domain:i,nonce:r}=e;if(!Array.isArray(t)||0===t.length)throw new Error("chains is required and must be a non-empty array");if(!ju(n,!1))throw new Error("uri is required parameter");if(!ju(i,!1))throw new Error("domain is required parameter");if(!ju(r,!1))throw new Error("nonce is required parameter");if([...new Set(t.map((e=>Ka(e).namespace)))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:s}=Ka(t[0]);if("eip155"!==s)throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")})),hy(this,"getVerifyContext",(async e=>{const{attestationId:t,hash:n,encryptedId:i,metadata:r,transportType:s}=e,a={verified:{verifyUrl:r.verifyUrl||Mp,validation:"UNKNOWN",origin:r.url||""}};try{if(s===op.link_mode){const e=this.getAppLinkIfEnabled(r,s);return a.verified.validation=e&&new URL(e).origin===new URL(r.url).origin?"VALID":"INVALID",a}const e=await this.client.core.verify.resolve({attestationId:t,hash:n,encryptedId:i,verifyUrl:r.verifyUrl});e&&(a.verified.origin=e.origin,a.verified.isScam=e.isScam,a.verified.validation=e.origin===new URL(r.url).origin?"VALID":"INVALID")}catch(Z){this.client.logger.warn(Z)}return this.client.logger.debug(`Verify context: ${JSON.stringify(a)}`),a})),hy(this,"validateSessionProps",((e,t)=>{Object.values(e).forEach(((n,i)=>{if(null==n){const{message:r}=ku("MISSING_OR_INVALID",`${t} must contain an existing value for each key. Received: ${n} for key ${Object.keys(e)[i]}`);throw new Error(r)}}))})),hy(this,"getPendingAuthRequest",(e=>{const t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0})),hy(this,"addToRecentlyDeleted",((e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0;const t=this.recentlyDeletedLimit/2;for(const n of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(n)}}})),hy(this,"checkRecentlyDeleted",(e=>{const t=this.recentlyDeletedMap.get(e);if(t){const{message:n}=ku("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw new Error(n)}})),hy(this,"isLinkModeEnabled",((e,t)=>{var i,r,s,a,o,l,c,h,u;return!(!e||t!==op.link_mode)&&(!0===(null==(r=null==(i=this.client.metadata)?void 0:i.redirect)?void 0:r.linkMode)&&void 0!==(null==(a=null==(s=this.client.metadata)?void 0:s.redirect)?void 0:a.universal)&&""!==(null==(l=null==(o=this.client.metadata)?void 0:o.redirect)?void 0:l.universal)&&void 0!==(null==(c=e?.redirect)?void 0:c.universal)&&""!==(null==(h=e?.redirect)?void 0:h.universal)&&!0===(null==(u=e?.redirect)?void 0:u.linkMode)&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&typeof(null==n.g?void 0:n.g.Linking)<"u")})),hy(this,"getAppLinkIfEnabled",((e,t)=>{var n;return this.isLinkModeEnabled(e,t)?null==(n=e?.redirect)?void 0:n.universal:void 0})),hy(this,"handleLinkModeMessage",(e=>{let{url:t}=e;if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const n=No(t,"topic")||"",i=decodeURIComponent(No(t,"wc_ev")||""),r=this.client.session.keys.includes(n);r&&this.client.session.update(n,{transportType:op.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:i,sessionExists:r})})),hy(this,"registerLinkModeListeners",(async()=>{var e;if(Oo()||co()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){const e=null==n.g?void 0:n.g.Linking;if(typeof e<"u"){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);const t=await e.getInitialURL();t&&setTimeout((()=>{this.handleLinkModeMessage({url:t})}),50)}}})),hy(this,"shouldSetTVF",((e,t)=>{if(!t||"wc_sessionRequest"!==e)return!1;const{request:n}=t;return Object.keys(Zv).includes(n.method)})),hy(this,"getTVFParams",((e,t,n)=>{var i,r;try{const s=t.request.method,a=this.extractTxHashesFromResult(s,n);return cy(ly({correlationId:e,rpcMethods:[s],chainId:t.chainId},this.isValidContractData(t.request.params)&&{contractAddresses:[null==(r=null==(i=t.request.params)?void 0:i[0])?void 0:r.to]}),{txHashes:a})}catch(s){this.client.logger.warn("Error getting TVF params",s)}return{}})),hy(this,"isValidContractData",(e=>{var t;if(!e)return!1;try{const n=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!n.startsWith("0x"))return!1;const i=n.slice(2);return!!/^[0-9a-fA-F]*$/.test(i)&&i.length%2===0}catch{}return!1})),hy(this,"extractTxHashesFromResult",((e,t)=>{try{if("string"==typeof t)return[t];const n=t[Zv[e].key];if(Uu(n))return"solana_signAllTransactions"===e?n.map((e=>function(e){const t=atob(e),n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);const i=n[0];if(0===i)throw new Error("No signatures found");const r=1+64*i;if(n.length<r)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const s=Buffer.from(e,"base64").slice(1,65);return ps.A.encode(s)}(e))):n;if("string"==typeof n)return[n]}catch(E){this.client.logger.warn("Error extracting tx hashes from result",E)}return[]}))}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,i]of Object.entries(t))for(const e of i)try{await this.onProviderMessageEvent({topic:n,message:e,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${e}`)}}catch(x){this.client.logger.warn("processPendingMessageEvents failed",x)}}isInitialized(){if(!this.initialized){const{message:e}=ku("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Qd,(e=>{this.onProviderMessageEvent(e)}))}async onRelayMessage(e){const{topic:t,message:n,attestation:i,transportType:r}=e,{publicKey:s}=this.client.auth.authKeys.keys.includes(ey)?this.client.auth.authKeys.get(ey):{responseTopic:void 0,publicKey:void 0};try{const e=await this.client.core.crypto.decode(t,n,{receiverPublicKey:s,encoding:r===op.link_mode?hu:cu});Dd(e)?(this.client.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e,attestation:i,transportType:r,encryptedId:fu(n)})):Ld(e)?(await this.client.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e,transportType:r}),this.client.core.history.delete(t,e.id)):await this.onRelayEventUnknownPayload({topic:t,payload:e,transportType:r}),await this.client.core.relayer.messages.ack(t,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(_p,(async e=>{const{topic:t,id:n}=Ao(e.target);return n&&this.client.pendingRequest.keys.includes(n)?await this.deletePendingSessionRequest(n,ku("EXPIRED"),!0):n&&this.client.auth.requests.keys.includes(n)?await this.deletePendingAuthRequest(n,ku("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n})))}))}registerPairingEvents(){this.client.core.pairing.events.on(gp,(e=>this.onPairingCreated(e))),this.client.core.pairing.events.on(yp,(e=>{this.addToRecentlyDeleted(e.topic,"pairing")}))}isValidPairingTopic(e){if(!ju(e,!1)){const{message:t}=ku("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ku("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(_o(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ku("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!ju(e,!1)){const{message:t}=ku("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=ku("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(_o(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=ku("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=ku("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else{if(!this.client.core.pairing.pairings.keys.includes(e)){if(ju(e,!1)){const{message:t}=ku("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}{const{message:t}=ku("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}this.isValidPairingTopic(e)}}async isValidProposalId(e){if(!function(e){return"number"==typeof e}(e)){const{message:t}=ku("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ku("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(_o(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=ku("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class dy extends ov{constructor(e,t){super(e,t,"proposal",jv),this.core=e,this.logger=t}}class py extends ov{constructor(e,t){super(e,t,"session",jv),this.core=e,this.logger=t}}class fy extends ov{constructor(e,t){super(e,t,"request",jv,(e=>e.id)),this.core=e,this.logger=t}}class my extends ov{constructor(e,t){super(e,t,"authKeys",$v,(()=>ey)),this.core=e,this.logger=t}}class gy extends ov{constructor(e,t){super(e,t,"pairingTopics",$v),this.core=e,this.logger=t}}class vy extends ov{constructor(e,t){super(e,t,"requests",$v,(e=>e.id)),this.core=e,this.logger=t}}var yy=Object.defineProperty,by=(e,t,n)=>((e,t,n)=>t in e?yy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class wy{constructor(e,t){this.core=e,this.logger=t,by(this,"authKeys"),by(this,"pairingTopics"),by(this,"requests"),this.authKeys=new my(this.core,this.logger),this.pairingTopics=new gy(this.core,this.logger),this.requests=new vy(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var xy=Object.defineProperty,Ey=(e,t,n)=>((e,t,n)=>t in e?xy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class Cy extends xe{constructor(e){super(e),Ey(this,"protocol","wc"),Ey(this,"version",2),Ey(this,"name",Vv),Ey(this,"metadata"),Ey(this,"core"),Ey(this,"logger"),Ey(this,"events",new v.EventEmitter),Ey(this,"engine"),Ey(this,"session"),Ey(this,"proposal"),Ey(this,"pendingRequest"),Ey(this,"auth"),Ey(this,"signConfig"),Ey(this,"on",((e,t)=>this.events.on(e,t))),Ey(this,"once",((e,t)=>this.events.once(e,t))),Ey(this,"off",((e,t)=>this.events.off(e,t))),Ey(this,"removeListener",((e,t)=>this.events.removeListener(e,t))),Ey(this,"removeAllListeners",(e=>this.events.removeAllListeners(e))),Ey(this,"connect",(async e=>{try{return await this.engine.connect(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"pair",(async e=>{try{return await this.engine.pair(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"approve",(async e=>{try{return await this.engine.approve(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"reject",(async e=>{try{return await this.engine.reject(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"update",(async e=>{try{return await this.engine.update(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"extend",(async e=>{try{return await this.engine.extend(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"request",(async e=>{try{return await this.engine.request(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"respond",(async e=>{try{return await this.engine.respond(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"ping",(async e=>{try{return await this.engine.ping(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"emit",(async e=>{try{return await this.engine.emit(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"disconnect",(async e=>{try{return await this.engine.disconnect(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"find",(e=>{try{return this.engine.find(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"getPendingSessionRequests",(()=>{try{return this.engine.getPendingSessionRequests()}catch(vc){throw this.logger.error(vc.message),vc}})),Ey(this,"authenticate",(async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(we){throw this.logger.error(we.message),we}})),Ey(this,"formatAuthMessage",(e=>{try{return this.engine.formatAuthMessage(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"approveSessionAuthenticate",(async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(E){throw this.logger.error(E.message),E}})),Ey(this,"rejectSessionAuthenticate",(async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(E){throw this.logger.error(E.message),E}})),this.name=e?.name||Vv,this.metadata=fo(e?.metadata),this.signConfig=e?.signConfig;const t=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:(0,ie.h6)((0,ie.iP)({level:e?.logger||Hv}));this.core=e?.core||new zv(e),this.logger=(0,ie.U5)(t,this.name),this.session=new py(this.core,this.logger),this.proposal=new dy(this.core,this.logger),this.pendingRequest=new fy(this.core,this.logger),this.engine=new uy(this),this.auth=new wy(this.core,this.logger)}static async init(e){const t=new Cy(e);return await t.initialize(),t}get context(){return(0,ie.oI)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout((()=>{this.engine.processRelayMessageCache()}),(0,b.toMiliseconds)(b.ONE_SECOND))}catch(x){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(x.message),x}}}const Ay=":";function Sy(e){const[t,n]=e.split(Ay);return{namespace:t,reference:n}}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function _y(){return[...new Set([...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],...arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]])]}function Ty(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Py(e){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function My(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Ty(e.outputLen),Ty(e.blockLen)}function Ny(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Iy(e,t){Py(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Oy=BigInt(2**32-1),Dy=BigInt(32);function Ly(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&Oy),l:Number(e>>Dy&Oy)}:{h:0|Number(e>>Dy&Oy),l:0|Number(e&Oy)}}const Ry="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function ky(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function By(e,t){return e<<32-t|e>>>t}const Uy=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function zy(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Fy(e){for(let t=0;t<e.length;t++)e[t]=zy(e[t])}function jy(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),Py(e),e}class Vy{clone(){return this._cloneInto()}}function Hy(e){const t=t=>e().update(jy(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Wy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(Ry&&"function"==typeof Ry.getRandomValues)return Ry.getRandomValues(new Uint8Array(e));if(Ry&&"function"==typeof Ry.randomBytes)return Ry.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}const Gy=[],qy=[],Ky=[],Yy=BigInt(0),Qy=BigInt(1),Xy=BigInt(2),Zy=BigInt(7),Jy=BigInt(256),$y=BigInt(113);for(let HC=0,WC=Qy,GC=1,qC=0;HC<24;HC++){[GC,qC]=[qC,(2*GC+3*qC)%5],Gy.push(2*(5*qC+GC)),qy.push((HC+1)*(HC+2)/2%64);let e=Yy;for(let t=0;t<7;t++)WC=(WC<<Qy^(WC>>Zy)*$y)%Jy,WC&Xy&&(e^=Qy<<(Qy<<BigInt(t))-Qy);Ky.push(e)}const[eb,tb]=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let r=0;r<e.length;r++){const{h:s,l:a}=Ly(e[r],t);[n[r],i[r]]=[s,a]}return[n,i]}(Ky,!0),nb=(e,t,n)=>n>32?((e,t,n)=>t<<n-32|e>>>64-n)(e,t,n):((e,t,n)=>e<<n|t>>>32-n)(e,t,n),ib=(e,t,n)=>n>32?((e,t,n)=>e<<n-32|t>>>64-n)(e,t,n):((e,t,n)=>t<<n|e>>>32-n)(e,t,n);class rb extends Vy{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=i,this.rounds=r,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Ty(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}(this.state)}keccak(){Uy||Fy(this.state32),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;const n=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){const t=(i+8)%10,r=(i+2)%10,s=n[r],a=n[r+1],o=nb(s,a,1)^n[t],l=ib(s,a,1)^n[t+1];for(let n=0;n<50;n+=10)e[i+n]^=o,e[i+n+1]^=l}let t=e[2],r=e[3];for(let n=0;n<24;n++){const i=qy[n],s=nb(t,r,i),a=ib(t,r,i),o=Gy[n];t=e[o],r=e[o+1],e[o]=s,e[o+1]=a}for(let i=0;i<50;i+=10){for(let t=0;t<10;t++)n[t]=e[i+t];for(let t=0;t<10;t++)e[i+t]^=~n[(t+2)%10]&n[(t+4)%10]}e[0]^=eb[i],e[1]^=tb[i]}n.fill(0)}(this.state32,this.rounds),Uy||Fy(this.state32),this.posOut=0,this.pos=0}update(e){Ny(this);const{blockLen:t,state:n}=this,i=(e=jy(e)).length;for(let r=0;r<i;){const s=Math.min(t-this.pos,i-r);for(let t=0;t<s;t++)n[this.pos++]^=e[r++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:i}=this;e[n]^=t,0!==(128&t)&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Ny(this,!1),Py(e),this.finish();const t=this.state,{blockLen:n}=this;for(let i=0,r=e.length;i<r;){this.posOut>=n&&this.keccak();const s=Math.min(n-this.posOut,r-i);e.set(t.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ty(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Iy(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:i,rounds:r,enableXOF:s}=this;return e||(e=new rb(t,n,i,s,r)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=r,e.suffix=n,e.outputLen=i,e.enableXOF=s,e.destroyed=this.destroyed,e}}((e,t,n)=>{Hy((()=>new rb(t,e,n)))})(1,136,32);Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function sb(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function ab(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function ob(e){if(!ab(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function lb(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function cb(e){if("boolean"!=typeof e)throw new Error(`boolean expected, not ${e}`)}const hb=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function ub(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!ab(e))throw new Error("Uint8Array expected, got "+typeof e);e=fb(e)}return e}function db(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!function(e){return e.byteOffset%4===0}(t))throw new Error("invalid output, must be aligned");return t}function pb(e,t,n,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,i);const r=BigInt(32),s=BigInt(4294967295),a=Number(n>>r&s),o=Number(n&s),l=i?4:0,c=i?0:4;e.setUint32(t+l,a,i),e.setUint32(t+c,o,i)}function fb(e){return Uint8Array.from(e)}function mb(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<t.length;i++)t[i].fill(0)}const gb=e=>Uint8Array.from(e.split("").map((e=>e.charCodeAt(0)))),vb=gb("expand 16-byte k"),yb=gb("expand 32-byte k"),bb=hb(vb),wb=hb(yb);function xb(e,t){return e<<t|e>>>32-t}function Eb(e){return e.byteOffset%4===0}const Cb=2**32-1,Ab=new Uint32Array;const Sb=(e,t)=>255&e[t++]|(255&e[t++])<<8;class _b{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,ob(e=ub(e),32);const t=Sb(e,0),n=Sb(e,2),i=Sb(e,4),r=Sb(e,6),s=Sb(e,8),a=Sb(e,10),o=Sb(e,12),l=Sb(e,14);this.r[0]=8191&t,this.r[1]=8191&(t>>>13|n<<3),this.r[2]=7939&(n>>>10|i<<6),this.r[3]=8191&(i>>>7|r<<9),this.r[4]=255&(r>>>4|s<<12),this.r[5]=s>>>1&8190,this.r[6]=8191&(s>>>14|a<<2),this.r[7]=8065&(a>>>11|o<<5),this.r[8]=8191&(o>>>8|l<<8),this.r[9]=l>>>5&127;for(let c=0;c<8;c++)this.pad[c]=Sb(e,16+2*c)}process(e,t){const n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?0:2048,{h:i,r:r}=this,s=r[0],a=r[1],o=r[2],l=r[3],c=r[4],h=r[5],u=r[6],d=r[7],p=r[8],f=r[9],m=Sb(e,t+0),g=Sb(e,t+2),v=Sb(e,t+4),y=Sb(e,t+6),b=Sb(e,t+8),w=Sb(e,t+10),x=Sb(e,t+12),E=Sb(e,t+14);let C=i[0]+(8191&m),A=i[1]+(8191&(m>>>13|g<<3)),S=i[2]+(8191&(g>>>10|v<<6)),_=i[3]+(8191&(v>>>7|y<<9)),T=i[4]+(8191&(y>>>4|b<<12)),P=i[5]+(b>>>1&8191),M=i[6]+(8191&(b>>>14|w<<2)),N=i[7]+(8191&(w>>>11|x<<5)),I=i[8]+(8191&(x>>>8|E<<8)),O=i[9]+(E>>>5|n),D=0,L=D+C*s+A*(5*f)+S*(5*p)+_*(5*d)+T*(5*u);D=L>>>13,L&=8191,L+=P*(5*h)+M*(5*c)+N*(5*l)+I*(5*o)+O*(5*a),D+=L>>>13,L&=8191;let R=D+C*a+A*s+S*(5*f)+_*(5*p)+T*(5*d);D=R>>>13,R&=8191,R+=P*(5*u)+M*(5*h)+N*(5*c)+I*(5*l)+O*(5*o),D+=R>>>13,R&=8191;let k=D+C*o+A*a+S*s+_*(5*f)+T*(5*p);D=k>>>13,k&=8191,k+=P*(5*d)+M*(5*u)+N*(5*h)+I*(5*c)+O*(5*l),D+=k>>>13,k&=8191;let B=D+C*l+A*o+S*a+_*s+T*(5*f);D=B>>>13,B&=8191,B+=P*(5*p)+M*(5*d)+N*(5*u)+I*(5*h)+O*(5*c),D+=B>>>13,B&=8191;let U=D+C*c+A*l+S*o+_*a+T*s;D=U>>>13,U&=8191,U+=P*(5*f)+M*(5*p)+N*(5*d)+I*(5*u)+O*(5*h),D+=U>>>13,U&=8191;let z=D+C*h+A*c+S*l+_*o+T*a;D=z>>>13,z&=8191,z+=P*s+M*(5*f)+N*(5*p)+I*(5*d)+O*(5*u),D+=z>>>13,z&=8191;let F=D+C*u+A*h+S*c+_*l+T*o;D=F>>>13,F&=8191,F+=P*a+M*s+N*(5*f)+I*(5*p)+O*(5*d),D+=F>>>13,F&=8191;let j=D+C*d+A*u+S*h+_*c+T*l;D=j>>>13,j&=8191,j+=P*o+M*a+N*s+I*(5*f)+O*(5*p),D+=j>>>13,j&=8191;let V=D+C*p+A*d+S*u+_*h+T*c;D=V>>>13,V&=8191,V+=P*l+M*o+N*a+I*s+O*(5*f),D+=V>>>13,V&=8191;let H=D+C*f+A*p+S*d+_*u+T*h;D=H>>>13,H&=8191,H+=P*c+M*l+N*o+I*a+O*s,D+=H>>>13,H&=8191,D=(D<<2)+D|0,D=D+L|0,L=8191&D,D>>>=13,R+=D,i[0]=L,i[1]=R,i[2]=k,i[3]=B,i[4]=U,i[5]=z,i[6]=F,i[7]=j,i[8]=V,i[9]=H}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let r=(1^i)-1;for(let a=0;a<10;a++)n[a]&=r;r=~r;for(let a=0;a<10;a++)e[a]=e[a]&r|n[a];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let s=e[0]+t[0];e[0]=65535&s;for(let a=1;a<8;a++)s=(e[a]+t[a]|0)+(s>>>16)|0,e[a]=65535&s;mb(n)}update(e){lb(this);const{buffer:t,blockLen:n}=this,i=(e=ub(e)).length;for(let r=0;r<i;){const s=Math.min(n-this.pos,i-r);if(s!==n)t.set(e.subarray(r,r+s),this.pos),this.pos+=s,r+=s,this.pos===n&&(this.process(t,0,!1),this.pos=0);else for(;n<=i-r;r+=n)this.process(e,r)}return this}destroy(){mb(this.h,this.r,this.buffer,this.pad)}digestInto(e){lb(this),function(e,t){ob(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let r=0;for(let s=0;s<8;s++)e[r++]=n[s]>>>0,e[r++]=n[s]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}const Tb=function(e){const t=(t,n)=>e(n).update(ub(t)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t}((e=>new _b(e)));const Pb=function(e,t){const{allowShortKeys:n,extendNonceFn:i,counterLength:r,counterRight:s,rounds:a}=function(e,t){if(null==t||"object"!=typeof t)throw new Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw new Error("core must be a function");return sb(r),sb(a),cb(s),cb(n),function(t,o,l,c){let h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;ob(t),ob(o),ob(l);const u=l.length;if(void 0===c&&(c=new Uint8Array(u)),ob(c),sb(h),h<0||h>=Cb)throw new Error("arx: counter overflow");if(c.length<u)throw new Error(`arx: output (${c.length}) is shorter than data (${u})`);const d=[];let p,f,m=t.length;if(32===m)d.push(p=fb(t)),f=wb;else{if(16!==m||!n)throw new Error(`arx: invalid 32-byte key, got length=${m}`);p=new Uint8Array(32),p.set(t),p.set(t,16),f=bb,d.push(p)}Eb(o)||d.push(o=fb(o));const g=hb(p);if(i){if(24!==o.length)throw new Error("arx: extended nonce must be 24 bytes");i(f,g,hb(o.subarray(0,16)),g),o=o.subarray(16)}const v=16-r;if(v!==o.length)throw new Error(`arx: nonce must be ${v} or 16 bytes`);if(12!==v){const e=new Uint8Array(12);e.set(o,s?0:12-o.length),o=e,d.push(o)}const y=hb(o);return function(e,t,n,i,r,s,a,o){const l=r.length,c=new Uint8Array(64),h=hb(c),u=Eb(r)&&Eb(s),d=u?hb(r):Ab,p=u?hb(s):Ab;for(let f=0;f<l;a++){if(e(t,n,i,h,a,o),a>=Cb)throw new Error("arx: counter overflow");const m=Math.min(64,l-f);if(u&&64===m){const e=f/4;if(f%4!==0)throw new Error("arx: invalid block position");for(let t,n=0;n<16;n++)t=e+n,p[t]=d[t]^h[n];f+=64}else{for(let e,t=0;t<m;t++)e=f+t,s[e]=r[e]^c[t];f+=m}}}(e,f,g,y,l,c,h,a),mb(...d),c}}((function(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,a=e[0],o=e[1],l=e[2],c=e[3],h=t[0],u=t[1],d=t[2],p=t[3],f=t[4],m=t[5],g=t[6],v=t[7],y=r,b=n[0],w=n[1],x=n[2],E=a,C=o,A=l,S=c,_=h,T=u,P=d,M=p,N=f,I=m,O=g,D=v,L=y,R=b,k=w,B=x;for(let z=0;z<s;z+=2)E=E+_|0,L=xb(L^E,16),N=N+L|0,_=xb(_^N,12),E=E+_|0,L=xb(L^E,8),N=N+L|0,_=xb(_^N,7),C=C+T|0,R=xb(R^C,16),I=I+R|0,T=xb(T^I,12),C=C+T|0,R=xb(R^C,8),I=I+R|0,T=xb(T^I,7),A=A+P|0,k=xb(k^A,16),O=O+k|0,P=xb(P^O,12),A=A+P|0,k=xb(k^A,8),O=O+k|0,P=xb(P^O,7),S=S+M|0,B=xb(B^S,16),D=D+B|0,M=xb(M^D,12),S=S+M|0,B=xb(B^S,8),D=D+B|0,M=xb(M^D,7),E=E+T|0,B=xb(B^E,16),O=O+B|0,T=xb(T^O,12),E=E+T|0,B=xb(B^E,8),O=O+B|0,T=xb(T^O,7),C=C+P|0,L=xb(L^C,16),D=D+L|0,P=xb(P^D,12),C=C+P|0,L=xb(L^C,8),D=D+L|0,P=xb(P^D,7),A=A+M|0,R=xb(R^A,16),N=N+R|0,M=xb(M^N,12),A=A+M|0,R=xb(R^A,8),N=N+R|0,M=xb(M^N,7),S=S+_|0,k=xb(k^S,16),I=I+k|0,_=xb(_^I,12),S=S+_|0,k=xb(k^S,8),I=I+k|0,_=xb(_^I,7);let U=0;i[U++]=a+E|0,i[U++]=o+C|0,i[U++]=l+A|0,i[U++]=c+S|0,i[U++]=h+_|0,i[U++]=u+T|0,i[U++]=d+P|0,i[U++]=p+M|0,i[U++]=f+N|0,i[U++]=m+I|0,i[U++]=g+O|0,i[U++]=v+D|0,i[U++]=y+L|0,i[U++]=b+R|0,i[U++]=w+k|0,i[U++]=x+B|0}),{counterRight:!1,counterLength:4,allowShortKeys:!1}),Mb=new Uint8Array(16),Nb=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(Mb.subarray(n))},Ib=new Uint8Array(32);function Ob(e,t,n,i,r){const s=e(t,n,Ib),a=Tb.create(s);r&&Nb(a,r),Nb(a,i);const o=new Uint8Array(16),l=(e=>new DataView(e.buffer,e.byteOffset,e.byteLength))(o);pb(l,0,BigInt(r?r.length:0),!0),pb(l,8,BigInt(i.length),!0),a.update(o);const c=a.digest();return mb(s,o),c}((e,t)=>{function n(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];if(ob(n),void 0!==e.nonceLength){const t=r[0];if(!t)throw new Error("nonce / iv required");e.varSizeNonce?ob(t):ob(t,e.nonceLength)}const a=e.tagLength;a&&void 0!==r[1]&&ob(r[1]);const o=t(n,...r),l=(e,t)=>{if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");ob(t)}};let c=!1;return{encrypt(e,t){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,ob(e),l(o.encrypt.length,t),o.encrypt(e,t)},decrypt(e,t){if(ob(e),a&&e.length<a)throw new Error("invalid ciphertext length: smaller than tagLength="+a);return l(o.decrypt.length,t),o.decrypt(e,t)}}}Object.assign(n,e)})({blockSize:64,nonceLength:12,tagLength:16},(e=>(t,n,i)=>({encrypt(r,s){const a=r.length;(s=db(a+16,s,!1)).set(r);const o=s.subarray(0,-16);e(t,n,o,o,1);const l=Ob(e,t,n,o,i);return s.set(l,a),mb(l),s},decrypt(r,s){s=db(r.length-16,s,!1);const a=r.subarray(0,-16),o=r.subarray(-16),l=Ob(e,t,n,a,i);if(!function(e,t){if(e.length!==t.length)return!1;let n=0;for(let i=0;i<e.length;i++)n|=e[i]^t[i];return 0===n}(o,l))throw new Error("invalid tag");return s.set(r.subarray(0,-16)),e(t,n,s,s,1),mb(l),s}}))(Pb));class Db extends Vy{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,My(e);const n=jy(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,r=new Uint8Array(i);r.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<r.length;s++)r[s]^=54;this.iHash.update(r),this.oHash=e.create();for(let s=0;s<r.length;s++)r[s]^=106;this.oHash.update(r),r.fill(0)}update(e){return Ny(this),this.iHash.update(e),this}digestInto(e){Ny(this),Py(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:i,destroyed:r,blockLen:s,outputLen:a}=this;return e.finished=i,e.destroyed=r,e.blockLen=s,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Lb=(e,t,n)=>new Db(e,t).update(n).digest();Lb.create=(e,t)=>new Db(e,t);new Uint8Array([0]),new Uint8Array;function Rb(e,t,n){return e&t^~e&n}function kb(e,t,n){return e&t^e&n^t&n}class Bb extends Vy{constructor(e,t,n,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ky(this.buffer)}update(e){Ny(this);const{view:t,buffer:n,blockLen:i}=this,r=(e=jy(e)).length;for(let s=0;s<r;){const a=Math.min(i-this.pos,r-s);if(a!==i)n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0);else{const t=ky(e);for(;i<=r-s;s+=i)this.process(t,s)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ny(this),Iy(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:r}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)t[h]=0;(function(e,t,n,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,i);const r=BigInt(32),s=BigInt(4294967295),a=Number(n>>r&s),o=Number(n&s),l=i?4:0,c=i?0:4;e.setUint32(t+l,a,i),e.setUint32(t+c,o,i)})(n,i-8,BigInt(8*this.length),r),this.process(n,0);const a=ky(e),o=this.outputLen;if(o%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=o/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,c[h],r)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:i,finished:r,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=r,e.destroyed=s,i%t&&e.buffer.set(n),e}}const Ub=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),zb=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Fb=new Uint32Array(64);class jb extends Bb{constructor(){super(64,32,8,!1),this.A=0|zb[0],this.B=0|zb[1],this.C=0|zb[2],this.D=0|zb[3],this.E=0|zb[4],this.F=0|zb[5],this.G=0|zb[6],this.H=0|zb[7]}get(){const{A:e,B:t,C:n,D:i,E:r,F:s,G:a,H:o}=this;return[e,t,n,i,r,s,a,o]}set(e,t,n,i,r,s,a,o){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|i,this.E=0|r,this.F=0|s,this.G=0|a,this.H=0|o}process(e,t){for(let h=0;h<16;h++,t+=4)Fb[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const e=Fb[h-15],t=Fb[h-2],n=By(e,7)^By(e,18)^e>>>3,i=By(t,17)^By(t,19)^t>>>10;Fb[h]=i+Fb[h-7]+n+Fb[h-16]|0}let{A:n,B:i,C:r,D:s,E:a,F:o,G:l,H:c}=this;for(let h=0;h<64;h++){const e=c+(By(a,6)^By(a,11)^By(a,25))+Rb(a,o,l)+Ub[h]+Fb[h]|0,t=(By(n,2)^By(n,13)^By(n,22))+kb(n,i,r)|0;c=l,l=o,o=a,a=s+e|0,s=r,r=i,i=n,n=e+t|0}n=n+this.A|0,i=i+this.B|0,r=r+this.C|0,s=s+this.D|0,a=a+this.E|0,o=o+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,i,r,s,a,o,l,c)}roundClean(){Fb.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Vb=Hy((()=>new jb)),Hb=BigInt(0),Wb=BigInt(1),Gb=BigInt(2);function qb(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Kb(e){if(!qb(e))throw new Error("Uint8Array expected")}function Yb(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}const Qb=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Xb(e){Kb(e);let t="";for(let n=0;n<e.length;n++)t+=Qb[e[n]];return t}function Zb(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function Jb(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?Hb:BigInt("0x"+e)}const $b=48,ew=57,tw=65,nw=70,iw=97,rw=102;function sw(e){return e>=$b&&e<=ew?e-$b:e>=tw&&e<=nw?e-(tw-10):e>=iw&&e<=rw?e-(iw-10):void 0}function aw(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const i=new Uint8Array(n);for(let r=0,s=0;r<n;r++,s+=2){const t=sw(e.charCodeAt(s)),n=sw(e.charCodeAt(s+1));if(void 0===t||void 0===n){const t=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+s)}i[r]=16*t+n}return i}function ow(e){return Jb(Xb(e))}function lw(e){return Kb(e),Jb(Xb(Uint8Array.from(e).reverse()))}function cw(e,t){return aw(e.toString(16).padStart(2*t,"0"))}function hw(e,t){return cw(e,t).reverse()}function uw(e,t,n){let i;if("string"==typeof t)try{i=aw(t)}catch(we){throw new Error(e+" must be hex string or Uint8Array, cause: "+we)}else{if(!qb(t))throw new Error(e+" must be hex string or Uint8Array");i=Uint8Array.from(t)}const r=i.length;if("number"==typeof n&&r!==n)throw new Error(e+" of length "+n+" expected, got "+r);return i}function dw(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];Kb(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,i=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,i),i+=e.length}return t}const pw=e=>"bigint"==typeof e&&Hb<=e;function fw(e,t,n){return pw(e)&&pw(t)&&pw(n)&&t<=e&&e<n}function mw(e,t,n,i){if(!fw(t,n,i))throw new Error("expected valid "+e+": "+n+" <= n < "+i+", got "+t)}function gw(e){let t;for(t=0;e>Hb;e>>=Wb,t+=1);return t}const vw=e=>(Gb<<BigInt(e-1))-Wb,yw=e=>new Uint8Array(e),bw=e=>Uint8Array.from(e);function ww(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let i=yw(e),r=yw(e),s=0;const a=()=>{i.fill(1),r.fill(0),s=0},o=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return n(r,i,...t)},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yw();r=o(bw([0]),e),i=o(),0!==e.length&&(r=o(bw([1]),e),i=o())},c=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){i=o();const t=i.slice();n.push(t),e+=i.length}return dw(...n)};return(e,t)=>{let n;for(a(),l(e);!(n=t(c()));)l();return a(),n}}const xw={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||qb(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function Ew(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=(t,n,i)=>{const r=xw[n];if("function"!=typeof r)throw new Error("invalid validator function");const s=e[t];if((!i||void 0!==s)&&!r(s,e))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+s)};for(const[r,s]of Object.entries(t))i(r,s,!1);for(const[r,s]of Object.entries(n))i(r,s,!0);return e}function Cw(e){const t=new WeakMap;return function(n){const i=t.get(n);if(void 0!==i)return i;for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const o=e(n,...s);return t.set(n,o),o}}var Aw=Object.freeze({__proto__:null,isBytes:qb,abytes:Kb,abool:Yb,bytesToHex:Xb,numberToHexUnpadded:Zb,hexToNumber:Jb,hexToBytes:aw,bytesToNumberBE:ow,bytesToNumberLE:lw,numberToBytesBE:cw,numberToBytesLE:hw,numberToVarBytesBE:function(e){return aw(Zb(e))},ensureBytes:uw,concatBytes:dw,equalBytes:function(e,t){if(e.length!==t.length)return!1;let n=0;for(let i=0;i<e.length;i++)n|=e[i]^t[i];return 0===n},utf8ToBytes:function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))},inRange:fw,aInRange:mw,bitLen:gw,bitGet:function(e,t){return e>>BigInt(t)&Wb},bitSet:function(e,t,n){return e|(n?Wb:Hb)<<BigInt(t)},bitMask:vw,createHmacDrbg:ww,validateObject:Ew,notImplemented:()=>{throw new Error("not implemented")},memoized:Cw});const Sw=BigInt(0),_w=BigInt(1),Tw=BigInt(2),Pw=BigInt(3),Mw=BigInt(4),Nw=BigInt(5),Iw=BigInt(8);function Ow(e,t){const n=e%t;return n>=Sw?n:t+n}function Dw(e,t,n){if(t<Sw)throw new Error("invalid exponent, negatives unsupported");if(n<=Sw)throw new Error("invalid modulus");if(n===_w)return Sw;let i=_w;for(;t>Sw;)t&_w&&(i=i*e%n),e=e*e%n,t>>=_w;return i}function Lw(e,t,n){let i=e;for(;t-- >Sw;)i*=i,i%=n;return i}function Rw(e,t){if(e===Sw)throw new Error("invert: expected non-zero number");if(t<=Sw)throw new Error("invert: expected positive modulus, got "+t);let n=Ow(e,t),i=t,r=Sw,s=_w;for(;n!==Sw;){const e=i%n,t=r-s*(i/n);i=n,n=e,r=s,s=t}if(i!==_w)throw new Error("invert: does not exist");return Ow(r,t)}function kw(e){if(e%Mw===Pw){const t=(e+_w)/Mw;return function(e,n){const i=e.pow(n,t);if(!e.eql(e.sqr(i),n))throw new Error("Cannot find square root");return i}}if(e%Iw===Nw){const t=(e-Nw)/Iw;return function(e,n){const i=e.mul(n,Tw),r=e.pow(i,t),s=e.mul(n,r),a=e.mul(e.mul(s,Tw),r),o=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),n))throw new Error("Cannot find square root");return o}}return function(e){const t=(e-_w)/Tw;let n,i,r;for(n=e-_w,i=0;n%Tw===Sw;n/=Tw,i++);for(r=Tw;r<e&&Dw(r,t,e)!==e-_w;r++)if(r>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===i){const t=(e+_w)/Mw;return function(e,n){const i=e.pow(n,t);if(!e.eql(e.sqr(i),n))throw new Error("Cannot find square root");return i}}const s=(n+_w)/Tw;return function(e,a){if(e.pow(a,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let o=i,l=e.pow(e.mul(e.ONE,r),n),c=e.pow(a,s),h=e.pow(a,n);for(;!e.eql(h,e.ONE);){if(e.eql(h,e.ZERO))return e.ZERO;let t=1;for(let i=e.sqr(h);t<o&&!e.eql(i,e.ONE);t++)i=e.sqr(i);const n=e.pow(l,_w<<BigInt(o-t-1));l=e.sqr(n),c=e.mul(c,n),h=e.mul(h,l),o=t}return c}}(e)}const Bw=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Uw(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function zw(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=Sw)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:r,nByteLength:s}=Uw(e,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let a;const o=Object.freeze({ORDER:e,isLE:n,BITS:r,BYTES:s,MASK:vw(r),ZERO:Sw,ONE:_w,create:t=>Ow(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return Sw<=t&&t<e},is0:e=>e===Sw,isOdd:e=>(e&_w)===_w,neg:t=>Ow(-t,e),eql:(e,t)=>e===t,sqr:t=>Ow(t*t,e),add:(t,n)=>Ow(t+n,e),sub:(t,n)=>Ow(t-n,e),mul:(t,n)=>Ow(t*n,e),pow:(e,t)=>function(e,t,n){if(n<Sw)throw new Error("invalid exponent, negatives unsupported");if(n===Sw)return e.ONE;if(n===_w)return t;let i=e.ONE,r=t;for(;n>Sw;)n&_w&&(i=e.mul(i,r)),r=e.sqr(r),n>>=_w;return i}(o,e,t),div:(t,n)=>Ow(t*Rw(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>Rw(t,e),sqrt:i.sqrt||(t=>(a||(a=kw(e)),a(o,t))),invertBatch:e=>function(e,t){const n=new Array(t.length),i=t.reduce(((t,i,r)=>e.is0(i)?t:(n[r]=t,e.mul(t,i))),e.ONE),r=e.inv(i);return t.reduceRight(((t,i,r)=>e.is0(i)?t:(n[r]=e.mul(t,n[r]),e.mul(t,i))),r),n}(o,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?hw(e,s):cw(e,s),fromBytes:e=>{if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return n?lw(e):ow(e)}});return Object.freeze(o)}function Fw(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function jw(e){const t=Fw(e);return t+Math.ceil(t/2)}const Vw=BigInt(0),Hw=BigInt(1);function Ww(e,t){const n=t.negate();return e?n:t}function Gw(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function qw(e,t){Gw(e,t);return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}const Kw=new WeakMap,Yw=new WeakMap;function Qw(e){return Yw.get(e)||1}function Xw(e,t,n,i){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)}))}(n,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)}))}(i,t),n.length!==i.length)throw new Error("arrays of points and scalars must have equal length");const r=e.ZERO,s=gw(BigInt(n.length)),a=s>12?s-3:s>4?s-2:s?2:1,o=(1<<a)-1,l=new Array(o+1).fill(r);let c=r;for(let h=Math.floor((t.BITS-1)/a)*a;h>=0;h-=a){l.fill(r);for(let t=0;t<i.length;t++){const e=i[t],r=Number(e>>BigInt(h)&BigInt(o));l[r]=l[r].add(n[t])}let e=r;for(let t=l.length-1,n=r;t>0;t--)n=n.add(l[t]),e=e.add(n);if(c=c.add(e),0!==h)for(let t=0;t<a;t++)c=c.double()}return c}function Zw(e){return function(e){const t=Bw.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});Ew(e,t)}(e.Fp),Ew(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Uw(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Jw=BigInt(0),$w=BigInt(1);const ex=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const tx=BigInt(1),nx=BigInt(2),ix=BigInt(3),rx=BigInt(5);BigInt(8);!function(e){const t=function(e){return Ew(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}(e),{P:n}=t,i=e=>Ow(e,n),r=t.montgomeryBits,s=Math.ceil(r/8),a=t.nByteLength,o=t.adjustScalarBytes||(e=>e),l=t.powPminus2||(e=>Dw(e,n-BigInt(2),n));function c(e,t,n){const r=i(e*(t-n));return[t=i(t-r),n=i(n+r)]}const h=(t.a-BigInt(2))/BigInt(4);function u(e){return hw(i(e),s)}function d(e,t){const d=function(e){const t=uw("u coordinate",e,s);return 32===a&&(t[31]&=127),lw(t)}(t),p=function(e){const t=uw("scalar",e),n=t.length;if(n!==s&&n!==a)throw new Error("invalid scalar, expected "+s+" or "+a+" bytes, got "+n);return lw(o(t))}(e),f=function(e,t){mw("u",e,Jw,n),mw("scalar",t,Jw,n);const s=t,a=e;let o,u=$w,d=Jw,p=e,f=$w,m=Jw;for(let n=BigInt(r-1);n>=Jw;n--){const e=s>>n&$w;m^=e,o=c(m,u,p),u=o[0],p=o[1],o=c(m,d,f),d=o[0],f=o[1],m=e;const t=u+d,r=i(t*t),l=u-d,g=i(l*l),v=r-g,y=p+f,b=i((p-f)*t),w=i(y*l),x=b+w,E=b-w;p=i(x*x),f=i(a*i(E*E)),u=i(r*g),d=i(v*(r+i(h*v)))}o=c(m,u,p),u=o[0],p=o[1],o=c(m,d,f),d=o[0],f=o[1];const g=l(d);return i(u*g)}(d,p);if(f===Jw)throw new Error("invalid private or public key received");return u(f)}const p=u(t.Gu);function f(e){return d(e,p)}}({P:ex,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{const t=ex,{pow_p_5_8:n,b2:i}=function(e){const t=BigInt(10),n=BigInt(20),i=BigInt(40),r=BigInt(80),s=ex,a=e*e%s*e%s,o=Lw(a,nx,s)*a%s,l=Lw(o,tx,s)*e%s,c=Lw(l,rx,s)*l%s,h=Lw(c,t,s)*c%s,u=Lw(h,n,s)*h%s,d=Lw(u,i,s)*u%s,p=Lw(d,r,s)*d%s,f=Lw(p,r,s)*d%s,m=Lw(f,t,s)*c%s;return{pow_p_5_8:Lw(m,nx,s)*e%s,b2:a}}(e);return Ow(Lw(n,ix,t)*i,t)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:Wy});function sx(e){void 0!==e.lowS&&Yb("lowS",e.lowS),void 0!==e.prehash&&Yb("prehash",e.prehash)}const{bytesToNumberBE:ax,hexToBytes:ox}=Aw;class lx extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}}const cx={Err:lx,_tlv:{encode:(e,t)=>{const{Err:n}=cx;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&t.length)throw new n("tlv.encode: unpadded data");const i=t.length/2,r=Zb(i);if(r.length/2&128)throw new n("tlv.encode: long form length too big");const s=i>127?Zb(r.length/2|128):"";return Zb(e)+s+r+t},decode(e,t){const{Err:n}=cx;let i=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new n("tlv.decode: wrong tlv");const r=t[i++];let s=0;if(!!(128&r)){const e=127&r;if(!e)throw new n("tlv.decode(long): indefinite length not supported");if(e>4)throw new n("tlv.decode(long): byte length is too big");const a=t.subarray(i,i+e);if(a.length!==e)throw new n("tlv.decode: length bytes not complete");if(0===a[0])throw new n("tlv.decode(long): zero leftmost byte");for(const t of a)s=s<<8|t;if(i+=e,s<128)throw new n("tlv.decode(long): not minimal encoding")}else s=r;const a=t.subarray(i,i+s);if(a.length!==s)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(i+s)}}},_int:{encode(e){const{Err:t}=cx;if(e<hx)throw new t("integer: negative integers are not allowed");let n=Zb(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=cx;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return ax(e)}},toSig(e){const{Err:t,_int:n,_tlv:i}=cx,r="string"==typeof e?ox(e):e;Kb(r);const{v:s,l:a}=i.decode(48,r);if(a.length)throw new t("invalid signature: left bytes after parsing");const{v:o,l:l}=i.decode(2,s),{v:c,l:h}=i.decode(2,l);if(h.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(o),s:n.decode(c)}},hexFromSig(e){const{_tlv:t,_int:n}=cx,i=t.encode(2,n.encode(e.r))+t.encode(2,n.encode(e.s));return t.encode(48,i)}},hx=BigInt(0),ux=BigInt(1);BigInt(2);const dx=BigInt(3);function px(e){const t=function(e){const t=Zw(e);Ew(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:i,a:r}=t;if(n){if(!i.eql(r,i.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:n}=t,i=zw(t.n,t.nBitLength),r=t.toBytes||((e,t,i)=>{const r=t.toAffine();return dw(Uint8Array.from([4]),n.toBytes(r.x),n.toBytes(r.y))}),s=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function a(e){const{a:i,b:r}=t,s=n.sqr(e),a=n.mul(s,e);return n.add(n.add(a,n.mul(e,i)),r)}if(!n.eql(n.sqr(t.Gy),a(t.Gx)))throw new Error("bad generator point: equation left != right");function o(e){const{allowedPrivateKeyLengths:n,nByteLength:i,wrapPrivateKey:r,n:s}=t;if(n&&"bigint"!=typeof e){if(qb(e)&&(e=Xb(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*i,"0")}let a;try{a="bigint"==typeof e?e:ow(uw("private key",e,i))}catch{throw new Error("invalid private key, expected hex or "+i+" bytes, got "+typeof e)}return r&&(a=Ow(a,s)),mw("private key",a,ux,s),a}function l(e){if(!(e instanceof u))throw new Error("ProjectivePoint expected")}const c=Cw(((e,t)=>{const{px:i,py:r,pz:s}=e;if(n.eql(s,n.ONE))return{x:i,y:r};const a=e.is0();null==t&&(t=a?n.ONE:n.inv(s));const o=n.mul(i,t),l=n.mul(r,t),c=n.mul(s,t);if(a)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:o,y:l}})),h=Cw((e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:i,y:r}=e.toAffine();if(!n.isValid(i)||!n.isValid(r))throw new Error("bad point: x or y not FE");const s=n.sqr(r),o=a(i);if(!n.eql(s,o))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class u{constructor(e,t,i){if(this.px=e,this.py=t,this.pz=i,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==i||!n.isValid(i))throw new Error("z required");Object.freeze(this)}static fromAffine(e){const{x:t,y:i}=e||{};if(!e||!n.isValid(t)||!n.isValid(i))throw new Error("invalid affine point");if(e instanceof u)throw new Error("projective point not allowed");const r=e=>n.eql(e,n.ZERO);return r(t)&&r(i)?u.ZERO:new u(t,i,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(u.fromAffine)}static fromHex(e){const t=u.fromAffine(s(uw("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return u.BASE.multiply(o(e))}static msm(e,t){return Xw(u,i,e,t)}_setWindowSize(e){p.setWindowSize(this,e)}assertValidity(){h(this)}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){l(e);const{px:t,py:i,pz:r}=this,{px:s,py:a,pz:o}=e,c=n.eql(n.mul(t,o),n.mul(s,r)),h=n.eql(n.mul(i,o),n.mul(a,r));return c&&h}negate(){return new u(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:i}=t,r=n.mul(i,dx),{px:s,py:a,pz:o}=this;let l=n.ZERO,c=n.ZERO,h=n.ZERO,d=n.mul(s,s),p=n.mul(a,a),f=n.mul(o,o),m=n.mul(s,a);return m=n.add(m,m),h=n.mul(s,o),h=n.add(h,h),l=n.mul(e,h),c=n.mul(r,f),c=n.add(l,c),l=n.sub(p,c),c=n.add(p,c),c=n.mul(l,c),l=n.mul(m,l),h=n.mul(r,h),f=n.mul(e,f),m=n.sub(d,f),m=n.mul(e,m),m=n.add(m,h),h=n.add(d,d),d=n.add(h,d),d=n.add(d,f),d=n.mul(d,m),c=n.add(c,d),f=n.mul(a,o),f=n.add(f,f),d=n.mul(f,m),l=n.sub(l,d),h=n.mul(f,p),h=n.add(h,h),h=n.add(h,h),new u(l,c,h)}add(e){l(e);const{px:i,py:r,pz:s}=this,{px:a,py:o,pz:c}=e;let h=n.ZERO,d=n.ZERO,p=n.ZERO;const f=t.a,m=n.mul(t.b,dx);let g=n.mul(i,a),v=n.mul(r,o),y=n.mul(s,c),b=n.add(i,r),w=n.add(a,o);b=n.mul(b,w),w=n.add(g,v),b=n.sub(b,w),w=n.add(i,s);let x=n.add(a,c);return w=n.mul(w,x),x=n.add(g,y),w=n.sub(w,x),x=n.add(r,s),h=n.add(o,c),x=n.mul(x,h),h=n.add(v,y),x=n.sub(x,h),p=n.mul(f,w),h=n.mul(m,y),p=n.add(h,p),h=n.sub(v,p),p=n.add(v,p),d=n.mul(h,p),v=n.add(g,g),v=n.add(v,g),y=n.mul(f,y),w=n.mul(m,w),v=n.add(v,y),y=n.sub(g,y),y=n.mul(f,y),w=n.add(w,y),g=n.mul(v,w),d=n.add(d,g),g=n.mul(x,w),h=n.mul(b,h),h=n.sub(h,g),g=n.mul(b,v),p=n.mul(x,p),p=n.add(p,g),new u(h,d,p)}subtract(e){return this.add(e.negate())}is0(){return this.equals(u.ZERO)}wNAF(e){return p.wNAFCached(this,e,u.normalizeZ)}multiplyUnsafe(e){const{endo:i,n:r}=t;mw("scalar",e,hx,r);const s=u.ZERO;if(e===hx)return s;if(this.is0()||e===ux)return this;if(!i||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,e,u.normalizeZ);let{k1neg:a,k1:o,k2neg:l,k2:c}=i.splitScalar(e),h=s,d=s,f=this;for(;o>hx||c>hx;)o&ux&&(h=h.add(f)),c&ux&&(d=d.add(f)),f=f.double(),o>>=ux,c>>=ux;return a&&(h=h.negate()),l&&(d=d.negate()),d=new u(n.mul(d.px,i.beta),d.py,d.pz),h.add(d)}multiply(e){const{endo:i,n:r}=t;let s,a;if(mw("scalar",e,ux,r),i){const{k1neg:t,k1:r,k2neg:o,k2:l}=i.splitScalar(e);let{p:c,f:h}=this.wNAF(r),{p:d,f:f}=this.wNAF(l);c=p.constTimeNegate(t,c),d=p.constTimeNegate(o,d),d=new u(n.mul(d.px,i.beta),d.py,d.pz),s=c.add(d),a=h.add(f)}else{const{p:t,f:n}=this.wNAF(e);s=t,a=n}return u.normalizeZ([s,a])[0]}multiplyAndAddUnsafe(e,t,n){const i=u.BASE,r=(e,t)=>t!==hx&&t!==ux&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t),s=r(this,t).add(r(e,n));return s.is0()?void 0:s}toAffine(e){return c(this,e)}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===ux)return!0;if(n)return n(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===ux?this:n?n(u,this):this.multiplyUnsafe(t.h)}toRawBytes(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Yb("isCompressed",e),this.assertValidity(),r(u,this,e)}toHex(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Yb("isCompressed",e),Xb(this.toRawBytes(e))}}u.BASE=new u(t.Gx,t.Gy,n.ONE),u.ZERO=new u(n.ZERO,n.ONE,n.ZERO);const d=t.nBitLength,p=function(e,t){return{constTimeNegate:Ww,hasPrecomputes:e=>1!==Qw(e),unsafeLadder(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ZERO,r=t;for(;n>Vw;)n&Hw&&(i=i.add(r)),r=r.double(),n>>=Hw;return i},precomputeWindow(e,n){const{windows:i,windowSize:r}=qw(n,t),s=[];let a=e,o=a;for(let t=0;t<i;t++){o=a,s.push(o);for(let e=1;e<r;e++)o=o.add(a),s.push(o);a=o.double()}return s},wNAF(n,i,r){const{windows:s,windowSize:a}=qw(n,t);let o=e.ZERO,l=e.BASE;const c=BigInt(2**n-1),h=2**n,u=BigInt(n);for(let e=0;e<s;e++){const t=e*a;let n=Number(r&c);r>>=u,n>a&&(n-=h,r+=Hw);const s=t,d=t+Math.abs(n)-1,p=e%2!==0,f=n<0;0===n?l=l.add(Ww(p,i[s])):o=o.add(Ww(f,i[d]))}return{p:o,f:l}},wNAFUnsafe(n,i,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.ZERO;const{windows:a,windowSize:o}=qw(n,t),l=BigInt(2**n-1),c=2**n,h=BigInt(n);for(let e=0;e<a;e++){const t=e*o;if(r===Vw)break;let n=Number(r&l);if(r>>=h,n>o&&(n-=c,r+=Hw),0===n)continue;let a=i[t+Math.abs(n)-1];n<0&&(a=a.negate()),s=s.add(a)}return s},getPrecomputes(e,t,n){let i=Kw.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&Kw.set(t,n(i))),i},wNAFCached(e,t,n){const i=Qw(e);return this.wNAF(i,this.getPrecomputes(i,e,n),t)},wNAFCachedUnsafe(e,t,n,i){const r=Qw(e);return 1===r?this.unsafeLadder(e,t,i):this.wNAFUnsafe(r,this.getPrecomputes(r,e,n),t,i)},setWindowSize(e,n){Gw(n,t),Yw.set(e,n),Kw.delete(e)}}}(u,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:u,normPrivateKeyToScalar:o,weierstrassEquation:a,isWithinCurveOrder:function(e){return fw(e,ux,t.n)}}}function fx(e){const t=function(e){const t=Zw(e);return Ew(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:n,n:i}=t,r=n.BYTES+1,s=2*n.BYTES+1;function a(e){return Ow(e,i)}function o(e){return Rw(e,i)}const{ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:h,isWithinCurveOrder:u}=px({...t,toBytes(e,t,i){const r=t.toAffine(),s=n.toBytes(r.x),a=dw;return Yb("isCompressed",i),i?a(Uint8Array.from([t.hasEvenY()?2:3]),s):a(Uint8Array.from([4]),s,n.toBytes(r.y))},fromBytes(e){const t=e.length,i=e[0],a=e.subarray(1);if(t!==r||2!==i&&3!==i){if(t===s&&4===i){return{x:n.fromBytes(a.subarray(0,n.BYTES)),y:n.fromBytes(a.subarray(n.BYTES,2*n.BYTES))}}throw new Error("invalid Point, expected length of "+r+", or uncompressed "+s+", got "+t)}{const e=ow(a);if(!fw(e,ux,n.ORDER))throw new Error("Point is not on curve");const t=h(e);let r;try{r=n.sqrt(t)}catch(ge){const t=ge instanceof Error?": "+ge.message:"";throw new Error("Point is not on curve"+t)}return 1===(1&i)!==((r&ux)===ux)&&(r=n.neg(r)),{x:e,y:r}}}}),d=e=>Xb(cw(e,t.nByteLength));function p(e){return e>i>>ux}const f=(e,t,n)=>ow(e.slice(t,n));class m{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=uw("compactSignature",e,2*n),new m(f(e,0,n),f(e,n,2*n))}static fromDER(e){const{r:t,s:n}=cx.toSig(uw("DER",e));return new m(t,n)}assertValidity(){mw("r",this.r,ux,i),mw("s",this.s,ux,i)}addRecoveryBit(e){return new m(this.r,this.s,e)}recoverPublicKey(e){const{r:i,s:r,recovery:s}=this,c=b(uw("msgHash",e));if(null==s||![0,1,2,3].includes(s))throw new Error("recovery id invalid");const h=2===s||3===s?i+t.n:i;if(h>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const u=0===(1&s)?"02":"03",p=l.fromHex(u+d(h)),f=o(h),m=a(-c*f),g=a(r*f),v=l.BASE.multiplyAndAddUnsafe(p,m,g);if(!v)throw new Error("point at infinify");return v.assertValidity(),v}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return aw(this.toDERHex())}toDERHex(){return cx.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return aw(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const g={isValidPrivateKey(e){try{return c(e),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{const e=jw(t.n);return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.length,r=Fw(t),s=jw(t);if(i<16||i<s||i>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+i);const a=Ow(n?lw(e):ow(e),t-_w)+_w;return n?hw(a,r):cw(a,r)}(t.randomBytes(e),t.n)},precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function v(e){const t=qb(e),n="string"==typeof e,i=(t||n)&&e.length;return t?i===r||i===s:n?i===2*r||i===2*s:e instanceof l}const y=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const n=ow(e),i=8*e.length-t.nBitLength;return i>0?n>>BigInt(i):n},b=t.bits2int_modN||function(e){return a(y(e))},w=vw(t.nBitLength);function x(e){return mw("num < 2^"+t.nBitLength,e,hx,w),cw(e,t.nByteLength)}function E(e,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C;if(["recovered","canonical"].some((e=>e in r)))throw new Error("sign() legacy options not supported");const{hash:s,randomBytes:h}=t;let{lowS:d,prehash:f,extraEntropy:g}=r;null==d&&(d=!0),e=uw("msgHash",e),sx(r),f&&(e=uw("prehashed msgHash",s(e)));const v=b(e),w=c(i),E=[x(w),x(v)];if(null!=g&&!1!==g){const e=!0===g?h(n.BYTES):g;E.push(uw("extraEntropy",e))}const A=dw(...E),S=v;return{seed:A,k2sig:function(e){const t=y(e);if(!u(t))return;const n=o(t),i=l.BASE.multiply(t).toAffine(),r=a(i.x);if(r===hx)return;const s=a(n*a(S+r*w));if(s===hx)return;let c=(i.x===r?0:2)|Number(i.y&ux),h=s;return d&&p(s)&&(h=function(e){return p(e)?a(-e):e}(s),c^=1),new m(r,h,c)}}}const C={lowS:t.lowS,prehash:!1},A={lowS:t.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return l.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(v(e))throw new Error("first arg must be private key");if(!v(t))throw new Error("second arg must be public key");return l.fromHex(t).multiply(c(e)).toRawBytes(n)},sign:function(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C;const{seed:r,k2sig:s}=E(e,n,i),a=t;return ww(a.hash.outputLen,a.nByteLength,a.hmac)(r,s)},verify:function(e,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:A;const s=e;n=uw("msgHash",n),i=uw("publicKey",i);const{lowS:c,prehash:h,format:u}=r;if(sx(r),"strict"in r)throw new Error("options.strict was renamed to lowS");if(void 0!==u&&"compact"!==u&&"der"!==u)throw new Error("format must be compact or der");const d="string"==typeof s||qb(s),p=!d&&!u&&"object"==typeof s&&null!==s&&"bigint"==typeof s.r&&"bigint"==typeof s.s;if(!d&&!p)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let f,g;try{if(p&&(f=new m(s.r,s.s)),d){try{"compact"!==u&&(f=m.fromDER(s))}catch(Ge){if(!(Ge instanceof cx.Err))throw Ge}!f&&"der"!==u&&(f=m.fromCompact(s))}g=l.fromHex(i)}catch{return!1}if(!f||c&&f.hasHighS())return!1;h&&(n=t.hash(n));const{r:v,s:y}=f,w=b(n),x=o(y),E=a(w*x),C=a(v*x),S=l.BASE.multiplyAndAddUnsafe(g,E,C)?.toAffine();return!!S&&a(S.x)===v},ProjectivePoint:l,Signature:m,utils:g}}function mx(e){return{hash:e,hmac:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return Lb(e,t,function(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];Py(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,i=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,i),i+=e.length}return t}(...i))},randomBytes:Wy}}BigInt(4);const gx=zw(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"));!function(e,t){const n=t=>fx({...e,...mx(t)});n(t)}({a:gx.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:gx,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Vb);Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function vx(e){return e.includes(":")}function yx(e){return vx(e)?e.split(":")[0]:e}const bx={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function wx(e,t){const{message:n,code:i}=bx[e];return{message:t?`${n} ${t}`:n,code:i}}function xx(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function Ex(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}var Cx=n(6177),Ax=n.n(Cx),Sx=Object.defineProperty,_x=Object.defineProperties,Tx=Object.getOwnPropertyDescriptors,Px=Object.getOwnPropertySymbols,Mx=Object.prototype.hasOwnProperty,Nx=Object.prototype.propertyIsEnumerable,Ix=(e,t,n)=>t in e?Sx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ox=(e,t)=>{for(var n in t||(t={}))Mx.call(t,n)&&Ix(e,n,t[n]);if(Px)for(var n of Px(t))Nx.call(t,n)&&Ix(e,n,t[n]);return e},Dx=(e,t)=>_x(e,Tx(t));const Lx={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};class Rx{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.url=e,this.disableProviderPing=t,this.events=new v.EventEmitter,this.isAvailable=!1,this.registering=!1,!Nd(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url;await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=(0,Y.h)(e),n=await(await Ax()(this.url,Dx(Ox({},Lx),{body:t}))).json();this.onPayload({data:n})}catch(t){this.onError(e.id,t)}}async register(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.url;if(!Nd(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise(((e,t)=>{this.events.once("register_error",(e=>{this.resetMaxListeners(),t(e)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return t(new Error("HTTP connection is missing or invalid"));e()}))}))}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=(0,Y.h)({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ax()(e,Dx(Ox({},Lx),{body:t}))}this.onOpen()}catch(t){const e=this.parseError(t);throw this.events.emit("register_error",e),this.onClose(),e}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?(0,Y.j)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),i=Ad(e,n.message||n.toString());this.events.emit("payload",i)}parseError(e){return yd(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.url,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}const kx="error",Bx="wc@2:universal_provider:",Ux="https://rpc.walletconnect.org/v1/",zx="generic",Fx=`${Ux}bundler`,jx="default_chain_changed";function Vx(){}function Hx(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function Wx(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Gx(e){return"object"==typeof e&&null!==e}function qx(e){return Object.getOwnPropertySymbols(e).filter((t=>Object.prototype.propertyIsEnumerable.call(e,t)))}function Kx(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Yx="[object RegExp]",Qx="[object String]",Xx="[object Number]",Zx="[object Boolean]",Jx="[object Arguments]",$x="[object Symbol]",eE="[object Date]",tE="[object Map]",nE="[object Set]",iE="[object Array]",rE="[object ArrayBuffer]",sE="[object Object]",aE="[object DataView]",oE="[object Uint8Array]",lE="[object Uint8ClampedArray]",cE="[object Uint16Array]",hE="[object Uint32Array]",uE="[object Int8Array]",dE="[object Int16Array]",pE="[object Int32Array]",fE="[object Float32Array]",mE="[object Float64Array]";function gE(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const s=r?.(e,t,n,i);if(null!=s)return s;if(Hx(e))return e;if(i.has(e))return i.get(e);if(Array.isArray(e)){const t=new Array(e.length);i.set(e,t);for(let s=0;s<e.length;s++)t[s]=gE(e[s],s,n,i,r);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;i.set(e,t);for(const[s,a]of e)t.set(s,gE(a,s,n,i,r));return t}if(e instanceof Set){const t=new Set;i.set(e,t);for(const s of e)t.add(gE(s,void 0,n,i,r));return t}if(typeof Buffer<"u"&&Buffer.isBuffer(e))return e.subarray();if(Wx(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);i.set(e,t);for(let s=0;s<e.length;s++)t[s]=gE(e[s],s,n,i,r);return t}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return i.set(e,t),vE(t,e,n,i,r),t}if(typeof File<"u"&&e instanceof File){const t=new File([e],e.name,{type:e.type});return i.set(e,t),vE(t,e,n,i,r),t}if(e instanceof Blob){const t=new Blob([e],{type:e.type});return i.set(e,t),vE(t,e,n,i,r),t}if(e instanceof Error){const t=new e.constructor;return i.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,vE(t,e,n,i,r),t}if("object"==typeof e&&function(e){switch(Kx(e)){case Jx:case iE:case rE:case aE:case Zx:case eE:case fE:case mE:case uE:case dE:case pE:case tE:case Xx:case sE:case Yx:case nE:case Qx:case $x:case oE:case lE:case cE:case hE:return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return i.set(e,t),vE(t,e,n,i,r),t}return e}function vE(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;const s=[...Object.keys(t),...qx(t)];for(let a=0;a<s.length;a++){const o=s[a],l=Object.getOwnPropertyDescriptor(e,o);(null==l||l.writable)&&(e[o]=gE(t[o],o,n,i,r))}}function yE(e,t){return function(e,t){return gE(e,void 0,e,new Map,t)}(e,((n,i,r,s)=>{const a=t?.(n,i,r,s);if(null!=a)return a;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case Xx:case Qx:case Zx:{const t=new e.constructor(e?.valueOf());return vE(t,e),t}case Jx:{const t={};return vE(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}}))}function bE(e){return yE(e)}function wE(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===Kx(e)}function xE(e){return Wx(e)}function EE(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){const t=e[Symbol.toStringTag];return!(null==t||!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable)&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function CE(e,t,n,i){if(Hx(e)&&(e=Object(e)),null==t||"object"!=typeof t)return e;if(i.has(t))return function(e){if(Hx(e))return e;if(Array.isArray(e)||Wx(e)||e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);const t=Object.getPrototypeOf(e),n=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new n(e);if(e instanceof RegExp){const t=new n(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new n(e.buffer.slice(0));if(e instanceof Error){const t=new n(e.message);return t.stack=e.stack,t.name=e.name,t.cause=e.cause,t}if(typeof File<"u"&&e instanceof File)return new n([e],e.name,{type:e.type,lastModified:e.lastModified});if("object"==typeof e){const n=Object.create(t);return Object.assign(n,e)}return e}(i.get(t));if(i.set(t,e),Array.isArray(t)){t=t.slice();for(let e=0;e<t.length;e++)t[e]=t[e]??void 0}const r=[...Object.keys(t),...qx(t)];for(let s=0;s<r.length;s++){const a=r[s];let o=t[a],l=e[a];if(wE(o)&&(o={...o}),wE(l)&&(l={...l}),typeof Buffer<"u"&&Buffer.isBuffer(o)&&(o=bE(o)),Array.isArray(o))if("object"==typeof l&&null!=l){const e=[],t=Reflect.ownKeys(l);for(let n=0;n<t.length;n++){const i=t[n];e[i]=l[i]}l=e}else l=[];const c=n(l,o,a,e,t,i);null!=c?e[a]=c:Array.isArray(o)||Gx(l)&&Gx(o)?e[a]=CE(l,o,n,i):null==l&&EE(o)?e[a]=CE({},o,n,i):null==l&&xE(o)?e[a]=bE(o):(void 0===l||void 0!==o)&&(e[a]=o)}return e}function AE(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const r=n.slice(0,-1),s=n[n.length-1];let a=e;for(let o=0;o<r.length;o++)a=CE(a,r[o],s,new Map);return a}(e,...n,Vx)}var SE=Object.defineProperty,_E=Object.defineProperties,TE=Object.getOwnPropertyDescriptors,PE=Object.getOwnPropertySymbols,ME=Object.prototype.hasOwnProperty,NE=Object.prototype.propertyIsEnumerable,IE=(e,t,n)=>t in e?SE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,OE=(e,t)=>{for(var n in t||(t={}))ME.call(t,n)&&IE(e,n,t[n]);if(PE)for(var n of PE(t))NE.call(t,n)&&IE(e,n,t[n]);return e},DE=(e,t)=>_E(e,TE(t));function LE(e,t,n){var i;const r=Sy(e);return(null==(i=t.rpcMap)?void 0:i[r.reference])||`${Ux}?chainId=${r.namespace}:${r.reference}&projectId=${n}`}function RE(e){return e.includes(":")?e.split(":")[1]:e}function kE(e){return e.map((e=>`${e.split(":")[0]}:${e.split(":")[1]}`))}function BE(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return AE(UE(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),UE(e))}function UE(e){var t,n,i,r;const s={};if(!Ex(e))return s;for(const[a,o]of Object.entries(e)){const e=vx(a)?[a]:o.chains,l=o.methods||[],c=o.events||[],h=o.rpcMap||{},u=yx(a);s[u]=DE(OE(OE({},s[u]),o),{chains:_y(e,null==(t=s[u])?void 0:t.chains),methods:_y(l,null==(n=s[u])?void 0:n.methods),events:_y(c,null==(i=s[u])?void 0:i.events),rpcMap:OE(OE({},h),null==(r=s[u])?void 0:r.rpcMap)})}return s}function zE(e){return e.includes(":")?e.split(":")[2]:e}function FE(e){const t={};for(const[n,i]of Object.entries(e)){const e=i.methods||[],r=i.events||[],s=i.accounts||[],a=vx(n)?[n]:i.chains?i.chains:kE(i.accounts);t[n]={chains:a,methods:e,events:r,accounts:s}}return t}function jE(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))}const VE={},HE=e=>VE[e],WE=(e,t)=>{VE[e]=t};var GE=Object.defineProperty,qE=(e,t,n)=>((e,t,n)=>t in e?GE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class KE{constructor(e){qE(this,"name","polkadot"),qE(this,"client"),qE(this,"httpProviders"),qE(this,"events"),qE(this,"namespace"),qE(this,"chainId"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e&&e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2]))||[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var n;const i=RE(t);e[i]=this.createHttpProvider(i,null==(n=this.namespace.rpcMap)?void 0:n[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||LE(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Bd(new Rx(n,HE("disableProviderPing")))}}var YE=Object.defineProperty,QE=Object.defineProperties,XE=Object.getOwnPropertyDescriptors,ZE=Object.getOwnPropertySymbols,JE=Object.prototype.hasOwnProperty,$E=Object.prototype.propertyIsEnumerable,eC=(e,t,n)=>t in e?YE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,tC=(e,t)=>{for(var n in t||(t={}))JE.call(t,n)&&eC(e,n,t[n]);if(ZE)for(var n of ZE(t))$E.call(t,n)&&eC(e,n,t[n]);return e},nC=(e,t)=>QE(e,XE(t)),iC=(e,t,n)=>eC(e,"symbol"!=typeof t?t+"":t,n);class rC{constructor(e){iC(this,"name","eip155"),iC(this,"client"),iC(this,"chainId"),iC(this,"namespace"),iC(this,"httpProviders"),iC(this,"events"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(jx,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const n=t||LE(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Bd(new Rx(n,HE("disableProviderPing")))}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var n;const i=parseInt(RE(t));e[i]=this.createHttpProvider(i,null==(n=this.namespace.rpcMap)?void 0:n[t])})),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,n;let i=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0";i=i.startsWith("0x")?i:`0x${i}`;const r=parseInt(i,16);if(this.isChainApproved(r))this.setDefaultChain(`${r}`);else{if(!this.namespace.methods.includes("wallet_switchEthereumChain"))throw new Error(`Failed to switch to chain 'eip155:${r}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:null==(n=this.namespace.chains)?void 0:n[0]}),this.setDefaultChain(`${r}`)}return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,n,i;const r=null==(n=null==(t=e.request)?void 0:t.params)?void 0:n[0];if(!r)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const s=this.client.session.get(e.topic),a=(null==(i=s?.sessionProperties)?void 0:i.capabilities)||{};if(null!=a&&a[r])return a?.[r];const o=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:nC(tC({},s.sessionProperties||{}),{capabilities:nC(tC({},a||{}),{[r]:o})})})}catch(le){console.warn("Failed to update session with capabilities",le)}return o}async getCallStatus(e){var t,n;const i=this.client.session.get(e.topic),r=null==(t=i.sessionProperties)?void 0:t.bundler_name;if(r){const t=this.getBundlerUrl(e.chainId,r);try{return await this.getUserOperationReceipt(t,e)}catch(a){console.warn("Failed to fetch call status from bundler",a,t)}}const s=null==(n=i.sessionProperties)?void 0:n.bundler_url;if(s)try{return await this.getUserOperationReceipt(s,e)}catch(J){console.warn("Failed to fetch call status from custom bundler",J,s)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var n;const i=new URL(e),r=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ed("eth_getUserOperationReceipt",[null==(n=t.request.params)?void 0:n[0]]))});if(!r.ok)throw new Error(`Failed to fetch user operation receipt - ${r.status}`);return await r.json()}getBundlerUrl(e,t){return`${Fx}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var sC=Object.defineProperty,aC=(e,t,n)=>((e,t,n)=>t in e?sC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class oC{constructor(e){aC(this,"name","solana"),aC(this,"client"),aC(this,"httpProviders"),aC(this,"events"),aC(this,"namespace"),aC(this,"chainId"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var n;const i=RE(t);e[i]=this.createHttpProvider(i,null==(n=this.namespace.rpcMap)?void 0:n[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||LE(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Bd(new Rx(n,HE("disableProviderPing")))}}var lC=Object.defineProperty,cC=(e,t,n)=>((e,t,n)=>t in e?lC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class hC{constructor(e){cC(this,"name","cosmos"),cC(this,"client"),cC(this,"httpProviders"),cC(this,"events"),cC(this,"namespace"),cC(this,"chainId"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var n;const i=RE(t);e[i]=this.createHttpProvider(i,null==(n=this.namespace.rpcMap)?void 0:n[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||LE(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Bd(new Rx(n,HE("disableProviderPing")))}}var uC=Object.defineProperty,dC=(e,t,n)=>((e,t,n)=>t in e?uC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class pC{constructor(e){dC(this,"name","algorand"),dC(this,"client"),dC(this,"httpProviders"),dC(this,"events"),dC(this,"namespace"),dC(this,"chainId"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const n=t||LE(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(jx,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var n;e[t]=this.createHttpProvider(t,null==(n=this.namespace.rpcMap)?void 0:n[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||LE(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Bd(new Rx(n,HE("disableProviderPing")))}}var fC=Object.defineProperty,mC=(e,t,n)=>((e,t,n)=>t in e?fC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class gC{constructor(e){mC(this,"name","cip34"),mC(this,"client"),mC(this,"httpProviders"),mC(this,"events"),mC(this,"namespace"),mC(this,"chainId"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{const n=this.getCardanoRPCUrl(t),i=RE(t);e[i]=this.createHttpProvider(i,n)})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Bd(new Rx(n,HE("disableProviderPing")))}}var vC=Object.defineProperty,yC=(e,t,n)=>((e,t,n)=>t in e?vC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class bC{constructor(e){yC(this,"name","elrond"),yC(this,"client"),yC(this,"httpProviders"),yC(this,"events"),yC(this,"namespace"),yC(this,"chainId"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var n;const i=RE(t);e[i]=this.createHttpProvider(i,null==(n=this.namespace.rpcMap)?void 0:n[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||LE(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Bd(new Rx(n,HE("disableProviderPing")))}}var wC=Object.defineProperty,xC=(e,t,n)=>((e,t,n)=>t in e?wC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class EC{constructor(e){xC(this,"name","multiversx"),xC(this,"client"),xC(this,"httpProviders"),xC(this,"events"),xC(this,"namespace"),xC(this,"chainId"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var n;const i=RE(t);e[i]=this.createHttpProvider(i,null==(n=this.namespace.rpcMap)?void 0:n[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||LE(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Bd(new Rx(n,HE("disableProviderPing")))}}var CC=Object.defineProperty,AC=(e,t,n)=>((e,t,n)=>t in e?CC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class SC{constructor(e){AC(this,"name","near"),AC(this,"client"),AC(this,"httpProviders"),AC(this,"events"),AC(this,"namespace"),AC(this,"chainId"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||LE(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(jx,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e&&e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2]))||[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{var n;e[t]=this.createHttpProvider(t,null==(n=this.namespace.rpcMap)?void 0:n[t])})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||LE(e,this.namespace);return typeof n>"u"?void 0:new Bd(new Rx(n,HE("disableProviderPing")))}}var _C=Object.defineProperty,TC=(e,t,n)=>((e,t,n)=>t in e?_C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class PC{constructor(e){TC(this,"name","tezos"),TC(this,"client"),TC(this,"httpProviders"),TC(this,"events"),TC(this,"namespace"),TC(this,"chainId"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||LE(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(jx,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e&&e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2]))||[]}createHttpProviders(){const e={};return this.namespace.chains.forEach((t=>{e[t]=this.createHttpProvider(t)})),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||LE(e,this.namespace);return typeof n>"u"?void 0:new Bd(new Rx(n))}}var MC=Object.defineProperty,NC=(e,t,n)=>((e,t,n)=>t in e?MC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class IC{constructor(e){NC(this,"name",zx),NC(this,"client"),NC(this,"httpProviders"),NC(this,"events"),NC(this,"namespace"),NC(this,"chainId"),this.namespace=e.namespace,this.events=HE("events"),this.client=HE("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jx,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter((e=>e.split(":")[1]===this.chainId.toString())).map((e=>e.split(":")[2])))]:[]}createHttpProviders(){var e,t;const n={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach((e=>{const t=Sy(e);n[`${t.namespace}:${t.reference}`]=this.createHttpProvider(e)})),n}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||LE(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Bd(new Rx(n,HE("disableProviderPing")))}}var OC=Object.defineProperty,DC=Object.defineProperties,LC=Object.getOwnPropertyDescriptors,RC=Object.getOwnPropertySymbols,kC=Object.prototype.hasOwnProperty,BC=Object.prototype.propertyIsEnumerable,UC=(e,t,n)=>t in e?OC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zC=(e,t)=>{for(var n in t||(t={}))kC.call(t,n)&&UC(e,n,t[n]);if(RC)for(var n of RC(t))BC.call(t,n)&&UC(e,n,t[n]);return e},FC=(e,t)=>DC(e,LC(t)),jC=(e,t,n)=>UC(e,"symbol"!=typeof t?t+"":t,n);class VC{constructor(e){jC(this,"client"),jC(this,"namespaces"),jC(this,"optionalNamespaces"),jC(this,"sessionProperties"),jC(this,"scopedProperties"),jC(this,"events",new(y())),jC(this,"rpcProviders",{}),jC(this,"session"),jC(this,"providerOpts"),jC(this,"logger"),jC(this,"uri"),jC(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:(0,ie.h6)((0,ie.iP)({level:e?.logger||kx})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const t=new VC(e);return await t.initialize(),t}async request(e,t,n){const[i,r]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:zC({},e),chainId:`${i}:${r}`,topic:this.session.topic,expiry:n})}sendAsync(e,t,n,i){const r=(new Date).getTime();this.request(e,n,i).then((e=>t(null,Cd(r,e)))).catch((e=>t(e,void 0)))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:wx("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:i}=await this.client.authenticate(e,t);n&&(this.uri=n,this.events.emit("display_uri",n));const r=await i();if(this.session=r.session,this.session){const e=FE(this.session.namespaces);this.namespaces=BE(this.namespaces,e),await this.persist("namespaces",this.namespaces),this.onConnect()}return r}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const i=await n();this.session=i;const r=FE(i.namespaces);return this.namespaces=BE(this.namespaces,r),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[n,i]=this.validateChain(e),r=this.getProvider(n);r.name===zx?r.setDefaultChain(`${n}:${i}`,t):r.setDefaultChain(i,t)}catch(we){if(!/Please call connect/.test(we.message))throw we}}async cleanupPendingPairings(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(xx(t)){for(const n of t)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await Cy.init({core:this.providerOpts.core,logger:this.providerOpts.logger||kx,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(we){throw this.logger.error("Failed to get session",we),new Error(`The provided session: ${null==(t=null==(e=this.providerOpts)?void 0:e.session)?void 0:t.topic} doesn't exist in the Sign client`)}else{const e=this.client.session.getAll();this.session=e[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map((e=>yx(e))))];WE("client",this.client),WE("events",this.events),WE("disableProviderPing",this.disableProviderPing),e.forEach((e=>{if(!this.session)return;const t=function(e,t){const n=Object.keys(t.namespaces).filter((t=>t.includes(e)));if(!n.length)return[];const i=[];return n.forEach((e=>{const n=t.namespaces[e].accounts;i.push(...n)})),i}(e,this.session),n=kE(t),i=BE(this.namespaces,this.optionalNamespaces),r=FC(zC({},i[e]),{accounts:t,chains:n});switch(e){case"eip155":this.rpcProviders[e]=new rC({namespace:r});break;case"algorand":this.rpcProviders[e]=new pC({namespace:r});break;case"solana":this.rpcProviders[e]=new oC({namespace:r});break;case"cosmos":this.rpcProviders[e]=new hC({namespace:r});break;case"polkadot":this.rpcProviders[e]=new KE({namespace:r});break;case"cip34":this.rpcProviders[e]=new gC({namespace:r});break;case"elrond":this.rpcProviders[e]=new bC({namespace:r});break;case"multiversx":this.rpcProviders[e]=new EC({namespace:r});break;case"near":this.rpcProviders[e]=new SC({namespace:r});break;case"tezos":this.rpcProviders[e]=new PC({namespace:r});break;default:this.rpcProviders[zx]?this.rpcProviders[zx].updateNamespace(r):this.rpcProviders[zx]=new IC({namespace:r})}}))}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",(e=>{var t;const{topic:n}=e;n===(null==(t=this.session)?void 0:t.topic)&&this.events.emit("session_ping",e)})),this.client.on("session_event",(e=>{var t;const{params:n,topic:i}=e;if(i!==(null==(t=this.session)?void 0:t.topic))return;const{event:r}=n;if("accountsChanged"===r.name){const e=r.data;e&&xx(e)&&this.events.emit("accountsChanged",e.map(zE))}else if("chainChanged"===r.name){const e=n.chainId,t=n.event.data,i=yx(e),r=jE(e)!==jE(t)?`${i}:${jE(t)}`:e;this.onChainChanged(r)}else this.events.emit(r.name,r.data);this.events.emit("session_event",e)})),this.client.on("session_update",(e=>{let{topic:t,params:n}=e;var i,r;if(t!==(null==(i=this.session)?void 0:i.topic))return;const{namespaces:s}=n,a=null==(r=this.client)?void 0:r.session.get(t);this.session=FC(zC({},a),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:n})})),this.client.on("session_delete",(async e=>{var t;e.topic===(null==(t=this.session)?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",FC(zC({},wx("USER_DISCONNECTED")),{data:e.topic})))})),this.on(jx,(e=>{this.onChainChanged(e,!0)}))}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[zx]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach((e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])}))}setNamespaces(e){const{namespaces:t,optionalNamespaces:n,sessionProperties:i,scopedProperties:r}=e;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=i,this.scopedProperties=r}validateChain(e){const[t,n]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map((e=>yx(e))).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const i=yx(Object.keys(this.namespaces)[0]);return[i,this.rpcProviders[i].getDefaultChain()]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.namespaces)return;const[n,i]=this.validateChain(e);if(!i)return;this.updateNamespaceChain(n,i),this.events.emit("chainChanged",i);const r=this.getProvider(n).getDefaultChain();t||this.getProvider(n).setDefaultChain(i),this.emitAccountsChangedOnChainChange({namespace:n,previousChainId:r,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange(e){let{namespace:t,previousChainId:n,newChainId:i}=e;var r,s;try{if(n===i)return;const e=null==(s=null==(r=this.session)?void 0:r.namespaces[t])?void 0:s.accounts;if(!e)return;const a=e.filter((e=>e.includes(`${i}:`))).map(zE);if(!xx(a))return;this.events.emit("accountsChanged",a)}catch(a){this.logger.warn("Failed to emit accountsChanged on chain change",a)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${t}`,i={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=t):this.namespaces[n]=i}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var n;const i=(null==(n=this.session)?void 0:n.topic)||"";await this.client.core.storage.setItem(`${Bx}/${e}${i}`,t)}async getFromStore(e){var t;const n=(null==(t=this.session)?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${Bx}/${e}${n}`)}async deleteFromStore(e){var t;const n=(null==(t=this.session)?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${Bx}/${e}${n}`)}async cleanupStorage(){var e;try{if((null==(e=this.client)?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const e of t)e.startsWith(Bx)&&await this.client.core.storage.removeItem(e)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}}},63206:(e,t,n)=>{"use strict";n.d(t,{n:()=>y});var i=n(97965),r=n(43028),s=n(30751),a=n(22017),o=n(36220),l=n(48604),c=n(3458),h=n(67962),u=n(84117);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"undefined"!==typeof t.size&&(0,h.Sl)(e,{size:t.size});const n=(0,u.My)(e,t);return(0,h.uU)(n,t)}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("undefined"!==typeof t.size&&((0,h.Sl)(n,{size:t.size}),n=(0,l.B)(n)),n.length>1||n[0]>1)throw new c.xO(n);return Boolean(n[0])}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"undefined"!==typeof t.size&&(0,h.Sl)(e,{size:t.size});const n=(0,u.My)(e,t);return(0,h.ME)(n,t)}function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;return"undefined"!==typeof t.size&&((0,h.Sl)(n,{size:t.size}),n=(0,l.B)(n,{dir:"right"})),(new TextDecoder).decode(n)}var g=n(37131),v=n(43479);function y(e,t){const n="string"===typeof t?(0,g.aT)(t):t,r=(0,s.l)(n);if(0===(0,a.E)(n)&&e.length>0)throw new i.O;if((0,a.E)(t)&&(0,a.E)(t)<32)throw new i.Iy({data:"string"===typeof t?t:(0,u.My)(t),params:e,size:(0,a.E)(t)});let o=0;const l=[];for(let i=0;i<e.length;++i){const t=e[i];r.setPosition(o);const[n,s]=b(r,t,{staticPosition:0});o+=s,l.push(n)}return l}function b(e,t,n){let{staticPosition:s}=n;const a=(0,v.k)(t.type);if(a){const[n,i]=a;return function(e,t,n){let{length:i,staticPosition:r}=n;if(!i){const n=r+f(e.readBytes(x)),i=n+w;e.setPosition(n);const s=f(e.readBytes(w)),a=E(t);let o=0;const l=[];for(let r=0;r<s;++r){e.setPosition(i+(a?32*r:o));const[n,s]=b(e,t,{staticPosition:i});o+=s,l.push(n)}return e.setPosition(r+32),[l,32]}if(E(t)){const n=r+f(e.readBytes(x)),s=[];for(let r=0;r<i;++r){e.setPosition(n+32*r);const[i]=b(e,t,{staticPosition:n});s.push(i)}return e.setPosition(r+32),[s,32]}let s=0;const a=[];for(let o=0;o<i;++o){const[n,i]=b(e,t,{staticPosition:r+s});s+=i,a.push(n)}return[a,s]}(e,{...t,type:i},{length:n,staticPosition:s})}if("tuple"===t.type)return function(e,t,n){let{staticPosition:i}=n;const r=0===t.components.length||t.components.some((e=>{let{name:t}=e;return!t})),s=r?[]:{};let a=0;if(E(t)){const n=i+f(e.readBytes(x));for(let i=0;i<t.components.length;++i){const o=t.components[i];e.setPosition(n+a);const[l,c]=b(e,o,{staticPosition:n});a+=c,s[r?i:o?.name]=l}return e.setPosition(i+32),[s,32]}for(let o=0;o<t.components.length;++o){const n=t.components[o],[l,c]=b(e,n,{staticPosition:i});s[r?o:n?.name]=l,a+=c}return[s,a]}(e,t,{staticPosition:s});if("address"===t.type)return function(e){const t=e.readBytes(32);return[(0,r.o)((0,u.My)((0,o.A1)(t,-20))),32]}(e);if("bool"===t.type)return function(e){return[p(e.readBytes(32),{size:32}),32]}(e);if(t.type.startsWith("bytes"))return function(e,t,n){let{staticPosition:i}=n;const[r,s]=t.type.split("bytes");if(!s){const t=f(e.readBytes(32));e.setPosition(i+t);const n=f(e.readBytes(32));if(0===n)return e.setPosition(i+32),["0x",32];const r=e.readBytes(n);return e.setPosition(i+32),[(0,u.My)(r),32]}const a=(0,u.My)(e.readBytes(Number.parseInt(s),32));return[a,32]}(e,t,{staticPosition:s});if(t.type.startsWith("uint")||t.type.startsWith("int"))return function(e,t){const n=t.type.startsWith("int"),i=Number.parseInt(t.type.split("int")[1]||"256"),r=e.readBytes(32);return[i>48?d(r,{signed:n}):f(r,{signed:n}),32]}(e,t);if("string"===t.type)return function(e,t){let{staticPosition:n}=t;const i=f(e.readBytes(32)),r=n+i;e.setPosition(r);const s=f(e.readBytes(32));if(0===s)return e.setPosition(n+32),["",32];const a=e.readBytes(s,32),o=m((0,l.B)(a));return e.setPosition(n+32),[o,32]}(e,{staticPosition:s});throw new i.j(t.type,{docsPath:"/docs/contract/decodeAbiParameters"})}const w=32,x=32;function E(e){const{type:t}=e;if("string"===t)return!0;if("bytes"===t)return!0;if(t.endsWith("[]"))return!0;if("tuple"===t)return e.components?.some(E);const n=(0,v.k)(e.type);return!(!n||!E({...e,type:n[1]}))}},63542:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var i=n(38993),r=n(76844),s=n(42661);const a=(0,i.BX)({message:"",variant:"info",open:!1}),o={state:a,subscribeKey:(e,t)=>(0,r.u$)(a,e,t),open(e,t){const{debug:n}=s.H.state,{shortMessage:i,longMessage:r}=e;n&&(a.message=i,a.variant=t,a.open=!0),r&&console.error("function"===typeof r?r():r)},close(){a.open=!1,a.message="",a.variant="info"}}},64034:(e,t,n)=>{"use strict";function i(e){return"string"===typeof e?{address:e,type:"json-rpc"}:e}n.d(t,{J:()=>i})},64564:(e,t,n)=>{"use strict";async function i(){const e=await fetch(...arguments);if(!e.ok){throw new Error(`HTTP status code: ${e.status}`,{cause:e})}return e}n.d(t,{Z:()=>r});class r{constructor(e){let{baseUrl:t,clientId:n}=e;this.baseUrl=t,this.clientId=n}async get(e){let{headers:t,signal:n,cache:r,...s}=e;const a=this.createUrl(s);return(await i(a,{method:"GET",headers:t,signal:n,cache:r})).json()}async getBlob(e){let{headers:t,signal:n,...r}=e;const s=this.createUrl(r);return(await i(s,{method:"GET",headers:t,signal:n})).blob()}async post(e){let{body:t,headers:n,signal:r,...s}=e;const a=this.createUrl(s);return(await i(a,{method:"POST",headers:n,body:t?JSON.stringify(t):void 0,signal:r})).json()}async put(e){let{body:t,headers:n,signal:r,...s}=e;const a=this.createUrl(s);return(await i(a,{method:"PUT",headers:n,body:t?JSON.stringify(t):void 0,signal:r})).json()}async delete(e){let{body:t,headers:n,signal:r,...s}=e;const a=this.createUrl(s);return(await i(a,{method:"DELETE",headers:n,body:t?JSON.stringify(t):void 0,signal:r})).json()}createUrl(e){let{path:t,params:n}=e;const i=new URL(t,this.baseUrl);return n&&Object.entries(n).forEach((e=>{let[t,n]=e;n&&i.searchParams.append(t,n)})),this.clientId&&i.searchParams.append("clientId",this.clientId),i}}},65043:(e,t,n)=>{"use strict";e.exports=n(44288)},65618:(e,t,n)=>{"use strict";n.d(t,{T:()=>m});var i=n(38993),r=n(84657),s=n(24657),a=n(64564),o=n(88861),l=n(595),c=n(15814),h=n(42661),u=n(7258);const d={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},p=s.w.getBlockchainApiUrl(),f=(0,i.BX)({clientId:null,api:new a.Z({baseUrl:p,clientId:null}),supportedChains:{http:[],ws:[]}}),m={state:f,async get(e){const{st:t,sv:n}=m.getSdkProperties(),i=h.H.state.projectId,r={...e.params||{},st:t,sv:n,projectId:i};return f.api.get({...e,params:r})},getSdkProperties(){const{sdkType:e,sdkVersion:t}=h.H.state;return{st:e||"unknown",sv:t||"unknown"}},async isNetworkSupported(e){if(!e)return!1;try{f.supportedChains.http.length||await m.getSupportedNetworks()}catch(t){return!1}return f.supportedChains.http.includes(e)},async getSupportedNetworks(){const e=await m.get({path:"v1/supported-chains"});return f.supportedChains=e,e},async fetchIdentity(e){let{address:t,caipNetworkId:n}=e;if(!await m.isNetworkSupported(n))return{avatar:"",name:""};const i=o.i.getIdentityFromCacheForAddress(t);if(i)return i;const r=await m.get({path:`/v1/identity/${t}`,params:{sender:c.W.state.activeCaipAddress?s.w.getPlainAddress(c.W.state.activeCaipAddress):void 0}});return o.i.updateIdentityCache({address:t,identity:r,timestamp:Date.now()}),r},async fetchTransactions(e){let{account:t,cursor:n,onramp:i,signal:r,cache:s,chainId:a}=e;return await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?m.get({path:`/v1/account/${t}/history`,params:{cursor:n,onramp:i,chainId:a},signal:r,cache:s}):{data:[],next:void 0}},async fetchSwapQuote(e){let{amount:t,userAddress:n,from:i,to:r,gasPrice:s}=e;return await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?m.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:n,from:i,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens(e){let{chainId:t}=e;return await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?m.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async fetchTokenPrice(e){let{addresses:t}=e;return await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:h.H.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]}},async fetchSwapAllowance(e){let{tokenAddress:t,userAddress:n}=e;return await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?m.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:n},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice(e){let{chainId:t}=e;const{st:n,sv:i}=m.getSdkProperties();if(!await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return m.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:n,sv:i}})},async generateSwapCalldata(e){let{amount:t,from:n,to:i,userAddress:s,disableEstimate:a}=e;if(!await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return f.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:r.oU.CONVERT_SLIPPAGE_TOLERANCE},projectId:h.H.state.projectId,from:n,to:i,userAddress:s,disableEstimate:a}})},async generateApproveCalldata(e){let{from:t,to:n,userAddress:i}=e;const{st:r,sv:s}=m.getSdkProperties();if(!await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return m.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:i,from:t,to:n,st:r,sv:s}})},async getBalance(e,t,n){const{st:i,sv:r}=m.getSdkProperties();if(!await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId))return u.P.showError("Token Balance Unavailable"),{balances:[]};const s=`${t}:${e}`,a=o.i.getBalanceCacheForCaipAddress(s);if(a)return a;const l=await m.get({path:`/v1/account/${e}/balance`,params:{currency:"usd",chainId:t,forceUpdate:n,st:i,sv:r}});return o.i.updateBalanceCache({caipAddress:s,balance:l,timestamp:Date.now()}),l},lookupEnsName:async e=>await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?m.get({path:`/v1/profile/account/${e}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]},async reverseLookupEnsName(e){let{address:t}=e;return await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?m.get({path:`/v1/profile/reverse/${t}`,params:{sender:l.U.state.address,apiVersion:"2"}}):[]},getEnsNameSuggestions:async e=>await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?m.get({path:`/v1/profile/suggestions/${e}`,params:{zone:"reown.id"}}):{suggestions:[]},async registerEnsName(e){let{coinType:t,address:n,message:i,signature:r}=e;return await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:"/v1/profile/account",body:{coin_type:t,address:n,message:i,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL(e){let{destinationWallets:t,partnerUserId:n,defaultNetwork:i,purchaseAmount:r,paymentAmount:s}=e;if(!await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId))return"";return(await f.api.post({path:"/v1/generators/onrampurl",params:{projectId:h.H.state.projectId},body:{destinationWallets:t,defaultNetwork:i,partnerUserId:n,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url},async getOnrampOptions(){if(!await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await m.get({path:"/v1/onramp/options"})}catch(e){return d}},async getOnrampQuote(e){let{purchaseCurrency:t,paymentCurrency:n,amount:i,network:r}=e;try{if(!await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId))return null;return await f.api.post({path:"/v1/onramp/quote",params:{projectId:h.H.state.projectId},body:{purchaseCurrency:t,paymentCurrency:n,amount:i,network:r}})}catch(s){return{coinbaseFee:{amount:i,currency:n.id},networkFee:{amount:i,currency:n.id},paymentSubtotal:{amount:i,currency:n.id},paymentTotal:{amount:i,currency:n.id},purchaseAmount:{amount:i,currency:n.id},quoteId:"mocked-quote-id"}}},getSmartSessions:async e=>await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?m.get({path:`/v1/sessions/${e}`}):[],revokeSmartSession:async(e,t,n)=>await m.isNetworkSupported(c.W.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:`/v1/sessions/${e}/revoke`,params:{projectId:h.H.state.projectId},body:{pci:t,signature:n}}):{success:!1},setClientId(e){f.clientId=e,f.api=new a.Z({baseUrl:p,clientId:e})}}},65871:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(56121);i.__exportStar(n(30296),t),i.__exportStar(n(568),t)},67887:(e,t,n)=>{"use strict";n.d(t,{o:()=>s});var i=n(59979),r=n(22538);const s={set(e,t){r.Q.isClient&&localStorage.setItem(`${i.s1.STORAGE_KEY}${e}`,t)},get:e=>r.Q.isClient?localStorage.getItem(`${i.s1.STORAGE_KEY}${e}`):null,delete(e,t){r.Q.isClient&&(t?localStorage.removeItem(e):localStorage.removeItem(`${i.s1.STORAGE_KEY}${e}`))}}},67962:(e,t,n)=>{"use strict";n.d(t,{IQ:()=>h,ME:()=>c,Sl:()=>o,uU:()=>l});var i=n(3458),r=n(22017),s=n(48604),a=n(37131);function o(e,t){let{size:n}=t;if((0,r.E)(e)>n)throw new i.u({givenSize:(0,r.E)(e),maxSize:n})}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{signed:n}=t;t.size&&o(e,{size:t.size});const i=BigInt(e);if(!n)return i;const r=(e.length-2)/2;return i<=(1n<<8n*BigInt(r)-1n)-1n?i:i-BigInt(`0x${"f".padStart(2*r,"f")}`)-1n}function c(e){return Number(l(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,a.aT)(e);return t.size&&(o(n,{size:t.size}),n=(0,s.B)(n,{dir:"right"})),(new TextDecoder).decode(n)}},68231:(e,t,n)=>{"use strict";n.d(t,{W:()=>d});var i=n(38993),r=n(59979),s=n(595),a=n(65618),o=n(15814),l=n(79323),c=n(42661),h=n(7258);const u=(0,i.BX)({transactions:[],coinbaseTransactions:{},transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),d={state:u,subscribe:e=>(0,i.B1)(u,(()=>e(u))),setLastNetworkInView(e){u.lastNetworkInView=e},async fetchTransactions(e,t){if(!e)throw new Error("Transactions can't be fetched without an accountAddress");u.loading=!0;try{const n=await a.T.fetchTransactions({account:e,cursor:u.next,onramp:t,cache:"coinbase"===t?"no-cache":void 0,chainId:o.W.state.activeCaipNetwork?.caipNetworkId}),i=this.filterSpamTransactions(n.data),r=this.filterByConnectedChain(i),s=[...u.transactions,...r];u.loading=!1,"coinbase"===t?u.coinbaseTransactions=this.groupTransactionsByYearAndMonth(u.coinbaseTransactions,n.data):(u.transactions=s,u.transactionsByYear=this.groupTransactionsByYearAndMonth(u.transactionsByYear,r)),u.empty=0===s.length,u.next=n.next?n.next:void 0}catch(n){const t=o.W.state.activeChain;l.E.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:e,projectId:c.H.state.projectId,cursor:u.next,isSmartAccount:s.U.state.preferredAccountTypes?.[t]===r.Vl.ACCOUNT_TYPES.SMART_ACCOUNT}}),h.P.showError("Failed to fetch transactions"),u.loading=!1,u.empty=!0,u.next=void 0}},groupTransactionsByYearAndMonth(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((t=>{const n=new Date(t.metadata.minedAt).getFullYear(),i=new Date(t.metadata.minedAt).getMonth(),r=e[n]??{},s=(r[i]??[]).filter((e=>e.id!==t.id));e[n]={...r,[i]:[...s,t].sort(((e,t)=>new Date(t.metadata.minedAt).getTime()-new Date(e.metadata.minedAt).getTime()))}})),e},filterSpamTransactions:e=>e.filter((e=>!e.transfers.every((e=>!0===e.nft_info?.flags.is_spam)))),filterByConnectedChain(e){const t=o.W.state.activeCaipNetwork?.caipNetworkId;return e.filter((e=>e.metadata.chain===t))},clearCursor(){u.next=void 0},resetTransactions(){u.transactions=[],u.transactionsByYear={},u.lastNetworkInView=void 0,u.loading=!1,u.empty=!1,u.next=void 0}}},69397:(e,t,n)=>{"use strict";n.d(t,{D5:()=>_,U5:()=>S,h6:()=>r.a,iP:()=>C,oI:()=>A});var i=n(25711),r=n.n(i),s=n(48661);const a={level:"info"},o="custom_context",l=1024e3;class c{constructor(e){this.nodeValue=e,this.sizeInBytes=(new TextEncoder).encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class h{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new c(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}}class u{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;this.level=e??"error",this.levelValue=i.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new h(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===i.levels.values.error?console.error(e):t===i.levels.values.warn?console.warn(e):t===i.levels.values.debug?console.debug(e):t===i.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append((0,s.h)({timestamp:(new Date).toISOString(),log:e}));const t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new h(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push((0,s.h)({extraMetadata:e})),new Blob(t,{type:"application/json"})}}class d{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;this.baseChunkLogger=new u(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download=`walletconnect-logs-${(new Date).toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}}class p{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;this.baseChunkLogger=new u(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var f=Object.defineProperty,m=Object.defineProperties,g=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,w=(e,t,n)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,x=(e,t)=>{for(var n in t||(t={}))y.call(t,n)&&w(e,n,t[n]);if(v)for(var n of v(t))b.call(t,n)&&w(e,n,t[n]);return e},E=(e,t)=>m(e,g(t));function C(e){return E(x({},e),{level:e?.level||a.level})}function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,n="";return n=typeof e.bindings>"u"?function(e){return e[arguments.length>1&&void 0!==arguments[1]?arguments[1]:o]||""}(e,t):e.bindings().context||"",n}function S(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o;const i=function(e,t){const n=A(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:o);return n.trim()?`${n}/${t}`:t}(e,t,n);return function(e,t){return e[arguments.length>2&&void 0!==arguments[2]?arguments[2]:o]=t,e}(e.child({context:i}),i,n)}function _(e){return typeof e.loggerOverride<"u"&&"string"!=typeof e.loggerOverride?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?function(e){var t,n;const i=new d(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:r()(E(x({},e.opts),{level:"trace",browser:E(x({},null==(n=e.opts)?void 0:n.browser),{write:e=>i.write(e)})})),chunkLoggerController:i}}(e):function(e){var t;const n=new p(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:r()(E(x({},e.opts),{level:"trace"}),n),chunkLoggerController:n}}(e)}},69611:(e,t,n)=>{"use strict";n.d(t,{eL:()=>i,pj:()=>s,sz:()=>r});const i={gwei:9,wei:18},r={ether:-9,wei:9},s={ether:-18,gwei:-9}},69929:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={getSpacingStyles:(e,t)=>Array.isArray(e)?e[t]?`var(--wui-spacing-${e[t]})`:void 0:"string"===typeof e?`var(--wui-spacing-${e})`:void 0,getFormattedDate:e=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(e),getHostName(e){try{return new URL(e).hostname}catch(t){return""}},getTruncateString(e){let{string:t,charsStart:n,charsEnd:i,truncate:r}=e;return t.length<=n+i?t:"end"===r?`${t.substring(0,n)}...`:"start"===r?`...${t.substring(t.length-i)}`:`${t.substring(0,Math.floor(n))}...${t.substring(t.length-Math.floor(i))}`},generateAvatarColors(e){const t=e.toLowerCase().replace(/^0x/iu,"").replace(/[^a-f0-9]/gu,"").substring(0,6).padEnd(6,"0"),n=this.hexToRgb(t),i=getComputedStyle(document.documentElement).getPropertyValue("--w3m-border-radius-master"),r=100-3*Number(i?.replace("px","")),s=`${r}% ${r}% at 65% 40%`,a=[];for(let o=0;o<5;o+=1){const e=this.tintColor(n,.15*o);a.push(`rgb(${e[0]}, ${e[1]}, ${e[2]})`)}return`\n    --local-color-1: ${a[0]};\n    --local-color-2: ${a[1]};\n    --local-color-3: ${a[2]};\n    --local-color-4: ${a[3]};\n    --local-color-5: ${a[4]};\n    --local-radial-circle: ${s}\n   `},hexToRgb(e){const t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]},tintColor(e,t){const[n,i,r]=e;return[Math.round(n+(255-n)*t),Math.round(i+(255-i)*t),Math.round(r+(255-r)*t)]},isNumber:e=>/^[0-9]+$/u.test(e),getColorTheme:e=>e||("undefined"!==typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)")?.matches?"dark":"light":"dark"),splitBalance(e){const t=e.split(".");return 2===t.length?[t[0],t[1]]:["0","00"]},roundNumber:(e,t,n)=>e.toString().length>=t?Number(e).toFixed(n):e,formatNumberToLocalString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return void 0===e?"0.00":"number"===typeof e?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t})}}},70579:(e,t,n)=>{"use strict";e.exports=n(22799)},71636:(e,t,n)=>{"use strict";n.d(t,{R:()=>x});var i=n(38993),r=n(76844),s=n(268);const a=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],o=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}];var l=n(80883);const c=e=>l.o.USDT_CONTRACT_ADDRESSES.includes(e)?o:a;var h=n(59979),u=n(84657),d=n(24657),p=n(87049),f=n(595),m=n(15814),g=n(93022),v=n(79323),y=n(61139),b=n(7258);const w=(0,i.BX)({tokenBalances:[],loading:!1}),x={state:w,subscribe:e=>(0,i.B1)(w,(()=>e(w))),subscribeKey:(e,t)=>(0,r.u$)(w,e,t),setToken(e){e&&(w.token=(0,i.KR)(e))},setTokenAmount(e){w.sendTokenAmount=e},setReceiverAddress(e){w.receiverAddress=e},setReceiverProfileImageUrl(e){w.receiverProfileImageUrl=e},setReceiverProfileName(e){w.receiverProfileName=e},setGasPrice(e){w.gasPrice=e},setGasPriceInUsd(e){w.gasPriceInUSD=e},setNetworkBalanceInUsd(e){w.networkBalanceInUSD=e},setLoading(e){w.loading=e},sendToken(){switch(m.W.state.activeCaipNetwork?.chainNamespace){case"eip155":return void this.sendEvmToken();case"solana":return void this.sendSolanaToken();default:throw new Error("Unsupported chain")}},sendEvmToken(){const e=m.W.state.activeChain,t=f.U.state.preferredAccountTypes?.[e];this.state.token?.address&&this.state.sendTokenAmount&&this.state.receiverAddress?(v.E.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:t===h.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token.address,amount:this.state.sendTokenAmount,network:m.W.state.activeCaipNetwork?.caipNetworkId||""}}),this.sendERC20Token({receiverAddress:this.state.receiverAddress,tokenAddress:this.state.token.address,sendTokenAmount:this.state.sendTokenAmount,decimals:this.state.token.quantity.decimals})):this.state.receiverAddress&&this.state.sendTokenAmount&&this.state.gasPrice&&this.state.token?.quantity.decimals&&(v.E.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:t===h.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol,amount:this.state.sendTokenAmount,network:m.W.state.activeCaipNetwork?.caipNetworkId||""}}),this.sendNativeToken({receiverAddress:this.state.receiverAddress,sendTokenAmount:this.state.sendTokenAmount,gasPrice:this.state.gasPrice,decimals:this.state.token.quantity.decimals}))},async fetchTokenBalance(e){w.loading=!0;const t=m.W.state.activeCaipNetwork?.caipNetworkId,n=m.W.state.activeCaipNetwork?.chainNamespace,i=m.W.state.activeCaipAddress,r=i?d.w.getPlainAddress(i):void 0;if(w.lastRetry&&!d.w.isAllowedRetry(w.lastRetry,30*u.oU.ONE_SEC_MS))return w.loading=!1,[];try{if(r&&t&&n){const e=await p.t.getMyTokensWithBalance();return w.tokenBalances=e,w.lastRetry=void 0,e}}catch(s){w.lastRetry=Date.now(),e?.(s),b.P.showError("Token Balance Unavailable")}finally{w.loading=!1}return[]},fetchNetworkBalance(){if(0===w.tokenBalances.length)return;const e=p.t.mapBalancesToSwapTokens(w.tokenBalances);if(!e)return;const t=e.find((e=>e.address===m.W.getActiveNetworkTokenAddress()));t&&(w.networkBalanceInUSD=t?s.S.multiply(t.quantity.numeric,t.price).toString():"0")},isInsufficientNetworkTokenForGas(e,t){const n=t||"0";return!!s.S.bigNumber(e).eq(0)||s.S.bigNumber(s.S.bigNumber(n)).gt(e)},hasInsufficientGasFunds(){const e=m.W.state.activeChain;let t=!0;return f.U.state.preferredAccountTypes?.[e]===h.Vl.ACCOUNT_TYPES.SMART_ACCOUNT?t=!1:w.networkBalanceInUSD&&(t=this.isInsufficientNetworkTokenForGas(w.networkBalanceInUSD,w.gasPriceInUSD)),t},async sendNativeToken(e){const t=m.W.state.activeChain;y.I.pushTransactionStack({view:"Account",goBack:!1});const n=e.receiverAddress,i=f.U.state.address,r=g.x.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));try{await g.x.sendTransaction({chainNamespace:"eip155",to:n,address:i,data:"0x",value:r??BigInt(0),gasPrice:e.gasPrice}),b.P.showSuccess("Transaction started"),v.E.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:f.U.state.preferredAccountTypes?.[t]===h.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol||"",amount:e.sendTokenAmount,network:m.W.state.activeCaipNetwork?.caipNetworkId||""}}),this.resetSend()}catch(s){console.error("SendController:sendERC20Token - failed to send native token",s);const n=s instanceof Error?s.message:"Unknown error";v.E.sendEvent({type:"track",event:"SEND_ERROR",properties:{message:n,isSmartAccount:f.U.state.preferredAccountTypes?.[t]===h.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol||"",amount:e.sendTokenAmount,network:m.W.state.activeCaipNetwork?.caipNetworkId||""}}),b.P.showError("Something went wrong")}},async sendERC20Token(e){y.I.pushTransactionStack({view:"Account",goBack:!1});const t=g.x.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));try{if(f.U.state.address&&e.sendTokenAmount&&e.receiverAddress&&e.tokenAddress){const n=d.w.getPlainAddress(e.tokenAddress);await g.x.writeContract({fromAddress:f.U.state.address,tokenAddress:n,args:[e.receiverAddress,t??BigInt(0)],method:"transfer",abi:c(n),chainNamespace:"eip155"}),b.P.showSuccess("Transaction started"),this.resetSend()}}catch(n){console.error("SendController:sendERC20Token - failed to send erc20 token",n);const t=n instanceof Error?n.message:"Unknown error";v.E.sendEvent({type:"track",event:"SEND_ERROR",properties:{message:t,isSmartAccount:f.U.state.preferredAccountTypes?.eip155===h.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol||"",amount:e.sendTokenAmount,network:m.W.state.activeCaipNetwork?.caipNetworkId||""}}),b.P.showError("Something went wrong")}},sendSolanaToken(){this.state.sendTokenAmount&&this.state.receiverAddress?(y.I.pushTransactionStack({view:"Account",goBack:!1}),g.x.sendTransaction({chainNamespace:"solana",to:this.state.receiverAddress,value:this.state.sendTokenAmount}).then((()=>{this.resetSend(),f.U.fetchTokenBalance()})).catch((e=>{b.P.showError("Failed to send transaction. Please try again."),console.error("SendController:sendToken - failed to send solana transaction",e)}))):b.P.showError("Please enter a valid amount and receiver address")},resetSend(){w.token=void 0,w.sendTokenAmount=void 0,w.receiverAddress=void 0,w.receiverProfileImageUrl=void 0,w.receiverProfileName=void 0,w.loading=!1,w.tokenBalances=[]}}},71822:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const t=this.get(e);if("undefined"!==typeof t.elapsed)throw new Error(`Watch already stopped for label: ${e}`);const n=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:n})}get(e){const t=this.timestamps.get(e);if("undefined"===typeof t)throw new Error(`No timestamp found for label: ${e}`);return t}elapsed(e){const t=this.get(e);return t.elapsed||Date.now()-t.started}}t.Watch=n,t.default=n},72494:(e,t,n)=>{"use strict";n.d(t,{Ci:()=>a,J8:()=>o,MU:()=>l});var i=n(23512),r=n(21627),s=n(91218);class a extends r.C{constructor(e){let{body:t,cause:n,details:r,headers:a,status:o,url:l}=e;super("HTTP request failed.",{cause:n,details:r,metaMessages:[o&&`Status: ${o}`,`URL: ${(0,s.I)(l)}`,t&&`Request body: ${(0,i.A)(t)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=t,this.headers=a,this.status=o,this.url=l}}r.C;class o extends r.C{constructor(e){let{body:t,error:n,url:r}=e;super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${(0,s.I)(r)}`,`Request body: ${(0,i.A)(t)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data}}r.C;class l extends r.C{constructor(e){let{body:t,url:n}=e;super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${(0,s.I)(n)}`,`Request body: ${(0,i.A)(t)}`],name:"TimeoutError"})}}},73609:(e,t,n)=>{"use strict";n.d(t,{W:()=>g});var i=n(38993),r=n(76844),s=n(24657),a=n(595),o=n(16496),l=n(15814),c=n(93022),h=n(73939),u=n(79323),d=n(42661),p=n(44098),f=n(61139);const m=(0,i.BX)({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),g={state:m,subscribe:e=>(0,i.B1)(m,(()=>e(m))),subscribeKey:(e,t)=>(0,r.u$)(m,e,t),async open(e){const t="connected"===a.U.state.status;c.x.state.wcBasic?o.N.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await o.N.prefetch({fetchConnectorImages:!t,fetchFeaturedWallets:!t,fetchRecommendedWallets:!t}),e?.namespace?(await l.W.switchActiveNamespace(e.namespace),g.setLoading(!0,e.namespace)):g.setLoading(!0),h.a.setFilterByNamespace(e?.namespace);const n=l.W.getAccountData(e?.namespace)?.caipAddress;l.W.state.noAdapters&&!n?s.w.isMobile()?f.I.reset("AllWallets"):f.I.reset("ConnectingWalletConnectBasic"):e?.view?f.I.reset(e.view,e.data):n?f.I.reset("Account"):f.I.reset("Connect"),m.open=!0,p.z.set({open:!0}),u.E.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:Boolean(n)}})},close(){const e=d.H.state.enableEmbedded,t=Boolean(l.W.state.activeCaipAddress);m.open&&u.E.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:t}}),m.open=!1,g.clearLoading(),e?t?f.I.replace("Account"):f.I.push("Connect"):p.z.set({open:!1}),c.x.resetUri()},setLoading(e,t){t&&m.loadingNamespaceMap.set(t,e),m.loading=e,p.z.set({loading:e})},clearLoading(){m.loadingNamespaceMap.clear(),m.loading=!1},shake(){m.shake||(m.shake=!0,setTimeout((()=>{m.shake=!1}),500))}}},73924:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var i=n(36220),r=n(61945);const s=e=>(0,i.di)((0,r.k)(e),0,4)},73939:(e,t,n)=>{"use strict";n.d(t,{a:()=>g});var i=n(38993),r=n(76844),s=n(80883),a=n(25347),o=n(15814);const l={handleSolanaDeeplinkRedirect(e){if(o.W.state.activeChain===s.o.CHAIN.SOLANA){const t=window.location.href,n=encodeURIComponent(t);if("Phantom"===e&&!("phantom"in window)){const e=t.startsWith("https")?"https":"http",i=t.split("/")[2],r=encodeURIComponent(`${e}://${i}`);window.location.href=`https://phantom.app/ul/browse/${n}?ref=${r}`}"Coinbase Wallet"!==e||"coinbaseSolana"in window||(window.location.href=`https://go.cb-w.com/dapp?cb_url=${n}`)}}};var c=n(88861),h=n(16496),u=n(42661),d=n(61139),p=n(36141);const f={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0},m=(0,i.BX)({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...f}}),g={state:m,subscribe:e=>(0,i.B1)(m,(()=>{e(m)})),subscribeKey:(e,t)=>(0,r.u$)(m,e,t),initialize(e){e.forEach((e=>{const t=c.i.getConnectedConnectorId(e);t&&this.setConnectorId(t,e)}))},setActiveConnector(e){e&&(m.activeConnector=(0,i.KR)(e))},setConnectors(e){e.filter((e=>!m.allConnectors.some((t=>t.id===e.id&&this.getConnectorName(t.name)===this.getConnectorName(e.name)&&t.chain===e.chain)))).forEach((e=>{"MULTI_CHAIN"!==e.type&&m.allConnectors.push((0,i.KR)(e))})),m.connectors=this.mergeMultiChainConnectors(m.allConnectors)},removeAdapter(e){m.allConnectors=m.allConnectors.filter((t=>t.chain!==e)),m.connectors=this.mergeMultiChainConnectors(m.allConnectors)},mergeMultiChainConnectors(e){const t=this.generateConnectorMapByName(e),n=[];return t.forEach((e=>{const t=e[0],i=t?.id===s.o.CONNECTOR_ID.AUTH;e.length>1&&t?n.push({name:t.name,imageUrl:t.imageUrl,imageId:t.imageId,connectors:[...e],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:t?.id||""}):t&&n.push(t)})),n},generateConnectorMapByName(e){const t=new Map;return e.forEach((e=>{const{name:n}=e,i=this.getConnectorName(n);if(!i)return;const r=t.get(i)||[];r.find((t=>t.chain===e.chain))||r.push(e),t.set(i,r)})),t},getConnectorName(e){if(!e)return e;return{"Trust Wallet":"Trust"}[e]||e},getUniqueConnectorsByName(e){const t=[];return e.forEach((e=>{t.find((t=>t.chain===e.chain))||t.push(e)})),t},addConnector(e){if(e.id===s.o.CONNECTOR_ID.AUTH){const t=e,n=(0,i.P9)(u.H.state),r=p.W.getSnapshot().themeMode,s=p.W.getSnapshot().themeVariables;t?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,projectId:n.projectId,sdkType:n.sdkType}),t?.provider?.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:(0,a.o)(s,r)}),this.setConnectors([e])}else this.setConnectors([e])},getAuthConnector(e){const t=e||o.W.state.activeChain,n=m.connectors.find((e=>e.id===s.o.CONNECTOR_ID.AUTH));if(n){if(n?.connectors?.length){return n.connectors.find((e=>e.chain===t))}return n}},getAnnouncedConnectorRdns:()=>m.connectors.filter((e=>"ANNOUNCED"===e.type)).map((e=>e.info?.rdns)),getConnectorById:e=>m.allConnectors.find((t=>t.id===e)),getConnector:(e,t)=>m.allConnectors.filter((e=>e.chain===o.W.state.activeChain)).find((n=>n.explorerId===e||n.info?.rdns===t)),syncIfAuthConnector(e){if("ID_AUTH"!==e.id)return;const t=e,n=(0,i.P9)(u.H.state),r=p.W.getSnapshot().themeMode,s=p.W.getSnapshot().themeVariables;t?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),t.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:(0,a.o)(s,r)})},getConnectorsByNamespace(e){const t=m.allConnectors.filter((t=>t.chain===e));return this.mergeMultiChainConnectors(t)},selectWalletConnector(e){const t=g.getConnector(e.id,e.rdns);o.W.state.activeChain===s.o.CHAIN.SOLANA&&l.handleSolanaDeeplinkRedirect(t?.name||e.name||""),t?d.I.push("ConnectingExternal",{connector:t}):d.I.push("ConnectingWalletConnect",{wallet:e})},getConnectors(e){return e?this.getConnectorsByNamespace(e):this.mergeMultiChainConnectors(m.allConnectors)},setFilterByNamespace(e){m.filterByNamespace=e,m.connectors=this.getConnectors(e),h.N.setFilterByNamespace(e)},setConnectorId(e,t){e&&(m.activeConnectorIds={...m.activeConnectorIds,[t]:e},c.i.setConnectedConnectorId(t,e))},removeConnectorId(e){m.activeConnectorIds={...m.activeConnectorIds,[e]:void 0},c.i.deleteConnectedConnectorId(e)},getConnectorId(e){if(e)return m.activeConnectorIds[e]},isConnected:e=>e?Boolean(m.activeConnectorIds[e]):Object.values(m.activeConnectorIds).some((e=>Boolean(e))),resetConnectorIds(){m.activeConnectorIds={...f}}}},74074:(e,t,n)=>{"use strict";n.d(t,{P:()=>o});var i=n(56844),r=n(43028);const s=/^0x[a-fA-F0-9]{40}$/,a=new i.A(8192);function o(e,t){const{strict:n=!0}=t??{},i=`${e}.${n}`;if(a.has(i))return a.get(i);const o=!!s.test(e)&&(e.toLowerCase()===e||!n||(0,r.o)(e)===e);return a.set(i,o),o}},74745:(e,t,n)=>{"use strict";n.d(t,{W:()=>c});var i=n(19048),r=n(97965),s=n(36220),a=n(73924),o=n(63206),l=n(59052);function c(e){const{abi:t,data:n}=e,c=(0,s.di)(n,0,4);if("0x"===c)throw new r.O;const h=[...t||[],i.Mc,i.J9].find((e=>"error"===e.type&&c===(0,a.V)((0,l.B)(e))));if(!h)throw new r.Wq(c,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:h,args:"inputs"in h&&h.inputs&&h.inputs.length>0?(0,o.n)(h.inputs,(0,s.di)(n,4)):void 0,errorName:h.name}}},74807:function(e,t,n){e.exports=function(e){"use strict";function t(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e)for(const n in e)if("default"!==n){const i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:()=>e[n]})}return t.default=e,Object.freeze(t)}const n=t(e),i=new Map,r={set(e,t,n){i.has(e)||i.set(e,new Map);const r=i.get(e);r.has(t)||0===r.size?r.set(t,n):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(r.keys())[0]}.`)},get:(e,t)=>i.has(e)&&i.get(e).get(t)||null,remove(e,t){if(!i.has(e))return;const n=i.get(e);n.delete(t),0===n.size&&i.delete(e)}},s="transitionend",a=e=>(e&&window.CSS&&window.CSS.escape&&(e=e.replace(/#([^\s"#']+)/g,((e,t)=>`#${CSS.escape(t)}`))),e),o=e=>{e.dispatchEvent(new Event(s))},l=e=>!(!e||"object"!=typeof e)&&(void 0!==e.jquery&&(e=e[0]),void 0!==e.nodeType),c=e=>l(e)?e.jquery?e[0]:e:"string"==typeof e&&e.length>0?document.querySelector(a(e)):null,h=e=>{if(!l(e)||0===e.getClientRects().length)return!1;const t="visible"===getComputedStyle(e).getPropertyValue("visibility"),n=e.closest("details:not([open])");if(!n)return t;if(n!==e){const t=e.closest("summary");if(t&&t.parentNode!==n)return!1;if(null===t)return!1}return t},u=e=>!e||e.nodeType!==Node.ELEMENT_NODE||!!e.classList.contains("disabled")||(void 0!==e.disabled?e.disabled:e.hasAttribute("disabled")&&"false"!==e.getAttribute("disabled")),d=e=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof e.getRootNode){const t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?d(e.parentNode):null},p=()=>{},f=e=>{e.offsetHeight},m=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,g=[],v=()=>"rtl"===document.documentElement.dir,y=e=>{var t;t=()=>{const t=m();if(t){const n=e.NAME,i=t.fn[n];t.fn[n]=e.jQueryInterface,t.fn[n].Constructor=e,t.fn[n].noConflict=()=>(t.fn[n]=i,e.jQueryInterface)}},"loading"===document.readyState?(g.length||document.addEventListener("DOMContentLoaded",(()=>{for(const e of g)e()})),g.push(t)):t()},b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return"function"==typeof e?e.call(...t):n},w=function(e,t){if(arguments.length>2&&void 0!==arguments[2]&&!arguments[2])return void b(e);const n=(e=>{if(!e)return 0;let{transitionDuration:t,transitionDelay:n}=window.getComputedStyle(e);const i=Number.parseFloat(t),r=Number.parseFloat(n);return i||r?(t=t.split(",")[0],n=n.split(",")[0],1e3*(Number.parseFloat(t)+Number.parseFloat(n))):0})(t)+5;let i=!1;const r=n=>{let{target:a}=n;a===t&&(i=!0,t.removeEventListener(s,r),b(e))};t.addEventListener(s,r),setTimeout((()=>{i||o(t)}),n)},x=(e,t,n,i)=>{const r=e.length;let s=e.indexOf(t);return-1===s?!n&&i?e[r-1]:e[0]:(s+=n?1:-1,i&&(s=(s+r)%r),e[Math.max(0,Math.min(s,r-1))])},E=/[^.]*(?=\..*)\.|.*/,C=/\..*/,A=/::\d+$/,S={};let _=1;const T={mouseenter:"mouseover",mouseleave:"mouseout"},P=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function M(e,t){return t&&`${t}::${_++}`||e.uidEvent||_++}function N(e){const t=M(e);return e.uidEvent=t,S[t]=S[t]||{},S[t]}function I(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object.values(e).find((e=>e.callable===t&&e.delegationSelector===n))}function O(e,t,n){const i="string"==typeof t,r=i?n:t||n;let s=k(e);return P.has(s)||(s=e),[i,r,s]}function D(e,t,n,i,r){if("string"!=typeof t||!e)return;let[s,a,o]=O(t,n,i);if(t in T){const e=e=>function(t){if(!t.relatedTarget||t.relatedTarget!==t.delegateTarget&&!t.delegateTarget.contains(t.relatedTarget))return e.call(this,t)};a=e(a)}const l=N(e),c=l[o]||(l[o]={}),h=I(c,a,s?n:null);if(h)return void(h.oneOff=h.oneOff&&r);const u=M(a,t.replace(E,"")),d=s?function(e,t,n){return function i(r){const s=e.querySelectorAll(t);for(let{target:a}=r;a&&a!==this;a=a.parentNode)for(const o of s)if(o===a)return U(r,{delegateTarget:a}),i.oneOff&&B.off(e,r.type,t,n),n.apply(a,[r])}}(e,n,a):function(e,t){return function n(i){return U(i,{delegateTarget:e}),n.oneOff&&B.off(e,i.type,t),t.apply(e,[i])}}(e,a);d.delegationSelector=s?n:null,d.callable=a,d.oneOff=r,d.uidEvent=u,c[u]=d,e.addEventListener(o,d,s)}function L(e,t,n,i,r){const s=I(t[n],i,r);s&&(e.removeEventListener(n,s,Boolean(r)),delete t[n][s.uidEvent])}function R(e,t,n,i){const r=t[n]||{};for(const[s,a]of Object.entries(r))s.includes(i)&&L(e,t,n,a.callable,a.delegationSelector)}function k(e){return e=e.replace(C,""),T[e]||e}const B={on(e,t,n,i){D(e,t,n,i,!1)},one(e,t,n,i){D(e,t,n,i,!0)},off(e,t,n,i){if("string"!=typeof t||!e)return;const[r,s,a]=O(t,n,i),o=a!==t,l=N(e),c=l[a]||{},h=t.startsWith(".");if(void 0===s){if(h)for(const n of Object.keys(l))R(e,l,n,t.slice(1));for(const[n,i]of Object.entries(c)){const r=n.replace(A,"");o&&!t.includes(r)||L(e,l,a,i.callable,i.delegationSelector)}}else{if(!Object.keys(c).length)return;L(e,l,a,s,r?n:null)}},trigger(e,t,n){if("string"!=typeof t||!e)return null;const i=m();let r=null,s=!0,a=!0,o=!1;t!==k(t)&&i&&(r=i.Event(t,n),i(e).trigger(r),s=!r.isPropagationStopped(),a=!r.isImmediatePropagationStopped(),o=r.isDefaultPrevented());const l=U(new Event(t,{bubbles:s,cancelable:!0}),n);return o&&l.preventDefault(),a&&e.dispatchEvent(l),l.defaultPrevented&&r&&r.preventDefault(),l}};function U(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(const[n,i]of Object.entries(t))try{e[n]=i}catch(t){Object.defineProperty(e,n,{configurable:!0,get:()=>i})}return e}function z(e){if("true"===e)return!0;if("false"===e)return!1;if(e===Number(e).toString())return Number(e);if(""===e||"null"===e)return null;if("string"!=typeof e)return e;try{return JSON.parse(decodeURIComponent(e))}catch(t){return e}}function F(e){return e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}const j={setDataAttribute(e,t,n){e.setAttribute(`data-bs-${F(t)}`,n)},removeDataAttribute(e,t){e.removeAttribute(`data-bs-${F(t)}`)},getDataAttributes(e){if(!e)return{};const t={},n=Object.keys(e.dataset).filter((e=>e.startsWith("bs")&&!e.startsWith("bsConfig")));for(const i of n){let n=i.replace(/^bs/,"");n=n.charAt(0).toLowerCase()+n.slice(1),t[n]=z(e.dataset[i])}return t},getDataAttribute:(e,t)=>z(e.getAttribute(`data-bs-${F(t)}`))};class V{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const n=l(t)?j.getDataAttribute(t,"config"):{};return{...this.constructor.Default,..."object"==typeof n?n:{},...l(t)?j.getDataAttributes(t):{},..."object"==typeof e?e:{}}}_typeCheckConfig(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.constructor.DefaultType;for(const[i,r]of Object.entries(t)){const t=e[i],s=l(t)?"element":null==(n=t)?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(r).test(s))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${i}" provided type "${s}" but expected type "${r}".`)}var n}}class H extends V{constructor(e,t){super(),(e=c(e))&&(this._element=e,this._config=this._getConfig(t),r.set(this._element,this.constructor.DATA_KEY,this))}dispose(){r.remove(this._element,this.constructor.DATA_KEY),B.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t){w(e,t,!(arguments.length>2&&void 0!==arguments[2])||arguments[2])}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return r.get(c(e),this.DATA_KEY)}static getOrCreateInstance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getInstance(e)||new this(e,"object"==typeof t?t:null)}static get VERSION(){return"5.3.5"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const W=e=>{let t=e.getAttribute("data-bs-target");if(!t||"#"===t){let n=e.getAttribute("href");if(!n||!n.includes("#")&&!n.startsWith("."))return null;n.includes("#")&&!n.startsWith("#")&&(n=`#${n.split("#")[1]}`),t=n&&"#"!==n?n.trim():null}return t?t.split(",").map((e=>a(e))).join(","):null},G={find:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.documentElement;return[].concat(...Element.prototype.querySelectorAll.call(t,e))},findOne:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.documentElement;return Element.prototype.querySelector.call(t,e)},children:(e,t)=>[].concat(...e.children).filter((e=>e.matches(t))),parents(e,t){const n=[];let i=e.parentNode.closest(t);for(;i;)n.push(i),i=i.parentNode.closest(t);return n},prev(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return[n];n=n.previousElementSibling}return[]},next(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return[n];n=n.nextElementSibling}return[]},focusableChildren(e){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((e=>`${e}:not([tabindex^="-"])`)).join(",");return this.find(t,e).filter((e=>!u(e)&&h(e)))},getSelectorFromElement(e){const t=W(e);return t&&G.findOne(t)?t:null},getElementFromSelector(e){const t=W(e);return t?G.findOne(t):null},getMultipleElementsFromSelector(e){const t=W(e);return t?G.find(t):[]}},q=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hide";const n=`click.dismiss${e.EVENT_KEY}`,i=e.NAME;B.on(document,n,`[data-bs-dismiss="${i}"]`,(function(n){if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),u(this))return;const r=G.getElementFromSelector(this)||this.closest(`.${i}`);e.getOrCreateInstance(r)[t]()}))},K=".bs.alert",Y=`close${K}`,Q=`closed${K}`;class X extends H{static get NAME(){return"alert"}close(){if(B.trigger(this._element,Y).defaultPrevented)return;this._element.classList.remove("show");const e=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,e)}_destroyElement(){this._element.remove(),B.trigger(this._element,Q),this.dispose()}static jQueryInterface(e){return this.each((function(){const t=X.getOrCreateInstance(this);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}q(X,"close"),y(X);const Z='[data-bs-toggle="button"]';class J extends H{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(e){return this.each((function(){const t=J.getOrCreateInstance(this);"toggle"===e&&t[e]()}))}}B.on(document,"click.bs.button.data-api",Z,(e=>{e.preventDefault();const t=e.target.closest(Z);J.getOrCreateInstance(t).toggle()})),y(J);const $=".bs.swipe",ee=`touchstart${$}`,te=`touchmove${$}`,ne=`touchend${$}`,ie=`pointerdown${$}`,re=`pointerup${$}`,se={endCallback:null,leftCallback:null,rightCallback:null},ae={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class oe extends V{constructor(e,t){super(),this._element=e,e&&oe.isSupported()&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return se}static get DefaultType(){return ae}static get NAME(){return"swipe"}dispose(){B.off(this._element,$)}_start(e){this._supportPointerEvents?this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX):this._deltaX=e.touches[0].clientX}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),b(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=40)return;const t=e/this._deltaX;this._deltaX=0,t&&b(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(B.on(this._element,ie,(e=>this._start(e))),B.on(this._element,re,(e=>this._end(e))),this._element.classList.add("pointer-event")):(B.on(this._element,ee,(e=>this._start(e))),B.on(this._element,te,(e=>this._move(e))),B.on(this._element,ne,(e=>this._end(e))))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&("pen"===e.pointerType||"touch"===e.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const le=".bs.carousel",ce=".data-api",he="ArrowLeft",ue="ArrowRight",de="next",pe="prev",fe="left",me="right",ge=`slide${le}`,ve=`slid${le}`,ye=`keydown${le}`,be=`mouseenter${le}`,we=`mouseleave${le}`,xe=`dragstart${le}`,Ee=`load${le}${ce}`,Ce=`click${le}${ce}`,Ae="carousel",Se="active",_e=".active",Te=".carousel-item",Pe=_e+Te,Me={[he]:me,[ue]:fe},Ne={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Ie={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Oe extends H{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=G.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Ae&&this.cycle()}static get Default(){return Ne}static get DefaultType(){return Ie}static get NAME(){return"carousel"}next(){this._slide(de)}nextWhenVisible(){!document.hidden&&h(this._element)&&this.next()}prev(){this._slide(pe)}pause(){this._isSliding&&o(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval((()=>this.nextWhenVisible()),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?B.one(this._element,ve,(()=>this.cycle())):this.cycle())}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding)return void B.one(this._element,ve,(()=>this.to(e)));const n=this._getItemIndex(this._getActive());if(n===e)return;const i=e>n?de:pe;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&B.on(this._element,ye,(e=>this._keydown(e))),"hover"===this._config.pause&&(B.on(this._element,be,(()=>this.pause())),B.on(this._element,we,(()=>this._maybeEnableCycle()))),this._config.touch&&oe.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const t of G.find(".carousel-item img",this._element))B.on(t,xe,(e=>e.preventDefault()));const e={leftCallback:()=>this._slide(this._directionToOrder(fe)),rightCallback:()=>this._slide(this._directionToOrder(me)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((()=>this._maybeEnableCycle()),500+this._config.interval))}};this._swipeHelper=new oe(this._element,e)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Me[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=G.findOne(_e,this._indicatorsElement);t.classList.remove(Se),t.removeAttribute("aria-current");const n=G.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);n&&(n.classList.add(Se),n.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._isSliding)return;const n=this._getActive(),i=e===de,r=t||x(this._getItems(),n,i,this._config.wrap);if(r===n)return;const s=this._getItemIndex(r),a=t=>B.trigger(this._element,t,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(n),to:s});if(a(ge).defaultPrevented)return;if(!n||!r)return;const o=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(s),this._activeElement=r;const l=i?"carousel-item-start":"carousel-item-end",c=i?"carousel-item-next":"carousel-item-prev";r.classList.add(c),f(r),n.classList.add(l),r.classList.add(l),this._queueCallback((()=>{r.classList.remove(l,c),r.classList.add(Se),n.classList.remove(Se,c,l),this._isSliding=!1,a(ve)}),n,this._isAnimated()),o&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return G.findOne(Pe,this._element)}_getItems(){return G.find(Te,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return v()?e===fe?pe:de:e===fe?de:pe}_orderToDirection(e){return v()?e===pe?fe:me:e===pe?me:fe}static jQueryInterface(e){return this.each((function(){const t=Oe.getOrCreateInstance(this,e);if("number"!=typeof e){if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}else t.to(e)}))}}B.on(document,Ce,"[data-bs-slide], [data-bs-slide-to]",(function(e){const t=G.getElementFromSelector(this);if(!t||!t.classList.contains(Ae))return;e.preventDefault();const n=Oe.getOrCreateInstance(t),i=this.getAttribute("data-bs-slide-to");return i?(n.to(i),void n._maybeEnableCycle()):"next"===j.getDataAttribute(this,"slide")?(n.next(),void n._maybeEnableCycle()):(n.prev(),void n._maybeEnableCycle())})),B.on(window,Ee,(()=>{const e=G.find('[data-bs-ride="carousel"]');for(const t of e)Oe.getOrCreateInstance(t)})),y(Oe);const De=".bs.collapse",Le=`show${De}`,Re=`shown${De}`,ke=`hide${De}`,Be=`hidden${De}`,Ue=`click${De}.data-api`,ze="show",Fe="collapse",je="collapsing",Ve=`:scope .${Fe} .${Fe}`,He='[data-bs-toggle="collapse"]',We={parent:null,toggle:!0},Ge={parent:"(null|element)",toggle:"boolean"};class qe extends H{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const n=G.find(He);for(const i of n){const e=G.getSelectorFromElement(i),t=G.find(e).filter((e=>e===this._element));null!==e&&t.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return We}static get DefaultType(){return Ge}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((e=>e!==this._element)).map((e=>qe.getOrCreateInstance(e,{toggle:!1})))),e.length&&e[0]._isTransitioning)return;if(B.trigger(this._element,Le).defaultPrevented)return;for(const i of e)i.hide();const t=this._getDimension();this._element.classList.remove(Fe),this._element.classList.add(je),this._element.style[t]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const n=`scroll${t[0].toUpperCase()+t.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(je),this._element.classList.add(Fe,ze),this._element.style[t]="",B.trigger(this._element,Re)}),this._element,!0),this._element.style[t]=`${this._element[n]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(B.trigger(this._element,ke).defaultPrevented)return;const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,f(this._element),this._element.classList.add(je),this._element.classList.remove(Fe,ze);for(const t of this._triggerArray){const e=G.getElementFromSelector(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0,this._element.style[e]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(je),this._element.classList.add(Fe),B.trigger(this._element,Be)}),this._element,!0)}_isShown(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._element).classList.contains(ze)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=c(e.parent),e}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(He);for(const t of e){const e=G.getElementFromSelector(t);e&&this._addAriaAndCollapsedClass([t],this._isShown(e))}}_getFirstLevelChildren(e){const t=G.find(Ve,this._config.parent);return G.find(e,this._config.parent).filter((e=>!t.includes(e)))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const n of e)n.classList.toggle("collapsed",!t),n.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return"string"==typeof e&&/show|hide/.test(e)&&(t.toggle=!1),this.each((function(){const n=qe.getOrCreateInstance(this,t);if("string"==typeof e){if(void 0===n[e])throw new TypeError(`No method named "${e}"`);n[e]()}}))}}B.on(document,Ue,He,(function(e){("A"===e.target.tagName||e.delegateTarget&&"A"===e.delegateTarget.tagName)&&e.preventDefault();for(const t of G.getMultipleElementsFromSelector(this))qe.getOrCreateInstance(t,{toggle:!1}).toggle()})),y(qe);const Ke="dropdown",Ye=".bs.dropdown",Qe=".data-api",Xe="ArrowUp",Ze="ArrowDown",Je=`hide${Ye}`,$e=`hidden${Ye}`,et=`show${Ye}`,tt=`shown${Ye}`,nt=`click${Ye}${Qe}`,it=`keydown${Ye}${Qe}`,rt=`keyup${Ye}${Qe}`,st="show",at='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',ot=`${at}.${st}`,lt=".dropdown-menu",ct=v()?"top-end":"top-start",ht=v()?"top-start":"top-end",ut=v()?"bottom-end":"bottom-start",dt=v()?"bottom-start":"bottom-end",pt=v()?"left-start":"right-start",ft=v()?"right-start":"left-start",mt={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},gt={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class vt extends H{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=G.next(this._element,lt)[0]||G.prev(this._element,lt)[0]||G.findOne(lt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return mt}static get DefaultType(){return gt}static get NAME(){return Ke}toggle(){return this._isShown()?this.hide():this.show()}show(){if(u(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!B.trigger(this._element,et,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const e of[].concat(...document.body.children))B.on(e,"mouseover",p);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(st),this._element.classList.add(st),B.trigger(this._element,tt,e)}}hide(){if(u(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!B.trigger(this._element,Je,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))B.off(e,"mouseover",p);this._popper&&this._popper.destroy(),this._menu.classList.remove(st),this._element.classList.remove(st),this._element.setAttribute("aria-expanded","false"),j.removeDataAttribute(this._menu,"popper"),B.trigger(this._element,$e,e)}}_getConfig(e){if("object"==typeof(e=super._getConfig(e)).reference&&!l(e.reference)&&"function"!=typeof e.reference.getBoundingClientRect)throw new TypeError(`${Ke.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(void 0===n)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;"parent"===this._config.reference?e=this._parent:l(this._config.reference)?e=c(this._config.reference):"object"==typeof this._config.reference&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=n.createPopper(e,this._menu,t)}_isShown(){return this._menu.classList.contains(st)}_getPlacement(){const e=this._parent;if(e.classList.contains("dropend"))return pt;if(e.classList.contains("dropstart"))return ft;if(e.classList.contains("dropup-center"))return"top";if(e.classList.contains("dropdown-center"))return"bottom";const t="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return e.classList.contains("dropup")?t?ht:ct:t?dt:ut}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:e}=this._config;return"string"==typeof e?e.split(",").map((e=>Number.parseInt(e,10))):"function"==typeof e?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(j.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...b(this._config.popperConfig,[void 0,e])}}_selectMenuItem(e){let{key:t,target:n}=e;const i=G.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter((e=>h(e)));i.length&&x(i,n,t===Ze,!i.includes(n)).focus()}static jQueryInterface(e){return this.each((function(){const t=vt.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}static clearMenus(e){if(2===e.button||"keyup"===e.type&&"Tab"!==e.key)return;const t=G.find(ot);for(const n of t){const t=vt.getInstance(n);if(!t||!1===t._config.autoClose)continue;const i=e.composedPath(),r=i.includes(t._menu);if(i.includes(t._element)||"inside"===t._config.autoClose&&!r||"outside"===t._config.autoClose&&r)continue;if(t._menu.contains(e.target)&&("keyup"===e.type&&"Tab"===e.key||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const s={relatedTarget:t._element};"click"===e.type&&(s.clickEvent=e),t._completeHide(s)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),n="Escape"===e.key,i=[Xe,Ze].includes(e.key);if(!i&&!n)return;if(t&&!n)return;e.preventDefault();const r=this.matches(at)?this:G.prev(this,at)[0]||G.next(this,at)[0]||G.findOne(at,e.delegateTarget.parentNode),s=vt.getOrCreateInstance(r);if(i)return e.stopPropagation(),s.show(),void s._selectMenuItem(e);s._isShown()&&(e.stopPropagation(),s.hide(),r.focus())}}B.on(document,it,at,vt.dataApiKeydownHandler),B.on(document,it,lt,vt.dataApiKeydownHandler),B.on(document,nt,vt.clearMenus),B.on(document,rt,vt.clearMenus),B.on(document,nt,at,(function(e){e.preventDefault(),vt.getOrCreateInstance(this).toggle()})),y(vt);const yt="backdrop",bt="show",wt=`mousedown.bs.${yt}`,xt={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Et={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Ct extends V{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return xt}static get DefaultType(){return Et}static get NAME(){return yt}show(e){if(!this._config.isVisible)return void b(e);this._append();const t=this._getElement();this._config.isAnimated&&f(t),t.classList.add(bt),this._emulateAnimation((()=>{b(e)}))}hide(e){this._config.isVisible?(this._getElement().classList.remove(bt),this._emulateAnimation((()=>{this.dispose(),b(e)}))):b(e)}dispose(){this._isAppended&&(B.off(this._element,wt),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add("fade"),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=c(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),B.on(e,wt,(()=>{b(this._config.clickCallback)})),this._isAppended=!0}_emulateAnimation(e){w(e,this._getElement(),this._config.isAnimated)}}const At=".bs.focustrap",St=`focusin${At}`,_t=`keydown.tab${At}`,Tt="backward",Pt={autofocus:!0,trapElement:null},Mt={autofocus:"boolean",trapElement:"element"};class Nt extends V{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Pt}static get DefaultType(){return Mt}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),B.off(document,At),B.on(document,St,(e=>this._handleFocusin(e))),B.on(document,_t,(e=>this._handleKeydown(e))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,B.off(document,At))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const n=G.focusableChildren(t);0===n.length?t.focus():this._lastTabNavDirection===Tt?n[n.length-1].focus():n[0].focus()}_handleKeydown(e){"Tab"===e.key&&(this._lastTabNavDirection=e.shiftKey?Tt:"forward")}}const It=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Ot=".sticky-top",Dt="padding-right",Lt="margin-right";class Rt{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Dt,(t=>t+e)),this._setElementAttributes(It,Dt,(t=>t+e)),this._setElementAttributes(Ot,Lt,(t=>t-e))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Dt),this._resetElementAttributes(It,Dt),this._resetElementAttributes(Ot,Lt)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,n){const i=this.getWidth();this._applyManipulationCallback(e,(e=>{if(e!==this._element&&window.innerWidth>e.clientWidth+i)return;this._saveInitialAttribute(e,t);const r=window.getComputedStyle(e).getPropertyValue(t);e.style.setProperty(t,`${n(Number.parseFloat(r))}px`)}))}_saveInitialAttribute(e,t){const n=e.style.getPropertyValue(t);n&&j.setDataAttribute(e,t,n)}_resetElementAttributes(e,t){this._applyManipulationCallback(e,(e=>{const n=j.getDataAttribute(e,t);null!==n?(j.removeDataAttribute(e,t),e.style.setProperty(t,n)):e.style.removeProperty(t)}))}_applyManipulationCallback(e,t){if(l(e))t(e);else for(const n of G.find(e,this._element))t(n)}}const kt=".bs.modal",Bt=`hide${kt}`,Ut=`hidePrevented${kt}`,zt=`hidden${kt}`,Ft=`show${kt}`,jt=`shown${kt}`,Vt=`resize${kt}`,Ht=`click.dismiss${kt}`,Wt=`mousedown.dismiss${kt}`,Gt=`keydown.dismiss${kt}`,qt=`click${kt}.data-api`,Kt="modal-open",Yt="show",Qt="modal-static",Xt={backdrop:!0,focus:!0,keyboard:!0},Zt={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Jt extends H{constructor(e,t){super(e,t),this._dialog=G.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Rt,this._addEventListeners()}static get Default(){return Xt}static get DefaultType(){return Zt}static get NAME(){return"modal"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||B.trigger(this._element,Ft,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Kt),this._adjustDialog(),this._backdrop.show((()=>this._showElement(e))))}hide(){this._isShown&&!this._isTransitioning&&(B.trigger(this._element,Bt).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Yt),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated())))}dispose(){B.off(window,kt),B.off(this._dialog,kt),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Ct({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Nt({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=G.findOne(".modal-body",this._dialog);t&&(t.scrollTop=0),f(this._element),this._element.classList.add(Yt),this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,B.trigger(this._element,jt,{relatedTarget:e})}),this._dialog,this._isAnimated())}_addEventListeners(){B.on(this._element,Gt,(e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())})),B.on(window,Vt,(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),B.on(this._element,Wt,(e=>{B.one(this._element,Ht,(t=>{this._element===e.target&&this._element===t.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(Kt),this._resetAdjustments(),this._scrollBar.reset(),B.trigger(this._element,zt)}))}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(B.trigger(this._element,Ut).defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._element.style.overflowY;"hidden"===t||this._element.classList.contains(Qt)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(Qt),this._queueCallback((()=>{this._element.classList.remove(Qt),this._queueCallback((()=>{this._element.style.overflowY=t}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),n=t>0;if(n&&!e){const e=v()?"paddingLeft":"paddingRight";this._element.style[e]=`${t}px`}if(!n&&e){const e=v()?"paddingRight":"paddingLeft";this._element.style[e]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each((function(){const n=Jt.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===n[e])throw new TypeError(`No method named "${e}"`);n[e](t)}}))}}B.on(document,qt,'[data-bs-toggle="modal"]',(function(e){const t=G.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),B.one(t,Ft,(e=>{e.defaultPrevented||B.one(t,zt,(()=>{h(this)&&this.focus()}))}));const n=G.findOne(".modal.show");n&&Jt.getInstance(n).hide(),Jt.getOrCreateInstance(t).toggle(this)})),q(Jt),y(Jt);const $t=".bs.offcanvas",en=".data-api",tn=`load${$t}${en}`,nn="show",rn="showing",sn="hiding",an=".offcanvas.show",on=`show${$t}`,ln=`shown${$t}`,cn=`hide${$t}`,hn=`hidePrevented${$t}`,un=`hidden${$t}`,dn=`resize${$t}`,pn=`click${$t}${en}`,fn=`keydown.dismiss${$t}`,mn={backdrop:!0,keyboard:!0,scroll:!1},gn={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class vn extends H{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return mn}static get DefaultType(){return gn}static get NAME(){return"offcanvas"}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||B.trigger(this._element,on,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new Rt).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(rn),this._queueCallback((()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(nn),this._element.classList.remove(rn),B.trigger(this._element,ln,{relatedTarget:e})}),this._element,!0))}hide(){this._isShown&&(B.trigger(this._element,cn).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(sn),this._backdrop.hide(),this._queueCallback((()=>{this._element.classList.remove(nn,sn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new Rt).reset(),B.trigger(this._element,un)}),this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=Boolean(this._config.backdrop);return new Ct({className:"offcanvas-backdrop",isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?()=>{"static"!==this._config.backdrop?this.hide():B.trigger(this._element,hn)}:null})}_initializeFocusTrap(){return new Nt({trapElement:this._element})}_addEventListeners(){B.on(this._element,fn,(e=>{"Escape"===e.key&&(this._config.keyboard?this.hide():B.trigger(this._element,hn))}))}static jQueryInterface(e){return this.each((function(){const t=vn.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}B.on(document,pn,'[data-bs-toggle="offcanvas"]',(function(e){const t=G.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&e.preventDefault(),u(this))return;B.one(t,un,(()=>{h(this)&&this.focus()}));const n=G.findOne(an);n&&n!==t&&vn.getInstance(n).hide(),vn.getOrCreateInstance(t).toggle(this)})),B.on(window,tn,(()=>{for(const e of G.find(an))vn.getOrCreateInstance(e).show()})),B.on(window,dn,(()=>{for(const e of G.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(e).position&&vn.getOrCreateInstance(e).hide()})),q(vn),y(vn);const yn={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},bn=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),wn=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,xn=(e,t)=>{const n=e.nodeName.toLowerCase();return t.includes(n)?!bn.has(n)||Boolean(wn.test(e.nodeValue)):t.filter((e=>e instanceof RegExp)).some((e=>e.test(n)))},En={allowList:yn,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Cn={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},An={entry:"(string|element|function|null)",selector:"(string|element)"};class Sn extends V{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return En}static get DefaultType(){return Cn}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map((e=>this._resolvePossibleFunction(e))).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,r]of Object.entries(this._config.content))this._setContent(e,r,i);const t=e.children[0],n=this._resolvePossibleFunction(this._config.extraClass);return n&&t.classList.add(...n.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,n]of Object.entries(e))super._typeCheckConfig({selector:t,entry:n},An)}_setContent(e,t,n){const i=G.findOne(n,e);i&&((t=this._resolvePossibleFunction(t))?l(t)?this._putElementInTemplate(c(t),i):this._config.html?i.innerHTML=this._maybeSanitize(t):i.textContent=t:i.remove())}_maybeSanitize(e){return this._config.sanitize?function(e,t,n){if(!e.length)return e;if(n&&"function"==typeof n)return n(e);const i=(new window.DOMParser).parseFromString(e,"text/html"),r=[].concat(...i.body.querySelectorAll("*"));for(const s of r){const e=s.nodeName.toLowerCase();if(!Object.keys(t).includes(e)){s.remove();continue}const n=[].concat(...s.attributes),i=[].concat(t["*"]||[],t[e]||[]);for(const t of n)xn(t,i)||s.removeAttribute(t.nodeName)}return i.body.innerHTML}(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return b(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html)return t.innerHTML="",void t.append(e);t.textContent=e.textContent}}const _n=new Set(["sanitize","allowList","sanitizeFn"]),Tn="fade",Pn="show",Mn=".tooltip-inner",Nn=".modal",In="hide.bs.modal",On="hover",Dn="focus",Ln={AUTO:"auto",TOP:"top",RIGHT:v()?"left":"right",BOTTOM:"bottom",LEFT:v()?"right":"left"},Rn={allowList:yn,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},kn={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Bn extends H{constructor(e,t){if(void 0===n)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Rn}static get DefaultType(){return kn}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),B.off(this._element.closest(Nn),In,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const e=B.trigger(this._element,this.constructor.eventName("show")),t=(d(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!t)return;this._disposePopper();const n=this._getTipElement();this._element.setAttribute("aria-describedby",n.getAttribute("id"));const{container:i}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(i.append(n),B.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(n),n.classList.add(Pn),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))B.on(r,"mouseover",p);this._queueCallback((()=>{B.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1}),this.tip,this._isAnimated())}hide(){if(this._isShown()&&!B.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Pn),"ontouchstart"in document.documentElement)for(const e of[].concat(...document.body.children))B.off(e,"mouseover",p);this._activeTrigger.click=!1,this._activeTrigger[Dn]=!1,this._activeTrigger[On]=!1,this._isHovered=null,this._queueCallback((()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),B.trigger(this._element,this.constructor.eventName("hidden")))}),this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Tn,Pn),t.classList.add(`bs-${this.constructor.NAME}-auto`);const n=(e=>{do{e+=Math.floor(1e6*Math.random())}while(document.getElementById(e));return e})(this.constructor.NAME).toString();return t.setAttribute("id",n),this._isAnimated()&&t.classList.add(Tn),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Sn({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Mn]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Tn)}_isShown(){return this.tip&&this.tip.classList.contains(Pn)}_createPopper(e){const t=b(this._config.placement,[this,e,this._element]),i=Ln[t.toUpperCase()];return n.createPopper(this._element,e,this._getPopperConfig(i))}_getOffset(){const{offset:e}=this._config;return"string"==typeof e?e.split(",").map((e=>Number.parseInt(e,10))):"function"==typeof e?t=>e(t,this._element):e}_resolvePossibleFunction(e){return b(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:e=>{this._getTipElement().setAttribute("data-popper-placement",e.state.placement)}}]};return{...t,...b(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if("click"===t)B.on(this._element,this.constructor.eventName("click"),this._config.selector,(e=>{this._initializeOnDelegatedTarget(e).toggle()}));else if("manual"!==t){const e=t===On?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),n=t===On?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");B.on(this._element,e,this._config.selector,(e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusin"===e.type?Dn:On]=!0,t._enter()})),B.on(this._element,n,this._config.selector,(e=>{const t=this._initializeOnDelegatedTarget(e);t._activeTrigger["focusout"===e.type?Dn:On]=t._element.contains(e.relatedTarget),t._leave()}))}this._hideModalHandler=()=>{this._element&&this.hide()},B.on(this._element.closest(Nn),In,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout((()=>{this._isHovered&&this.show()}),this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout((()=>{this._isHovered||this.hide()}),this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=j.getDataAttributes(this._element);for(const n of Object.keys(t))_n.has(n)&&delete t[n];return e={...t,..."object"==typeof e&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=!1===e.container?document.body:c(e.container),"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,n]of Object.entries(this._config))this.constructor.Default[t]!==n&&(e[t]=n);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each((function(){const t=Bn.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}}y(Bn);const Un=".popover-header",zn=".popover-body",Fn={...Bn.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},jn={...Bn.DefaultType,content:"(null|string|element|function)"};class Vn extends Bn{static get Default(){return Fn}static get DefaultType(){return jn}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Un]:this._getTitle(),[zn]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each((function(){const t=Vn.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e]()}}))}}y(Vn);const Hn=".bs.scrollspy",Wn=`activate${Hn}`,Gn=`click${Hn}`,qn=`load${Hn}.data-api`,Kn="active",Yn="[href]",Qn=".nav-link",Xn=`${Qn}, .nav-item > ${Qn}, .list-group-item`,Zn={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Jn={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class $n extends H{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Zn}static get DefaultType(){return Jn}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=c(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,"string"==typeof e.threshold&&(e.threshold=e.threshold.split(",").map((e=>Number.parseFloat(e)))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(B.off(this._config.target,Gn),B.on(this._config.target,Gn,Yn,(e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const n=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(n.scrollTo)return void n.scrollTo({top:i,behavior:"smooth"});n.scrollTop=i}})))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver((e=>this._observerCallback(e)),e)}_observerCallback(e){const t=e=>this._targetLinks.get(`#${e.target.id}`),n=e=>{this._previousScrollData.visibleEntryTop=e.target.offsetTop,this._process(t(e))},i=(this._rootElement||document.documentElement).scrollTop,r=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const s of e){if(!s.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(s));continue}const e=s.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&e){if(n(s),!i)return}else r||e||n(s)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=G.find(Yn,this._config.target);for(const t of e){if(!t.hash||u(t))continue;const e=G.findOne(decodeURI(t.hash),this._element);h(e)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,e))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Kn),this._activateParents(e),B.trigger(this._element,Wn,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains("dropdown-item"))G.findOne(".dropdown-toggle",e.closest(".dropdown")).classList.add(Kn);else for(const t of G.parents(e,".nav, .list-group"))for(const e of G.prev(t,Xn))e.classList.add(Kn)}_clearActiveClass(e){e.classList.remove(Kn);const t=G.find(`${Yn}.${Kn}`,e);for(const n of t)n.classList.remove(Kn)}static jQueryInterface(e){return this.each((function(){const t=$n.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}))}}B.on(window,qn,(()=>{for(const e of G.find('[data-bs-spy="scroll"]'))$n.getOrCreateInstance(e)})),y($n);const ei=".bs.tab",ti=`hide${ei}`,ni=`hidden${ei}`,ii=`show${ei}`,ri=`shown${ei}`,si=`click${ei}`,ai=`keydown${ei}`,oi=`load${ei}`,li="ArrowLeft",ci="ArrowRight",hi="ArrowUp",ui="ArrowDown",di="Home",pi="End",fi="active",mi="fade",gi="show",vi=".dropdown-toggle",yi=`:not(${vi})`,bi='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',wi=`.nav-link${yi}, .list-group-item${yi}, [role="tab"]${yi}, ${bi}`,xi=`.${fi}[data-bs-toggle="tab"], .${fi}[data-bs-toggle="pill"], .${fi}[data-bs-toggle="list"]`;class Ei extends H{constructor(e){super(e),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),B.on(this._element,ai,(e=>this._keydown(e))))}static get NAME(){return"tab"}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),n=t?B.trigger(t,ti,{relatedTarget:e}):null;B.trigger(e,ii,{relatedTarget:t}).defaultPrevented||n&&n.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){e&&(e.classList.add(fi),this._activate(G.getElementFromSelector(e)),this._queueCallback((()=>{"tab"===e.getAttribute("role")?(e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),B.trigger(e,ri,{relatedTarget:t})):e.classList.add(gi)}),e,e.classList.contains(mi)))}_deactivate(e,t){e&&(e.classList.remove(fi),e.blur(),this._deactivate(G.getElementFromSelector(e)),this._queueCallback((()=>{"tab"===e.getAttribute("role")?(e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),B.trigger(e,ni,{relatedTarget:t})):e.classList.remove(gi)}),e,e.classList.contains(mi)))}_keydown(e){if(![li,ci,hi,ui,di,pi].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter((e=>!u(e)));let n;if([di,pi].includes(e.key))n=t[e.key===di?0:t.length-1];else{const i=[ci,ui].includes(e.key);n=x(t,e.target,i,!0)}n&&(n.focus({preventScroll:!0}),Ei.getOrCreateInstance(n).show())}_getChildren(){return G.find(wi,this._parent)}_getActiveElem(){return this._getChildren().find((e=>this._elemIsActive(e)))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const n of t)this._setInitialAttributesOnChild(n)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),n=this._getOuterElement(e);e.setAttribute("aria-selected",t),n!==e&&this._setAttributeIfNotExists(n,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=G.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const n=this._getOuterElement(e);if(!n.classList.contains("dropdown"))return;const i=(e,i)=>{const r=G.findOne(e,n);r&&r.classList.toggle(i,t)};i(vi,fi),i(".dropdown-menu",gi),n.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,n){e.hasAttribute(t)||e.setAttribute(t,n)}_elemIsActive(e){return e.classList.contains(fi)}_getInnerElement(e){return e.matches(wi)?e:G.findOne(wi,e)}_getOuterElement(e){return e.closest(".nav-item, .list-group-item")||e}static jQueryInterface(e){return this.each((function(){const t=Ei.getOrCreateInstance(this);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}))}}B.on(document,si,bi,(function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),u(this)||Ei.getOrCreateInstance(this).show()})),B.on(window,oi,(()=>{for(const e of G.find(xi))Ei.getOrCreateInstance(e)})),y(Ei);const Ci=".bs.toast",Ai=`mouseover${Ci}`,Si=`mouseout${Ci}`,_i=`focusin${Ci}`,Ti=`focusout${Ci}`,Pi=`hide${Ci}`,Mi=`hidden${Ci}`,Ni=`show${Ci}`,Ii=`shown${Ci}`,Oi="hide",Di="show",Li="showing",Ri={animation:"boolean",autohide:"boolean",delay:"number"},ki={animation:!0,autohide:!0,delay:5e3};class Bi extends H{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return ki}static get DefaultType(){return Ri}static get NAME(){return"toast"}show(){B.trigger(this._element,Ni).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Oi),f(this._element),this._element.classList.add(Di,Li),this._queueCallback((()=>{this._element.classList.remove(Li),B.trigger(this._element,Ii),this._maybeScheduleHide()}),this._element,this._config.animation))}hide(){this.isShown()&&(B.trigger(this._element,Pi).defaultPrevented||(this._element.classList.add(Li),this._queueCallback((()=>{this._element.classList.add(Oi),this._element.classList.remove(Li,Di),B.trigger(this._element,Mi)}),this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Di),super.dispose()}isShown(){return this._element.classList.contains(Di)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":this._hasMouseInteraction=t;break;case"focusin":case"focusout":this._hasKeyboardInteraction=t}if(t)return void this._clearTimeout();const n=e.relatedTarget;this._element===n||this._element.contains(n)||this._maybeScheduleHide()}_setListeners(){B.on(this._element,Ai,(e=>this._onInteraction(e,!0))),B.on(this._element,Si,(e=>this._onInteraction(e,!1))),B.on(this._element,_i,(e=>this._onInteraction(e,!0))),B.on(this._element,Ti,(e=>this._onInteraction(e,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each((function(){const t=Bi.getOrCreateInstance(this,e);if("string"==typeof e){if(void 0===t[e])throw new TypeError(`No method named "${e}"`);t[e](this)}}))}}return q(Bi),y(Bi),{Alert:X,Button:J,Carousel:Oe,Collapse:qe,Dropdown:vt,Modal:Jt,Offcanvas:vn,Popover:Vn,ScrollSpy:$n,Tab:Ei,Toast:Bi,Tooltip:Bn}}(n(51738))},74817:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e.reduce(((e,n)=>{const i=String(n[t]);return e[i]||(e[i]=[]),e[i].push(n),e}),{})}},75984:e=>{"use strict";function t(e){try{return JSON.stringify(e)}catch(t){return'"[Circular]"'}}e.exports=function(e,n,i){var r=i&&i.stringify||t;if("object"===typeof e&&null!==e){var s=n.length+1;if(1===s)return e;var a=new Array(s);a[0]=r(e);for(var o=1;o<s;o++)a[o]=r(n[o]);return a.join(" ")}if("string"!==typeof e)return e;var l=n.length;if(0===l)return e;for(var c="",h=0,u=-1,d=e&&e.length||0,p=0;p<d;){if(37===e.charCodeAt(p)&&p+1<d){switch(u=u>-1?u:0,e.charCodeAt(p+1)){case 100:case 102:if(h>=l)break;if(null==n[h])break;u<p&&(c+=e.slice(u,p)),c+=Number(n[h]),u=p+2,p++;break;case 105:if(h>=l)break;if(null==n[h])break;u<p&&(c+=e.slice(u,p)),c+=Math.floor(Number(n[h])),u=p+2,p++;break;case 79:case 111:case 106:if(h>=l)break;if(void 0===n[h])break;u<p&&(c+=e.slice(u,p));var f=typeof n[h];if("string"===f){c+="'"+n[h]+"'",u=p+2,p++;break}if("function"===f){c+=n[h].name||"<anonymous>",u=p+2,p++;break}c+=r(n[h]),u=p+2,p++;break;case 115:if(h>=l)break;u<p&&(c+=e.slice(u,p)),c+=String(n[h]),u=p+2,p++;break;case 37:u<p&&(c+=e.slice(u,p)),c+="%",u=p+2,p++,h--}++h}++p}if(-1===u)return e;u<d&&(c+=e.slice(u));return c}},76844:(e,t,n)=>{"use strict";n.d(t,{u$:()=>r,zC:()=>s});var i=n(38993);function r(e,t,n,r){let s=e[t];return(0,i.B1)(e,(()=>{const i=e[t];Object.is(s,i)||n(s=i)}),r)}Symbol();function s(e){const t=(0,i.BX)({data:Array.from(e||[]),has(e){return this.data.some((t=>t[0]===e))},set(e,t){const n=this.data.find((t=>t[0]===e));return n?n[1]=t:this.data.push([e,t]),this},get(e){var t;return null==(t=this.data.find((t=>t[0]===e)))?void 0:t[1]},delete(e){const t=this.data.findIndex((t=>t[0]===e));return-1!==t&&(this.data.splice(t,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(e){this.data.forEach((t=>{e(t[1],t[0],this)}))},keys(){return this.data.map((e=>e[0])).values()},values(){return this.data.map((e=>e[1])).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(t,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(t),t}},78628:(e,t,n)=>{"use strict";function i(){let e=()=>{},t=()=>{};return{promise:new Promise(((n,i)=>{e=n,t=i})),resolve:e,reject:t}}n.d(t,{Y:()=>i})},78853:(e,t,n)=>{"use strict";e.exports=n(5896)},79323:(e,t,n)=>{"use strict";n.d(t,{E:()=>m});var i=n(38993),r=n(80883),s=n(49477),a=n(24657),o=n(64564),l=n(595),c=n(63542),h=n(42661);const u=a.w.getAnalyticsUrl(),d=new o.Z({baseUrl:u,clientId:null}),p=["MODAL_CREATED"],f=(0,i.BX)({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),m={state:f,subscribe:e=>(0,i.B1)(f,(()=>e(f))),getSdkProperties(){const{projectId:e,sdkType:t,sdkVersion:n}=h.H.state;return{projectId:e,st:t,sv:n||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(e){try{const t=l.U.state.address;if(p.includes(e.data.event)||"undefined"===typeof window)return;await d.post({path:"/e",params:m.getSdkProperties(),body:{eventId:a.w.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:e.timestamp,props:{...e.data,address:t}}}),f.reportedErrors.FORBIDDEN=!1}catch(t){t instanceof Error&&t.cause instanceof Response&&t.cause.status===r.o.HTTP_STATUS_CODES.FORBIDDEN&&!f.reportedErrors.FORBIDDEN&&(c.h.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${(0,s.IP)()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),f.reportedErrors.FORBIDDEN=!0)}},sendEvent(e){f.timestamp=Date.now(),f.data=e,h.H.state.features?.analytics&&m._sendAnalyticsEvent(f)}}},80629:(e,t,n)=>{"use strict";n.d(t,{g:()=>p});var i=n(80883),r=n(42661),s=n(88861),a=n(16496),o=n(24657),l=n(93022),c=n(15814),h=n(73939),u=n(99251),d=n(93005);const p={getConnectorsByType(e,t,n){const{customWallets:i}=r.H.state,a=s.i.getRecentWallets(),o=d.A.filterOutDuplicateWallets(t),l=d.A.filterOutDuplicateWallets(n),c=e.filter((e=>"MULTI_CHAIN"===e.type)),h=e.filter((e=>"ANNOUNCED"===e.type)),u=e.filter((e=>"INJECTED"===e.type));return{custom:i,recent:a,external:e.filter((e=>"EXTERNAL"===e.type)),multiChain:c,announced:h,injected:u,recommended:o,featured:l}},showConnector(e){const t=e.info?.rdns,n=Boolean(t)&&a.N.state.excludedWallets.some((e=>Boolean(e.rdns)&&e.rdns===t)),i=Boolean(e.name)&&a.N.state.excludedWallets.some((t=>u.y.isLowerCaseMatch(t.name,e.name)));if("INJECTED"===e.type){if(!o.w.isMobile()&&"Browser Wallet"===e.name)return!1;if(!t&&!l.x.checkInstalled())return!1;if(n||i)return!1}return"ANNOUNCED"!==e.type&&"EXTERNAL"!==e.type||!n&&!i},getIsConnectedWithWC:()=>Array.from(c.W.state.chains.values()).some((e=>h.a.getConnectorId(e.namespace)===i.o.CONNECTOR_ID.WALLET_CONNECT)),getConnectorTypeOrder(e){let{recommended:t,featured:n,custom:i,recent:s,announced:a,injected:o,multiChain:l,external:c,overriddenConnectors:h=r.H.state.features?.connectorTypeOrder??[]}=e;const u=p.getIsConnectedWithWC(),d=[{type:"walletConnect",isEnabled:r.H.state.enableWalletConnect&&!u},{type:"recent",isEnabled:s.length>0},{type:"injected",isEnabled:[...o,...a,...l].length>0},{type:"featured",isEnabled:n.length>0},{type:"custom",isEnabled:i&&i.length>0},{type:"external",isEnabled:c.length>0},{type:"recommended",isEnabled:t.length>0}].filter((e=>e.isEnabled)),f=new Set(d.map((e=>e.type))),m=h.filter((e=>f.has(e))).map((e=>({type:e,isEnabled:!0}))),g=d.filter((e=>{let{type:t}=e;return!m.some((e=>{let{type:n}=e;return n===t}))}));return Array.from(new Set([...m,...g].map((e=>{let{type:t}=e;return t}))))}}},80883:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});const i={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network"}},81064:(e,t,n)=>{"use strict";n.d(t,{S:()=>O});var i=n(108);const r=BigInt(2**32-1),s=BigInt(32);function a(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&r),l:Number(e>>s&r)}:{h:0|Number(e>>s&r),l:0|Number(e&r)}}function o(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let r=0;r<e.length;r++){const{h:s,l:o}=a(e[r],t);[n[r],i[r]]=[s,o]}return[n,i]}const l=(e,t,n)=>e<<n|t>>>32-n,c=(e,t,n)=>t<<n|e>>>32-n,h=(e,t,n)=>t<<n-32|e>>>64-n,u=(e,t,n)=>e<<n-32|t>>>64-n;var d=n(90464);const p=[],f=[],m=[],g=BigInt(0),v=BigInt(1),y=BigInt(2),b=BigInt(7),w=BigInt(256),x=BigInt(113);for(let D=0,L=v,R=1,k=0;D<24;D++){[R,k]=[k,(2*R+3*k)%5],p.push(2*(5*k+R)),f.push((D+1)*(D+2)/2%64);let e=g;for(let t=0;t<7;t++)L=(L<<v^(L>>b)*x)%w,L&y&&(e^=v<<(v<<BigInt(t))-v);m.push(e)}const[E,C]=o(m,!0),A=(e,t,n)=>n>32?h(e,t,n):l(e,t,n),S=(e,t,n)=>n>32?u(e,t,n):c(e,t,n);class _ extends d.Vw{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=r,this.rounds=s,(0,i.Fe)(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,d.DH)(this.state)}keccak(){d.qv||(0,d.Fc)(this.state32),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;const n=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){const t=(i+8)%10,r=(i+2)%10,s=n[r],a=n[r+1],o=A(s,a,1)^n[t],l=S(s,a,1)^n[t+1];for(let n=0;n<50;n+=10)e[i+n]^=o,e[i+n+1]^=l}let t=e[2],r=e[3];for(let n=0;n<24;n++){const i=f[n],s=A(t,r,i),a=S(t,r,i),o=p[n];t=e[o],r=e[o+1],e[o]=s,e[o+1]=a}for(let i=0;i<50;i+=10){for(let t=0;t<10;t++)n[t]=e[i+t];for(let t=0;t<10;t++)e[i+t]^=~n[(t+2)%10]&n[(t+4)%10]}e[0]^=E[i],e[1]^=C[i]}n.fill(0)}(this.state32,this.rounds),d.qv||(0,d.Fc)(this.state32),this.posOut=0,this.pos=0}update(e){(0,i.CC)(this);const{blockLen:t,state:n}=this,r=(e=(0,d.ZJ)(e)).length;for(let i=0;i<r;){const s=Math.min(t-this.pos,r-i);for(let t=0;t<s;t++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:i}=this;e[n]^=t,0!==(128&t)&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){(0,i.CC)(this,!1),(0,i.DO)(e),this.finish();const t=this.state,{blockLen:n}=this;for(let i=0,r=e.length;i<r;){this.posOut>=n&&this.keccak();const s=Math.min(n-this.posOut,r-i);e.set(t.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,i.Fe)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,i.Ht)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:i,rounds:r,enableXOF:s}=this;return e||(e=new _(t,n,i,s,r)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=r,e.suffix=n,e.outputLen=i,e.enableXOF=s,e.destroyed=this.destroyed,e}}const T=(e,t,n)=>(0,d.ld)((()=>new _(t,e,n))),P=T(1,136,32);var M=n(31499),N=n(37131),I=n(84117);function O(e,t){const n=t||"hex",i=P((0,M.q)(e,{strict:!1})?(0,N.ZJ)(e):e);return"bytes"===n?i:(0,I.nj)(i)}},83003:(e,t,n)=>{"use strict";n.d(t,{$s:()=>c,Kc:()=>u,Kz:()=>h,Vg:()=>l,WA:()=>d,aO:()=>a,n3:()=>o});var i=n(1273),r=n(4569),s=n(21627);function a(e){const t=Object.entries(e).map((e=>{let[t,n]=e;return void 0===n||!1===n?null:[t,n]})).filter(Boolean),n=t.reduce(((e,t)=>{let[n]=t;return Math.max(e,n.length)}),0);return t.map((e=>{let[t,i]=e;return`  ${`${t}:`.padEnd(n+1)}  ${i}`})).join("\n")}class o extends s.C{constructor(){super(["Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.","Use `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others."].join("\n"),{name:"FeeConflictError"})}}s.C;class l extends s.C{constructor(e){let{transaction:t}=e;super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",a(t),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}}s.C;s.C;s.C;class c extends s.C{constructor(e,t){let{account:n,docsPath:s,chain:o,data:l,gas:c,gasPrice:h,maxFeePerGas:u,maxPriorityFeePerGas:d,nonce:p,to:f,value:m}=t;const g=a({chain:o&&`${o?.name} (id: ${o?.id})`,from:n?.address,to:f,value:"undefined"!==typeof m&&`${(0,i.c)(m)} ${o?.nativeCurrency?.symbol||"ETH"}`,data:l,gas:c,gasPrice:"undefined"!==typeof h&&`${(0,r.Q)(h)} gwei`,maxFeePerGas:"undefined"!==typeof u&&`${(0,r.Q)(u)} gwei`,maxPriorityFeePerGas:"undefined"!==typeof d&&`${(0,r.Q)(d)} gwei`,nonce:p});super(e.shortMessage,{cause:e,docsPath:s,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Request Arguments:",g].filter(Boolean),name:"TransactionExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class h extends s.C{constructor(e){let{blockHash:t,blockNumber:n,blockTag:i,hash:r,index:s}=e,a="Transaction";i&&void 0!==s&&(a=`Transaction at block time "${i}" at index "${s}"`),t&&void 0!==s&&(a=`Transaction at block hash "${t}" at index "${s}"`),n&&void 0!==s&&(a=`Transaction at block number "${n}" at index "${s}"`),r&&(a=`Transaction with hash "${r}"`),super(`${a} could not be found.`,{name:"TransactionNotFoundError"})}}class u extends s.C{constructor(e){let{hash:t}=e;super(`Transaction receipt with hash "${t}" could not be found. The Transaction may not be processed on a block yet.`,{name:"TransactionReceiptNotFoundError"})}}class d extends s.C{constructor(e){let{hash:t}=e;super(`Timed out while waiting for transaction with hash "${t}" to be confirmed.`,{name:"WaitForTransactionReceiptTimeoutError"})}}},83793:(e,t,n)=>{"use strict";n.d(t,{f:()=>m});var i=n(38993),r=n(76844);const s=2147483648,a={convertEVMChainIdToCoinType(e){if(e>=s)throw new Error("Invalid chainId");return(s|e)>>>0}};var o=n(88861),l=n(595),c=n(65618),h=n(15814),u=n(93022),d=n(73939),p=n(61139);const f=(0,i.BX)({suggestions:[],loading:!1}),m={state:f,subscribe:e=>(0,i.B1)(f,(()=>e(f))),subscribeKey:(e,t)=>(0,r.u$)(f,e,t),async resolveName(e){try{return await c.T.lookupEnsName(e)}catch(t){const e=t;throw new Error(e?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(e){try{return await c.T.lookupEnsName(e),!0}catch{return!1}},async getSuggestions(e){try{f.loading=!0,f.suggestions=[];const t=await c.T.getEnsNameSuggestions(e);return f.suggestions=t.suggestions.map((e=>({...e,name:e.name})))||[],f.suggestions}catch(t){const e=this.parseEnsApiError(t,"Error fetching name suggestions");throw new Error(e)}finally{f.loading=!1}},async getNamesForAddress(e){try{if(!h.W.state.activeCaipNetwork)return[];const t=o.i.getEnsFromCacheForAddress(e);if(t)return t;const n=await c.T.reverseLookupEnsName({address:e});return o.i.updateEnsCache({address:e,ens:n,timestamp:Date.now()}),n}catch(t){const e=this.parseEnsApiError(t,"Error fetching names for address");throw new Error(e)}},async registerName(e){const t=h.W.state.activeCaipNetwork;if(!t)throw new Error("Network not found");const n=l.U.state.address,i=d.a.getAuthConnector();if(!n||!i)throw new Error("Address or auth connector not found");f.loading=!0;try{const i=JSON.stringify({name:e,attributes:{},timestamp:Math.floor(Date.now()/1e3)});p.I.pushTransactionStack({view:"RegisterAccountNameSuccess",goBack:!1,replace:!0,onCancel(){f.loading=!1}});const r=await u.x.signMessage(i),s=t.id;if(!s)throw new Error("Network not found");const o=a.convertEVMChainIdToCoinType(Number(s));await c.T.registerEnsName({coinType:o,address:n,signature:r,message:i}),l.U.setProfileName(e,t.chainNamespace),p.I.replace("RegisterAccountNameSuccess")}catch(r){const t=this.parseEnsApiError(r,`Error registering name ${e}`);throw p.I.replace("RegisterAccountName"),new Error(t)}finally{f.loading=!1}},validateName:e=>/^[a-zA-Z0-9-]{4,}$/u.test(e),parseEnsApiError(e,t){const n=e;return n?.reasons?.[0]?.description||t}}},84117:(e,t,n)=>{"use strict";n.d(t,{$P:()=>l,My:()=>c,cK:()=>h,i3:()=>d,nj:()=>o});var i=n(3458),r=n(17143),s=n(67962);const a=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"number"===typeof e||"bigint"===typeof e?h(e,t):"string"===typeof e?d(e,t):"boolean"===typeof e?l(e,t):c(e,t)}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=`0x${Number(e)}`;return"number"===typeof t.size?((0,s.Sl)(n,{size:t.size}),(0,r.eV)(n,{size:t.size})):n}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="";for(let r=0;r<e.length;r++)n+=a[e[r]];const i=`0x${n}`;return"number"===typeof t.size?((0,s.Sl)(i,{size:t.size}),(0,r.eV)(i,{dir:"right",size:t.size})):i}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{signed:n,size:s}=t,a=BigInt(e);let o;s?o=n?(1n<<8n*BigInt(s)-1n)-1n:2n**(8n*BigInt(s))-1n:"number"===typeof e&&(o=BigInt(Number.MAX_SAFE_INTEGER));const l="bigint"===typeof o&&n?-o-1n:0;if(o&&a>o||a<l){const t="bigint"===typeof e?"n":"";throw new i.Ty({max:o?`${o}${t}`:void 0,min:`${l}${t}`,signed:n,size:s,value:`${e}${t}`})}const c=`0x${(n&&a<0?(1n<<BigInt(8*s))+BigInt(a):a).toString(16)}`;return s?(0,r.eV)(c,{size:s}):c}const u=new TextEncoder;function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(u.encode(e),t)}},84391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(97004)},84657:(e,t,n)=>{"use strict";n.d(t,{Db:()=>s,oU:()=>a,tM:()=>r});const i=("undefined"!==typeof process?{NODE_ENV:"production",PUBLIC_URL:"/build",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PROJECT_ID:"bb8edcd28daf7c13ce0a49cafab2782d"}.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",r=[{label:"Coinbase",name:"coinbase",feeRange:"1-2%",url:"",supportedChains:["eip155"]},{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],s="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",a={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:i,SECURE_SITE_DASHBOARD:`${i}/dashboard`,SECURE_SITE_FAVICON:`${i}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],WC_COINBASE_PAY_SDK_CHAINS:["ethereum","arbitrum","polygon","berachain","avalanche-c-chain","optimism","celo","base"],WC_COINBASE_PAY_SDK_FALLBACK_CHAIN:"ethereum",WC_COINBASE_PAY_SDK_CHAIN_NAME_MAP:{Ethereum:"ethereum","Arbitrum One":"arbitrum",Polygon:"polygon",Berachain:"berachain",Avalanche:"avalanche-c-chain","OP Mainnet":"optimism",Celo:"celo",Base:"base"},WC_COINBASE_ONRAMP_APP_ID:"bf18c88d-495a-463b-b249-0b9d3656cf5e",SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:["eip155","solana"],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:["eip155"],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:["eip155","solana"],ACTIVITY_ENABLED_CHAIN_NAMESPACES:["eip155"],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in a new browser tab"},DEFAULT_FEATURES:{swaps:!0,onramp:!0,receive:!0,send:!0,email:!0,emailShowWallets:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],history:!0,analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0},DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"}}},87049:(e,t,n)=>{"use strict";n.d(t,{t:()=>c});var i=n(595),r=n(65618),s=n(15814),a=n(93022),o=n(10306);const l={createBalance(e,t){const n={name:e.metadata.name||"",symbol:e.metadata.symbol||"",decimals:e.metadata.decimals||0,value:e.metadata.value||0,price:e.metadata.price||0,iconUrl:e.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:t,address:"native"===e.address?void 0:this.convertAddressToCAIP10Address(e.address,t),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:e.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance(e){let{hex:t,decimals:n}=e;return(0,o.J)(BigInt(t),n)},convertAddressToCAIP10Address:(e,t)=>`${t}:${e}`,createCAIP2ChainId:(e,t)=>`${t}:${parseInt(e,16)}`,getChainIdHexFromCAIP2ChainId(e){const t=e.split(":");if(t.length<2||!t[1])return"0x0";const n=t[1],i=parseInt(n,10);return isNaN(i)?"0x0":`0x${i.toString(16)}`},isWalletGetAssetsResponse(e){return"object"===typeof e&&null!==e&&Object.values(e).every((e=>Array.isArray(e)&&e.every((e=>this.isValidAsset(e)))))},isValidAsset:e=>"object"===typeof e&&null!==e&&"string"===typeof e.address&&"string"===typeof e.balance&&("ERC20"===e.type||"NATIVE"===e.type)&&"object"===typeof e.metadata&&null!==e.metadata&&"string"===typeof e.metadata.name&&"string"===typeof e.metadata.symbol&&"number"===typeof e.metadata.decimals&&"number"===typeof e.metadata.price&&"string"===typeof e.metadata.iconUrl},c={async getMyTokensWithBalance(e){const t=i.U.state.address,n=s.W.state.activeCaipNetwork;if(!t||!n)return[];if("eip155"===n.chainNamespace){const e=await this.getEIP155Balances(t,n);if(e)return this.filterLowQualityTokens(e)}const a=await r.T.getBalance(t,n.caipNetworkId,e);return this.filterLowQualityTokens(a.balances)},async getEIP155Balances(e,t){try{const n=l.getChainIdHexFromCAIP2ChainId(t.caipNetworkId),i=await a.x.getCapabilities(e);if(!i?.[n]?.assetDiscovery?.supported)return null;const r=await a.x.walletGetAssets({account:e,chainFilter:[n]});if(!l.isWalletGetAssetsResponse(r))return null;return(r[n]||[]).map((e=>l.createBalance(e,t.caipNetworkId)))}catch(n){return null}},filterLowQualityTokens:e=>e.filter((e=>"0"!==e.quantity.decimals)),mapBalancesToSwapTokens:e=>e?.map((e=>({...e,address:e?.address?e.address:s.W.getActiveNetworkTokenAddress(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]}},87942:(e,t,n)=>{"use strict";n.d(t,{zX:()=>v,bG:()=>y,M:()=>b,rR:()=>w,Po:()=>x,$S:()=>E});var i=n(64034),r=n(19048),s=n(74745),a=n(59052),o=n(23512);function l(e){let{abiItem:t,args:n,includeFunctionName:i=!0,includeName:r=!1}=e;if("name"in t&&"inputs"in t&&t.inputs)return`${i?t.name:""}(${t.inputs.map(((e,t)=>`${r&&e.name?`${e.name}: `:""}${"object"===typeof n[t]?(0,o.A)(n[t]):n[t]}`)).join(", ")})`}var c=n(2283),h=n(1273),u=n(4569),d=n(97965),p=n(21627),f=n(21602),m=n(83003),g=n(91218);class v extends p.C{constructor(e,t){let{account:n,docsPath:r,chain:s,data:a,gas:o,gasPrice:l,maxFeePerGas:c,maxPriorityFeePerGas:d,nonce:p,to:g,value:v,stateOverride:y}=t;const b=n?(0,i.J)(n):void 0;let w=(0,m.aO)({from:b?.address,to:g,value:"undefined"!==typeof v&&`${(0,h.c)(v)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:a,gas:o,gasPrice:"undefined"!==typeof l&&`${(0,u.Q)(l)} gwei`,maxFeePerGas:"undefined"!==typeof c&&`${(0,u.Q)(c)} gwei`,maxPriorityFeePerGas:"undefined"!==typeof d&&`${(0,u.Q)(d)} gwei`,nonce:p});y&&(w+=`\n${(0,f.uj)(y)}`),super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Raw Call Arguments:",w].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class y extends p.C{constructor(e,t){let{abi:n,args:i,contractAddress:r,docsPath:s,functionName:o,sender:h}=t;const u=(0,c.iY)({abi:n,args:i,name:o}),d=u?l({abiItem:u,args:i,includeFunctionName:!1,includeName:!1}):void 0,p=u?(0,a.B)(u,{includeName:!0}):void 0,f=(0,m.aO)({address:r&&(0,g.R)(r),function:p,args:d&&"()"!==d&&`${[...Array(o?.length??0).keys()].map((()=>" ")).join("")}${d}`,sender:h});super(e.shortMessage||`An unknown error occurred while executing the contract function "${o}".`,{cause:e,docsPath:s,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],f&&"Contract Call:",f].filter(Boolean),name:"ContractFunctionExecutionError"}),Object.defineProperty(this,"abi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formattedArgs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"functionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sender",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abi=n,this.args=i,this.cause=e,this.contractAddress=r,this.functionName=o,this.sender=h}}class b extends p.C{constructor(e){let t,n,i,o,c,{abi:h,data:u,functionName:p,message:f}=e;if(u&&"0x"!==u)try{n=(0,s.W)({abi:h,data:u});const{abiItem:e,errorName:t,args:c}=n;if("Error"===t)o=c[0];else if("Panic"===t){const[e]=c;o=r.fD[e]}else{const n=e?(0,a.B)(e,{includeName:!0}):void 0,r=e&&c?l({abiItem:e,args:c,includeFunctionName:!1,includeName:!1}):void 0;i=[n?`Error: ${n}`:"",r&&"()"!==r?`       ${[...Array(t?.length??0).keys()].map((()=>" ")).join("")}${r}`:""]}}catch(m){t=m}else f&&(o=f);t instanceof d.Wq&&(c=t.signature,i=[`Unable to decode signature "${c}" as it was not found on the provided ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${c}.`]),super(o&&"execution reverted"!==o||c?[`The contract function "${p}" reverted with the following ${c?"signature":"reason"}:`,o||c].join("\n"):`The contract function "${p}" reverted.`,{cause:t,metaMessages:i,name:"ContractFunctionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"raw",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reason",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n,this.raw=u,this.reason=o,this.signature=c}}class w extends p.C{constructor(e){let{functionName:t}=e;super(`The contract function "${t}" returned no data ("0x").`,{metaMessages:["This could be due to any of the following:",`  - The contract does not have the function "${t}",`,"  - The parameters passed to the contract function may be invalid, or","  - The address is not a contract."],name:"ContractFunctionZeroDataError"})}}class x extends p.C{constructor(e){let{factory:t}=e;super("Deployment for counterfactual contract call failed"+(t?` for factory "${t}".`:""),{metaMessages:["Please ensure:","- The `factory` is a valid contract deployment factory (ie. Create2 Factory, ERC-4337 Factory, etc).","- The `factoryData` is a valid encoded function call for contract deployment function on the factory."],name:"CounterfactualDeploymentFailedError"})}}class E extends p.C{constructor(e){let{data:t,message:n}=e;super(n||"",{name:"RawContractError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t}}},88861:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});var i=n(49477);const r={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired:(e,t)=>Date.now()-e>t,getActiveNetworkProps(){const e=r.getActiveNamespace(),t=r.getActiveCaipNetworkId(),n=t?t.split(":")[1]:void 0;return{namespace:e,caipNetworkId:t,chainId:n?isNaN(Number(n))?n:Number(n):void 0}},setWalletConnectDeepLink(e){let{name:t,href:n}=e;try{i.Ud.setItem(i.Ws.DEEPLINK_CHOICE,JSON.stringify({href:n,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const e=i.Ud.getItem(i.Ws.DEEPLINK_CHOICE);if(e)return JSON.parse(e)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{i.Ud.removeItem(i.Ws.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(e){try{i.Ud.setItem(i.Ws.ACTIVE_NAMESPACE,e)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(e){try{i.Ud.setItem(i.Ws.ACTIVE_CAIP_NETWORK_ID,e),r.setActiveNamespace(e.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return i.Ud.getItem(i.Ws.ACTIVE_CAIP_NETWORK_ID)}catch{return void console.info("Unable to get active caip network id")}},deleteActiveCaipNetworkId(){try{i.Ud.removeItem(i.Ws.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(e){try{const t=(0,i.T8)(e);i.Ud.removeItem(t)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(e){try{const t=r.getRecentWallets();t.find((t=>t.id===e.id))||(t.unshift(e),t.length>2&&t.pop(),i.Ud.setItem(i.Ws.RECENT_WALLETS,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const e=i.Ud.getItem(i.Ws.RECENT_WALLETS);return e?JSON.parse(e):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(e,t){try{const n=(0,i.T8)(e);i.Ud.setItem(n,t)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return i.Ud.getItem(i.Ws.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(e){if(e)try{const t=(0,i.T8)(e);return i.Ud.getItem(t)}catch(t){console.info("Unable to get connected connector id in namespace ",e)}},setConnectedSocialProvider(e){try{i.Ud.setItem(i.Ws.CONNECTED_SOCIAL,e)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return i.Ud.getItem(i.Ws.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{i.Ud.removeItem(i.Ws.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return i.Ud.getItem(i.Ws.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){const e=i.Ud.getItem(i.Ws.ACTIVE_CAIP_NETWORK_ID),t=e?.split(":")?.[1];return t},setConnectionStatus(e){try{i.Ud.setItem(i.Ws.CONNECTION_STATUS,e)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return i.Ud.getItem(i.Ws.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const e=i.Ud.getItem(i.Ws.CONNECTED_NAMESPACES);return e?.length?e.split(","):[]}catch{return[]}},setConnectedNamespaces(e){try{const t=Array.from(new Set(e));i.Ud.setItem(i.Ws.CONNECTED_NAMESPACES,t.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(e){try{const t=r.getConnectedNamespaces();t.includes(e)||(t.push(e),r.setConnectedNamespaces(t))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(e){try{const t=r.getConnectedNamespaces(),n=t.indexOf(e);n>-1&&(t.splice(n,1),r.setConnectedNamespaces(t))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return i.Ud.getItem(i.Ws.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(e){try{i.Ud.setItem(i.Ws.TELEGRAM_SOCIAL_PROVIDER,e)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{i.Ud.removeItem(i.Ws.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let e={};try{const t=i.Ud.getItem(i.Ws.PORTFOLIO_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromBalanceCache(e){try{const t=r.getBalanceCache();i.Ud.setItem(i.Ws.PORTFOLIO_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getBalanceCacheForCaipAddress(e){try{const t=r.getBalanceCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.portfolio))return t.balance;r.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateBalanceCache(e){try{const t=r.getBalanceCache();t[e.caipAddress]=e,i.Ud.setItem(i.Ws.PORTFOLIO_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getNativeBalanceCache(){let e={};try{const t=i.Ud.getItem(i.Ws.NATIVE_BALANCE_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromNativeBalanceCache(e){try{const t=r.getBalanceCache();i.Ud.setItem(i.Ws.NATIVE_BALANCE_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getNativeBalanceCacheForCaipAddress(e){try{const t=r.getNativeBalanceCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.nativeBalance))return t;console.info("Discarding cache for address",e),r.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateNativeBalanceCache(e){try{const t=r.getNativeBalanceCache();t[e.caipAddress]=e,i.Ud.setItem(i.Ws.NATIVE_BALANCE_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getEnsCache(){let e={};try{const t=i.Ud.getItem(i.Ws.ENS_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get ens name cache")}return e},getEnsFromCacheForAddress(e){try{const t=r.getEnsCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.ens))return t.ens;r.removeEnsFromCache(e)}catch{console.info("Unable to get ens name from cache",e)}},updateEnsCache(e){try{const t=r.getEnsCache();t[e.address]=e,i.Ud.setItem(i.Ws.ENS_CACHE,JSON.stringify(t))}catch{console.info("Unable to update ens name cache",e)}},removeEnsFromCache(e){try{const t=r.getEnsCache();i.Ud.setItem(i.Ws.ENS_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove ens name from cache",e)}},getIdentityCache(){let e={};try{const t=i.Ud.getItem(i.Ws.IDENTITY_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get identity cache")}return e},getIdentityFromCacheForAddress(e){try{const t=r.getIdentityCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.identity))return t.identity;r.removeIdentityFromCache(e)}catch{console.info("Unable to get identity from cache",e)}},updateIdentityCache(e){try{const t=r.getIdentityCache();t[e.address]={identity:e.identity,timestamp:e.timestamp},i.Ud.setItem(i.Ws.IDENTITY_CACHE,JSON.stringify(t))}catch{console.info("Unable to update identity cache",e)}},removeIdentityFromCache(e){try{const t=r.getIdentityCache();i.Ud.setItem(i.Ws.IDENTITY_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove identity from cache",e)}},clearAddressCache(){try{i.Ud.removeItem(i.Ws.PORTFOLIO_CACHE),i.Ud.removeItem(i.Ws.NATIVE_BALANCE_CACHE),i.Ud.removeItem(i.Ws.ENS_CACHE),i.Ud.removeItem(i.Ws.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(e){try{i.Ud.setItem(i.Ws.PREFERRED_ACCOUNT_TYPES,JSON.stringify(e))}catch{console.info("Unable to set preferred account types",e)}},getPreferredAccountTypes(){try{const e=i.Ud.getItem(i.Ws.PREFERRED_ACCOUNT_TYPES);return JSON.parse(e)}catch{console.info("Unable to get preferred account types")}}}},89268:(e,t,n)=>{"use strict";n.d(t,{z8:()=>i,tt:()=>c,Zv:()=>s.Z,EM:()=>h.E,RF:()=>r.RF,JX:()=>r.JX,ds:()=>r.ds});const i={interpolate(e,t,n){if(2!==e.length||2!==t.length)throw new Error("inputRange and outputRange must be an array of length 2");const i=e[0]||0,r=e[1]||0,s=t[0]||0,a=t[1]||0;return n<i?s:n>r?a:(a-s)/(r-i)*(n-i)+s}};var r=n(39446),s=n(69929),a=n(24684);const o=["receive","deposit","borrow","claim"],l=["withdraw","repay","burn"],c={getTransactionGroupTitle(e,t){const n=a.r.getYear(),i=a.r.getMonthNameByIndex(t);return e===n?i:`${i} ${e}`},getTransactionImages(e){const[t,n]=e,i=Boolean(t)&&e?.every((e=>Boolean(e.nft_info))),r=e?.length>1;return 2===e?.length&&!i?[this.getTransactionImage(t),this.getTransactionImage(n)]:r?e.map((e=>this.getTransactionImage(e))):[this.getTransactionImage(t)]},getTransactionImage:e=>({type:c.getTransactionTransferTokenType(e),url:c.getTransactionImageURL(e)}),getTransactionImageURL(e){let t;const n=Boolean(e?.nft_info),i=Boolean(e?.fungible_info);return e&&n?t=e?.nft_info?.content?.preview?.url:e&&i&&(t=e?.fungible_info?.icon?.url),t},getTransactionTransferTokenType:e=>e?.fungible_info?"FUNGIBLE":e?.nft_info?"NFT":void 0,getTransactionDescriptions(e){const t=e?.metadata?.operationType,n=e?.transfers,i=e?.transfers?.length>0,r=e?.transfers?.length>1,a=i&&n?.every((e=>Boolean(e?.fungible_info))),[c,h]=n;let u=this.getTransferDescription(c),d=this.getTransferDescription(h);if(!i){return("send"===t||"receive"===t)&&a?(u=s.Z.getTruncateString({string:e?.metadata.sentFrom,charsStart:4,charsEnd:6,truncate:"middle"}),d=s.Z.getTruncateString({string:e?.metadata.sentTo,charsStart:4,charsEnd:6,truncate:"middle"}),[u,d]):[e.metadata.status]}if(r)return n.map((e=>this.getTransferDescription(e)));let p="";return o.includes(t)?p="+":l.includes(t)&&(p="-"),u=p.concat(u),[u]},getTransferDescription(e){let t="";return e?(e?.nft_info?t=e?.nft_info?.name||"-":e?.fungible_info&&(t=this.getFungibleTransferDescription(e)||"-"),t):t},getFungibleTransferDescription(e){if(!e)return null;return[this.getQuantityFixedValue(e?.quantity.numeric),e?.fungible_info?.symbol].join(" ").trim()},getQuantityFixedValue(e){if(!e)return null;return parseFloat(e).toFixed(3)}};var h=n(37845)},90297:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.customList=t.customArray=t.findOne=t.filter=t.all=t.utils=void 0;const r=i(n(74817)),s=i(n(24722)),a=i(n(62499));t.utils={groupBy:r.default},t.all=function(){return a.default},t.filter=function(e,t){return a.default.filter((n=>n[e]===t))},t.findOne=function(e,t){return a.default.find((n=>n[e]===t))},t.customArray=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"{countryNameEn} ({countryCode})",value:"{countryCode}"},{sortBy:t,sortDataBy:n,filter:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[];let o=a.default;if("function"===typeof i&&(o=o.filter(i)),n){const e=new Intl.Collator([],{sensitivity:"accent"});o.sort(((t,i)=>e.compare(t[n],i[n])))}if(o.forEach((t=>{const n={};for(const i in e)n[i]=(0,s.default)(e[i],t);r.push(n)})),t&&e[t]){const e=new Intl.Collator([],{sensitivity:"accent"});r.sort(((n,i)=>e.compare(n[t],i[t])))}return r},t.customList=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"countryCode",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"{countryNameEn} ({countryCode})",{filter:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={};let r=a.default;return"function"===typeof n&&(r=r.filter(n)),r.forEach((n=>{const r=(0,s.default)(t,n);i[String(n[e])]=r})),i}},90464:(e,t,n)=>{"use strict";n.d(t,{Vw:()=>p,Fc:()=>h,Id:()=>d,O8:()=>a,qv:()=>l,po:()=>m,Ow:()=>o,ZJ:()=>u,DH:()=>s,ld:()=>f});const i="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;var r=n(108);function s(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function a(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function o(e,t){return e<<32-t|e>>>t}const l=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])();function c(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function h(e){for(let t=0;t<e.length;t++)e[t]=c(e[t])}"function"===typeof Uint8Array.from([]).toHex&&Uint8Array.fromHex;function u(e){return"string"===typeof e&&(e=function(e){if("string"!==typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),(0,r.DO)(e),e}function d(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];(0,r.DO)(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,i=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,i),i+=e.length}return t}class p{clone(){return this._cloneInto()}}function f(e){const t=t=>e().update(u(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(i&&"function"===typeof i.getRandomValues)return i.getRandomValues(new Uint8Array(e));if(i&&"function"===typeof i.randomBytes)return Uint8Array.from(i.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}},91218:(e,t,n)=>{"use strict";n.d(t,{I:()=>r,R:()=>i});const i=e=>e,r=e=>e},91391:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});const i={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:("undefined"!==typeof process?{NODE_ENV:"production",PUBLIC_URL:"/build",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PROJECT_ID:"bb8edcd28daf7c13ce0a49cafab2782d"}.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}}},92770:(e,t,n)=>{"use strict";n.d(t,{Ag:()=>a,Rm:()=>c,SJ:()=>l,b2:()=>r,oX:()=>o,v2:()=>i});const i=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"}],r=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],s=[{inputs:[],name:"ResolverNotFound",type:"error"},{inputs:[],name:"ResolverWildcardNotSupported",type:"error"},{inputs:[],name:"ResolverNotContract",type:"error"},{inputs:[{name:"returnData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{components:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"errors",type:"tuple[]"}],name:"HttpError",type:"error"}],a=[...s,{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]},{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],o=[...s,{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]},{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]}],l=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],c=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}]},93005:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(42661),r=n(73939),s=n(88861),a=n(24657),o=n(16496),l=n(99251),c=n(80629),h=n(91391);const u={filterOutDuplicatesByRDNS(e){const t=i.H.state.enableEIP6963?r.a.state.connectors:[],n=s.i.getRecentWallets(),o=t.map((e=>e.info?.rdns)).filter(Boolean),l=n.map((e=>e.rdns)).filter(Boolean),c=o.concat(l);if(c.includes("io.metamask.mobile")&&a.w.isMobile()){const e=c.indexOf("io.metamask.mobile");c[e]="io.metamask"}return e.filter((e=>!c.includes(String(e?.rdns))))},filterOutDuplicatesByIds(e){const t=r.a.state.connectors.filter((e=>"ANNOUNCED"===e.type||"INJECTED"===e.type)),n=s.i.getRecentWallets(),i=t.map((e=>e.explorerId)),a=n.map((e=>e.id)),o=i.concat(a);return e.filter((e=>!o.includes(e?.id)))},filterOutDuplicateWallets(e){const t=this.filterOutDuplicatesByRDNS(e);return this.filterOutDuplicatesByIds(t)},markWalletsAsInstalled(e){const{connectors:t}=r.a.state,n=t.filter((e=>"ANNOUNCED"===e.type)).reduce(((e,t)=>t.info?.rdns?(e[t.info.rdns]=!0,e):e),{});return e.map((e=>({...e,installed:Boolean(e.rdns)&&Boolean(n[e.rdns??""])}))).sort(((e,t)=>Number(t.installed)-Number(e.installed)))},getConnectOrderMethod(e,t){const n=e?.connectMethodsOrder||i.H.state.features?.connectMethodsOrder,s=t||r.a.state.connectors;if(n)return n;const{injected:a,announced:l}=c.g.getConnectorsByType(s,o.N.state.recommended,o.N.state.featured),u=a.filter(c.g.showConnector),d=l.filter(c.g.showConnector);return u.length||d.length?["wallet","email","social"]:h.o.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(e){const t=Boolean(e.rdns)&&o.N.state.excludedWallets.some((t=>t.rdns===e.rdns)),n=Boolean(e.name)&&o.N.state.excludedWallets.some((t=>l.y.isLowerCaseMatch(t.name,e.name)));return t||n}}},93022:(e,t,n)=>{"use strict";n.d(t,{x:()=>v});var i=n(38993),r=n(76844),s=n(24657),a=n(13237),o=n(88861),l=n(595),c=n(15814),h=n(73939),u=n(79323),d=n(73609),p=n(61139),f=n(68231);const m=(0,i.BX)({wcError:!1,buffering:!1,status:"disconnected"});let g;const v={state:m,subscribeKey:(e,t)=>(0,r.u$)(m,e,t),_getClient:()=>m._client,setClient(e){m._client=(0,i.KR)(e)},async connectWalletConnect(){if(s.w.isTelegram()||s.w.isSafari()&&s.w.isIos()){if(g)return await g,void(g=void 0);if(!s.w.isPairingExpired(m?.wcPairingExpiry)){const e=m.wcUri;return void(m.wcUri=e)}g=this._getClient()?.connectWalletConnect?.().catch((()=>{})),this.state.status="connecting",await g,g=void 0,m.wcPairingExpiry=void 0,this.state.status="connected"}else await(this._getClient()?.connectWalletConnect?.())},async connectExternal(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];await(this._getClient()?.connectExternal?.(e)),n&&c.W.setActiveNamespace(t)},async reconnectExternal(e){await(this._getClient()?.reconnectExternal?.(e));const t=e.chain||c.W.state.activeChain;t&&h.a.setConnectorId(e.id,t)},async setPreferredAccountType(e,t){d.W.setLoading(!0,c.W.state.activeChain);const n=h.a.getAuthConnector();n&&(l.U.setPreferredAccountType(e,t),await n.provider.setPreferredAccount(e),o.i.setPreferredAccountTypes(l.U.state.preferredAccountTypes??{[t]:e}),await this.reconnectExternal(n),d.W.setLoading(!1,c.W.state.activeChain),u.E.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:e,network:c.W.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(e){return this._getClient()?.signMessage(e)},parseUnits(e,t){return this._getClient()?.parseUnits(e,t)},formatUnits(e,t){return this._getClient()?.formatUnits(e,t)},async sendTransaction(e){return this._getClient()?.sendTransaction(e)},async getCapabilities(e){return this._getClient()?.getCapabilities(e)},async grantPermissions(e){return this._getClient()?.grantPermissions(e)},async walletGetAssets(e){return this._getClient()?.walletGetAssets(e)??{}},async estimateGas(e){return this._getClient()?.estimateGas(e)},async writeContract(e){return this._getClient()?.writeContract(e)},async getEnsAddress(e){return this._getClient()?.getEnsAddress(e)},async getEnsAvatar(e){return this._getClient()?.getEnsAvatar(e)},checkInstalled(e){return this._getClient()?.checkInstalled?.(e)||!1},resetWcConnection(){m.wcUri=void 0,m.wcPairingExpiry=void 0,m.wcLinking=void 0,m.recentWallet=void 0,m.status="disconnected",f.W.resetTransactions(),o.i.deleteWalletConnectDeepLink()},resetUri(){m.wcUri=void 0,m.wcPairingExpiry=void 0},finalizeWcConnection(){const{wcLinking:e,recentWallet:t}=v.state;e&&o.i.setWalletConnectDeepLink(e),t&&o.i.setAppKitRecent(t),u.E.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:e?"mobile":"qrcode",name:p.I.state.data?.wallet?.name||"Unknown"}})},setWcBasic(e){m.wcBasic=e},setUri(e){m.wcUri=e,m.wcPairingExpiry=s.w.getPairingExpiry()},setWcLinking(e){m.wcLinking=e},setWcError(e){m.wcError=e,m.buffering=!1},setRecentWallet(e){m.recentWallet=e},setBuffering(e){m.buffering=e},setStatus(e){m.status=e},async disconnect(e){try{d.W.setLoading(!0,e),await a.U.clearSessions(),await c.W.disconnect(e),d.W.setLoading(!1,e),h.a.setFilterByNamespace(void 0)}catch(t){throw new Error("Failed to disconnect")}}}},93692:(e,t,n)=>{"use strict";n.d(t,{yH:()=>h});var i=n(3491),r=n(24603),s=n(21602),a=n(74074),o=n(84117);function l(e){if(e&&0!==e.length)return e.reduce(((e,t)=>{let{slot:n,value:i}=t;if(66!==n.length)throw new r.NV({size:n.length,targetSize:66,type:"hex"});if(66!==i.length)throw new r.NV({size:i.length,targetSize:66,type:"hex"});return e[n]=i,e}),{})}function c(e){const{balance:t,nonce:n,state:i,stateDiff:r,code:a}=e,c={};if(void 0!==a&&(c.code=a),void 0!==t&&(c.balance=(0,o.cK)(t)),void 0!==n&&(c.nonce=(0,o.cK)(n)),void 0!==i&&(c.state=l(i)),void 0!==r){if(c.state)throw new s.ft;c.stateDiff=l(r)}return c}function h(e){if(!e)return;const t={};for(const{address:n,...r}of e){if(!(0,a.P)(n,{strict:!1}))throw new i.M({address:n});if(t[n])throw new s.Hi({address:n});t[n]=c(r)}return t}},96454:(e,t)=>{"use strict";function n(){return"undefined"===typeof document&&"undefined"!==typeof navigator&&"ReactNative"===navigator.product}function i(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=n,t.isNode=i,t.isBrowser=function(){return!n()&&!i()}},97004:(e,t,n)=>{"use strict";var i=n(78853),r=n(65043),s=n(97950);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function h(e){if(l(e)!==e)throw Error(a(188))}function u(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=u(e)))return t;e=e.sibling}return null}var d=Object.assign,p=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),x=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),_=Symbol.for("react.lazy");Symbol.for("react.scope");var T=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var P=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var M=Symbol.iterator;function N(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var I=Symbol.for("react.client.reference");function O(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===I?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case C:return"Suspense";case A:return"SuspenseList";case T:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case x:return(e.displayName||"Context")+".Provider";case w:return(e._context.displayName||"Context")+".Consumer";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case S:return null!==(t=e.displayName||null)?t:O(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return O(e(t))}catch(n){}}return null}var D=Array.isArray,L=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,k={pending:!1,data:null,method:null,action:null},B=[],U=-1;function z(e){return{current:e}}function F(e){0>U||(e.current=B[U],B[U]=null,U--)}function j(e,t){U++,B[U]=e.current,e.current=t}var V=z(null),H=z(null),W=z(null),G=z(null);function q(e,t){switch(j(W,t),j(H,e),j(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?ru(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=su(t=ru(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}F(V),j(V,e)}function K(){F(V),F(H),F(W)}function Y(e){null!==e.memoizedState&&j(G,e);var t=V.current,n=su(t,e.type);t!==n&&(j(H,e),j(V,n))}function Q(e){H.current===e&&(F(V),F(H)),G.current===e&&(F(G),Yu._currentValue=k)}var X=Object.prototype.hasOwnProperty,Z=i.unstable_scheduleCallback,J=i.unstable_cancelCallback,$=i.unstable_shouldYield,ee=i.unstable_requestPaint,te=i.unstable_now,ne=i.unstable_getCurrentPriorityLevel,ie=i.unstable_ImmediatePriority,re=i.unstable_UserBlockingPriority,se=i.unstable_NormalPriority,ae=i.unstable_LowPriority,oe=i.unstable_IdlePriority,le=i.log,ce=i.unstable_setDisableYieldValue,he=null,ue=null;function de(e){if("function"===typeof le&&ce(e),ue&&"function"===typeof ue.setStrictMode)try{ue.setStrictMode(he,e)}catch(t){}}var pe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(fe(e)/me|0)|0},fe=Math.log,me=Math.LN2;var ge=256,ve=4194304;function ye(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,n){var i=e.pendingLanes;if(0===i)return 0;var r=0,s=e.suspendedLanes,a=e.pingedLanes;e=e.warmLanes;var o=134217727&i;return 0!==o?0!==(i=o&~s)?r=ye(i):0!==(a&=o)?r=ye(a):n||0!==(n=o&~e)&&(r=ye(n)):0!==(o=i&~s)?r=ye(o):0!==a?r=ye(a):n||0!==(n=i&~e)&&(r=ye(n)),0===r?0:0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(n=t&-t)||32===s&&0!==(4194048&n))?t:r}function we(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function xe(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ee(){var e=ge;return 0===(4194048&(ge<<=1))&&(ge=256),e}function Ce(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function Ae(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Se(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function _e(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-pe(t);e.entangledLanes|=t,e.entanglements[i]=1073741824|e.entanglements[i]|4194090&n}function Te(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-pe(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}function Pe(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Me(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ne(){var e=R.p;return 0!==e?e:void 0===(e=window.event)?32:cd(e.type)}var Ie=Math.random().toString(36).slice(2),Oe="__reactFiber$"+Ie,De="__reactProps$"+Ie,Le="__reactContainer$"+Ie,Re="__reactEvents$"+Ie,ke="__reactListeners$"+Ie,Be="__reactHandles$"+Ie,Ue="__reactResources$"+Ie,ze="__reactMarker$"+Ie;function Fe(e){delete e[Oe],delete e[De],delete e[Re],delete e[ke],delete e[Be]}function je(e){var t=e[Oe];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Le]||n[Oe]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=bu(e);null!==e;){if(n=e[Oe])return n;e=bu(e)}return t}n=(e=n).parentNode}return null}function Ve(e){if(e=e[Oe]||e[Le]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function He(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function We(e){var t=e[Ue];return t||(t=e[Ue]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ge(e){e[ze]=!0}var qe=new Set,Ke={};function Ye(e,t){Qe(e,t),Qe(e+"Capture",t)}function Qe(e,t){for(Ke[e]=t,e=0;e<t.length;e++)qe.add(t[e])}var Xe,Ze,Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$e={},et={};function tt(e,t,n){if(r=t,X.call(et,r)||!X.call($e,r)&&(Je.test(r)?et[r]=!0:($e[r]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var i=t.toLowerCase().slice(0,5);if("data-"!==i&&"aria-"!==i)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var r}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function it(e,t,n,i){if(null===i)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+i)}}function rt(e){if(void 0===Xe)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Xe=t&&t[1]||"",Ze=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Xe+e+Ze}var st=!1;function at(e,t){if(!e||st)return"";st=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(r){var i=r}Reflect.construct(e,[],n)}else{try{n.call()}catch(s){i=s}e.call(n.prototype)}}else{try{throw Error()}catch(a){i=a}(n=e())&&"function"===typeof n.catch&&n.catch((function(){}))}}catch(o){if(o&&i&&"string"===typeof o.stack)return[o.stack,i.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=i.DetermineComponentFrameRoot(),a=s[0],o=s[1];if(a&&o){var l=a.split("\n"),c=o.split("\n");for(r=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(i===l.length||r===c.length)for(i=l.length-1,r=c.length-1;1<=i&&0<=r&&l[i]!==c[r];)r--;for(;1<=i&&0<=r;i--,r--)if(l[i]!==c[r]){if(1!==i||1!==r)do{if(i--,0>--r||l[i]!==c[r]){var h="\n"+l[i].replace(" at new "," at ");return e.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",e.displayName)),h}}while(1<=i&&0<=r);break}}}finally{st=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?rt(n):""}function ot(e){switch(e.tag){case 26:case 27:case 5:return rt(e.type);case 16:return rt("Lazy");case 13:return rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return at(e.type,!1);case 11:return at(e.type.render,!1);case 1:return at(e.type,!0);case 31:return rt("Activity");default:return""}}function lt(e){try{var t="";do{t+=ot(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ut(e){e._valueTracker||(e._valueTracker=function(e){var t=ht(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function dt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=ht(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function pt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var ft=/[\n"\\]/g;function mt(e){return e.replace(ft,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function gt(e,t,n,i,r,s,a,o){e.name="",null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.type=a:e.removeAttribute("type"),null!=t?"number"===a?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==a&&"reset"!==a||e.removeAttribute("value"),null!=t?yt(e,a,ct(t)):null!=n?yt(e,a,ct(n)):null!=i&&e.removeAttribute("value"),null==r&&null!=s&&(e.defaultChecked=!!s),null!=r&&(e.checked=r&&"function"!==typeof r&&"symbol"!==typeof r),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ct(o):e.removeAttribute("name")}function vt(e,t,n,i,r,s,a,o){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=n){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}i="function"!==typeof(i=null!=i?i:r)&&"symbol"!==typeof i&&!!i,e.checked=o?e.checked:!!i,e.defaultChecked=!!i,null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.name=a)}function yt(e,t,n){"number"===t&&pt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function wt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function xt(e,t,n,i){if(null==t){if(null!=i){if(null!=n)throw Error(a(92));if(D(i)){if(1<i.length)throw Error(a(93));i=i[0]}n=i}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(i=e.textContent)===n&&""!==i&&null!==i&&(e.value=i)}function Et(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Ct=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function At(e,t,n){var i=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?i?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":i?e.setProperty(t,n):"number"!==typeof n||0===n||Ct.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function St(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var i in n)!n.hasOwnProperty(i)||null!=t&&t.hasOwnProperty(i)||(0===i.indexOf("--")?e.setProperty(i,""):"float"===i?e.cssFloat="":e[i]="");for(var r in t)i=t[r],t.hasOwnProperty(r)&&n[r]!==i&&At(e,r,i)}else for(var s in t)t.hasOwnProperty(s)&&At(e,s,t[s])}function _t(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Mt(e){return Pt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Nt=null;function It(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ot=null,Dt=null;function Lt(e){var t=Ve(e);if(t&&(e=t.stateNode)){var n=e[De]||null;e:switch(e=t.stateNode,t.type){case"input":if(gt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=i[De]||null;if(!r)throw Error(a(90));gt(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)(i=n[t]).form===e.form&&dt(i)}break e;case"textarea":wt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var Rt=!1;function kt(e,t,n){if(Rt)return e(t,n);Rt=!0;try{return e(t)}finally{if(Rt=!1,(null!==Ot||null!==Dt)&&(jc(),Ot&&(t=Ot,e=Dt,Dt=Ot=null,Lt(t),e)))for(t=0;t<e.length;t++)Lt(e[t])}}function Bt(e,t){var n=e.stateNode;if(null===n)return null;var i=n[De]||null;if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Ut=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),zt=!1;if(Ut)try{var Ft={};Object.defineProperty(Ft,"passive",{get:function(){zt=!0}}),window.addEventListener("test",Ft,Ft),window.removeEventListener("test",Ft,Ft)}catch(Dd){zt=!1}var jt=null,Vt=null,Ht=null;function Wt(){if(Ht)return Ht;var e,t,n=Vt,i=n.length,r="value"in jt?jt.value:jt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var a=i-e;for(t=1;t<=a&&n[i-t]===r[s-t];t++);return Ht=r.slice(e,1<t?1-t:void 0)}function Gt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function qt(){return!0}function Kt(){return!1}function Yt(e){function t(t,n,i,r,s){for(var a in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?qt:Kt,this.isPropagationStopped=Kt,this}return d(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=qt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=qt)},persist:function(){},isPersistent:qt}),t}var Qt,Xt,Zt,Jt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$t=Yt(Jt),en=d({},Jt,{view:0,detail:0}),tn=Yt(en),nn=d({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zt&&(Zt&&"mousemove"===e.type?(Qt=e.screenX-Zt.screenX,Xt=e.screenY-Zt.screenY):Xt=Qt=0,Zt=e),Qt)},movementY:function(e){return"movementY"in e?e.movementY:Xt}}),rn=Yt(nn),sn=Yt(d({},nn,{dataTransfer:0})),an=Yt(d({},en,{relatedTarget:0})),on=Yt(d({},Jt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Yt(d({},Jt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=Yt(d({},Jt,{data:0})),hn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},un={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=dn[e])&&!!t[e]}function fn(){return pn}var mn=Yt(d({},en,{key:function(e){if(e.key){var t=hn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Gt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?un[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fn,charCode:function(e){return"keypress"===e.type?Gt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Gt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),gn=Yt(d({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vn=Yt(d({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fn})),yn=Yt(d({},Jt,{propertyName:0,elapsedTime:0,pseudoElement:0})),bn=Yt(d({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),wn=Yt(d({},Jt,{newState:0,oldState:0})),xn=[9,13,27,32],En=Ut&&"CompositionEvent"in window,Cn=null;Ut&&"documentMode"in document&&(Cn=document.documentMode);var An=Ut&&"TextEvent"in window&&!Cn,Sn=Ut&&(!En||Cn&&8<Cn&&11>=Cn),_n=String.fromCharCode(32),Tn=!1;function Pn(e,t){switch(e){case"keyup":return-1!==xn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Nn=!1;var In={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function On(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!In[e.type]:"textarea"===t}function Dn(e,t,n,i){Ot?Dt?Dt.push(i):Dt=[i]:Ot=i,0<(t=Wh(t,"onChange")).length&&(n=new $t("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Ln=null,Rn=null;function kn(e){kh(e,0)}function Bn(e){if(dt(He(e)))return e}function Un(e,t){if("change"===e)return t}var zn=!1;if(Ut){var Fn;if(Ut){var jn="oninput"in document;if(!jn){var Vn=document.createElement("div");Vn.setAttribute("oninput","return;"),jn="function"===typeof Vn.oninput}Fn=jn}else Fn=!1;zn=Fn&&(!document.documentMode||9<document.documentMode)}function Hn(){Ln&&(Ln.detachEvent("onpropertychange",Wn),Rn=Ln=null)}function Wn(e){if("value"===e.propertyName&&Bn(Rn)){var t=[];Dn(t,Rn,e,It(e)),kt(kn,t)}}function Gn(e,t,n){"focusin"===e?(Hn(),Rn=n,(Ln=t).attachEvent("onpropertychange",Wn)):"focusout"===e&&Hn()}function qn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Bn(Rn)}function Kn(e,t){if("click"===e)return Bn(t)}function Yn(e,t){if("input"===e||"change"===e)return Bn(t)}var Qn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Xn(e,t){if(Qn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!X.call(t,r)||!Qn(e[r],t[r]))return!1}return!0}function Zn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jn(e,t){var n,i=Zn(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Zn(i)}}function $n(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?$n(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ei(e){for(var t=pt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=pt((e=t.contentWindow).document)}return t}function ti(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ni=Ut&&"documentMode"in document&&11>=document.documentMode,ii=null,ri=null,si=null,ai=!1;function oi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ai||null==ii||ii!==pt(i)||("selectionStart"in(i=ii)&&ti(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},si&&Xn(si,i)||(si=i,0<(i=Wh(ri,"onSelect")).length&&(t=new $t("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=ii)))}function li(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ci={animationend:li("Animation","AnimationEnd"),animationiteration:li("Animation","AnimationIteration"),animationstart:li("Animation","AnimationStart"),transitionrun:li("Transition","TransitionRun"),transitionstart:li("Transition","TransitionStart"),transitioncancel:li("Transition","TransitionCancel"),transitionend:li("Transition","TransitionEnd")},hi={},ui={};function di(e){if(hi[e])return hi[e];if(!ci[e])return e;var t,n=ci[e];for(t in n)if(n.hasOwnProperty(t)&&t in ui)return hi[e]=n[t];return e}Ut&&(ui=document.createElement("div").style,"AnimationEvent"in window||(delete ci.animationend.animation,delete ci.animationiteration.animation,delete ci.animationstart.animation),"TransitionEvent"in window||delete ci.transitionend.transition);var pi=di("animationend"),fi=di("animationiteration"),mi=di("animationstart"),gi=di("transitionrun"),vi=di("transitionstart"),yi=di("transitioncancel"),bi=di("transitionend"),wi=new Map,xi="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ei(e,t){wi.set(e,t),Ye(t,[e])}xi.push("scrollEnd");var Ci=new WeakMap;function Ai(e,t){if("object"===typeof e&&null!==e){var n=Ci.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},Ci.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Si=[],_i=0,Ti=0;function Pi(){for(var e=_i,t=Ti=_i=0;t<e;){var n=Si[t];Si[t++]=null;var i=Si[t];Si[t++]=null;var r=Si[t];Si[t++]=null;var s=Si[t];if(Si[t++]=null,null!==i&&null!==r){var a=i.pending;null===a?r.next=r:(r.next=a.next,a.next=r),i.pending=r}0!==s&&Oi(n,r,s)}}function Mi(e,t,n,i){Si[_i++]=e,Si[_i++]=t,Si[_i++]=n,Si[_i++]=i,Ti|=i,e.lanes|=i,null!==(e=e.alternate)&&(e.lanes|=i)}function Ni(e,t,n,i){return Mi(e,t,n,i),Di(e)}function Ii(e,t){return Mi(e,null,null,t),Di(e)}function Oi(e,t,n){e.lanes|=n;var i=e.alternate;null!==i&&(i.lanes|=n);for(var r=!1,s=e.return;null!==s;)s.childLanes|=n,null!==(i=s.alternate)&&(i.childLanes|=n),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(r=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,r&&null!==t&&(r=31-pe(n),null===(i=(e=s.hiddenUpdates)[r])?e[r]=[t]:i.push(t),t.lane=536870912|n),s):null}function Di(e){if(50<Oc)throw Oc=0,Dc=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Li={};function Ri(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ki(e,t,n,i){return new Ri(e,t,n,i)}function Bi(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ui(e,t){var n=e.alternate;return null===n?((n=ki(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function zi(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Fi(e,t,n,i,r,s){var o=0;if(i=e,"function"===typeof e)Bi(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case T:return(e=ki(31,n,t,r)).elementType=T,e.lanes=s,e;case g:return ji(n.children,r,s,t);case v:o=8,r|=24;break;case y:return(e=ki(12,n,t,2|r)).elementType=y,e.lanes=s,e;case C:return(e=ki(13,n,t,r)).elementType=C,e.lanes=s,e;case A:return(e=ki(19,n,t,r)).elementType=A,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:case x:o=10;break e;case w:o=9;break e;case E:o=11;break e;case S:o=14;break e;case _:o=16,i=null;break e}o=29,n=Error(a(130,null===e?"null":typeof e,"")),i=null}return(t=ki(o,n,t,r)).elementType=e,t.type=i,t.lanes=s,t}function ji(e,t,n,i){return(e=ki(7,e,i,t)).lanes=n,e}function Vi(e,t,n){return(e=ki(6,e,null,t)).lanes=n,e}function Hi(e,t,n){return(t=ki(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Wi=[],Gi=0,qi=null,Ki=0,Yi=[],Qi=0,Xi=null,Zi=1,Ji="";function $i(e,t){Wi[Gi++]=Ki,Wi[Gi++]=qi,qi=e,Ki=t}function er(e,t,n){Yi[Qi++]=Zi,Yi[Qi++]=Ji,Yi[Qi++]=Xi,Xi=e;var i=Zi;e=Ji;var r=32-pe(i)-1;i&=~(1<<r),n+=1;var s=32-pe(t)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Zi=1<<32-pe(t)+r|n<<r|i,Ji=s+e}else Zi=1<<s|n<<r|i,Ji=e}function tr(e){null!==e.return&&($i(e,1),er(e,1,0))}function nr(e){for(;e===qi;)qi=Wi[--Gi],Wi[Gi]=null,Ki=Wi[--Gi],Wi[Gi]=null;for(;e===Xi;)Xi=Yi[--Qi],Yi[Qi]=null,Ji=Yi[--Qi],Yi[Qi]=null,Zi=Yi[--Qi],Yi[Qi]=null}var ir=null,rr=null,sr=!1,ar=null,or=!1,lr=Error(a(519));function cr(e){throw mr(Ai(Error(a(418,"")),e)),lr}function hr(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[Oe]=e,t[De]=i,n){case"dialog":Bh("cancel",t),Bh("close",t);break;case"iframe":case"object":case"embed":Bh("load",t);break;case"video":case"audio":for(n=0;n<Lh.length;n++)Bh(Lh[n],t);break;case"source":Bh("error",t);break;case"img":case"image":case"link":Bh("error",t),Bh("load",t);break;case"details":Bh("toggle",t);break;case"input":Bh("invalid",t),vt(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),ut(t);break;case"select":Bh("invalid",t);break;case"textarea":Bh("invalid",t),xt(t,i.value,i.defaultValue,i.children),ut(t)}"string"!==typeof(n=i.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===i.suppressHydrationWarning||Xh(t.textContent,n)?(null!=i.popover&&(Bh("beforetoggle",t),Bh("toggle",t)),null!=i.onScroll&&Bh("scroll",t),null!=i.onScrollEnd&&Bh("scrollend",t),null!=i.onClick&&(t.onclick=Zh),t=!0):t=!1,t||cr(e)}function ur(e){for(ir=e.return;ir;)switch(ir.tag){case 5:case 13:return void(or=!1);case 27:case 3:return void(or=!0);default:ir=ir.return}}function dr(e){if(e!==ir)return!1;if(!sr)return ur(e),sr=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||au(e.type,e.memoizedProps)),t=!t),t&&rr&&cr(e),ur(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){rr=vu(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}rr=null}}else 27===n?(n=rr,pu(e.type)?(e=yu,yu=null,rr=e):rr=n):rr=ir?vu(e.stateNode.nextSibling):null;return!0}function pr(){rr=ir=null,sr=!1}function fr(){var e=ar;return null!==e&&(null===bc?bc=e:bc.push.apply(bc,e),ar=null),e}function mr(e){null===ar?ar=[e]:ar.push(e)}var gr=z(null),vr=null,yr=null;function br(e,t,n){j(gr,t._currentValue),t._currentValue=n}function wr(e){e._currentValue=gr.current,F(gr)}function xr(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Er(e,t,n,i){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var s=r.dependencies;if(null!==s){var o=r.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=r;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),xr(s.return,n,e),i||(o=null);break e}s=l.next}}else if(18===r.tag){if(null===(o=r.return))throw Error(a(341));o.lanes|=n,null!==(s=o.alternate)&&(s.lanes|=n),xr(o,n,e),o=null}else o=r.child;if(null!==o)o.return=r;else for(o=r;null!==o;){if(o===e){o=null;break}if(null!==(r=o.sibling)){r.return=o.return,o=r;break}o=o.return}r=o}}function Cr(e,t,n,i){e=null;for(var r=t,s=!1;null!==r;){if(!s)if(0!==(524288&r.flags))s=!0;else if(0!==(262144&r.flags))break;if(10===r.tag){var o=r.alternate;if(null===o)throw Error(a(387));if(null!==(o=o.memoizedProps)){var l=r.type;Qn(r.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(r===G.current){if(null===(o=r.alternate))throw Error(a(387));o.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(Yu):e=[Yu])}r=r.return}null!==e&&Er(t,e,n,i),t.flags|=262144}function Ar(e){for(e=e.firstContext;null!==e;){if(!Qn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Sr(e){vr=e,yr=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function _r(e){return Pr(vr,e)}function Tr(e,t){return null===vr&&Sr(e),Pr(e,t)}function Pr(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===yr){if(null===e)throw Error(a(308));yr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else yr=yr.next=t;return n}var Mr="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Nr=i.unstable_scheduleCallback,Ir=i.unstable_NormalPriority,Or={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Dr(){return{controller:new Mr,data:new Map,refCount:0}}function Lr(e){e.refCount--,0===e.refCount&&Nr(Ir,(function(){e.controller.abort()}))}var Rr=null,kr=0,Br=0,Ur=null;function zr(){if(0===--kr&&null!==Rr){null!==Ur&&(Ur.status="fulfilled");var e=Rr;Rr=null,Br=0,Ur=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Fr=L.S;L.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Rr){var n=Rr=[];kr=0,Br=Mh(),Ur={status:"pending",value:void 0,then:function(e){n.push(e)}}}kr++,t.then(zr,zr)}(0,t),null!==Fr&&Fr(e,t)};var jr=z(null);function Vr(){var e=jr.current;return null!==e?e:ic.pooledCache}function Hr(e,t){j(jr,null===t?jr.current:t.pool)}function Wr(){var e=Vr();return null===e?null:{parent:Or._currentValue,pool:e}}var Gr=Error(a(460)),qr=Error(a(474)),Kr=Error(a(542)),Yr={then:function(){}};function Qr(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Xr(){}function Zr(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Xr,Xr),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw es(e=t.reason),e;default:if("string"===typeof t.status)t.then(Xr,Xr);else{if(null!==(e=ic)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}}),(function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":throw es(e=t.reason),e}throw Jr=t,Gr}}var Jr=null;function $r(){if(null===Jr)throw Error(a(459));var e=Jr;return Jr=null,e}function es(e){if(e===Gr||e===Kr)throw Error(a(483))}var ts=!1;function ns(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function is(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function rs(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ss(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&nc)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,t=Di(e),Oi(e,null,n),t}return Mi(e,i,t,n),Di(e)}function as(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Te(e,n)}}function os(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===s?r=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,callbacks:i.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ls=!1;function cs(){if(ls){if(null!==Ur)throw Ur}}function hs(e,t,n,i){ls=!1;var r=e.updateQueue;ts=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var h=e.alternate;null!==h&&((o=(h=h.updateQueue).lastBaseUpdate)!==a&&(null===o?h.firstBaseUpdate=c:o.next=c,h.lastBaseUpdate=l))}if(null!==s){var u=r.baseState;for(a=0,h=c=l=null,o=s;;){var p=-536870913&o.lane,f=p!==o.lane;if(f?(sc&p)===p:(i&p)===p){0!==p&&p===Br&&(ls=!0),null!==h&&(h=h.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var m=e,g=o;p=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){u=m.call(v,u,p);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(p="function"===typeof(m=g.payload)?m.call(v,u,p):m)||void 0===p)break e;u=d({},u,p);break e;case 2:ts=!0}}null!==(p=o.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=r.callbacks)?r.callbacks=[p]:f.push(p))}else f={lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===h?(c=h=f,l=u):h=h.next=f,a|=p;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(f=o).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}null===h&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=h,null===s&&(r.shared.lanes=0),pc|=a,e.lanes=a,e.memoizedState=u}}function us(e,t){if("function"!==typeof e)throw Error(a(191,e));e.call(t)}function ds(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)us(n[e],t)}var ps=z(null),fs=z(0);function ms(e,t){j(fs,e=uc),j(ps,t),uc=e|t.baseLanes}function gs(){j(fs,uc),j(ps,ps.current)}function vs(){uc=fs.current,F(ps),F(fs)}var ys=0,bs=null,ws=null,xs=null,Es=!1,Cs=!1,As=!1,Ss=0,_s=0,Ts=null,Ps=0;function Ms(){throw Error(a(321))}function Ns(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Qn(e[n],t[n]))return!1;return!0}function Is(e,t,n,i,r,s){return ys=s,bs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,L.H=null===e||null===e.memoizedState?Ga:qa,As=!1,s=n(i,r),As=!1,Cs&&(s=Ds(t,n,i,r)),Os(e),s}function Os(e){L.H=Wa;var t=null!==ws&&null!==ws.next;if(ys=0,xs=ws=bs=null,Es=!1,_s=0,Ts=null,t)throw Error(a(300));null===e||To||null!==(e=e.dependencies)&&Ar(e)&&(To=!0)}function Ds(e,t,n,i){bs=e;var r=0;do{if(Cs&&(Ts=null),_s=0,Cs=!1,25<=r)throw Error(a(301));if(r+=1,xs=ws=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}L.H=Ka,s=t(n,i)}while(Cs);return s}function Ls(){var e=L.H,t=e.useState()[0];return t="function"===typeof t.then?Fs(t):t,e=e.useState()[0],(null!==ws?ws.memoizedState:null)!==e&&(bs.flags|=1024),t}function Rs(){var e=0!==Ss;return Ss=0,e}function ks(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Bs(e){if(Es){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Es=!1}ys=0,xs=ws=bs=null,Cs=!1,_s=Ss=0,Ts=null}function Us(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===xs?bs.memoizedState=xs=e:xs=xs.next=e,xs}function zs(){if(null===ws){var e=bs.alternate;e=null!==e?e.memoizedState:null}else e=ws.next;var t=null===xs?bs.memoizedState:xs.next;if(null!==t)xs=t,ws=e;else{if(null===e){if(null===bs.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(ws=e).memoizedState,baseState:ws.baseState,baseQueue:ws.baseQueue,queue:ws.queue,next:null},null===xs?bs.memoizedState=xs=e:xs=xs.next=e}return xs}function Fs(e){var t=_s;return _s+=1,null===Ts&&(Ts=[]),e=Zr(Ts,e,t),t=bs,null===(null===xs?t.memoizedState:xs.next)&&(t=t.alternate,L.H=null===t||null===t.memoizedState?Ga:qa),e}function js(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Fs(e);if(e.$$typeof===x)return _r(e)}throw Error(a(438,String(e)))}function Vs(e){var t=null,n=bs.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var i=bs.alternate;null!==i&&(null!==(i=i.updateQueue)&&(null!=(i=i.memoCache)&&(t={data:i.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},bs.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=P;return t.index++,n}function Hs(e,t){return"function"===typeof t?t(e):t}function Ws(e){return Gs(zs(),ws,e)}function Gs(e,t,n){var i=e.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=n;var r=e.baseQueue,s=i.pending;if(null!==s){if(null!==r){var o=r.next;r.next=s.next,s.next=o}t.baseQueue=r=s,i.pending=null}if(s=e.baseState,null===r)e.memoizedState=s;else{var l=o=null,c=null,h=t=r.next,u=!1;do{var d=-536870913&h.lane;if(d!==h.lane?(sc&d)===d:(ys&d)===d){var p=h.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),d===Br&&(u=!0);else{if((ys&p)===p){h=h.next,p===Br&&(u=!0);continue}d={lane:0,revertLane:h.revertLane,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null},null===c?(l=c=d,o=s):c=c.next=d,bs.lanes|=p,pc|=p}d=h.action,As&&n(s,d),s=h.hasEagerState?h.eagerState:n(s,d)}else p={lane:d,revertLane:h.revertLane,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null},null===c?(l=c=p,o=s):c=c.next=p,bs.lanes|=d,pc|=d;h=h.next}while(null!==h&&h!==t);if(null===c?o=s:c.next=l,!Qn(s,e.memoizedState)&&(To=!0,u&&null!==(n=Ur)))throw n;e.memoizedState=s,e.baseState=o,e.baseQueue=c,i.lastRenderedState=s}return null===r&&(i.lanes=0),[e.memoizedState,i.dispatch]}function qs(e){var t=zs(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{s=e(s,o.action),o=o.next}while(o!==r);Qn(s,t.memoizedState)||(To=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function Ks(e,t,n){var i=bs,r=zs(),s=sr;if(s){if(void 0===n)throw Error(a(407));n=n()}else n=t();var o=!Qn((ws||r).memoizedState,n);if(o&&(r.memoizedState=n,To=!0),r=r.queue,ga(2048,8,Xs.bind(null,i,r,e),[e]),r.getSnapshot!==t||o||null!==xs&&1&xs.memoizedState.tag){if(i.flags|=2048,pa(9,{destroy:void 0,resource:void 0},Qs.bind(null,i,r,n,t),null),null===ic)throw Error(a(349));s||0!==(124&ys)||Ys(i,t,n)}return n}function Ys(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=bs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},bs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Qs(e,t,n,i){t.value=n,t.getSnapshot=i,Zs(t)&&Js(e)}function Xs(e,t,n){return n((function(){Zs(t)&&Js(e)}))}function Zs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Qn(e,n)}catch(i){return!0}}function Js(e){var t=Ii(e,2);null!==t&&kc(t,e,2)}function $s(e){var t=Us();if("function"===typeof e){var n=e;if(e=n(),As){de(!0);try{n()}finally{de(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hs,lastRenderedState:e},t}function ea(e,t,n,i){return e.baseState=n,Gs(e,ws,"function"===typeof i?i:Hs)}function ta(e,t,n,i,r){if(ja(e))throw Error(a(485));if(null!==(e=t.action)){var s={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==L.T?n(!0):s.isTransition=!1,i(s),null===(n=t.pending)?(s.next=t.pending=s,na(t,s)):(s.next=n.next,t.pending=n.next=s)}}function na(e,t){var n=t.action,i=t.payload,r=e.state;if(t.isTransition){var s=L.T,a={};L.T=a;try{var o=n(r,i),l=L.S;null!==l&&l(a,o),ia(e,t,o)}catch(c){sa(e,t,c)}finally{L.T=s}}else try{ia(e,t,s=n(r,i))}catch(h){sa(e,t,h)}}function ia(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then((function(n){ra(e,t,n)}),(function(n){return sa(e,t,n)})):ra(e,t,n)}function ra(e,t,n){t.status="fulfilled",t.value=n,aa(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,na(e,n)))}function sa(e,t,n){var i=e.pending;if(e.pending=null,null!==i){i=i.next;do{t.status="rejected",t.reason=n,aa(t),t=t.next}while(t!==i)}e.action=null}function aa(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function oa(e,t){return t}function la(e,t){if(sr){var n=ic.formState;if(null!==n){e:{var i=bs;if(sr){if(rr){t:{for(var r=rr,s=or;8!==r.nodeType;){if(!s){r=null;break t}if(null===(r=vu(r.nextSibling))){r=null;break t}}r="F!"===(s=r.data)||"F"===s?r:null}if(r){rr=vu(r.nextSibling),i="F!"===r.data;break e}}cr(i)}i=!1}i&&(t=n[0])}}return(n=Us()).memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oa,lastRenderedState:t},n.queue=i,n=Ua.bind(null,bs,i),i.dispatch=n,i=$s(!1),s=Fa.bind(null,bs,!1,i.queue),r={state:t,dispatch:null,action:e,pending:null},(i=Us()).queue=r,n=ta.bind(null,bs,r,s,n),r.dispatch=n,i.memoizedState=e,[t,n,!1]}function ca(e){return ha(zs(),ws,e)}function ha(e,t,n){if(t=Gs(e,t,oa)[0],e=Ws(Hs)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var i=Fs(t)}catch(a){if(a===Gr)throw Kr;throw a}else i=t;var r=(t=zs()).queue,s=r.dispatch;return n!==t.memoizedState&&(bs.flags|=2048,pa(9,{destroy:void 0,resource:void 0},ua.bind(null,r,n),null)),[i,s,e]}function ua(e,t){e.action=t}function da(e){var t=zs(),n=ws;if(null!==n)return ha(t,n,e);zs(),t=t.memoizedState;var i=(n=zs()).queue.dispatch;return n.memoizedState=e,[t,i,!1]}function pa(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},null===(t=bs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},bs.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function fa(){return zs().memoizedState}function ma(e,t,n,i){var r=Us();i=void 0===i?null:i,bs.flags|=e,r.memoizedState=pa(1|t,{destroy:void 0,resource:void 0},n,i)}function ga(e,t,n,i){var r=zs();i=void 0===i?null:i;var s=r.memoizedState.inst;null!==ws&&null!==i&&Ns(i,ws.memoizedState.deps)?r.memoizedState=pa(t,s,n,i):(bs.flags|=e,r.memoizedState=pa(1|t,s,n,i))}function va(e,t){ma(8390656,8,e,t)}function ya(e,t){ga(2048,8,e,t)}function ba(e,t){return ga(4,2,e,t)}function wa(e,t){return ga(4,4,e,t)}function xa(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ea(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,ga(4,4,xa.bind(null,t,e),n)}function Ca(){}function Aa(e,t){var n=zs();t=void 0===t?null:t;var i=n.memoizedState;return null!==t&&Ns(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Sa(e,t){var n=zs();t=void 0===t?null:t;var i=n.memoizedState;if(null!==t&&Ns(t,i[1]))return i[0];if(i=e(),As){de(!0);try{e()}finally{de(!1)}}return n.memoizedState=[i,t],i}function _a(e,t,n){return void 0===n||0!==(1073741824&ys)?e.memoizedState=t:(e.memoizedState=n,e=Rc(),bs.lanes|=e,pc|=e,n)}function Ta(e,t,n,i){return Qn(n,t)?n:null!==ps.current?(e=_a(e,n,i),Qn(e,t)||(To=!0),e):0===(42&ys)?(To=!0,e.memoizedState=n):(e=Rc(),bs.lanes|=e,pc|=e,t)}function Pa(e,t,n,i,r){var s=R.p;R.p=0!==s&&8>s?s:8;var a=L.T,o={};L.T=o,Fa(e,!1,t,n);try{var l=r(),c=L.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)za(e,t,function(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then((function(){i.status="fulfilled",i.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)}),(function(e){for(i.status="rejected",i.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)})),i}(l,i),Lc());else za(e,t,i,Lc())}catch(h){za(e,t,{then:function(){},status:"rejected",reason:h},Lc())}finally{R.p=s,L.T=a}}function Ma(){}function Na(e,t,n,i){if(5!==e.tag)throw Error(a(476));var r=Ia(e).queue;Pa(e,r,t,k,null===n?Ma:function(){return Oa(e),n(i)})}function Ia(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:k,baseState:k,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hs,lastRenderedState:k},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hs,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Oa(e){za(e,Ia(e).next.queue,{},Lc())}function Da(){return _r(Yu)}function La(){return zs().memoizedState}function Ra(){return zs().memoizedState}function ka(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Lc(),i=ss(t,e=rs(n),n);return null!==i&&(kc(i,t,n),as(i,t,n)),t={cache:Dr()},void(e.payload=t)}t=t.return}}function Ba(e,t,n){var i=Lc();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},ja(e)?Va(t,n):null!==(n=Ni(e,t,n,i))&&(kc(n,e,i),Ha(n,t,i))}function Ua(e,t,n){za(e,t,n,Lc())}function za(e,t,n,i){var r={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(ja(e))Va(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,Qn(o,a))return Mi(e,t,r,0),null===ic&&Pi(),!1}catch(l){}if(null!==(n=Ni(e,t,r,i)))return kc(n,e,i),Ha(n,t,i),!0}return!1}function Fa(e,t,n,i){if(i={lane:2,revertLane:Mh(),action:i,hasEagerState:!1,eagerState:null,next:null},ja(e)){if(t)throw Error(a(479))}else null!==(t=Ni(e,n,i,2))&&kc(t,e,2)}function ja(e){var t=e.alternate;return e===bs||null!==t&&t===bs}function Va(e,t){Cs=Es=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ha(e,t,n){if(0!==(4194048&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Te(e,n)}}var Wa={readContext:_r,use:js,useCallback:Ms,useContext:Ms,useEffect:Ms,useImperativeHandle:Ms,useLayoutEffect:Ms,useInsertionEffect:Ms,useMemo:Ms,useReducer:Ms,useRef:Ms,useState:Ms,useDebugValue:Ms,useDeferredValue:Ms,useTransition:Ms,useSyncExternalStore:Ms,useId:Ms,useHostTransitionStatus:Ms,useFormState:Ms,useActionState:Ms,useOptimistic:Ms,useMemoCache:Ms,useCacheRefresh:Ms},Ga={readContext:_r,use:js,useCallback:function(e,t){return Us().memoizedState=[e,void 0===t?null:t],e},useContext:_r,useEffect:va,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,ma(4194308,4,xa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ma(4194308,4,e,t)},useInsertionEffect:function(e,t){ma(4,2,e,t)},useMemo:function(e,t){var n=Us();t=void 0===t?null:t;var i=e();if(As){de(!0);try{e()}finally{de(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=Us();if(void 0!==n){var r=n(t);if(As){de(!0);try{n(t)}finally{de(!1)}}}else r=t;return i.memoizedState=i.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},i.queue=e,e=e.dispatch=Ba.bind(null,bs,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Us().memoizedState=e},useState:function(e){var t=(e=$s(e)).queue,n=Ua.bind(null,bs,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ca,useDeferredValue:function(e,t){return _a(Us(),e,t)},useTransition:function(){var e=$s(!1);return e=Pa.bind(null,bs,e.queue,!0,!1),Us().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=bs,r=Us();if(sr){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===ic)throw Error(a(349));0!==(124&sc)||Ys(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,va(Xs.bind(null,i,s,e),[e]),i.flags|=2048,pa(9,{destroy:void 0,resource:void 0},Qs.bind(null,i,s,n,t),null),n},useId:function(){var e=Us(),t=ic.identifierPrefix;if(sr){var n=Ji;t="\xab"+t+"R"+(n=(Zi&~(1<<32-pe(Zi)-1)).toString(32)+n),0<(n=Ss++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=Ps++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Da,useFormState:la,useActionState:la,useOptimistic:function(e){var t=Us();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Fa.bind(null,bs,!0,n),n.dispatch=t,[e,t]},useMemoCache:Vs,useCacheRefresh:function(){return Us().memoizedState=ka.bind(null,bs)}},qa={readContext:_r,use:js,useCallback:Aa,useContext:_r,useEffect:ya,useImperativeHandle:Ea,useInsertionEffect:ba,useLayoutEffect:wa,useMemo:Sa,useReducer:Ws,useRef:fa,useState:function(){return Ws(Hs)},useDebugValue:Ca,useDeferredValue:function(e,t){return Ta(zs(),ws.memoizedState,e,t)},useTransition:function(){var e=Ws(Hs)[0],t=zs().memoizedState;return["boolean"===typeof e?e:Fs(e),t]},useSyncExternalStore:Ks,useId:La,useHostTransitionStatus:Da,useFormState:ca,useActionState:ca,useOptimistic:function(e,t){return ea(zs(),0,e,t)},useMemoCache:Vs,useCacheRefresh:Ra},Ka={readContext:_r,use:js,useCallback:Aa,useContext:_r,useEffect:ya,useImperativeHandle:Ea,useInsertionEffect:ba,useLayoutEffect:wa,useMemo:Sa,useReducer:qs,useRef:fa,useState:function(){return qs(Hs)},useDebugValue:Ca,useDeferredValue:function(e,t){var n=zs();return null===ws?_a(n,e,t):Ta(n,ws.memoizedState,e,t)},useTransition:function(){var e=qs(Hs)[0],t=zs().memoizedState;return["boolean"===typeof e?e:Fs(e),t]},useSyncExternalStore:Ks,useId:La,useHostTransitionStatus:Da,useFormState:da,useActionState:da,useOptimistic:function(e,t){var n=zs();return null!==ws?ea(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Vs,useCacheRefresh:Ra},Ya=null,Qa=0;function Xa(e){var t=Qa;return Qa+=1,null===Ya&&(Ya=[]),Zr(Ya,e,t)}function Za(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Ja(e,t){if(t.$$typeof===p)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function $a(e){return(0,e._init)(e._payload)}function eo(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=Ui(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=67108866,n):i:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Vi(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===g?u(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===_&&$a(s)===t.type)?(Za(t=r(t,n.props),n),t.return=e,t):(Za(t=Fi(n.type,n.key,n.props,null,e.mode,i),n),t.return=e,t)}function h(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Hi(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function u(e,t,n,i,s){return null===t||7!==t.tag?((t=ji(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Vi(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case f:return Za(n=Fi(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=Hi(t,e.mode,n)).return=e,t;case _:return d(e,t=(0,t._init)(t._payload),n)}if(D(t)||N(t))return(t=ji(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return d(e,Xa(t),n);if(t.$$typeof===x)return d(e,Tr(e,t),n);Ja(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case f:return n.key===r?c(e,t,n,i):null;case m:return n.key===r?h(e,t,n,i):null;case _:return p(e,t,n=(r=n._init)(n._payload),i)}if(D(n)||N(n))return null!==r?null:u(e,t,n,i,null);if("function"===typeof n.then)return p(e,t,Xa(n),i);if(n.$$typeof===x)return p(e,t,Tr(e,n),i);Ja(e,n)}return null}function v(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i||"bigint"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case f:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case m:return h(t,e=e.get(null===i.key?n:i.key)||null,i,r);case _:return v(e,t,n,i=(0,i._init)(i._payload),r)}if(D(i)||N(i))return u(t,e=e.get(n)||null,i,r,null);if("function"===typeof i.then)return v(e,t,n,Xa(i),r);if(i.$$typeof===x)return v(e,t,n,Tr(t,i),r);Ja(t,i)}return null}function y(l,c,h,u){if("object"===typeof h&&null!==h&&h.type===g&&null===h.key&&(h=h.props.children),"object"===typeof h&&null!==h){switch(h.$$typeof){case f:e:{for(var b=h.key;null!==c;){if(c.key===b){if((b=h.type)===g){if(7===c.tag){n(l,c.sibling),(u=r(c,h.props.children)).return=l,l=u;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===_&&$a(b)===c.type){n(l,c.sibling),Za(u=r(c,h.props),h),u.return=l,l=u;break e}n(l,c);break}t(l,c),c=c.sibling}h.type===g?((u=ji(h.props.children,l.mode,u,h.key)).return=l,l=u):(Za(u=Fi(h.type,h.key,h.props,null,l.mode,u),h),u.return=l,l=u)}return o(l);case m:e:{for(b=h.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===h.containerInfo&&c.stateNode.implementation===h.implementation){n(l,c.sibling),(u=r(c,h.children||[])).return=l,l=u;break e}n(l,c);break}t(l,c),c=c.sibling}(u=Hi(h,l.mode,u)).return=l,l=u}return o(l);case _:return y(l,c,h=(b=h._init)(h._payload),u)}if(D(h))return function(r,a,o,l){for(var c=null,h=null,u=a,f=a=0,m=null;null!==u&&f<o.length;f++){u.index>f?(m=u,u=null):m=u.sibling;var g=p(r,u,o[f],l);if(null===g){null===u&&(u=m);break}e&&u&&null===g.alternate&&t(r,u),a=s(g,a,f),null===h?c=g:h.sibling=g,h=g,u=m}if(f===o.length)return n(r,u),sr&&$i(r,f),c;if(null===u){for(;f<o.length;f++)null!==(u=d(r,o[f],l))&&(a=s(u,a,f),null===h?c=u:h.sibling=u,h=u);return sr&&$i(r,f),c}for(u=i(u);f<o.length;f++)null!==(m=v(u,r,f,o[f],l))&&(e&&null!==m.alternate&&u.delete(null===m.key?f:m.key),a=s(m,a,f),null===h?c=m:h.sibling=m,h=m);return e&&u.forEach((function(e){return t(r,e)})),sr&&$i(r,f),c}(l,c,h,u);if(N(h)){if("function"!==typeof(b=N(h)))throw Error(a(150));return function(r,o,l,c){if(null==l)throw Error(a(151));for(var h=null,u=null,f=o,m=o=0,g=null,y=l.next();null!==f&&!y.done;m++,y=l.next()){f.index>m?(g=f,f=null):g=f.sibling;var b=p(r,f,y.value,c);if(null===b){null===f&&(f=g);break}e&&f&&null===b.alternate&&t(r,f),o=s(b,o,m),null===u?h=b:u.sibling=b,u=b,f=g}if(y.done)return n(r,f),sr&&$i(r,m),h;if(null===f){for(;!y.done;m++,y=l.next())null!==(y=d(r,y.value,c))&&(o=s(y,o,m),null===u?h=y:u.sibling=y,u=y);return sr&&$i(r,m),h}for(f=i(f);!y.done;m++,y=l.next())null!==(y=v(f,r,m,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?m:y.key),o=s(y,o,m),null===u?h=y:u.sibling=y,u=y);return e&&f.forEach((function(e){return t(r,e)})),sr&&$i(r,m),h}(l,c,h=b.call(h),u)}if("function"===typeof h.then)return y(l,c,Xa(h),u);if(h.$$typeof===x)return y(l,c,Tr(l,h),u);Ja(l,h)}return"string"===typeof h&&""!==h||"number"===typeof h||"bigint"===typeof h?(h=""+h,null!==c&&6===c.tag?(n(l,c.sibling),(u=r(c,h)).return=l,l=u):(n(l,c),(u=Vi(h,l.mode,u)).return=l,l=u),o(l)):n(l,c)}return function(e,t,n,i){try{Qa=0;var r=y(e,t,n,i);return Ya=null,r}catch(a){if(a===Gr||a===Kr)throw a;var s=ki(29,a,null,e.mode);return s.lanes=i,s.return=e,s}}}var to=eo(!0),no=eo(!1),io=z(null),ro=null;function so(e){var t=e.alternate;j(co,1&co.current),j(io,e),null===ro&&(null===t||null!==ps.current||null!==t.memoizedState)&&(ro=e)}function ao(e){if(22===e.tag){if(j(co,co.current),j(io,e),null===ro){var t=e.alternate;null!==t&&null!==t.memoizedState&&(ro=e)}}else oo()}function oo(){j(co,co.current),j(io,io.current)}function lo(e){F(io),ro===e&&(ro=null),F(co)}var co=z(0);function ho(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||gu(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function uo(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:d({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var po={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Lc(),r=rs(i);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=ss(e,r,i))&&(kc(t,e,i),as(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Lc(),r=rs(i);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=ss(e,r,i))&&(kc(t,e,i),as(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Lc(),i=rs(n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=ss(e,i,n))&&(kc(t,e,n),as(t,e,n))}};function fo(e,t,n,i,r,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!Xn(n,i)||!Xn(r,s))}function mo(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&po.enqueueReplaceState(t,t.state,null)}function go(e,t){var n=t;if("ref"in t)for(var i in n={},t)"ref"!==i&&(n[i]=t[i]);if(e=e.defaultProps)for(var r in n===t&&(n=d({},n)),e)void 0===n[r]&&(n[r]=e[r]);return n}var vo="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function yo(e){vo(e)}function bo(e){console.error(e)}function wo(e){vo(e)}function xo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout((function(){throw n}))}}function Eo(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(i){setTimeout((function(){throw i}))}}function Co(e,t,n){return(n=rs(n)).tag=3,n.payload={element:null},n.callback=function(){xo(e,t)},n}function Ao(e){return(e=rs(e)).tag=3,e}function So(e,t,n,i){var r=n.type.getDerivedStateFromError;if("function"===typeof r){var s=i.value;e.payload=function(){return r(s)},e.callback=function(){Eo(t,n,i)}}var a=n.stateNode;null!==a&&"function"===typeof a.componentDidCatch&&(e.callback=function(){Eo(t,n,i),"function"!==typeof r&&(null===Ac?Ac=new Set([this]):Ac.add(this));var e=i.stack;this.componentDidCatch(i.value,{componentStack:null!==e?e:""})})}var _o=Error(a(461)),To=!1;function Po(e,t,n,i){t.child=null===e?no(t,null,n,i):to(t,e.child,n,i)}function Mo(e,t,n,i,r){n=n.render;var s=t.ref;if("ref"in i){var a={};for(var o in i)"ref"!==o&&(a[o]=i[o])}else a=i;return Sr(t),i=Is(e,t,n,a,s,r),o=Rs(),null===e||To?(sr&&o&&tr(t),t.flags|=1,Po(e,t,i,r),t.child):(ks(e,t,r),Qo(e,t,r))}function No(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Bi(s)||void 0!==s.defaultProps||null!==n.compare?((e=Fi(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Io(e,t,s,i,r))}if(s=e.child,!Xo(e,r)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:Xn)(a,i)&&e.ref===t.ref)return Qo(e,t,r)}return t.flags|=1,(e=Ui(s,i)).ref=t.ref,e.return=t,t.child=e}function Io(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(Xn(s,i)&&e.ref===t.ref){if(To=!1,t.pendingProps=i=s,!Xo(e,r))return t.lanes=e.lanes,Qo(e,t,r);0!==(131072&e.flags)&&(To=!0)}}return Ro(e,t,n,i,r)}function Oo(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode){if(0!==(128&t.flags)){if(i=null!==s?s.baseLanes|n:n,null!==e){for(r=t.child=e.child,s=0;null!==r;)s=s|r.lanes|r.childLanes,r=r.sibling;t.childLanes=s&~i}else t.childLanes=0,t.child=null;return Do(e,t,i,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Do(e,t,null!==s?s.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Hr(0,null!==s?s.cachePool:null),null!==s?ms(t,s):gs(),ao(t)}else null!==s?(Hr(0,s.cachePool),ms(t,s),oo(),t.memoizedState=null):(null!==e&&Hr(0,null),gs(),oo());return Po(e,t,r,n),t.child}function Do(e,t,n,i){var r=Vr();return r=null===r?null:{parent:Or._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},null!==e&&Hr(0,null),gs(),ao(t),null!==e&&Cr(e,t,i,!0),null}function Lo(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Ro(e,t,n,i,r){return Sr(t),n=Is(e,t,n,i,void 0,r),i=Rs(),null===e||To?(sr&&i&&tr(t),t.flags|=1,Po(e,t,n,r),t.child):(ks(e,t,r),Qo(e,t,r))}function ko(e,t,n,i,r,s){return Sr(t),t.updateQueue=null,n=Ds(t,i,n,r),Os(e),i=Rs(),null===e||To?(sr&&i&&tr(t),t.flags|=1,Po(e,t,n,s),t.child):(ks(e,t,s),Qo(e,t,s))}function Bo(e,t,n,i,r){if(Sr(t),null===t.stateNode){var s=Li,a=n.contextType;"object"===typeof a&&null!==a&&(s=_r(a)),s=new n(i,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=po,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=i,s.state=t.memoizedState,s.refs={},ns(t),a=n.contextType,s.context="object"===typeof a&&null!==a?_r(a):Li,s.state=t.memoizedState,"function"===typeof(a=n.getDerivedStateFromProps)&&(uo(t,n,a,i),s.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(a=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),a!==s.state&&po.enqueueReplaceState(s,s.state,null),hs(t,i,s,r),cs(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),i=!0}else if(null===e){s=t.stateNode;var o=t.memoizedProps,l=go(n,o);s.props=l;var c=s.context,h=n.contextType;a=Li,"object"===typeof h&&null!==h&&(a=_r(h));var u=n.getDerivedStateFromProps;h="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate,o=t.pendingProps!==o,h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o||c!==a)&&mo(t,s,i,a),ts=!1;var d=t.memoizedState;s.state=d,hs(t,i,s,r),cs(),c=t.memoizedState,o||d!==c||ts?("function"===typeof u&&(uo(t,n,u,i),c=t.memoizedState),(l=ts||fo(t,n,l,i,d,c,a))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),s.props=i,s.state=c,s.context=a,i=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),i=!1)}else{s=t.stateNode,is(e,t),h=go(n,a=t.memoizedProps),s.props=h,u=t.pendingProps,d=s.context,c=n.contextType,l=Li,"object"===typeof c&&null!==c&&(l=_r(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==u||d!==l)&&mo(t,s,i,l),ts=!1,d=t.memoizedState,s.state=d,hs(t,i,s,r),cs();var p=t.memoizedState;a!==u||d!==p||ts||null!==e&&null!==e.dependencies&&Ar(e.dependencies)?("function"===typeof o&&(uo(t,n,o,i),p=t.memoizedState),(h=ts||fo(t,n,h,i,d,p,l)||null!==e&&null!==e.dependencies&&Ar(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(i,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),s.props=i,s.state=p,s.context=l,i=h):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return s=i,Lo(e,t),i=0!==(128&t.flags),s||i?(s=t.stateNode,n=i&&"function"!==typeof n.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&i?(t.child=to(t,e.child,null,r),t.child=to(t,null,n,r)):Po(e,t,n,r),t.memoizedState=s.state,e=t.child):e=Qo(e,t,r),e}function Uo(e,t,n,i){return pr(),t.flags|=256,Po(e,t,n,i),t.child}var zo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Fo(e){return{baseLanes:e,cachePool:Wr()}}function jo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=gc),e}function Vo(e,t,n){var i,r=t.pendingProps,s=!1,o=0!==(128&t.flags);if((i=o)||(i=(null===e||null!==e.memoizedState)&&0!==(2&co.current)),i&&(s=!0,t.flags&=-129),i=0!==(32&t.flags),t.flags&=-33,null===e){if(sr){if(s?so(t):oo(),sr){var l,c=rr;if(l=c){e:{for(l=c,c=or;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=vu(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Xi?{id:Zi,overflow:Ji}:null,retryLane:536870912,hydrationErrors:null},(l=ki(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ir=t,rr=null,l=!0):l=!1}l||cr(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return gu(c)?t.lanes=32:t.lanes=536870912,null;lo(t)}return c=r.children,r=r.fallback,s?(oo(),c=Wo({mode:"hidden",children:c},s=t.mode),r=ji(r,s,n,null),c.return=t,r.return=t,c.sibling=r,t.child=c,(s=t.child).memoizedState=Fo(n),s.childLanes=jo(e,i,n),t.memoizedState=zo,r):(so(t),Ho(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(o)256&t.flags?(so(t),t.flags&=-257,t=Go(e,t,n)):null!==t.memoizedState?(oo(),t.child=e.child,t.flags|=128,t=null):(oo(),s=r.fallback,c=t.mode,r=Wo({mode:"visible",children:r.children},c),(s=ji(s,c,n,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,to(t,e.child,null,n),(r=t.child).memoizedState=Fo(n),r.childLanes=jo(e,i,n),t.memoizedState=zo,t=s);else if(so(t),gu(c)){if(i=c.nextSibling&&c.nextSibling.dataset)var h=i.dgst;i=h,(r=Error(a(419))).stack="",r.digest=i,mr({value:r,source:null,stack:null}),t=Go(e,t,n)}else if(To||Cr(e,t,n,!1),i=0!==(n&e.childLanes),To||i){if(null!==(i=ic)&&(0!==(r=0!==((r=0!==(42&(r=n&-n))?1:Pe(r))&(i.suspendedLanes|n))?0:r)&&r!==l.retryLane))throw l.retryLane=r,Ii(e,r),kc(i,e,r),_o;"$?"===c.data||Kc(),t=Go(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,rr=vu(c.nextSibling),ir=t,sr=!0,ar=null,or=!1,null!==e&&(Yi[Qi++]=Zi,Yi[Qi++]=Ji,Yi[Qi++]=Xi,Zi=e.id,Ji=e.overflow,Xi=t),(t=Ho(t,r.children)).flags|=4096);return t}return s?(oo(),s=r.fallback,c=t.mode,h=(l=e.child).sibling,(r=Ui(l,{mode:"hidden",children:r.children})).subtreeFlags=65011712&l.subtreeFlags,null!==h?s=Ui(h,s):(s=ji(s,c,n,null)).flags|=2,s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,null===(c=e.child.memoizedState)?c=Fo(n):(null!==(l=c.cachePool)?(h=Or._currentValue,l=l.parent!==h?{parent:h,pool:h}:l):l=Wr(),c={baseLanes:c.baseLanes|n,cachePool:l}),s.memoizedState=c,s.childLanes=jo(e,i,n),t.memoizedState=zo,r):(so(t),e=(n=e.child).sibling,(n=Ui(n,{mode:"visible",children:r.children})).return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n)}function Ho(e,t){return(t=Wo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Wo(e,t){return(e=ki(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Go(e,t,n){return to(t,e.child,null,n),(e=Ho(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qo(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),xr(e.return,t,n)}function Ko(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Yo(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Po(e,t,i.children,n),0!==(2&(i=co.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qo(e,n,t);else if(19===e.tag)qo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}switch(j(co,i),r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ho(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ko(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ho(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ko(t,!0,n,null,s);break;case"together":Ko(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Qo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),pc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Cr(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Ui(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ui(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Xo(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ar(e))}function Zo(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)To=!0;else{if(!Xo(e,n)&&0===(128&t.flags))return To=!1,function(e,t,n){switch(t.tag){case 3:q(t,t.stateNode.containerInfo),br(0,Or,e.memoizedState.cache),pr();break;case 27:case 5:Y(t);break;case 4:q(t,t.stateNode.containerInfo);break;case 10:br(0,t.type,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(so(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Vo(e,t,n):(so(t),null!==(e=Qo(e,t,n))?e.sibling:null);so(t);break;case 19:var r=0!==(128&e.flags);if((i=0!==(n&t.childLanes))||(Cr(e,t,n,!1),i=0!==(n&t.childLanes)),r){if(i)return Yo(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),j(co,co.current),i)break;return null;case 22:case 23:return t.lanes=0,Oo(e,t,n);case 24:br(0,Or,e.memoizedState.cache)}return Qo(e,t,n)}(e,t,n);To=0!==(131072&e.flags)}else To=!1,sr&&0!==(1048576&t.flags)&&er(t,Ki,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var i=t.elementType,r=i._init;if(i=r(i._payload),t.type=i,"function"!==typeof i){if(void 0!==i&&null!==i){if((r=i.$$typeof)===E){t.tag=11,t=Mo(null,t,i,e,n);break e}if(r===S){t.tag=14,t=No(null,t,i,e,n);break e}}throw t=O(i)||i,Error(a(306,t,""))}Bi(i)?(e=go(i,e),t.tag=1,t=Bo(null,t,i,e,n)):(t.tag=0,t=Ro(null,t,i,e,n))}return t;case 0:return Ro(e,t,t.type,t.pendingProps,n);case 1:return Bo(e,t,i=t.type,r=go(i,t.pendingProps),n);case 3:e:{if(q(t,t.stateNode.containerInfo),null===e)throw Error(a(387));i=t.pendingProps;var s=t.memoizedState;r=s.element,is(e,t),hs(t,i,null,n);var o=t.memoizedState;if(i=o.cache,br(0,Or,i),i!==s.cache&&Er(t,[Or],n,!0),cs(),i=o.element,s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Uo(e,t,i,n);break e}if(i!==r){mr(r=Ai(Error(a(424)),t)),t=Uo(e,t,i,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(rr=vu(e.firstChild),ir=t,sr=!0,ar=null,or=!0,n=no(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pr(),i===r){t=Qo(e,t,n);break e}Po(e,t,i,n)}t=t.child}return t;case 26:return Lo(e,t),null===e?(n=Pu(t.type,null,t.pendingProps,null))?t.memoizedState=n:sr||(n=t.type,e=t.pendingProps,(i=iu(W.current).createElement(n))[Oe]=t,i[De]=e,eu(i,n,e),Ge(i),t.stateNode=i):t.memoizedState=Pu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Y(t),null===e&&sr&&(i=t.stateNode=wu(t.type,t.pendingProps,W.current),ir=t,or=!0,r=rr,pu(t.type)?(yu=r,rr=vu(i.firstChild)):rr=r),Po(e,t,t.pendingProps.children,n),Lo(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&sr&&((r=i=rr)&&(null!==(i=function(e,t,n,i){for(;1===e.nodeType;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(i){if(!e[ze])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===s)return e}if(null===(e=vu(e.nextSibling)))break}return null}(i,t.type,t.pendingProps,or))?(t.stateNode=i,ir=t,rr=vu(i.firstChild),or=!1,r=!0):r=!1),r||cr(t)),Y(t),r=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,i=s.children,au(r,s)?i=null:null!==o&&au(r,o)&&(t.flags|=32),null!==t.memoizedState&&(r=Is(e,t,Ls,null,null,n),Yu._currentValue=r),Lo(e,t),Po(e,t,i,n),t.child;case 6:return null===e&&sr&&((e=n=rr)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=vu(e.nextSibling)))return null}return e}(n,t.pendingProps,or))?(t.stateNode=n,ir=t,rr=null,e=!0):e=!1),e||cr(t)),null;case 13:return Vo(e,t,n);case 4:return q(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=to(t,null,i,n):Po(e,t,i,n),t.child;case 11:return Mo(e,t,t.type,t.pendingProps,n);case 7:return Po(e,t,t.pendingProps,n),t.child;case 8:case 12:return Po(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,br(0,t.type,i.value),Po(e,t,i.children,n),t.child;case 9:return r=t.type._context,i=t.pendingProps.children,Sr(t),i=i(r=_r(r)),t.flags|=1,Po(e,t,i,n),t.child;case 14:return No(e,t,t.type,t.pendingProps,n);case 15:return Io(e,t,t.type,t.pendingProps,n);case 19:return Yo(e,t,n);case 31:return i=t.pendingProps,n=t.mode,i={mode:i.mode,children:i.children},null===e?((n=Wo(i,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Ui(e.child,i)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Oo(e,t,n);case 24:return Sr(t),i=_r(Or),null===e?(null===(r=Vr())&&(r=ic,s=Dr(),r.pooledCache=s,s.refCount++,null!==s&&(r.pooledCacheLanes|=n),r=s),t.memoizedState={parent:i,cache:r},ns(t),br(0,Or,r)):(0!==(e.lanes&n)&&(is(e,t),hs(t,null,null,n),cs()),r=e.memoizedState,s=t.memoizedState,r.parent!==i?(r={parent:i,cache:i},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),br(0,Or,i)):(i=s.cache,br(0,Or,i),i!==r.cache&&Er(t,[Or],n,!0))),Po(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function Jo(e){e.flags|=4}function $o(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!ju(t)){if(null!==(t=io.current)&&((4194048&sc)===sc?null!==ro:(62914560&sc)!==sc&&0===(536870912&sc)||t!==ro))throw Jr=Yr,qr;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ce():536870912,e.lanes|=t,vc|=t)}function tl(e,t){if(!sr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=65011712&r.subtreeFlags,i|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function il(e,t,n){var i=t.pendingProps;switch(nr(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,i=null,null!==e&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),wr(Or),K(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(dr(t)?Jo(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,fr())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Jo(t),null!==n?(nl(t),$o(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Jo(t),nl(t),$o(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==i&&Jo(t),nl(t),t.flags&=-16777217),null;case 27:Q(t),n=W.current;var r=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==i&&Jo(t);else{if(!i){if(null===t.stateNode)throw Error(a(166));return nl(t),null}e=V.current,dr(t)?hr(t):(e=wu(r,i,n),t.stateNode=e,Jo(t))}return nl(t),null;case 5:if(Q(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&Jo(t);else{if(!i){if(null===t.stateNode)throw Error(a(166));return nl(t),null}if(e=V.current,dr(t))hr(t);else{switch(r=iu(W.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=r.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof i.is?r.createElement("select",{is:i.is}):r.createElement("select"),i.multiple?e.multiple=!0:i.size&&(e.size=i.size);break;default:e="string"===typeof i.is?r.createElement(n,{is:i.is}):r.createElement(n)}}e[Oe]=t,e[De]=i;e:for(r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&27!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;null===r.sibling;){if(null===r.return||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(eu(e,n,i),n){case"button":case"input":case"select":case"textarea":e=!!i.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Jo(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==i&&Jo(t);else{if("string"!==typeof i&&null===t.stateNode)throw Error(a(166));if(e=W.current,dr(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,null!==(r=ir))switch(r.tag){case 27:case 5:i=r.memoizedProps}e[Oe]=t,(e=!!(e.nodeValue===n||null!==i&&!0===i.suppressHydrationWarning||Xh(e.nodeValue,n)))||cr(t)}else(e=iu(e).createTextNode(i))[Oe]=t,t.stateNode=e}return nl(t),null;case 13:if(i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=dr(t),null!==i&&null!==i.dehydrated){if(null===e){if(!r)throw Error(a(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(a(317));r[Oe]=t}else pr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),r=!1}else r=fr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(lo(t),t):(lo(t),null)}if(lo(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==i,e=null!==e&&null!==e.memoizedState,n){r=null,null!==(i=t.child).alternate&&null!==i.alternate.memoizedState&&null!==i.alternate.memoizedState.cachePool&&(r=i.alternate.memoizedState.cachePool.pool);var s=null;null!==i.memoizedState&&null!==i.memoizedState.cachePool&&(s=i.memoizedState.cachePool.pool),s!==r&&(i.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return K(),null===e&&Fh(t.stateNode.containerInfo),nl(t),null;case 10:return wr(t.type),nl(t),null;case 19:if(F(co),null===(r=t.memoizedState))return nl(t),null;if(i=0!==(128&t.flags),null===(s=r.rendering))if(i)tl(r,!1);else{if(0!==dc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=ho(e))){for(t.flags|=128,tl(r,!1),e=s.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)zi(n,e),n=n.sibling;return j(co,1&co.current|2),t.child}e=e.sibling}null!==r.tail&&te()>Ec&&(t.flags|=128,i=!0,tl(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ho(s))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!sr)return nl(t),null}else 2*te()-r.renderingStartTime>Ec&&536870912!==n&&(t.flags|=128,i=!0,tl(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=r.last)?e.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=te(),t.sibling=null,e=co.current,j(co,i?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return lo(t),vs(),i=null!==t.memoizedState,null!==e?null!==e.memoizedState!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),i=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),null!==e&&F(jr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),wr(Or),nl(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function rl(e,t){switch(nr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return wr(Or),K(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Q(t),null;case 13:if(lo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));pr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return F(co),null;case 4:return K(),null;case 10:return wr(t.type),null;case 22:case 23:return lo(t),vs(),null!==e&&F(jr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return wr(Or),null;default:return null}}function sl(e,t){switch(nr(t),t.tag){case 3:wr(Or),K();break;case 26:case 27:case 5:Q(t);break;case 4:K();break;case 13:lo(t);break;case 19:F(co);break;case 10:wr(t.type);break;case 22:case 23:lo(t),vs(),null!==e&&F(jr);break;case 24:wr(Or)}}function al(e,t){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var r=i.next;n=r;do{if((n.tag&e)===e){i=void 0;var s=n.create,a=n.inst;i=s(),a.destroy=i}n=n.next}while(n!==r)}}catch(o){hh(t,t.return,o)}}function ol(e,t,n){try{var i=t.updateQueue,r=null!==i?i.lastEffect:null;if(null!==r){var s=r.next;i=s;do{if((i.tag&e)===e){var a=i.inst,o=a.destroy;if(void 0!==o){a.destroy=void 0,r=t;var l=n,c=o;try{c()}catch(h){hh(r,l,h)}}}i=i.next}while(i!==s)}}catch(h){hh(t,t.return,h)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{ds(t,n)}catch(i){hh(e,e.return,i)}}}function cl(e,t,n){n.props=go(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){hh(e,t,i)}}function hl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;default:i=e.stateNode}"function"===typeof n?e.refCleanup=n(i):n.current=i}}catch(r){hh(e,t,r)}}function ul(e,t){var n=e.ref,i=e.refCleanup;if(null!==n)if("function"===typeof i)try{i()}catch(r){hh(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(s){hh(e,t,s)}else n.current=null}function dl(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(r){hh(e,e.return,r)}}function pl(e,t,n){try{var i=e.stateNode;!function(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,s=null,o=null,l=null,c=null,h=null,u=null;for(f in n){var d=n[f];if(n.hasOwnProperty(f)&&null!=d)switch(f){case"checked":case"value":break;case"defaultValue":c=d;default:i.hasOwnProperty(f)||Jh(e,t,f,null,i,d)}}for(var p in i){var f=i[p];if(d=n[p],i.hasOwnProperty(p)&&(null!=f||null!=d))switch(p){case"type":s=f;break;case"name":r=f;break;case"checked":h=f;break;case"defaultChecked":u=f;break;case"value":o=f;break;case"defaultValue":l=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(a(137,t));break;default:f!==d&&Jh(e,t,p,f,i,d)}}return void gt(e,o,l,c,h,u,s,r);case"select":for(s in f=o=l=p=null,n)if(c=n[s],n.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":f=c;default:i.hasOwnProperty(s)||Jh(e,t,s,null,i,c)}for(r in i)if(s=i[r],c=n[r],i.hasOwnProperty(r)&&(null!=s||null!=c))switch(r){case"value":p=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&Jh(e,t,r,s,i,c)}return t=l,n=o,i=f,void(null!=p?bt(e,!!n,p,!1):!!i!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(l in f=p=null,n)if(r=n[l],n.hasOwnProperty(l)&&null!=r&&!i.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Jh(e,t,l,null,i,r)}for(o in i)if(r=i[o],s=n[o],i.hasOwnProperty(o)&&(null!=r||null!=s))switch(o){case"value":p=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(a(91));break;default:r!==s&&Jh(e,t,o,r,i,s)}return void wt(e,p,f);case"option":for(var m in n)if(p=n[m],n.hasOwnProperty(m)&&null!=p&&!i.hasOwnProperty(m))if("selected"===m)e.selected=!1;else Jh(e,t,m,null,i,p);for(c in i)if(p=i[c],f=n[c],i.hasOwnProperty(c)&&p!==f&&(null!=p||null!=f))if("selected"===c)e.selected=p&&"function"!==typeof p&&"symbol"!==typeof p;else Jh(e,t,c,p,i,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)p=n[g],n.hasOwnProperty(g)&&null!=p&&!i.hasOwnProperty(g)&&Jh(e,t,g,null,i,p);for(h in i)if(p=i[h],f=n[h],i.hasOwnProperty(h)&&p!==f&&(null!=p||null!=f))switch(h){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(a(137,t));break;default:Jh(e,t,h,p,i,f)}return;default:if(_t(t)){for(var v in n)p=n[v],n.hasOwnProperty(v)&&void 0!==p&&!i.hasOwnProperty(v)&&$h(e,t,v,void 0,i,p);for(u in i)p=i[u],f=n[u],!i.hasOwnProperty(u)||p===f||void 0===p&&void 0===f||$h(e,t,u,p,i,f);return}}for(var y in n)p=n[y],n.hasOwnProperty(y)&&null!=p&&!i.hasOwnProperty(y)&&Jh(e,t,y,null,i,p);for(d in i)p=i[d],f=n[d],!i.hasOwnProperty(d)||p===f||null==p&&null==f||Jh(e,t,d,p,i,f)}(i,e.type,n,t),i[De]=t}catch(r){hh(e,e.return,r)}}function fl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&pu(e.type)||4===e.tag}function ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||fl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&pu(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function gl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zh));else if(4!==i&&(27===i&&pu(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(gl(e,t,n),e=e.sibling;null!==e;)gl(e,t,n),e=e.sibling}function vl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&(27===i&&pu(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function yl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);eu(t,i,n),t[Oe]=e,t[De]=n}catch(s){hh(e,e.return,s)}}var bl=!1,wl=!1,xl=!1,El="function"===typeof WeakSet?WeakSet:Set,Cl=null;function Al(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Bl(e,n),4&i&&al(5,n);break;case 1:if(Bl(e,n),4&i)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(a){hh(n,n.return,a)}else{var r=go(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){hh(n,n.return,o)}}64&i&&ll(n),512&i&&hl(n,n.return);break;case 3:if(Bl(e,n),64&i&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{ds(e,t)}catch(a){hh(n,n.return,a)}}break;case 27:null===t&&4&i&&yl(n);case 26:case 5:Bl(e,n),null===t&&4&i&&dl(n),512&i&&hl(n,n.return);break;case 12:Bl(e,n);break;case 13:Bl(e,n),4&i&&Nl(e,n),64&i&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}(e,n=fh.bind(null,n))));break;case 22:if(!(i=null!==n.memoizedState||bl)){t=null!==t&&null!==t.memoizedState||wl,r=bl;var s=wl;bl=i,(wl=t)&&!s?zl(e,n,0!==(8772&n.subtreeFlags)):Bl(e,n),bl=r,wl=s}break;case 30:break;default:Bl(e,n)}}function Sl(e){var t=e.alternate;null!==t&&(e.alternate=null,Sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Fe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var _l=null,Tl=!1;function Pl(e,t,n){for(n=n.child;null!==n;)Ml(e,t,n),n=n.sibling}function Ml(e,t,n){if(ue&&"function"===typeof ue.onCommitFiberUnmount)try{ue.onCommitFiberUnmount(he,n)}catch(s){}switch(n.tag){case 26:wl||ul(n,t),Pl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:wl||ul(n,t);var i=_l,r=Tl;pu(n.type)&&(_l=n.stateNode,Tl=!1),Pl(e,t,n),xu(n.stateNode),_l=i,Tl=r;break;case 5:wl||ul(n,t);case 6:if(i=_l,r=Tl,_l=null,Pl(e,t,n),Tl=r,null!==(_l=i))if(Tl)try{(9===_l.nodeType?_l.body:"HTML"===_l.nodeName?_l.ownerDocument.body:_l).removeChild(n.stateNode)}catch(a){hh(n,t,a)}else try{_l.removeChild(n.stateNode)}catch(a){hh(n,t,a)}break;case 18:null!==_l&&(Tl?(fu(9===(e=_l).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Td(e)):fu(_l,n.stateNode));break;case 4:i=_l,r=Tl,_l=n.stateNode.containerInfo,Tl=!0,Pl(e,t,n),_l=i,Tl=r;break;case 0:case 11:case 14:case 15:wl||ol(2,n,t),wl||ol(4,n,t),Pl(e,t,n);break;case 1:wl||(ul(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount&&cl(n,t,i)),Pl(e,t,n);break;case 21:Pl(e,t,n);break;case 22:wl=(i=wl)||null!==n.memoizedState,Pl(e,t,n),wl=i;break;default:Pl(e,t,n)}}function Nl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Td(e)}catch(n){hh(t,t.return,n)}}function Il(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new El),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new El),t;default:throw Error(a(435,e.tag))}}(e);t.forEach((function(t){var i=mh.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}function Ol(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(pu(l.type)){_l=l.stateNode,Tl=!1;break e}break;case 5:_l=l.stateNode,Tl=!1;break e;case 3:case 4:_l=l.stateNode.containerInfo,Tl=!0;break e}l=l.return}if(null===_l)throw Error(a(160));Ml(s,o,r),_l=null,Tl=!1,null!==(s=r.alternate)&&(s.return=null),r.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Ll(t,e),t=t.sibling}var Dl=null;function Ll(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ol(t,e),Rl(e),4&i&&(ol(3,e,e.return),al(3,e),ol(5,e,e.return));break;case 1:Ol(t,e),Rl(e),512&i&&(wl||null===n||ul(n,n.return)),64&i&&bl&&(null!==(e=e.updateQueue)&&(null!==(i=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?i:n.concat(i))));break;case 26:var r=Dl;if(Ol(t,e),Rl(e),512&i&&(wl||null===n||ul(n,n.return)),4&i){var s=null!==n?n.memoizedState:null;if(i=e.memoizedState,null===n)if(null===i)if(null===e.stateNode){e:{i=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(i){case"title":(!(s=r.getElementsByTagName("title")[0])||s[ze]||s[Oe]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=r.createElement(i),r.head.insertBefore(s,r.querySelector("head > title"))),eu(s,i,n),s[Oe]=e,Ge(s),i=s;break e;case"link":var o=zu("link","href",r).get(i+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&s.getAttribute("rel")===(null==n.rel?null:n.rel)&&s.getAttribute("title")===(null==n.title?null:n.title)&&s.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}eu(s=r.createElement(i),i,n),r.head.appendChild(s);break;case"meta":if(o=zu("meta","content",r).get(i+(n.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&s.getAttribute("name")===(null==n.name?null:n.name)&&s.getAttribute("property")===(null==n.property?null:n.property)&&s.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&s.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}eu(s=r.createElement(i),i,n),r.head.appendChild(s);break;default:throw Error(a(468,i))}s[Oe]=e,Ge(s),i=s}e.stateNode=i}else Fu(r,e.type,e.stateNode);else e.stateNode=Lu(r,i,e.memoizedProps);else s!==i?(null===s?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):s.count--,null===i?Fu(r,e.type,e.stateNode):Lu(r,i,e.memoizedProps)):null===i&&null!==e.stateNode&&pl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Ol(t,e),Rl(e),512&i&&(wl||null===n||ul(n,n.return)),null!==n&&4&i&&pl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Ol(t,e),Rl(e),512&i&&(wl||null===n||ul(n,n.return)),32&e.flags){r=e.stateNode;try{Et(r,"")}catch(f){hh(e,e.return,f)}}4&i&&null!=e.stateNode&&pl(e,r=e.memoizedProps,null!==n?n.memoizedProps:r),1024&i&&(xl=!0);break;case 6:if(Ol(t,e),Rl(e),4&i){if(null===e.stateNode)throw Error(a(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(f){hh(e,e.return,f)}}break;case 3:if(Uu=null,r=Dl,Dl=Au(t.containerInfo),Ol(t,e),Dl=r,Rl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Td(t.containerInfo)}catch(f){hh(e,e.return,f)}xl&&(xl=!1,kl(e));break;case 4:i=Dl,Dl=Au(e.stateNode.containerInfo),Ol(t,e),Rl(e),Dl=i;break;case 12:default:Ol(t,e),Rl(e);break;case 13:Ol(t,e),Rl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(xc=te()),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,Il(e,i)));break;case 22:r=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,h=bl,u=wl;if(bl=h||r,wl=u||c,Ol(t,e),wl=u,bl=h,Rl(e),8192&i)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===n||c||bl||wl||Ul(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(s=c.stateNode,r)"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var d=c.memoizedProps.style,p=void 0!==d&&null!==d&&d.hasOwnProperty("display")?d.display:null;l.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(f){hh(c,c.return,f)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(f){hh(c,c.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&i&&(null!==(i=e.updateQueue)&&(null!==(n=i.retryQueue)&&(i.retryQueue=null,Il(e,n))));break;case 19:Ol(t,e),Rl(e),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,Il(e,i)));case 30:case 21:}}function Rl(e){var t=e.flags;if(2&t){try{for(var n,i=e.return;null!==i;){if(fl(i)){n=i;break}i=i.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var r=n.stateNode;vl(e,ml(e),r);break;case 5:var s=n.stateNode;32&n.flags&&(Et(s,""),n.flags&=-33),vl(e,ml(e),s);break;case 3:case 4:var o=n.stateNode.containerInfo;gl(e,ml(e),o);break;default:throw Error(a(161))}}catch(l){hh(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function kl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;kl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Bl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Al(e,t.alternate,t),t=t.sibling}function Ul(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ol(4,t,t.return),Ul(t);break;case 1:ul(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&cl(t,t.return,n),Ul(t);break;case 27:xu(t.stateNode);case 26:case 5:ul(t,t.return),Ul(t);break;case 22:null===t.memoizedState&&Ul(t);break;default:Ul(t)}e=e.sibling}}function zl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var i=t.alternate,r=e,s=t,a=s.flags;switch(s.tag){case 0:case 11:case 15:zl(r,s,n),al(4,s);break;case 1:if(zl(r,s,n),"function"===typeof(r=(i=s).stateNode).componentDidMount)try{r.componentDidMount()}catch(c){hh(i,i.return,c)}if(null!==(r=(i=s).updateQueue)){var o=i.stateNode;try{var l=r.shared.hiddenCallbacks;if(null!==l)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)us(l[r],o)}catch(c){hh(i,i.return,c)}}n&&64&a&&ll(s),hl(s,s.return);break;case 27:yl(s);case 26:case 5:zl(r,s,n),n&&null===i&&4&a&&dl(s),hl(s,s.return);break;case 12:zl(r,s,n);break;case 13:zl(r,s,n),n&&4&a&&Nl(r,s);break;case 22:null===s.memoizedState&&zl(r,s,n),hl(s,s.return);break;case 30:break;default:zl(r,s,n)}t=t.sibling}}function Fl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Lr(n))}function jl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Lr(e))}function Vl(e,t,n,i){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Hl(e,t,n,i),t=t.sibling}function Hl(e,t,n,i){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Vl(e,t,n,i),2048&r&&al(9,t);break;case 1:case 13:default:Vl(e,t,n,i);break;case 3:Vl(e,t,n,i),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Lr(e)));break;case 12:if(2048&r){Vl(e,t,n,i),e=t.stateNode;try{var s=t.memoizedProps,a=s.id,o=s.onPostCommit;"function"===typeof o&&o(a,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){hh(t,t.return,l)}}else Vl(e,t,n,i);break;case 23:break;case 22:s=t.stateNode,a=t.alternate,null!==t.memoizedState?2&s._visibility?Vl(e,t,n,i):Gl(e,t):2&s._visibility?Vl(e,t,n,i):(s._visibility|=2,Wl(e,t,n,i,0!==(10256&t.subtreeFlags))),2048&r&&Fl(a,t);break;case 24:Vl(e,t,n,i),2048&r&&jl(t.alternate,t)}}function Wl(e,t,n,i,r){for(r=r&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var s=e,a=t,o=n,l=i,c=a.flags;switch(a.tag){case 0:case 11:case 15:Wl(s,a,o,l,r),al(8,a);break;case 23:break;case 22:var h=a.stateNode;null!==a.memoizedState?2&h._visibility?Wl(s,a,o,l,r):Gl(s,a):(h._visibility|=2,Wl(s,a,o,l,r)),r&&2048&c&&Fl(a.alternate,a);break;case 24:Wl(s,a,o,l,r),r&&2048&c&&jl(a.alternate,a);break;default:Wl(s,a,o,l,r)}t=t.sibling}}function Gl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,i=t,r=i.flags;switch(i.tag){case 22:Gl(n,i),2048&r&&Fl(i.alternate,i);break;case 24:Gl(n,i),2048&r&&jl(i.alternate,i);break;default:Gl(n,i)}t=t.sibling}}var ql=8192;function Kl(e){if(e.subtreeFlags&ql)for(e=e.child;null!==e;)Yl(e),e=e.sibling}function Yl(e){switch(e.tag){case 26:Kl(e),e.flags&ql&&null!==e.memoizedState&&function(e,t,n){if(null===Vu)throw Error(a(475));var i=Vu;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var r=Mu(n.href),s=e.querySelector(Nu(r));if(s)return null!==(e=s._p)&&"object"===typeof e&&"function"===typeof e.then&&(i.count++,i=Wu.bind(i),e.then(i,i)),t.state.loading|=4,t.instance=s,void Ge(s);s=e.ownerDocument||e,n=Iu(n),(r=Eu.get(r))&&ku(n,r),Ge(s=s.createElement("link"));var o=s;o._p=new Promise((function(e,t){o.onload=e,o.onerror=t})),eu(s,"link",n),t.instance=s}null===i.stylesheets&&(i.stylesheets=new Map),i.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(i.count++,t=Wu.bind(i),e.addEventListener("load",t),e.addEventListener("error",t))}}(Dl,e.memoizedState,e.memoizedProps);break;case 5:default:Kl(e);break;case 3:case 4:var t=Dl;Dl=Au(e.stateNode.containerInfo),Kl(e),Dl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=ql,ql=16777216,Kl(e),ql=t):Kl(e))}}function Ql(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Xl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Cl=i,$l(i,e)}Ql(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Zl(e),e=e.sibling}function Zl(e){switch(e.tag){case 0:case 11:case 15:Xl(e),2048&e.flags&&ol(9,e,e.return);break;case 3:case 12:default:Xl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Jl(e)):Xl(e)}}function Jl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Cl=i,$l(i,e)}Ql(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:ol(8,t,t.return),Jl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Jl(t));break;default:Jl(t)}e=e.sibling}}function $l(e,t){for(;null!==Cl;){var n=Cl;switch(n.tag){case 0:case 11:case 15:ol(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var i=n.memoizedState.cachePool.pool;null!=i&&i.refCount++}break;case 24:Lr(n.memoizedState.cache)}if(null!==(i=n.child))i.return=n,Cl=i;else e:for(n=e;null!==Cl;){var r=(i=Cl).sibling,s=i.return;if(Sl(i),i===n){Cl=null;break e}if(null!==r){r.return=s,Cl=r;break e}Cl=s}}}var ec={getCacheForType:function(e){var t=_r(Or),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tc="function"===typeof WeakMap?WeakMap:Map,nc=0,ic=null,rc=null,sc=0,ac=0,oc=null,lc=!1,cc=!1,hc=!1,uc=0,dc=0,pc=0,fc=0,mc=0,gc=0,vc=0,yc=null,bc=null,wc=!1,xc=0,Ec=1/0,Cc=null,Ac=null,Sc=0,_c=null,Tc=null,Pc=0,Mc=0,Nc=null,Ic=null,Oc=0,Dc=null;function Lc(){if(0!==(2&nc)&&0!==sc)return sc&-sc;if(null!==L.T){return 0!==Br?Br:Mh()}return Ne()}function Rc(){0===gc&&(gc=0===(536870912&sc)||sr?Ee():536870912);var e=io.current;return null!==e&&(e.flags|=32),gc}function kc(e,t,n){(e!==ic||2!==ac&&9!==ac)&&null===e.cancelPendingCommit||(Hc(e,0),Fc(e,sc,gc,!1)),Se(e,n),0!==(2&nc)&&e===ic||(e===ic&&(0===(2&nc)&&(fc|=n),4===dc&&Fc(e,sc,gc,!1)),Eh(e))}function Bc(e,t,n){if(0!==(6&nc))throw Error(a(327));for(var i=!n&&0===(124&t)&&0===(t&e.expiredLanes)||we(e,t),r=i?function(e,t){var n=nc;nc|=2;var i=Gc(),r=qc();ic!==e||sc!==t?(Cc=null,Ec=te()+500,Hc(e,t)):cc=we(e,t);e:for(;;)try{if(0!==ac&&null!==rc){t=rc;var s=oc;t:switch(ac){case 1:ac=0,oc=null,$c(e,t,s,1);break;case 2:case 9:if(Qr(s)){ac=0,oc=null,Jc(t);break}t=function(){2!==ac&&9!==ac||ic!==e||(ac=7),Eh(e)},s.then(t,t);break e;case 3:ac=7;break e;case 4:ac=5;break e;case 7:Qr(s)?(ac=0,oc=null,Jc(t)):(ac=0,oc=null,$c(e,t,s,7));break;case 5:var o=null;switch(rc.tag){case 26:o=rc.memoizedState;case 5:case 27:var l=rc;if(!o||ju(o)){ac=0,oc=null;var c=l.sibling;if(null!==c)rc=c;else{var h=l.return;null!==h?(rc=h,eh(h)):rc=null}break t}}ac=0,oc=null,$c(e,t,s,5);break;case 6:ac=0,oc=null,$c(e,t,s,6);break;case 8:Vc(),dc=6;break e;default:throw Error(a(462))}}Xc();break}catch(u){Wc(e,u)}return yr=vr=null,L.H=i,L.A=r,nc=n,null!==rc?0:(ic=null,sc=0,Pi(),dc)}(e,t):Yc(e,t,!0),s=i;;){if(0===r){cc&&!i&&Fc(e,t,0,!1);break}if(n=e.current.alternate,!s||zc(n)){if(2===r){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;r=yc;var c=l.current.memoizedState.isDehydrated;if(c&&(Hc(l,o).flags|=256),2!==(o=Yc(l,o,!1))){if(hc&&!c){l.errorRecoveryDisabledLanes|=s,fc|=s,r=4;break e}s=bc,bc=r,null!==s&&(null===bc?bc=s:bc.push.apply(bc,s))}r=o}if(s=!1,2!==r)continue}}if(1===r){Hc(e,0),Fc(e,t,0,!0);break}e:{switch(i=e,s=r){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:Fc(i,t,gc,!lc);break e;case 2:bc=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(r=xc+300-te())){if(Fc(i,t,gc,!lc),0!==be(i,0,!0))break e;i.timeoutHandle=lu(Uc.bind(null,i,n,bc,Cc,wc,t,gc,fc,vc,lc,s,2,-0,0),r)}else Uc(i,n,bc,Cc,wc,t,gc,fc,vc,lc,s,0,-0,0)}break}r=Yc(e,t,!1),s=!1}Eh(e)}function Uc(e,t,n,i,r,s,o,l,c,h,u,d,p,f){if(e.timeoutHandle=-1,(8192&(d=t.subtreeFlags)||16785408===(16785408&d))&&(Vu={stylesheets:null,count:0,unsuspend:Hu},Yl(t),null!==(d=function(){if(null===Vu)throw Error(a(475));var e=Vu;return e.stylesheets&&0===e.count&&qu(e,e.stylesheets),0<e.count?function(t){var n=setTimeout((function(){if(e.stylesheets&&qu(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=d(nh.bind(null,e,t,s,n,i,r,o,l,c,u,1,p,f)),void Fc(e,s,o,!h);nh(e,t,s,n,i,r,o,l,c)}function zc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Qn(s(),r))return!1}catch(a){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Fc(e,t,n,i){t&=~mc,t&=~fc,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var r=t;0<r;){var s=31-pe(r),a=1<<s;i[s]=-1,r&=~a}0!==n&&_e(e,n,t)}function jc(){return 0!==(6&nc)||(Ch(0,!1),!1)}function Vc(){if(null!==rc){if(0===ac)var e=rc.return;else yr=vr=null,Bs(e=rc),Ya=null,Qa=0,e=rc;for(;null!==e;)sl(e.alternate,e),e=e.return;rc=null}}function Hc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,cu(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Vc(),ic=e,rc=n=Ui(e.current,null),sc=t,ac=0,oc=null,lc=!1,cc=we(e,t),hc=!1,vc=gc=mc=fc=pc=dc=0,bc=yc=null,wc=!1,0!==(8&t)&&(t|=32&t);var i=e.entangledLanes;if(0!==i)for(e=e.entanglements,i&=t;0<i;){var r=31-pe(i),s=1<<r;t|=e[r],i&=~s}return uc=t,Pi(),n}function Wc(e,t){bs=null,L.H=Wa,t===Gr||t===Kr?(t=$r(),ac=3):t===qr?(t=$r(),ac=4):ac=t===_o?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,oc=t,null===rc&&(dc=1,xo(e,Ai(t,e.current)))}function Gc(){var e=L.H;return L.H=Wa,null===e?Wa:e}function qc(){var e=L.A;return L.A=ec,e}function Kc(){dc=4,lc||(4194048&sc)!==sc&&null!==io.current||(cc=!0),0===(134217727&pc)&&0===(134217727&fc)||null===ic||Fc(ic,sc,gc,!1)}function Yc(e,t,n){var i=nc;nc|=2;var r=Gc(),s=qc();ic===e&&sc===t||(Cc=null,Hc(e,t)),t=!1;var a=dc;e:for(;;)try{if(0!==ac&&null!==rc){var o=rc,l=oc;switch(ac){case 8:Vc(),a=6;break e;case 3:case 2:case 9:case 6:null===io.current&&(t=!0);var c=ac;if(ac=0,oc=null,$c(e,o,l,c),n&&cc){a=0;break e}break;default:c=ac,ac=0,oc=null,$c(e,o,l,c)}}Qc(),a=dc;break}catch(h){Wc(e,h)}return t&&e.shellSuspendCounter++,yr=vr=null,nc=i,L.H=r,L.A=s,null===rc&&(ic=null,sc=0,Pi()),a}function Qc(){for(;null!==rc;)Zc(rc)}function Xc(){for(;null!==rc&&!$();)Zc(rc)}function Zc(e){var t=Zo(e.alternate,e,uc);e.memoizedProps=e.pendingProps,null===t?eh(e):rc=t}function Jc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=ko(n,t,t.pendingProps,t.type,void 0,sc);break;case 11:t=ko(n,t,t.pendingProps,t.type.render,t.ref,sc);break;case 5:Bs(t);default:sl(n,t),t=Zo(n,t=rc=zi(t,uc),uc)}e.memoizedProps=e.pendingProps,null===t?eh(e):rc=t}function $c(e,t,n,i){yr=vr=null,Bs(t),Ya=null,Qa=0;var r=t.return;try{if(function(e,t,n,i,r){if(n.flags|=32768,null!==i&&"object"===typeof i&&"function"===typeof i.then){if(null!==(t=n.alternate)&&Cr(t,n,r,!0),null!==(n=io.current)){switch(n.tag){case 13:return null===ro?Kc():null===n.alternate&&0===dc&&(dc=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===Yr?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([i]):t.add(i),uh(e,i,r)),!1;case 22:return n.flags|=65536,i===Yr?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([i]):n.add(i),uh(e,i,r)),!1}throw Error(a(435,n.tag))}return uh(e,i,r),Kc(),!1}if(sr)return null!==(t=io.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,i!==lr&&mr(Ai(e=Error(a(422),{cause:i}),n))):(i!==lr&&mr(Ai(t=Error(a(423),{cause:i}),n)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,i=Ai(i,n),os(e,r=Co(e.stateNode,i,r)),4!==dc&&(dc=2)),!1;var s=Error(a(520),{cause:i});if(s=Ai(s,n),null===yc?yc=[s]:yc.push(s),4!==dc&&(dc=2),null===t)return!0;i=Ai(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,os(n,e=Co(n.stateNode,i,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Ac||!Ac.has(s))))return n.flags|=65536,r&=-r,n.lanes|=r,So(r=Ao(r),e,n,i),os(n,r),!1}n=n.return}while(null!==n);return!1}(e,r,t,n,sc))return dc=1,xo(e,Ai(n,e.current)),void(rc=null)}catch(s){if(null!==r)throw rc=r,s;return dc=1,xo(e,Ai(n,e.current)),void(rc=null)}32768&t.flags?(sr||1===i?e=!0:cc||0!==(536870912&sc)?e=!1:(lc=e=!0,(2===i||9===i||3===i||6===i)&&(null!==(i=io.current)&&13===i.tag&&(i.flags|=16384))),th(t,e)):eh(t)}function eh(e){var t=e;do{if(0!==(32768&t.flags))return void th(t,lc);e=t.return;var n=il(t.alternate,t,uc);if(null!==n)return void(rc=n);if(null!==(t=t.sibling))return void(rc=t);rc=t=e}while(null!==t);0===dc&&(dc=5)}function th(e,t){do{var n=rl(e.alternate,e);if(null!==n)return n.flags&=32767,void(rc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(rc=e);rc=e=n}while(null!==e);dc=6,rc=null}function nh(e,t,n,i,r,s,o,l,c){e.cancelPendingCommit=null;do{oh()}while(0!==Sc);if(0!==(6&nc))throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(s=t.lanes|t.childLanes,function(e,t,n,i,r,s){var a=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=a&~n;0<n;){var h=31-pe(n),u=1<<h;o[h]=0,l[h]=-1;var d=c[h];if(null!==d)for(c[h]=null,h=0;h<d.length;h++){var p=d[h];null!==p&&(p.lane&=-536870913)}n&=~u}0!==i&&_e(e,i,0),0!==s&&0===r&&0!==e.tag&&(e.suspendedLanes|=s&~(a&~t))}(e,n,s|=Ti,o,l,c),e===ic&&(rc=ic=null,sc=0),Tc=t,_c=e,Pc=n,Mc=s,Nc=r,Ic=i,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,Z(se,(function(){return lh(),null}))):(e.callbackNode=null,e.callbackPriority=0),i=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||i){i=L.T,L.T=null,r=R.p,R.p=2,o=nc,nc|=4;try{!function(e,t){if(e=e.containerInfo,tu=nd,ti(e=ei(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch(g){n=null;break e}var o=0,l=-1,c=-1,h=0,u=0,d=e,p=null;t:for(;;){for(var f;d!==n||0!==r&&3!==d.nodeType||(l=o+r),d!==s||0!==i&&3!==d.nodeType||(c=o+i),3===d.nodeType&&(o+=d.nodeValue.length),null!==(f=d.firstChild);)p=d,d=f;for(;;){if(d===e)break t;if(p===n&&++h===r&&(l=o),p===s&&++u===i&&(c=o),null!==(f=d.nextSibling))break;p=(d=p).parentNode}d=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nu={focusedElem:e,selectionRange:n},nd=!1,Cl=t;null!==Cl;)if(e=(t=Cl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,Cl=e;else for(;null!==Cl;){switch(s=(t=Cl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,n=t,r=s.memoizedProps,s=s.memoizedState,i=n.stateNode;try{var m=go(n.type,r,(n.elementType,n.type));e=i.getSnapshotBeforeUpdate(m,s),i.__reactInternalSnapshotBeforeUpdate=e}catch(v){hh(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))mu(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":mu(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Cl=e;break}Cl=t.return}}(e,t)}finally{nc=o,R.p=r,L.T=i}}Sc=1,ih(),rh(),sh()}}function ih(){if(1===Sc){Sc=0;var e=_c,t=Tc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=L.T,L.T=null;var i=R.p;R.p=2;var r=nc;nc|=4;try{Ll(t,e);var s=nu,a=ei(e.containerInfo),o=s.focusedElem,l=s.selectionRange;if(a!==o&&o&&o.ownerDocument&&$n(o.ownerDocument.documentElement,o)){if(null!==l&&ti(o)){var c=l.start,h=l.end;if(void 0===h&&(h=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(h,o.value.length);else{var u=o.ownerDocument||document,d=u&&u.defaultView||window;if(d.getSelection){var p=d.getSelection(),f=o.textContent.length,m=Math.min(l.start,f),g=void 0===l.end?m:Math.min(l.end,f);!p.extend&&m>g&&(a=g,g=m,m=a);var v=Jn(o,m),y=Jn(o,g);if(v&&y&&(1!==p.rangeCount||p.anchorNode!==v.node||p.anchorOffset!==v.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var b=u.createRange();b.setStart(v.node,v.offset),p.removeAllRanges(),m>g?(p.addRange(b),p.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),p.addRange(b))}}}}for(u=[],p=o;p=p.parentNode;)1===p.nodeType&&u.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<u.length;o++){var w=u[o];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}nd=!!tu,nu=tu=null}finally{nc=r,R.p=i,L.T=n}}e.current=t,Sc=2}}function rh(){if(2===Sc){Sc=0;var e=_c,t=Tc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=L.T,L.T=null;var i=R.p;R.p=2;var r=nc;nc|=4;try{Al(e,t.alternate,t)}finally{nc=r,R.p=i,L.T=n}}Sc=3}}function sh(){if(4===Sc||3===Sc){Sc=0,ee();var e=_c,t=Tc,n=Pc,i=Ic;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Sc=5:(Sc=0,Tc=_c=null,ah(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(Ac=null),Me(n),t=t.stateNode,ue&&"function"===typeof ue.onCommitFiberRoot)try{ue.onCommitFiberRoot(he,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==i){t=L.T,r=R.p,R.p=2,L.T=null;try{for(var s=e.onRecoverableError,a=0;a<i.length;a++){var o=i[a];s(o.value,{componentStack:o.stack})}}finally{L.T=t,R.p=r}}0!==(3&Pc)&&oh(),Eh(e),r=e.pendingLanes,0!==(4194090&n)&&0!==(42&r)?e===Dc?Oc++:(Oc=0,Dc=e):Oc=0,Ch(0,!1)}}function ah(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Lr(t)))}function oh(e){return ih(),rh(),sh(),lh()}function lh(){if(5!==Sc)return!1;var e=_c,t=Mc;Mc=0;var n=Me(Pc),i=L.T,r=R.p;try{R.p=32>n?32:n,L.T=null,n=Nc,Nc=null;var s=_c,o=Pc;if(Sc=0,Tc=_c=null,Pc=0,0!==(6&nc))throw Error(a(331));var l=nc;if(nc|=4,Zl(s.current),Hl(s,s.current,o,n),nc=l,Ch(0,!1),ue&&"function"===typeof ue.onPostCommitFiberRoot)try{ue.onPostCommitFiberRoot(he,s)}catch(c){}return!0}finally{R.p=r,L.T=i,ah(e,t)}}function ch(e,t,n){t=Ai(n,t),null!==(e=ss(e,t=Co(e.stateNode,t,2),2))&&(Se(e,2),Eh(e))}function hh(e,t,n){if(3===e.tag)ch(e,e,n);else for(;null!==t;){if(3===t.tag){ch(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Ac||!Ac.has(i))){e=Ai(n,e),null!==(i=ss(t,n=Ao(2),2))&&(So(n,i,t,e),Se(i,2),Eh(i));break}}t=t.return}}function uh(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new tc;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(hc=!0,r.add(n),e=dh.bind(null,e,t,n),t.then(e,e))}function dh(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ic===e&&(sc&n)===n&&(4===dc||3===dc&&(62914560&sc)===sc&&300>te()-xc?0===(2&nc)&&Hc(e,0):mc|=n,vc===sc&&(vc=0)),Eh(e)}function ph(e,t){0===t&&(t=Ce()),null!==(e=Ii(e,t))&&(Se(e,t),Eh(e))}function fh(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),ph(e,n)}function mh(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==i&&i.delete(t),ph(e,n)}var gh=null,vh=null,yh=!1,bh=!1,wh=!1,xh=0;function Eh(e){e!==vh&&null===e.next&&(null===vh?gh=vh=e:vh=vh.next=e),bh=!0,yh||(yh=!0,uu((function(){0!==(6&nc)?Z(ie,Ah):Sh()})))}function Ch(e,t){if(!wh&&bh){wh=!0;do{for(var n=!1,i=gh;null!==i;){if(!t)if(0!==e){var r=i.pendingLanes;if(0===r)var s=0;else{var a=i.suspendedLanes,o=i.pingedLanes;s=(1<<31-pe(42|e)+1)-1,s=201326741&(s&=r&~(a&~o))?201326741&s|1:s?2|s:0}0!==s&&(n=!0,Ph(i,s))}else s=sc,0===(3&(s=be(i,i===ic?s:0,null!==i.cancelPendingCommit||-1!==i.timeoutHandle)))||we(i,s)||(n=!0,Ph(i,s));i=i.next}}while(n);wh=!1}}function Ah(){Sh()}function Sh(){bh=yh=!1;var e=0;0!==xh&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==ou&&(ou=e,!0);return ou=null,!1}()&&(e=xh),xh=0);for(var t=te(),n=null,i=gh;null!==i;){var r=i.next,s=_h(i,t);0===s?(i.next=null,null===n?gh=r:n.next=r,null===r&&(vh=n)):(n=i,(0!==e||0!==(3&s))&&(bh=!0)),i=r}Ch(e,!1)}function _h(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var a=31-pe(s),o=1<<a,l=r[a];-1===l?0!==(o&n)&&0===(o&i)||(r[a]=xe(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}if(n=sc,n=be(e,e===(t=ic)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),i=e.callbackNode,0===n||e===t&&(2===ac||9===ac)||null!==e.cancelPendingCommit)return null!==i&&null!==i&&J(i),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||we(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==i&&J(i),Me(n)){case 2:case 8:n=re;break;case 32:default:n=se;break;case 268435456:n=oe}return i=Th.bind(null,e),n=Z(n,i),e.callbackPriority=t,e.callbackNode=n,t}return null!==i&&null!==i&&J(i),e.callbackPriority=2,e.callbackNode=null,2}function Th(e,t){if(0!==Sc&&5!==Sc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(oh()&&e.callbackNode!==n)return null;var i=sc;return 0===(i=be(e,e===ic?i:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Bc(e,i,t),_h(e,te()),null!=e.callbackNode&&e.callbackNode===n?Th.bind(null,e):null)}function Ph(e,t){if(oh())return null;Bc(e,t,!0)}function Mh(){return 0===xh&&(xh=Ee()),xh}function Nh(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Mt(""+e)}function Ih(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Oh=0;Oh<xi.length;Oh++){var Dh=xi[Oh];Ei(Dh.toLowerCase(),"on"+(Dh[0].toUpperCase()+Dh.slice(1)))}Ei(pi,"onAnimationEnd"),Ei(fi,"onAnimationIteration"),Ei(mi,"onAnimationStart"),Ei("dblclick","onDoubleClick"),Ei("focusin","onFocus"),Ei("focusout","onBlur"),Ei(gi,"onTransitionRun"),Ei(vi,"onTransitionStart"),Ei(yi,"onTransitionCancel"),Ei(bi,"onTransitionEnd"),Qe("onMouseEnter",["mouseout","mouseover"]),Qe("onMouseLeave",["mouseout","mouseover"]),Qe("onPointerEnter",["pointerout","pointerover"]),Qe("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rh=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lh));function kh(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=c;try{s(r)}catch(h){vo(h)}r.currentTarget=null,s=l}else for(a=0;a<i.length;a++){if(l=(o=i[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=c;try{s(r)}catch(h){vo(h)}r.currentTarget=null,s=l}}}}function Bh(e,t){var n=t[Re];void 0===n&&(n=t[Re]=new Set);var i=e+"__bubble";n.has(i)||(jh(t,e,2,!1),n.add(i))}function Uh(e,t,n){var i=0;t&&(i|=4),jh(n,e,i,t)}var zh="_reactListening"+Math.random().toString(36).slice(2);function Fh(e){if(!e[zh]){e[zh]=!0,qe.forEach((function(t){"selectionchange"!==t&&(Rh.has(t)||Uh(t,!1,e),Uh(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zh]||(t[zh]=!0,Uh("selectionchange",!1,t))}}function jh(e,t,n,i){switch(cd(t)){case 2:var r=id;break;case 8:r=rd;break;default:r=sd}n=r.bind(null,t,n,e),r=void 0,!zt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Vh(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var o=i.stateNode.containerInfo;if(o===r)break;if(4===a)for(a=i.return;null!==a;){var c=a.tag;if((3===c||4===c)&&a.stateNode.containerInfo===r)return;a=a.return}for(;null!==o;){if(null===(a=je(o)))return;if(5===(c=a.tag)||6===c||26===c||27===c){i=s=a;continue e}o=o.parentNode}}i=i.return}kt((function(){var i=s,r=It(n),a=[];e:{var o=wi.get(e);if(void 0!==o){var c=$t,h=e;switch(e){case"keypress":if(0===Gt(n))break e;case"keydown":case"keyup":c=mn;break;case"focusin":h="focus",c=an;break;case"focusout":h="blur",c=an;break;case"beforeblur":case"afterblur":c=an;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=sn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vn;break;case pi:case fi:case mi:c=on;break;case bi:c=yn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=bn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=gn;break;case"toggle":case"beforetoggle":c=wn}var u=0!==(4&t),d=!u&&("scroll"===e||"scrollend"===e),p=u?null!==o?o+"Capture":null:o;u=[];for(var f,m=i;null!==m;){var g=m;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===p||null!=(g=Bt(m,p))&&u.push(Hh(m,g,f)),d)break;m=m.return}0<u.length&&(o=new c(o,h,null,n,r),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===Nt||!(h=n.relatedTarget||n.fromElement)||!je(h)&&!h[Le])&&(c||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=i,null!==(h=(h=n.relatedTarget||n.toElement)?je(h):null)&&(d=l(h),u=h.tag,h!==d||5!==u&&27!==u&&6!==u)&&(h=null)):(c=null,h=i),c!==h)){if(u=rn,g="onMouseLeave",p="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=gn,g="onPointerLeave",p="onPointerEnter",m="pointer"),d=null==c?o:He(c),f=null==h?o:He(h),(o=new u(g,m+"leave",c,n,r)).target=d,o.relatedTarget=f,g=null,je(r)===i&&((u=new u(p,m+"enter",h,n,r)).target=f,u.relatedTarget=d,g=u),d=g,c&&h)e:{for(p=h,m=0,f=u=c;f;f=Gh(f))m++;for(f=0,g=p;g;g=Gh(g))f++;for(;0<m-f;)u=Gh(u),m--;for(;0<f-m;)p=Gh(p),f--;for(;m--;){if(u===p||null!==p&&u===p.alternate)break e;u=Gh(u),p=Gh(p)}u=null}else u=null;null!==c&&qh(a,o,c,u,!1),null!==h&&null!==d&&qh(a,d,h,u,!0)}if("select"===(c=(o=i?He(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var v=Un;else if(On(o))if(zn)v=Yn;else{v=qn;var y=Gn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?i&&_t(i.elementType)&&(v=Un):v=Kn;switch(v&&(v=v(e,i))?Dn(a,v,n,r):(y&&y(e,o,i),"focusout"===e&&i&&"number"===o.type&&null!=i.memoizedProps.value&&yt(o,"number",o.value)),y=i?He(i):window,e){case"focusin":(On(y)||"true"===y.contentEditable)&&(ii=y,ri=i,si=null);break;case"focusout":si=ri=ii=null;break;case"mousedown":ai=!0;break;case"contextmenu":case"mouseup":case"dragend":ai=!1,oi(a,n,r);break;case"selectionchange":if(ni)break;case"keydown":case"keyup":oi(a,n,r)}var b;if(En)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Nn?Pn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Sn&&"ko"!==n.locale&&(Nn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Nn&&(b=Wt()):(Vt="value"in(jt=r)?jt.value:jt.textContent,Nn=!0)),0<(y=Wh(i,w)).length&&(w=new cn(w,e,null,n,r),a.push({event:w,listeners:y}),b?w.data=b:null!==(b=Mn(n))&&(w.data=b))),(b=An?function(e,t){switch(e){case"compositionend":return Mn(t);case"keypress":return 32!==t.which?null:(Tn=!0,_n);case"textInput":return(e=t.data)===_n&&Tn?null:e;default:return null}}(e,n):function(e,t){if(Nn)return"compositionend"===e||!En&&Pn(e,t)?(e=Wt(),Ht=Vt=jt=null,Nn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Sn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=Wh(i,"onBeforeInput")).length&&(y=new cn("onBeforeInput","beforeinput",null,n,r),a.push({event:y,listeners:w}),y.data=b)),function(e,t,n,i,r){if("submit"===t&&n&&n.stateNode===r){var s=Nh((r[De]||null).action),a=i.submitter;a&&null!==(t=(t=a[De]||null)?Nh(t.formAction):a.getAttribute("formAction"))&&(s=t,a=null);var o=new $t("action","action",null,i,r);e.push({event:o,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(0!==xh){var e=a?Ih(r,a):new FormData(r);Na(n,{pending:!0,data:e,method:r.method,action:s},null,e)}}else"function"===typeof s&&(o.preventDefault(),e=a?Ih(r,a):new FormData(r),Na(n,{pending:!0,data:e,method:r.method,action:s},s,e))},currentTarget:r}]})}}(a,e,i,n,r)}kh(a,t)}))}function Hh(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wh(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===s||(null!=(r=Bt(e,n))&&i.unshift(Hh(e,r,s)),null!=(r=Bt(e,t))&&i.push(Hh(e,r,s))),3===e.tag)return i;e=e.return}return[]}function Gh(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function qh(e,t,n,i,r){for(var s=t._reactName,a=[];null!==n&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===i)break;5!==o&&26!==o&&27!==o||null===c||(l=c,r?null!=(c=Bt(n,s))&&a.unshift(Hh(n,c,l)):r||null!=(c=Bt(n,s))&&a.push(Hh(n,c,l))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Kh=/\r\n?/g,Yh=/\u0000|\uFFFD/g;function Qh(e){return("string"===typeof e?e:""+e).replace(Kh,"\n").replace(Yh,"")}function Xh(e,t){return t=Qh(t),Qh(e)===t}function Zh(){}function Jh(e,t,n,i,r,s){switch(n){case"children":"string"===typeof i?"body"===t||"textarea"===t&&""===i||Et(e,i):("number"===typeof i||"bigint"===typeof i)&&"body"!==t&&Et(e,""+i);break;case"className":nt(e,"class",i);break;case"tabIndex":nt(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,i);break;case"style":St(e,i,s);break;case"data":if("object"!==t){nt(e,"data",i);break}case"src":case"href":if(""===i&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==i||"function"===typeof i||"symbol"===typeof i||"boolean"===typeof i){e.removeAttribute(n);break}i=Mt(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if("function"===typeof i){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===n?("input"!==t&&Jh(e,t,"name",r.name,r,null),Jh(e,t,"formEncType",r.formEncType,r,null),Jh(e,t,"formMethod",r.formMethod,r,null),Jh(e,t,"formTarget",r.formTarget,r,null)):(Jh(e,t,"encType",r.encType,r,null),Jh(e,t,"method",r.method,r,null),Jh(e,t,"target",r.target,r,null))),null==i||"symbol"===typeof i||"boolean"===typeof i){e.removeAttribute(n);break}i=Mt(""+i),e.setAttribute(n,i);break;case"onClick":null!=i&&(e.onclick=Zh);break;case"onScroll":null!=i&&Bh("scroll",e);break;case"onScrollEnd":null!=i&&Bh("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!==typeof i||!("__html"in i))throw Error(a(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&"function"!==typeof i&&"symbol"!==typeof i;break;case"muted":e.muted=i&&"function"!==typeof i&&"symbol"!==typeof i;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==i||"function"===typeof i||"boolean"===typeof i||"symbol"===typeof i){e.removeAttribute("xlink:href");break}n=Mt(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===i?e.setAttribute(n,""):!1!==i&&null!=i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":null==i||"function"===typeof i||"symbol"===typeof i||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":Bh("beforetoggle",e),Bh("toggle",e),tt(e,"popover",i);break;case"xlinkActuate":it(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":it(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":it(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":it(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":it(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":it(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":it(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":it(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":it(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":tt(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=Tt.get(n)||n,i)}}function $h(e,t,n,i,r,s){switch(n){case"style":St(e,i,s);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!==typeof i||!("__html"in i))throw Error(a(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"===typeof i?Et(e,i):("number"===typeof i||"bigint"===typeof i)&&Et(e,""+i);break;case"onScroll":null!=i&&Bh("scroll",e);break;case"onScrollEnd":null!=i&&Bh("scrollend",e);break;case"onClick":null!=i&&(e.onclick=Zh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ke.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),"function"===typeof(s=null!=(s=e[De]||null)?s[n]:null)&&e.removeEventListener(t,s,r),"function"!==typeof i)?n in e?e[n]=i:!0===i?e.setAttribute(n,""):tt(e,n,i):("function"!==typeof s&&null!==s&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,r)))}}function eu(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bh("error",e),Bh("load",e);var i,r=!1,s=!1;for(i in n)if(n.hasOwnProperty(i)){var o=n[i];if(null!=o)switch(i){case"src":r=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:Jh(e,t,i,o,n,null)}}return s&&Jh(e,t,"srcSet",n.srcSet,n,null),void(r&&Jh(e,t,"src",n.src,n,null));case"input":Bh("invalid",e);var l=i=o=s=null,c=null,h=null;for(r in n)if(n.hasOwnProperty(r)){var u=n[r];if(null!=u)switch(r){case"name":s=u;break;case"type":o=u;break;case"checked":c=u;break;case"defaultChecked":h=u;break;case"value":i=u;break;case"defaultValue":l=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(a(137,t));break;default:Jh(e,t,r,u,n,null)}}return vt(e,i,l,c,h,o,s,!1),void ut(e);case"select":for(s in Bh("invalid",e),r=o=i=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":i=l;break;case"defaultValue":o=l;break;case"multiple":r=l;default:Jh(e,t,s,l,n,null)}return t=i,n=o,e.multiple=!!r,void(null!=t?bt(e,!!r,t,!1):null!=n&&bt(e,!!r,n,!0));case"textarea":for(o in Bh("invalid",e),i=s=r=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":r=l;break;case"defaultValue":s=l;break;case"children":i=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(a(91));break;default:Jh(e,t,o,l,n,null)}return xt(e,r,s,i),void ut(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(r=n[c]))if("selected"===c)e.selected=r&&"function"!==typeof r&&"symbol"!==typeof r;else Jh(e,t,c,r,n,null);return;case"dialog":Bh("beforetoggle",e),Bh("toggle",e),Bh("cancel",e),Bh("close",e);break;case"iframe":case"object":Bh("load",e);break;case"video":case"audio":for(r=0;r<Lh.length;r++)Bh(Lh[r],e);break;case"image":Bh("error",e),Bh("load",e);break;case"details":Bh("toggle",e);break;case"embed":case"source":case"link":Bh("error",e),Bh("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(h in n)if(n.hasOwnProperty(h)&&null!=(r=n[h]))switch(h){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:Jh(e,t,h,r,n,null)}return;default:if(_t(t)){for(u in n)n.hasOwnProperty(u)&&(void 0!==(r=n[u])&&$h(e,t,u,r,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(r=n[l])&&Jh(e,t,l,r,n,null))}var tu=null,nu=null;function iu(e){return 9===e.nodeType?e:e.ownerDocument}function ru(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function su(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function au(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ou=null;var lu="function"===typeof setTimeout?setTimeout:void 0,cu="function"===typeof clearTimeout?clearTimeout:void 0,hu="function"===typeof Promise?Promise:void 0,uu="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof hu?function(e){return hu.resolve(null).then(e).catch(du)}:lu;function du(e){setTimeout((function(){throw e}))}function pu(e){return"head"===e}function fu(e,t){var n=t,i=0,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0<i&&8>i){n=i;var a=e.ownerDocument;if(1&n&&xu(a.documentElement),2&n&&xu(a.body),4&n)for(xu(n=a.head),a=n.firstChild;a;){var o=a.nextSibling,l=a.nodeName;a[ze]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===a.rel.toLowerCase()||n.removeChild(a),a=o}}if(0===r)return e.removeChild(s),void Td(t);r--}else"$"===n||"$?"===n||"$!"===n?r++:i=n.charCodeAt(0)-48;else i=0;n=s}while(n);Td(t)}function mu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":mu(n),Fe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function gu(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function vu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var yu=null;function bu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function wu(e,t,n){switch(t=iu(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function xu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Fe(e)}var Eu=new Map,Cu=new Set;function Au(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Su=R.d;R.d={f:function(){var e=Su.f(),t=jc();return e||t},r:function(e){var t=Ve(e);null!==t&&5===t.tag&&"form"===t.type?Oa(t):Su.r(e)},D:function(e){Su.D(e),Tu("dns-prefetch",e,null)},C:function(e,t){Su.C(e,t),Tu("preconnect",e,t)},L:function(e,t,n){Su.L(e,t,n);var i=_u;if(i&&e&&t){var r='link[rel="preload"][as="'+mt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(r+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(r+='[imagesizes="'+mt(n.imageSizes)+'"]')):r+='[href="'+mt(e)+'"]';var s=r;switch(t){case"style":s=Mu(e);break;case"script":s=Ou(e)}Eu.has(s)||(e=d({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Eu.set(s,e),null!==i.querySelector(r)||"style"===t&&i.querySelector(Nu(s))||"script"===t&&i.querySelector(Du(s))||(eu(t=i.createElement("link"),"link",e),Ge(t),i.head.appendChild(t)))}},m:function(e,t){Su.m(e,t);var n=_u;if(n&&e){var i=t&&"string"===typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+mt(i)+'"][href="'+mt(e)+'"]',s=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Ou(e)}if(!Eu.has(s)&&(e=d({rel:"modulepreload",href:e},t),Eu.set(s,e),null===n.querySelector(r))){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Du(s)))return}eu(i=n.createElement("link"),"link",e),Ge(i),n.head.appendChild(i)}}},X:function(e,t){Su.X(e,t);var n=_u;if(n&&e){var i=We(n).hoistableScripts,r=Ou(e),s=i.get(r);s||((s=n.querySelector(Du(r)))||(e=d({src:e,async:!0},t),(t=Eu.get(r))&&Bu(e,t),Ge(s=n.createElement("script")),eu(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}},S:function(e,t,n){Su.S(e,t,n);var i=_u;if(i&&e){var r=We(i).hoistableStyles,s=Mu(e);t=t||"default";var a=r.get(s);if(!a){var o={loading:0,preload:null};if(a=i.querySelector(Nu(s)))o.loading=5;else{e=d({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Eu.get(s))&&ku(e,n);var l=a=i.createElement("link");Ge(l),eu(l,"link",e),l._p=new Promise((function(e,t){l.onload=e,l.onerror=t})),l.addEventListener("load",(function(){o.loading|=1})),l.addEventListener("error",(function(){o.loading|=2})),o.loading|=4,Ru(a,t,i)}a={type:"stylesheet",instance:a,count:1,state:o},r.set(s,a)}}},M:function(e,t){Su.M(e,t);var n=_u;if(n&&e){var i=We(n).hoistableScripts,r=Ou(e),s=i.get(r);s||((s=n.querySelector(Du(r)))||(e=d({src:e,async:!0,type:"module"},t),(t=Eu.get(r))&&Bu(e,t),Ge(s=n.createElement("script")),eu(s,"link",e),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}};var _u="undefined"===typeof document?null:document;function Tu(e,t,n){var i=_u;if(i&&"string"===typeof t&&t){var r=mt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"===typeof n&&(r+='[crossorigin="'+n+'"]'),Cu.has(r)||(Cu.add(r),e={rel:e,crossOrigin:n,href:t},null===i.querySelector(r)&&(eu(t=i.createElement("link"),"link",e),Ge(t),i.head.appendChild(t)))}}function Pu(e,t,n,i){var r,s,o,l,c=(c=W.current)?Au(c):null;if(!c)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Mu(n.href),(i=(n=We(c).hoistableStyles).get(t))||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Mu(n.href);var h=We(c).hoistableStyles,u=h.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,u),(h=c.querySelector(Nu(e)))&&!h._p&&(u.instance=h,u.state.loading=5),Eu.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Eu.set(e,n),h||(r=c,s=e,o=n,l=u.state,r.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=r.createElement("link"),l.preload=s,s.addEventListener("load",(function(){return l.loading|=1})),s.addEventListener("error",(function(){return l.loading|=2})),eu(s,"link",o),Ge(s),r.head.appendChild(s))))),t&&null===i)throw Error(a(528,""));return u}if(t&&null!==i)throw Error(a(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Ou(n),(i=(n=We(c).hoistableScripts).get(t))||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Mu(e){return'href="'+mt(e)+'"'}function Nu(e){return'link[rel="stylesheet"]['+e+"]"}function Iu(e){return d({},e,{"data-precedence":e.precedence,precedence:null})}function Ou(e){return'[src="'+mt(e)+'"]'}function Du(e){return"script[async]"+e}function Lu(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(i)return t.instance=i,Ge(i),i;var r=d({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Ge(i=(e.ownerDocument||e).createElement("style")),eu(i,"style",r),Ru(i,n.precedence,e),t.instance=i;case"stylesheet":r=Mu(n.href);var s=e.querySelector(Nu(r));if(s)return t.state.loading|=4,t.instance=s,Ge(s),s;i=Iu(n),(r=Eu.get(r))&&ku(i,r),Ge(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise((function(e,t){o.onload=e,o.onerror=t})),eu(s,"link",i),t.state.loading|=4,Ru(s,n.precedence,e),t.instance=s;case"script":return s=Ou(n.src),(r=e.querySelector(Du(s)))?(t.instance=r,Ge(r),r):(i=n,(r=Eu.get(s))&&Bu(i=d({},n),r),Ge(r=(e=e.ownerDocument||e).createElement("script")),eu(r,"link",i),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(i=t.instance,t.state.loading|=4,Ru(i,n.precedence,e));return t.instance}function Ru(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,s=r,a=0;a<i.length;a++){var o=i[a];if(o.dataset.precedence===t)s=o;else if(s!==r)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function ku(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Bu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Uu=null;function zu(e,t,n){if(null===Uu){var i=new Map,r=Uu=new Map;r.set(n,i)}else(i=(r=Uu).get(n))||(i=new Map,r.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var s=n[r];if(!(s[ze]||s[Oe]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var a=s.getAttribute(t)||"";a=e+a;var o=i.get(a);o?o.push(s):i.set(a,[s])}}return i}function Fu(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function ju(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Vu=null;function Hu(){}function Wu(){if(this.count--,0===this.count)if(this.stylesheets)qu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Gu=null;function qu(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Gu=new Map,t.forEach(Ku,e),Gu=null,Wu.call(e))}function Ku(e,t){if(!(4&t.state.loading)){var n=Gu.get(e);if(n)var i=n.get(null);else{n=new Map,Gu.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<r.length;s++){var a=r[s];"LINK"!==a.nodeName&&"not all"===a.getAttribute("media")||(n.set(a.dataset.precedence,a),i=a)}i&&n.set(null,i)}a=(r=t.instance).getAttribute("data-precedence"),(s=n.get(a)||i)===i&&n.set(null,r),n.set(a,r),this.count++,i=Wu.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),s?s.parentNode.insertBefore(r,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var Yu={$$typeof:x,Provider:null,Consumer:null,_currentValue:k,_currentValue2:k,_threadCount:0};function Qu(e,t,n,i,r,s,a,o){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=s,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Xu(e,t,n,i,r,s,a,o,l,c,h,u){return e=new Qu(e,t,n,a,o,l,c,u),t=1,!0===s&&(t|=24),s=ki(3,null,null,t),e.current=s,s.stateNode=e,(t=Dr()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:i,isDehydrated:n,cache:t},ns(s),e}function Zu(e){return e?e=Li:Li}function Ju(e,t,n,i,r,s){r=Zu(r),null===i.context?i.context=r:i.pendingContext=r,(i=rs(t)).payload={element:n},null!==(s=void 0===s?null:s)&&(i.callback=s),null!==(n=ss(e,i,t))&&(kc(n,0,t),as(n,e,t))}function $u(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ed(e,t){$u(e,t),(e=e.alternate)&&$u(e,t)}function td(e){if(13===e.tag){var t=Ii(e,67108864);null!==t&&kc(t,0,67108864),ed(e,67108864)}}var nd=!0;function id(e,t,n,i){var r=L.T;L.T=null;var s=R.p;try{R.p=2,sd(e,t,n,i)}finally{R.p=s,L.T=r}}function rd(e,t,n,i){var r=L.T;L.T=null;var s=R.p;try{R.p=8,sd(e,t,n,i)}finally{R.p=s,L.T=r}}function sd(e,t,n,i){if(nd){var r=ad(i);if(null===r)Vh(e,t,i,od,n),yd(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return ud=bd(ud,e,t,n,i,r),!0;case"dragenter":return dd=bd(dd,e,t,n,i,r),!0;case"mouseover":return pd=bd(pd,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return fd.set(s,bd(fd.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,md.set(s,bd(md.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(yd(e,i),4&t&&-1<vd.indexOf(e)){for(;null!==r;){var s=Ve(r);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var a=ye(s.pendingLanes);if(0!==a){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var l=1<<31-pe(a);o.entanglements[1]|=l,a&=~l}Eh(s),0===(6&nc)&&(Ec=te()+500,Ch(0,!1))}}break;case 13:null!==(o=Ii(s,2))&&kc(o,0,2),jc(),ed(s,2)}if(null===(s=ad(i))&&Vh(e,t,i,od,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Vh(e,t,i,null,n)}}function ad(e){return ld(e=It(e))}var od=null;function ld(e){if(od=null,null!==(e=je(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return od=e,null}function cd(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case ie:return 2;case re:return 8;case se:case ae:return 32;case oe:return 268435456;default:return 32}default:return 32}}var hd=!1,ud=null,dd=null,pd=null,fd=new Map,md=new Map,gd=[],vd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yd(e,t){switch(e){case"focusin":case"focusout":ud=null;break;case"dragenter":case"dragleave":dd=null;break;case"mouseover":case"mouseout":pd=null;break;case"pointerover":case"pointerout":fd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":md.delete(t.pointerId)}}function bd(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=Ve(t))&&td(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function wd(e){var t=je(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=R.p;try{return R.p=e,t()}finally{R.p=n}}(e.priority,(function(){if(13===n.tag){var e=Lc();e=Pe(e);var t=Ii(n,e);null!==t&&kc(t,0,e),ed(n,e)}}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function xd(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=ad(e.nativeEvent);if(null!==n)return null!==(t=Ve(n))&&td(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);Nt=i,n.target.dispatchEvent(i),Nt=null,t.shift()}return!0}function Ed(e,t,n){xd(e)&&n.delete(t)}function Cd(){hd=!1,null!==ud&&xd(ud)&&(ud=null),null!==dd&&xd(dd)&&(dd=null),null!==pd&&xd(pd)&&(pd=null),fd.forEach(Ed),md.forEach(Ed)}function Ad(e,t){e.blockedOn===t&&(e.blockedOn=null,hd||(hd=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Cd)))}var Sd=null;function _d(e){Sd!==e&&(Sd=e,i.unstable_scheduleCallback(i.unstable_NormalPriority,(function(){Sd===e&&(Sd=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],r=e[t+2];if("function"!==typeof i){if(null===ld(i||n))continue;break}var s=Ve(n);null!==s&&(e.splice(t,3),t-=3,Na(s,{pending:!0,data:r,method:n.method,action:i},i,r))}})))}function Td(e){function t(t){return Ad(t,e)}null!==ud&&Ad(ud,e),null!==dd&&Ad(dd,e),null!==pd&&Ad(pd,e),fd.forEach(t),md.forEach(t);for(var n=0;n<gd.length;n++){var i=gd[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<gd.length&&null===(n=gd[0]).blockedOn;)wd(n),null===n.blockedOn&&gd.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(i=0;i<n.length;i+=3){var r=n[i],s=n[i+1],a=r[De]||null;if("function"===typeof s)a||_d(n);else if(a){var o=null;if(s&&s.hasAttribute("formAction")){if(r=s,a=s[De]||null)o=a.formAction;else if(null!==ld(r))continue}else o=a.action;"function"===typeof o?n[i+1]=o:(n.splice(i,3),i-=3),_d(n)}}}function Pd(e){this._internalRoot=e}function Md(e){this._internalRoot=e}Md.prototype.render=Pd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Ju(t.current,Lc(),e,t,null,null)},Md.prototype.unmount=Pd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Ju(e.current,2,null,e,null,null),jc(),t[Le]=null}},Md.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ne();e={blockedOn:null,target:e,priority:t};for(var n=0;n<gd.length&&0!==t&&t<gd[n].priority;n++);gd.splice(n,0,e),0===n&&wd(e)}};var Nd=r.version;if("19.1.0"!==Nd)throw Error(a(527,Nd,"19.1.0"));R.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return h(r),e;if(s===i)return h(r),t;s=s.sibling}throw Error(a(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,c=r.child;c;){if(c===n){o=!0,n=r,i=s;break}if(c===i){o=!0,i=r,n=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===n){o=!0,n=s,i=r;break}if(c===i){o=!0,i=s,n=r;break}c=c.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?u(e):null)?null:e.stateNode};var Id={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Od=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Od.isDisabled&&Od.supportsFiber)try{he=Od.inject(Id),ue=Od}catch(Ld){}}t.createRoot=function(e,t){if(!o(e))throw Error(a(299));var n=!1,i="",r=yo,s=bo,l=wo;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(r=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Xu(e,1,!1,null,0,n,i,r,s,l,0,null),e[Le]=t.current,Fh(e),new Pd(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(a(299));var i=!1,r="",s=yo,l=bo,c=wo,h=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(h=n.formState)),(t=Xu(e,1,!0,t,0,i,r,s,l,c,0,h)).context=Zu(null),n=t.current,(r=rs(i=Pe(i=Lc()))).callback=null,ss(n,r,i),n=i,t.current.lanes=n,Se(t,n),Eh(t),e[Le]=t.current,Fh(e),new Md(t)},t.version="19.1.0"},97950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(46672)},97965:(e,t,n)=>{"use strict";n.d(t,{EB:()=>w,Iy:()=>l,Iz:()=>y,MR:()=>b,Nc:()=>h,O:()=>c,Wq:()=>m,YE:()=>d,YF:()=>o,YW:()=>a,ZP:()=>p,_z:()=>g,d_:()=>T,dm:()=>_,fo:()=>E,gH:()=>u,j:()=>S,kE:()=>v,l3:()=>C,nK:()=>A,nM:()=>x,yy:()=>f});var i=n(59052),r=n(22017),s=n(21627);class a extends s.C{constructor(e){let{docsPath:t}=e;super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join("\n"),{docsPath:t,name:"AbiConstructorNotFoundError"})}}class o extends s.C{constructor(e){let{docsPath:t}=e;super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join("\n"),{docsPath:t,name:"AbiConstructorParamsNotFoundError"})}}s.C;class l extends s.C{constructor(e){let{data:t,params:n,size:r}=e;super([`Data size of ${r} bytes is too small for given parameters.`].join("\n"),{metaMessages:[`Params: (${(0,i.A)(n,{includeName:!0})})`,`Data:   ${t} (${r} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t,this.params=n,this.size=r}}class c extends s.C{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}}class h extends s.C{constructor(e){let{expectedLength:t,givenLength:n,type:i}=e;super([`ABI encoding array length mismatch for type ${i}.`,`Expected length: ${t}`,`Given length: ${n}`].join("\n"),{name:"AbiEncodingArrayLengthMismatchError"})}}class u extends s.C{constructor(e){let{expectedSize:t,value:n}=e;super(`Size of bytes "${n}" (bytes${(0,r.E)(n)}) does not match expected size (bytes${t}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class d extends s.C{constructor(e){let{expectedLength:t,givenLength:n}=e;super(["ABI encoding params/values length mismatch.",`Expected length (params): ${t}`,`Given length (values): ${n}`].join("\n"),{name:"AbiEncodingLengthMismatchError"})}}class p extends s.C{constructor(e,t){let{docsPath:n}=t;super([`Arguments (\`args\`) were provided to "${e}", but "${e}" on the ABI does not contain any parameters (\`inputs\`).`,"Cannot encode error result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the inputs exist on it."].join("\n"),{docsPath:n,name:"AbiErrorInputsNotFoundError"})}}class f extends s.C{constructor(e){let{docsPath:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super([`Error ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it."].join("\n"),{docsPath:t,name:"AbiErrorNotFoundError"})}}class m extends s.C{constructor(e,t){let{docsPath:n}=t;super([`Encoded error signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${e}.`].join("\n"),{docsPath:n,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=e}}class g extends s.C{constructor(e){let{docsPath:t}=e;super("Cannot extract event signature from empty topics.",{docsPath:t,name:"AbiEventSignatureEmptyTopicsError"})}}class v extends s.C{constructor(e,t){let{docsPath:n}=t;super([`Encoded event signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join("\n"),{docsPath:n,name:"AbiEventSignatureNotFoundError"})}}s.C;class y extends s.C{constructor(e){let{docsPath:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super([`Function ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join("\n"),{docsPath:t,name:"AbiFunctionNotFoundError"})}}class b extends s.C{constructor(e,t){let{docsPath:n}=t;super([`Function "${e}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join("\n"),{docsPath:n,name:"AbiFunctionOutputsNotFoundError"})}}class w extends s.C{constructor(e,t){let{docsPath:n}=t;super([`Encoded function signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join("\n"),{docsPath:n,name:"AbiFunctionSignatureNotFoundError"})}}class x extends s.C{constructor(e,t){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${e.type}\` in \`${(0,i.B)(e.abiItem)}\`, and`,`\`${t.type}\` in \`${(0,i.B)(t.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}s.C;class E extends s.C{constructor(e){let{abiItem:t,data:n,params:r,size:s}=e;super([`Data size of ${s} bytes is too small for non-indexed event parameters.`].join("\n"),{metaMessages:[`Params: (${(0,i.A)(r,{includeName:!0})})`,`Data:   ${n} (${s} bytes)`],name:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=t,this.data=n,this.params=r,this.size=s}}class C extends s.C{constructor(e){let{abiItem:t,param:n}=e;super([`Expected a topic for indexed event parameter${n.name?` "${n.name}"`:""} on event "${(0,i.B)(t,{includeName:!0})}".`].join("\n"),{name:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=t}}class A extends s.C{constructor(e,t){let{docsPath:n}=t;super([`Type "${e}" is not a valid encoding type.`,"Please provide a valid ABI type."].join("\n"),{docsPath:n,name:"InvalidAbiEncodingType"})}}class S extends s.C{constructor(e,t){let{docsPath:n}=t;super([`Type "${e}" is not a valid decoding type.`,"Please provide a valid ABI type."].join("\n"),{docsPath:n,name:"InvalidAbiDecodingType"})}}class _ extends s.C{constructor(e){super([`Value "${e}" is not a valid array.`].join("\n"),{name:"InvalidArrayError"})}}class T extends s.C{constructor(e){super([`"${e}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join("\n"),{name:"InvalidDefinitionTypeError"})}}s.C},98677:(e,t,n)=>{"use strict";function i(e){return e}n.d(t,{U:()=>i})},99251:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});var i=n(32819);const r={getCaipTokens(e){if(!e)return;const t={};return Object.entries(e).forEach((e=>{let[n,r]=e;t[`${i.o.EIP155}:${n}`]=r})),t},isLowerCaseMatch:(e,t)=>e?.toLowerCase()===t?.toLowerCase()}},99577:(e,t,n)=>{"use strict";n.d(t,{B4:()=>r,SK:()=>s,hX:()=>a});var i=n(21627);class r extends i.C{constructor(e){let{offset:t}=e;super(`Offset \`${t}\` cannot be negative.`,{name:"NegativeOffsetError"})}}class s extends i.C{constructor(e){let{length:t,position:n}=e;super(`Position \`${n}\` is out of bounds (\`0 < position < ${t}\`).`,{name:"PositionOutOfBoundsError"})}}class a extends i.C{constructor(e){let{count:t,limit:n}=e;super(`Recursive read limit of \`${n}\` exceeded (recursive read count: \`${t}\`).`,{name:"RecursiveReadLimitExceededError"})}}},99632:(e,t,n)=>{"use strict";n.d(t,{L:()=>i});const i={caipNetworkIdToNumber:e=>e?Number(e.split(":")[1]):void 0,parseEvmChainId(e){return"string"===typeof e?this.caipNetworkIdToNumber(e):e},getNetworksByNamespace:(e,t)=>e?.filter((e=>e.chainNamespace===t))||[],getFirstNetworkByNamespace(e,t){return this.getNetworksByNamespace(e,t)[0]}}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var s=Object.create(null);n.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&r&&i;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>a[e]=()=>i[e]));return a.default=()=>i,n.d(s,a),s}})(),n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,i)=>(n.f[i](e,t),t)),[])),n.u=e=>"static/js/"+e+"."+{7:"15a71fe9",88:"c9bf0dd4",101:"8f716e05",374:"513f7f1a",395:"f0bdcbda",483:"aa5f67bf",526:"719e5276",752:"7632532a",792:"8344c967",900:"ab704d08",917:"597d92e6",1117:"969bcbda",1131:"1111a550",1150:"04a355c0",1160:"ea6e53ed",1191:"ff1d949f",1208:"bc40ed93",1250:"23cd0866",1284:"133887be",1487:"dc3dbcd9",1519:"5402ce95",1520:"56263f5b",1525:"1affaa0a",1542:"13d87a51",1599:"832d47e4",1854:"efcc7efe",1925:"877d6984",2011:"8e1470bf",2415:"3f57e95d",2416:"3406829d",2456:"699b7c65",2463:"e49c515e",2784:"2da1dd92",2821:"0ef74ea8",2926:"775a7050",3005:"45ce469b",3137:"f9666d52",3293:"8f313cbf",3430:"10f9cf53",3448:"4716e84a",3516:"33732b3b",3596:"3aa4e099",3656:"d62b2484",3697:"cfed4c44",4004:"6456ee6c",4093:"97e16ec8",4246:"6a7cbcf1",4310:"2e4c4f37",4500:"1ceec483",4625:"52731f95",4661:"f72e7d96",4682:"7399e6e5",4708:"7a006547",4780:"499114df",4865:"187f3333",4931:"1231e0bf",5010:"bef2f1ac",5023:"93329e54",5024:"c8c89d0a",5311:"3f4d3828",5333:"9a2816b6",5465:"ba8f03b5",5519:"08d39adc",5596:"63a74e6c",5656:"7c938534",5710:"ba9426f2",5911:"27c96b9f",5938:"07ba931a",6003:"b8c7b32e",6118:"5b2c52de",6243:"d3bf181e",6426:"a59bf5e6",6453:"de2c0eb8",6495:"1acabe7d",6549:"edd507b5",6629:"0e46e4be",6749:"a8ad5589",6867:"eb0a6472",6970:"fbf99a19",7055:"f0fc2d7c",7069:"6d90eb51",7134:"e21b9b7e",7209:"9cc40688",7217:"c6e4a2b9",7293:"8696ff0e",7556:"077a291d",7610:"df5c8004",7654:"608e4bd2",7751:"e4a910e5",7942:"e2274264",8007:"97bc871e",8126:"13c7c179",8417:"0e193adf",8471:"ca672588",8486:"9a226afd",8606:"7cdf8fb5",8817:"461c9c8b",8926:"17ed5e2e",8946:"93b278a8",9053:"ca282559",9075:"f2cc4f7d",9190:"4c1c1416",9197:"99722594",9252:"ccb734fc",9466:"9828a621",9539:"d82b2156",9729:"59e2e41a",9867:"d957bf2c"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="onewave:";n.l=(i,r,s,a)=>{if(e[i])e[i].push(r);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),h=0;h<c.length;h++){var u=c[h];if(u.getAttribute("src")==i||u.getAttribute("data-webpack")==t+s){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=i),e[i]=[r];var d=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var r=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((e=>e(n))),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/build/",(()=>{var e={8792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var s=new Promise(((n,i)=>r=e[t]=[n,i]));i.push(r[2]=s);var a=n.p+n.u(t),o=new Error;n.l(a,(i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,r[1](o)}}),"chunk-"+t,t)}};var t=(t,i)=>{var r,s,a=i[0],o=i[1],l=i[2],c=0;if(a.some((t=>0!==e[t]))){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(t&&t(i);c<a.length;c++)s=a[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},i=self.webpackChunkonewave=self.webpackChunkonewave||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e,t=n(65043),i=n.t(t,2),r=n(84391),s=n(97950),a=n.t(s,2);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));const l="popstate";function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(yw){}}}function u(e,t){return{usr:e.state,key:e.key,idx:t}}function d(e,t,n,i){return void 0===n&&(n=null),o({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?f(t):t,{state:n,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function p(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function f(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function m(t,n,i,r){void 0===r&&(r={});let{window:s=document.defaultView,v5Compat:a=!1}=r,h=s.history,f=e.Pop,m=null,g=v();function v(){return(h.state||{idx:null}).idx}function y(){f=e.Pop;let t=v(),n=null==t?null:t-g;g=t,m&&m({action:f,location:w.location,delta:n})}function b(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:p(e);return n=n.replace(/ $/,"%20"),c(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,h.replaceState(o({},h.state,{idx:g}),""));let w={get action(){return f},get location(){return t(s,h)},listen(e){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(l,y),m=e,()=>{s.removeEventListener(l,y),m=null}},createHref:e=>n(s,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,n){f=e.Push;let r=d(w.location,t,n);i&&i(r,t),g=v()+1;let o=u(r,g),l=w.createHref(r);try{h.pushState(o,"",l)}catch(c){if(c instanceof DOMException&&"DataCloneError"===c.name)throw c;s.location.assign(l)}a&&m&&m({action:f,location:w.location,delta:1})},replace:function(t,n){f=e.Replace;let r=d(w.location,t,n);i&&i(r,t),g=v();let s=u(r,g),o=w.createHref(r);h.replaceState(s,"",o),a&&m&&m({action:f,location:w.location,delta:0})},go:e=>h.go(e)};return w}var g;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function v(e,t,n){return void 0===n&&(n="/"),y(e,t,n,!1)}function y(e,t,n,i){let r=O(("string"===typeof t?f(t):t).pathname||"/",n);if(null==r)return null;let s=b(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let e=I(r);a=M(s[o],e,i)}return a}function b(e,t,n,i){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===i&&(i="");let r=(e,r,s)=>{let a={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};a.relativePath.startsWith("/")&&(c(a.relativePath.startsWith(i),'Absolute route path "'+a.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(i.length));let o=B([i,a.relativePath]),l=n.concat(a);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),b(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:P(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let i of w(e.path))r(e,t,i);else r(e,t)})),t}function w(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let a=w(i.join("/")),o=[];return o.push(...a.map((e=>""===e?s:[s,e].join("/")))),r&&o.push(...a),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const x=/^:[\w-]+$/,E=3,C=2,A=1,S=10,_=-2,T=e=>"*"===e;function P(e,t){let n=e.split("/"),i=n.length;return n.some(T)&&(i+=_),t&&(i+=C),n.filter((e=>!T(e))).reduce(((e,t)=>e+(x.test(t)?E:""===t?A:S)),i)}function M(e,t,n){void 0===n&&(n=!1);let{routesMeta:i}=e,r={},s="/",a=[];for(let o=0;o<i.length;++o){let e=i[o],l=o===i.length-1,c="/"===s?t:t.slice(s.length)||"/",h=N({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!h&&l&&n&&!i[i.length-1].route.index&&(h=N({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!h)return null;Object.assign(r,h.params),a.push({params:r,pathname:B([s,h.pathname]),pathnameBase:U(B([s,h.pathnameBase])),route:u}),"/"!==h.pathnameBase&&(s=B([s,h.pathnameBase]))}return a}function N(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let s=new RegExp(r,t?void 0:"i");return[s,i]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1),l=i.reduce(((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=o[n]||"";a=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[i]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:s,pathnameBase:a,pattern:e}}function I(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function O(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}function D(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function L(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function R(e,t){let n=L(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function k(e,t,n,i){let r;void 0===i&&(i=!1),"string"===typeof e?r=f(e):(r=o({},e),c(!r.pathname||!r.pathname.includes("?"),D("?","pathname","search",r)),c(!r.pathname||!r.pathname.includes("#"),D("#","pathname","hash",r)),c(!r.search||!r.search.includes("#"),D("#","search","hash",r)));let s,a=""===e||""===r.pathname,l=a?"/":r.pathname;if(null==l)s=n;else{let e=t.length-1;if(!i&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let h=function(e,t){void 0===t&&(t="/");let{pathname:n,search:i="",hash:r=""}="string"===typeof e?f(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:z(i),hash:F(r)}}(r,s),u=l&&"/"!==l&&l.endsWith("/"),d=(a||"."===l)&&n.endsWith("/");return h.pathname.endsWith("/")||!u&&!d||(h.pathname+="/"),h}const B=e=>e.join("/").replace(/\/\/+/g,"/"),U=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),z=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",F=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function j(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const V=["post","put","patch","delete"],H=(new Set(V),["get",...V]);new Set(H),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},W.apply(this,arguments)}const G=t.createContext(null);const q=t.createContext(null);const K=t.createContext(null);const Y=t.createContext(null);const Q=t.createContext({outlet:null,matches:[],isDataRoute:!1});const X=t.createContext(null);function Z(){return null!=t.useContext(Y)}function J(){return Z()||c(!1),t.useContext(Y).location}function $(e){t.useContext(K).static||t.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=t.useContext(Q);return e?function(){let{router:e}=he(le.UseNavigateStable),n=de(ce.UseNavigateStable),i=t.useRef(!1);$((()=>{i.current=!0}));let r=t.useCallback((function(t,r){void 0===r&&(r={}),i.current&&("number"===typeof t?e.navigate(t):e.navigate(t,W({fromRouteId:n},r)))}),[e,n]);return r}():function(){Z()||c(!1);let e=t.useContext(G),{basename:n,future:i,navigator:r}=t.useContext(K),{matches:s}=t.useContext(Q),{pathname:a}=J(),o=JSON.stringify(R(s,i.v7_relativeSplatPath)),l=t.useRef(!1);$((()=>{l.current=!0}));let h=t.useCallback((function(t,i){if(void 0===i&&(i={}),!l.current)return;if("number"===typeof t)return void r.go(t);let s=k(t,JSON.parse(o),a,"path"===i.relative);null==e&&"/"!==n&&(s.pathname="/"===s.pathname?n:B([n,s.pathname])),(i.replace?r.replace:r.push)(s,i.state,i)}),[n,r,o,a,e]);return h}()}function te(e,n){let{relative:i}=void 0===n?{}:n,{future:r}=t.useContext(K),{matches:s}=t.useContext(Q),{pathname:a}=J(),o=JSON.stringify(R(s,r.v7_relativeSplatPath));return t.useMemo((()=>k(e,JSON.parse(o),a,"path"===i)),[e,o,a,i])}function ne(n,i,r,s){Z()||c(!1);let{navigator:a,static:o}=t.useContext(K),{matches:l}=t.useContext(Q),h=l[l.length-1],u=h?h.params:{},d=(h&&h.pathname,h?h.pathnameBase:"/");h&&h.route;let p,m=J();if(i){var g;let e="string"===typeof i?f(i):i;"/"===d||(null==(g=e.pathname)?void 0:g.startsWith(d))||c(!1),p=e}else p=m;let y=p.pathname||"/",b=y;if("/"!==d){let e=d.replace(/^\//,"").split("/");b="/"+y.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=!o&&r&&r.matches&&r.matches.length>0?r.matches:v(n,{pathname:b});let x=oe(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:B([d,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:B([d,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,r,s);return i&&x?t.createElement(Y.Provider,{value:{location:W({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:e.Pop}},x):x}function ie(){let e=function(){var e;let n=t.useContext(X),i=ue(ce.UseRouteError),r=de(ce.UseRouteError);if(void 0!==n)return n;return null==(e=i.errors)?void 0:e[r]}(),n=j(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),i?t.createElement("pre",{style:s},i):null,null)}const re=t.createElement(ie,null);class se extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(Q.Provider,{value:this.props.routeContext},t.createElement(X.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ae(e){let{routeContext:n,match:i,children:r}=e,s=t.useContext(G);return s&&s.static&&s.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=i.route.id),t.createElement(Q.Provider,{value:n},r)}function oe(e,n,i,r){var s;if(void 0===n&&(n=[]),void 0===i&&(i=null),void 0===r&&(r=null),null==e){var a;if(!i)return null;if(i.errors)e=i.matches;else{if(!(null!=(a=r)&&a.v7_partialHydration&&0===n.length&&!i.initialized&&i.matches.length>0))return null;e=i.matches}}let o=e,l=null==(s=i)?void 0:s.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||c(!1),o=o.slice(0,Math.min(o.length,e+1))}let h=!1,u=-1;if(i&&r&&r.v7_partialHydration)for(let t=0;t<o.length;t++){let e=o[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=t),e.route.id){let{loaderData:t,errors:n}=i,r=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||r){h=!0,o=u>=0?o.slice(0,u+1):[o[0]];break}}}return o.reduceRight(((e,r,s)=>{let a,c=!1,d=null,p=null;var f;i&&(a=l&&r.route.id?l[r.route.id]:void 0,d=r.route.errorElement||re,h&&(u<0&&0===s?(f="route-fallback",!1||pe[f]||(pe[f]=!0),c=!0,p=null):u===s&&(c=!0,p=r.route.hydrateFallbackElement||null)));let m=n.concat(o.slice(0,s+1)),g=()=>{let n;return n=a?d:c?p:r.route.Component?t.createElement(r.route.Component,null):r.route.element?r.route.element:e,t.createElement(ae,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=i},children:n})};return i&&(r.route.ErrorBoundary||r.route.errorElement||0===s)?t.createElement(se,{location:i.location,revalidation:i.revalidation,component:d,error:a,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var le=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(le||{}),ce=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ce||{});function he(e){let n=t.useContext(G);return n||c(!1),n}function ue(e){let n=t.useContext(q);return n||c(!1),n}function de(e){let n=function(){let e=t.useContext(Q);return e||c(!1),e}(),i=n.matches[n.matches.length-1];return i.route.id||c(!1),i.route.id}const pe={};function fe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}i.startTransition;function me(e){c(!1)}function ge(n){let{basename:i="/",children:r=null,location:s,navigationType:a=e.Pop,navigator:o,static:l=!1,future:h}=n;Z()&&c(!1);let u=i.replace(/^\/*/,"/"),d=t.useMemo((()=>({basename:u,navigator:o,static:l,future:W({v7_relativeSplatPath:!1},h)})),[u,h,o,l]);"string"===typeof s&&(s=f(s));let{pathname:p="/",search:m="",hash:g="",state:v=null,key:y="default"}=s,b=t.useMemo((()=>{let e=O(p,u);return null==e?null:{location:{pathname:e,search:m,hash:g,state:v,key:y},navigationType:a}}),[u,p,m,g,v,y,a]);return null==b?null:t.createElement(K.Provider,{value:d},t.createElement(Y.Provider,{children:r,value:b}))}function ve(e){let{children:t,location:n}=e;return ne(ye(t),n)}new Promise((()=>{}));t.Component;function ye(e,n){void 0===n&&(n=[]);let i=[];return t.Children.forEach(e,((e,r)=>{if(!t.isValidElement(e))return;let s=[...n,r];if(e.type===t.Fragment)return void i.push.apply(i,ye(e.props.children,s));e.type!==me&&c(!1),e.props.index&&e.props.children&&c(!1);let a={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=ye(e.props.children,s)),i.push(a)})),i}function be(){return be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},be.apply(this,arguments)}function we(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const xe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(yw){}new Map;const Ee=i.startTransition;a.flushSync,i.useId;function Ce(e){let{basename:n,children:i,future:r,window:s}=e,a=t.useRef();var o;null==a.current&&(a.current=(void 0===(o={window:s,v5Compat:!0})&&(o={}),m((function(e,t){let{pathname:n,search:i,hash:r}=e.location;return d("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:p(t)}),null,o)));let l=a.current,[c,h]=t.useState({action:l.action,location:l.location}),{v7_startTransition:u}=r||{},f=t.useCallback((e=>{u&&Ee?Ee((()=>h(e))):h(e)}),[h,u]);return t.useLayoutEffect((()=>l.listen(f)),[l,f]),t.useEffect((()=>fe(r)),[r]),t.createElement(ge,{basename:n,children:i,location:c.location,navigationType:c.action,navigator:l,future:r})}const Ae="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Se=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_e=t.forwardRef((function(e,n){let i,{onClick:r,relative:s,reloadDocument:a,replace:o,state:l,target:h,to:u,preventScrollReset:d,viewTransition:f}=e,m=we(e,xe),{basename:g}=t.useContext(K),v=!1;if("string"===typeof u&&Se.test(u)&&(i=u,Ae))try{let e=new URL(window.location.href),t=u.startsWith("//")?new URL(e.protocol+u):new URL(u),n=O(t.pathname,g);t.origin===e.origin&&null!=n?u=n+t.search+t.hash:v=!0}catch(yw){}let y=function(e,n){let{relative:i}=void 0===n?{}:n;Z()||c(!1);let{basename:r,navigator:s}=t.useContext(K),{hash:a,pathname:o,search:l}=te(e,{relative:i}),h=o;return"/"!==r&&(h="/"===o?r:B([r,o])),s.createHref({pathname:h,search:l,hash:a})}(u,{relative:s}),b=function(e,n){let{target:i,replace:r,state:s,preventScrollReset:a,relative:o,viewTransition:l}=void 0===n?{}:n,c=ee(),h=J(),u=te(e,{relative:o});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,i)){t.preventDefault();let n=void 0!==r?r:p(h)===p(u);c(e,{replace:n,state:s,preventScrollReset:a,relative:o,viewTransition:l})}}),[h,c,u,r,s,i,e,a,o,l])}(u,{replace:o,state:l,target:h,preventScrollReset:d,relative:s,viewTransition:f});return t.createElement("a",be({},m,{href:i||y,onClick:v||a?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:n,target:h}))}));var Te,Pe;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Te||(Te={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Pe||(Pe={}));n(74807);function Me(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=Me(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}const Ne=function(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=Me(e))&&(i&&(i+=" "),i+=t);return i};!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}(':root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n');var Ie=e=>"number"==typeof e&&!isNaN(e),Oe=e=>"string"==typeof e,De=e=>"function"==typeof e,Le=e=>Oe(e)||De(e)?e:null,Re=(e,t)=>!1===e||Ie(e)&&e>0?e:t,ke=e=>(0,t.isValidElement)(e)||Oe(e)||De(e)||Ie(e);function Be(e){let{enter:n,exit:i,appendPosition:r=!1,collapse:s=!0,collapseDuration:a=300}=e;return function(e){let{children:o,position:l,preventExitTransition:c,done:h,nodeRef:u,isIn:d,playToast:p}=e,f=r?`${n}--${l}`:n,m=r?`${i}--${l}`:i,g=(0,t.useRef)(0);return(0,t.useLayoutEffect)((()=>{let e=u.current,t=f.split(" "),n=i=>{i.target===u.current&&(p(),e.removeEventListener("animationend",n),e.removeEventListener("animationcancel",n),0===g.current&&"animationcancel"!==i.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",n),e.addEventListener("animationcancel",n)}),[]),(0,t.useEffect)((()=>{let e=u.current,t=()=>{e.removeEventListener("animationend",t),s?function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,{scrollHeight:i,style:r}=e;requestAnimationFrame((()=>{r.minHeight="initial",r.height=i+"px",r.transition=`all ${n}ms`,requestAnimationFrame((()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(t,n)}))}))}(e,h,a):h()};d||(c?t():(g.current=1,e.className+=` ${m}`,e.addEventListener("animationend",t)))}),[d]),t.createElement(t.Fragment,null,o)}}function Ue(e,t){return{content:ze(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function ze(e,n){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,t.isValidElement)(e)&&!Oe(e.type)?(0,t.cloneElement)(e,{closeToast:n.closeToast,toastProps:n,data:n.data,isPaused:i}):De(e)?e({closeToast:n.closeToast,toastProps:n,data:n.data,isPaused:i}):e}function Fe(e){let{delay:n,isRunning:i,closeToast:r,type:s="default",hide:a,className:o,controlledProgress:l,progress:c,rtl:h,isIn:u,theme:d}=e,p=a||l&&0===c,f={animationDuration:`${n}ms`,animationPlayState:i?"running":"paused"};l&&(f.transform=`scaleX(${c})`);let m=Ne("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":h}),g=De(o)?o({rtl:h,type:s,defaultClassName:m}):Ne(m,o),v={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{u&&r()}};return t.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":p},t.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${d} Toastify__progress-bar--${s}`}),t.createElement("div",{role:"progressbar","aria-hidden":p?"true":"false","aria-label":"notification timer",className:g,style:f,...v}))}var je=1,Ve=()=>""+je++;function He(e,t,n){let i=1,r=0,s=[],a=[],o=t,l=new Map,c=new Set,h=()=>{a=Array.from(l.values()),c.forEach((e=>e()))},u=e=>{var t,n;null==(n=null==(t=e.props)?void 0:t.onClose)||n.call(t,e.removalReason),e.isActive=!1},d=e=>{if(null==e)l.forEach(u);else{let t=l.get(e);t&&u(t)}h()},p=e=>{var t,i;let{toastId:r,updateId:s}=e.props,a=null==s;e.staleId&&l.delete(e.staleId),e.isActive=!0,l.set(r,e),h(),n(Ue(e,a?"added":"updated")),a&&(null==(i=(t=e.props).onOpen)||i.call(t))};return{id:e,props:o,observe:e=>(c.add(e),()=>c.delete(e)),toggle:(e,t)=>{l.forEach((n=>{var i;(null==t||t===n.props.toastId)&&(null==(i=n.toggle)||i.call(n,e))}))},removeToast:d,toasts:l,clearQueue:()=>{r-=s.length,s=[]},buildToast:(t,a)=>{if((t=>{let{containerId:n,toastId:i,updateId:r}=t,s=n?n!==e:1!==e,a=l.has(i)&&null==r;return s||a})(a))return;let{toastId:c,updateId:u,data:f,staleId:m,delay:g}=a,v=null==u;v&&r++;let y={...o,style:o.toastStyle,key:i++,...Object.fromEntries(Object.entries(a).filter((e=>{let[t,n]=e;return null!=n}))),toastId:c,updateId:u,data:f,isIn:!1,className:Le(a.className||o.toastClassName),progressClassName:Le(a.progressClassName||o.progressClassName),autoClose:!a.isLoading&&Re(a.autoClose,o.autoClose),closeToast(e){l.get(c).removalReason=e,d(c)},deleteToast(){let e=l.get(c);if(null!=e){if(n(Ue(e,"removed")),l.delete(c),r--,r<0&&(r=0),s.length>0)return void p(s.shift());h()}}};y.closeButton=o.closeButton,!1===a.closeButton||ke(a.closeButton)?y.closeButton=a.closeButton:!0===a.closeButton&&(y.closeButton=!ke(o.closeButton)||o.closeButton);let b={content:t,props:y,staleId:m};o.limit&&o.limit>0&&r>o.limit&&v?s.push(b):Ie(g)?setTimeout((()=>{p(b)}),g):p(b)},setProps(e){o=e},setToggle:(e,t)=>{let n=l.get(e);n&&(n.toggle=t)},isToastActive:e=>{var t;return null==(t=l.get(e))?void 0:t.isActive},getSnapshot:()=>a}}var We=new Map,Ge=[],qe=new Set,Ke=e=>qe.forEach((t=>t(e))),Ye=()=>We.size>0;function Qe(e,t){var n;if(t)return!(null==(n=We.get(t))||!n.isToastActive(e));let i=!1;return We.forEach((t=>{t.isToastActive(e)&&(i=!0)})),i}function Xe(e){if(Ye()){if(null==e||(e=>Oe(e)||Ie(e))(e))We.forEach((t=>{t.removeToast(e)}));else if(e&&("containerId"in e||"id"in e)){let t=We.get(e.containerId);t?t.removeToast(e.id):We.forEach((t=>{t.removeToast(e.id)}))}}else Ge=Ge.filter((t=>null!=e&&t.options.toastId!==e))}function Ze(e,t){ke(e)&&(Ye()||Ge.push({content:e,options:t}),We.forEach((n=>{n.buildToast(e,t)})))}function Je(e,t){We.forEach((n=>{(null==t||null==t||!t.containerId||(null==t?void 0:t.containerId)===n.id)&&n.toggle(e,null==t?void 0:t.id)}))}function $e(e){let t=e.containerId||1;return{subscribe(n){let i=He(t,e,Ke);We.set(t,i);let r=i.observe(n);return Ge.forEach((e=>Ze(e.content,e.options))),Ge=[],()=>{r(),We.delete(t)}},setProps(e){var n;null==(n=We.get(t))||n.setProps(e)},getSnapshot(){var e;return null==(e=We.get(t))?void 0:e.getSnapshot()}}}function et(e){return e&&(Oe(e.toastId)||Ie(e.toastId))?e.toastId:Ve()}function tt(e,t){return Ze(e,t),t.toastId}function nt(e,t){return{...t,type:t&&t.type||e,toastId:et(t)}}function it(e){return(t,n)=>tt(t,nt(e,n))}function rt(e,t){return tt(e,nt("default",t))}function st(e){let[n,i]=(0,t.useState)(!1),[r,s]=(0,t.useState)(!1),a=(0,t.useRef)(null),o=(0,t.useRef)({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:h,onClick:u,closeOnClick:d}=e;function p(){i(!0)}function f(){i(!1)}function m(t){let i=a.current;if(o.canDrag&&i){o.didMove=!0,n&&f(),"x"===e.draggableDirection?o.delta=t.clientX-o.start:o.delta=t.clientY-o.start,o.start!==t.clientX&&(o.canCloseOnClick=!1);let r="x"===e.draggableDirection?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;i.style.transform=`translate3d(${r},0)`,i.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance))}}function g(){document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",g);let t=a.current;if(o.canDrag&&o.didMove&&t){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return s(!0),e.closeToast(!0),void e.collapseAll();t.style.transition="transform 0.2s, opacity 0.2s",t.style.removeProperty("transform"),t.style.removeProperty("opacity")}}(function(e){var t;null==(t=We.get(e.containerId||1))||t.setToggle(e.id,e.fn)})({id:e.toastId,containerId:e.containerId,fn:i}),(0,t.useEffect)((()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||f(),window.addEventListener("focus",p),window.addEventListener("blur",f),()=>{window.removeEventListener("focus",p),window.removeEventListener("blur",f)}}),[e.pauseOnFocusLoss]);let v={onPointerDown:function(t){if(!0===e.draggable||e.draggable===t.pointerType){o.didMove=!1,document.addEventListener("pointermove",m),document.addEventListener("pointerup",g);let n=a.current;o.canCloseOnClick=!0,o.canDrag=!0,n.style.transition="none","x"===e.draggableDirection?(o.start=t.clientX,o.removalDistance=n.offsetWidth*(e.draggablePercent/100)):(o.start=t.clientY,o.removalDistance=n.offsetHeight*(80===e.draggablePercent?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(t){let{top:n,bottom:i,left:r,right:s}=a.current.getBoundingClientRect();"touchend"!==t.nativeEvent.type&&e.pauseOnHover&&t.clientX>=r&&t.clientX<=s&&t.clientY>=n&&t.clientY<=i?f():p()}};return l&&c&&(v.onMouseEnter=f,e.stacked||(v.onMouseLeave=p)),d&&(v.onClick=e=>{u&&u(e),o.canCloseOnClick&&h(!0)}),{playToast:p,pauseToast:f,isRunning:n,preventExitTransition:r,toastRef:a,eventHandlers:v}}rt.loading=(e,t)=>tt(e,nt("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),rt.promise=function(e,t,n){let i,{pending:r,error:s,success:a}=t;r&&(i=Oe(r)?rt.loading(r,n):rt.loading(r.render,{...n,...r}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(e,t,r)=>{if(null==t)return void rt.dismiss(i);let s={type:e,...o,...n,data:r},a=Oe(t)?{render:t}:t;return i?rt.update(i,{...s,...a}):rt(a.render,{...s,...a}),r},c=De(e)?e():e;return c.then((e=>l("success",a,e))).catch((e=>l("error",s,e))),c},rt.success=it("success"),rt.info=it("info"),rt.error=it("error"),rt.warning=it("warning"),rt.warn=rt.warning,rt.dark=(e,t)=>tt(e,nt("default",{theme:"dark",...t})),rt.dismiss=function(e){Xe(e)},rt.clearWaitingQueue=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};We.forEach((t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()}))},rt.isActive=Qe,rt.update=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=((e,t)=>{let{containerId:n}=t;var i;return null==(i=We.get(n||1))?void 0:i.toasts.get(e)})(e,t);if(n){let{props:i,content:r}=n,s={delay:100,...i,...t,toastId:t.toastId||e,updateId:Ve()};s.toastId!==e&&(s.staleId=e);let a=s.render||r;delete s.render,tt(a,s)}},rt.done=e=>{rt.update(e,{progress:1})},rt.onChange=function(e){return qe.add(e),()=>{qe.delete(e)}},rt.play=e=>Je(!0,e),rt.pause=e=>Je(!1,e);var at="undefined"!=typeof window?t.useLayoutEffect:t.useEffect,ot=e=>{let{theme:n,type:i,isLoading:r,...s}=e;return t.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===n?"currentColor":`var(--toastify-icon-color-${i})`,...s})};var lt={info:function(e){return t.createElement(ot,{...e},t.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return t.createElement(ot,{...e},t.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return t.createElement(ot,{...e},t.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return t.createElement(ot,{...e},t.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return t.createElement("div",{className:"Toastify__spinner"})}};function ct(e){let{theme:n,type:i,isLoading:r,icon:s}=e,a=null,o={theme:n,type:i};return!1===s||(De(s)?a=s({...o,isLoading:r}):(0,t.isValidElement)(s)?a=(0,t.cloneElement)(s,o):r?a=lt.spinner():(e=>e in lt)(i)&&(a=lt[i](o))),a}var ht=e=>{let{isRunning:n,preventExitTransition:i,toastRef:r,eventHandlers:s,playToast:a}=st(e),{closeButton:o,children:l,autoClose:c,onClick:h,type:u,hideProgressBar:d,closeToast:p,transition:f,position:m,className:g,style:v,progressClassName:y,updateId:b,role:w,progress:x,rtl:E,toastId:C,deleteToast:A,isIn:S,isLoading:_,closeOnClick:T,theme:P,ariaLabel:M}=e,N=Ne("Toastify__toast",`Toastify__toast-theme--${P}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":E},{"Toastify__toast--close-on-click":T}),I=De(g)?g({rtl:E,position:m,type:u,defaultClassName:N}):Ne(N,g),O=ct(e),D=!!x||!c,L={closeToast:p,type:u,theme:P},R=null;return!1===o||(R=De(o)?o(L):(0,t.isValidElement)(o)?(0,t.cloneElement)(o,L):function(e){let{closeToast:n,theme:i,ariaLabel:r="close"}=e;return t.createElement("button",{className:`Toastify__close-button Toastify__close-button--${i}`,type:"button",onClick:e=>{e.stopPropagation(),n(!0)},"aria-label":r},t.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},t.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(L)),t.createElement(f,{isIn:S,done:A,position:m,preventExitTransition:i,nodeRef:r,playToast:a},t.createElement("div",{id:C,tabIndex:0,onClick:h,"data-in":S,className:I,...s,style:v,ref:r,...S&&{role:w,"aria-label":M}},null!=O&&t.createElement("div",{className:Ne("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!_})},O),ze(l,e,!n),R,!e.customProgressBar&&t.createElement(Fe,{...b&&!D?{key:`p-${b}`}:{},rtl:E,theme:P,delay:c,isRunning:n,isIn:S,closeToast:p,hide:d,type:u,className:y,controlledProgress:D,progress:x||0})))},ut=function(e){return{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},dt=Be(ut("bounce",!0)),pt=(Be(ut("slide",!0)),Be(ut("zoom")),Be(ut("flip")),{position:"top-right",transition:dt,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&"KeyT"===e.code});function ft(e){let n={...pt,...e},i=e.stacked,[r,s]=(0,t.useState)(!0),a=(0,t.useRef)(null),{getToastToRender:o,isToastActive:l,count:c}=function(e){var n;let{subscribe:i,getSnapshot:r,setProps:s}=(0,t.useRef)($e(e)).current;s(e);let a=null==(n=(0,t.useSyncExternalStore)(i,r,r))?void 0:n.slice();return{getToastToRender:function(t){if(!a)return[];let n=new Map;return e.newestOnTop&&a.reverse(),a.forEach((e=>{let{position:t}=e.props;n.has(t)||n.set(t,[]),n.get(t).push(e)})),Array.from(n,(e=>t(e[0],e[1])))},isToastActive:Qe,count:null==a?void 0:a.length}}(n),{className:h,style:u,rtl:d,containerId:p,hotKeys:f}=n;function m(e){let t=Ne("Toastify__toast-container",`Toastify__toast-container--${e}`,{"Toastify__toast-container--rtl":d});return De(h)?h({position:e,rtl:d,defaultClassName:t}):Ne(t,Le(h))}function g(){i&&(s(!0),rt.play())}return at((()=>{var e;if(i){let t=a.current.querySelectorAll('[data-in="true"]'),i=12,s=null==(e=n.position)?void 0:e.includes("top"),o=0,l=0;Array.from(t).reverse().forEach(((e,t)=>{let n=e;n.classList.add("Toastify__toast--stacked"),t>0&&(n.dataset.collapsed=`${r}`),n.dataset.pos||(n.dataset.pos=s?"top":"bot");let a=o*(r?.2:1)+(r?0:i*t);n.style.setProperty("--y",`${s?a:-1*a}px`),n.style.setProperty("--g",`${i}`),n.style.setProperty("--s",""+(1-(r?l:0))),o+=n.offsetHeight,l+=.025}))}}),[r,c,i]),(0,t.useEffect)((()=>{function e(e){var t;let n=a.current;f(e)&&(null==(t=n.querySelector('[tabIndex="0"]'))||t.focus(),s(!1),rt.pause()),"Escape"===e.key&&(document.activeElement===n||null!=n&&n.contains(document.activeElement))&&(s(!0),rt.play())}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[f]),t.createElement("section",{ref:a,className:"Toastify",id:p,onMouseEnter:()=>{i&&(s(!1),rt.pause())},onMouseLeave:g,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":n["aria-label"]},o(((e,n)=>{let r=n.length?{...u}:{...u,pointerEvents:"none"};return t.createElement("div",{tabIndex:-1,className:m(e),"data-stacked":i,style:r,key:`c-${e}`},n.map((e=>{let{content:n,props:r}=e;return t.createElement(ht,{...r,stacked:i,collapseAll:g,isIn:l(r.toastId,r.containerId),key:`t-${r.key}`},n)})))})))}n.p;const mt="data:image/png;base64,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";var gt=n(70579);const vt=()=>{const e=ee(),[n,i]=(0,t.useState)(""),[r,s]=(0,t.useState)(""),[a,o]=(0,t.useState)(!1),[l,c]=(0,t.useState)(""),[h,u]=(0,t.useState)("");return(0,gt.jsxs)(gt.Fragment,{children:[(0,gt.jsxs)("div",{className:"blur-bg py-3 px-4 d-flex justify-content-between align-items-center w-100 shadow-sm position-absolute top-0",children:[(0,gt.jsx)("img",{src:mt,alt:"Wave Logo",className:"img-fluid",style:{maxWidth:"120px"}}),(0,gt.jsx)("button",{className:"btn btn-primary px-4",onClick:()=>e("/signup"),children:"Sign Up"})]}),(0,gt.jsxs)("div",{className:"login-page position-relative vh-100 mh-100",children:[(0,gt.jsx)("div",{className:"position-absolute w-100 h-100 bg-dark bg-opacity-10"}),(0,gt.jsx)("div",{className:"position-absolute translate-centrt w-100 mw-100 px-3",children:(0,gt.jsxs)("div",{className:"login-box shadow-lg rounded-3 bg-white ",style:{maxWidth:"450px"},children:[(0,gt.jsxs)("div",{className:"p-3 pb-0",children:[(0,gt.jsxs)("h2",{className:"fw-semibold",children:["Sign in to ",(0,gt.jsx)("span",{className:"text-primary",children:"Wave"})]}),(0,gt.jsx)("p",{className:"text-secondary mb-4",children:"Fill your email and password to sign in"})]}),(0,gt.jsx)("hr",{}),(0,gt.jsxs)("form",{className:"px-3",onSubmit:e=>{e.preventDefault(),(()=>{let e=!0;return c(""),u(""),n.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)?n.length>=250&&(c("Too long email"),e=!1):(c("Invalid email format"),e=!1):(c("Email is required"),e=!1),r.trim()?r.length<=8&&(u("Password must be 8 digits long"),e=!1):(u("Password is required"),e=!1),e})()&&(rt.success("Login successful"),console.log("Logging in with:",{email:n,password:r}))},children:[(0,gt.jsxs)("div",{className:"mb-2",children:[(0,gt.jsx)("label",{className:"form-label fw-medium",children:"Email"}),(0,gt.jsx)("input",{type:"email",className:"form-control rounded-2 "+(l?"is-invalid":""),placeholder:"Enter email",value:n,onChange:e=>i(e.target.value)}),l&&(0,gt.jsx)("div",{className:"invalid-feedback",children:l})]}),(0,gt.jsxs)("div",{className:"mb-2 position-relative",children:[(0,gt.jsx)("label",{className:"form-label fw-medium",children:"Password"}),(0,gt.jsx)("input",{type:a?"text":"password",className:"form-control rounded-2 "+(h?"is-invalid":""),placeholder:"Enter password",value:r,onChange:e=>s(e.target.value)}),(0,gt.jsx)("button",{type:"button",className:"btn btn-link position-absolute end-0 top-50 translate-middle-y",onClick:()=>o(!a),children:(0,gt.jsx)("i",{className:a?"fa fa-eye":"fa fa-eye-slash"})}),h&&(0,gt.jsx)("div",{className:"invalid-feedback",children:h})]}),(0,gt.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,gt.jsxs)("div",{className:"form-check",children:[(0,gt.jsx)("input",{className:"form-check-input",type:"checkbox",id:"remember"}),(0,gt.jsx)("label",{className:"form-check-label text-secondary",htmlFor:"remember",children:"Remember me"})]}),(0,gt.jsx)(_e,{to:"/forgot-password",className:"text-decoration-none text-primary small",children:"Forgot password?"})]}),(0,gt.jsx)("button",{type:"submit",className:"btn btn-primary text-ligh w-100 py-2 rounded-2 fw-medium",children:"Sign In"}),(0,gt.jsxs)("p",{className:"text-center mt-2 text-secondary",children:["Don't have an account?"," ",(0,gt.jsx)("a",{href:"/signup",className:"text-primary text-decoration-none fw-medium",children:"Sign Up"})]})]})]})})]})]})};var yt=n(90297);const bt=()=>{const e=ee(),n=(0,yt.customList)("countryCode","{countryNameEn} (+{countryCallingCode})"),i=Object.entries(n).map((e=>{let[t,n]=e;return{code:t,name:n}})),r=(0,yt.customList)("countryCode","{countryCallingCode}"),[s,a]=(0,t.useState)({firstName:"",lastName:"",email:"",country:"",phone:"",refEmail:"",password:"",rePassword:"",agree:!1});console.log(s);const[o,l]=(0,t.useState)(!1),[c,h]=(0,t.useState)({}),[u,d]=(0,t.useState)(!1),p=/^[a-zA-Z\s]+$/,f=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,m=/^[0-9]{5,15}$/,g=e=>{const{name:t,value:n,type:i,checked:r}=e.target;a((e=>({...e,[t]:"checkbox"===i?r:n})))};return(0,gt.jsxs)(gt.Fragment,{children:[(0,gt.jsxs)("div",{className:"blur-bg py-3 px-4 d-flex justify-content-between align-items-center w-100 shadow-sm position-absolute top-0",children:[(0,gt.jsx)("img",{src:mt,alt:"Wave Logo",className:"img-fluid",style:{maxWidth:"120px"}}),(0,gt.jsx)("button",{className:"btn btn-primary px-4",onClick:()=>e("/signin"),children:"Sign In"})]}),(0,gt.jsxs)("div",{className:"register-page position-relative vh-100",children:[(0,gt.jsx)("div",{className:"position-absolute w-100 h-100 bg-dark bg-opacity-10"}),(0,gt.jsx)("div",{className:"position-absolute translate-centrt w-100 mw-100 px-3",children:(0,gt.jsxs)("div",{className:"login-box shadow-lg rounded-3 bg-white ",style:{maxWidth:"450px"},children:[(0,gt.jsxs)("div",{className:"pt-2 px-3 pb-0",children:[(0,gt.jsxs)("h2",{className:"fw-semibold",children:["Sign up to ",(0,gt.jsx)("span",{className:"text-primary",children:"Wave"})]}),(0,gt.jsx)("p",{className:"text-secondary mb-4",children:"Create account today and start using Wave"})]}),(0,gt.jsx)("hr",{className:"my-1"}),(0,gt.jsxs)("form",{className:"pt-2 pb-3 px-3",onSubmit:o?e=>{e.preventDefault(),(()=>{const e={};return(!s.password||s.password.length<8)&&(e.password="Password must be at least 8 characters."),s.password!==s.rePassword&&(e.rePassword="Passwords do not match."),s.agree||(e.agree="You must agree to the terms."),h(e),0===Object.keys(e).length})()&&console.log("Registration form submitted:",s)}:e=>{e.preventDefault(),(()=>{const e={};return!s.firstName||s.firstName.length<2||s.firstName.length>50?e.firstName="First name must be 2-50 characters.":p.test(s.firstName)||(e.firstName="First name should not contain special characters."),!s.lastName||s.lastName.length<2||s.lastName.length>50?e.lastName="Last name must be 2-50 characters.":p.test(s.lastName)||(e.lastName="Last name should not contain special characters."),f.test(s.email)||(e.email="Invalid email format."),s.country||(e.country="Country is required."),m.test(s.phone)||(e.phone="Phone must be 5-15 digits."),s.refEmail&&!f.test(s.refEmail)&&(e.refEmail="Invalid referral email."),h(e),0===Object.keys(e).length})()&&l(!0)},children:[!o&&(0,gt.jsxs)(gt.Fragment,{children:[(0,gt.jsxs)("div",{className:"d-flex gap-2",children:[(0,gt.jsxs)("div",{className:"mb-2 w-50",children:[(0,gt.jsx)("label",{className:"form-label",children:"First Name"}),(0,gt.jsx)("input",{type:"text",className:"form-control "+(c.firstName?"is-invalid":""),placeholder:"Your First Name",name:"firstName",value:s.firstName,onChange:g}),c.firstName&&(0,gt.jsx)("div",{className:"invalid-feedback",children:c.firstName})]}),(0,gt.jsxs)("div",{className:"mb-2 w-50",children:[(0,gt.jsx)("label",{className:"form-label",children:"Last Name"}),(0,gt.jsx)("input",{type:"text",className:"form-control "+(c.lastName?"is-invalid":""),placeholder:"Your Last Name",name:"lastName",value:s.lastName,onChange:g}),c.lastName&&(0,gt.jsx)("div",{className:"invalid-feedback",children:c.lastName})]})]}),(0,gt.jsxs)("div",{className:"mb-2",children:[(0,gt.jsx)("label",{className:"form-label",children:"Email"}),(0,gt.jsx)("input",{type:"email",className:"form-control "+(c.email?"is-invalid":""),placeholder:"Your Email",name:"email",value:s.email,onChange:g}),c.email&&(0,gt.jsx)("div",{className:"invalid-feedback",children:c.email})]}),(0,gt.jsxs)("div",{className:"mb-2",children:[(0,gt.jsx)("label",{className:"form-label",children:"Country"}),(0,gt.jsxs)("select",{className:"form-control "+(c.country?"is-invalid":""),name:"country",value:s.country,onChange:g,children:[(0,gt.jsx)("option",{value:"",children:"Select Country"}),i.map((e=>(0,gt.jsx)("option",{value:e.code,children:e.name},e.code)))]}),c.country&&(0,gt.jsx)("div",{className:"invalid-feedback",children:c.country})]}),(0,gt.jsxs)("div",{className:"mb-2",children:[(0,gt.jsx)("label",{className:"form-label",children:"Phone"}),(0,gt.jsxs)("div",{className:"input-group",children:[(0,gt.jsxs)("span",{className:"input-group-text",children:["+",s.country?r[s.country]:"___"]}),(0,gt.jsx)("input",{type:"tel",className:"form-control "+(c.phone?"is-invalid":""),placeholder:"Your Phone No",name:"phone",value:s.phone,onChange:g}),c.phone&&(0,gt.jsx)("div",{className:"invalid-feedback",children:c.phone})]})]}),(0,gt.jsxs)("div",{className:"mb-2",children:[(0,gt.jsx)("label",{className:"form-label",children:"Referral Email (optional)"}),(0,gt.jsx)("input",{type:"email",className:"form-control "+(c.refEmail?"is-invalid":""),placeholder:"Referral Email",name:"refEmail",value:s.refEmail,onChange:g}),c.refEmail&&(0,gt.jsx)("div",{className:"invalid-feedback",children:c.refEmail})]})]}),o&&(0,gt.jsxs)(gt.Fragment,{children:[(0,gt.jsxs)("div",{className:"mb-2 position-relative",children:[(0,gt.jsx)("label",{className:"form-label",children:"Password"}),(0,gt.jsx)("input",{type:"password",className:"form-control "+(c.password?"is-invalid":""),name:"password",placeholder:"Password",value:s.password,onChange:g}),c.password&&(0,gt.jsx)("div",{className:"invalid-feedback",children:c.password})]}),(0,gt.jsxs)("div",{className:"mb-2",children:[(0,gt.jsx)("label",{className:"form-label",children:"Re-enter Password"}),(0,gt.jsx)("input",{type:"password",className:"form-control "+(c.rePassword?"is-invalid":""),placeholder:"Re Enter Password",name:"rePassword",value:s.rePassword,onChange:g}),c.rePassword&&(0,gt.jsx)("div",{className:"invalid-feedback",children:c.rePassword})]}),(0,gt.jsxs)("div",{className:"form-check mb-3",children:[(0,gt.jsx)("input",{className:"form-check-input",type:"checkbox",name:"agree",id:"agree",checked:s.agree,onChange:g}),(0,gt.jsxs)("label",{className:"form-check-label",htmlFor:"agree",children:["I agree to the ",(0,gt.jsx)(_e,{to:"/",className:"text-decoration-none",children:" terms and conditions"})]}),c.agree&&(0,gt.jsx)("div",{className:"invalid-feedback d-block",children:c.agree})]})]}),(0,gt.jsx)("button",{type:"submit",className:"btn btn-primary w-100 py-2",children:o?"Register":"Continue"})]})]})})]})]})},wt=()=>{const e=ee(),[n,i]=(0,t.useState)(""),[r,s]=(0,t.useState)(""),[a,o]=(0,t.useState)(!1),[l,c]=(0,t.useState)(""),[h,u]=(0,t.useState)("");return(0,gt.jsxs)(gt.Fragment,{children:[(0,gt.jsxs)("div",{className:"blur-bg py-3 px-4 d-flex justify-content-between align-items-center w-100 shadow-sm position-absolute top-0",children:[(0,gt.jsx)("img",{src:mt,alt:"Wave Logo",className:"img-fluid",style:{maxWidth:"120px"}}),(0,gt.jsx)("button",{className:"btn btn-primary px-4",onClick:()=>e("/signin"),children:"Sign In"})]}),(0,gt.jsxs)("div",{className:"login-page position-relative vh-100 mh-100",children:[(0,gt.jsx)("div",{className:"position-absolute w-100 h-100 bg-dark bg-opacity-10"}),(0,gt.jsx)("div",{className:"position-absolute translate-centrt w-100 mw-100 px-3",children:(0,gt.jsxs)("div",{className:"login-box shadow-lg rounded-3 bg-white ",style:{maxWidth:"450px"},children:[(0,gt.jsxs)("div",{className:"p-3 pb-0",children:[(0,gt.jsx)("h2",{className:"fw-semibold",children:"Forgot Password"}),(0,gt.jsx)("p",{className:"text-secondary mb-4",children:"Reset your password without any hassle"})]}),(0,gt.jsx)("hr",{}),(0,gt.jsxs)("form",{className:"px-3",children:[(0,gt.jsxs)("div",{className:"mb-3",children:[(0,gt.jsx)("label",{className:"form-label fw-medium",children:"Email"}),(0,gt.jsx)("input",{type:"email",className:"form-control rounded-2 "+(l?"is-invalid":""),placeholder:"Enter email",value:n,onChange:e=>i(e.target.value)}),l&&(0,gt.jsx)("div",{className:"invalid-feedback",children:l})]}),(0,gt.jsxs)("button",{type:"submit",className:"btn btn-primary text-ligh w-100 py-2 rounded-2 fw-medium",children:["Continue ",(0,gt.jsx)("i",{class:"fa-solid fa-arrow-right ms-2"})]}),(0,gt.jsxs)("div",{className:"d-flex gap-3 justify-content-center py-2",children:[(0,gt.jsx)("p",{className:"text-center mt-2 text-secondary pe-3 border-end",children:(0,gt.jsx)(_e,{to:"/signin",className:"text-primary text-decoration-none fw-medium",children:"Sign in "})}),(0,gt.jsxs)("p",{className:"text-center mt-2 text-secondary",children:[" ",(0,gt.jsx)(_e,{to:"/signup",className:"text-primary text-decoration-none fw-medium",children:" Sign Up"})]})]})]})]})})]})]})},xt=()=>{const e=ee();return(0,gt.jsx)(gt.Fragment,{children:(0,gt.jsx)("nav",{class:"navbar navbar-expand-lg blur-bg position-absolute w-100 start-0",children:(0,gt.jsxs)("div",{class:"container position-relative z-2",children:[(0,gt.jsx)("img",{onClick:()=>e("/"),src:mt,alt:"Wave Logo",style:{maxWidth:"120px"},className:"img-fluid"}),(0,gt.jsx)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,gt.jsx)("span",{class:"navbar-toggler-icon"})}),(0,gt.jsxs)("div",{class:"collapse navbar-collapse",id:"navbarSupportedContent",children:[(0,gt.jsxs)("ul",{class:"navbar-nav ms-auto mb-2 mb-lg-0",children:[(0,gt.jsxs)("li",{class:"nav-item dropdown px-2",children:[(0,gt.jsx)("a",{class:"nav-link dropdown-toggle ",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"Utilities"}),(0,gt.jsxs)("ul",{class:"dropdown-menu",children:[(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Action"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Another action"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("hr",{class:"dropdown-divider"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Something else here"})})]})]}),(0,gt.jsxs)("li",{class:"nav-item dropdown px-2",children:[(0,gt.jsx)("a",{class:"nav-link dropdown-toggle ",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"Resources"}),(0,gt.jsxs)("ul",{class:"dropdown-menu",children:[(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Action"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Another action"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("hr",{class:"dropdown-divider"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Something else here"})})]})]}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link ",href:"#",children:"Lern"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)(_e,{class:"nav-link ",to:"/presale",children:"Presele"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link ",href:"#",children:"Staking"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link ",href:"#",children:"Roadmap"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link ",href:"#",children:"Tokenomics"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link ",href:"#",children:"Team"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link ",href:"#",children:"Downloads"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link ",href:"#",children:"Contact"})})]}),(0,gt.jsx)("button",{class:"rounded-2 custom-login px-4 py-2",type:"submit",onClick:()=>e("/signin"),children:"Login"})]})]})})})};var Et=Object.create,Ct=Object.defineProperty,At=Object.getOwnPropertyDescriptor,St=Object.getOwnPropertyNames,_t=Object.getPrototypeOf,Tt=Object.prototype.hasOwnProperty,Pt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Mt=(e,t,n)=>(n=null!=e?Et(_t(e)):{},((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of St(t))!Tt.call(e,r)&&r!==n&&Ct(e,r,{get:()=>t[r],enumerable:!(i=At(t,r))||i.enumerable});return e})(!t&&e&&e.__esModule?n:Ct(n,"default",{value:e,enumerable:!0}),e)),Nt=(e,t,n)=>(((e,t,n)=>{t in e?Ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),It=Pt(((e,t)=>{var n,i;n=e,i=function(){return e.importState=function(t){var n=new e;return n.importState(t),n},e;function e(){return function(e){var t=0,n=0,i=0,r=1;0==e.length&&(e=[+new Date]);var s=function(){var e=4022871197,t=function(t){t=t.toString();for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)};return t.version="Mash 0.9",t}();t=s(" "),n=s(" "),i=s(" ");for(var a=0;a<e.length;a++)(t-=s(e[a]))<0&&(t+=1),(n-=s(e[a]))<0&&(n+=1),(i-=s(e[a]))<0&&(i+=1);s=null;var o=function(){var e=2091639*t+2.3283064365386963e-10*r;return t=n,n=i,i=e-(r=0|e)};return o.next=o,o.uint32=function(){return 4294967296*o()},o.fract53=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.version="Alea 0.9",o.args=e,o.exportState=function(){return[t,n,i,r]},o.importState=function(e){t=+e[0]||0,n=+e[1]||0,i=+e[2]||0,r=+e[3]||0},o}(Array.prototype.slice.call(arguments))}},"object"==typeof e?t.exports=i():"function"==typeof define&&define.amd?define(i):n.Alea=i()})),Ot=Pt(((e,t)=>{var n,i;n=e,i=function(e){e.SVD=function(e,t,n,i,r){if(t=void 0===t||t,n=void 0===n||n,r=1e-64/(i=i||Math.pow(2,-52)),!e)throw new TypeError("Matrix a is not defined");var s,a,o,l,c,h,u,d,p,f,m,g,v=e[0].length,y=e.length;if(y<v)throw new TypeError("Invalid matrix: m < n");for(var b=[],w=[],x=[],E="f"===t?y:v,C=f=u=0;C<y;C++)w[C]=new Array(E).fill(0);for(C=0;C<v;C++)x[C]=new Array(v).fill(0);var A,S=new Array(v).fill(0);for(C=0;C<y;C++)for(s=0;s<v;s++)w[C][s]=e[C][s];for(C=0;C<v;C++){for(b[C]=u,p=0,o=C+1,s=C;s<y;s++)p+=Math.pow(w[s][C],2);if(p<r)u=0;else for(d=(h=w[C][C])*(u=h<0?Math.sqrt(p):-Math.sqrt(p))-p,w[C][C]=h-u,s=o;s<v;s++){for(p=0,a=C;a<y;a++)p+=w[a][C]*w[a][s];for(h=p/d,a=C;a<y;a++)w[a][s]=w[a][s]+h*w[a][C]}for(S[C]=u,p=0,s=o;s<v;s++)p+=Math.pow(w[C][s],2);if(p<r)u=0;else{for(d=(h=w[C][C+1])*(u=h<0?Math.sqrt(p):-Math.sqrt(p))-p,w[C][C+1]=h-u,s=o;s<v;s++)b[s]=w[C][s]/d;for(s=o;s<y;s++){for(p=0,a=o;a<v;a++)p+=w[s][a]*w[C][a];for(a=o;a<v;a++)w[s][a]=w[s][a]+p*b[a]}}f<(m=Math.abs(S[C])+Math.abs(b[C]))&&(f=m)}if(n)for(C=v-1;0<=C;C--){if(0!==u){for(d=w[C][C+1]*u,s=o;s<v;s++)x[s][C]=w[C][s]/d;for(s=o;s<v;s++){for(p=0,a=o;a<v;a++)p+=w[C][a]*x[a][s];for(a=o;a<v;a++)x[a][s]=x[a][s]+p*x[a][C]}}for(s=o;s<v;s++)x[C][s]=0,x[s][C]=0;x[C][C]=1,u=b[C],o=C}if(t){if("f"===t)for(C=v;C<y;C++){for(s=v;s<y;s++)w[C][s]=0;w[C][C]=1}for(C=v-1;0<=C;C--){for(o=C+1,u=S[C],s=o;s<E;s++)w[C][s]=0;if(0!==u){for(d=w[C][C]*u,s=o;s<E;s++){for(p=0,a=o;a<y;a++)p+=w[a][C]*w[a][s];for(h=p/d,a=C;a<y;a++)w[a][s]=w[a][s]+h*w[a][C]}for(s=C;s<y;s++)w[s][C]=w[s][C]/u}else for(s=C;s<y;s++)w[s][C]=0;w[C][C]=w[C][C]+1}}for(i*=f,a=v-1;0<=a;a--)for(var _=0;_<50;_++){for(A=!1,o=a;0<=o;o--){if(Math.abs(b[o])<=i){A=!0;break}if(Math.abs(S[o-1])<=i)break}if(!A)for(c=0,l=o-(p=1),C=o;C<a+1&&(h=p*b[C],b[C]=c*b[C],!(Math.abs(h)<=i));C++)if(u=S[C],S[C]=Math.sqrt(h*h+u*u),c=u/(d=S[C]),p=-h/d,t)for(s=0;s<y;s++)m=w[s][l],g=w[s][C],w[s][l]=m*c+g*p,w[s][C]=-m*p+g*c;if(g=S[a],o===a){if(g<0&&(S[a]=-g,n))for(s=0;s<v;s++)x[s][a]=-x[s][a];break}for(f=S[o],h=(((m=S[a-1])-g)*(m+g)+((u=b[a-1])-(d=b[a]))*(u+d))/(2*d*m),u=Math.sqrt(h*h+1),h=((f-g)*(f+g)+d*(m/(h<0?h-u:h+u)-d))/f,C=o+(p=c=1);C<a+1;C++){if(u=b[C],m=S[C],d=p*u,u*=c,g=Math.sqrt(h*h+d*d),h=f*(c=h/(b[C-1]=g))+u*(p=d/g),u=-f*p+u*c,d=m*p,m*=c,n)for(s=0;s<v;s++)f=x[s][C-1],g=x[s][C],x[s][C-1]=f*c+g*p,x[s][C]=-f*p+g*c;if(g=Math.sqrt(h*h+d*d),h=(c=h/(S[C-1]=g))*u+(p=d/g)*m,f=-p*u+c*m,t)for(s=0;s<y;s++)m=w[s][C-1],g=w[s][C],w[s][C-1]=m*c+g*p,w[s][C]=-m*p+g*c}b[o]=0,b[a]=h,S[a]=f}for(C=0;C<v;C++)S[C]<i&&(S[C]=0);return{u:w,q:S,v:x}},e.VERSION="1.1.1",Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof e&&typeof t<"u"?i(e):"function"==typeof define&&define.amd?define(["exports"],i):i((n=typeof globalThis<"u"?globalThis:n||self).SVDJS={})})),Dt=Pt(((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)},t.exports=e.default})),Lt=Pt(((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()},t.exports=e.default})),Rt=Pt(((e,t)=>{function n(e,t,i,r){this.message=e,this.expected=t,this.found=i,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(n,Error),n.buildMessage=function(e,t){var n,i={literal:function(e){return'"'+s(e.text)+'"'},class:function(e){var t,n="";for(t=0;t<e.parts.length;t++)n+=e.parts[t]instanceof Array?a(e.parts[t][0])+"-"+a(e.parts[t][1]):a(e.parts[t]);return"["+(e.inverted?"^":"")+n+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function s(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function o(e){return i[e.type](e)}return"Expected "+function(e){var t,n,i=new Array(e.length);for(t=0;t<e.length;t++)i[t]=o(e[t]);if(i.sort(),i.length>0){for(t=1,n=1;t<i.length;t++)i[t-1]!==i[t]&&(i[n]=i[t],n++);i.length=n}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+(((n=t)?'"'+s(n)+'"':"end of input")+" found.")},t.exports={SyntaxError:n,parse:function(e,t){t=void 0!==t?t:{};var i,r={},s={svg_path:ge},a=ge,o=function(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t=t.concat.apply(t,e[n]);var i=t[0];return i&&"m"==i.code&&(delete i.relative,i.code="M"),t},l=function(e,t){return function(e,t){if(!t)return[e];for(var n=[e],i=0,r=t.length;i<r;i++)n[i+1]=t[i][1];return n}(e,t)},c=/^[Mm]/,h=ue(["M","m"],!1,!1),u=function(e,t,n){var i=Ue(e,[t]);return n&&(i=i.concat(Ue("M"==e?"L":"l",n[1]))),i},d=/^[Zz]/,p=ue(["Z","z"],!1,!1),f=function(){return Ue("Z")},m=/^[Ll]/,g=ue(["L","l"],!1,!1),v=function(e,t){return Ue(e,t)},y=/^[Hh]/,b=ue(["H","h"],!1,!1),w=function(e,t){return Ue(e,t.map((function(e){return{x:e}})))},x=/^[Vv]/,E=ue(["V","v"],!1,!1),C=function(e,t){return Ue(e,t.map((function(e){return{y:e}})))},A=/^[Cc]/,S=ue(["C","c"],!1,!1),_=function(e,t,n){return{x1:e.x,y1:e.y,x2:t.x,y2:t.y,x:n.x,y:n.y}},T=/^[Ss]/,P=ue(["S","s"],!1,!1),M=function(e,t){return{x2:e.x,y2:e.y,x:t.x,y:t.y}},N=/^[Qq]/,I=ue(["Q","q"],!1,!1),O=function(e,t){return{x1:e.x,y1:e.y,x:t.x,y:t.y}},D=/^[Tt]/,L=ue(["T","t"],!1,!1),R=/^[Aa]/,k=ue(["A","a"],!1,!1),B=function(e,t,n,i,r,s){return{rx:e,ry:t,xAxisRotation:n,largeArc:i,sweep:r,x:s.x,y:s.y}},U=function(e,t){return{x:e,y:t}},z=function(e){return 1*e},F=function(e){return 1*e.join("")},j=/^[01]/,V=ue(["0","1"],!1,!1),H=function(e){return"1"==e},W=function(){return""},G=",",q=he(",",!1),K=function(e){return e.join("")},Y=".",Q=he(".",!1),X=/^[eE]/,Z=ue(["e","E"],!1,!1),J=/^[+\-]/,$=ue(["+","-"],!1,!1),ee=/^[0-9]/,te=ue([["0","9"]],!1,!1),ne=function(e){return e.join("")},ie=/^[ \t\n\r]/,re=ue([" ","\t","\n","\r"],!1,!1),se=0,ae=[{line:1,column:1}],oe=0,le=[],ce=0;if("startRule"in t){if(!(t.startRule in s))throw new Error("Can't start parsing from rule \""+t.startRule+'".');a=s[t.startRule]}function he(e,t){return{type:"literal",text:e,ignoreCase:t}}function ue(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function de(t){var n,i=ae[t];if(i)return i;for(n=t-1;!ae[n];)n--;for(i={line:(i=ae[n]).line,column:i.column};n<t;)10===e.charCodeAt(n)?(i.line++,i.column=1):i.column++,n++;return ae[t]=i,i}function pe(e,t){var n=de(e),i=de(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:i.line,column:i.column}}}function fe(e){se<oe||(se>oe&&(oe=se,le=[]),le.push(e))}function me(e,t,i){return new n(n.buildMessage(e,t),e,t,i)}function ge(){var e,t,n,i,s;for(e=se,t=[],n=Re();n!==r;)t.push(n),n=Re();if(t!==r)if(n=function(){var e,t,n,i,s,a;if(e=se,t=ve(),t!==r){for(n=[],i=se,s=[],a=Re();a!==r;)s.push(a),a=Re();for(s!==r?(a=ve())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;){for(n.push(i),i=se,s=[],a=Re();a!==r;)s.push(a),a=Re();s!==r?(a=ve())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r)}n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),n===r&&(n=null),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?e=t=o(n):(se=e,e=r)}else se=e,e=r;else se=e,e=r;return e}function ve(){var t,n,i,s,a,o;if(t=se,n=function(){var t,n,i,s,a,o,l;if(t=se,c.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(h)),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?(s=Se())!==r?(a=se,(o=Me())===r&&(o=null),o!==r?(l=be())!==r?a=o=[o,l]:(se=a,a=r):(se=a,a=r),a===r&&(a=null),a!==r?t=n=u(n,s,a):(se=t,t=r)):(se=t,t=r):(se=t,t=r)}else se=t,t=r;return t}(),n!==r){for(i=[],s=se,a=[],o=Re();o!==r;)a.push(o),o=Re();for(a!==r?(o=ye())!==r?s=a=[a,o]:(se=s,s=r):(se=s,s=r);s!==r;){for(i.push(s),s=se,a=[],o=Re();o!==r;)a.push(o),o=Re();a!==r?(o=ye())!==r?s=a=[a,o]:(se=s,s=r):(se=s,s=r)}i!==r?t=n=l(n,i):(se=t,t=r)}else se=t,t=r;return t}function ye(){var t;return(t=function(){var t,n;return t=se,d.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(p)),n!==r&&(n=f()),t=n,t}())===r&&(t=function(){var t,n,i,s;if(t=se,m.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(g)),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?(s=be())!==r?t=n=v(n,s):(se=t,t=r):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,y.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(b)),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?(s=we())!==r?t=n=w(n,s):(se=t,t=r):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,x.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(E)),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?(s=we())!==r?t=n=C(n,s):(se=t,t=r):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,A.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(S)),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?(s=function(){var e,t,n,i,s,a;if(e=se,t=xe(),t!==r){for(n=[],i=se,(s=Me())===r&&(s=null),s!==r?(a=xe())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Me())===r&&(s=null),s!==r?(a=xe())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),s!==r?t=n=v(n,s):(se=t,t=r)):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,T.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(P)),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?(s=function(){var e,t,n,i,s,a;if(e=se,t=Ee(),t!==r){for(n=[],i=se,(s=Me())===r&&(s=null),s!==r?(a=Ee())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Me())===r&&(s=null),s!==r?(a=Ee())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),s!==r?t=n=v(n,s):(se=t,t=r)):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,N.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(I)),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?(s=function(){var e,t,n,i,s,a;if(e=se,t=Ce(),t!==r){for(n=[],i=se,(s=Me())===r&&(s=null),s!==r?(a=Ce())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Me())===r&&(s=null),s!==r?(a=Ce())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),s!==r?t=n=v(n,s):(se=t,t=r)):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,D.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(L)),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?(s=function(){var e,t,n,i,s,a;if(e=se,t=Se(),t!==r){for(n=[],i=se,(s=Me())===r&&(s=null),s!==r?(a=Se())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Me())===r&&(s=null),s!==r?(a=Se())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),s!==r?t=n=v(n,s):(se=t,t=r)):(se=t,t=r)}else se=t,t=r;return t}(),t===r&&(t=function(){var t,n,i,s;if(t=se,R.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(k)),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?(s=function(){var e,t,n,i,s,a;if(e=se,t=Ae(),t!==r){for(n=[],i=se,(s=Me())===r&&(s=null),s!==r?(a=Ae())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Me())===r&&(s=null),s!==r?(a=Ae())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}(),s!==r?t=n=v(n,s):(se=t,t=r)):(se=t,t=r)}else se=t,t=r;return t}())))))))),t}function be(){var e,t,n,i,s,a;if(e=se,(t=Se())!==r){for(n=[],i=se,(s=Me())===r&&(s=null),s!==r?(a=Se())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Me())===r&&(s=null),s!==r?(a=Se())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}function we(){var e,t,n,i,s,a;if(e=se,(t=Te())!==r){for(n=[],i=se,(s=Me())===r&&(s=null),s!==r?(a=Te())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);i!==r;)n.push(i),i=se,(s=Me())===r&&(s=null),s!==r?(a=Te())!==r?i=s=[s,a]:(se=i,i=r):(se=i,i=r);n!==r?e=t=l(t,n):(se=e,e=r)}else se=e,e=r;return e}function xe(){var e,t,n,i,s,a;return e=se,(t=Se())!==r?((n=Me())===r&&(n=null),n!==r?(i=Se())!==r?((s=Me())===r&&(s=null),s!==r?(a=Se())!==r?e=t=_(t,i,a):(se=e,e=r):(se=e,e=r)):(se=e,e=r):(se=e,e=r)):(se=e,e=r),e}function Ee(){var e,t,n,i;return e=se,(t=Se())!==r?((n=Me())===r&&(n=null),n!==r?(i=Se())!==r?e=t=M(t,i):(se=e,e=r):(se=e,e=r)):(se=e,e=r),e}function Ce(){var e,t,n,i;return e=se,(t=Se())!==r?((n=Me())===r&&(n=null),n!==r?(i=Se())!==r?e=t=O(t,i):(se=e,e=r):(se=e,e=r)):(se=e,e=r),e}function Ae(){var e,t,n,i,s,a,o,l,c,h,u;return e=se,(t=_e())!==r?((n=Me())===r&&(n=null),n!==r?(i=_e())!==r?((s=Me())===r&&(s=null),s!==r?(a=Te())!==r?Me()!==r?(o=Pe())!==r?((l=Me())===r&&(l=null),l!==r?(c=Pe())!==r?((h=Me())===r&&(h=null),h!==r?(u=Se())!==r?e=t=B(t,i,a,o,c,u):(se=e,e=r):(se=e,e=r)):(se=e,e=r):(se=e,e=r)):(se=e,e=r):(se=e,e=r):(se=e,e=r):(se=e,e=r)):(se=e,e=r):(se=e,e=r)):(se=e,e=r),e}function Se(){var e,t,n,i;return e=se,(t=Te())!==r?((n=Me())===r&&(n=null),n!==r?(i=Te())!==r?e=t=U(t,i):(se=e,e=r):(se=e,e=r)):(se=e,e=r),e}function _e(){var e,t;return e=se,(t=Ie())===r&&(t=Le()),t!==r&&(t=z(t)),e=t}function Te(){var e,t,n,i;return e=se,t=se,(n=De())===r&&(n=null),n!==r?(i=Ie())!==r?t=n=[n,i]:(se=t,t=r):(se=t,t=r),t===r&&(t=se,(n=De())===r&&(n=null),n!==r?(i=Le())!==r?t=n=[n,i]:(se=t,t=r):(se=t,t=r)),t!==r&&(t=F(t)),e=t}function Pe(){var t,n;return t=se,j.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(V)),n!==r&&(n=H(n)),t=n}function Me(){var e,t,n,i,s;if(e=se,t=[],(n=Re())!==r)for(;n!==r;)t.push(n),n=Re();else t=r;if(t!==r)if((n=Ne())===r&&(n=null),n!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?e=t=[t,n,i]:(se=e,e=r)}else se=e,e=r;else se=e,e=r;if(e===r){if(e=se,t=se,(n=Ne())!==r){for(i=[],s=Re();s!==r;)i.push(s),s=Re();i!==r?t=n=[n,i]:(se=t,t=r)}else se=t,t=r;t!==r&&(t=W()),e=t}return e}function Ne(){var t;return 44===e.charCodeAt(se)?(t=G,se++):(t=r,0===ce&&fe(q)),t}function Ie(){var t,n,i,s;return t=se,n=se,i=function(){var t,n,i,s,a;return t=se,n=se,i=Le(),i===r&&(i=null),i!==r?(46===e.charCodeAt(se)?(s=Y,se++):(s=r,0===ce&&fe(Q)),s!==r&&(a=Le())!==r?(i=[i,s,a],n=i):(se=n,n=r)):(se=n,n=r),n===r&&(n=se,i=Le(),i!==r?(46===e.charCodeAt(se)?(s=Y,se++):(s=r,0===ce&&fe(Q)),s!==r?(i=[i,s],n=i):(se=n,n=r)):(se=n,n=r)),n!==r&&(n=K(n)),t=n,t}(),i!==r?((s=Oe())===r&&(s=null),s!==r?n=i=[i,s]:(se=n,n=r)):(se=n,n=r),n===r&&(n=se,(i=Le())!==r?(s=Oe())!==r?n=i=[i,s]:(se=n,n=r):(se=n,n=r)),n!==r&&(n=K(n)),t=n}function Oe(){var t,n,i,s,a;return t=se,n=se,X.test(e.charAt(se))?(i=e.charAt(se),se++):(i=r,0===ce&&fe(Z)),i!==r?((s=De())===r&&(s=null),s!==r?(a=Le())!==r?n=i=[i,s,a]:(se=n,n=r):(se=n,n=r)):(se=n,n=r),n!==r&&(n=K(n)),t=n}function De(){var t;return J.test(e.charAt(se))?(t=e.charAt(se),se++):(t=r,0===ce&&fe($)),t}function Le(){var t,n,i;if(t=se,n=[],ee.test(e.charAt(se))?(i=e.charAt(se),se++):(i=r,0===ce&&fe(te)),i!==r)for(;i!==r;)n.push(i),ee.test(e.charAt(se))?(i=e.charAt(se),se++):(i=r,0===ce&&fe(te));else n=r;return n!==r&&(n=ne(n)),t=n}function Re(){var t,n;return t=se,ie.test(e.charAt(se))?(n=e.charAt(se),se++):(n=r,0===ce&&fe(re)),n!==r&&(n=W()),t=n}var ke={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var Be in ke)ke[Be.toUpperCase()]=ke[Be];function Ue(e,t){t||(t=[{}]);for(var n=t.length;n--;){var i={code:e,command:ke[e]};for(var r in e==e.toLowerCase()&&(i.relative=!0),t[n])i[r]=t[n][r];t[n]=i}return t}if((i=a())!==r&&se===e.length)return i;throw i!==r&&se<e.length&&fe({type:"end"}),me(le,oe<e.length?e.charAt(oe):null,oe<e.length?pe(oe,oe+1):pe(oe,oe))}}})),kt=Pt(((e,t)=>{var n=Rt().parse;n.parseSVG=n,n.makeAbsolute=function(e){var t,n={x:0,y:0},i={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return e.forEach((function(e){for(var r in"moveto"===e.command&&(t=e),e.x0=n.x,e.y0=n.y,i)r in e&&(e[r]+=e.relative?e[i[r]]:0);"x"in e||(e.x=n.x),"y"in e||(e.y=n.y),e.relative=!1,e.code=e.code.toUpperCase(),"closepath"==e.command&&(e.x=t.x,e.y=t.y),n=e})),e},t.exports=n})),Bt=Pt(((e,t)=>{t.exports=function(e,t){for(var n=e.split("."),i=t.split("."),r=0;r<3;r++){var s=Number(n[r]),a=Number(i[r]);if(s>a)return 1;if(a>s)return-1;if(!isNaN(s)&&isNaN(a))return 1;if(isNaN(s)&&!isNaN(a))return-1}return 0}})),Ut="149",zt=0,Ft=1,jt=2,Vt=3,Ht=0,Wt=1,Gt=2,qt=100,Kt=101,Yt=102,Qt=200,Xt=201,Zt=202,Jt=203,$t=204,en=205,tn=206,nn=207,rn=208,sn=209,an=210,on=301,ln=302,cn=306,hn=1e3,un=1001,dn=1002,pn=1003,fn=1004,mn=1005,gn=1006,vn=1007,yn=1008,bn=1009,wn=1014,xn=1015,En=1016,Cn=1020,An=1023,Sn=1026,_n=1027,Tn=1028,Pn=1030,Mn=33776,Nn=33777,In=33778,On=33779,Dn=36492,Ln=2202,Rn=2300,kn=2301,Bn=2302,Un=2400,zn=2401,Fn=2402,jn=2500,Vn=3e3,Hn=3001,Wn=3200,Gn="srgb",qn="srgb-linear",Kn=7680,Yn=35044,Qn="300 es",Xn=1035,Zn=class{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});let n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;let n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;let n=this._listeners[e];if(void 0!==n){let e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;let t=this._listeners[e.type];if(void 0!==t){e.target=this;let n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}},Jn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],$n=1234567,ei=Math.PI/180,ti=180/Math.PI;function ni(){let e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Jn[255&e]+Jn[e>>8&255]+Jn[e>>16&255]+Jn[e>>24&255]+"-"+Jn[255&t]+Jn[t>>8&255]+"-"+Jn[t>>16&15|64]+Jn[t>>24&255]+"-"+Jn[63&n|128]+Jn[n>>8&255]+"-"+Jn[n>>16&255]+Jn[n>>24&255]+Jn[255&i]+Jn[i>>8&255]+Jn[i>>16&255]+Jn[i>>24&255]).toLowerCase()}function ii(e,t,n){return Math.max(t,Math.min(n,e))}function ri(e,t){return(e%t+t)%t}function si(e,t,n){return(1-n)*e+n*t}function ai(e){return 0===(e&e-1)&&0!==e}function oi(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function li(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function ci(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function hi(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}var ui=Object.freeze({__proto__:null,DEG2RAD:ei,RAD2DEG:ti,ceilPowerOfTwo:oi,clamp:ii,damp:function(e,t,n,i){return si(e,t,1-Math.exp(-n*i))},degToRad:function(e){return e*ei},denormalize:ci,euclideanModulo:ri,floorPowerOfTwo:li,generateUUID:ni,inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},isPowerOfTwo:ai,lerp:si,mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},normalize:hi,pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(ri(e,2*t)-t)},radToDeg:function(e){return e*ti},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},seededRandom:function(e){void 0!==e&&($n=e);let t=$n+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},setQuaternionFromProperEuler:function(e,t,n,i,r){let s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),c=s((t+i)/2),h=a((t+i)/2),u=s((t-i)/2),d=a((t-i)/2),p=s((i-t)/2),f=a((i-t)/2);switch(r){case"XYX":e.set(o*h,l*u,l*d,o*c);break;case"YZY":e.set(l*d,o*h,l*u,o*c);break;case"ZXZ":e.set(l*u,l*d,o*h,o*c);break;case"XZX":e.set(o*h,l*f,l*p,o*c);break;case"YXY":e.set(l*p,o*h,l*f,o*c);break;case"ZYZ":e.set(l*f,l*p,o*h,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)}}),di=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;di.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},pi=class{constructor(){pi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,n,i,r,s,a,o,l){let c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=r,c[5]=o,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,i=t.elements,r=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],c=n[4],h=n[7],u=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],b=i[7],w=i[2],x=i[5],E=i[8];return r[0]=s*f+a*v+o*w,r[3]=s*m+a*y+o*x,r[6]=s*g+a*b+o*E,r[1]=l*f+c*v+h*w,r[4]=l*m+c*y+h*x,r[7]=l*g+c*b+h*E,r[2]=u*f+d*v+p*w,r[5]=u*m+d*y+p*x,r[8]=u*g+d*b+p*E,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-n*r*c+n*a*o+i*r*l-i*s*o}invert(){let e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=c*s-a*l,u=a*o-c*r,d=l*r-s*o,p=t*h+n*u+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return e[0]=h*f,e[1]=(i*l-c*n)*f,e[2]=(a*n-i*s)*f,e[3]=u*f,e[4]=(c*t-i*o)*f,e[5]=(i*r-a*t)*f,e[6]=d*f,e[7]=(n*o-l*t)*f,e[8]=(s*t-n*r)*f,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,a){let o=Math.cos(r),l=Math.sin(r);return this.set(n*o,n*l,-n*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(fi.makeScale(e,t)),this}rotate(e){return this.premultiply(fi.makeRotation(-e)),this}translate(e,t){return this.premultiply(fi.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}},fi=new pi;function mi(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var gi={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function vi(e,t){return new gi[e](t)}function yi(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function bi(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function wi(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var xi={[Gn]:{[qn]:bi},[qn]:{[Gn]:wi}},Ei={legacyMode:!0,get workingColorSpace(){return qn},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,n){if(this.legacyMode||t===n||!t||!n)return e;if(xi[t]&&void 0!==xi[t][n]){let i=xi[t][n];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},Ci={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ai={r:0,g:0,b:0},Si={h:0,s:0,l:0},_i={h:0,s:0,l:0};function Ti(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Pi(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var Mi=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gn;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Ei.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ei.workingColorSpace;return this.r=e,this.g=t,this.b=n,Ei.toWorkingColorSpace(this,i),this}setHSL(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ei.workingColorSpace;if(e=ri(e,1),t=ii(t,0,1),n=ii(n,0,1),0===t)this.r=this.g=this.b=n;else{let i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=Ti(r,i,e+1/3),this.g=Ti(r,i,e),this.b=Ti(r,i,e-1/3)}return Ei.toWorkingColorSpace(this,i),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gn;function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e,r=t[1],s=t[2];switch(r){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,Ei.toWorkingColorSpace(this,n),i(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,Ei.toWorkingColorSpace(this,n),i(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){let t=parseFloat(e[1])/360,r=parseFloat(e[2])/100,s=parseFloat(e[3])/100;return i(e[4]),this.setHSL(t,r,s,n)}}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){let e=t[1],i=e.length;if(3===i)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,Ei.toWorkingColorSpace(this,n),this;if(6===i)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,Ei.toWorkingColorSpace(this,n),this}return e&&e.length>0?this.setColorName(e,n):this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gn,n=Ci[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=bi(e.r),this.g=bi(e.g),this.b=bi(e.b),this}copyLinearToSRGB(e){return this.r=wi(e.r),this.g=wi(e.g),this.b=wi(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gn;return Ei.fromWorkingColorSpace(Pi(this,Ai),e),ii(255*Ai.r,0,255)<<16^ii(255*Ai.g,0,255)<<8^ii(255*Ai.b,0,255)}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gn;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ei.workingColorSpace;Ei.fromWorkingColorSpace(Pi(this,Ai),t);let n,i,r=Ai.r,s=Ai.g,a=Ai.b,o=Math.max(r,s,a),l=Math.min(r,s,a),c=(l+o)/2;if(l===o)n=0,i=0;else{let e=o-l;switch(i=c<=.5?e/(o+l):e/(2-o-l),o){case r:n=(s-a)/e+(s<a?6:0);break;case s:n=(a-r)/e+2;break;case a:n=(r-s)/e+4}n/=6}return e.h=n,e.s=i,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ei.workingColorSpace;return Ei.fromWorkingColorSpace(Pi(this,Ai),t),e.r=Ai.r,e.g=Ai.g,e.b=Ai.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gn;return Ei.fromWorkingColorSpace(Pi(this,Ai),e),e!==Gn?`color(${e} ${Ai.r} ${Ai.g} ${Ai.b})`:`rgb(${255*Ai.r|0},${255*Ai.g|0},${255*Ai.b|0})`}offsetHSL(e,t,n){return this.getHSL(Si),Si.h+=e,Si.s+=t,Si.l+=n,this.setHSL(Si.h,Si.s,Si.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Si),e.getHSL(_i);let n=si(Si.h,_i.h,t),i=si(Si.s,_i.s,t),r=si(Si.l,_i.l,t);return this.setHSL(n,i,r),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Mi.NAMES=Ci;var Ni,Ii=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Ni&&(Ni=yi("canvas")),Ni.width=e.width,Ni.height=e.height;let n=Ni.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Ni}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=yi("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*bi(r[e]/255);return n.putImageData(i,0,0),t}if(e.data){let t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*bi(t[e]/255)):t[e]=bi(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},Oi=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,this.uuid=ni(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];let n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(Di(i[t].image)):e.push(Di(i[t]))}else e=Di(i);n.url=e}return t||(e.images[this.uuid]=n),n}};function Di(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?Ii.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Li=0,Ri=class extends Zn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ri.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ri.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:un,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:un,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gn,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:yn,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:An,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:bn,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Ri.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:Vn;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Li++}),this.uuid=ni(),this.name="",this.source=new Oi(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new di(0,0),this.repeat=new di(1,1),this.center=new di(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new pi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];let n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case hn:e.x=e.x-Math.floor(e.x);break;case un:e.x=e.x<0?0:1;break;case dn:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case hn:e.y=e.y-Math.floor(e.y);break;case un:e.y=e.y<0?0:1;break;case dn:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}};Ri.DEFAULT_IMAGE=null,Ri.DEFAULT_MAPPING=300,Ri.DEFAULT_ANISOTROPY=1;var ki=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;ki.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r,s=e.elements,a=s[0],o=s[4],l=s[8],c=s[1],h=s[5],u=s[9],d=s[2],p=s[6],f=s[10];if(Math.abs(o-c)<.01&&Math.abs(l-d)<.01&&Math.abs(u-p)<.01){if(Math.abs(o+c)<.1&&Math.abs(l+d)<.1&&Math.abs(u+p)<.1&&Math.abs(a+h+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let e=(a+1)/2,s=(h+1)/2,m=(f+1)/2,g=(o+c)/4,v=(l+d)/4,y=(u+p)/4;return e>s&&e>m?e<.01?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=g/n,r=v/n):s>m?s<.01?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(s),n=g/i,r=y/i):m<.01?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(m),n=v/r,i=y/r),this.set(n,i,r,t),this}let m=Math.sqrt((p-u)*(p-u)+(l-d)*(l-d)+(c-o)*(c-o));return Math.abs(m)<.001&&(m=1),this.x=(p-u)/m,this.y=(l-d)/m,this.z=(c-o)/m,this.w=Math.acos((a+h+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Bi=class extends Zn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new ki(0,0,e,t),this.scissorTest=!1,this.viewport=new ki(0,0,e,t);let i={width:e,height:t,depth:1};this.texture=new Ri(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:gn,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new Oi(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},Ui=class extends Ri{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=pn,this.minFilter=pn,this.wrapR=un,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},zi=class extends Bi{constructor(){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLMultipleRenderTargets=!0;let t=this.texture;this.texture=[];for(let n=0;n<e;n++)this.texture[n]=t.clone(),this.texture[n].isRenderTargetTexture=!0}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},Fi=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,a){let o=n[i+0],l=n[i+1],c=n[i+2],h=n[i+3],u=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(0===a)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=h);if(1===a)return e[t+0]=u,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(h!==f||o!==u||l!==d||c!==p){let e=1-a,t=o*u+l*d+c*p+h*f,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){let r=Math.sqrt(i),s=Math.atan2(r,t*n);e=Math.sin(e*s)/r,a=Math.sin(a*s)/r}let r=a*n;if(o=o*e+u*r,l=l*e+d*r,c=c*e+p*r,h=h*e+f*r,e===1-a){let e=1/Math.sqrt(o*o+l*l+c*c+h*h);o*=e,l*=e,c*=e,h*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,n,i,r,s){let a=n[i],o=n[i+1],l=n[i+2],c=n[i+3],h=r[s],u=r[s+1],d=r[s+2],p=r[s+3];return e[t]=a*p+c*h+o*d-l*u,e[t+1]=o*p+c*u+l*h-a*d,e[t+2]=l*p+c*d+a*u-o*h,e[t+3]=c*p-a*h-o*u-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let n=e._x,i=e._y,r=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(n/2),c=a(i/2),h=a(r/2),u=o(n/2),d=o(i/2),p=o(r/2);switch(s){case"XYZ":this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p;break;case"YXZ":this._x=u*c*h+l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p;break;case"ZXY":this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h-u*d*p;break;case"ZYX":this._x=u*c*h-l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h+u*d*p;break;case"YZX":this._x=u*c*h+l*d*p,this._y=l*d*h+u*c*p,this._z=l*c*p-u*d*h,this._w=l*c*h-u*d*p;break;case"XZY":this._x=u*c*h-l*d*p,this._y=l*d*h-u*c*p,this._z=l*c*p+u*d*h,this._w=l*c*h+u*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],h=t[10],u=n+a+h;if(u>0){let e=.5/Math.sqrt(u+1);this._w=.25/e,this._x=(c-o)*e,this._y=(r-l)*e,this._z=(s-i)*e}else if(n>a&&n>h){let e=2*Math.sqrt(1+n-a-h);this._w=(c-o)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(r+l)/e}else if(a>h){let e=2*Math.sqrt(1+a-n-h);this._w=(r-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(o+c)/e}else{let e=2*Math.sqrt(1+h-n-a);this._w=(s-i)/e,this._x=(r+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ii(this.dot(e),-1,1)))}rotateTowards(e,t){let n=this.angleTo(e);if(0===n)return this;let i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let n=e._x,i=e._y,r=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=n*c+s*a+i*l-r*o,this._y=i*c+s*o+r*a-n*l,this._z=r*c+s*l+n*o-i*a,this._w=s*c-n*a-i*o-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);let n=this._x,i=this._y,r=this._z,s=this._w,a=s*e._w+n*e._x+i*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;let o=1-a*a;if(o<=Number.EPSILON){let e=1-t;return this._w=e*s+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),c=Math.atan2(l,a),h=Math.sin((1-t)*c)/l,u=Math.sin(t*c)/l;return this._w=s*h+this._w*u,this._x=n*h+this._x*u,this._y=i*h+this._y*u,this._z=r*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){let e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(r),n*Math.cos(r),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},ji=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;ji.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Hi.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Hi.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){let t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,a=e.z,o=e.w,l=o*t+s*i-a*n,c=o*n+a*t-r*i,h=o*i+r*n-s*t,u=-r*t-s*n-a*i;return this.x=l*o+u*-r+c*-a-h*-s,this.y=c*o+u*-s+h*-r-l*-a,this.z=h*o+u*-a+l*-s-c*-r,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let n=e.x,i=e.y,r=e.z,s=t.x,a=t.y,o=t.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this}projectOnVector(e){let t=e.lengthSq();if(0===t)return this.set(0,0,0);let n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Vi.copy(this).projectOnVector(e),this.sub(Vi)}reflect(e){return this.sub(Vi.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(ii(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){let i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},Vi=new ji,Hi=new Fi,Wi=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ji(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=3){let l=e[o],c=e[o+1],h=e[o+2];l<t&&(t=l),c<n&&(n=c),h<i&&(i=h),l>r&&(r=l),c>s&&(s=c),h>a&&(a=h)}return this.min.set(t,n,i),this.max.set(r,s,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.count;o<l;o++){let l=e.getX(o),c=e.getY(o),h=e.getZ(o);l<t&&(t=l),c<n&&(n=c),h<i&&(i=h),l>r&&(r=l),c>s&&(s=c),h>a&&(a=h)}return this.min.set(t,n,i),this.max.set(r,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=qi.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);let n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){let t=n.attributes.position;for(let n=0,i=t.count;n<i;n++)qi.fromBufferAttribute(t,n).applyMatrix4(e.matrixWorld),this.expandByPoint(qi)}else null===n.boundingBox&&n.computeBoundingBox(),Ki.copy(n.boundingBox),Ki.applyMatrix4(e.matrixWorld),this.union(Ki);let i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,qi),qi.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(er),tr.subVectors(this.max,er),Yi.subVectors(e.a,er),Qi.subVectors(e.b,er),Xi.subVectors(e.c,er),Zi.subVectors(Qi,Yi),Ji.subVectors(Xi,Qi),$i.subVectors(Yi,Xi);let t=[0,-Zi.z,Zi.y,0,-Ji.z,Ji.y,0,-$i.z,$i.y,Zi.z,0,-Zi.x,Ji.z,0,-Ji.x,$i.z,0,-$i.x,-Zi.y,Zi.x,0,-Ji.y,Ji.x,0,-$i.y,$i.x,0];return!(!rr(t,Yi,Qi,Xi,tr)||(t=[1,0,0,0,1,0,0,0,1],!rr(t,Yi,Qi,Xi,tr)))&&(nr.crossVectors(Zi,Ji),t=[nr.x,nr.y,nr.z],rr(t,Yi,Qi,Xi,tr))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qi.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(qi).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Gi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Gi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Gi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Gi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Gi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Gi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Gi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Gi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Gi)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Gi=[new ji,new ji,new ji,new ji,new ji,new ji,new ji,new ji],qi=new ji,Ki=new Wi,Yi=new ji,Qi=new ji,Xi=new ji,Zi=new ji,Ji=new ji,$i=new ji,er=new ji,tr=new ji,nr=new ji,ir=new ji;function rr(e,t,n,i,r){for(let s=0,a=e.length-3;s<=a;s+=3){ir.fromArray(e,s);let a=r.x*Math.abs(ir.x)+r.y*Math.abs(ir.y)+r.z*Math.abs(ir.z),o=t.dot(ir),l=n.dot(ir),c=i.dot(ir);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}var sr=new Wi,ar=new ji,or=new ji,lr=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ji,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let n=this.center;void 0!==t?n.copy(t):sr.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ar.subVectors(e,this.center);let t=ar.lengthSq();if(t>this.radius*this.radius){let e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(ar,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(or.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ar.copy(e.center).add(or)),this.expandByPoint(ar.copy(e.center).sub(or))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}},cr=new ji,hr=new ji,ur=new ji,dr=new ji,pr=new ji,fr=new ji,mr=new ji,gr=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ji,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,cr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=cr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(cr.copy(this.direction).multiplyScalar(t).add(this.origin),cr.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){hr.copy(e).add(t).multiplyScalar(.5),ur.copy(t).sub(e).normalize(),dr.copy(this.origin).sub(hr);let r,s,a,o,l=.5*e.distanceTo(t),c=-this.direction.dot(ur),h=dr.dot(this.direction),u=-dr.dot(ur),d=dr.lengthSq(),p=Math.abs(1-c*c);if(p>0)if(r=c*u-h,s=c*h-u,o=l*p,r>=0)if(s>=-o)if(s<=o){let e=1/p;r*=e,s*=e,a=r*(r+c*s+2*h)+s*(c*r+s+2*u)+d}else s=l,r=Math.max(0,-(c*s+h)),a=-r*r+s*(s+2*u)+d;else s=-l,r=Math.max(0,-(c*s+h)),a=-r*r+s*(s+2*u)+d;else s<=-o?(r=Math.max(0,-(-c*l+h)),s=r>0?-l:Math.min(Math.max(-l,-u),l),a=-r*r+s*(s+2*u)+d):s<=o?(r=0,s=Math.min(Math.max(-l,-u),l),a=s*(s+2*u)+d):(r=Math.max(0,-(c*l+h)),s=r>0?l:Math.min(Math.max(-l,-u),l),a=-r*r+s*(s+2*u)+d);else s=c>0?-l:l,r=Math.max(0,-(c*s+h)),a=-r*r+s*(s+2*u)+d;return n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(ur).multiplyScalar(s).add(hr),a}intersectSphere(e,t){cr.subVectors(e.center,this.origin);let n=cr.dot(this.direction),i=cr.dot(cr)-n*n,r=e.radius*e.radius;if(i>r)return null;let s=Math.sqrt(r-i),a=n-s,o=n+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){let n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,a,o,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(n=(e.min.x-u.x)*l,i=(e.max.x-u.x)*l):(n=(e.max.x-u.x)*l,i=(e.min.x-u.x)*l),c>=0?(r=(e.min.y-u.y)*c,s=(e.max.y-u.y)*c):(r=(e.max.y-u.y)*c,s=(e.min.y-u.y)*c),n>s||r>i||((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),h>=0?(a=(e.min.z-u.z)*h,o=(e.max.z-u.z)*h):(a=(e.max.z-u.z)*h,o=(e.min.z-u.z)*h),n>o||a>i)||((a>n||n!==n)&&(n=a),(o<i||i!==i)&&(i=o),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return null!==this.intersectBox(e,cr)}intersectTriangle(e,t,n,i,r){pr.subVectors(t,e),fr.subVectors(n,e),mr.crossVectors(pr,fr);let s,a=this.direction.dot(mr);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}dr.subVectors(this.origin,e);let o=s*this.direction.dot(fr.crossVectors(dr,fr));if(o<0)return null;let l=s*this.direction.dot(pr.cross(dr));if(l<0||o+l>a)return null;let c=-s*dr.dot(mr);return c<0?null:this.at(c/a,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}},vr=class{constructor(){vr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,n,i,r,s,a,o,l,c,h,u,d,p,f,m){let g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new vr).fromArray(this.elements)}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){let t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,n=e.elements,i=1/yr.setFromMatrixColumn(e,0).length(),r=1/yr.setFromMatrixColumn(e,1).length(),s=1/yr.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),c=Math.cos(r),h=Math.sin(r);if("XYZ"===e.order){let e=s*c,n=s*h,i=a*c,r=a*h;t[0]=o*c,t[4]=-o*h,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-a*o,t[2]=r-e*l,t[6]=i+n*l,t[10]=s*o}else if("YXZ"===e.order){let e=o*c,n=o*h,i=l*c,r=l*h;t[0]=e+r*a,t[4]=i*a-n,t[8]=s*l,t[1]=s*h,t[5]=s*c,t[9]=-a,t[2]=n*a-i,t[6]=r+e*a,t[10]=s*o}else if("ZXY"===e.order){let e=o*c,n=o*h,i=l*c,r=l*h;t[0]=e-r*a,t[4]=-s*h,t[8]=i+n*a,t[1]=n+i*a,t[5]=s*c,t[9]=r-e*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if("ZYX"===e.order){let e=s*c,n=s*h,i=a*c,r=a*h;t[0]=o*c,t[4]=i*l-n,t[8]=e*l+r,t[1]=o*h,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=a*o,t[10]=s*o}else if("YZX"===e.order){let e=s*o,n=s*l,i=a*o,r=a*l;t[0]=o*c,t[4]=r-e*h,t[8]=i*h+n,t[1]=h,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=n*h+i,t[10]=e-r*h}else if("XZY"===e.order){let e=s*o,n=s*l,i=a*o,r=a*l;t[0]=o*c,t[4]=-h,t[8]=l*c,t[1]=e*h+r,t[5]=s*c,t[9]=n*h-i,t[2]=i*h-n,t[6]=a*c,t[10]=r*h+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(wr,e,xr)}lookAt(e,t,n){let i=this.elements;return Ar.subVectors(e,t),0===Ar.lengthSq()&&(Ar.z=1),Ar.normalize(),Er.crossVectors(n,Ar),0===Er.lengthSq()&&(1===Math.abs(n.z)?Ar.x+=1e-4:Ar.z+=1e-4,Ar.normalize(),Er.crossVectors(n,Ar)),Er.normalize(),Cr.crossVectors(Ar,Er),i[0]=Er.x,i[4]=Cr.x,i[8]=Ar.x,i[1]=Er.y,i[5]=Cr.y,i[9]=Ar.y,i[2]=Er.z,i[6]=Cr.z,i[10]=Ar.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,i=t.elements,r=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],c=n[1],h=n[5],u=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],w=n[15],x=i[0],E=i[4],C=i[8],A=i[12],S=i[1],_=i[5],T=i[9],P=i[13],M=i[2],N=i[6],I=i[10],O=i[14],D=i[3],L=i[7],R=i[11],k=i[15];return r[0]=s*x+a*S+o*M+l*D,r[4]=s*E+a*_+o*N+l*L,r[8]=s*C+a*T+o*I+l*R,r[12]=s*A+a*P+o*O+l*k,r[1]=c*x+h*S+u*M+d*D,r[5]=c*E+h*_+u*N+d*L,r[9]=c*C+h*T+u*I+d*R,r[13]=c*A+h*P+u*O+d*k,r[2]=p*x+f*S+m*M+g*D,r[6]=p*E+f*_+m*N+g*L,r[10]=p*C+f*T+m*I+g*R,r[14]=p*A+f*P+m*O+g*k,r[3]=v*x+y*S+b*M+w*D,r[7]=v*E+y*_+b*N+w*L,r[11]=v*C+y*T+b*I+w*R,r[15]=v*A+y*P+b*O+w*k,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],a=e[5],o=e[9],l=e[13],c=e[2],h=e[6],u=e[10],d=e[14];return e[3]*(+r*o*h-i*l*h-r*a*u+n*l*u+i*a*d-n*o*d)+e[7]*(+t*o*d-t*l*u+r*s*u-i*s*d+i*l*c-r*o*c)+e[11]*(+t*l*h-t*a*d-r*s*h+n*s*d+r*a*c-n*l*c)+e[15]*(-i*a*c-t*o*h+t*a*u+i*s*h-n*s*u+n*o*c)}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(e,t,n){let i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){let e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=e[9],u=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=h*m*l-f*u*l+f*o*d-a*m*d-h*o*g+a*u*g,y=p*u*l-c*m*l-p*o*d+s*m*d+c*o*g-s*u*g,b=c*f*l-p*h*l+p*a*d-s*f*d-c*a*g+s*h*g,w=p*h*o-c*f*o-p*a*u+s*f*u+c*a*m-s*h*m,x=t*v+n*y+i*b+r*w;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let E=1/x;return e[0]=v*E,e[1]=(f*u*r-h*m*r-f*i*d+n*m*d+h*i*g-n*u*g)*E,e[2]=(a*m*r-f*o*r+f*i*l-n*m*l-a*i*g+n*o*g)*E,e[3]=(h*o*r-a*u*r-h*i*l+n*u*l+a*i*d-n*o*d)*E,e[4]=y*E,e[5]=(c*m*r-p*u*r+p*i*d-t*m*d-c*i*g+t*u*g)*E,e[6]=(p*o*r-s*m*r-p*i*l+t*m*l+s*i*g-t*o*g)*E,e[7]=(s*u*r-c*o*r+c*i*l-t*u*l-s*i*d+t*o*d)*E,e[8]=b*E,e[9]=(p*h*r-c*f*r-p*n*d+t*f*d+c*n*g-t*h*g)*E,e[10]=(s*f*r-p*a*r+p*n*l-t*f*l-s*n*g+t*a*g)*E,e[11]=(c*a*r-s*h*r-c*n*l+t*h*l+s*n*d-t*a*d)*E,e[12]=w*E,e[13]=(c*f*i-p*h*i+p*n*u-t*f*u-c*n*m+t*h*m)*E,e[14]=(p*a*i-s*f*i-p*n*o+t*f*o+s*n*m-t*a*m)*E,e[15]=(s*h*i-c*a*i+c*n*o-t*h*o-s*n*u+t*a*u)*E,this}scale(e){let t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,a=e.y,o=e.z,l=r*s,c=r*a;return this.set(l*s+n,l*a-i*o,l*o+i*a,0,l*a+i*o,c*a+n,c*o-i*s,0,l*o-i*a,c*o+i*s,r*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){let i=this.elements,r=t._x,s=t._y,a=t._z,o=t._w,l=r+r,c=s+s,h=a+a,u=r*l,d=r*c,p=r*h,f=s*c,m=s*h,g=a*h,v=o*l,y=o*c,b=o*h,w=n.x,x=n.y,E=n.z;return i[0]=(1-(f+g))*w,i[1]=(d+b)*w,i[2]=(p-y)*w,i[3]=0,i[4]=(d-b)*x,i[5]=(1-(u+g))*x,i[6]=(m+v)*x,i[7]=0,i[8]=(p+y)*E,i[9]=(m-v)*E,i[10]=(1-(u+f))*E,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){let i=this.elements,r=yr.set(i[0],i[1],i[2]).length(),s=yr.set(i[4],i[5],i[6]).length(),a=yr.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],br.copy(this);let o=1/r,l=1/s,c=1/a;return br.elements[0]*=o,br.elements[1]*=o,br.elements[2]*=o,br.elements[4]*=l,br.elements[5]*=l,br.elements[6]*=l,br.elements[8]*=c,br.elements[9]*=c,br.elements[10]*=c,t.setFromRotationMatrix(br),n.x=r,n.y=s,n.z=a,this}makePerspective(e,t,n,i,r,s){let a=this.elements,o=2*r/(t-e),l=2*r/(n-i),c=(t+e)/(t-e),h=(n+i)/(n-i),u=-(s+r)/(s-r),d=-2*s*r/(s-r);return a[0]=o,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,i,r,s){let a=this.elements,o=1/(t-e),l=1/(n-i),c=1/(s-r),h=(t+e)*o,u=(n+i)*l,d=(s+r)*c;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}},yr=new ji,br=new vr,wr=new ji(0,0,0),xr=new ji(1,1,1),Er=new ji,Cr=new ji,Ar=new ji,Sr=new vr,_r=new Fi,Tr=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Tr.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.elements,r=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],h=i[2],u=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(ii(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-ii(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(ii(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-ii(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(ii(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-ii(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Sr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Sr,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return _r.setFromEuler(this),this.setFromQuaternion(_r,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Tr.DEFAULT_ORDER="XYZ";var Pr=class{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}},Mr=0,Nr=new ji,Ir=new Fi,Or=new vr,Dr=new ji,Lr=new ji,Rr=new ji,kr=new Fi,Br=new ji(1,0,0),Ur=new ji(0,1,0),zr=new ji(0,0,1),Fr={type:"added"},jr={type:"removed"},Vr=class extends Zn{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Mr++}),this.uuid=ni(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Vr.DEFAULT_UP.clone();let e=new ji,t=new Tr,n=new Fi,i=new ji(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new vr},normalMatrix:{value:new pi}}),this.matrix=new vr,this.matrixWorld=new vr,this.matrixAutoUpdate=Vr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Vr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Pr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ir.setFromAxisAngle(e,t),this.quaternion.multiply(Ir),this}rotateOnWorldAxis(e,t){return Ir.setFromAxisAngle(e,t),this.quaternion.premultiply(Ir),this}rotateX(e){return this.rotateOnAxis(Br,e)}rotateY(e){return this.rotateOnAxis(Ur,e)}rotateZ(e){return this.rotateOnAxis(zr,e)}translateOnAxis(e,t){return Nr.copy(e).applyQuaternion(this.quaternion),this.position.add(Nr.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Br,e)}translateY(e){return this.translateOnAxis(Ur,e)}translateZ(e){return this.translateOnAxis(zr,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Or.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Dr.copy(e):Dr.set(e,t,n);let i=this.parent;this.updateWorldMatrix(!0,!1),Lr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Or.lookAt(Lr,Dr,this.up):Or.lookAt(Dr,Lr,this.up),this.quaternion.setFromRotationMatrix(Or),i&&(Or.extractRotation(i.matrixWorld),Ir.setFromRotationMatrix(Or),this.quaternion.premultiply(Ir.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Fr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}let t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(jr)),this}removeFromParent(){let e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(jr)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Or.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Or.multiply(e.parent.matrixWorld)),e.applyMatrix4(Or),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){let i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getObjectsByProperty(e,t){let n=[];this[e]===t&&n.push(this);for(let i=0,r=this.children.length;i<r;i++){let r=this.children[i].getObjectsByProperty(e,t);r.length>0&&(n=n.concat(r))}return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Lr,e,Rr),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Lr,kr,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);let t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){let t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let n=0,i=t.length;n<i;n++){let i=t[n];(!0===i.matrixWorldAutoUpdate||!0===e)&&i.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){let e=this.children;for(let t=0,n=e.length;t<n;t++){let n=e[t];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);let t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){let n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){let i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){let t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){let n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){let t=s(e.geometries),i=s(e.materials),r=s(e.textures),a=s(e.images),o=s(e.shapes),l=s(e.skeletons),c=s(e.animations),h=s(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),h.length>0&&(n.nodes=h)}return n.object=i,n;function s(e){let t=[];for(let n in e){let i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){let t=e.children[n];this.add(t.clone())}return this}};Vr.DEFAULT_UP=new ji(0,1,0),Vr.DEFAULT_MATRIX_AUTO_UPDATE=!0,Vr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Hr=new ji,Wr=new ji,Gr=new ji,qr=new ji,Kr=new ji,Yr=new ji,Qr=new ji,Xr=new ji,Zr=new ji,Jr=new ji,$r=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ji,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ji;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Hr.subVectors(e,t),i.cross(Hr);let r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){Hr.subVectors(i,t),Wr.subVectors(n,t),Gr.subVectors(e,t);let s=Hr.dot(Hr),a=Hr.dot(Wr),o=Hr.dot(Gr),l=Wr.dot(Wr),c=Wr.dot(Gr),h=s*l-a*a;if(0===h)return r.set(-2,-1,-1);let u=1/h,d=(l*o-a*c)*u,p=(s*c-a*o)*u;return r.set(1-d-p,p,d)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,qr),qr.x>=0&&qr.y>=0&&qr.x+qr.y<=1}static getUV(e,t,n,i,r,s,a,o){return this.getBarycoord(e,t,n,i,qr),o.set(0,0),o.addScaledVector(r,qr.x),o.addScaledVector(s,qr.y),o.addScaledVector(a,qr.z),o}static isFrontFacing(e,t,n,i){return Hr.subVectors(n,t),Wr.subVectors(e,t),Hr.cross(Wr).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Hr.subVectors(this.c,this.b),Wr.subVectors(this.a,this.b),.5*Hr.cross(Wr).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return $r.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return $r.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,r){return $r.getUV(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return $r.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return $r.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n,i,r=this.a,s=this.b,a=this.c;Kr.subVectors(s,r),Yr.subVectors(a,r),Xr.subVectors(e,r);let o=Kr.dot(Xr),l=Yr.dot(Xr);if(o<=0&&l<=0)return t.copy(r);Zr.subVectors(e,s);let c=Kr.dot(Zr),h=Yr.dot(Zr);if(c>=0&&h<=c)return t.copy(s);let u=o*h-c*l;if(u<=0&&o>=0&&c<=0)return n=o/(o-c),t.copy(r).addScaledVector(Kr,n);Jr.subVectors(e,a);let d=Kr.dot(Jr),p=Yr.dot(Jr);if(p>=0&&d<=p)return t.copy(a);let f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return i=l/(l-p),t.copy(r).addScaledVector(Yr,i);let m=c*p-d*h;if(m<=0&&h-c>=0&&d-p>=0)return Qr.subVectors(a,s),i=(h-c)/(h-c+(d-p)),t.copy(s).addScaledVector(Qr,i);let g=1/(m+f+u);return n=f*g,i=u*g,t.copy(r).addScaledVector(Kr,n).addScaledVector(Yr,i)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},es=0,ts=class extends Zn{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:es++}),this.uuid=ni(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=qt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Kn,this.stencilZFail=Kn,this.stencilZPass=Kn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(let t in e){let n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){let t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});let n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){let t=[];for(let n in e){let i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){let t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,n=null;if(null!==t){let e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}},ns=class extends ts{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},is=new ji,rs=new di,ss=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Yn,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)rs.fromBufferAttribute(this,t),rs.applyMatrix3(e),this.setXY(t,rs.x,rs.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)is.fromBufferAttribute(this,t),is.applyMatrix3(e),this.setXYZ(t,is.x,is.y,is.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)is.fromBufferAttribute(this,t),is.applyMatrix4(e),this.setXYZ(t,is.x,is.y,is.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)is.fromBufferAttribute(this,t),is.applyNormalMatrix(e),this.setXYZ(t,is.x,is.y,is.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)is.fromBufferAttribute(this,t),is.transformDirection(e),this.setXYZ(t,is.x,is.y,is.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ci(t,this.array)),t}setX(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ci(t,this.array)),t}setY(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ci(t,this.array)),t}setZ(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ci(t,this.array)),t}setW(e,t){return this.normalized&&(t=hi(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array),i=hi(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array),i=hi(i,this.array),r=hi(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Yn&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},as=class extends ss{constructor(e,t,n){super(new Uint16Array(e),t,n)}},os=class extends ss{constructor(e,t,n){super(new Uint32Array(e),t,n)}},ls=class extends ss{constructor(e,t,n){super(new Float32Array(e),t,n)}},cs=0,hs=new vr,us=new Vr,ds=new ji,ps=new Wi,fs=new Wi,ms=new ji,gs=class extends Zn{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:cs++}),this.uuid=ni(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(mi(e)?os:as)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);let n=this.attributes.normal;if(void 0!==n){let t=(new pi).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}let i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return hs.makeRotationFromQuaternion(e),this.applyMatrix4(hs),this}rotateX(e){return hs.makeRotationX(e),this.applyMatrix4(hs),this}rotateY(e){return hs.makeRotationY(e),this.applyMatrix4(hs),this}rotateZ(e){return hs.makeRotationZ(e),this.applyMatrix4(hs),this}translate(e,t,n){return hs.makeTranslation(e,t,n),this.applyMatrix4(hs),this}scale(e,t,n){return hs.makeScale(e,t,n),this.applyMatrix4(hs),this}lookAt(e){return us.lookAt(e),us.updateMatrix(),this.applyMatrix4(us.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ds).negate(),this.translate(ds.x,ds.y,ds.z),this}setFromPoints(e){let t=[];for(let n=0,i=e.length;n<i;n++){let i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new ls(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Wi);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ji(-1/0,-1/0,-1/0),new ji(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){let e=t[n];ps.setFromBufferAttribute(e),this.morphTargetsRelative?(ms.addVectors(this.boundingBox.min,ps.min),this.boundingBox.expandByPoint(ms),ms.addVectors(this.boundingBox.max,ps.max),this.boundingBox.expandByPoint(ms)):(this.boundingBox.expandByPoint(ps.min),this.boundingBox.expandByPoint(ps.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new lr);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ji,1/0);if(e){let n=this.boundingSphere.center;if(ps.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let n=t[e];fs.setFromBufferAttribute(n),this.morphTargetsRelative?(ms.addVectors(ps.min,fs.min),ps.expandByPoint(ms),ms.addVectors(ps.max,fs.max),ps.expandByPoint(ms)):(ps.expandByPoint(fs.min),ps.expandByPoint(fs.max))}ps.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)ms.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(ms));if(t)for(let r=0,s=t.length;r<s;r++){let s=t[r],a=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)ms.fromBufferAttribute(s,t),a&&(ds.fromBufferAttribute(e,t),ms.add(ds)),i=Math.max(i,n.distanceToSquared(ms))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");let n=e.array,i=t.position.array,r=t.normal.array,s=t.uv.array,a=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ss(new Float32Array(4*a),4));let o=this.getAttribute("tangent").array,l=[],c=[];for(let S=0;S<a;S++)l[S]=new ji,c[S]=new ji;let h=new ji,u=new ji,d=new ji,p=new di,f=new di,m=new di,g=new ji,v=new ji;function y(e,t,n){h.fromArray(i,3*e),u.fromArray(i,3*t),d.fromArray(i,3*n),p.fromArray(s,2*e),f.fromArray(s,2*t),m.fromArray(s,2*n),u.sub(h),d.sub(h),f.sub(p),m.sub(p);let r=1/(f.x*m.y-m.x*f.y);!isFinite(r)||(g.copy(u).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(r),v.copy(d).multiplyScalar(f.x).addScaledVector(u,-m.x).multiplyScalar(r),l[e].add(g),l[t].add(g),l[n].add(g),c[e].add(v),c[t].add(v),c[n].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(let S=0,_=b.length;S<_;++S){let e=b[S],t=e.start;for(let i=t,r=t+e.count;i<r;i+=3)y(n[i+0],n[i+1],n[i+2])}let w=new ji,x=new ji,E=new ji,C=new ji;function A(e){E.fromArray(r,3*e),C.copy(E);let t=l[e];w.copy(t),w.sub(E.multiplyScalar(E.dot(t))).normalize(),x.crossVectors(C,t);let n=x.dot(c[e])<0?-1:1;o[4*e]=w.x,o[4*e+1]=w.y,o[4*e+2]=w.z,o[4*e+3]=n}for(let S=0,_=b.length;S<_;++S){let e=b[S],t=e.start;for(let i=t,r=t+e.count;i<r;i+=3)A(n[i+0]),A(n[i+1]),A(n[i+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new ss(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);let i=new ji,r=new ji,s=new ji,a=new ji,o=new ji,l=new ji,c=new ji,h=new ji;if(e)for(let u=0,d=e.count;u<d;u+=3){let d=e.getX(u+0),p=e.getX(u+1),f=e.getX(u+2);i.fromBufferAttribute(t,d),r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,f),c.subVectors(s,r),h.subVectors(i,r),c.cross(h),a.fromBufferAttribute(n,d),o.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),a.add(c),o.add(c),l.add(c),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(p,o.x,o.y,o.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,u=t.count;e<u;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,r),h.subVectors(i,r),c.cross(h),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)ms.fromBufferAttribute(e,t),ms.normalize(),e.setXYZ(t,ms.x,ms.y,ms.z)}toNonIndexed(){function e(e,t){let n=e.array,i=e.itemSize,r=e.normalized,s=new n.constructor(t.length*i),a=0,o=0;for(let l=0,c=t.length;l<c;l++){a=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*i;for(let e=0;e<i;e++)s[o++]=n[a++]}return new ss(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new gs,n=this.index.array,i=this.attributes;for(let a in i){let r=e(i[a],n);t.setAttribute(a,r)}let r=this.morphAttributes;for(let a in r){let i=[],s=r[a];for(let t=0,r=s.length;t<r;t++){let r=e(s[t],n);i.push(r)}t.morphAttributes[a]=i}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,o=s.length;a<o;a++){let e=s[a];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){let t=this.parameters;for(let n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};let t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let n=this.attributes;for(let o in n){let t=n[o];e.data.attributes[o]=t.toJSON(e.data)}let i={},r=!1;for(let o in this.morphAttributes){let t=this.morphAttributes[o],n=[];for(let i=0,r=t.length;i<r;i++){let r=t[i];n.push(r.toJSON(e.data))}n.length>0&&(i[o]=n,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let n=e.index;null!==n&&this.setIndex(n.clone(t));let i=e.attributes;for(let l in i){let e=i[l];this.setAttribute(l,e.clone(t))}let r=e.morphAttributes;for(let l in r){let e=[],n=r[l];for(let i=0,r=n.length;i<r;i++)e.push(n[i].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,c=s.length;l<c;l++){let e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}let a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());let o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},vs=new vr,ys=new gr,bs=new lr,ws=new ji,xs=new ji,Es=new ji,Cs=new ji,As=new ji,Ss=new di,_s=new di,Ts=new di,Ps=new ji,Ms=new ji,Ns=class extends Vr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gs,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ns;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){let t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){let n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(i,e);let a=this.morphTargetInfluences;if(r&&a){As.set(0,0,0);for(let n=0,i=r.length;n<i;n++){let i=a[n],o=r[n];0!==i&&(Cs.fromBufferAttribute(o,e),s?As.addScaledVector(Cs,i):As.addScaledVector(Cs.sub(t),i))}t.add(As)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i||(null===n.boundingSphere&&n.computeBoundingSphere(),bs.copy(n.boundingSphere),bs.applyMatrix4(r),!1===e.ray.intersectsSphere(bs))||(vs.copy(r).invert(),ys.copy(e.ray).applyMatrix4(vs),null!==n.boundingBox&&!1===ys.intersectsBox(n.boundingBox)))return;let s,a=n.index,o=n.attributes.position,l=n.attributes.uv,c=n.attributes.uv2,h=n.groups,u=n.drawRange;if(null!==a)if(Array.isArray(i))for(let d=0,p=h.length;d<p;d++){let n=h[d],r=i[n.materialIndex];for(let i=Math.max(n.start,u.start),o=Math.min(a.count,Math.min(n.start+n.count,u.start+u.count));i<o;i+=3){let o=a.getX(i),h=a.getX(i+1),u=a.getX(i+2);s=Is(this,r,e,ys,l,c,o,h,u),s&&(s.faceIndex=Math.floor(i/3),s.face.materialIndex=n.materialIndex,t.push(s))}}else{for(let n=Math.max(0,u.start),r=Math.min(a.count,u.start+u.count);n<r;n+=3){let r=a.getX(n),o=a.getX(n+1),h=a.getX(n+2);s=Is(this,i,e,ys,l,c,r,o,h),s&&(s.faceIndex=Math.floor(n/3),t.push(s))}}else if(void 0!==o)if(Array.isArray(i))for(let d=0,p=h.length;d<p;d++){let n=h[d],r=i[n.materialIndex];for(let i=Math.max(n.start,u.start),a=Math.min(o.count,Math.min(n.start+n.count,u.start+u.count));i<a;i+=3){s=Is(this,r,e,ys,l,c,i,i+1,i+2),s&&(s.faceIndex=Math.floor(i/3),s.face.materialIndex=n.materialIndex,t.push(s))}}else{for(let n=Math.max(0,u.start),r=Math.min(o.count,u.start+u.count);n<r;n+=3){s=Is(this,i,e,ys,l,c,n,n+1,n+2),s&&(s.faceIndex=Math.floor(n/3),t.push(s))}}}};function Is(e,t,n,i,r,s,a,o,l){e.getVertexPosition(a,ws),e.getVertexPosition(o,xs),e.getVertexPosition(l,Es);let c=function(e,t,n,i,r,s,a,o){let l;if(l=1===t.side?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,0===t.side,o),null===l)return null;Ms.copy(o),Ms.applyMatrix4(e.matrixWorld);let c=n.ray.origin.distanceTo(Ms);return c<n.near||c>n.far?null:{distance:c,point:Ms.clone(),object:e}}(e,t,n,i,ws,xs,Es,Ps);if(c){r&&(Ss.fromBufferAttribute(r,a),_s.fromBufferAttribute(r,o),Ts.fromBufferAttribute(r,l),c.uv=$r.getUV(Ps,ws,xs,Es,Ss,_s,Ts,new di)),s&&(Ss.fromBufferAttribute(s,a),_s.fromBufferAttribute(s,o),Ts.fromBufferAttribute(s,l),c.uv2=$r.getUV(Ps,ws,xs,Es,Ss,_s,Ts,new di));let e={a:a,b:o,c:l,normal:new ji,materialIndex:0};$r.getNormal(ws,xs,Es,e.normal),c.face=e}return c}var Os=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};let a=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);let o=[],l=[],c=[],h=[],u=0,d=0;function p(e,t,n,i,r,s,p,f,m,g,v){let y=s/m,b=p/g,w=s/2,x=p/2,E=f/2,C=m+1,A=g+1,S=0,_=0,T=new ji;for(let a=0;a<A;a++){let s=a*b-x;for(let o=0;o<C;o++){let u=o*y-w;T[e]=u*i,T[t]=s*r,T[n]=E,l.push(T.x,T.y,T.z),T[e]=0,T[t]=0,T[n]=f>0?1:-1,c.push(T.x,T.y,T.z),h.push(o/m),h.push(1-a/g),S+=1}}for(let a=0;a<g;a++)for(let e=0;e<m;e++){let t=u+e+C*a,n=u+e+C*(a+1),i=u+(e+1)+C*(a+1),r=u+(e+1)+C*a;o.push(t,n,r),o.push(n,i,r),_+=6}a.addGroup(d,_,v),d+=_,u+=S}p("z","y","x",-1,-1,n,t,e,s,r,0),p("z","y","x",1,-1,n,t,-e,s,r,1),p("x","z","y",1,1,e,n,t,i,s,2),p("x","z","y",1,-1,e,n,-t,i,s,3),p("x","y","z",1,-1,e,t,n,i,r,4),p("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(o),this.setAttribute("position",new ls(l,3)),this.setAttribute("normal",new ls(c,3)),this.setAttribute("uv",new ls(h,2))}static fromJSON(e){return new Os(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Ds(e){let t={};for(let n in e){t[n]={};for(let i in e[n]){let r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function Ls(e){let t={};for(let n=0;n<e.length;n++){let i=Ds(e[n]);for(let e in i)t[e]=i[e]}return t}function Rs(e){return null===e.getRenderTarget()&&e.outputEncoding===Hn?Gn:qn}var ks={clone:Ds,merge:Ls},Bs=class extends ts{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ds(e.uniforms),this.uniformsGroups=function(e){let t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let n={};for(let i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}},Us=class extends Vr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new vr,this.projectionMatrix=new vr,this.projectionMatrixInverse=new vr}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}},zs=class extends Us{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=2*ti*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(.5*ei*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ti*Math.atan(Math.tan(.5*ei*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(.5*ei*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i,s=this.view;if(null!==this.view&&this.view.enabled){let e=s.fullWidth,a=s.fullHeight;r+=s.offsetX*i/e,t-=s.offsetY*n/a,i*=s.width/e,n*=s.height/a}let a=this.filmOffset;0!==a&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},Fs=-90,js=class extends Vr{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n;let i=new zs(Fs,1,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let r=new zs(Fs,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(-1,0,0),this.add(r);let s=new zs(Fs,1,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let a=new zs(Fs,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);let o=new zs(Fs,1,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new zs(Fs,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();let n=this.renderTarget,[i,r,s,a,o,l]=this.children,c=e.getRenderTarget(),h=e.toneMapping,u=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;let d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,r),e.setRenderTarget(n,2),e.render(t,s),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,o),n.texture.generateMipmaps=d,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=h,e.xr.enabled=u,n.texture.needsPMREMUpdate=!0}},Vs=class extends Ri{constructor(e,t,n,i,r,s,a,o,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:on,n,i,r,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},Hs=class extends Bi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;let n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new Vs(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:gn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},i=new Os(5,5,5),r=new Bs({name:"CubemapFromEquirect",uniforms:Ds(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});r.uniforms.tEquirect.value=t;let s=new Ns(i,r),a=t.minFilter;return t.minFilter===yn&&(t.minFilter=gn),new js(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,n,i){let r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(r)}},Ws=new ji,Gs=new ji,qs=new pi,Ks=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ji(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){let i=Ws.subVectors(n,t).cross(Gs.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let n=e.delta(Ws),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;let r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(n).multiplyScalar(r).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let n=t||qs.getNormalMatrix(e),i=this.coplanarPoint(Ws).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}},Ys=new lr,Qs=new ji,Xs=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ks,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ks,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ks,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ks,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Ks,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Ks;this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(s),this}copy(e){let t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=this.planes,n=e.elements,i=n[0],r=n[1],s=n[2],a=n[3],o=n[4],l=n[5],c=n[6],h=n[7],u=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(a-i,h-o,f-u,y-m).normalize(),t[1].setComponents(a+i,h+o,f+u,y+m).normalize(),t[2].setComponents(a+r,h+l,f+d,y+g).normalize(),t[3].setComponents(a-r,h-l,f-d,y-g).normalize(),t[4].setComponents(a-s,h-c,f-p,y-v).normalize(),t[5].setComponents(a+s,h+c,f+p,y+v).normalize(),this}intersectsObject(e){let t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Ys.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ys)}intersectsSprite(e){return Ys.center.set(0,0,0),Ys.radius=.7071067811865476,Ys.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ys)}intersectsSphere(e){let t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let n=0;n<6;n++){let i=t[n];if(Qs.x=i.normal.x>0?e.max.x:e.min.x,Qs.y=i.normal.y>0?e.max.y:e.min.y,Qs.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Qs)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}};function Zs(){let e=null,t=!1,n=null,i=null;function r(t,s){n(t,s),i=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Js(e,t){let n=t.isWebGL2,i=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),i.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);let n=i.get(t);n&&(e.deleteBuffer(n.buffer),i.delete(t))},update:function(t,r){if(t.isGLBufferAttribute){let e=i.get(t);return void((!e||e.version<t.version)&&i.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);let s=i.get(t);void 0===s?i.set(t,function(t,i){let r,s=t.array,a=t.usage,o=e.createBuffer();if(e.bindBuffer(i,o),e.bufferData(i,s,a),t.onUploadCallback(),s instanceof Float32Array)r=5126;else if(s instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");r=5131}else r=5123;else if(s instanceof Int16Array)r=5122;else if(s instanceof Uint32Array)r=5125;else if(s instanceof Int32Array)r=5124;else if(s instanceof Int8Array)r=5120;else if(s instanceof Uint8Array)r=5121;else{if(!(s instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+s);r=5121}return{buffer:o,type:r,bytesPerElement:s.BYTES_PER_ELEMENT,version:t.version}}(t,r)):s.version<t.version&&(function(t,i,r){let s=i.array,a=i.updateRange;e.bindBuffer(r,t),-1===a.count?e.bufferSubData(r,0,s):(n?e.bufferSubData(r,a.offset*s.BYTES_PER_ELEMENT,s,a.offset,a.count):e.bufferSubData(r,a.offset*s.BYTES_PER_ELEMENT,s.subarray(a.offset,a.offset+a.count)),a.count=-1),i.onUploadCallback()}(s.buffer,t,r),s.version=t.version)}}}var $s=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};let r=e/2,s=t/2,a=Math.floor(n),o=Math.floor(i),l=a+1,c=o+1,h=e/a,u=t/o,d=[],p=[],f=[],m=[];for(let g=0;g<c;g++){let e=g*u-s;for(let t=0;t<l;t++){let n=t*h-r;p.push(n,-e,0),f.push(0,0,1),m.push(t/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let e=0;e<a;e++){let t=e+l*g,n=e+l*(g+1),i=e+1+l*(g+1),r=e+1+l*g;d.push(t,n,r),d.push(n,i,r)}this.setIndex(d),this.setAttribute("position",new ls(p,3)),this.setAttribute("normal",new ls(f,3)),this.setAttribute("uv",new ls(m,2))}static fromJSON(e){return new $s(e.width,e.height,e.widthSegments,e.heightSegments)}},ea={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},ta={common:{diffuse:{value:new Mi(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new pi},uv2Transform:{value:new pi},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new di(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Mi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Mi(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new pi}},sprite:{diffuse:{value:new Mi(16777215)},opacity:{value:1},center:{value:new di(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new pi}}},na={basic:{uniforms:Ls([ta.common,ta.specularmap,ta.envmap,ta.aomap,ta.lightmap,ta.fog]),vertexShader:ea.meshbasic_vert,fragmentShader:ea.meshbasic_frag},lambert:{uniforms:Ls([ta.common,ta.specularmap,ta.envmap,ta.aomap,ta.lightmap,ta.emissivemap,ta.bumpmap,ta.normalmap,ta.displacementmap,ta.fog,ta.lights,{emissive:{value:new Mi(0)}}]),vertexShader:ea.meshlambert_vert,fragmentShader:ea.meshlambert_frag},phong:{uniforms:Ls([ta.common,ta.specularmap,ta.envmap,ta.aomap,ta.lightmap,ta.emissivemap,ta.bumpmap,ta.normalmap,ta.displacementmap,ta.fog,ta.lights,{emissive:{value:new Mi(0)},specular:{value:new Mi(1118481)},shininess:{value:30}}]),vertexShader:ea.meshphong_vert,fragmentShader:ea.meshphong_frag},standard:{uniforms:Ls([ta.common,ta.envmap,ta.aomap,ta.lightmap,ta.emissivemap,ta.bumpmap,ta.normalmap,ta.displacementmap,ta.roughnessmap,ta.metalnessmap,ta.fog,ta.lights,{emissive:{value:new Mi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ea.meshphysical_vert,fragmentShader:ea.meshphysical_frag},toon:{uniforms:Ls([ta.common,ta.aomap,ta.lightmap,ta.emissivemap,ta.bumpmap,ta.normalmap,ta.displacementmap,ta.gradientmap,ta.fog,ta.lights,{emissive:{value:new Mi(0)}}]),vertexShader:ea.meshtoon_vert,fragmentShader:ea.meshtoon_frag},matcap:{uniforms:Ls([ta.common,ta.bumpmap,ta.normalmap,ta.displacementmap,ta.fog,{matcap:{value:null}}]),vertexShader:ea.meshmatcap_vert,fragmentShader:ea.meshmatcap_frag},points:{uniforms:Ls([ta.points,ta.fog]),vertexShader:ea.points_vert,fragmentShader:ea.points_frag},dashed:{uniforms:Ls([ta.common,ta.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ea.linedashed_vert,fragmentShader:ea.linedashed_frag},depth:{uniforms:Ls([ta.common,ta.displacementmap]),vertexShader:ea.depth_vert,fragmentShader:ea.depth_frag},normal:{uniforms:Ls([ta.common,ta.bumpmap,ta.normalmap,ta.displacementmap,{opacity:{value:1}}]),vertexShader:ea.meshnormal_vert,fragmentShader:ea.meshnormal_frag},sprite:{uniforms:Ls([ta.sprite,ta.fog]),vertexShader:ea.sprite_vert,fragmentShader:ea.sprite_frag},background:{uniforms:{uvTransform:{value:new pi},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ea.background_vert,fragmentShader:ea.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ea.backgroundCube_vert,fragmentShader:ea.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ea.cube_vert,fragmentShader:ea.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ea.equirect_vert,fragmentShader:ea.equirect_frag},distanceRGBA:{uniforms:Ls([ta.common,ta.displacementmap,{referencePosition:{value:new ji},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ea.distanceRGBA_vert,fragmentShader:ea.distanceRGBA_frag},shadow:{uniforms:Ls([ta.lights,ta.fog,{color:{value:new Mi(0)},opacity:{value:1}}]),vertexShader:ea.shadow_vert,fragmentShader:ea.shadow_frag}};na.physical={uniforms:Ls([na.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new di(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Mi(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new di},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Mi(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Mi(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ea.meshphysical_vert,fragmentShader:ea.meshphysical_frag};var ia={r:0,b:0,g:0};function ra(e,t,n,i,r,s,a){let o,l,c=new Mi(0),h=!0===s?0:1,u=null,d=0,p=null;function f(t,n){t.getRGB(ia,Rs(e)),i.buffers.color.setClear(ia.r,ia.g,ia.b,n,a)}return{getClearColor:function(){return c},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;c.set(e),h=t,f(c,h)},getClearAlpha:function(){return h},setClearAlpha:function(e){h=e,f(c,h)},render:function(i,s){let a=!1,m=!0===s.isScene?s.background:null;m&&m.isTexture&&(m=(s.backgroundBlurriness>0?n:t).get(m));let g=e.xr,v=g.getSession&&g.getSession();v&&"additive"===v.environmentBlendMode&&(m=null),null===m?f(c,h):m&&m.isColor&&(f(m,1),a=!0),(e.autoClear||a)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),m&&(m.isCubeTexture||m.mapping===cn)?(void 0===l&&(l=new Ns(new Os(1,1,1),new Bs({name:"BackgroundCubeMaterial",uniforms:Ds(na.backgroundCube.uniforms),vertexShader:na.backgroundCube.vertexShader,fragmentShader:na.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=m,l.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,l.material.uniforms.backgroundBlurriness.value=s.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,l.material.toneMapped=m.encoding!==Hn,(u!==m||d!==m.version||p!==e.toneMapping)&&(l.material.needsUpdate=!0,u=m,d=m.version,p=e.toneMapping),l.layers.enableAll(),i.unshift(l,l.geometry,l.material,0,0,null)):m&&m.isTexture&&(void 0===o&&(o=new Ns(new $s(2,2),new Bs({name:"BackgroundMaterial",uniforms:Ds(na.background.uniforms),vertexShader:na.background.vertexShader,fragmentShader:na.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(o)),o.material.uniforms.t2D.value=m,o.material.uniforms.backgroundIntensity.value=s.backgroundIntensity,o.material.toneMapped=m.encoding!==Hn,!0===m.matrixAutoUpdate&&m.updateMatrix(),o.material.uniforms.uvTransform.value.copy(m.matrix),(u!==m||d!==m.version||p!==e.toneMapping)&&(o.material.needsUpdate=!0,u=m,d=m.version,p=e.toneMapping),o.layers.enableAll(),i.unshift(o,o.geometry,o.material,0,0,null))}}}function sa(e,t,n,i){let r=e.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),a=i.isWebGL2||null!==s,o={},l=p(null),c=l,h=!1;function u(t){return i.isWebGL2?e.bindVertexArray(t):s.bindVertexArrayOES(t)}function d(t){return i.isWebGL2?e.deleteVertexArray(t):s.deleteVertexArrayOES(t)}function p(e){let t=[],n=[],i=[];for(let s=0;s<r;s++)t[s]=0,n[s]=0,i[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:i,object:e,attributes:{},index:null}}function f(){let e=c.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function m(e){g(e,0)}function g(n,r){let s=c.newAttributes,a=c.enabledAttributes,o=c.attributeDivisors;s[n]=1,0===a[n]&&(e.enableVertexAttribArray(n),a[n]=1),o[n]!==r&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),o[n]=r)}function v(){let t=c.newAttributes,n=c.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function y(t,n,r,s,a,o){!0!==i.isWebGL2||5124!==r&&5125!==r?e.vertexAttribPointer(t,n,r,s,a,o):e.vertexAttribIPointer(t,n,r,a,o)}function b(){w(),h=!0,c!==l&&(c=l,u(c.object))}function w(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,d,b,w){let x=!1;if(a){let t=function(t,n,r){let a=!0===r.wireframe,l=o[t.id];void 0===l&&(l={},o[t.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let h=c[a];return void 0===h&&(h=p(i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()),c[a]=h),h}(b,d,l);c!==t&&(c=t,u(c.object)),x=function(e,t,n,i){let r=c.attributes,s=t.attributes,a=0,o=n.getAttributes();for(let l in o)if(o[l].location>=0){let t=r[l],n=s[l];if(void 0===n&&("instanceMatrix"===l&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(n=e.instanceColor)),void 0===t||t.attribute!==n||n&&t.data!==n.data)return!0;a++}return c.attributesNum!==a||c.index!==i}(r,b,d,w),x&&function(e,t,n,i){let r={},s=t.attributes,a=0,o=n.getAttributes();for(let l in o)if(o[l].location>=0){let t=s[l];void 0===t&&("instanceMatrix"===l&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(t=e.instanceColor));let n={};n.attribute=t,t&&t.data&&(n.data=t.data),r[l]=n,a++}c.attributes=r,c.attributesNum=a,c.index=i}(r,b,d,w)}else{let e=!0===l.wireframe;(c.geometry!==b.id||c.program!==d.id||c.wireframe!==e)&&(c.geometry=b.id,c.program=d.id,c.wireframe=e,x=!0)}null!==w&&n.update(w,34963),(x||h)&&(h=!1,function(r,s,a,o){if(!1===i.isWebGL2&&(r.isInstancedMesh||o.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();let l=o.attributes,c=a.getAttributes(),h=s.defaultAttributeValues;for(let t in c){let i=c[t];if(i.location>=0){let s=l[t];if(void 0===s&&("instanceMatrix"===t&&r.instanceMatrix&&(s=r.instanceMatrix),"instanceColor"===t&&r.instanceColor&&(s=r.instanceColor)),void 0!==s){let t=s.normalized,a=s.itemSize,l=n.get(s);if(void 0===l)continue;let c=l.buffer,h=l.type,u=l.bytesPerElement;if(s.isInterleavedBufferAttribute){let n=s.data,l=n.stride,d=s.offset;if(n.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)g(i.location+e,n.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let e=0;e<i.locationSize;e++)m(i.location+e);e.bindBuffer(34962,c);for(let e=0;e<i.locationSize;e++)y(i.location+e,a/i.locationSize,h,t,l*u,(d+a/i.locationSize*e)*u)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)g(i.location+e,s.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<i.locationSize;e++)m(i.location+e);e.bindBuffer(34962,c);for(let e=0;e<i.locationSize;e++)y(i.location+e,a/i.locationSize,h,t,a*u,a/i.locationSize*e*u)}}else if(void 0!==h){let n=h[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(i.location,n);break;case 3:e.vertexAttrib3fv(i.location,n);break;case 4:e.vertexAttrib4fv(i.location,n);break;default:e.vertexAttrib1fv(i.location,n)}}}}v()}(r,l,d,b),null!==w&&e.bindBuffer(34963,n.get(w).buffer))},reset:b,resetDefaultState:w,dispose:function(){b();for(let e in o){let t=o[e];for(let e in t){let n=t[e];for(let e in n)d(n[e].object),delete n[e];delete t[e]}delete o[e]}},releaseStatesOfGeometry:function(e){if(void 0===o[e.id])return;let t=o[e.id];for(let n in t){let e=t[n];for(let t in e)d(e[t].object),delete e[t];delete t[n]}delete o[e.id]},releaseStatesOfProgram:function(e){for(let t in o){let n=o[t];if(void 0===n[e.id])continue;let i=n[e.id];for(let e in i)d(i[e].object),delete i[e];delete n[e.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:v}}function aa(e,t,n,i){let r,s=i.isWebGL2;this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=function(i,a,o){if(0===o)return;let l,c;if(s)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](r,i,a,o),n.update(a,r,o)}}function oa(e,t,n){let i;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let s=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,a=void 0!==n.precision?n.precision:"highp",o=r(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);let l=s||t.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,h=e.getParameter(34930),u=e.getParameter(35660),d=e.getParameter(3379),p=e.getParameter(34076),f=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),v=e.getParameter(36349),y=u>0,b=s||t.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){let n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:u,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:s?e.getParameter(36183):0}}function la(e){let t=this,n=null,i=0,r=!1,s=!1,a=new Ks,o=new pi,l={value:null,needsUpdate:!1};function c(e,n,i,r){let s=null!==e?e.length:0,c=null;if(0!==s){if(c=l.value,!0!==r||null===c){let t=i+4*s,r=n.matrixWorldInverse;o.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=i;n!==s;++n,l+=4)a.copy(e[n]).applyMatrix4(r,o),a.normal.toArray(c,l),c[l+3]=a.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){let n=0!==e.length||t||0!==i||r;return r=t,i=e.length,n},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(a,o,h){let u=a.clippingPlanes,d=a.clipIntersection,p=a.clipShadows,f=e.get(a);if(!r||null===u||0===u.length||s&&!p)s?c(null):(l.value!==n&&(l.value=n,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0);else{let e=s?0:i,t=4*e,r=f.clippingState||null;l.value=r,r=c(u,o,t,h);for(let i=0;i!==t;++i)r[i]=n[i];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function ca(e){let t=new WeakMap;function n(e,t){return 303===t?e.mapping=on:304===t&&(e.mapping=ln),e}function i(e){let n=e.target;n.removeEventListener("dispose",i);let r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){let s=r.mapping;if(303===s||304===s){if(t.has(r)){return n(t.get(r).texture,r.mapping)}{let s=r.image;if(s&&s.height>0){let a=new Hs(s.height/2);return a.fromEquirectangularTexture(e,r),t.set(r,a),r.addEventListener("dispose",i),n(a.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}var ha=class extends Us{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-e,s=n+e,a=i+t,o=i-t;if(null!==this.view&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,a-=t*this.view.offsetY,o=a-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}},ua=[.125,.215,.35,.446,.526,.582],da=20,pa=new ha,fa=new Mi,ma=null,ga=(1+Math.sqrt(5))/2,va=1/ga,ya=[new ji(1,1,1),new ji(-1,1,1),new ji(1,1,-1),new ji(-1,1,-1),new ji(0,ga,va),new ji(0,ga,-va),new ji(va,0,ga),new ji(-va,0,ga),new ji(ga,va,0),new ji(-ga,va,0)],ba=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;ma=this._renderer.getRenderTarget(),this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Ca(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Ea(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(ma),e.scissorTest=!1,xa(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===on||e.mapping===ln?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),ma=this._renderer.getRenderTarget();let n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:gn,minFilter:gn,generateMipmaps:!1,type:En,format:An,encoding:Vn,depthBuffer:!1},i=wa(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=wa(e,t,n);let{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){let t=[],n=[],i=[],r=e,s=e-4+1+ua.length;for(let a=0;a<s;a++){let s=Math.pow(2,r);n.push(s);let o=1/s;a>e-4?o=ua[a-e+4-1]:0===a&&(o=0),i.push(o);let l=1/(s-2),c=-l,h=1+l,u=[c,c,h,c,h,h,c,c,h,h,c,h],d=6,p=6,f=3,m=2,g=1,v=new Float32Array(f*p*d),y=new Float32Array(m*p*d),b=new Float32Array(g*p*d);for(let e=0;e<d;e++){let t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(i,f*p*e),y.set(u,m*p*e);let r=[e,e,e,e,e,e];b.set(r,g*p*e)}let w=new gs;w.setAttribute("position",new ss(v,f)),w.setAttribute("uv",new ss(y,m)),w.setAttribute("faceIndex",new ss(b,g)),t.push(w),r>4&&r--}return{lodPlanes:t,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(e,t,n){let i=new Float32Array(da),r=new ji(0,1,0);return new Bs({name:"SphericalGaussianBlur",defines:{n:da,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:Aa(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(i,e,t)}return i}_compileMaterial(e){let t=new Ns(this._lodPlanes[0],e);this._renderer.compile(t,pa)}_sceneToCubeUV(e,t,n,i){let r=new zs(90,1,t,n),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor(fa),o.toneMapping=0,o.autoClear=!1;let h=new ns({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),u=new Ns(new Os,h),d=!1,p=e.background;p?p.isColor&&(h.color.copy(p),e.background=null,d=!0):(h.color.copy(fa),d=!0);for(let f=0;f<6;f++){let t=f%3;0===t?(r.up.set(0,s[f],0),r.lookAt(a[f],0,0)):1===t?(r.up.set(0,0,s[f]),r.lookAt(0,a[f],0)):(r.up.set(0,s[f],0),r.lookAt(0,0,a[f]));let n=this._cubeSize;xa(i,t*n,f>2?n:0,n,n),o.setRenderTarget(i),d&&o.render(u,r),o.render(e,r)}u.geometry.dispose(),u.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=p}_textureToCubeUV(e,t){let n=this._renderer,i=e.mapping===on||e.mapping===ln;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=Ca()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Ea());let r=i?this._cubemapMaterial:this._equirectMaterial,s=new Ns(this._lodPlanes[0],r);r.uniforms.envMap.value=e;let a=this._cubeSize;xa(t,0,0,3*a,2*a),n.setRenderTarget(t),n.render(s,pa)}_applyPMREM(e){let t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let t=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),n=ya[(i-1)%ya.length];this._blur(e,i-1,i,t,n)}t.autoClear=n}_blur(e,t,n,i,r){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",r),this._halfBlur(s,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,s,a){let o=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");let c=new Ns(this._lodPlanes[i],l),h=l.uniforms,u=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*u):2*Math.PI/39,p=r/d,f=isFinite(r)?1+Math.floor(3*p):da;f>da&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);let m=[],g=0;for(let b=0;b<da;++b){let e=b/p,t=Math.exp(-e*e/2);m.push(t),0===b?g+=t:b<f&&(g+=2*t)}for(let b=0;b<m.length;b++)m[b]=m[b]/g;h.envMap.value=e.texture,h.samples.value=f,h.weights.value=m,h.latitudinal.value="latitudinal"===s,a&&(h.poleAxis.value=a);let{_lodMax:v}=this;h.dTheta.value=d,h.mipInt.value=v-n;let y=this._sizeLods[i];xa(t,3*y*(i>v-4?i-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(t),o.render(c,pa)}};function wa(e,t,n){let i=new Bi(e,t,n);return i.texture.mapping=cn,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function xa(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function Ea(){return new Bs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Aa(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Ca(){return new Bs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Aa(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Aa(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function Sa(e){let t=new WeakMap,n=null;function i(e){let n=e.target;n.removeEventListener("dispose",i);let r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){let s=r.mapping,a=303===s||304===s,o=s===on||s===ln;if(a||o){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let i=t.get(r);return null===n&&(n=new ba(e)),i=a?n.fromEquirectangular(r,i):n.fromCubemap(r,i),t.set(r,i),i.texture}if(t.has(r))return t.get(r).texture;{let s=r.image;if(a&&s&&s.height>0||o&&s&&function(e){let t=0,n=6;for(let i=0;i<n;i++)void 0!==e[i]&&t++;return t===n}(s)){null===n&&(n=new ba(e));let s=a?n.fromEquirectangular(r):n.fromCubemap(r);return t.set(r,s),r.addEventListener("dispose",i),s.texture}return null}}}return r},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function _a(e){let t={};function n(n){if(void 0!==t[n])return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){let t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Ta(e,t,n,i){let r={},s=new WeakMap;function a(e){let o=e.target;null!==o.index&&t.remove(o.index);for(let n in o.attributes)t.remove(o.attributes[n]);o.removeEventListener("dispose",a),delete r[o.id];let l=s.get(o);l&&(t.remove(l),s.delete(o)),i.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(e){let n=[],i=e.index,r=e.attributes.position,a=0;if(null!==i){let e=i.array;a=i.version;for(let t=0,i=e.length;t<i;t+=3){let i=e[t+0],r=e[t+1],s=e[t+2];n.push(i,r,r,s,s,i)}}else{let e=r.array;a=r.version;for(let t=0,i=e.length/3-1;t<i;t+=3){let e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}let o=new(mi(n)?os:as)(n,1);o.version=a;let l=s.get(e);l&&t.remove(l),s.set(e,o)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",a),r[t.id]=!0,n.memory.geometries++),t},update:function(e){let n=e.attributes;for(let r in n)t.update(n[r],34962);let i=e.morphAttributes;for(let r in i){let e=i[r];for(let n=0,i=e.length;n<i;n++)t.update(e[n],34962)}},getWireframeAttribute:function(e){let t=s.get(e);if(t){let n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return s.get(e)}}}function Pa(e,t,n,i){let r,s,a,o=i.isWebGL2;this.setMode=function(e){r=e},this.setIndex=function(e){s=e.type,a=e.bytesPerElement},this.render=function(t,i){e.drawElements(r,i,s,t*a),n.update(i,r,1)},this.renderInstances=function(i,l,c){if(0===c)return;let h,u;if(o)h=e,u="drawElementsInstanced";else if(h=t.get("ANGLE_instanced_arrays"),u="drawElementsInstancedANGLE",null===h)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[u](r,l,s,i*a,c),n.update(l,r,c)}}function Ma(e){let t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,i){switch(t.calls++,n){case 4:t.triangles+=i*(e/3);break;case 1:t.lines+=i*(e/2);break;case 3:t.lines+=i*(e-1);break;case 2:t.lines+=i*e;break;case 0:t.points+=i*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Na(e,t){return e[0]-t[0]}function Ia(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Oa(e,t,n){let i={},r=new Float32Array(8),s=new WeakMap,a=new ki,o=[];for(let l=0;l<8;l++)o[l]=[l,0];return{update:function(l,c,h,u){let d=l.morphTargetInfluences;if(!0===t.isWebGL2){let i=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,r=void 0!==i?i.length:0,o=s.get(c);if(void 0===o||o.count!==r){let e=function(){v.dispose(),s.delete(c),c.removeEventListener("dispose",e)};void 0!==o&&o.texture.dispose();let n=void 0!==c.morphAttributes.position,i=void 0!==c.morphAttributes.normal,l=void 0!==c.morphAttributes.color,h=c.morphAttributes.position||[],u=c.morphAttributes.normal||[],d=c.morphAttributes.color||[],p=0;!0===n&&(p=1),!0===i&&(p=2),!0===l&&(p=3);let f=c.attributes.position.count*p,m=1;f>t.maxTextureSize&&(m=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);let g=new Float32Array(f*m*4*r),v=new Ui(g,f,m,r);v.type=xn,v.needsUpdate=!0;let y=4*p;for(let t=0;t<r;t++){let e=h[t],r=u[t],s=d[t],o=f*m*4*t;for(let t=0;t<e.count;t++){let c=t*y;!0===n&&(a.fromBufferAttribute(e,t),g[o+c+0]=a.x,g[o+c+1]=a.y,g[o+c+2]=a.z,g[o+c+3]=0),!0===i&&(a.fromBufferAttribute(r,t),g[o+c+4]=a.x,g[o+c+5]=a.y,g[o+c+6]=a.z,g[o+c+7]=0),!0===l&&(a.fromBufferAttribute(s,t),g[o+c+8]=a.x,g[o+c+9]=a.y,g[o+c+10]=a.z,g[o+c+11]=4===s.itemSize?a.w:1)}}o={count:r,texture:v,size:new di(f,m)},s.set(c,o),c.addEventListener("dispose",e)}let l=0;for(let e=0;e<d.length;e++)l+=d[e];let h=c.morphTargetsRelative?1:1-l;u.getUniforms().setValue(e,"morphTargetBaseInfluence",h),u.getUniforms().setValue(e,"morphTargetInfluences",d),u.getUniforms().setValue(e,"morphTargetsTexture",o.texture,n),u.getUniforms().setValue(e,"morphTargetsTextureSize",o.size)}else{let t=void 0===d?0:d.length,n=i[c.id];if(void 0===n||n.length!==t){n=[];for(let e=0;e<t;e++)n[e]=[e,0];i[c.id]=n}for(let e=0;e<t;e++){let t=n[e];t[0]=e,t[1]=d[e]}n.sort(Ia);for(let e=0;e<8;e++)e<t&&n[e][1]?(o[e][0]=n[e][0],o[e][1]=n[e][1]):(o[e][0]=Number.MAX_SAFE_INTEGER,o[e][1]=0);o.sort(Na);let s=c.morphAttributes.position,a=c.morphAttributes.normal,l=0;for(let e=0;e<8;e++){let t=o[e],n=t[0],i=t[1];n!==Number.MAX_SAFE_INTEGER&&i?(s&&c.getAttribute("morphTarget"+e)!==s[n]&&c.setAttribute("morphTarget"+e,s[n]),a&&c.getAttribute("morphNormal"+e)!==a[n]&&c.setAttribute("morphNormal"+e,a[n]),r[e]=i,l+=i):(s&&!0===c.hasAttribute("morphTarget"+e)&&c.deleteAttribute("morphTarget"+e),a&&!0===c.hasAttribute("morphNormal"+e)&&c.deleteAttribute("morphNormal"+e),r[e]=0)}let h=c.morphTargetsRelative?1:1-l;u.getUniforms().setValue(e,"morphTargetBaseInfluence",h),u.getUniforms().setValue(e,"morphTargetInfluences",r)}}}}function Da(e,t,n,i){let r=new WeakMap;function s(e){let t=e.target;t.removeEventListener("dispose",s),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){let a=i.render.frame,o=e.geometry,l=t.get(e,o);return r.get(l)!==a&&(t.update(l),r.set(l,a)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",s)&&e.addEventListener("dispose",s),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),l},dispose:function(){r=new WeakMap}}}var La=new Ri,Ra=new Ui,ka=new class extends Ri{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=pn,this.minFilter=pn,this.wrapR=un,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Ba=new Vs,Ua=[],za=[],Fa=new Float32Array(16),ja=new Float32Array(9),Va=new Float32Array(4);function Ha(e,t,n){let i=e[0];if(null==i||i<=0||i>0)return e;let r=t*n,s=Ua[r];if(void 0===s&&(s=new Float32Array(r),Ua[r]=s),0!==t){i.toArray(s,0);for(let i=1,r=0;i!==t;++i)r+=n,e[i].toArray(s,r)}return s}function Wa(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function Ga(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function qa(e,t){let n=za[t];void 0===n&&(n=new Int32Array(t),za[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function Ka(e,t){let n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Ya(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Wa(n,t))return;e.uniform2fv(this.addr,t),Ga(n,t)}}function Qa(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)(n[0]!==t.r||n[1]!==t.g||n[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Wa(n,t))return;e.uniform3fv(this.addr,t),Ga(n,t)}}function Xa(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Wa(n,t))return;e.uniform4fv(this.addr,t),Ga(n,t)}}function Za(e,t){let n=this.cache,i=t.elements;if(void 0===i){if(Wa(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Ga(n,t)}else{if(Wa(n,i))return;Va.set(i),e.uniformMatrix2fv(this.addr,!1,Va),Ga(n,i)}}function Ja(e,t){let n=this.cache,i=t.elements;if(void 0===i){if(Wa(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Ga(n,t)}else{if(Wa(n,i))return;ja.set(i),e.uniformMatrix3fv(this.addr,!1,ja),Ga(n,i)}}function $a(e,t){let n=this.cache,i=t.elements;if(void 0===i){if(Wa(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Ga(n,t)}else{if(Wa(n,i))return;Fa.set(i),e.uniformMatrix4fv(this.addr,!1,Fa),Ga(n,i)}}function eo(e,t){let n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function to(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Wa(n,t))return;e.uniform2iv(this.addr,t),Ga(n,t)}}function no(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Wa(n,t))return;e.uniform3iv(this.addr,t),Ga(n,t)}}function io(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Wa(n,t))return;e.uniform4iv(this.addr,t),Ga(n,t)}}function ro(e,t){let n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function so(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Wa(n,t))return;e.uniform2uiv(this.addr,t),Ga(n,t)}}function ao(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Wa(n,t))return;e.uniform3uiv(this.addr,t),Ga(n,t)}}function oo(e,t){let n=this.cache;if(void 0!==t.x)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Wa(n,t))return;e.uniform4uiv(this.addr,t),Ga(n,t)}}function lo(e,t,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(t||La,r)}function co(e,t,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||ka,r)}function ho(e,t,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(t||Ba,r)}function uo(e,t,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||Ra,r)}function po(e,t){e.uniform1fv(this.addr,t)}function fo(e,t){let n=Ha(t,this.size,2);e.uniform2fv(this.addr,n)}function mo(e,t){let n=Ha(t,this.size,3);e.uniform3fv(this.addr,n)}function go(e,t){let n=Ha(t,this.size,4);e.uniform4fv(this.addr,n)}function vo(e,t){let n=Ha(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function yo(e,t){let n=Ha(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function bo(e,t){let n=Ha(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function wo(e,t){e.uniform1iv(this.addr,t)}function xo(e,t){e.uniform2iv(this.addr,t)}function Eo(e,t){e.uniform3iv(this.addr,t)}function Co(e,t){e.uniform4iv(this.addr,t)}function Ao(e,t){e.uniform1uiv(this.addr,t)}function So(e,t){e.uniform2uiv(this.addr,t)}function _o(e,t){e.uniform3uiv(this.addr,t)}function To(e,t){e.uniform4uiv(this.addr,t)}function Po(e,t,n){let i=this.cache,r=t.length,s=qa(n,r);Wa(i,s)||(e.uniform1iv(this.addr,s),Ga(i,s));for(let a=0;a!==r;++a)n.setTexture2D(t[a]||La,s[a])}function Mo(e,t,n){let i=this.cache,r=t.length,s=qa(n,r);Wa(i,s)||(e.uniform1iv(this.addr,s),Ga(i,s));for(let a=0;a!==r;++a)n.setTexture3D(t[a]||ka,s[a])}function No(e,t,n){let i=this.cache,r=t.length,s=qa(n,r);Wa(i,s)||(e.uniform1iv(this.addr,s),Ga(i,s));for(let a=0;a!==r;++a)n.setTextureCube(t[a]||Ba,s[a])}function Io(e,t,n){let i=this.cache,r=t.length,s=qa(n,r);Wa(i,s)||(e.uniform1iv(this.addr,s),Ga(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(t[a]||Ra,s[a])}var Oo=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Ka;case 35664:return Ya;case 35665:return Qa;case 35666:return Xa;case 35674:return Za;case 35675:return Ja;case 35676:return $a;case 5124:case 35670:return eo;case 35667:case 35671:return to;case 35668:case 35672:return no;case 35669:case 35673:return io;case 5125:return ro;case 36294:return so;case 36295:return ao;case 36296:return oo;case 35678:case 36198:case 36298:case 36306:case 35682:return lo;case 35679:case 36299:case 36307:return co;case 35680:case 36300:case 36308:case 36293:return ho;case 36289:case 36303:case 36311:case 36292:return uo}}(t.type)}},Do=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return po;case 35664:return fo;case 35665:return mo;case 35666:return go;case 35674:return vo;case 35675:return yo;case 35676:return bo;case 5124:case 35670:return wo;case 35667:case 35671:return xo;case 35668:case 35672:return Eo;case 35669:case 35673:return Co;case 5125:return Ao;case 36294:return So;case 36295:return _o;case 36296:return To;case 35678:case 36198:case 36298:case 36306:case 35682:return Po;case 35679:case 36299:case 36307:return Mo;case 35680:case 36300:case 36308:case 36293:return No;case 36289:case 36303:case 36311:case 36292:return Io}}(t.type)}},Lo=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){if(void 0===t)return;let i=this.seq;for(let r=0,s=i.length;r!==s;++r){let s=i[r];s.setValue(e,t[s.id],n)}}},Ro=/(\w+)(\])?(\[|\.)?/g;function ko(e,t){e.seq.push(t),e.map[t.id]=t}function Bo(e,t,n){let i=e.name,r=i.length;for(Ro.lastIndex=0;;){let s=Ro.exec(i),a=Ro.lastIndex,o=s[1],l="]"===s[2],c=s[3];if(l&&(o|=0),void 0===c||"["===c&&a+2===r){ko(n,void 0===c?new Oo(o,e,t):new Do(o,e,t));break}{let e=n.map[o];void 0===e&&(e=new Lo(o),ko(n,e)),n=e}}}var Uo=class{constructor(e,t){this.seq=[],this.map={};let n=e.getProgramParameter(t,35718);for(let i=0;i<n;++i){let n=e.getActiveUniform(t,i);Bo(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,i){let r=this.map[t];void 0!==r&&r.setValue(e,n,i)}setOptional(e,t,n){let i=t[n];void 0!==i&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,s=t.length;r!==s;++r){let s=t[r],a=n[s.id];!1!==a.needsUpdate&&s.setValue(e,a.value,i)}}static seqWithValue(e,t){let n=[];for(let i=0,r=e.length;i!==r;++i){let r=e[i];r.id in t&&n.push(r)}return n}};function zo(e,t,n){let i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}var Fo=0;function jo(e,t,n){let i=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();if(i&&""===r)return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){let n=e.split("\n"),i=[],r=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let a=r;a<s;a++){let e=a+1;i.push(`${e===t?">":" "} ${e}: ${n[a]}`)}return i.join("\n")}(e.getShaderSource(t),i)}return r}function Vo(e,t){let n=function(e){switch(e){case Vn:return["Linear","( value )"];case Hn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Ho(e,t){let n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Wo(e){return""!==e}function Go(e,t){let n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function qo(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Ko=/^[ \t]*#include +<([\w\d./]+)>/gm;function Yo(e){return e.replace(Ko,Qo)}function Qo(e,t){let n=ea[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Yo(n)}var Xo=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Zo(e){return e.replace(Xo,Jo)}function Jo(e,t,n,i){let r="";for(let s=parseInt(t);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function $o(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function el(e,t,n,i){let r,s,a=e.getContext(),o=n.defines,l=n.vertexShader,c=n.fragmentShader,h=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),u=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case on:case ln:t="ENVMAP_TYPE_CUBE";break;case cn:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),d=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===ln&&(t="ENVMAP_MODE_REFRACTION");return t}(n),p=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),f=function(e){let t=e.envMapCubeUVHeight;if(null===t)return null;let n=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),m=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Wo).join("\n")}(n),g=function(e){let t=[];for(let n in e){let i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(o),v=a.createProgram(),y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(r=[g].filter(Wo).join("\n"),r.length>0&&(r+="\n"),s=[m,g].filter(Wo).join("\n"),s.length>0&&(s+="\n")):(r=[$o(n),"#define SHADER_NAME "+n.shaderName,g,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Wo).join("\n"),s=[m,$o(n),"#define SHADER_NAME "+n.shaderName,g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",n.envMap?"#define "+p:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?ea.tonemapping_pars_fragment:"",0!==n.toneMapping?Ho("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",ea.encodings_pars_fragment,Vo("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Wo).join("\n")),l=Yo(l),l=Go(l,n),l=qo(l,n),c=Yo(c),c=Go(c,n),c=qo(c,n),l=Zo(l),c=Zo(c),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",r=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,s=["#define varying in",n.glslVersion===Qn?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Qn?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+s);let b,w,x=y+s+c,E=zo(a,35633,y+r+l),C=zo(a,35632,x);if(a.attachShader(v,E),a.attachShader(v,C),void 0!==n.index0AttributeName?a.bindAttribLocation(v,0,n.index0AttributeName):!0===n.morphTargets&&a.bindAttribLocation(v,0,"position"),a.linkProgram(v),e.debug.checkShaderErrors){let e=a.getProgramInfoLog(v).trim(),t=a.getShaderInfoLog(E).trim(),n=a.getShaderInfoLog(C).trim(),i=!0,o=!0;if(!1===a.getProgramParameter(v,35714)){i=!1;let t=jo(a,E,"vertex"),n=jo(a,C,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(v,35715)+"\n\nProgram Info Log: "+e+"\n"+t+"\n"+n)}else""!==e?console.warn("THREE.WebGLProgram: Program Info Log:",e):(""===t||""===n)&&(o=!1);o&&(this.diagnostics={runnable:i,programLog:e,vertexShader:{log:t,prefix:r},fragmentShader:{log:n,prefix:s}})}return a.deleteShader(E),a.deleteShader(C),this.getUniforms=function(){return void 0===b&&(b=new Uo(a,v)),b},this.getAttributes=function(){return void 0===w&&(w=function(e,t){let n={},i=e.getProgramParameter(t,35721);for(let r=0;r<i;r++){let i=e.getActiveAttrib(t,r),s=i.name,a=1;35674===i.type&&(a=2),35675===i.type&&(a=3),35676===i.type&&(a=4),n[s]={type:i.type,location:e.getAttribLocation(t,s),locationSize:a}}return n}(a,v)),w},this.destroy=function(){i.releaseStatesOfProgram(this),a.deleteProgram(v),this.program=void 0},this.name=n.shaderName,this.id=Fo++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=E,this.fragmentShader=C,this}var tl=0,nl=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){let t=this.shaderCache,n=t.get(e);return void 0===n&&(n=new il(e),t.set(e,n)),n}},il=class{constructor(e){this.id=tl++,this.code=e,this.usedTimes=0}};function rl(e,t,n,i,r,s,a){let o=new Pr,l=new nl,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures,p=r.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(s,o,c,m,g){let v=m.fog,y=g.geometry,b=s.isMeshStandardMaterial?m.environment:null,w=(s.isMeshStandardMaterial?n:t).get(s.envMap||b),x=w&&w.mapping===cn?w.image.height:null,E=f[s.type];null!==s.precision&&(p=r.getMaxPrecision(s.precision),p!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",p,"instead."));let C,A,S,_,T=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,P=void 0!==T?T.length:0,M=0;if(void 0!==y.morphAttributes.position&&(M=1),void 0!==y.morphAttributes.normal&&(M=2),void 0!==y.morphAttributes.color&&(M=3),E){let e=na[E];C=e.vertexShader,A=e.fragmentShader}else C=s.vertexShader,A=s.fragmentShader,l.update(s),S=l.getVertexShaderID(s),_=l.getFragmentShaderID(s);let N=e.getRenderTarget(),I=s.alphaTest>0,O=s.clearcoat>0,D=s.iridescence>0;return{isWebGL2:h,shaderID:E,shaderName:s.type,vertexShader:C,fragmentShader:A,defines:s.defines,customVertexShaderID:S,customFragmentShaderID:_,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:p,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:d,outputEncoding:null===N?e.outputEncoding:!0===N.isXRRenderTarget?N.texture.encoding:Vn,map:!!s.map,matcap:!!s.matcap,envMap:!!w,envMapMode:w&&w.mapping,envMapCubeUVHeight:x,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,objectSpaceNormalMap:1===s.normalMapType,tangentSpaceNormalMap:0===s.normalMapType,decodeVideoTexture:!!s.map&&!0===s.map.isVideoTexture&&s.map.encoding===Hn,clearcoat:O,clearcoatMap:O&&!!s.clearcoatMap,clearcoatRoughnessMap:O&&!!s.clearcoatRoughnessMap,clearcoatNormalMap:O&&!!s.clearcoatNormalMap,iridescence:D,iridescenceMap:D&&!!s.iridescenceMap,iridescenceThicknessMap:D&&!!s.iridescenceThicknessMap,displacementMap:!!s.displacementMap,roughnessMap:!!s.roughnessMap,metalnessMap:!!s.metalnessMap,specularMap:!!s.specularMap,specularIntensityMap:!!s.specularIntensityMap,specularColorMap:!!s.specularColorMap,opaque:!1===s.transparent&&1===s.blending,alphaMap:!!s.alphaMap,alphaTest:I,gradientMap:!!s.gradientMap,sheen:s.sheen>0,sheenColorMap:!!s.sheenColorMap,sheenRoughnessMap:!!s.sheenRoughnessMap,transmission:s.transmission>0,transmissionMap:!!s.transmissionMap,thicknessMap:!!s.thicknessMap,combine:s.combine,vertexTangents:!!s.normalMap&&!!y.attributes.tangent,vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,vertexUvs:!!s.map||!!s.bumpMap||!!s.normalMap||!!s.specularMap||!!s.alphaMap||!!s.emissiveMap||!!s.roughnessMap||!!s.metalnessMap||!!s.clearcoatMap||!!s.clearcoatRoughnessMap||!!s.clearcoatNormalMap||!!s.iridescenceMap||!!s.iridescenceThicknessMap||!!s.displacementMap||!!s.transmissionMap||!!s.thicknessMap||!!s.specularIntensityMap||!!s.specularColorMap||!!s.sheenColorMap||!!s.sheenRoughnessMap,uvsVertexOnly:!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.transmission>0||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheen>0||s.sheenColorMap||s.sheenRoughnessMap)&&!!s.displacementMap,fog:!!v,useFog:!0===s.fog,fogExp2:v&&v.isFogExp2,flatShading:!!s.flatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:P,morphTextureStride:M,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:s.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:1===s.side,useDepthPacking:!!s.depthPacking,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:s.extensions&&s.extensions.derivatives,extensionFragDepth:s.extensions&&s.extensions.fragDepth,extensionDrawBuffers:s.extensions&&s.extensions.drawBuffers,extensionShaderTextureLOD:s.extensions&&s.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(t){let n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(let e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){o.disableAll(),t.isWebGL2&&o.enable(0),t.supportsVertexTextures&&o.enable(1),t.instancing&&o.enable(2),t.instancingColor&&o.enable(3),t.map&&o.enable(4),t.matcap&&o.enable(5),t.envMap&&o.enable(6),t.lightMap&&o.enable(7),t.aoMap&&o.enable(8),t.emissiveMap&&o.enable(9),t.bumpMap&&o.enable(10),t.normalMap&&o.enable(11),t.objectSpaceNormalMap&&o.enable(12),t.tangentSpaceNormalMap&&o.enable(13),t.clearcoat&&o.enable(14),t.clearcoatMap&&o.enable(15),t.clearcoatRoughnessMap&&o.enable(16),t.clearcoatNormalMap&&o.enable(17),t.iridescence&&o.enable(18),t.iridescenceMap&&o.enable(19),t.iridescenceThicknessMap&&o.enable(20),t.displacementMap&&o.enable(21),t.specularMap&&o.enable(22),t.roughnessMap&&o.enable(23),t.metalnessMap&&o.enable(24),t.gradientMap&&o.enable(25),t.alphaMap&&o.enable(26),t.alphaTest&&o.enable(27),t.vertexColors&&o.enable(28),t.vertexAlphas&&o.enable(29),t.vertexUvs&&o.enable(30),t.vertexTangents&&o.enable(31),t.uvsVertexOnly&&o.enable(32),e.push(o.mask),o.disableAll(),t.fog&&o.enable(0),t.useFog&&o.enable(1),t.flatShading&&o.enable(2),t.logarithmicDepthBuffer&&o.enable(3),t.skinning&&o.enable(4),t.morphTargets&&o.enable(5),t.morphNormals&&o.enable(6),t.morphColors&&o.enable(7),t.premultipliedAlpha&&o.enable(8),t.shadowMapEnabled&&o.enable(9),t.physicallyCorrectLights&&o.enable(10),t.doubleSided&&o.enable(11),t.flipSided&&o.enable(12),t.useDepthPacking&&o.enable(13),t.dithering&&o.enable(14),t.specularIntensityMap&&o.enable(15),t.specularColorMap&&o.enable(16),t.transmission&&o.enable(17),t.transmissionMap&&o.enable(18),t.thicknessMap&&o.enable(19),t.sheen&&o.enable(20),t.sheenColorMap&&o.enable(21),t.sheenRoughnessMap&&o.enable(22),t.decodeVideoTexture&&o.enable(23),t.opaque&&o.enable(24),e.push(o.mask)}(n,t),n.push(e.outputEncoding)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){let t,n=f[e.type];if(n){let e=na[n];t=ks.clone(e.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){let i;for(let e=0,r=c.length;e<r;e++){let t=c[e];if(t.cacheKey===n){i=t,++i.usedTimes;break}}return void 0===i&&(i=new el(e,n,t,s),c.push(i)),i},releaseProgram:function(e){if(0===--e.usedTimes){let t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function sl(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function al(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function ol(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function ll(){let e=[],t=0,n=[],i=[],r=[];function s(n,i,r,s,a,o){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:a,group:o},e[t]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=a,l.group=o),t++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){t=0,n.length=0,i.length=0,r.length=0},push:function(e,t,a,o,l,c){let h=s(e,t,a,o,l,c);a.transmission>0?i.push(h):!0===a.transparent?r.push(h):n.push(h)},unshift:function(e,t,a,o,l,c){let h=s(e,t,a,o,l,c);a.transmission>0?i.unshift(h):!0===a.transparent?r.unshift(h):n.unshift(h)},finish:function(){for(let n=t,i=e.length;n<i;n++){let t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||al),i.length>1&&i.sort(t||ol),r.length>1&&r.sort(t||ol)}}}function cl(){let e=new WeakMap;return{get:function(t,n){let i,r=e.get(t);return void 0===r?(i=new ll,e.set(t,[i])):n>=r.length?(i=new ll,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function hl(){let e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new ji,color:new Mi};break;case"SpotLight":n={position:new ji,direction:new ji,color:new Mi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ji,color:new Mi,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ji,skyColor:new Mi,groundColor:new Mi};break;case"RectAreaLight":n={color:new Mi,position:new ji,halfWidth:new ji,halfHeight:new ji}}return e[t.id]=n,n}}}var ul=0;function dl(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function pl(e,t){let n=new hl,i=function(){let e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new di};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new di,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let l=0;l<9;l++)r.probe.push(new ji);let s=new ji,a=new vr,o=new vr;return{setup:function(s,a){let o=0,l=0,c=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let h=0,u=0,d=0,p=0,f=0,m=0,g=0,v=0,y=0,b=0;s.sort(dl);let w=!0!==a?Math.PI:1;for(let e=0,t=s.length;e<t;e++){let t=s[e],a=t.color,x=t.intensity,E=t.distance,C=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)o+=a.r*x*w,l+=a.g*x*w,c+=a.b*x*w;else if(t.isLightProbe)for(let e=0;e<9;e++)r.probe[e].addScaledVector(t.sh.coefficients[e],x);else if(t.isDirectionalLight){let e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*w),t.castShadow){let e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,r.directionalShadow[h]=n,r.directionalShadowMap[h]=C,r.directionalShadowMatrix[h]=t.shadow.matrix,m++}r.directional[h]=e,h++}else if(t.isSpotLight){let e=n.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(a).multiplyScalar(x*w),e.distance=E,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,r.spot[d]=e;let s=t.shadow;if(t.map&&(r.spotLightMap[y]=t.map,y++,s.updateMatrices(t),t.castShadow&&b++),r.spotLightMatrix[d]=s.matrix,t.castShadow){let e=i.get(t);e.shadowBias=s.bias,e.shadowNormalBias=s.normalBias,e.shadowRadius=s.radius,e.shadowMapSize=s.mapSize,r.spotShadow[d]=e,r.spotShadowMap[d]=C,v++}d++}else if(t.isRectAreaLight){let e=n.get(t);e.color.copy(a).multiplyScalar(x),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),r.rectArea[p]=e,p++}else if(t.isPointLight){let e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*w),e.distance=t.distance,e.decay=t.decay,t.castShadow){let e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,r.pointShadow[u]=n,r.pointShadowMap[u]=C,r.pointShadowMatrix[u]=t.shadow.matrix,g++}r.point[u]=e,u++}else if(t.isHemisphereLight){let e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(x*w),e.groundColor.copy(t.groundColor).multiplyScalar(x*w),r.hemi[f]=e,f++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=ta.LTC_FLOAT_1,r.rectAreaLTC2=ta.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ta.LTC_HALF_1,r.rectAreaLTC2=ta.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=o,r.ambient[1]=l,r.ambient[2]=c;let x=r.hash;(x.directionalLength!==h||x.pointLength!==u||x.spotLength!==d||x.rectAreaLength!==p||x.hemiLength!==f||x.numDirectionalShadows!==m||x.numPointShadows!==g||x.numSpotShadows!==v||x.numSpotMaps!==y)&&(r.directional.length=h,r.spot.length=d,r.rectArea.length=p,r.point.length=u,r.hemi.length=f,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=v,r.spotShadowMap.length=v,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=g,r.spotLightMatrix.length=v+y-b,r.spotLightMap.length=y,r.numSpotLightShadowsWithMaps=b,x.directionalLength=h,x.pointLength=u,x.spotLength=d,x.rectAreaLength=p,x.hemiLength=f,x.numDirectionalShadows=m,x.numPointShadows=g,x.numSpotShadows=v,x.numSpotMaps=y,r.version=ul++)},setupView:function(e,t){let n=0,i=0,l=0,c=0,h=0,u=t.matrixWorldInverse;for(let d=0,p=e.length;d<p;d++){let t=e[d];if(t.isDirectionalLight){let e=r.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),s.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(u),n++}else if(t.isSpotLight){let e=r.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),e.direction.setFromMatrixPosition(t.matrixWorld),s.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(u),l++}else if(t.isRectAreaLight){let e=r.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),o.identity(),a.copy(t.matrixWorld),a.premultiply(u),o.extractRotation(a),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),c++}else if(t.isPointLight){let e=r.point[i];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),i++}else if(t.isHemisphereLight){let e=r.hemi[h];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(u),h++}}},state:r}}function fl(e,t){let n=new pl(e,t),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(e){n.setup(i,e)},setupLightsView:function(e){n.setupView(i,e)},pushLight:function(e){i.push(e)},pushShadow:function(e){r.push(e)}}}function ml(e,t){let n=new WeakMap;return{get:function(i){let r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=n.get(i);return void 0===a?(r=new fl(e,t),n.set(i,[r])):s>=a.length?(r=new fl(e,t),a.push(r)):r=a[s],r},dispose:function(){n=new WeakMap}}}var gl=class extends ts{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Wn,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},vl=class extends ts{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new ji,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};function yl(e,t,n){let i=new Xs,r=new di,s=new di,a=new ki,o=new gl({depthPacking:3201}),l=new vl,c={},h=n.maxTextureSize,u={[Ht]:1,[Wt]:0,[Gt]:2},d=new Bs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new di},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;let f=new gs;f.setAttribute("position",new ss(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new Ns(f,d),g=this;function v(n,i){let s=t.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Bi(r.x,r.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,s,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,s,p,m,null)}function y(t,n,i,r,s,a){let h=null,d=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==d)h=d;else if(h=!0===i.isPointLight?l:o,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){let e=h.uuid,t=n.uuid,i=c[e];void 0===i&&(i={},c[e]=i);let r=i[t];void 0===r&&(r=h.clone(),i[t]=r),h=r}return h.visible=n.visible,h.wireframe=n.wireframe,h.side=3===a?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:u[n.side],h.alphaMap=n.alphaMap,h.alphaTest=n.alphaTest,h.map=n.map,h.clipShadows=n.clipShadows,h.clippingPlanes=n.clippingPlanes,h.clipIntersection=n.clipIntersection,h.displacementMap=n.displacementMap,h.displacementScale=n.displacementScale,h.displacementBias=n.displacementBias,h.wireframeLinewidth=n.wireframeLinewidth,h.linewidth=n.linewidth,!0===i.isPointLight&&!0===h.isMeshDistanceMaterial&&(h.referencePosition.setFromMatrixPosition(i.matrixWorld),h.nearDistance=r,h.farDistance=s),h}function b(n,r,s,a,o){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===o)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);let i=t.update(n),r=n.material;if(Array.isArray(r)){let t=i.groups;for(let l=0,c=t.length;l<c;l++){let c=t[l],h=r[c.materialIndex];if(h&&h.visible){let t=y(n,h,a,s.near,s.far,o);e.renderBufferDirect(s,null,i,t,n,c)}}}else if(r.visible){let t=y(n,r,a,s.near,s.far,o);e.renderBufferDirect(s,null,i,t,n,null)}}let l=n.children;for(let e=0,t=l.length;e<t;e++)b(l[e],r,s,a,o)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,n,o){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===t.length)return;let l=e.getRenderTarget(),c=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let p=0,f=t.length;p<f;p++){let l=t[p],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);let u=c.getFrameExtents();if(r.multiply(u),s.copy(c.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/u.x),r.x=s.x*u.x,c.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/u.y),r.y=s.y*u.y,c.mapSize.y=s.y)),null===c.map){let e=3!==this.type?{minFilter:pn,magFilter:pn}:{};c.map=new Bi(r.x,r.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();let f=c.getViewportCount();for(let e=0;e<f;e++){let t=c.getViewport(e);a.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),d.viewport(a),c.updateMatrices(l,e),i=c.getFrustum(),b(n,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&v(c,o),c.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(l,c,u)}}function bl(e,t,n){let i=n.isWebGL2;let r=new function(){let t=!1,n=new ki,i=null,r=new ki(0,0,0,0);return{setMask:function(n){i!==n&&!t&&(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,s,a,o){!0===o&&(t*=a,i*=a,s*=a),n.set(t,i,s,a),!1===r.equals(n)&&(e.clearColor(t,i,s,a),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},s=new function(){let t=!1,n=null,i=null,r=null;return{setTest:function(e){e?F(2929):j(2929)},setMask:function(i){n!==i&&!t&&(e.depthMask(i),n=i)},setFunc:function(t){if(i!==t){switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:default:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517)}i=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,n=null,i=null,r=null}}},a=new function(){let t=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,c=null;return{setTest:function(e){t||(e?F(2960):j(2960))},setMask:function(i){n!==i&&!t&&(e.stencilMask(i),n=i)},setFunc:function(t,n,a){(i!==t||r!==n||s!==a)&&(e.stencilFunc(t,n,a),i=t,r=n,s=a)},setOp:function(t,n,i){(a!==t||o!==n||l!==i)&&(e.stencilOp(t,n,i),a=t,o=n,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,c=null}}},o=new WeakMap,l=new WeakMap,c={},h={},u=new WeakMap,d=[],p=null,f=!1,m=null,g=null,v=null,y=null,b=null,w=null,x=null,E=!1,C=null,A=null,S=null,_=null,T=null,P=e.getParameter(35661),M=!1,N=0,I=e.getParameter(7938);-1!==I.indexOf("WebGL")?(N=parseFloat(/^WebGL (\d)/.exec(I)[1]),M=N>=1):-1!==I.indexOf("OpenGL ES")&&(N=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),M=N>=2);let O=null,D={},L=e.getParameter(3088),R=e.getParameter(2978),k=(new ki).fromArray(L),B=(new ki).fromArray(R);function U(t,n,i){let r=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let a=0;a<i;a++)e.texImage2D(n+a,0,6408,1,1,0,6408,5121,r);return s}let z={};function F(t){!0!==c[t]&&(e.enable(t),c[t]=!0)}function j(t){!1!==c[t]&&(e.disable(t),c[t]=!1)}z[3553]=U(3553,3553,1),z[34067]=U(34067,34069,6),r.setClear(0,0,0,1),s.setClear(1),a.setClear(0),F(2929),s.setFunc(3),G(!1),q(1),F(2884),W(0);let V={[qt]:32774,[Kt]:32778,[Yt]:32779};if(i)V[103]=32775,V[104]=32776;else{let e=t.get("EXT_blend_minmax");null!==e&&(V[103]=e.MIN_EXT,V[104]=e.MAX_EXT)}let H={[Qt]:0,[Xt]:1,[Zt]:768,[$t]:770,[an]:776,[rn]:774,[tn]:772,[Jt]:769,[en]:771,[sn]:775,[nn]:773};function W(t,n,i,r,s,a,o,l){if(0!==t){if(!1===f&&(F(3042),f=!0),5===t)s=s||n,a=a||i,o=o||r,(n!==g||s!==b)&&(e.blendEquationSeparate(V[n],V[s]),g=n,b=s),(i!==v||r!==y||a!==w||o!==x)&&(e.blendFuncSeparate(H[i],H[r],H[a],H[o]),v=i,y=r,w=a,x=o),m=t,E=!1;else if(t!==m||l!==E){if((g!==qt||b!==qt)&&(e.blendEquation(32774),g=qt,b=qt),l)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,769,0,1);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFuncSeparate(0,769,0,1);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,y=null,w=null,x=null,m=t,E=l}}else!0===f&&(j(3042),f=!1)}function G(t){C!==t&&(t?e.frontFace(2304):e.frontFace(2305),C=t)}function q(t){0!==t?(F(2884),t!==A&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):j(2884),A=t}function K(t,n,i){t?(F(32823),(_!==n||T!==i)&&(e.polygonOffset(n,i),_=n,T=i)):j(32823)}return{buffers:{color:r,depth:s,stencil:a},enable:F,disable:j,bindFramebuffer:function(t,n){return h[t]!==n&&(e.bindFramebuffer(t,n),h[t]=n,i&&(36009===t&&(h[36160]=n),36160===t&&(h[36009]=n)),!0)},drawBuffers:function(i,r){let s=d,a=!1;if(i)if(s=u.get(r),void 0===s&&(s=[],u.set(r,s)),i.isWebGLMultipleRenderTargets){let e=i.texture;if(s.length!==e.length||36064!==s[0]){for(let t=0,n=e.length;t<n;t++)s[t]=36064+t;s.length=e.length,a=!0}}else 36064!==s[0]&&(s[0]=36064,a=!0);else 1029!==s[0]&&(s[0]=1029,a=!0);a&&(n.isWebGL2?e.drawBuffers(s):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:W,setMaterial:function(e,t){2===e.side?j(2884):F(2884);let n=1===e.side;t&&(n=!n),G(n),1===e.blending&&!1===e.transparent?W(0):W(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),r.setMask(e.colorWrite);let i=e.stencilWrite;a.setTest(i),i&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),K(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?F(32926):j(32926)},setFlipSided:G,setCullFace:q,setLineWidth:function(t){t!==S&&(M&&e.lineWidth(t),S=t)},setPolygonOffset:K,setScissorTest:function(e){e?F(3089):j(3089)},activeTexture:function(t){void 0===t&&(t=33984+P-1),O!==t&&(e.activeTexture(t),O=t)},bindTexture:function(t,n,i){void 0===i&&(i=null===O?33984+P-1:O);let r=D[i];void 0===r&&(r={type:void 0,texture:void 0},D[i]=r),(r.type!==t||r.texture!==n)&&(O!==i&&(e.activeTexture(i),O=i),e.bindTexture(t,n||z[t]),r.type=t,r.texture=n)},unbindTexture:function(){let t=D[O];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}},updateUBOMapping:function(t,n){let i=l.get(n);void 0===i&&(i=new WeakMap,l.set(n,i));let r=i.get(t);void 0===r&&(r=e.getUniformBlockIndex(n,t.name),i.set(t,r))},uniformBlockBinding:function(t,n){let i=l.get(n).get(t);o.get(n)!==i&&(e.uniformBlockBinding(n,i,t.__bindingPointIndex),o.set(n,i))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(ut){console.error("THREE.WebGLState:",ut)}},scissor:function(t){!1===k.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),k.copy(t))},viewport:function(t){!1===B.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),B.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===i&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),c={},O=null,D={},h={},u=new WeakMap,d=[],p=null,f=!1,m=null,g=null,v=null,y=null,b=null,w=null,x=null,E=!1,C=null,A=null,S=null,_=null,T=null,k.set(0,0,e.canvas.width,e.canvas.height),B.set(0,0,e.canvas.width,e.canvas.height),r.reset(),s.reset(),a.reset()}}}function wl(e,t,n,i,r,s,a){let o,l=r.isWebGL2,c=r.maxTextures,h=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,p=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap,g=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function y(e,t){return v?new OffscreenCanvas(e,t):yi("canvas")}function b(e,t,n,i){let r=1;if((e.width>i||e.height>i)&&(r=i/Math.max(e.width,e.height)),r<1||!0===t){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let i=t?li:Math.floor,s=i(r*e.width),a=i(r*e.height);void 0===o&&(o=y(s,a));let l=n?y(s,a):o;return l.width=s,l.height=a,l.getContext("2d").drawImage(e,0,0,s,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+s+"x"+a+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function w(e){return ai(e.width)&&ai(e.height)}function x(e,t){return e.generateMipmaps&&t&&e.minFilter!==pn&&e.minFilter!==gn}function E(t){e.generateMipmap(t)}function C(n,i,r,s){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===l)return i;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=i;return 6403===i&&(5126===r&&(o=33326),5131===r&&(o=33325),5121===r&&(o=33321)),33319===i&&(5126===r&&(o=33328),5131===r&&(o=33327),5121===r&&(o=33323)),6408===i&&(5126===r&&(o=34836),5131===r&&(o=34842),5121===r&&(o=s===Hn&&!1===a?35907:32856),32819===r&&(o=32854),32820===r&&(o=32855)),(33325===o||33326===o||33327===o||33328===o||34842===o||34836===o)&&t.get("EXT_color_buffer_float"),o}function A(e,t,n){return!0===x(e,n)||e.isFramebufferTexture&&e.minFilter!==pn&&e.minFilter!==gn?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function S(e){return e===pn||1004===e||e===mn?9728:9729}function _(e){let t=e.target;t.removeEventListener("dispose",_),function(e){let t=i.get(e);if(void 0===t.__webglInit)return;let n=e.source,r=g.get(n);if(r){let i=r[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&P(e),0===Object.keys(r).length&&g.delete(n)}i.remove(e)}(t),t.isVideoTexture&&m.delete(t)}function T(t){let n=t.target;n.removeEventListener("dispose",T),function(t){let n=t.texture,r=i.get(t),s=i.get(n);if(void 0!==s.__webglTexture&&(e.deleteTexture(s.__webglTexture),a.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let i=0;i<6;i++)e.deleteFramebuffer(r.__webglFramebuffer[i]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[i]);else{if(e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let t=0;t<r.__webglColorRenderbuffer.length;t++)r.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(r.__webglColorRenderbuffer[t]);r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let o=0,l=n.length;o<l;o++){let t=i.get(n[o]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),a.memory.textures--),i.remove(n[o])}i.remove(n),i.remove(t)}(n)}function P(t){let n=i.get(t);e.deleteTexture(n.__webglTexture);let r=t.source;delete g.get(r)[n.__cacheKey],a.memory.textures--}let M=0;function N(e,t){let r=i.get(e);if(e.isVideoTexture&&function(e){let t=a.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&r.__version!==e.version){let n=e.image;if(null===n)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==n.complete)return void R(r,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(3553,r.__webglTexture,33984+t)}let I={[hn]:10497,[un]:33071,[dn]:33648},O={[pn]:9728,[fn]:9984,[mn]:9986,[gn]:9729,[vn]:9985,[yn]:9987};function D(n,s,a){if(a?(e.texParameteri(n,10242,I[s.wrapS]),e.texParameteri(n,10243,I[s.wrapT]),(32879===n||35866===n)&&e.texParameteri(n,32882,I[s.wrapR]),e.texParameteri(n,10240,O[s.magFilter]),e.texParameteri(n,10241,O[s.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),(32879===n||35866===n)&&e.texParameteri(n,32882,33071),(s.wrapS!==un||s.wrapT!==un)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,S(s.magFilter)),e.texParameteri(n,10241,S(s.minFilter)),s.minFilter!==pn&&s.minFilter!==gn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){let a=t.get("EXT_texture_filter_anisotropic");if(s.magFilter===pn||s.minFilter!==mn&&s.minFilter!==yn||s.type===xn&&!1===t.has("OES_texture_float_linear")||!1===l&&s.type===En&&!1===t.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(e.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function L(t,n){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",_));let r=n.source,s=g.get(r);void 0===s&&(s={},g.set(r,s));let o=function(e){let t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(n);if(o!==t.__cacheKey){void 0===s[o]&&(s[o]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,i=!0),s[o].usedTimes++;let r=s[t.__cacheKey];void 0!==r&&(s[t.__cacheKey].usedTimes--,0===r.usedTimes&&P(n)),t.__cacheKey=o,t.__webglTexture=s[o].texture}return i}function R(t,r,a){let o=3553;(r.isDataArrayTexture||r.isCompressedArrayTexture)&&(o=35866),r.isData3DTexture&&(o=32879);let c=L(t,r),h=r.source;n.bindTexture(o,t.__webglTexture,33984+a);let d=i.get(h);if(h.version!==d.__version||!0===c){n.activeTexture(33984+a),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);let t=function(e){return!l&&(e.wrapS!==un||e.wrapT!==un||e.minFilter!==pn&&e.minFilter!==gn)}(r)&&!1===w(r.image),i=b(r.image,t,!1,u);i=j(r,i);let p=w(i)||l,f=s.convert(r.format,r.encoding),m=s.convert(r.type),g=C(r.internalFormat,f,m,r.encoding,r.isVideoTexture);D(o,r,p);let v,y=r.mipmaps,S=l&&!0!==r.isVideoTexture,_=void 0===d.__version||!0===c,T=A(r,i,p);if(r.isDepthTexture)g=6402,l?g=r.type===xn?36012:r.type===wn?33190:r.type===Cn?35056:33189:r.type===xn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===Sn&&6402===g&&1012!==r.type&&r.type!==wn&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=wn,m=s.convert(r.type)),r.format===_n&&6402===g&&(g=34041,r.type!==Cn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Cn,m=s.convert(r.type))),_&&(S?n.texStorage2D(3553,1,g,i.width,i.height):n.texImage2D(3553,0,g,i.width,i.height,0,f,m,null));else if(r.isDataTexture)if(y.length>0&&p){S&&_&&n.texStorage2D(3553,T,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],S?n.texSubImage2D(3553,e,0,0,v.width,v.height,f,m,v.data):n.texImage2D(3553,e,g,v.width,v.height,0,f,m,v.data);r.generateMipmaps=!1}else S?(_&&n.texStorage2D(3553,T,g,i.width,i.height),n.texSubImage2D(3553,0,0,0,i.width,i.height,f,m,i.data)):n.texImage2D(3553,0,g,i.width,i.height,0,f,m,i.data);else if(r.isCompressedTexture)if(r.isCompressedArrayTexture){S&&_&&n.texStorage3D(35866,T,g,y[0].width,y[0].height,i.depth);for(let e=0,t=y.length;e<t;e++)v=y[e],r.format!==An?null!==f?S?n.compressedTexSubImage3D(35866,e,0,0,0,v.width,v.height,i.depth,f,v.data,0,0):n.compressedTexImage3D(35866,e,g,v.width,v.height,i.depth,0,v.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):S?n.texSubImage3D(35866,e,0,0,0,v.width,v.height,i.depth,f,m,v.data):n.texImage3D(35866,e,g,v.width,v.height,i.depth,0,f,m,v.data)}else{S&&_&&n.texStorage2D(3553,T,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],r.format!==An?null!==f?S?n.compressedTexSubImage2D(3553,e,0,0,v.width,v.height,f,v.data):n.compressedTexImage2D(3553,e,g,v.width,v.height,0,v.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):S?n.texSubImage2D(3553,e,0,0,v.width,v.height,f,m,v.data):n.texImage2D(3553,e,g,v.width,v.height,0,f,m,v.data)}else if(r.isDataArrayTexture)S?(_&&n.texStorage3D(35866,T,g,i.width,i.height,i.depth),n.texSubImage3D(35866,0,0,0,0,i.width,i.height,i.depth,f,m,i.data)):n.texImage3D(35866,0,g,i.width,i.height,i.depth,0,f,m,i.data);else if(r.isData3DTexture)S?(_&&n.texStorage3D(32879,T,g,i.width,i.height,i.depth),n.texSubImage3D(32879,0,0,0,0,i.width,i.height,i.depth,f,m,i.data)):n.texImage3D(32879,0,g,i.width,i.height,i.depth,0,f,m,i.data);else if(r.isFramebufferTexture){if(_)if(S)n.texStorage2D(3553,T,g,i.width,i.height);else{let e=i.width,t=i.height;for(let i=0;i<T;i++)n.texImage2D(3553,i,g,e,t,0,f,m,null),e>>=1,t>>=1}}else if(y.length>0&&p){S&&_&&n.texStorage2D(3553,T,g,y[0].width,y[0].height);for(let e=0,t=y.length;e<t;e++)v=y[e],S?n.texSubImage2D(3553,e,0,0,f,m,v):n.texImage2D(3553,e,g,f,m,v);r.generateMipmaps=!1}else S?(_&&n.texStorage2D(3553,T,g,i.width,i.height),n.texSubImage2D(3553,0,0,0,f,m,i)):n.texImage2D(3553,0,g,f,m,i);x(r,p)&&E(o),d.__version=h.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}function k(t,r,a,o,l){let c=s.convert(a.format,a.encoding),h=s.convert(a.type),u=C(a.internalFormat,c,h,a.encoding);i.get(r).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,u,r.width,r.height,r.depth,0,c,h,null):n.texImage2D(l,0,u,r.width,r.height,0,c,h,null)),n.bindFramebuffer(36160,t),F(r)?p.framebufferTexture2DMultisampleEXT(36160,o,l,i.get(a).__webglTexture,0,z(r)):(3553===l||l>=34069&&l<=34074)&&e.framebufferTexture2D(36160,o,l,i.get(a).__webglTexture,0),n.bindFramebuffer(36160,null)}function B(t,n,i){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let r=33189;if(i||F(n)){let t=n.depthTexture;t&&t.isDepthTexture&&(t.type===xn?r=36012:t.type===wn&&(r=33190));let i=z(n);F(n)?p.renderbufferStorageMultisampleEXT(36161,i,r,n.width,n.height):e.renderbufferStorageMultisample(36161,i,r,n.width,n.height)}else e.renderbufferStorage(36161,r,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){let r=z(n);i&&!1===F(n)?e.renderbufferStorageMultisample(36161,r,35056,n.width,n.height):F(n)?p.renderbufferStorageMultisampleEXT(36161,r,35056,n.width,n.height):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{let t=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let r=0;r<t.length;r++){let a=t[r],o=s.convert(a.format,a.encoding),l=s.convert(a.type),c=C(a.internalFormat,o,l,a.encoding),h=z(n);i&&!1===F(n)?e.renderbufferStorageMultisample(36161,h,c,n.width,n.height):F(n)?p.renderbufferStorageMultisampleEXT(36161,h,c,n.width,n.height):e.renderbufferStorage(36161,c,n.width,n.height)}}e.bindRenderbuffer(36161,null)}function U(t){let r=i.get(t),s=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(r.depthTexture).__webglTexture||r.depthTexture.image.width!==r.width||r.depthTexture.image.height!==r.height)&&(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),N(r.depthTexture,0);let s=i.get(r.depthTexture).__webglTexture,a=z(r);if(r.depthTexture.format===Sn)F(r)?p.framebufferTexture2DMultisampleEXT(36160,36096,3553,s,0,a):e.framebufferTexture2D(36160,36096,3553,s,0);else{if(r.depthTexture.format!==_n)throw new Error("Unknown depthTexture format");F(r)?p.framebufferTexture2DMultisampleEXT(36160,33306,3553,s,0,a):e.framebufferTexture2D(36160,33306,3553,s,0)}}(r.__webglFramebuffer,t)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(36160,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=e.createRenderbuffer(),B(r.__webglDepthbuffer[i],t,!1)}else n.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),B(r.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function z(e){return Math.min(d,e.samples)}function F(e){let n=i.get(e);return l&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function j(e,n){let i=e.encoding,r=e.format,s=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===Xn||i!==Vn&&(i===Hn?!1===l?!0===t.has("EXT_sRGB")&&r===An?(e.format=Xn,e.minFilter=gn,e.generateMipmaps=!1):n=Ii.sRGBToLinear(n):(r!==An||s!==bn)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",i)),n}this.allocateTextureUnit=function(){let e=M;return e>=c&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+c),M+=1,e},this.resetTextureUnits=function(){M=0},this.setTexture2D=N,this.setTexture2DArray=function(e,t){let r=i.get(e);e.version>0&&r.__version!==e.version?R(r,e,t):n.bindTexture(35866,r.__webglTexture,33984+t)},this.setTexture3D=function(e,t){let r=i.get(e);e.version>0&&r.__version!==e.version?R(r,e,t):n.bindTexture(32879,r.__webglTexture,33984+t)},this.setTextureCube=function(t,r){let a=i.get(t);t.version>0&&a.__version!==t.version?function(t,r,a){if(6!==r.image.length)return;let o=L(t,r),c=r.source;n.bindTexture(34067,t.__webglTexture,33984+a);let u=i.get(c);if(c.version!==u.__version||!0===o){n.activeTexture(33984+a),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);let t=r.isCompressedTexture||r.image[0].isCompressedTexture,i=r.image[0]&&r.image[0].isDataTexture,d=[];for(let e=0;e<6;e++)d[e]=t||i?i?r.image[e].image:r.image[e]:b(r.image[e],!1,!0,h),d[e]=j(r,d[e]);let p,f=d[0],m=w(f)||l,g=s.convert(r.format,r.encoding),v=s.convert(r.type),y=C(r.internalFormat,g,v,r.encoding),S=l&&!0!==r.isVideoTexture,_=void 0===u.__version||!0===o,T=A(r,f,m);if(D(34067,r,m),t){S&&_&&n.texStorage2D(34067,T,y,f.width,f.height);for(let e=0;e<6;e++){p=d[e].mipmaps;for(let t=0;t<p.length;t++){let i=p[t];r.format!==An?null!==g?S?n.compressedTexSubImage2D(34069+e,t,0,0,i.width,i.height,g,i.data):n.compressedTexImage2D(34069+e,t,y,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):S?n.texSubImage2D(34069+e,t,0,0,i.width,i.height,g,v,i.data):n.texImage2D(34069+e,t,y,i.width,i.height,0,g,v,i.data)}}}else{p=r.mipmaps,S&&_&&(p.length>0&&T++,n.texStorage2D(34067,T,y,d[0].width,d[0].height));for(let e=0;e<6;e++)if(i){S?n.texSubImage2D(34069+e,0,0,0,d[e].width,d[e].height,g,v,d[e].data):n.texImage2D(34069+e,0,y,d[e].width,d[e].height,0,g,v,d[e].data);for(let t=0;t<p.length;t++){let i=p[t].image[e].image;S?n.texSubImage2D(34069+e,t+1,0,0,i.width,i.height,g,v,i.data):n.texImage2D(34069+e,t+1,y,i.width,i.height,0,g,v,i.data)}}else{S?n.texSubImage2D(34069+e,0,0,0,g,v,d[e]):n.texImage2D(34069+e,0,y,g,v,d[e]);for(let t=0;t<p.length;t++){let i=p[t];S?n.texSubImage2D(34069+e,t+1,0,0,g,v,i.image[e]):n.texImage2D(34069+e,t+1,y,g,v,i.image[e])}}}x(r,m)&&E(34067),u.__version=c.version,r.onUpdate&&r.onUpdate(r)}t.__version=r.version}(a,t,r):n.bindTexture(34067,a.__webglTexture,33984+r)},this.rebindTextures=function(e,t,n){let r=i.get(e);void 0!==t&&k(r.__webglFramebuffer,e,e.texture,36064,3553),void 0!==n&&U(e)},this.setupRenderTarget=function(t){let o=t.texture,c=i.get(t),h=i.get(o);t.addEventListener("dispose",T),!0!==t.isWebGLMultipleRenderTargets&&(void 0===h.__webglTexture&&(h.__webglTexture=e.createTexture()),h.__version=o.version,a.memory.textures++);let u=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,p=w(t)||l;if(u){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else{if(c.__webglFramebuffer=e.createFramebuffer(),d)if(r.drawBuffers){let n=t.texture;for(let t=0,r=n.length;t<r;t++){let r=i.get(n[t]);void 0===r.__webglTexture&&(r.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&t.samples>0&&!1===F(t)){let i=d?o:[o];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer);for(let n=0;n<i.length;n++){let r=i[n];c.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer[n]);let a=s.convert(r.format,r.encoding),o=s.convert(r.type),l=C(r.internalFormat,a,o,r.encoding,!0===t.isXRRenderTarget),h=z(t);e.renderbufferStorageMultisample(36161,h,l,t.width,t.height),e.framebufferRenderbuffer(36160,36064+n,36161,c.__webglColorRenderbuffer[n])}e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),B(c.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}}if(u){n.bindTexture(34067,h.__webglTexture),D(34067,o,p);for(let e=0;e<6;e++)k(c.__webglFramebuffer[e],t,o,36064,34069+e);x(o,p)&&E(34067),n.unbindTexture()}else if(d){let e=t.texture;for(let r=0,s=e.length;r<s;r++){let s=e[r],a=i.get(s);n.bindTexture(3553,a.__webglTexture),D(3553,s,p),k(c.__webglFramebuffer,t,s,36064+r,3553),x(s,p)&&E(3553)}n.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l?e=t.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(e,h.__webglTexture),D(e,o,p),k(c.__webglFramebuffer,t,o,36064,e),x(o,p)&&E(e),n.unbindTexture()}t.depthBuffer&&U(t)},this.updateRenderTargetMipmap=function(e){let t=w(e)||l,r=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let s=0,a=r.length;s<a;s++){let a=r[s];if(x(a,t)){let t=e.isWebGLCubeRenderTarget?34067:3553,r=i.get(a).__webglTexture;n.bindTexture(t,r),E(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(l&&t.samples>0&&!1===F(t)){let r=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],s=t.width,a=t.height,o=16384,l=[],c=t.stencilBuffer?33306:36096,h=i.get(t),u=!0===t.isWebGLMultipleRenderTargets;if(u)for(let t=0;t<r.length;t++)n.bindFramebuffer(36160,h.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,null),n.bindFramebuffer(36160,h.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,null,0);n.bindFramebuffer(36008,h.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,h.__webglFramebuffer);for(let n=0;n<r.length;n++){l.push(36064+n),t.depthBuffer&&l.push(c);let d=void 0!==h.__ignoreDepthValues&&h.__ignoreDepthValues;if(!1===d&&(t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024)),u&&e.framebufferRenderbuffer(36008,36064,36161,h.__webglColorRenderbuffer[n]),!0===d&&(e.invalidateFramebuffer(36008,[c]),e.invalidateFramebuffer(36009,[c])),u){let t=i.get(r[n]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,t,0)}e.blitFramebuffer(0,0,s,a,0,0,s,a,o,9728),f&&e.invalidateFramebuffer(36008,l)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),u)for(let t=0;t<r.length;t++){n.bindFramebuffer(36160,h.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+t,36161,h.__webglColorRenderbuffer[t]);let s=i.get(r[t]).__webglTexture;n.bindFramebuffer(36160,h.__webglFramebuffer),e.framebufferTexture2D(36009,36064+t,3553,s,0)}n.bindFramebuffer(36009,h.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=U,this.setupFrameBufferTexture=k,this.useMultisampledRTT=F}function xl(e,t,n){let i=n.isWebGL2;return{convert:function(n){let r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n===bn)return 5121;if(1017===n)return 32819;if(1018===n)return 32820;if(1010===n)return 5120;if(1011===n)return 5122;if(1012===n)return 5123;if(1013===n)return 5124;if(n===wn)return 5125;if(n===xn)return 5126;if(n===En)return i?5131:(r=t.get("OES_texture_half_float"),null!==r?r.HALF_FLOAT_OES:null);if(1021===n)return 6406;if(n===An)return 6408;if(1024===n)return 6409;if(1025===n)return 6410;if(n===Sn)return 6402;if(n===_n)return 34041;if(n===Xn)return r=t.get("EXT_sRGB"),null!==r?r.SRGB_ALPHA_EXT:null;if(n===Tn)return 6403;if(1029===n)return 36244;if(n===Pn)return 33319;if(1031===n)return 33320;if(1033===n)return 36249;if(n===Mn||n===Nn||n===In||n===On)if(s===Hn){if(r=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(n===Mn)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Nn)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===In)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===On)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=t.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(n===Mn)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Nn)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===In)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===On)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===n||35841===n||35842===n||35843===n){if(r=t.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(35840===n)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===n)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===n)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===n)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===n)return r=t.get("WEBGL_compressed_texture_etc1"),null!==r?r.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===n||37496===n){if(r=t.get("WEBGL_compressed_texture_etc"),null===r)return null;if(37492===n)return s===Hn?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(37496===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(37808===n||37809===n||37810===n||37811===n||37812===n||37813===n||37814===n||37815===n||37816===n||37817===n||37818===n||37819===n||37820===n||37821===n){if(r=t.get("WEBGL_compressed_texture_astc"),null===r)return null;if(37808===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===n)return s===Hn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===Dn){if(r=t.get("EXT_texture_compression_bptc"),null===r)return null;if(n===Dn)return s===Hn?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===n||36284===n||36285===n||36286===n){if(r=t.get("EXT_texture_compression_rgtc"),null===r)return null;if(n===Dn)return r.COMPRESSED_RED_RGTC1_EXT;if(36284===n)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===n)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===n)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===Cn?i?34042:(r=t.get("WEBGL_depth_texture"),null!==r?r.UNSIGNED_INT_24_8_WEBGL:null):void 0!==e[n]?e[n]:null}}}var El=class extends zs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.cameras=e}},Cl=class extends Vr{constructor(){super(),this.isGroup=!0,this.type="Group"}},Al={type:"move"},Sl=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Cl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Cl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ji,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ji),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Cl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ji,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ji),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(let s of e.hand.values()){let e=t.getJointPose(s,n),i=this._getHandJoint(l,s);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=e.radius),i.visible=null!==e}let i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=i.position.distanceTo(r.position),o=.02,c=.005;l.inputState.pinching&&a>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&a<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(i=t.getPose(e.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Al)))}return null!==a&&(a.visible=null!==i),null!==o&&(o.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){let n=new Cl;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}},_l=class extends Ri{constructor(e,t,n,i,r,s,a,o,l,c){if((c=void 0!==c?c:Sn)!==Sn&&c!==_n)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Sn&&(n=wn),void 0===n&&c===_n&&(n=Cn),super(null,i,r,s,a,o,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:pn,this.minFilter=void 0!==o?o:pn,this.flipY=!1,this.generateMipmaps=!1}},Tl=class extends Zn{constructor(e,t){super();let n=this,i=null,r=1,s=null,a="local-floor",o=1,l=null,c=null,h=null,u=null,d=null,p=null,f=t.getContextAttributes(),m=null,g=null,v=[],y=[],b=new Set,w=new Map,x=new zs;x.layers.enable(1),x.viewport=new ki;let E=new zs;E.layers.enable(2),E.viewport=new ki;let C=[x,E],A=new El;A.layers.enable(1),A.layers.enable(2);let S=null,_=null;function T(e){let t=y.indexOf(e.inputSource);if(-1===t)return;let n=v[t];void 0!==n&&n.dispatchEvent({type:e.type,data:e.inputSource})}function P(){i.removeEventListener("select",T),i.removeEventListener("selectstart",T),i.removeEventListener("selectend",T),i.removeEventListener("squeeze",T),i.removeEventListener("squeezestart",T),i.removeEventListener("squeezeend",T),i.removeEventListener("end",P),i.removeEventListener("inputsourceschange",M);for(let e=0;e<v.length;e++){let t=y[e];null!==t&&(y[e]=null,v[e].disconnect(t))}S=null,_=null,e.setRenderTarget(m),d=null,u=null,h=null,i=null,g=null,L.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function M(e){for(let t=0;t<e.removed.length;t++){let n=e.removed[t],i=y.indexOf(n);i>=0&&(y[i]=null,v[i].disconnect(n))}for(let t=0;t<e.added.length;t++){let n=e.added[t],i=y.indexOf(n);if(-1===i){for(let e=0;e<v.length;e++){if(e>=y.length){y.push(n),i=e;break}if(null===y[e]){y[e]=n,i=e;break}}if(-1===i)break}let r=v[i];r&&r.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=v[e];return void 0===t&&(t=new Sl,v[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=v[e];return void 0===t&&(t=new Sl,v[e]=t),t.getGripSpace()},this.getHand=function(e){let t=v[e];return void 0===t&&(t=new Sl,v[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){a=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==u?u:d},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(c){if(i=c,null!==i){if(m=e.getRenderTarget(),i.addEventListener("select",T),i.addEventListener("selectstart",T),i.addEventListener("selectend",T),i.addEventListener("squeeze",T),i.addEventListener("squeezestart",T),i.addEventListener("squeezeend",T),i.addEventListener("end",P),i.addEventListener("inputsourceschange",M),!0!==f.xrCompatible&&await t.makeXRCompatible(),void 0===i.renderState.layers||!1===e.capabilities.isWebGL2){let n={antialias:void 0!==i.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(i,t,n),i.updateRenderState({baseLayer:d}),g=new Bi(d.framebufferWidth,d.framebufferHeight,{format:An,type:bn,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let n=null,s=null,a=null;f.depth&&(a=f.stencil?35056:33190,n=f.stencil?_n:Sn,s=f.stencil?Cn:wn);let o={colorFormat:32856,depthFormat:a,scaleFactor:r};h=new XRWebGLBinding(i,t),u=h.createProjectionLayer(o),i.updateRenderState({layers:[u]}),g=new Bi(u.textureWidth,u.textureHeight,{format:An,type:bn,depthTexture:new _l(u.textureWidth,u.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=u.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),L.setContext(i),L.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};let N=new ji,I=new ji;function O(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===i)return;A.near=E.near=x.near=e.near,A.far=E.far=x.far=e.far,(S!==A.near||_!==A.far)&&(i.updateRenderState({depthNear:A.near,depthFar:A.far}),S=A.near,_=A.far);let t=e.parent,n=A.cameras;O(A,t);for(let i=0;i<n.length;i++)O(n[i],t);A.matrixWorld.decompose(A.position,A.quaternion,A.scale),e.matrix.copy(A.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);let r=e.children;for(let i=0,s=r.length;i<s;i++)r[i].updateMatrixWorld(!0);2===n.length?function(e,t,n){N.setFromMatrixPosition(t.matrixWorld),I.setFromMatrixPosition(n.matrixWorld);let i=N.distanceTo(I),r=t.projectionMatrix.elements,s=n.projectionMatrix.elements,a=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],h=(r[8]-1)/r[0],u=(s[8]+1)/s[0],d=a*h,p=a*u,f=i/(-h+u),m=f*-h;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();let g=a+f,v=o+f,y=d-m,b=p+(i-m),w=l*o/v*g,x=c*o/v*g;e.projectionMatrix.makePerspective(y,b,w,x,g,v)}(A,x,E):A.projectionMatrix.copy(x.projectionMatrix)},this.getCamera=function(){return A},this.getFoveation=function(){if(null!==u||null!==d)return o},this.setFoveation=function(e){o=e,null!==u&&(u.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.getPlanes=function(){return b};let D=null;let L=new Zs;L.setAnimationLoop((function(t,i){if(c=i.getViewerPose(l||s),p=i,null!==c){let t=c.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let n=!1;t.length!==A.cameras.length&&(A.cameras.length=0,n=!0);for(let i=0;i<t.length;i++){let r=t[i],s=null;if(null!==d)s=d.getViewport(r);else{let t=h.getViewSubImage(u,r);s=t.viewport,0===i&&(e.setRenderTargetTextures(g,t.colorTexture,u.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}let a=C[i];void 0===a&&(a=new zs,a.layers.enable(i),a.viewport=new ki,C[i]=a),a.matrix.fromArray(r.transform.matrix),a.projectionMatrix.fromArray(r.projectionMatrix),a.viewport.set(s.x,s.y,s.width,s.height),0===i&&A.matrix.copy(a.matrix),!0===n&&A.cameras.push(a)}}for(let e=0;e<v.length;e++){let t=y[e],n=v[e];null!==t&&void 0!==n&&n.update(t,i,l||s)}if(D&&D(t,i),i.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:i.detectedPlanes});let e=null;for(let t of b)i.detectedPlanes.has(t)||(null===e&&(e=[]),e.push(t));if(null!==e)for(let t of e)b.delete(t),w.delete(t),n.dispatchEvent({type:"planeremoved",data:t});for(let t of i.detectedPlanes)if(b.has(t)){let e=w.get(t);t.lastChangedTime>e&&(w.set(t,t.lastChangedTime),n.dispatchEvent({type:"planechanged",data:t}))}else b.add(t),w.set(t,i.lastChangedTime),n.dispatchEvent({type:"planeadded",data:t})}p=null})),this.setAnimationLoop=function(e){D=e},this.dispose=function(){}}};function Pl(e,t){function n(n,i){n.opacity.value=i.opacity,i.color&&n.diffuse.value.copy(i.color),i.emissive&&n.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(n.map.value=i.map),i.alphaMap&&(n.alphaMap.value=i.alphaMap),i.bumpMap&&(n.bumpMap.value=i.bumpMap,n.bumpScale.value=i.bumpScale,1===i.side&&(n.bumpScale.value*=-1)),i.displacementMap&&(n.displacementMap.value=i.displacementMap,n.displacementScale.value=i.displacementScale,n.displacementBias.value=i.displacementBias),i.emissiveMap&&(n.emissiveMap.value=i.emissiveMap),i.normalMap&&(n.normalMap.value=i.normalMap,n.normalScale.value.copy(i.normalScale),1===i.side&&n.normalScale.value.negate()),i.specularMap&&(n.specularMap.value=i.specularMap),i.alphaTest>0&&(n.alphaTest.value=i.alphaTest);let r,s,a=t.get(i).envMap;if(a&&(n.envMap.value=a,n.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,n.reflectivity.value=i.reflectivity,n.ior.value=i.ior,n.refractionRatio.value=i.refractionRatio),i.lightMap){n.lightMap.value=i.lightMap;let t=!0!==e.physicallyCorrectLights?Math.PI:1;n.lightMapIntensity.value=i.lightMapIntensity*t}i.aoMap&&(n.aoMap.value=i.aoMap,n.aoMapIntensity.value=i.aoMapIntensity),i.map?r=i.map:i.specularMap?r=i.specularMap:i.displacementMap?r=i.displacementMap:i.normalMap?r=i.normalMap:i.bumpMap?r=i.bumpMap:i.roughnessMap?r=i.roughnessMap:i.metalnessMap?r=i.metalnessMap:i.alphaMap?r=i.alphaMap:i.emissiveMap?r=i.emissiveMap:i.clearcoatMap?r=i.clearcoatMap:i.clearcoatNormalMap?r=i.clearcoatNormalMap:i.clearcoatRoughnessMap?r=i.clearcoatRoughnessMap:i.iridescenceMap?r=i.iridescenceMap:i.iridescenceThicknessMap?r=i.iridescenceThicknessMap:i.specularIntensityMap?r=i.specularIntensityMap:i.specularColorMap?r=i.specularColorMap:i.transmissionMap?r=i.transmissionMap:i.thicknessMap?r=i.thicknessMap:i.sheenColorMap?r=i.sheenColorMap:i.sheenRoughnessMap&&(r=i.sheenRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),n.uvTransform.value.copy(r.matrix)),i.aoMap?s=i.aoMap:i.lightMap&&(s=i.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),n.uv2Transform.value.copy(s.matrix))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,Rs(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,r,s,a){i.isMeshBasicMaterial||i.isMeshLambertMaterial?n(e,i):i.isMeshToonMaterial?(n(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(n(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(n(e,i),function(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap)),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate())),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap)),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,i,a)):i.isMeshMatcapMaterial?(n(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?n(e,i):i.isMeshDistanceMaterial?(n(e,i),function(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,i)):i.isMeshNormalMaterial?n(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,n,i){let r;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*i,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?r=t.map:t.alphaMap&&(r=t.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,i,r,s):i.isSpriteMaterial?function(e,t){let n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function Ml(e,t,n,i){let r={},s={},a=[],o=n.isWebGL2?e.getParameter(35375):0;function l(e,t,n){let i=e.value;if(void 0===n[t]){if("number"==typeof i)n[t]=i;else{let e=Array.isArray(i)?i:[i],r=[];for(let t=0;t<e.length;t++)r.push(e[t].clone());n[t]=r}return!0}if("number"==typeof i){if(n[t]!==i)return n[t]=i,!0}else{let e=Array.isArray(n[t])?n[t]:[n[t]],r=Array.isArray(i)?i:[i];for(let t=0;t<e.length;t++){let n=e[t];if(!1===n.equals(r[t]))return n.copy(r[t]),!0}}return!1}function c(e){let t={boundary:0,storage:0};return"number"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function h(t){let n=t.target;n.removeEventListener("dispose",h);let i=a.indexOf(n.__bindingPointIndex);a.splice(i,1),e.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(e,t){let n=t.program;i.uniformBlockBinding(e,n)},update:function(n,u){let d=r[n.id];void 0===d&&(function(e){let t=e.uniforms,n=0,i=16,r=0;for(let s=0,a=t.length;s<a;s++){let e=t[s],a={boundary:0,storage:0},o=Array.isArray(e.value)?e.value:[e.value];for(let t=0,n=o.length;t<n;t++){let e=c(o[t]);a.boundary+=e.boundary,a.storage+=e.storage}if(e.__data=new Float32Array(a.storage/Float32Array.BYTES_PER_ELEMENT),e.__offset=n,s>0){r=n%i,0!==r&&i-r-a.boundary<0&&(n+=i-r,e.__offset=n)}n+=a.storage}r=n%i,r>0&&(n+=i-r),e.__size=n,e.__cache={}}(n),d=function(t){let n=function(){for(let e=0;e<o;e++)if(-1===a.indexOf(e))return a.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;let i=e.createBuffer(),r=t.__size,s=t.usage;return e.bindBuffer(35345,i),e.bufferData(35345,r,s),e.bindBuffer(35345,null),e.bindBufferBase(35345,n,i),i}(n),r[n.id]=d,n.addEventListener("dispose",h));let p=u.program;i.updateUBOMapping(n,p);let f=t.render.frame;s[n.id]!==f&&(function(t){let n=r[t.id],i=t.uniforms,s=t.__cache;e.bindBuffer(35345,n);for(let r=0,a=i.length;r<a;r++){let t=i[r];if(!0===l(t,r,s)){let n=t.__offset,i=Array.isArray(t.value)?t.value:[t.value],r=0;for(let s=0;s<i.length;s++){let a=i[s],o=c(a);"number"==typeof a?(t.__data[0]=a,e.bufferSubData(35345,n+r,t.__data)):a.isMatrix3?(t.__data[0]=a.elements[0],t.__data[1]=a.elements[1],t.__data[2]=a.elements[2],t.__data[3]=a.elements[0],t.__data[4]=a.elements[3],t.__data[5]=a.elements[4],t.__data[6]=a.elements[5],t.__data[7]=a.elements[0],t.__data[8]=a.elements[6],t.__data[9]=a.elements[7],t.__data[10]=a.elements[8],t.__data[11]=a.elements[0]):(a.toArray(t.__data,r),r+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,n,t.__data)}}e.bindBuffer(35345,null)}(n),s[n.id]=f)},dispose:function(){for(let t in r)e.deleteBuffer(r[t]);a=[],r={},s={}}}}function Nl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isWebGLRenderer=!0;let t,n=void 0!==e.canvas?e.canvas:function(){let e=yi("canvas");return e.style.display="block",e}(),i=void 0!==e.context?e.context:null,r=void 0===e.depth||e.depth,s=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,o=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",h=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;t=null!==i?i.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let u=null,d=null,p=[],f=[];this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Vn,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;let m=this,g=!1,v=0,y=0,b=null,w=-1,x=null,E=new ki,C=new ki,A=null,S=n.width,_=n.height,T=1,P=null,M=null,N=new ki(0,0,S,_),I=new ki(0,0,S,_),O=!1,D=new Xs,L=!1,R=!1,k=null,B=new vr,U=new di,z=new ji,F={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function j(){return null===b?T:1}let V,H,W,G,q,K,Y,Q,X,Z,J,$,ee,te,ne,ie,re,se,ae,oe,le,ce,he,ue,de=i;function pe(e,t){for(let i=0;i<e.length;i++){let r=e[i],s=n.getContext(r,t);if(null!==s)return s}return null}try{let e={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${Ut}`),n.addEventListener("webglcontextlost",ge,!1),n.addEventListener("webglcontextrestored",ve,!1),n.addEventListener("webglcontextcreationerror",ye,!1),null===de){let t=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&t.shift(),de=pe(t,e),null===de)throw pe(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===de.getShaderPrecisionFormat&&(de.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ne){throw console.error("THREE.WebGLRenderer: "+Ne.message),Ne}function fe(){V=new _a(de),H=new oa(de,V,e),V.init(H),ce=new xl(de,V,H),W=new bl(de,V,H),G=new Ma,q=new sl,K=new wl(de,V,W,q,H,ce,G),Y=new ca(m),Q=new Sa(m),X=new Js(de,H),he=new sa(de,V,X,H),Z=new Ta(de,X,G,he),J=new Da(de,Z,X,G),ae=new Oa(de,H,K),ie=new la(q),$=new rl(m,Y,Q,V,H,he,ie),ee=new Pl(m,q),te=new cl,ne=new ml(V,H),se=new ra(m,Y,Q,W,J,t,o),re=new yl(m,J,H),ue=new Ml(de,G,H,W),oe=new aa(de,V,G,H),le=new Pa(de,V,G,H),G.programs=$.programs,m.capabilities=H,m.extensions=V,m.properties=q,m.renderLists=te,m.shadowMap=re,m.state=W,m.info=G}fe();let me=new Tl(m,de);function ge(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function ve(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let e=G.autoReset,t=re.enabled,n=re.autoUpdate,i=re.needsUpdate,r=re.type;fe(),G.autoReset=e,re.enabled=t,re.autoUpdate=n,re.needsUpdate=i,re.type=r}function ye(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function be(e){let t=e.target;t.removeEventListener("dispose",be),function(e){(function(e){let t=q.get(e).programs;void 0!==t&&(t.forEach((function(e){$.releaseProgram(e)})),e.isShaderMaterial&&$.releaseShaderCache(e))})(e),q.remove(e)}(t)}this.xr=me,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){let e=V.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){let e=V.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return T},this.setPixelRatio=function(e){void 0!==e&&(T=e,this.setSize(S,_,!1))},this.getSize=function(e){return e.set(S,_)},this.setSize=function(e,t,i){me.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(S=e,_=t,n.width=Math.floor(e*T),n.height=Math.floor(t*T),!1!==i&&(n.style.width=e+"px",n.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return e.set(S*T,_*T).floor()},this.setDrawingBufferSize=function(e,t,i){S=e,_=t,T=i,n.width=Math.floor(e*i),n.height=Math.floor(t*i),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(E)},this.getViewport=function(e){return e.copy(N)},this.setViewport=function(e,t,n,i){e.isVector4?N.set(e.x,e.y,e.z,e.w):N.set(e,t,n,i),W.viewport(E.copy(N).multiplyScalar(T).floor())},this.getScissor=function(e){return e.copy(I)},this.setScissor=function(e,t,n,i){e.isVector4?I.set(e.x,e.y,e.z,e.w):I.set(e,t,n,i),W.scissor(C.copy(I).multiplyScalar(T).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(e){W.setScissorTest(O=e)},this.setOpaqueSort=function(e){P=e},this.setTransparentSort=function(e){M=e},this.getClearColor=function(e){return e.copy(se.getClearColor())},this.setClearColor=function(){se.setClearColor.apply(se,arguments)},this.getClearAlpha=function(){return se.getClearAlpha()},this.setClearAlpha=function(){se.setClearAlpha.apply(se,arguments)},this.clear=function(){let e=0;(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(e|=16384),(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(e|=256),(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&(e|=1024),de.clear(e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",ge,!1),n.removeEventListener("webglcontextrestored",ve,!1),n.removeEventListener("webglcontextcreationerror",ye,!1),te.dispose(),ne.dispose(),q.dispose(),Y.dispose(),Q.dispose(),J.dispose(),he.dispose(),ue.dispose(),$.dispose(),me.dispose(),me.removeEventListener("sessionstart",xe),me.removeEventListener("sessionend",Ee),k&&(k.dispose(),k=null),Ce.stop()},this.renderBufferDirect=function(e,t,n,i,r,s){null===t&&(t=F);let a=r.isMesh&&r.matrixWorld.determinant()<0,o=function(e,t,n,i,r){!0!==t.isScene&&(t=F),K.resetTextureUnits();let s=t.fog,a=i.isMeshStandardMaterial?t.environment:null,o=null===b?m.outputEncoding:!0===b.isXRRenderTarget?b.texture.encoding:Vn,l=(i.isMeshStandardMaterial?Q:Y).get(i.envMap||a),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,h=!!i.normalMap&&!!n.attributes.tangent,u=!!n.morphAttributes.position,p=!!n.morphAttributes.normal,f=!!n.morphAttributes.color,g=i.toneMapped?m.toneMapping:0,v=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,y=void 0!==v?v.length:0,E=q.get(i),C=d.state.lights;if(!0===L&&(!0===R||e!==x)){let t=e===x&&i.id===w;ie.setState(i,e,t)}let A=!1;i.version===E.__version?(E.needsLights&&E.lightsStateVersion!==C.state.version||E.outputEncoding!==o||r.isInstancedMesh&&!1===E.instancing||!r.isInstancedMesh&&!0===E.instancing||r.isSkinnedMesh&&!1===E.skinning||!r.isSkinnedMesh&&!0===E.skinning||E.envMap!==l||!0===i.fog&&E.fog!==s||void 0!==E.numClippingPlanes&&(E.numClippingPlanes!==ie.numPlanes||E.numIntersection!==ie.numIntersection)||E.vertexAlphas!==c||E.vertexTangents!==h||E.morphTargets!==u||E.morphNormals!==p||E.morphColors!==f||E.toneMapping!==g||!0===H.isWebGL2&&E.morphTargetsCount!==y)&&(A=!0):(A=!0,E.__version=i.version);let S=E.currentProgram;!0===A&&(S=Pe(i,t,r));let P=!1,M=!1,N=!1,I=S.getUniforms(),O=E.uniforms;if(W.useProgram(S.program)&&(P=!0,M=!0,N=!0),i.id!==w&&(w=i.id,M=!0),P||x!==e){if(I.setValue(de,"projectionMatrix",e.projectionMatrix),H.logarithmicDepthBuffer&&I.setValue(de,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),x!==e&&(x=e,M=!0,N=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){let t=I.map.cameraPosition;void 0!==t&&t.setValue(de,z.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&I.setValue(de,"isOrthographic",!0===e.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||r.isSkinnedMesh)&&I.setValue(de,"viewMatrix",e.matrixWorldInverse)}if(r.isSkinnedMesh){I.setOptional(de,r,"bindMatrix"),I.setOptional(de,r,"bindMatrixInverse");let e=r.skeleton;e&&(H.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),I.setValue(de,"boneTexture",e.boneTexture,K),I.setValue(de,"boneTextureSize",e.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let D=n.morphAttributes;if((void 0!==D.position||void 0!==D.normal||void 0!==D.color&&!0===H.isWebGL2)&&ae.update(r,n,i,S),(M||E.receiveShadow!==r.receiveShadow)&&(E.receiveShadow=r.receiveShadow,I.setValue(de,"receiveShadow",r.receiveShadow)),i.isMeshGouraudMaterial&&null!==i.envMap&&(O.envMap.value=l,O.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1),M&&(I.setValue(de,"toneMappingExposure",m.toneMappingExposure),E.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(O,N),s&&!0===i.fog&&ee.refreshFogUniforms(O,s),ee.refreshMaterialUniforms(O,i,T,_,k),Uo.upload(de,E.uniformsList,O,K)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(Uo.upload(de,E.uniformsList,O,K),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&I.setValue(de,"center",r.center),I.setValue(de,"modelViewMatrix",r.modelViewMatrix),I.setValue(de,"normalMatrix",r.normalMatrix),I.setValue(de,"modelMatrix",r.matrixWorld),r.previousModelViewMatrix&&I.setValue(de,"previousModelViewMatrix",r.previousModelViewMatrix),e.previousProjectionMatrix&&I.setValue(de,"previousProjectionMatrix",e.previousProjectionMatrix),i.isShaderMaterial||i.isRawShaderMaterial){let e=i.uniformsGroups;for(let t=0,n=e.length;t<n;t++)if(H.isWebGL2){let n=e[t];ue.update(n,S),ue.bind(n,S)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return S}(e,t,n,i,r);W.setMaterial(i,a);let l=n.index,c=1;!0===i.wireframe&&(l=Z.getWireframeAttribute(n),c=2);let h=n.drawRange,u=n.attributes.position,p=h.start*c,f=(h.start+h.count)*c;null!==s&&(p=Math.max(p,s.start*c),f=Math.min(f,(s.start+s.count)*c)),null!==l?(p=Math.max(p,0),f=Math.min(f,l.count)):null!=u&&(p=Math.max(p,0),f=Math.min(f,u.count));let g=f-p;if(g<0||g===1/0)return;he.setup(r,i,o,n,l);let v,y=oe;if(null!==l&&(v=X.get(l),y=le,y.setIndex(v)),r.isMesh)!0===i.wireframe?(W.setLineWidth(i.wireframeLinewidth*j()),y.setMode(1)):y.setMode(4);else if(r.isLine){let e=i.linewidth;void 0===e&&(e=1),W.setLineWidth(e*j()),r.isLineSegments?y.setMode(1):r.isLineLoop?y.setMode(2):y.setMode(3)}else r.isPoints?y.setMode(0):r.isSprite&&y.setMode(4);if(r.isInstancedMesh)y.renderInstances(p,g,r.count);else if(n.isInstancedBufferGeometry){let e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);y.renderInstances(p,g,t)}else y.render(p,g)},this.compile=function(e,t){function n(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,Pe(e,t,n),e.side=0,e.needsUpdate=!0,Pe(e,t,n),e.side=2):Pe(e,t,n)}d=ne.get(e),d.init(),f.push(d),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(m.physicallyCorrectLights),e.traverse((function(t){let i=t.material;if(i)if(Array.isArray(i))for(let r=0;r<i.length;r++){n(i[r],e,t)}else n(i,e,t)})),f.pop(),d=null};let we=null;function xe(){Ce.stop()}function Ee(){Ce.start()}let Ce=new Zs;function Ae(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||D.intersectsSprite(e)){i&&z.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);let t=J.update(e),r=e.material;r.visible&&u.push(e,t,r,n,z.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==G.render.frame&&(e.skeleton.update(),e.skeleton.frame=G.render.frame),!e.frustumCulled||D.intersectsObject(e))){i&&z.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);let t=J.update(e),r=e.material;if(Array.isArray(r)){let i=t.groups;for(let s=0,a=i.length;s<a;s++){let a=i[s],o=r[a.materialIndex];o&&o.visible&&u.push(e,t,o,n,z.z,a)}}else r.visible&&u.push(e,t,r,n,z.z,null)}let r=e.children;for(let s=0,a=r.length;s<a;s++)Ae(r[s],t,n,i)}function Se(e,t,n,i){let r=e.opaque,s=e.transmissive,o=e.transparent;d.setupLightsView(n),!0===L&&ie.setGlobalState(m.clippingPlanes,n),s.length>0&&function(e,t,n){let i=H.isWebGL2;null===k&&(k=new Bi(1,1,{generateMipmaps:!0,type:V.has("EXT_color_buffer_half_float")?En:bn,minFilter:yn,samples:i&&!0===a?4:0})),m.getDrawingBufferSize(U),i?k.setSize(U.x,U.y):k.setSize(li(U.x),li(U.y));let r=m.getRenderTarget();m.setRenderTarget(k),m.clear();let s=m.toneMapping;m.toneMapping=0,_e(e,t,n),m.toneMapping=s,K.updateMultisampleRenderTarget(k),K.updateRenderTargetMipmap(k),m.setRenderTarget(r)}(r,t,n),i&&W.viewport(E.copy(i)),r.length>0&&_e(r,t,n),s.length>0&&_e(s,t,n),o.length>0&&_e(o,t,n),W.buffers.depth.setTest(!0),W.buffers.depth.setMask(!0),W.buffers.color.setMask(!0),W.setPolygonOffset(!1)}function _e(e,t,n){let i=!0===t.isScene?t.overrideMaterial:null;for(let r=0,s=e.length;r<s;r++){let s=e[r],a=s.object,o=s.geometry,l=null===i?s.material:i,c=s.group;a.layers.test(n.layers)&&Te(a,t,n,o,l,c)}}function Te(e,t,n,i,r,s){e.onBeforeRender(m,t,n,i,r,s),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(m,t,n,i,e,s),!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=1,r.needsUpdate=!0,m.renderBufferDirect(n,t,i,r,e,s),r.side=0,r.needsUpdate=!0,m.renderBufferDirect(n,t,i,r,e,s),r.side=2):m.renderBufferDirect(n,t,i,r,e,s),e.onAfterRender(m,t,n,i,r,s)}function Pe(e,t,n){!0!==t.isScene&&(t=F);let i=q.get(e),r=d.state.lights,s=d.state.shadowsArray,a=r.state.version,o=$.getParameters(e,r.state,s,t,n),l=$.getProgramCacheKey(o),c=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?Q:Y).get(e.envMap||i.environment),void 0===c&&(e.addEventListener("dispose",be),c=new Map,i.programs=c);let h=c.get(l);if(void 0!==h){if(i.currentProgram===h&&i.lightsStateVersion===a)return Me(e,o),h}else o.uniforms=$.getUniforms(e),e.onBuild(n,o,m),e.onBeforeCompile(o,m),h=$.acquireProgram(o,l),c.set(l,h),i.uniforms=o.uniforms;let u=i.uniforms;(!e.isShaderMaterial&&!e.isRawShaderMaterial||!0===e.clipping)&&(u.clippingPlanes=ie.uniform),Me(e,o),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=a,i.needsLights&&(u.ambientLightColor.value=r.state.ambient,u.lightProbe.value=r.state.probe,u.directionalLights.value=r.state.directional,u.directionalLightShadows.value=r.state.directionalShadow,u.spotLights.value=r.state.spot,u.spotLightShadows.value=r.state.spotShadow,u.rectAreaLights.value=r.state.rectArea,u.ltc_1.value=r.state.rectAreaLTC1,u.ltc_2.value=r.state.rectAreaLTC2,u.pointLights.value=r.state.point,u.pointLightShadows.value=r.state.pointShadow,u.hemisphereLights.value=r.state.hemi,u.directionalShadowMap.value=r.state.directionalShadowMap,u.directionalShadowMatrix.value=r.state.directionalShadowMatrix,u.spotShadowMap.value=r.state.spotShadowMap,u.spotLightMatrix.value=r.state.spotLightMatrix,u.spotLightMap.value=r.state.spotLightMap,u.pointShadowMap.value=r.state.pointShadowMap,u.pointShadowMatrix.value=r.state.pointShadowMatrix);let p=h.getUniforms(),f=Uo.seqWithValue(p.seq,u);return i.currentProgram=h,i.uniformsList=f,h}function Me(e,t){let n=q.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Ce.setAnimationLoop((function(e){we&&we(e)})),typeof self<"u"&&Ce.setContext(self),this.setAnimationLoop=function(e){we=e,me.setAnimationLoop(e),null===e?Ce.stop():Ce.start()},me.addEventListener("sessionstart",xe),me.addEventListener("sessionend",Ee),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===me.enabled&&!0===me.isPresenting&&(!0===me.cameraAutoUpdate&&me.updateCamera(t),t=me.getCamera()),!0===e.isScene&&e.onBeforeRender(m,e,t,b),d=ne.get(e,f.length),d.init(),f.push(d),B.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),D.setFromProjectionMatrix(B),R=this.localClippingEnabled,L=ie.init(this.clippingPlanes,R),u=te.get(e,p.length),u.init(),p.push(u),Ae(e,t,0,m.sortObjects),u.finish(),!0===m.sortObjects&&u.sort(P,M),!0===L&&ie.beginShadows();let n=d.state.shadowsArray;if(re.render(n,e,t),!0===L&&ie.endShadows(),!0===this.info.autoReset&&this.info.reset(),se.render(u,e),d.setupLights(m.physicallyCorrectLights),t.isArrayCamera){let n=t.cameras;for(let t=0,i=n.length;t<i;t++){let i=n[t];Se(u,e,i,i.viewport)}}else Se(u,e,t);null!==b&&(K.updateMultisampleRenderTarget(b),K.updateRenderTargetMipmap(b)),!0===e.isScene&&e.onAfterRender(m,e,t),he.resetDefaultState(),w=-1,x=null,f.pop(),d=f.length>0?f[f.length-1]:null,p.pop(),u=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(e,t,n){q.get(e.texture).__webglTexture=t,q.get(e.depthTexture).__webglTexture=n;let i=q.get(e);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||!0===V.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){let n=q.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;b=e,v=t,y=n;let i=!0,r=null,s=!1,a=!1;if(e){let n=q.get(e);void 0!==n.__useDefaultFramebuffer?(W.bindFramebuffer(36160,null),i=!1):void 0===n.__webglFramebuffer?K.setupRenderTarget(e):n.__hasExternalTextures&&K.rebindTextures(e,q.get(e.texture).__webglTexture,q.get(e.depthTexture).__webglTexture);let o=e.texture;(o.isData3DTexture||o.isDataArrayTexture||o.isCompressedArrayTexture)&&(a=!0);let l=q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=l[t],s=!0):r=H.isWebGL2&&e.samples>0&&!1===K.useMultisampledRTT(e)?q.get(e).__webglMultisampledFramebuffer:l,E.copy(e.viewport),C.copy(e.scissor),A=e.scissorTest}else E.copy(N).multiplyScalar(T).floor(),C.copy(I).multiplyScalar(T).floor(),A=O;if(W.bindFramebuffer(36160,r)&&H.drawBuffers&&i&&W.drawBuffers(e,r),W.viewport(E),W.scissor(C),W.setScissorTest(A),s){let i=q.get(e.texture);de.framebufferTexture2D(36160,36064,34069+t,i.__webglTexture,n)}else if(a){let i=q.get(e.texture),r=t||0;de.framebufferTextureLayer(36160,36064,i.__webglTexture,n||0,r)}w=-1},this.readRenderTargetPixels=function(e,t,n,i,r,s,a){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){W.bindFramebuffer(36160,o);try{let a=e.texture,o=a.format,l=a.type;if(o!==An&&ce.convert(o)!==de.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");let c=l===En&&(V.has("EXT_color_buffer_half_float")||H.isWebGL2&&V.has("EXT_color_buffer_float"));if(l!==bn&&ce.convert(l)!==de.getParameter(35738)&&(l!==xn||!(H.isWebGL2||V.has("OES_texture_float")||V.has("WEBGL_color_buffer_float")))&&!c)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&de.readPixels(t,n,i,r,ce.convert(o),ce.convert(l),s)}finally{let e=null!==b?q.get(b).__webglFramebuffer:null;W.bindFramebuffer(36160,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,i,r,s,a){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){let a=e.texture,l=a.format,c=a.type;if(t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r){W.bindFramebuffer(de.FRAMEBUFFER,o);let e=de.createBuffer();de.bindBuffer(de.PIXEL_PACK_BUFFER,e),de.bufferData(de.PIXEL_PACK_BUFFER,s.byteLength,de.STREAM_READ),de.readPixels(t,n,i,r,ce.convert(l),ce.convert(c),0);let a=null!==b?q.get(b).__webglFramebuffer:null;W.bindFramebuffer(de.FRAMEBUFFER,a);let h=de.fenceSync(de.SYNC_GPU_COMMANDS_COMPLETE,0);return de.flush(),await function(e,t,n){return new Promise((function(i,r){setTimeout((function s(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:r();break;case e.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}}),n)}))}(de,h,4),de.bindBuffer(de.PIXEL_PACK_BUFFER,e),de.getBufferSubData(de.PIXEL_PACK_BUFFER,0,s),de.deleteBuffer(e),de.deleteSync(h),s}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Math.pow(2,-n),r=Math.floor(t.image.width*i),s=Math.floor(t.image.height*i);K.setTexture2D(t,0),de.copyTexSubImage2D(3553,n,0,0,e.x,e.y,r,s),W.unbindTexture()},this.copyTextureToTexture=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=t.image.width,s=t.image.height,a=ce.convert(n.format),o=ce.convert(n.type);K.setTexture2D(n,0),de.pixelStorei(37440,n.flipY),de.pixelStorei(37441,n.premultiplyAlpha),de.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?de.texSubImage2D(3553,i,e.x,e.y,r,s,a,o,t.image.data):t.isCompressedTexture?de.compressedTexSubImage2D(3553,i,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):de.texSubImage2D(3553,i,e.x,e.y,a,o,t.image),0===i&&n.generateMipmaps&&de.generateMipmap(3553),W.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");let s,a=e.max.x-e.min.x+1,o=e.max.y-e.min.y+1,l=e.max.z-e.min.z+1,c=ce.convert(i.format),h=ce.convert(i.type);if(i.isData3DTexture)K.setTexture3D(i,0),s=32879;else{if(!i.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");K.setTexture2DArray(i,0),s=35866}de.pixelStorei(37440,i.flipY),de.pixelStorei(37441,i.premultiplyAlpha),de.pixelStorei(3317,i.unpackAlignment);let u=de.getParameter(3314),d=de.getParameter(32878),p=de.getParameter(3316),f=de.getParameter(3315),g=de.getParameter(32877),v=n.isCompressedTexture?n.mipmaps[0]:n.image;de.pixelStorei(3314,v.width),de.pixelStorei(32878,v.height),de.pixelStorei(3316,e.min.x),de.pixelStorei(3315,e.min.y),de.pixelStorei(32877,e.min.z),n.isDataTexture||n.isData3DTexture?de.texSubImage3D(s,r,t.x,t.y,t.z,a,o,l,c,h,v.data):n.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),de.compressedTexSubImage3D(s,r,t.x,t.y,t.z,a,o,l,c,v.data)):de.texSubImage3D(s,r,t.x,t.y,t.z,a,o,l,c,h,v),de.pixelStorei(3314,u),de.pixelStorei(32878,d),de.pixelStorei(3316,p),de.pixelStorei(3315,f),de.pixelStorei(32877,g),0===r&&i.generateMipmaps&&de.generateMipmap(s),W.unbindTexture()},this.initRenderTarget=function(e){void 0===q.get(e).__webglFramebuffer&&K.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?K.setTextureCube(e,0):e.isData3DTexture?K.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?K.setTexture2DArray(e,0):K.setTexture2D(e,0),W.unbindTexture()},this.resetState=function(){v=0,y=0,b=null,W.reset(),he.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends Nl{}).prototype.isWebGL1Renderer=!0;var Il=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new Mi(e),this.near=t,this.far=n}clone(){return new Il(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},Ol=class extends Vr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},Dl=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Yn,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ni()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ni()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ni()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Ll=new ji,Rl=class{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Ll.fromBufferAttribute(this,t),Ll.applyMatrix4(e),this.setXYZ(t,Ll.x,Ll.y,Ll.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ll.fromBufferAttribute(this,t),Ll.applyNormalMatrix(e),this.setXYZ(t,Ll.x,Ll.y,Ll.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ll.fromBufferAttribute(this,t),Ll.transformDirection(e),this.setXYZ(t,Ll.x,Ll.y,Ll.z);return this}setX(e,t){return this.normalized&&(t=hi(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=hi(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=hi(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=hi(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ci(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ci(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ci(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ci(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array),i=hi(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=hi(t,this.array),n=hi(n,this.array),i=hi(i,this.array),r=hi(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new ss(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Rl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},kl=class extends Vr{constructor(){super(),this.isBone=!0,this.type="Bone"}},Bl=class extends Ri{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:pn,arguments.length>9&&void 0!==arguments[9]?arguments[9]:pn,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Ul=new vr,zl=new vr,Fl=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=ni(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new vr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let t=new vr;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){let e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,s=e.length;r<s;r++){let i=e[r]?e[r].matrixWorld:zl;Ul.multiplyMatrices(i,t[r]),Ul.toArray(n,16*r)}null!==i&&(i.needsUpdate=!0)}clone(){return new Fl(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=oi(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let n=new Bl(t,e,e,An,xn);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){let n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){let i=e.bones[n],r=t[i];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),r=new kl),this.bones.push(r),this.boneInverses.push((new vr).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){let r=t[i];e.bones.push(r.uuid);let s=n[i];e.boneInverses.push(s.toArray())}return e}},jl=class extends ss{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},Vl=new vr,Hl=new vr,Wl=[],Gl=new vr,ql=new Ns,Kl=class extends Ns{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new jl(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let i=0;i<n;i++)this.setMatrixAt(i,Gl)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){let n=this.matrixWorld,i=this.count;if(ql.geometry=this.geometry,ql.material=this.material,void 0!==ql.material)for(let r=0;r<i;r++){this.getMatrixAt(r,Vl),Hl.multiplyMatrices(n,Vl),ql.matrixWorld=Hl,ql.raycast(e,Wl);for(let e=0,n=Wl.length;e<n;e++){let n=Wl[e];n.instanceId=r,n.object=this,t.push(n)}Wl.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new jl(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},Yl=class extends ts{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Mi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},Ql=new ji,Xl=new ji,Zl=new vr,Jl=new gr,$l=new lr,ec=class extends Vr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new gs,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Yl;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,n=[0];for(let e=1,i=t.count;e<i;e++)Ql.fromBufferAttribute(t,e-1),Xl.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=Ql.distanceTo(Xl);e.setAttribute("lineDistance",new ls(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),$l.copy(n.boundingSphere),$l.applyMatrix4(i),$l.radius+=r,!1===e.ray.intersectsSphere($l))return;Zl.copy(i).invert(),Jl.copy(e.ray).applyMatrix4(Zl);let a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new ji,c=new ji,h=new ji,u=new ji,d=this.isLineSegments?2:1,p=n.index,f=n.attributes.position;if(null!==p){for(let n=Math.max(0,s.start),i=Math.min(p.count,s.start+s.count)-1;n<i;n+=d){let i=p.getX(n),r=p.getX(n+1);if(l.fromBufferAttribute(f,i),c.fromBufferAttribute(f,r),Jl.distanceSqToSegment(l,c,u,h)>o)continue;u.applyMatrix4(this.matrixWorld);let s=e.ray.origin.distanceTo(u);s<e.near||s>e.far||t.push({distance:s,point:h.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,s.start),i=Math.min(f.count,s.start+s.count)-1;n<i;n+=d){if(l.fromBufferAttribute(f,n),c.fromBufferAttribute(f,n+1),Jl.distanceSqToSegment(l,c,u,h)>o)continue;u.applyMatrix4(this.matrixWorld);let i=e.ray.origin.distanceTo(u);i<e.near||i>e.far||t.push({distance:i,point:h.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){let t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}},tc=new ji,nc=new ji,ic=class extends ec{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,n=[];for(let e=0,i=t.count;e<i;e+=2)tc.fromBufferAttribute(t,e),nc.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+tc.distanceTo(nc);e.setAttribute("lineDistance",new ls(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},rc=class extends Ri{constructor(e,t,n,i,r,s,a,o,l){super(e,t,n,i,r,s,a,o,l),this.isVideoTexture=!0,this.minFilter=void 0!==s?s:gn,this.magFilter=void 0!==r?r:gn,this.generateMipmaps=!1;let c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},sc=class extends Ri{constructor(e,t,n,i,r,s,a,o,l){super(e,t,n,i,r,s,a,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},ac=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t,n=[],i=this.getPoint(0),r=0;n.push(0);for(let s=1;s<=e;s++)t=this.getPoint(s/e),r+=t.distanceTo(i),n.push(r),i=t;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let n,i=this.getLengths(),r=0,s=i.length;n=t||e*i[s-1];let a,o=0,l=s-1;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),a=i[r]-n,a<0)o=r+1;else{if(!(a>0)){l=r;break}l=r-1}if(r=l,i[r]===n)return r/(s-1);let c=i[r];return(r+(n-c)/(i[r+1]-c))/(s-1)}getTangent(e,t){let n=e-1e-4,i=e+1e-4;n<0&&(n=0),i>1&&(i=1);let r=this.getPoint(n),s=this.getPoint(i),a=t||(r.isVector2?new di:new ji);return a.copy(s).sub(r).normalize(),a}getTangentAt(e,t){let n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){let n=new ji,i=[],r=[],s=[],a=new ji,o=new vr;for(let d=0;d<=e;d++){let t=d/e;i[d]=this.getTangentAt(t,new ji)}r[0]=new ji,s[0]=new ji;let l=Number.MAX_VALUE,c=Math.abs(i[0].x),h=Math.abs(i[0].y),u=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),h<=l&&(l=h,n.set(0,1,0)),u<=l&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=e;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();let e=Math.acos(ii(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(o.makeRotationAxis(a,e))}s[d].crossVectors(i[d],r[d])}if(!0===t){let t=Math.acos(ii(r[0].dot(r[e]),-1,1));t/=e,i[0].dot(a.crossVectors(r[0],r[e]))>0&&(t=-t);for(let n=1;n<=e;n++)r[n].applyMatrix4(o.makeRotationAxis(i[n],t*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},oc=class extends ac{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let n=t||new di,i=2*Math.PI,r=this.aEndAngle-this.aStartAngle,s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=s?0:i),!0===this.aClockwise&&!s&&(r===i?r=-i:r-=i);let a=this.aStartAngle+e*r,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){let e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=o-this.aX,i=l-this.aY;o=n*e-i*t+this.aX,l=n*t+i*e+this.aY}return n.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};function lc(){let e=0,t=0,n=0,i=0;function r(r,s,a,o){e=r,t=a,n=-3*r+3*s-2*a-o,i=2*r-2*s+a+o}return{initCatmullRom:function(e,t,n,i,s){r(t,n,s*(n-e),s*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,s,a,o){let l=(t-e)/s-(n-e)/(s+a)+(n-t)/a,c=(n-t)/a-(i-t)/(a+o)+(i-n)/o;l*=a,c*=a,r(t,n,l,c)},calc:function(r){let s=r*r;return e+t*r+n*s+i*(s*r)}}}var cc=new ji,hc=new lc,uc=new lc,dc=new lc;function pc(e,t,n,i,r){let s=.5*(i-t),a=.5*(r-n),o=e*e;return(2*n-2*i+s+a)*(e*o)+(-3*n+3*i-2*s-a)*o+s*e+n}function fc(e,t,n,i){return function(e,t){let n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function mc(e,t,n,i,r){return function(e,t){let n=1-e;return n*n*n*t}(e,t)+function(e,t){let n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,r)}var gc=class extends ac{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new di,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new di,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new di;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(mc(e,n.x,i.x,r.x,s.x),mc(e,n.y,i.y,r.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},vc=class extends ac{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ji,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ji,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ji;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(mc(e,n.x,i.x,r.x,s.x),mc(e,n.y,i.y,r.y,s.y),mc(e,n.z,i.z,r.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},yc=class extends ac{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new di,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let n=t||new di;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},bc=class extends ac{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ji,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},wc=class extends ac{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new di,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new di;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di,n=this.v0,i=this.v1,r=this.v2;return t.set(fc(e,n.x,i.x,r.x),fc(e,n.y,i.y,r.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},xc=class extends ac{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di,n=this.points,i=(n.length-1)*e,r=Math.floor(i),s=i-r,a=n[0===r?r:r-1],o=n[r],l=n[r>n.length-2?n.length-1:r+1],c=n[r>n.length-3?n.length-1:r+2];return t.set(pc(s,a.x,o.x,l.x,c.x),pc(s,a.y,o.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n=e.points[t];this.points.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n=e.points[t];this.points.push((new di).fromArray(n))}return this}},Ec=Object.freeze({__proto__:null,ArcCurve:class extends oc{constructor(e,t,n,i,r,s){super(e,t,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class extends ac{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e){let t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e,o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:0===l&&o===s-1&&(o=s-2,l=1),this.closed||o>0?t=r[(o-1)%s]:(cc.subVectors(r[0],r[1]).add(r[0]),t=cc);let c=r[o%s],h=r[(o+1)%s];if(this.closed||o+2<s?n=r[(o+2)%s]:(cc.subVectors(r[s-1],r[s-2]).add(r[s-1]),n=cc),"centripetal"===this.curveType||"chordal"===this.curveType){let e="chordal"===this.curveType?.5:.25,i=Math.pow(t.distanceToSquared(c),e),r=Math.pow(c.distanceToSquared(h),e),s=Math.pow(h.distanceToSquared(n),e);r<1e-4&&(r=1),i<1e-4&&(i=r),s<1e-4&&(s=r),hc.initNonuniformCatmullRom(t.x,c.x,h.x,n.x,i,r,s),uc.initNonuniformCatmullRom(t.y,c.y,h.y,n.y,i,r,s),dc.initNonuniformCatmullRom(t.z,c.z,h.z,n.z,i,r,s)}else"catmullrom"===this.curveType&&(hc.initCatmullRom(t.x,c.x,h.x,n.x,this.tension),uc.initCatmullRom(t.y,c.y,h.y,n.y,this.tension),dc.initCatmullRom(t.z,c.z,h.z,n.z,this.tension));return i.set(hc.calc(l),uc.calc(l),dc.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let n=e.points[t];this.points.push((new ji).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:gc,CubicBezierCurve3:vc,EllipseCurve:oc,LineCurve:yc,LineCurve3:bc,QuadraticBezierCurve:wc,QuadraticBezierCurve3:class extends ac{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ji,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ji;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji,n=this.v0,i=this.v1,r=this.v2;return t.set(fc(e,n.x,i.x,r.x),fc(e,n.y,i.y,r.y),fc(e,n.z,i.z,r.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},SplineCurve:xc}),Cc=class extends ac{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new yc(t,e))}getPoint(e,t){let n=e*this.getLength(),i=this.getCurveLengths(),r=0;for(;r<i.length;){if(i[r]>=n){let e=i[r]-n,s=this.curves[r],a=s.getLength(),o=0===a?0:1-e/a;return s.getPointAt(o,t)}r++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[];for(let i=0,r=this.curves;i<r.length;i++){let s=r[i],a=s.isEllipseCurve?2*t:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,o=s.getPoints(a);for(let t=0;t<o.length;t++){let i=o[t];e&&e.equals(i)||(n.push(i),e=i)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){let n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let n=e.curves[t];this.curves.push((new Ec[n.type]).fromJSON(n))}return this}},Ac=class extends Cc{constructor(e){super(),this.type="Path",this.currentPoint=new di,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let n=new yc(this.currentPoint.clone(),new di(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){let r=new wc(this.currentPoint.clone(),new di(e,t),new di(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,s){let a=new gc(this.currentPoint.clone(),new di(e,t),new di(n,i),new di(r,s));return this.curves.push(a),this.currentPoint.set(r,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),n=new xc(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,n,i,r,s),this}absarc(e,t,n,i,r,s){return this.absellipse(e,t,n,n,i,r,s),this}ellipse(e,t,n,i,r,s,a,o){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,i,r,s,a,o),this}absellipse(e,t,n,i,r,s,a,o){let l=new oc(e,t,n,i,r,s,a,o);if(this.curves.length>0){let e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},Sc=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new di(0,-.5),new di(.5,0),new di(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=ii(i,0,2*Math.PI);let r=[],s=[],a=[],o=[],l=[],c=1/t,h=new ji,u=new di,d=new ji,p=new ji,f=new ji,m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(f.x,f.y,f.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),o.push(d.x,d.y,d.z),f.copy(p)}for(let v=0;v<=t;v++){let r=n+v*c*i,d=Math.sin(r),p=Math.cos(r);for(let n=0;n<=e.length-1;n++){h.x=e[n].x*d,h.y=e[n].y,h.z=e[n].x*p,s.push(h.x,h.y,h.z),u.x=v/t,u.y=n/(e.length-1),a.push(u.x,u.y);let i=o[3*n+0]*d,r=o[3*n+1],c=o[3*n+0]*p;l.push(i,r,c)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){let n=t+v*e.length,i=n,s=n+e.length,a=n+e.length+1,o=n+1;r.push(i,s,o),r.push(a,o,s)}this.setIndex(r),this.setAttribute("position",new ls(s,3)),this.setAttribute("uv",new ls(a,2)),this.setAttribute("normal",new ls(l,3))}static fromJSON(e){return new Sc(e.points,e.segments,e.phiStart,e.phiLength)}},_c=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o};let l=this;i=Math.floor(i),r=Math.floor(r);let c=[],h=[],u=[],d=[],p=0,f=[],m=n/2,g=0;function v(n){let r=p,s=new di,f=new ji,v=0,y=!0===n?e:t,b=!0===n?1:-1;for(let e=1;e<=i;e++)h.push(0,m*b,0),u.push(0,b,0),d.push(.5,.5),p++;let w=p;for(let e=0;e<=i;e++){let t=e/i*o+a,n=Math.cos(t),r=Math.sin(t);f.x=y*r,f.y=m*b,f.z=y*n,h.push(f.x,f.y,f.z),u.push(0,b,0),s.x=.5*n+.5,s.y=.5*r*b+.5,d.push(s.x,s.y),p++}for(let e=0;e<i;e++){let t=r+e,i=w+e;!0===n?c.push(i,i+1,t):c.push(i+1,i,t),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}(function(){let s=new ji,v=new ji,y=0,b=(t-e)/n;for(let l=0;l<=r;l++){let c=[],g=l/r,y=g*(t-e)+e;for(let e=0;e<=i;e++){let t=e/i,r=t*o+a,l=Math.sin(r),f=Math.cos(r);v.x=y*l,v.y=-g*n+m,v.z=y*f,h.push(v.x,v.y,v.z),s.set(l,b,f).normalize(),u.push(s.x,s.y,s.z),d.push(t,1-g),c.push(p++)}f.push(c)}for(let e=0;e<i;e++)for(let t=0;t<r;t++){let n=f[t][e],i=f[t+1][e],r=f[t+1][e+1],s=f[t][e+1];c.push(n,i,s),c.push(i,r,s),y+=6}l.addGroup(g,y,0),g+=y})(),!1===s&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new ls(h,3)),this.setAttribute("normal",new ls(u,3)),this.setAttribute("uv",new ls(d,2))}static fromJSON(e){return new _c(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},Tc=class extends _c{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,n,i,r,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:a}}static fromJSON(e){return new Tc(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},Pc=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};let r=[],s=[];function a(e,t,n,i){let r=i+1,s=[];for(let a=0;a<=r;a++){s[a]=[];let i=e.clone().lerp(n,a/r),o=t.clone().lerp(n,a/r),l=r-a;for(let e=0;e<=l;e++)s[a][e]=0===e&&a===r?i:i.clone().lerp(o,e/l)}for(let a=0;a<r;a++)for(let e=0;e<2*(r-a)-1;e++){let t=Math.floor(e/2);e%2===0?(o(s[a][t+1]),o(s[a+1][t]),o(s[a][t])):(o(s[a][t+1]),o(s[a+1][t+1]),o(s[a+1][t]))}}function o(e){r.push(e.x,e.y,e.z)}function l(t,n){let i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function c(e,t,n,i){i<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=i/2/Math.PI+.5)}function h(e){return Math.atan2(e.z,-e.x)}function u(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(function(e){let n=new ji,i=new ji,r=new ji;for(let s=0;s<t.length;s+=3)l(t[s+0],n),l(t[s+1],i),l(t[s+2],r),a(n,i,r,e)})(i),function(e){let t=new ji;for(let n=0;n<r.length;n+=3)t.x=r[n+0],t.y=r[n+1],t.z=r[n+2],t.normalize().multiplyScalar(e),r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z}(n),function(){let e=new ji;for(let t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];let n=h(e)/2/Math.PI+.5,i=u(e)/Math.PI+.5;s.push(n,1-i)}(function(){let e=new ji,t=new ji,n=new ji,i=new ji,a=new di,o=new di,l=new di;for(let u=0,d=0;u<r.length;u+=9,d+=6){e.set(r[u+0],r[u+1],r[u+2]),t.set(r[u+3],r[u+4],r[u+5]),n.set(r[u+6],r[u+7],r[u+8]),a.set(s[d+0],s[d+1]),o.set(s[d+2],s[d+3]),l.set(s[d+4],s[d+5]),i.copy(e).add(t).add(n).divideScalar(3);let p=h(i);c(a,d+0,e,p),c(o,d+2,t,p),c(l,d+4,n,p)}})(),function(){for(let e=0;e<s.length;e+=6){let t=s[e+0],n=s[e+2],i=s[e+4],r=Math.max(t,n,i),a=Math.min(t,n,i);r>.9&&a<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),i<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new ls(r,3)),this.setAttribute("normal",new ls(r.slice(),3)),this.setAttribute("uv",new ls(s,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new Pc(e.vertices,e.indices,e.radius,e.details)}},Mc=class extends Pc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Mc(e.radius,e.detail)}},Nc=class extends Ac{constructor(e){super(e),this.uuid=ni(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){let n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let n=e.holes[t];this.holes.push((new Ac).fromJSON(n))}return this}},Ic=function(e,t){let n,i,r,s,a,o,l,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,h=t&&t.length,u=h?t[0]*c:e.length,d=Oc(e,0,u,c,!0),p=[];if(!d||d.next===d.prev)return p;if(h&&(d=function(e,t,n,i){let r,s,a,o,l,c=[];for(r=0,s=t.length;r<s;r++)a=t[r]*i,o=r<s-1?t[r+1]*i:e.length,l=Oc(e,a,o,i,!1),l===l.next&&(l.steiner=!0),c.push(Hc(l));for(c.sort(zc),r=0;r<c.length;r++)n=Fc(c[r],n);return n}(e,t,d,c)),e.length>80*c){n=r=e[0],i=s=e[1];for(let t=c;t<u;t+=c)a=e[t],o=e[t+1],a<n&&(n=a),o<i&&(i=o),a>r&&(r=a),o>s&&(s=o);l=Math.max(r-n,s-i),l=0!==l?32767/l:0}return Lc(d,p,c,n,i,l,0),p};function Oc(e,t,n,i,r){let s,a;if(r===function(e,t,n,i){let r=0;for(let s=t,a=n-i;s<n;s+=i)r+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return r}(e,t,n,i)>0)for(s=t;s<n;s+=i)a=$c(s,e[s],e[s+1],a);else for(s=n-i;s>=t;s-=i)a=$c(s,e[s],e[s+1],a);return a&&Kc(a,a.next)&&(eh(a),a=a.next),a}function Dc(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!Kc(i,i.next)&&0!==qc(i.prev,i,i.next))i=i.next;else{if(eh(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function Lc(e,t,n,i,r,s,a){if(!e)return;!a&&s&&function(e,t,n,i){let r=e;do{0===r.z&&(r.z=Vc(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,n,i,r,s,a,o,l,c=1;do{for(n=e,e=null,s=null,a=0;n;){for(a++,i=n,o=0,t=0;t<c&&(o++,i=i.nextZ,i);t++);for(l=c;o>0||l>0&&i;)0!==o&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,o--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(a>1)}(r)}(e,i,r,s);let o,l,c=e;for(;e.prev!==e.next;)if(o=e.prev,l=e.next,s?kc(e,i,r,s):Rc(e))t.push(o.i/n|0),t.push(e.i/n|0),t.push(l.i/n|0),eh(e),e=l.next,c=l.next;else if((e=l)===c){a?1===a?Lc(e=Bc(Dc(e),t,n),t,n,i,r,s,2):2===a&&Uc(e,t,n,i,r,s):Lc(Dc(e),t,n,i,r,s,1);break}}function Rc(e){let t=e.prev,n=e,i=e.next;if(qc(t,n,i)>=0)return!1;let r=t.x,s=n.x,a=i.x,o=t.y,l=n.y,c=i.y,h=r<s?r<a?r:a:s<a?s:a,u=o<l?o<c?o:c:l<c?l:c,d=r>s?r>a?r:a:s>a?s:a,p=o>l?o>c?o:c:l>c?l:c,f=i.next;for(;f!==t;){if(f.x>=h&&f.x<=d&&f.y>=u&&f.y<=p&&Wc(r,o,s,l,a,c,f.x,f.y)&&qc(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function kc(e,t,n,i){let r=e.prev,s=e,a=e.next;if(qc(r,s,a)>=0)return!1;let o=r.x,l=s.x,c=a.x,h=r.y,u=s.y,d=a.y,p=o<l?o<c?o:c:l<c?l:c,f=h<u?h<d?h:d:u<d?u:d,m=o>l?o>c?o:c:l>c?l:c,g=h>u?h>d?h:d:u>d?u:d,v=Vc(p,f,t,n,i),y=Vc(m,g,t,n,i),b=e.prevZ,w=e.nextZ;for(;b&&b.z>=v&&w&&w.z<=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==r&&b!==a&&Wc(o,h,l,u,c,d,b.x,b.y)&&qc(b.prev,b,b.next)>=0||(b=b.prevZ,w.x>=p&&w.x<=m&&w.y>=f&&w.y<=g&&w!==r&&w!==a&&Wc(o,h,l,u,c,d,w.x,w.y)&&qc(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;b&&b.z>=v;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==r&&b!==a&&Wc(o,h,l,u,c,d,b.x,b.y)&&qc(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;w&&w.z<=y;){if(w.x>=p&&w.x<=m&&w.y>=f&&w.y<=g&&w!==r&&w!==a&&Wc(o,h,l,u,c,d,w.x,w.y)&&qc(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function Bc(e,t,n){let i=e;do{let r=i.prev,s=i.next.next;!Kc(r,s)&&Yc(r,i,i.next,s)&&Zc(r,s)&&Zc(s,r)&&(t.push(r.i/n|0),t.push(i.i/n|0),t.push(s.i/n|0),eh(i),eh(i.next),i=e=s),i=i.next}while(i!==e);return Dc(i)}function Uc(e,t,n,i,r,s){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&Gc(a,e)){let o=Jc(a,e);return a=Dc(a,a.next),o=Dc(o,o.next),Lc(a,t,n,i,r,s,0),void Lc(o,t,n,i,r,s,0)}e=e.next}a=a.next}while(a!==e)}function zc(e,t){return e.x-t.x}function Fc(e,t){let n=function(e,t){let n,i=t,r=-1/0,s=e.x,a=e.y;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){let e=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=s&&e>r&&(r=e,n=i.x<i.next.x?i:i.next,e===s))return n}i=i.next}while(i!==t);if(!n)return null;let o,l=n,c=n.x,h=n.y,u=1/0;i=n;do{s>=i.x&&i.x>=c&&s!==i.x&&Wc(a<h?s:r,a,c,h,a<h?r:s,a,i.x,i.y)&&(o=Math.abs(a-i.y)/(s-i.x),Zc(i,e)&&(o<u||o===u&&(i.x>n.x||i.x===n.x&&jc(n,i)))&&(n=i,u=o)),i=i.next}while(i!==l);return n}(e,t);if(!n)return t;let i=Jc(n,e);return Dc(i,i.next),Dc(n,n.next)}function jc(e,t){return qc(e.prev,e,t.prev)<0&&qc(t.next,e,e.next)<0}function Vc(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Hc(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Wc(e,t,n,i,r,s,a,o){return(r-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(i-o)>=(n-a)*(t-o)&&(n-a)*(s-o)>=(r-a)*(i-o)}function Gc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Yc(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Zc(e,t)&&Zc(t,e)&&function(e,t){let n=e,i=!1,r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(qc(e.prev,e,t.prev)||qc(e,t.prev,t))||Kc(e,t)&&qc(e.prev,e,e.next)>0&&qc(t.prev,t,t.next)>0)}function qc(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Kc(e,t){return e.x===t.x&&e.y===t.y}function Yc(e,t,n,i){let r=Xc(qc(e,t,n)),s=Xc(qc(e,t,i)),a=Xc(qc(n,i,e)),o=Xc(qc(n,i,t));return!!(r!==s&&a!==o||0===r&&Qc(e,n,t)||0===s&&Qc(e,i,t)||0===a&&Qc(n,e,i)||0===o&&Qc(n,t,i))}function Qc(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Xc(e){return e>0?1:e<0?-1:0}function Zc(e,t){return qc(e.prev,e,e.next)<0?qc(e,t,e.next)>=0&&qc(e,e.prev,t)>=0:qc(e,t,e.prev)<0||qc(e,e.next,t)<0}function Jc(e,t){let n=new th(e.i,e.x,e.y),i=new th(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function $c(e,t,n,i){let r=new th(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function eh(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function th(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}var nh=class{static area(e){let t=e.length,n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n}static isClockWise(e){return nh.area(e)<0}static triangulateShape(e,t){let n=[],i=[],r=[];ih(e),rh(n,e);let s=e.length;t.forEach(ih);for(let o=0;o<t.length;o++)i.push(s),s+=t[o].length,rh(n,t[o]);let a=Ic(n,i);for(let o=0;o<a.length;o+=3)r.push(a.slice(o,o+3));return r}};function ih(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function rh(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var sh=class extends Pc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new sh(e.radius,e.detail)}},ah=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));let o=Math.min(s+a,Math.PI),l=0,c=[],h=new ji,u=new ji,d=[],p=[],f=[],m=[];for(let g=0;g<=n;g++){let d=[],v=g/n,y=0;0==g&&0==s?y=.5/t:g==n&&o==Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){let o=n/t;h.x=-e*Math.cos(i+o*r)*Math.sin(s+v*a),h.y=e*Math.cos(s+v*a),h.z=e*Math.sin(i+o*r)*Math.sin(s+v*a),p.push(h.x,h.y,h.z),u.copy(h).normalize(),f.push(u.x,u.y,u.z),m.push(o+y,1-v),d.push(l++)}c.push(d)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){let t=c[g][e+1],i=c[g][e],r=c[g+1][e],a=c[g+1][e+1];(0!==g||s>0)&&d.push(t,i,a),(g!==n-1||o<Math.PI)&&d.push(i,r,a)}this.setIndex(d),this.setAttribute("position",new ls(p,3)),this.setAttribute("normal",new ls(f,3)),this.setAttribute("uv",new ls(m,2))}static fromJSON(e){return new ah(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},oh=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);let s=[],a=[],o=[],l=[],c=new ji,h=new ji,u=new ji;for(let d=0;d<=n;d++)for(let s=0;s<=i;s++){let p=s/i*r,f=d/n*Math.PI*2;h.x=(e+t*Math.cos(f))*Math.cos(p),h.y=(e+t*Math.cos(f))*Math.sin(p),h.z=t*Math.sin(f),a.push(h.x,h.y,h.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),u.subVectors(h,c).normalize(),o.push(u.x,u.y,u.z),l.push(s/i),l.push(d/n)}for(let d=1;d<=n;d++)for(let e=1;e<=i;e++){let t=(i+1)*d+e-1,n=(i+1)*(d-1)+e-1,r=(i+1)*(d-1)+e,a=(i+1)*d+e;s.push(t,n,a),s.push(n,r,a)}this.setIndex(s),this.setAttribute("position",new ls(a,3)),this.setAttribute("normal",new ls(o,3)),this.setAttribute("uv",new ls(l,2))}static fromJSON(e){return new oh(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},lh=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:s},n=Math.floor(n),i=Math.floor(i);let a=[],o=[],l=[],c=[],h=new ji,u=new ji,d=new ji,p=new ji,f=new ji,m=new ji,g=new ji;for(let y=0;y<=n;++y){let a=y/n*r*Math.PI*2;v(a,r,s,e,d),v(a+.01,r,s,e,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let e=0;e<=i;++e){let r=e/i*Math.PI*2,s=-t*Math.cos(r),a=t*Math.sin(r);h.x=d.x+(s*g.x+a*f.x),h.y=d.y+(s*g.y+a*f.y),h.z=d.z+(s*g.z+a*f.z),o.push(h.x,h.y,h.z),u.subVectors(h,d).normalize(),l.push(u.x,u.y,u.z),c.push(y/n),c.push(e/i)}}for(let y=1;y<=n;y++)for(let e=1;e<=i;e++){let t=(i+1)*(y-1)+(e-1),n=(i+1)*y+(e-1),r=(i+1)*y+e,s=(i+1)*(y-1)+e;a.push(t,n,s),a.push(n,r,s)}function v(e,t,n,i,r){let s=Math.cos(e),a=Math.sin(e),o=n/t*e,l=Math.cos(o);r.x=i*(2+l)*.5*s,r.y=i*(2+l)*a*.5,r.z=i*Math.sin(o)*.5}this.setIndex(a),this.setAttribute("position",new ls(o,3)),this.setAttribute("normal",new ls(l,3)),this.setAttribute("uv",new ls(c,2))}static fromJSON(e){return new lh(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},ch=class extends Bs{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}};function hh(e,t,n){return dh(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)}function uh(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function dh(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ph(e){let t=e.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort((function(t,n){return e[t]-e[n]})),n}function fh(e,t,n){let i=e.length,r=new e.constructor(i);for(let s=0,a=0;a!==i;++s){let i=n[s]*t;for(let n=0;n!==t;++n)r[a++]=e[i+n]}return r}function mh(e,t,n,i){let r=1,s=e[0];for(;void 0!==s&&void 0===s[i];)s=e[r++];if(void 0===s)return;let a=s[i];if(void 0!==a)if(Array.isArray(a))do{a=s[i],void 0!==a&&(t.push(s.time),n.push.apply(n,a)),s=e[r++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[i],void 0!==a&&(t.push(s.time),a.toArray(n,n.length)),s=e[r++]}while(void 0!==s);else do{a=s[i],void 0!==a&&(t.push(s.time),n.push(a)),s=e[r++]}while(void 0!==s)}var gh=class{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(e>=r)break e;{let a=t[1];e<a&&(n=2,r=a);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0}}for(;n<s;){let i=n+s>>>1;e<t[i]?s=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},vh=class extends gh{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Un,endingEnd:Un}}intervalChanged_(e,t,n){let i=this.parameterPositions,r=e-2,s=e+1,a=i[r],o=i[s];if(void 0===a)switch(this.getSettings_().endingStart){case zn:r=e,a=2*t-n;break;case Fn:r=i.length-2,a=t+i[r]-i[r+1];break;default:r=e,a=n}if(void 0===o)switch(this.getSettings_().endingEnd){case zn:s=e,o=2*n-t;break;case Fn:s=1,o=n+i[1]-i[0];break;default:s=e-1,o=t}let l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,n,i){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f;for(let w=0;w!==a;++w)r[w]=g*s[c+w]+v*s[l+w]+y*s[o+w]+b*s[h+w];return r}},yh=class extends gh{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(n-t)/(i-t),h=1-c;for(let u=0;u!==a;++u)r[u]=s[l+u]*h+s[o+u]*c;return r}},bh=class extends gh{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}},wh=class{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=uh(t,this.TimeBufferType),this.values=uh(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:uh(e.times,Array),values:uh(e.values,Array)};let n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t}InterpolantFactoryMethodDiscrete(e){return new bh(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new yh(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new vh(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Rn:t=this.InterpolantFactoryMethodDiscrete;break;case kn:t=this.InterpolantFactoryMethodLinear;break;case Bn:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){let t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Rn;case this.InterpolantFactoryMethodLinear:return kn;case this.InterpolantFactoryMethodSmooth:return Bn}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){let t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){let t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){let n=this.times,i=n.length,r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);let e=this.getValueSize();this.times=hh(n,r,s),this.values=hh(this.values,r*e,s*e)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==r;a++){let t=n[a];if("number"==typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,t,s),e=!1;break}s=t}if(void 0!==i&&dh(i))for(let a=0,o=i.length;a!==o;++a){let t=i[a];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,t),e=!1;break}}return e}optimize(){let e=hh(this.times),t=hh(this.values),n=this.getValueSize(),i=this.getInterpolation()===Bn,r=e.length-1,s=1;for(let a=1;a<r;++a){let r=!1,o=e[a];if(o!==e[a+1]&&(1!==a||o!==e[0]))if(i)r=!0;else{let e=a*n,i=e-n,s=e+n;for(let a=0;a!==n;++a){let n=t[e+a];if(n!==t[i+a]||n!==t[s+a]){r=!0;break}}}if(r){if(a!==s){e[s]=e[a];let i=a*n,r=s*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*n,i=s*n,a=0;a!==n;++a)t[i+a]=t[e+a];++s}return s!==e.length?(this.times=hh(e,0,s),this.values=hh(t,0,s*n)):(this.times=e,this.values=t),this}clone(){let e=hh(this.times,0),t=hh(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}};wh.prototype.TimeBufferType=Float32Array,wh.prototype.ValueBufferType=Float32Array,wh.prototype.DefaultInterpolation=kn;var xh=class extends wh{};xh.prototype.ValueTypeName="bool",xh.prototype.ValueBufferType=Array,xh.prototype.DefaultInterpolation=Rn,xh.prototype.InterpolantFactoryMethodLinear=void 0,xh.prototype.InterpolantFactoryMethodSmooth=void 0;var Eh=class extends wh{};Eh.prototype.ValueTypeName="color";var Ch=class extends wh{};Ch.prototype.ValueTypeName="number";var Ah=class extends gh{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(n-t)/(i-t),l=e*a;for(let c=l+a;l!==c;l+=4)Fi.slerpFlat(r,0,s,l-a,s,l,o);return r}},Sh=class extends wh{InterpolantFactoryMethodLinear(e){return new Ah(this.times,this.values,this.getValueSize(),e)}};Sh.prototype.ValueTypeName="quaternion",Sh.prototype.DefaultInterpolation=kn,Sh.prototype.InterpolantFactoryMethodSmooth=void 0;var _h=class extends wh{};_h.prototype.ValueTypeName="string",_h.prototype.ValueBufferType=Array,_h.prototype.DefaultInterpolation=Rn,_h.prototype.InterpolantFactoryMethodLinear=void 0,_h.prototype.InterpolantFactoryMethodSmooth=void 0;var Th=class extends wh{};Th.prototype.ValueTypeName="vector";var Ph=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:jn;this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=ni(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],n=e.tracks,i=1/(e.fps||1);for(let s=0,a=n.length;s!==a;++s)t.push(Mh(n[s]).scale(i));let r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){let t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,s=n.length;r!==s;++r)t.push(wh.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(e,t,n,i){let r=t.length,s=[];for(let a=0;a<r;a++){let e=[],o=[];e.push((a+r-1)%r,a,(a+1)%r),o.push(0,1,0);let l=ph(e);e=fh(e,1,l),o=fh(o,1,l),!i&&0===e[0]&&(e.push(r),o.push(o[0])),s.push(new Ch(".morphTargetInfluences["+t[a].name+"]",e,o).scale(1/n))}return new this(e,-1,s)}static findByName(e,t){let n=e;if(!Array.isArray(e)){let t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){let i={},r=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){let t=e[a],n=t.name.match(r);if(n&&n.length>1){let e=n[1],r=i[e];r||(i[e]=r=[]),r.push(t)}}let s=[];for(let a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],t,n));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let n=function(e,t,n,i,r){if(0!==n.length){let s=[],a=[];mh(n,s,a,i),0!==s.length&&r.push(new e(t,s,a))}},i=[],r=e.name||"default",s=e.fps||30,a=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){let t,n={};for(t=0;t<e.length;t++)if(e[t].morphTargets)for(let i=0;i<e[t].morphTargets.length;i++)n[e[t].morphTargets[i]]=-1;for(let r in n){let n=[],s=[];for(let i=0;i!==e[t].morphTargets.length;++i){let i=e[t];n.push(i.time),s.push(i.morphTarget===r?1:0)}i.push(new Ch(".morphTargetInfluence["+r+"]",n,s))}o=n.length*s}else{let r=".bones["+t[c].name+"]";n(Th,r+".position",e,"pos",i),n(Sh,r+".quaternion",e,"rot",i),n(Th,r+".scale",e,"scl",i)}}return 0===i.length?null:new this(r,o,i,a)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){let n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function Mh(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ch;case"vector":case"vector2":case"vector3":case"vector4":return Th;case"color":return Eh;case"quaternion":return Sh;case"bool":case"boolean":return xh;case"string":return _h}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){let t=[],n=[];mh(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var Nh={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Ih=class{constructor(e,t,n){let i,r=this,s=!1,a=0,o=0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===s&&void 0!==r.onStart&&r.onStart(e,a,o),s=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){let t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){let n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}},Oh=new Ih,Dh=class{constructor(e){this.manager=void 0!==e?e:Oh,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let n=this;return new Promise((function(i,r){n.load(e,i,t,r)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},Lh={},Rh=class extends Error{constructor(e,t){super(e),this.response=t}},kh=class extends Dh{constructor(e){super(e)}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let r=Nh.get(e);if(void 0!==r)return this.manager.itemStart(e),setTimeout((()=>{t&&t(r),this.manager.itemEnd(e)}),0),r;if(void 0!==Lh[e])return void Lh[e].push({onLoad:t,onProgress:n,onError:i});Lh[e]=[],Lh[e].push({onLoad:t,onProgress:n,onError:i});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===t.body||void 0===t.body.getReader)return t;let n=Lh[e],i=t.body.getReader(),r=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),s=r?parseInt(r):0,a=0!==s,o=0,l=new ReadableStream({start(e){!function t(){i.read().then((i=>{let{done:r,value:l}=i;if(r)e.close();else{o+=l.byteLength;let i=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});for(let e=0,t=n.length;e<t;e++){let t=n[e];t.onProgress&&t.onProgress(i)}e.enqueue(l),t()}}))}()}});return new Response(l)}throw new Rh(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)})).then((e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,a)));case"json":return e.json();default:if(void 0===a)return e.text();{let t=/charset="?([^;"\s]*)"?/i.exec(a),n=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(n);return e.arrayBuffer().then((e=>i.decode(e)))}}})).then((t=>{Nh.add(e,t);let n=Lh[e];delete Lh[e];for(let e=0,i=n.length;e<i;e++){let i=n[e];i.onLoad&&i.onLoad(t)}})).catch((t=>{let n=Lh[e];if(void 0===n)throw this.manager.itemError(e),t;delete Lh[e];for(let e=0,i=n.length;e<i;e++){let i=n[e];i.onError&&i.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},Bh=class extends Dh{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let r=this,s=Nh.get(e);if(void 0!==s)return r.manager.itemStart(e),setTimeout((function(){t&&t(s),r.manager.itemEnd(e)}),0),s;let a=yi("img");function o(){c(),Nh.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){c(),i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}function c(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(e),a.src=e,a}},Uh=class extends Dh{constructor(e){super(e)}load(e,t,n,i){let r=new Ri,s=new Bh(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,(function(e){r.image=e,r.needsUpdate=!0,void 0!==t&&t(r)}),n,i),r}},zh=class extends Vr{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new Mi(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}},Fh=class extends zh{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Vr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Mi(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},jh=new vr,Vh=new ji,Hh=new ji,Wh=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new di(512,512),this.map=null,this.mapPass=null,this.matrix=new vr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Xs,this._frameExtents=new di(1,1),this._viewportCount=1,this._viewports=[new ki(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,n=this.matrix;Vh.setFromMatrixPosition(e.matrixWorld),t.position.copy(Vh),Hh.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Hh),t.updateMatrixWorld(),jh.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jh),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(jh)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){let e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},Gh=class extends Wh{constructor(){super(new zs(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,n=2*ti*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(n!==t.fov||i!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},qh=class extends zh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Vr.DEFAULT_UP),this.updateMatrix(),this.target=new Vr,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new Gh}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},Kh=new vr,Yh=new ji,Qh=new ji,Xh=class extends Wh{constructor(){super(new zs(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new di(4,2),this._viewportCount=6,this._viewports=[new ki(2,1,1,1),new ki(0,1,1,1),new ki(3,1,1,1),new ki(1,1,1,1),new ki(3,0,1,1),new ki(1,0,1,1)],this._cubeDirections=[new ji(1,0,0),new ji(-1,0,0),new ji(0,0,1),new ji(0,0,-1),new ji(0,1,0),new ji(0,-1,0)],this._cubeUps=[new ji(0,1,0),new ji(0,1,0),new ji(0,1,0),new ji(0,1,0),new ji(0,0,1),new ji(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Yh.setFromMatrixPosition(e.matrixWorld),n.position.copy(Yh),Qh.copy(n.position),Qh.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Qh),n.updateMatrixWorld(),i.makeTranslation(-Yh.x,-Yh.y,-Yh.z),Kh.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Kh)}},Zh=class extends zh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Xh}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},Jh=class extends Wh{constructor(){super(new ha(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},$h=class extends zh{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Vr.DEFAULT_UP),this.updateMatrix(),this.target=new Vr,this.shadow=new Jh}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},eu=class extends gs{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},tu=class extends Dh{constructor(e){super(e)}load(e,t,n,i){let r=this,s=new kh(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(s){i?i(s):console.error(s),r.manager.itemError(e)}}),n,i)}parse(e){let t={},n={};function i(e,i){if(void 0!==t[i])return t[i];let r=e.interleavedBuffers[i],s=function(e,t){if(void 0!==n[t])return n[t];let i=e.arrayBuffers[t],r=new Uint32Array(i).buffer;return n[t]=r,r}(e,r.buffer),a=vi(r.type,s),o=new Dl(a,r.stride);return o.uuid=r.uuid,t[i]=o,o}let r=e.isInstancedBufferGeometry?new eu:new gs,s=e.data.index;if(void 0!==s){let e=vi(s.type,s.array);r.setIndex(new ss(e,1))}let a=e.data.attributes;for(let h in a){let t,n=a[h];if(n.isInterleavedBufferAttribute){let r=i(e.data,n.data);t=new Rl(r,n.itemSize,n.offset,n.normalized)}else{let e=vi(n.type,n.array);t=new(n.isInstancedBufferAttribute?jl:ss)(e,n.itemSize,n.normalized)}void 0!==n.name&&(t.name=n.name),void 0!==n.usage&&t.setUsage(n.usage),void 0!==n.updateRange&&(t.updateRange.offset=n.updateRange.offset,t.updateRange.count=n.updateRange.count),r.setAttribute(h,t)}let o=e.data.morphAttributes;if(o)for(let h in o){let t=o[h],n=[];for(let r=0,s=t.length;r<s;r++){let s,a=t[r];if(a.isInterleavedBufferAttribute){let t=i(e.data,a.data);s=new Rl(t,a.itemSize,a.offset,a.normalized)}else{let e=vi(a.type,a.array);s=new ss(e,a.itemSize,a.normalized)}void 0!==a.name&&(s.name=a.name),n.push(s)}r.morphAttributes[h]=n}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);let l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let h=0,u=l.length;h!==u;++h){let e=l[h];r.addGroup(e.start,e.count,e.materialIndex)}let c=e.data.boundingSphere;if(void 0!==c){let e=new ji;void 0!==c.center&&e.fromArray(c.center),r.boundingSphere=new lr(e,c.radius)}return e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}},nu=class{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=iu(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=iu();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function iu(){return(typeof performance>"u"?Date:performance).now()}var ru=class{constructor(e,t,n){let i,r,s;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let n=this.buffer,i=this.valueSize,r=e*i+i,s=this.cumulativeWeight;if(0===s){for(let e=0;e!==i;++e)n[r+e]=n[e];s=t}else{s+=t;let e=t/s;this._mixBufferRegion(n,r,0,e,i)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){let e=t*this._origIndex;this._mixBufferRegion(n,i,e,1-r,t)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(n[o]!==n[o+t]){a.setValue(n,i);break}}saveOriginalState(){let e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let r=n,s=i;r!==s;++r)t[r]=t[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)e[t+s]=e[n+s]}_slerp(e,t,n,i){Fi.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){let s=this._workIndex*r;Fi.multiplyQuaternionsFlat(e,s,e,t,e,n),Fi.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,n,i,r){let s=1-i;for(let a=0;a!==r;++a){let r=t+a;e[r]=e[r]*s+e[n+a]*i}}_lerpAdditive(e,t,n,i,r){for(let s=0;s!==r;++s){let r=t+s;e[r]=e[r]+e[n+s]*i}}},su="\\[\\]\\.:\\/",au=new RegExp("["+su+"]","g"),ou="[^"+su+"]",lu="[^"+su.replace("\\.","")+"]",cu=/((?:WC+[\/:])*)/.source.replace("WC",ou),hu=/(WCOD+)?/.source.replace("WCOD",lu),uu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ou),du=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ou),pu=new RegExp("^"+cu+hu+uu+du+"$"),fu=["material","materials","bones","map"],mu=class{constructor(e,t,n){this.path=t,this.parsedPath=n||mu.parseTrackName(t),this.node=mu.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new mu.Composite(e,t,n):new mu(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(au,"")}static parseTrackName(e){let t=pu.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){let e=n.nodeName.substring(i+1);-1!==fu.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){let n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){let n=function(e){for(let i=0;i<e.length;i++){let r=e[i];if(r.name===t||r.uuid===t)return r;let s=n(r.children);if(s)return s}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,r=t.propertyIndex;if(e||(e=mu.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}let s=e[i];if(void 0===s){let n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};mu.Composite=class{constructor(e,t,n){let i=n||mu.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){let n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},mu.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},mu.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},mu.prototype.GetterByBindingType=[mu.prototype._getValue_direct,mu.prototype._getValue_array,mu.prototype._getValue_arrayElement,mu.prototype._getValue_toArray],mu.prototype.SetterByBindingTypeAndVersioning=[[mu.prototype._setValue_direct,mu.prototype._setValue_direct_setNeedsUpdate,mu.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[mu.prototype._setValue_array,mu.prototype._setValue_array_setNeedsUpdate,mu.prototype._setValue_array_setMatrixWorldNeedsUpdate],[mu.prototype._setValue_arrayElement,mu.prototype._setValue_arrayElement_setNeedsUpdate,mu.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[mu.prototype._setValue_fromArray,mu.prototype._setValue_fromArray_setNeedsUpdate,mu.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var gu=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;let r=t.tracks,s=r.length,a=new Array(s),o={endingStart:Un,endingEnd:Un};for(let l=0;l!==s;++l){let e=r[l].createInterpolant(null);a[l]=e,e.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){let n=this._clip.duration,i=e._clip.duration,r=i/n,s=n/i;e.warp(1,r,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){let i=this._mixer,r=i.time,s=this.timeScale,a=this._timeScaleInterpolant;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=r,o[1]=r+n,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);let r=this._startTime;if(null!==r){let i=(e-r)*n;i<0||0===n?t=0:(this._startTime=null,t=n*i)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let e=this._interpolants,t=this._propertyBindings;if(2501===this.blendMode)for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(s),t[n].accumulateAdditive(a);else for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(s),t[n].accumulate(i,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let n=this._weightInterpolant;if(null!==n){let i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,n=this.loop,i=this.time+e,r=this._loopCount,s=n===Ln;if(0===e)return-1===r?i:s&&1===(1&r)?t-i:i;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=t||i<0){let n=Math.floor(i/t);i-=t*n,r+=Math.abs(n);let a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===a){let t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(s&&1===(1&r))return t-i}return i}_setEndings(e,t,n){let i=this._interpolantSettings;n?(i.endingStart=zn,i.endingEnd=zn):(i.endingStart=e?this.zeroSlopeAtStart?zn:Un:Fn,i.endingEnd=t?this.zeroSlopeAtEnd?zn:Un:Fn)}_scheduleFading(e,t,n){let i=this._mixer,r=i.time,s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=r,o[0]=t,a[1]=r+e,o[1]=n,this}},vu=new Float32Array(1),yu=class extends Zn{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,s=e._propertyBindings,a=e._interpolants,o=n.uuid,l=this._bindingsByRootAndName,c=l[o];void 0===c&&(c={},l[o]=c);for(let h=0;h!==r;++h){let e=i[h],r=e.name,l=c[r];if(void 0!==l)++l.referenceCount,s[h]=l;else{if(l=s[h],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,o,r));continue}let i=t&&t._propertyBindings[h].binding.parsedPath;l=new ru(mu.create(n,r,i),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,o,r),s[h]=l}a[h].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){let t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}let t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){let n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){let n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){let i=this._actions,r=this._actionsByClip,s=r[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=s;else{let t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[n]=e}_removeInactiveAction(e){let t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;let r=e._clip.uuid,s=this._actionsByClip,a=s[r],o=a.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete s[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){let e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){let t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){let t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){let i=this._bindingsByRootAndName,r=this._bindings,s=i[t];void 0===s&&(s={},i[t]=s),s[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){let t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,a=s[i],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[r],0===Object.keys(a).length&&delete s[i]}_lendBinding(e){let t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){let t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&(n=new yh(new Float32Array(2),new Float32Array(2),1,vu),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){let t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){let i=t||this._root,r=i.uuid,s="string"==typeof e?Ph.findByName(i,e):e,a=null!==s?s.uuid:e,o=this._actionsByClip[a],l=null;if(void 0===n&&(n=null!==s?s.blendMode:jn),void 0!==o){let e=o.actionByRoot[r];if(void 0!==e&&e.blendMode===n)return e;l=o.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;let c=new gu(this,s,t,n);return this._bindAction(c,l),this._addInactiveAction(c,a,r),c}existingAction(e,t){let n=t||this._root,i=n.uuid,r="string"==typeof e?Ph.findByName(n,e):e,s=r?r.uuid:e,a=this._actionsByClip[s];return void 0!==a&&a.actionByRoot[i]||null}stopAllAction(){let e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;let t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==n;++l)t[l]._update(i,e,r,s);let a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){let e=r.knownActions;for(let n=0,i=e.length;n!==i;++n){let i=e[n];this._deactivateAction(i);let r=i._cacheIndex,s=t[t.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,s._cacheIndex=r,t[r]=s,t.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(e){let t=e.uuid,n=this._actionsByClip;for(let r in n){let e=n[r].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}let i=this._bindingsByRootAndName[t];if(void 0!==i)for(let r in i){let e=i[r];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){let n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}},bu=class{constructor(e){this.value=e}clone(){return new bu(void 0===this.value.clone?this.value:this.value.clone())}},wu=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new gr(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Pr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Eu(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(xu),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let i=0,r=e.length;i<r;i++)Eu(e[i],this,n,t);return n.sort(xu),n}};function xu(e,t){return e.distance-t.distance}function Eu(e,t,n,i){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===i){let i=e.children;for(let e=0,r=i.length;e<r;e++)Eu(i[e],t,n,!0)}}var Cu=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(ii(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}},Au=new di,Su=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new di(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=Au.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Au.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},_u=new ji,Tu=new ji,Pu=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ji,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ji;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){_u.subVectors(e,this.start),Tu.subVectors(this.end,this.start);let n=Tu.dot(Tu),i=Tu.dot(_u)/n;return t&&(i=ii(i,0,1)),i}closestPointToPoint(e,t,n){let i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}},Mu=new ji,Nu=class extends Vr{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let n=new gs,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let e=s/o*Math.PI*2,t=a/o*Math.PI*2;i.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new ls(i,3));let r=new Yl({fog:!1,toneMapped:!1});this.cone=new ic(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Mu.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Mu),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Iu=class extends Ns{constructor(e,t,n){super(new ah(t,4,2),new ns({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},Ou=new ji,Du=new ji,Lu=new ji,Ru=class extends Vr{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let i=new gs;i.setAttribute("position",new ls([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let r=new Yl({fog:!1,toneMapped:!1});this.lightPlane=new ec(i,r),this.add(this.lightPlane),i=new gs,i.setAttribute("position",new ls([0,0,0,0,0,1],3)),this.targetLine=new ec(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Ou.setFromMatrixPosition(this.light.matrixWorld),Du.setFromMatrixPosition(this.light.target.matrixWorld),Lu.subVectors(Du,Ou),this.lightPlane.lookAt(Du),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Du),this.targetLine.scale.z=Lu.length()}},ku=new ji,Bu=new Us,Uu=class extends ic{constructor(e){let t=new gs,n=new Yl({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={};function a(e,t){o(e),o(t)}function o(e){i.push(0,0,0),r.push(0,0,0),void 0===s[e]&&(s[e]=[]),s[e].push(i.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),t.setAttribute("position",new ls(i,3)),t.setAttribute("color",new ls(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new Mi(16755200),c=new Mi(16711680),h=new Mi(43775),u=new Mi(16777215),d=new Mi(3355443);this.setColors(l,c,h,u,d)}setColors(e,t,n,i,r){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap;Bu.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),zu("c",t,e,Bu,0,0,-1),zu("t",t,e,Bu,0,0,1),zu("n1",t,e,Bu,-1,-1,-1),zu("n2",t,e,Bu,1,-1,-1),zu("n3",t,e,Bu,-1,1,-1),zu("n4",t,e,Bu,1,1,-1),zu("f1",t,e,Bu,-1,-1,1),zu("f2",t,e,Bu,1,-1,1),zu("f3",t,e,Bu,-1,1,1),zu("f4",t,e,Bu,1,1,1),zu("u1",t,e,Bu,.7,1.1,-1),zu("u2",t,e,Bu,-.7,1.1,-1),zu("u3",t,e,Bu,0,2,-1),zu("cf1",t,e,Bu,-1,0,1),zu("cf2",t,e,Bu,1,0,1),zu("cf3",t,e,Bu,0,-1,1),zu("cf4",t,e,Bu,0,1,1),zu("cn1",t,e,Bu,-1,0,-1),zu("cn2",t,e,Bu,1,0,-1),zu("cn3",t,e,Bu,0,-1,-1),zu("cn4",t,e,Bu,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function zu(e,t,n,i,r,s,a){ku.set(r,s,a).unproject(i);let o=t[e];if(void 0!==o){let e=n.getAttribute("position");for(let t=0,n=o.length;t<n;t++)e.setXYZ(o[t],ku.x,ku.y,ku.z)}}var Fu=class extends ic{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960,n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new gs;i.setIndex(new ss(n,1)),i.setAttribute("position",new ls([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new Yl({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},ju=class extends ic{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new gs;n.setAttribute("position",new ls(t,3)),n.setAttribute("color",new ls([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new Yl({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){let i=new Mi,r=this.geometry.attributes.color.array;return i.set(e),i.toArray(r,0),i.toArray(r,3),i.set(t),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},Vu=function(){let e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){let e=l-127;e<-27?(i[l]=0,i[256|l]=32768,r[l]=24,r[256|l]=24):e<-14?(i[l]=1024>>-e-14,i[256|l]=1024>>-e-14|32768,r[l]=-e-1,r[256|l]=-e-1):e<=15?(i[l]=e+15<<10,i[256|l]=e+15<<10|32768,r[l]=13,r[256|l]=13):e<128?(i[l]=31744,i[256|l]=64512,r[l]=24,r[256|l]=24):(i[l]=31744,i[256|l]=64512,r[l]=13,r[256|l]=13)}let s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,s[l]=e|t}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(o[l]=1024);return{floatView:t,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}();var Hu=Object.freeze({__proto__:null,fromHalfFloat:function(e){let t=e>>10;return Vu.uint32View[0]=Vu.mantissaTable[Vu.offsetTable[t]+(1023&e)]+Vu.exponentTable[t],Vu.floatView[0]},toHalfFloat:function(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=ii(e,-65504,65504),Vu.floatView[0]=e;let t=Vu.uint32View[0],n=t>>23&511;return Vu.baseTable[n]+((8388607&t)>>Vu.shiftTable[n])}});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Ut}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Ut);var Wu=".",Gu=Symbol("target"),qu=Symbol("unsubscribe");function Ku(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}var Yu=Array.isArray;function Qu(e){return"symbol"==typeof e}var Xu={after:(e,t)=>Yu(e)?e.slice(t.length):""===t?e:e.slice(t.length+1),concat:(e,t)=>Yu(e)?(e=[...e],t&&e.push(t),e):t&&void 0!==t.toString?(""!==e&&(e+=Wu),Qu(t)?e+t.toString():e+t):e,initial:e=>{if(Yu(e))return e.slice(0,-1);if(""===e)return e;let t=e.lastIndexOf(Wu);return-1===t?"":e.slice(0,t)},last:e=>{if(Yu(e))return e[e.length-1]||"";if(""===e)return e;let t=e.lastIndexOf(Wu);return-1===t?e:e.slice(t+1)},walk:(e,t)=>{if(Yu(e))for(let n of e)t(n);else if(""!==e){let n=0,i=e.indexOf(Wu);if(-1===i)t(e);else for(;n<e.length;)-1===i&&(i=e.length),t(e.slice(n,i)),n=i+1,i=e.indexOf(Wu,n)}},get(e,t){return this.walk(t,(t=>{e&&(e=e[t])})),e}},Zu=Xu;function Ju(e,t,n){return e.isUnsubscribed||t.ignoreSymbols&&Qu(n)||t.ignoreUnderscores&&"_"===n.charAt(0)||"ignoreKeys"in t&&t.ignoreKeys.includes(n)}var $u=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return void 0===this._descriptorCache&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let n=this._getProperties(e),i=n[t];return void 0===i&&(i=Reflect.getOwnPropertyDescriptor(e,t),n[t]=i),i}getProxy(e,t,n,i){if(this.isUnsubscribed)return e;let r=e[i],s=r||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return void 0===a&&(a=void 0===r?new Proxy(e,n):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,Zu.get(t,this.getPath(e)))}defineProperty(e,t,n){return!!Reflect.defineProperty(e,t,n)&&(this.isUnsubscribed||(this._getProperties(e)[t]=n),!0)}setProperty(e,t,n,i,r){if(!this._equals(r,n)||!(t in e)){let r=this._getOwnPropertyDescriptor(e,t);return void 0!==r&&"set"in r?Reflect.set(e,t,n,i):Reflect.set(e,t,n)}return!0}deleteProperty(e,t,n){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(e);i&&(delete i[t],this._pathCache.delete(n))}return!0}return!1}isSameDescriptor(e,t,n){let i=this._getOwnPropertyDescriptor(t,n);return void 0!==e&&void 0!==i&&Object.is(e.value,i.value)&&(e.writable||!1)===(i.writable||!1)&&(e.enumerable||!1)===(i.enumerable||!1)&&(e.configurable||!1)===(i.configurable||!1)&&e.get===i.get&&e.set===i.set}isGetInvariant(e,t){let n=this._getOwnPropertyDescriptor(e,t);return void 0!==n&&!0!==n.configurable&&!0!==n.writable}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function ed(e){return"[object Object]"===toString.call(e)}function td(){return!0}function nd(e,t){return e.length!==t.length||e.some(((e,n)=>t[n]!==e))}var id=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),rd=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),sd={push:td,pop:td,shift:td,unshift:td,copyWithin:nd,reverse:nd,sort:nd,splice:nd,flat:nd,fill:nd},ad=new Set([...id,...rd,...Object.keys(sd)]);function od(e,t){if(e.size!==t.size)return!0;for(let n of e)if(!t.has(n))return!0;return!1}var ld=["keys","values","entries"],cd=new Set(["has","toString"]),hd={add:od,clear:od,delete:od,forEach:od},ud=new Set([...cd,...Object.keys(hd),...ld]);function dd(e,t){if(e.size!==t.size)return!0;let n;for(let[i,r]of e)if(n=t.get(i),n!==r||void 0===n&&!t.has(i))return!0;return!1}var pd=new Set([...cd,"get"]),fd={set:dd,clear:dd,delete:dd,forEach:dd},md=new Set([...pd,...Object.keys(fd),...ld]),gd=class{constructor(e,t,n,i){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=void 0===t?e:this._shallowClone(e)}static isHandledMethod(e){return id.has(e)}_shallowClone(e){let t=e;if(ed(e))t={...e};else if(Yu(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map((e=>this._shallowClone(e))));else if(e instanceof Map){t=new Map;for(let[n,i]of e.entries())t.set(n,this._shallowClone(i))}return this._clonedCache.add(t),t}preferredThisArg(e,t,n,i){return e?(Yu(i)?this._onIsChanged=sd[t]:i instanceof Set?this._onIsChanged=hd[t]:i instanceof Map&&(this._onIsChanged=fd[t]),i):n}update(e,t,n){let i=Zu.after(e,this._path);if("length"!==t){let e=this.clone;Zu.walk(i,(t=>{e&&e[t]&&(this._clonedCache.has(e[t])||(e[t]=this._shallowClone(e[t])),e=e[t])})),this._hasOnValidate&&this._changes.push({path:i,property:t,previous:n}),e&&e[t]&&(e[t]=n)}this._isChanged=!0}undo(e){let t;for(let n=this._changes.length-1;-1!==n;n--)t=this._changes[n],Zu.get(e,t.path)[t.property]=t.previous}isChanged(e){return void 0===this._onIsChanged?this._isChanged:this._onIsChanged(this.clone,e)}},vd=class extends gd{static isHandledMethod(e){return ad.has(e)}},yd=class extends gd{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},bd=class extends gd{static isHandledMethod(e){return ud.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},wd=class extends gd{static isHandledMethod(e){return md.has(e)}undo(e){for(let[t,n]of this.clone.entries())e.set(t,n);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},xd=class extends gd{constructor(e,t,n,i){super(void 0,t,n,i),this._arg1=n[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},Ed=class extends gd{constructor(e,t,n,i){super(void 0,t,n,i),this._weakKey=n[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},Cd=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return ed(e)||Yu(e)||Ku(e)}static isHandledMethod(e,t){return ed(e)?gd.isHandledMethod(t):Yu(e)?vd.isHandledMethod(t):e instanceof Set?bd.isHandledMethod(t):e instanceof Map?wd.isHandledMethod(t):Ku(e)}get isCloning(){return this._stack.length>0}start(e,t,n){let i=gd;Yu(e)?i=vd:e instanceof Date?i=yd:e instanceof Set?i=bd:e instanceof Map?i=wd:e instanceof WeakSet?i=xd:e instanceof WeakMap&&(i=Ed),this._stack.push(new i(e,t,n,this._hasOnValidate))}update(e,t,n){this._stack[this._stack.length-1].update(e,t,n)}preferredThisArg(e,t,n){let{name:i}=e,r=Cd.isHandledMethod(n,i);return this._stack[this._stack.length-1].preferredThisArg(r,i,t,n)}isChanged(e,t,n){return this._stack[this._stack.length-1].isChanged(e,t,n)}undo(e){void 0!==this._previousClone&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},Ad={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},Sd=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n={...Ad,...n};let i=Symbol("ProxyTarget"),{equals:r,isShallow:s,ignoreDetached:a,details:o}=n,l=new $u(r),c="function"==typeof n.onValidate,h=new Cd(c),u=(e,t,i,r,s)=>!c||h.isCloning||!0===n.onValidate(Zu.concat(l.getPath(e),t),i,r,s),d=(t,i,r,s)=>{!Ju(l,n,i)&&(!a||!l.isDetached(t,e))&&p(l.getPath(t),i,r,s)},p=(e,n,i,r,s)=>{h.isCloning?h.update(e,n,r):t(Zu.concat(e,n),i,r,s)},f=e=>e&&(e[i]||e),m=(t,r,o,c)=>function(e){return("object"==typeof e?null===e:"function"!=typeof e)||e instanceof RegExp}(t)||"constructor"===o||s&&!Cd.isHandledMethod(r,o)||Ju(l,n,o)||l.isGetInvariant(r,o)||a&&l.isDetached(r,e)?t:(void 0===c&&(c=l.getPath(r)),l.getProxy(t,Zu.concat(c,o),g,i)),g={get(e,t,n){if(Qu(t)){if(t===i||t===Gu)return e;if(t===qu&&!l.isUnsubscribed&&0===l.getPath(e).length)return l.unsubscribe(),e}let r=Ku(e)?Reflect.get(e,t):Reflect.get(e,t,n);return m(r,e,t)},set(e,t,n,s){n=f(n);let a=e[i]||e,o=a[t];if(r(o,n)&&t in e)return!0;let c=u(e,t,n,o);return c&&l.setProperty(a,t,n,s,o)?(d(e,t,e[t],o),!0):!c},defineProperty(e,t,n){if(!l.isSameDescriptor(n,e,t)){let i=e[t];u(e,t,n.value,i)&&l.defineProperty(e,t,n,i)&&d(e,t,n.value,i)}return!0},deleteProperty(e,t){if(!Reflect.has(e,t))return!0;let n=Reflect.get(e,t),i=u(e,t,void 0,n);return i&&l.deleteProperty(e,t,n)?(d(e,t,void 0,n),!0):!i},apply(t,n,s){let a=n[i]||n;if(l.isUnsubscribed)return Reflect.apply(t,a,s);if((!1===o||!0!==o&&!o.includes(t.name))&&Cd.isHandledType(a)){let i=Zu.initial(l.getPath(t)),o=Cd.isHandledMethod(a,t.name);h.start(a,i,s);let c=Reflect.apply(t,h.preferredThisArg(t,n,a),o?s.map((e=>f(e))):s),d=h.isChanged(a,r),v=h.stop();if(Cd.isHandledType(c)&&o&&(n instanceof Map&&"get"===t.name&&(i=Zu.concat(i,s[0])),c=l.getProxy(c,i,g)),d){let n={name:t.name,args:s,result:c},r=h.isCloning?Zu.initial(i):i,o=h.isCloning?Zu.last(i):"";u(Zu.get(e,r),o,a,v,n)?p(r,o,a,v,n):h.undo(a)}return(n instanceof Map||n instanceof Set)&&function(e){return"object"==typeof e&&"function"==typeof e.next}(c)?function(e,t,n,i,r){let s=e.next;if("entries"===t.name)e.next=function(){let e=s.call(this);return!1===e.done&&(e.value[0]=r(e.value[0],t,e.value[0],i),e.value[1]=r(e.value[1],t,e.value[0],i)),e};else if("values"===t.name){let a=n[Gu].keys();e.next=function(){let e=s.call(this);return!1===e.done&&(e.value=r(e.value,t,a.next().value,i)),e}}else e.next=function(){let e=s.call(this);return!1===e.done&&(e.value=r(e.value,t,e.value,i)),e};return e}(c,t,n,i,m):c}return Reflect.apply(t,n,s)}},v=l.getProxy(e,n.pathAsArray?[]:"",g);return t=t.bind(v),c&&(n.onValidate=n.onValidate.bind(v)),v};Sd.target=e=>e&&e[Gu]||e,Sd.unsubscribe=e=>e[qu]||e;var _d=Sd,Td="object"==typeof global&&global&&global.Object===Object&&global,Pd="object"==typeof self&&self&&self.Object===Object&&self,Md=Td||Pd||Function("return this")(),Nd=Md.Symbol,Id=Object.prototype,Od=Id.hasOwnProperty,Dd=Id.toString,Ld=Nd?Nd.toStringTag:void 0;var Rd=function(e){var t=Od.call(e,Ld),n=e[Ld];try{e[Ld]=void 0;var i=!0}catch{}var r=Dd.call(e);return i&&(t?e[Ld]=n:delete e[Ld]),r},kd=Object.prototype.toString;var Bd=function(e){return kd.call(e)},Ud=Nd?Nd.toStringTag:void 0;var zd=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Ud&&Ud in Object(e)?Rd(e):Bd(e)};var Fd=function(e){return null!=e&&"object"==typeof e};var jd=function(e){return"symbol"==typeof e||Fd(e)&&"[object Symbol]"==zd(e)};var Vd=function(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r},Hd=Array.isArray,Wd=1/0,Gd=Nd?Nd.prototype:void 0,qd=Gd?Gd.toString:void 0;var Kd=function e(t){if("string"==typeof t)return t;if(Hd(t))return Vd(t,e)+"";if(jd(t))return qd?qd.call(t):"";var n=t+"";return"0"==n&&1/t==-Wd?"-0":n},Yd=/\s/;var Qd=function(e){for(var t=e.length;t--&&Yd.test(e.charAt(t)););return t},Xd=/^\s+/;var Zd=function(e){return e&&e.slice(0,Qd(e)+1).replace(Xd,"")};var Jd=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},$d=/^[-+]0x[0-9a-f]+$/i,ep=/^0b[01]+$/i,tp=/^0o[0-7]+$/i,np=parseInt;var ip=function(e){if("number"==typeof e)return e;if(jd(e))return NaN;if(Jd(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Jd(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Zd(e);var n=ep.test(e);return n||tp.test(e)?np(e.slice(2),n?2:8):$d.test(e)?NaN:+e};var rp=function(e){return e};var sp=function(e){if(!Jd(e))return!1;var t=zd(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},ap=Md["__core-js_shared__"],op=function(){var e=/[^.]+$/.exec(ap&&ap.keys&&ap.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var lp=function(e){return!!op&&op in e},cp=Function.prototype.toString;var hp=function(e){if(null!=e){try{return cp.call(e)}catch{}try{return e+""}catch{}}return""},up=/^\[object .+?Constructor\]$/,dp=Function.prototype,pp=Object.prototype,fp=dp.toString,mp=pp.hasOwnProperty,gp=RegExp("^"+fp.call(mp).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var vp=function(e){return!(!Jd(e)||lp(e))&&(sp(e)?gp:up).test(hp(e))};var yp=function(e,t){return e?.[t]};var bp=function(e,t){var n=yp(e,t);return vp(n)?n:void 0},wp=bp(Md,"WeakMap"),xp=Object.create,Ep=function(){function e(){}return function(t){if(!Jd(t))return{};if(xp)return xp(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),Cp=Ep;var Ap=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var Sp=function(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t},_p=Date.now;var Tp=function(e){var t=0,n=0;return function(){var i=_p(),r=16-(i-n);if(n=i,r>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}};var Pp=function(e){return function(){return e}},Mp=function(){try{var e=bp(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Np=Mp,Ip=Np?function(e,t){return Np(e,"toString",{configurable:!0,enumerable:!1,value:Pp(t),writable:!0})}:rp,Op=Tp(Ip);var Dp=function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e},Lp=/^(?:0|[1-9]\d*)$/;var Rp=function(e,t){var n=typeof e;return!!(t=t??9007199254740991)&&("number"==n||"symbol"!=n&&Lp.test(e))&&e>-1&&e%1==0&&e<t};var kp=function(e,t,n){"__proto__"==t&&Np?Np(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};var Bp=function(e,t){return e===t||e!==e&&t!==t},Up=Object.prototype.hasOwnProperty;var zp=function(e,t,n){var i=e[t];(!Up.call(e,t)||!Bp(i,n)||void 0===n&&!(t in e))&&kp(e,t,n)};var Fp=function(e,t,n,i){var r=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=i?i(n[o],e[o],o,n,e):void 0;void 0===l&&(l=e[o]),r?kp(n,o,l):zp(n,o,l)}return n},jp=Math.max;var Vp=function(e,t,n){return t=jp(void 0===t?e.length-1:t,0),function(){for(var i=arguments,r=-1,s=jp(i.length-t,0),a=Array(s);++r<s;)a[r]=i[t+r];r=-1;for(var o=Array(t+1);++r<t;)o[r]=i[r];return o[t]=n(a),Ap(e,this,o)}};var Hp=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var Wp=function(e){return null!=e&&Hp(e.length)&&!sp(e)},Gp=Object.prototype;var qp=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Gp)};var Kp=function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i};var Yp=function(e){return Fd(e)&&"[object Arguments]"==zd(e)},Qp=Object.prototype,Xp=Qp.hasOwnProperty,Zp=Qp.propertyIsEnumerable,Jp=Yp(function(){return arguments}())?Yp:function(e){return Fd(e)&&Xp.call(e,"callee")&&!Zp.call(e,"callee")},$p=Jp;var ef=function(){return!1},tf="object"==typeof exports&&exports&&!exports.nodeType&&exports,nf=tf&&"object"==typeof module&&module&&!module.nodeType&&module,rf=nf&&nf.exports===tf?Md.Buffer:void 0,sf=(rf?rf.isBuffer:void 0)||ef,af={};af["[object Float32Array]"]=af["[object Float64Array]"]=af["[object Int8Array]"]=af["[object Int16Array]"]=af["[object Int32Array]"]=af["[object Uint8Array]"]=af["[object Uint8ClampedArray]"]=af["[object Uint16Array]"]=af["[object Uint32Array]"]=!0,af["[object Arguments]"]=af["[object Array]"]=af["[object ArrayBuffer]"]=af["[object Boolean]"]=af["[object DataView]"]=af["[object Date]"]=af["[object Error]"]=af["[object Function]"]=af["[object Map]"]=af["[object Number]"]=af["[object Object]"]=af["[object RegExp]"]=af["[object Set]"]=af["[object String]"]=af["[object WeakMap]"]=!1;var of=function(e){return Fd(e)&&Hp(e.length)&&!!af[zd(e)]};var lf=function(e){return function(t){return e(t)}},cf="object"==typeof exports&&exports&&!exports.nodeType&&exports,hf=cf&&"object"==typeof module&&module&&!module.nodeType&&module,uf=hf&&hf.exports===cf&&Td.process,df=function(){try{return hf&&hf.require&&hf.require("util").types||uf&&uf.binding&&uf.binding("util")}catch{}}(),pf=df&&df.isTypedArray,ff=pf?lf(pf):of,mf=Object.prototype.hasOwnProperty;var gf=function(e,t){var n=Hd(e),i=!n&&$p(e),r=!n&&!i&&sf(e),s=!n&&!i&&!r&&ff(e),a=n||i||r||s,o=a?Kp(e.length,String):[],l=o.length;for(var c in e)(t||mf.call(e,c))&&(!a||!("length"==c||r&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Rp(c,l)))&&o.push(c);return o};var vf=function(e,t){return function(n){return e(t(n))}},yf=vf(Object.keys,Object),bf=Object.prototype.hasOwnProperty;var wf=function(e){if(!qp(e))return yf(e);var t=[];for(var n in Object(e))bf.call(e,n)&&"constructor"!=n&&t.push(n);return t};var xf=function(e){return Wp(e)?gf(e):wf(e)};var Ef=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},Cf=Object.prototype.hasOwnProperty;var Af=function(e){if(!Jd(e))return Ef(e);var t=qp(e),n=[];for(var i in e)"constructor"==i&&(t||!Cf.call(e,i))||n.push(i);return n};var Sf=function(e){return Wp(e)?gf(e,!0):Af(e)},_f=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tf=/^\w*$/;var Pf=function(e,t){if(Hd(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!jd(e))||(Tf.test(e)||!_f.test(e)||null!=t&&e in Object(t))},Mf=bp(Object,"create");var Nf=function(){this.__data__=Mf?Mf(null):{},this.size=0};var If=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Of=Object.prototype.hasOwnProperty;var Df=function(e){var t=this.__data__;if(Mf){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Of.call(t,e)?t[e]:void 0},Lf=Object.prototype.hasOwnProperty;var Rf=function(e){var t=this.__data__;return Mf?void 0!==t[e]:Lf.call(t,e)};var kf=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Mf&&void 0===t?"__lodash_hash_undefined__":t,this};function Bf(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Bf.prototype.clear=Nf,Bf.prototype.delete=If,Bf.prototype.get=Df,Bf.prototype.has=Rf,Bf.prototype.set=kf;var Uf=Bf;var zf=function(){this.__data__=[],this.size=0};var Ff=function(e,t){for(var n=e.length;n--;)if(Bp(e[n][0],t))return n;return-1},jf=Array.prototype.splice;var Vf=function(e){var t=this.__data__,n=Ff(t,e);return!(n<0)&&(n==t.length-1?t.pop():jf.call(t,n,1),--this.size,!0)};var Hf=function(e){var t=this.__data__,n=Ff(t,e);return n<0?void 0:t[n][1]};var Wf=function(e){return Ff(this.__data__,e)>-1};var Gf=function(e,t){var n=this.__data__,i=Ff(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};function qf(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}qf.prototype.clear=zf,qf.prototype.delete=Vf,qf.prototype.get=Hf,qf.prototype.has=Wf,qf.prototype.set=Gf;var Kf=qf,Yf=bp(Md,"Map");var Qf=function(){this.size=0,this.__data__={hash:new Uf,map:new(Yf||Kf),string:new Uf}};var Xf=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Zf=function(e,t){var n=e.__data__;return Xf(t)?n["string"==typeof t?"string":"hash"]:n.map};var Jf=function(e){var t=Zf(this,e).delete(e);return this.size-=t?1:0,t};var $f=function(e){return Zf(this,e).get(e)};var em=function(e){return Zf(this,e).has(e)};var tm=function(e,t){var n=Zf(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};function nm(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}nm.prototype.clear=Qf,nm.prototype.delete=Jf,nm.prototype.get=$f,nm.prototype.has=em,nm.prototype.set=tm;var im=nm;function rm(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var a=e.apply(this,i);return n.cache=s.set(r,a)||s,a};return n.cache=new(rm.Cache||im),n}rm.Cache=im;var sm=rm;var am=function(e){var t=sm(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t},om=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lm=/\\(\\)?/g,cm=am((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(om,(function(e,n,i,r){t.push(i?r.replace(lm,"$1"):n||e)})),t})),hm=cm;var um=function(e){return null==e?"":Kd(e)};var dm=function(e,t){return Hd(e)?e:Pf(e,t)?[e]:hm(um(e))},pm=1/0;var fm=function(e){if("string"==typeof e||jd(e))return e;var t=e+"";return"0"==t&&1/e==-pm?"-0":t};var mm=function(e,t){for(var n=0,i=(t=dm(t,e)).length;null!=e&&n<i;)e=e[fm(t[n++])];return n&&n==i?e:void 0};var gm=function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e},vm=Nd?Nd.isConcatSpreadable:void 0;var ym=function(e){return Hd(e)||$p(e)||!!(vm&&e&&e[vm])};var bm=function e(t,n,i,r,s){var a=-1,o=t.length;for(i||(i=ym),s||(s=[]);++a<o;){var l=t[a];n>0&&i(l)?n>1?e(l,n-1,i,r,s):gm(s,l):r||(s[s.length]=l)}return s};var wm=function(e){return(null==e?0:e.length)?bm(e,1):[]};var xm=function(e){return Op(Vp(e,void 0,wm),e+"")},Em=vf(Object.getPrototypeOf,Object),Cm=Function.prototype,Am=Object.prototype,Sm=Cm.toString,_m=Am.hasOwnProperty,Tm=Sm.call(Object);var Pm=function(e){if(!Fd(e)||"[object Object]"!=zd(e))return!1;var t=Em(e);if(null===t)return!0;var n=_m.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Sm.call(n)==Tm};var Mm=function(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var s=Array(r);++i<r;)s[i]=e[i+t];return s};var Nm=function(){this.__data__=new Kf,this.size=0};var Im=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var Om=function(e){return this.__data__.get(e)};var Dm=function(e){return this.__data__.has(e)};var Lm=function(e,t){var n=this.__data__;if(n instanceof Kf){var i=n.__data__;if(!Yf||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new im(i)}return n.set(e,t),this.size=n.size,this};function Rm(e){var t=this.__data__=new Kf(e);this.size=t.size}Rm.prototype.clear=Nm,Rm.prototype.delete=Im,Rm.prototype.get=Om,Rm.prototype.has=Dm,Rm.prototype.set=Lm;var km=Rm;var Bm=function(e,t){return e&&Fp(t,xf(t),e)};var Um=function(e,t){return e&&Fp(t,Sf(t),e)},zm="object"==typeof exports&&exports&&!exports.nodeType&&exports,Fm=zm&&"object"==typeof module&&module&&!module.nodeType&&module,jm=Fm&&Fm.exports===zm?Md.Buffer:void 0,Vm=jm?jm.allocUnsafe:void 0;var Hm=function(e,t){if(t)return e.slice();var n=e.length,i=Vm?Vm(n):new e.constructor(n);return e.copy(i),i};var Wm=function(e,t){for(var n=-1,i=null==e?0:e.length,r=0,s=[];++n<i;){var a=e[n];t(a,n,e)&&(s[r++]=a)}return s};var Gm=function(){return[]},qm=Object.prototype.propertyIsEnumerable,Km=Object.getOwnPropertySymbols,Ym=Km?function(e){return null==e?[]:(e=Object(e),Wm(Km(e),(function(t){return qm.call(e,t)})))}:Gm,Qm=Ym;var Xm=function(e,t){return Fp(e,Qm(e),t)},Zm=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)gm(t,Qm(e)),e=Em(e);return t}:Gm,Jm=Zm;var $m=function(e,t){return Fp(e,Jm(e),t)};var eg=function(e,t,n){var i=t(e);return Hd(e)?i:gm(i,n(e))};var tg=function(e){return eg(e,xf,Qm)};var ng=function(e){return eg(e,Sf,Jm)},ig=bp(Md,"DataView"),rg=bp(Md,"Promise"),sg=bp(Md,"Set"),ag="[object Map]",og="[object Promise]",lg="[object Set]",cg="[object WeakMap]",hg="[object DataView]",ug=hp(ig),dg=hp(Yf),pg=hp(rg),fg=hp(sg),mg=hp(wp),gg=zd;(ig&&gg(new ig(new ArrayBuffer(1)))!=hg||Yf&&gg(new Yf)!=ag||rg&&gg(rg.resolve())!=og||sg&&gg(new sg)!=lg||wp&&gg(new wp)!=cg)&&(gg=function(e){var t=zd(e),n="[object Object]"==t?e.constructor:void 0,i=n?hp(n):"";if(i)switch(i){case ug:return hg;case dg:return ag;case pg:return og;case fg:return lg;case mg:return cg}return t});var vg=gg,yg=Object.prototype.hasOwnProperty;var bg=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&yg.call(e,"index")&&(n.index=e.index,n.input=e.input),n},wg=Md.Uint8Array;var xg=function(e){var t=new e.constructor(e.byteLength);return new wg(t).set(new wg(e)),t};var Eg=function(e,t){var n=t?xg(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},Cg=/\w*$/;var Ag=function(e){var t=new e.constructor(e.source,Cg.exec(e));return t.lastIndex=e.lastIndex,t},Sg=Nd?Nd.prototype:void 0,_g=Sg?Sg.valueOf:void 0;var Tg=function(e){return _g?Object(_g.call(e)):{}};var Pg=function(e,t){var n=t?xg(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var Mg=function(e,t,n){var i=e.constructor;switch(t){case"[object ArrayBuffer]":return xg(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return Eg(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Pg(e,n);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return Ag(e);case"[object Symbol]":return Tg(e)}};var Ng=function(e){return"function"!=typeof e.constructor||qp(e)?{}:Cp(Em(e))};var Ig=function(e){return Fd(e)&&"[object Map]"==vg(e)},Og=df&&df.isMap,Dg=Og?lf(Og):Ig;var Lg=function(e){return Fd(e)&&"[object Set]"==vg(e)},Rg=df&&df.isSet,kg=Rg?lf(Rg):Lg,Bg="[object Arguments]",Ug="[object Function]",zg="[object Object]",Fg={};Fg[Bg]=Fg["[object Array]"]=Fg["[object ArrayBuffer]"]=Fg["[object DataView]"]=Fg["[object Boolean]"]=Fg["[object Date]"]=Fg["[object Float32Array]"]=Fg["[object Float64Array]"]=Fg["[object Int8Array]"]=Fg["[object Int16Array]"]=Fg["[object Int32Array]"]=Fg["[object Map]"]=Fg["[object Number]"]=Fg[zg]=Fg["[object RegExp]"]=Fg["[object Set]"]=Fg["[object String]"]=Fg["[object Symbol]"]=Fg["[object Uint8Array]"]=Fg["[object Uint8ClampedArray]"]=Fg["[object Uint16Array]"]=Fg["[object Uint32Array]"]=!0,Fg["[object Error]"]=Fg[Ug]=Fg["[object WeakMap]"]=!1;var jg=function e(t,n,i,r,s,a){var o,l=1&n,c=2&n,h=4&n;if(i&&(o=s?i(t,r,s,a):i(t)),void 0!==o)return o;if(!Jd(t))return t;var u=Hd(t);if(u){if(o=bg(t),!l)return Sp(t,o)}else{var d=vg(t),p=d==Ug||"[object GeneratorFunction]"==d;if(sf(t))return Hm(t,l);if(d==zg||d==Bg||p&&!s){if(o=c||p?{}:Ng(t),!l)return c?$m(t,Um(o,t)):Xm(t,Bm(o,t))}else{if(!Fg[d])return s?t:{};o=Mg(t,d,l)}}a||(a=new km);var f=a.get(t);if(f)return f;a.set(t,o),kg(t)?t.forEach((function(r){o.add(e(r,n,i,r,t,a))})):Dg(t)&&t.forEach((function(r,s){o.set(s,e(r,n,i,s,t,a))}));var m=u?void 0:(h?c?ng:tg:c?Sf:xf)(t);return Dp(m||t,(function(r,s){m&&(r=t[s=r]),zp(o,s,e(r,n,i,s,t,a))})),o};var Vg=function(e){return jg(e,5)};var Hg=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var Wg=function(e){return this.__data__.has(e)};function Gg(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new im;++t<n;)this.add(e[t])}Gg.prototype.add=Gg.prototype.push=Hg,Gg.prototype.has=Wg;var qg=Gg;var Kg=function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1};var Yg=function(e,t){return e.has(t)};var Qg=function(e,t,n,i,r,s){var a=1&n,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e),h=s.get(t);if(c&&h)return c==t&&h==e;var u=-1,d=!0,p=2&n?new qg:void 0;for(s.set(e,t),s.set(t,e);++u<o;){var f=e[u],m=t[u];if(i)var g=a?i(m,f,u,t,e,s):i(f,m,u,e,t,s);if(void 0!==g){if(g)continue;d=!1;break}if(p){if(!Kg(t,(function(e,t){if(!Yg(p,t)&&(f===e||r(f,e,n,i,s)))return p.push(t)}))){d=!1;break}}else if(f!==m&&!r(f,m,n,i,s)){d=!1;break}}return s.delete(e),s.delete(t),d};var Xg=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n};var Zg=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},Jg=Nd?Nd.prototype:void 0,$g=Jg?Jg.valueOf:void 0;var ev=function(e,t,n,i,r,s,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new wg(e),new wg(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Bp(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var o=Xg;case"[object Set]":var l=1&i;if(o||(o=Zg),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;i|=2,a.set(e,t);var h=Qg(o(e),o(t),i,r,s,a);return a.delete(e),h;case"[object Symbol]":if($g)return $g.call(e)==$g.call(t)}return!1},tv=Object.prototype.hasOwnProperty;var nv=function(e,t,n,i,r,s){var a=1&n,o=tg(e),l=o.length;if(l!=tg(t).length&&!a)return!1;for(var c=l;c--;){var h=o[c];if(!(a?h in t:tv.call(t,h)))return!1}var u=s.get(e),d=s.get(t);if(u&&d)return u==t&&d==e;var p=!0;s.set(e,t),s.set(t,e);for(var f=a;++c<l;){var m=e[h=o[c]],g=t[h];if(i)var v=a?i(g,m,h,t,e,s):i(m,g,h,e,t,s);if(!(void 0===v?m===g||r(m,g,n,i,s):v)){p=!1;break}f||(f="constructor"==h)}if(p&&!f){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return s.delete(e),s.delete(t),p},iv="[object Arguments]",rv="[object Array]",sv="[object Object]",av=Object.prototype.hasOwnProperty;var ov=function(e,t,n,i,r,s){var a=Hd(e),o=Hd(t),l=a?rv:vg(e),c=o?rv:vg(t),h=(l=l==iv?sv:l)==sv,u=(c=c==iv?sv:c)==sv,d=l==c;if(d&&sf(e)){if(!sf(t))return!1;a=!0,h=!1}if(d&&!h)return s||(s=new km),a||ff(e)?Qg(e,t,n,i,r,s):ev(e,t,l,n,i,r,s);if(!(1&n)){var p=h&&av.call(e,"__wrapped__"),f=u&&av.call(t,"__wrapped__");if(p||f){var m=p?e.value():e,g=f?t.value():t;return s||(s=new km),r(m,g,n,i,s)}}return!!d&&(s||(s=new km),nv(e,t,n,i,r,s))};var lv=function e(t,n,i,r,s){return t===n||(null==t||null==n||!Fd(t)&&!Fd(n)?t!==t&&n!==n:ov(t,n,i,r,e,s))};var cv=function(e,t){return null!=e&&t in Object(e)};var hv=function(e,t,n){for(var i=-1,r=(t=dm(t,e)).length,s=!1;++i<r;){var a=fm(t[i]);if(!(s=null!=e&&n(e,a)))break;e=e[a]}return s||++i!=r?s:!!(r=null==e?0:e.length)&&Hp(r)&&Rp(a,r)&&(Hd(e)||$p(e))};var uv=function(e,t){return null!=e&&hv(e,t,cv)},dv=function(){return Md.Date.now()},pv=Math.max,fv=Math.min;var mv=function(e,t,n){var i,r,s,a,o,l,c=0,h=!1,u=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=i,s=r;return i=r=void 0,c=t,a=e.apply(s,n)}function f(e){var n=e-l;return void 0===l||n>=t||n<0||u&&e-c>=s}function m(){var e=dv();if(f(e))return g(e);o=setTimeout(m,function(e){var n=t-(e-l);return u?fv(n,s-(e-c)):n}(e))}function g(e){return o=void 0,d&&i?p(e):(i=r=void 0,a)}function v(){var e=dv(),n=f(e);if(i=arguments,r=this,l=e,n){if(void 0===o)return function(e){return c=e,o=setTimeout(m,t),h?p(e):a}(l);if(u)return clearTimeout(o),o=setTimeout(m,t),p(l)}return void 0===o&&(o=setTimeout(m,t)),a}return t=ip(t)||0,Jd(n)&&(h=!!n.leading,s=(u="maxWait"in n)?pv(ip(n.maxWait)||0,t):s,d="trailing"in n?!!n.trailing:d),v.cancel=function(){void 0!==o&&clearTimeout(o),c=0,i=l=r=o=void 0},v.flush=function(){return void 0===o?a:g(dv())},v};var gv=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var vv=function(e,t){return e>t};var yv=function(e,t){return t.length<2?e:mm(e,Mm(t,0,-1))};var bv=function(e,t){return lv(e,t)};var wv=function(e,t,n){for(var i=-1,r=e.length;++i<r;){var s=e[i],a=t(s);if(null!=a&&(void 0===o?a===a&&!jd(a):n(a,o)))var o=a,l=s}return l};var xv=function(e){return e&&e.length?wv(e,rp,vv):void 0};var Ev=function(e,t){return t=dm(t,e),null==(e=yv(e,t))||delete e[fm(gv(t))]};var Cv=function(e){return Pm(e)?void 0:e},Av=xm((function(e,t){var n={};if(null==e)return n;var i=!1;t=Vd(t,(function(t){return t=dm(t,e),i||(i=t.length>1),t})),Fp(e,ng(e),n),i&&(n=jg(n,7,Cv));for(var r=t.length;r--;)Ev(n,t[r]);return n})),Sv=Av;var _v=function(e,t,n,i){if(!Jd(e))return e;for(var r=-1,s=(t=dm(t,e)).length,a=s-1,o=e;null!=o&&++r<s;){var l=fm(t[r]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(r!=a){var h=o[l];void 0===(c=i?i(h,l,o):void 0)&&(c=Jd(h)?h:Rp(t[r+1])?[]:{})}zp(o,l,c),o=o[l]}return e};var Tv=function(e,t,n){for(var i=-1,r=t.length,s={};++i<r;){var a=t[i],o=mm(e,a);n(o,a)&&_v(s,dm(a,e),o)}return s};var Pv=function(e,t){return Tv(e,t,(function(t,n){return uv(e,n)}))},Mv=xm((function(e,t){return null==e?{}:Pv(e,t)})),Nv=Mv;var Iv=function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Jd(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),mv(e,t,{leading:i,maxWait:t,trailing:r})};function Ov(e){for(let t of Object.keys(e))void 0===e[t]&&delete e[t];return e}function Dv(e,t){return Object.setPrototypeOf(e,t),e}var Lv=!(typeof window>"u")&&window.navigator.userAgent.toLowerCase().includes(" electron/"),Rv=(Lv&&(()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");e?window.localStorage.setItem("desktop-app-version",e):window.localStorage.getItem("desktop-app-version")})(),!(typeof window>"u")&&window.navigator.platform.toUpperCase().includes("MAC")),kv=!(typeof window>"u")&&(/iPad|iPhone|iPod/.test(window.navigator.userAgent)||Rv&&"ontouchend"in document),Bv=!(typeof window>"u")&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Uv=!(typeof window>"u")&&("ontouchstart"in window||navigator.maxTouchPoints>0),zv=(()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)})(),Fv=Number((()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]})());function jv(e){return Array.isArray(e)?e:[e]}function Vv(e,t){let n=0;for(;n<e.length&&n<t.length;){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1;n+=1}return n!==t.length?-1:n!==e.length?1:0}function Hv(e){return Rv?e.metaKey:e.ctrlKey}var Wv=[],Gv={},qv={},Kv={};function Yv(e){Wv.includes(e)||Wv.push(e)}function Qv(e){delete Gv[e.pointerId];for(let t=0;t<Wv.length;t++)if(Wv[t].pointerId===e.pointerId){Wv.splice(t,1);break}}function Xv(e){if("touch"!==e.pointerType)return;let t=Gv[e.pointerId];void 0===t&&(t={x:0,y:0},Gv[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function Zv(e){let t=e.pointerId===Wv[0].pointerId?Wv[1]:Wv[0];return Gv[t.pointerId]}function Jv(e){qv[e.key]=!0,Kv[e.key]=void 0===Kv[e.key]?1:Kv[e.key]+1}function $v(e){if(Rv&&qv.Meta)for(let t in qv)qv[t]=!1;else qv[e.key]=!1;Kv={}}var ey,ty,ny=new Promise((e=>{ey=e}));function iy(){if(ty)return ty;return ty=async function(){let e=n.e(1208).then(n.bind(n,41208)),[t,i]=await Promise.all([e,fetch("https://unpkg.com/@splinetool/navmesh-wasm@1.9.87/build/navmesh.wasm").then((e=>e.arrayBuffer()))]),r=t.default,s=await r({wasmBinary:i});ey(s)}()}var ry,sy,ay=new Promise((e=>{ry=e}));function oy(){if(sy)return sy;return sy=async function(){let e=await n.e(7293).then(n.bind(n,67293));await e.init(),ry(e)}()}var ly=class{modifyById(e,t){let n=this;if(void 0===n[e])throw new Error("not expected");{let i={...n,[e]:t};return Object.setPrototypeOf(i,ly.prototype),i}}add(e,t){return this.runOp({type:1,id:e,data:t})?.data??this}runOp(e){let t=this;if(1===e.type){let n,i=t[e.id];n=void 0===i?{type:2,id:e.id}:{type:1,id:e.id,data:i};let{id:r,data:s}=e,a={...t,[r]:s};return Object.setPrototypeOf(a,ly.prototype),{data:a,actual:e,reverse:n}}if(2===e.type){let{id:n}=e,i=t[n];if(void 0===i)return null;{let r={...t};return Object.setPrototypeOf(r,ly.prototype),delete r[n],{data:r,actual:e,reverse:{type:1,id:n,data:i}}}}return null}};function cy(e){if(void 0!==e.deepFreeze)return void e.deepFreeze(e);let t=Object.getOwnPropertyNames(e);for(let n of t){let t=e[n];t&&"object"==typeof t&&cy(t)}return Object.freeze(e)}var hy=class extends Error{};function uy(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function dy(e,t,n){if(void 0===e?void 0===t?(e=0,t=10):e=t-10:void 0===t&&(t=e+10),e>t){let n=e;e=t,t=n}let i=[],r=1/(n+1);for(let s=0;s<n;s++){let n=e+(t-e)*(s+.75+.5*Math.random())*r;i.push(n)}return i}function py(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function fy(e,t){for(let n of e)!0!==t(n.id,n.data)&&fy(n.children,t)}function my(e,t){if(!0!==t(e.id,e.data))for(let n of e.children)my(n,t)}var gy,vy=class extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,vy.prototype)}deepFreeze(){let e=0;for(;e<this.length;)cy(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let n of e.children)this.fillCaches0(n,e.id)}fillCaches(){if(void 0===this.objCaches){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(0!==e.length)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let n=this.parent(e);if(n===t)return!0;e=n}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(!t)return e;e=t}return e}isDescendantOf(e,t){for(;e;){let n=this.parent(e);if(n===t)return!0;e=n}return!1}data(e){return this.get(e)?.data}has(e){return void 0!==this.childrenOf(e)}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){return null===e?this:this.get(e)?.children}traverseFrom(e,t){if(null===e)this.traverse(t);else{let n=this.get(e);n&&my(n,t)}}traverse(e){fy(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return null===e?this:this.get(e).children}modifyById(e,t){if(void 0===this.get(e))throw new Error("not expected");{let n=this.parent(e),i=this.childrenArray(n),r=i.findIndex((t=>t.id===e));if(r<0)throw new Error("not expected");let s=i[r];return i=[...i],i[r]={...s,data:t},this.modifyArrayBy(n,i)}}modifyArrayBy(e,t){let n=e,i=t;for(;null!==n;){let e=i,t=n;if(n=this.parent(n),void 0===n)throw new Error;i=this.childrenArray(n);let r=i.findIndex((e=>e.id===t));if(r<0)throw new Error;i=[...i],i[r]={...i[r],children:e}}Object.setPrototypeOf(i,vy.prototype);let r=i;return r.fillCaches(),r}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec(e){let{id:t,children:n}=e;if(void 0!==this.get(t))return!0;for(let i of n)if(this.checkDuplicatedIdRec(i))return!0;return!1}addOp(e){let{parent:t,fi:n,id:i,data:r,children:s}=e;if(null!==t&&void 0===this.get(t))return null;if(this.checkDuplicatedIdRec(e))return null;{let a=t,o=this.childrenArray(a),l={fi:n,id:i,data:r,children:s};return o=[...o,l],o.sort(((e,t)=>e.fi-t.fi)),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(a,o),actual:e,reverse:{type:8,id:i}}}}deleteOp(e){let{id:t}=e;if(null===this.get(t))return null;{let n=this.parent(t);if(void 0===n)return null;let i=this.childrenArray(n),r=i.findIndex((e=>e.id===t));e.localIndex=r,i=[...i];let s=i.splice(r,1)[0];return{data:this.modifyArrayBy(n,i),actual:e,reverse:{type:7,...s,parent:n}}}}moveOp(e){let{parent:t,fi:n,id:i}=e;if(null!==t&&void 0===this.get(t))return this.deleteOp({type:8,id:i});if(null!==t){let e=t;for(;null!==e;){if(void 0===e)throw new Error;if(e===i)throw new hy("cyclic tree");e=this.parent(e)}}let r=this.parent(i);if(void 0===r)return null;let s=r,a=this.childrenArray(r),o=a.findIndex((e=>e.id===i));a=[...a];let l=a.splice(o,1)[0],c=this.modifyArrayBy(r,a);r=t,a=c.childrenArray(r);let h=l.fi;return l={...l,fi:n},a=[...a,l],a.sort(((e,t)=>e.fi-t.fi)),e.localIndex=a.indexOf(l),c=c.modifyArrayBy(r,a),{data:c,actual:e,reverse:{type:9,parent:s,fi:h,id:i}}}previous(e,t){if(null===t){let t=this.childrenArray(e);return 0===t.length?null:t[t.length-1].id}let n=null;for(let i of this.childrenArray(e)){if(i.id===t)return n;n=i.id}return null}traverseSortNext(e){let t=this.parent(e);if(void 0!==t){let n=this.childrenArray(t),i=n.findIndex((t=>t.id===e))+1;if(i<n.length)return n[i].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(void 0!==t){let n=this.childrenArray(t),i=n.findIndex((t=>t.id===e))-1;return i>=0?this.traverseSortPrevious(n[i].id):t}}getAllSorted(e){let t=[];for(let n of e){let e=this.getWithSortKey(n.id);void 0!==e&&t.push({...n,...e})}t.sort(((e,t)=>function(e,t){let n=0;for(;n<e.length&&n<t.length;){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1;n+=1}return n!==t.length?-1:n!==e.length?1:0}(e.sortKey,t.sortKey)));for(let n of t)delete n.sortKey;return t}getWithSortKey(e){var t=e;let n=[],i=this.get(t),r=i;if(void 0!==i){for(;t;)n.splice(0,0,i.fi),null!==(t=this.parent(t))&&(i=this.get(t));return{...r,sortKey:n}}}insertBeforeHelper(e,t,n){return this.insertAfterHelper(e,this.previous(e,t),n)}insertAfterHelper(e,t,n){let i=this.childrenArray(e);if(null===t){if(0===i.length)return dy(0,n,n);{let e=i[0].fi;return dy(e-n,e,n)}}{let r=this.get(t);if(void 0===r||this.parent(t)!==e)throw new Error("illegal args");let s=i.find((e=>e.fi>r.fi));if(void 0===s){let e=i[i.length-1].fi;return dy(e,e+n,n)}return dy(r.fi,s.fi,n)}}};(gy||(gy={})).runOp=function(e,t){if(0!==t.type)return null;if(Array.isArray(e)){let n=t.props,i={},r=[...e],s=!1;if(n)for(let e of Object.keys(n)){let t=parseInt(e);if(isNaN(t))throw new Error("wrong index");i[e]=r[t],r[t]=n[e],s=!0}return s?{data:r,actual:t,reverse:{type:0,props:i}}:null}{let n=t.props,i={},r={...e},s=!1;if(n)for(let e of Object.keys(n)){i[e]=r[e];let t=n[e];void 0===t?delete r[e]:r[e]=t,s=!0}return s?{data:r,actual:t,reverse:{type:0,props:i}}:null}};var yy=class extends Array{constructor(){super(...arguments),Object.setPrototypeOf(this,yy.prototype)}deepFreeze(){let e=0;for(;e<this.length;)cy(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(void 0===this.objCaches){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(0!==e.length)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){return this.get(e)?.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(void 0===this.get(e))throw new Error("not expected");{let n=this,i=n.findIndex((t=>t.id===e));if(i<0)throw new Error("not expected");let r=n[i];return n=[...n],n[i]={...r,data:t},this.modifyArrayBy(n)}}modifyArrayBy(e){Object.setPrototypeOf(e,yy.prototype);let t=e;return typeof process<"u"||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:n,data:i}=e,r=this,s={fi:t,id:n,data:i};return r=[...r,s],r.sort(((e,t)=>e.fi-t.fi)),e.localIndex=r.indexOf(s),{data:this.modifyArrayBy(r),actual:e,reverse:{type:5,id:n}}}deleteOp(e){let{id:t}=e,n=this,i=n.findIndex((e=>e.id===t));if(-1===i)return null;e.localIndex=i,n=[...n];let r=n.splice(i,1)[0];return{data:this.modifyArrayBy(n),actual:e,reverse:{type:4,...r}}}moveOp(e){let{fi:t,id:n}=e,i=this;i=[...i];let r=i.findIndex((e=>e.id===n));if(-1===r)return null;let s=i[r].fi,a={...i[r],fi:t};return i[r]=a,i.sort(((e,t)=>e.fi-t.fi)),e.localIndex=i.indexOf(a),{data:this.modifyArrayBy(i),actual:e,reverse:{type:6,fi:s,id:n}}}previous(e){if(null===e)return 0===this.length?null:this[this.length-1].id;let t=null;for(let n of this){if(n.id===e)return t;t=n.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let n=this;if(null===e){if(0===n.length)return dy(0,t,t);{let e=n[0].fi;return dy(e-t,e,t)}}{let i=this.get(e);if(void 0===i)throw new Error("illegal args");let r=n.find((e=>e.fi>i.fi));if(void 0===r){let e=n[n.length-1].fi;return dy(e,e+t,t)}return dy(i.fi,r.fi,t)}}};function by(e){return e&&"object"==typeof e&&e instanceof Ay}var wy,xy,Ey,Cy,Ay=class{unusedFunOverridesTable(e){}runOp(e){let t=[],n=this,i=0,r={};for(;i<e.path.length;){if(t.push(n),n=void 0===n?void 0:n[e.path[i]],void 0!==n&&!by(n))return null;i+=1}n=n?uy(n):new Ay;for(let[s,a]of Object.entries(e.props)){let e=n[s];r[s]=e,void 0===a?delete n[s]:n[s]=a}for(;i>0;){if(0===Object.keys(n).length){let r=t[i-1];r&&(n=uy(r),delete n[e.path[i-1]])}else{let r=t[i-1];if(r){let t=uy(r);t[e.path[i-1]]=n,n=t}else{let t=new Ay;t[e.path[i-1]]=n,n=t}}i-=1}return{data:Object.setPrototypeOf(n,Ay.prototype),actual:e,reverse:{...e,props:r}}}};function Sy(e,t){if(void 0===t)return;let n=!1,i=e.map((e=>{let i=e.id,r=_y(e.data,t[i]);if(n=n||void 0!==r,void 0===r&&(r=e.data),e.children){let s=Sy(e.children,t);return void 0!==s?n=!0:s=e.children,{...e,id:i,data:r,children:s}}return{...e,id:i,data:r}}));return n?i:void 0}function _y(e,t){if(!by(t))return t;if(e instanceof vy){let n=Sy(e,t);return void 0!==n&&Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}if(e instanceof yy)return function(e,t){if(void 0===t)return;let n=!1,i=e.map((e=>{let i=e.id,r=_y(e.data,t[i]);return n=n||void 0!==r,void 0===r&&(r=e.data),{...e,id:i,data:r}}));return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}(e,t);if(Array.isArray(e)){let n=!1,i=e.map(((e,i)=>{let r=_y(e,t[i]);return n=n||void 0!==r,void 0===r&&(r=e),r}));return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}if(e instanceof Ay)return Ty(e,t);if(e&&"object"==typeof e){let n={},i=!1;for(let[r,s]of Object.entries(e)){let e=_y(s,t[r]);i=i||void 0!==e,void 0===e&&(e=s),n[r]=e}return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}}function Ty(e,t){if(void 0===e)return t;if(void 0===t)return e;if(!by(t))return t;if(!by(e))return wy.apply(e,t);let n=new Set;for(let r of Object.keys(e))n.add(r);for(let r of Object.keys(t))n.add(r);let i=new Ay;for(let r of n){let n=Ty(void 0===e?void 0:e[r],void 0===t?void 0:t[r]);i[r]=n}return i}function Py(e,t){let n={cur:[],result:[],len:0};return[e=Oy(e,t,n)??e,n.result]}function My(e,t){return null===e?null:(e.cur[e.len]=t,e.len+=1,e)}function Ny(e){e&&(e.len-=1)}function Iy(e,t,n){let i=!1,r=e.map((e=>{let r=e.id,s=t[r];if(void 0!==s&&"string"==typeof s&&(i=!0,r=s,null!==n))throw new Error("not supported");let a=Oy(e.data,t,My(n,r));Ny(n),i=i||void 0!==a,void 0===a&&(a=e.data);let o=Iy(e.children,t,n);return void 0!==o?i=!0:o=e.children,{...e,id:r,data:a,children:o}}));if(i)return r}function Oy(e,t,n){if(e instanceof vy){let i=Iy(e,t,n);return void 0!==i&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}if(e instanceof yy)return function(e,t,n){let i=!1,r=e.map((e=>{let r=e.id,s=t[r];if(void 0!==s&&"string"==typeof s&&(i=!0,r=s,null!==n))throw new Error("not supported");let a=Oy(e.data,t,My(n,r));return Ny(n),i=i||void 0!==a,void 0===a&&(a=e.data),{...e,id:r,data:a}}));if(i)return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}(e,t,n);if(Array.isArray(e)){let i=!1,r=e.map(((e,r)=>{let s=Oy(e,t,My(n,r));return Ny(n),i=i||void 0!==s,void 0===s&&(s=e),s}));return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}if(e&&"object"==typeof e&&!py(e)){let i={},r=!1;for(let[s,a]of Object.entries(e))if("name"!==s&&"variableId"!==s){let e=t[s];if("string"==typeof e){if(null!==n)throw new Error("not supported");r=!0,s=e}let o=Oy(a,t,My(n,s));Ny(n),r=r||void 0!==o,void 0===o&&(o=a),i[s]=o}else i[s]=a;return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}if("string"==typeof e){let i=t[e];return void 0!==i&&function(e){if(null===e)return null;e.result.push(e.cur.slice(0,e.len))}(n),i}}(e=>{e.apply=function(e,t){return _y(e,t)??e},e.merge=function(e,t){return Ty(e,t)},e.filterOp=function(e,t){let n=0,i=t.path,r=e;for(;n<i.length&&void 0!==r;){if(r=Gy.zoomOnce(r,i[n]),void 0===r)return t;if(!by(r))return;n+=1}if(void 0===r)return t;if(by(r)){if(0===t.type){let e={...t.props};for(let t of Object.keys(r))delete e[t];return{...t,props:e}}if(1===t.type||4===t.type||7===t.type){let e=Sy([t],r);return e?(console.log(e),e):t}return t}}})(wy||(wy={})),(e=>{e.replaceProps=function(e,t){let n=Gy.zoom(t,e.path);if("object"==typeof n){let t={};for(let i of Object.keys(e.props))t[i]=n[i];return{...e,props:t}}return{...e,props:{}}}})(xy||(xy={})),(e=>{function t(e,t){let n=t.path;for(var i=[];;){let r;if(e instanceof Ay&&0===t.type&&(r=e.runOp({...t,path:n.slice(i.length)}),null===r&&(r=void 0)),void 0===r&&i.length===n.length&&(r=e instanceof vy||e instanceof yy||e instanceof ly?e.runOp(t):gy.runOp(e,t)),void 0!==r){if(null!==r){let e=r.data;for(let t=i.length-1;t>=0;t--){let r=n[t],s=i[t];if(s instanceof vy){if("number"==typeof r)throw new Error("illegal arg");e=s.modifyById(r,e)}else if(s instanceof yy){if("number"==typeof r)throw new Error("illegal arg");e=s.modifyById(r,e)}else if(s instanceof ly){if("number"==typeof r)throw new Error("illegal arg");e=s.modifyById(r,e)}else if(s instanceof Ay){let t={...s,[r]:e};e=Object.setPrototypeOf(t,Ay.prototype)}else{if("object"!=typeof s)return null;if(Array.isArray(s)){if("string"==typeof r&&(r=parseInt(r),isNaN(r)))throw new Error("Invalid path");let t=e;e=[...s],e[r]=t}else e={...s,[r]:e}}}return{data:e,actual:{...r.actual,path:n},reverse:{...r.reverse,path:n}}}return null}let s,a=n[i.length];if(e instanceof vy){if("number"==typeof a)throw new Error("");s=e.get(a)?.data}else if(e instanceof yy){if("number"==typeof a)throw new Error("");s=e.get(a)?.data}else null!==e&&(s=e[a]);if(void 0===s)return null;i.push(e),e=s}}function n(e,t){for(let n=0;n<e.length&&n<t.length;n++)if(e[n]!==t[n])return!0;return!1}function i(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}e.drop=function(e,t){return{...e,path:e.path.slice(t)}},e.applySimple=function(e,n){return t(e,n)?.data??e},e.apply=t,e.pathDisjoint=n,e.pathEq=i,e.commutative=function(e,t){return n(e.path,t.path)},e.subsumed=function(e,t){return!(0!==e.type||0!==t.type||!i(e.path,t.path))&&Object.keys(e.props).every((e=>void 0!==t.props[e]))}})(Ey||(Ey={})),(e=>{function t(e,t){var n=e;let i=[],r=[];for(let a of t)try{if(3===a.type||5===a.type&&"variables"===a.path[a.path.length-1]){let e,t,s;if(3===a.type?(e=Gy.zoom(n,[...a.path,a.id]),s=Ey.apply(n,{...a,type:2})):(e=Gy.zoom(n,[...a.path,a.id,"value"]),s=Ey.apply(n,a)),null!==s){n=s.data;let[o,l]=Py(n,{[a.id]:e});n=o;for(let s=0;s<l.length;s++){let o=l[s],c=o.pop();if("number"==typeof c){let i=[c];for(let e=s+1;e<l.length;e++){let t=l[e],n=t[t.length-1];if("number"!=typeof n||!Gy.equal(o,t.slice(0,t.length-1)))break;i.push(n),l.splice(e,1)}let r=Gy.zoom(n,o);t=r.map(((e,t)=>i.includes(t)?a.id:e)),e=r,c=o.pop()}else{if("alphaOverride"===c||"alpha"===c){e/=100;let t=e,i=Gy.zoom(n,o.slice(0,o.length-2)),r=i.layers.map((e=>e.id===o[o.length-1]?{...e,data:{...e.data,[c]:t}}:e));Object.setPrototypeOf(r,Object.getPrototypeOf(i.layers)),i.layers=r}t=a.id}i.push({type:0,path:o,props:{[c]:e}}),r.push({type:0,path:o,props:{[c]:t}})}r.push(s.reverse),i.push(s.actual)}}else{let e=Ey.apply(n,a);null!==e&&(i.push(e.actual),n=e.data,r.push(e.reverse))}}catch(s){if(s instanceof hy)return null;throw s}return{data:n,actual:i,reverse:r.reverse()}}e.empty=function(){return[]},e.removePrefix=function(e,t){let n=[];for(let i of e){let[e,...r]=i.path;e===t&&n.push({...i,path:r})}return n},e.addPrefix=function(e,t){return e.map((e=>({...e,path:[t,...e.path]})))},e.concat=function(e,t){return[...e,...t]},e.compress=function(e,t){return[...e.filter((e=>!t.some((t=>Ey.subsumed(e,t))))),...t]},e.commutative=function(e,t){return e.every((e=>t.every((t=>Ey.commutative(e,t)))))},e.applyAll=function(e,n){for(let i of n){let n=t(e,i);null!==n&&(e=n.data)}return e},e.apply=t})(Cy||(Cy={}));var Dy=Symbol(),Ly=Symbol(),Ry=Symbol(),ky=class{reportOp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=this;if(null===t)return;i._current=t.data;let r=n;for(;!(i instanceof qy);){let e=i._path,t=i._current;if(""!==e&&r.splice(0,0,e),i=i._parent,null===i)return;i.update(e,t)}i.push(r,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let n=t[Ry];n&&n(),delete this._children[e]}}}},By=class extends ky{constructor(e,t,n){super(),this._parent=e,this._path=t,this._current=n}update(e,t){if(Array.isArray(this._current)){if("string"==typeof e&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,gy.runOp(this._current,e),e.path)}},Uy=class extends ky{constructor(e,t,n){super(),this._parent=e,this._path=t,this._current=n}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,ly.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},zy={get(e,t){if(t===Ry)return()=>{e._parent=null};if(t===Dy)return e._current;if(t===Ly)return e;let{_current:n,_children:i}=e;if("push"===t&&Array.isArray(n))throw new Error("not supported to expand array");let r=void 0===i?void 0:i[t];if(void 0!==r)return r;let s=n[t],a=Ky(e,t,s);return a!==s?(void 0===i&&(i={},e._children=i),i[t]=a,a):s},has:(e,t)=>t in e._current,ownKeys:e=>Reflect.ownKeys(e._current),defineProperty(){throw Error("not supported")},getPrototypeOf:e=>Object.getPrototypeOf(e._current),setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let n=e._current,i=Reflect.getOwnPropertyDescriptor(n,t);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:n[t]}}},Fy={...zy,set(e,t,n){let i={type:0,props:{[t]:Xy(n)??n}};return e.deleteChildren(t),e.runOp(i),!0},deleteProperty(e,t){let n={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(n),!0}},jy={...zy,set(e,t,n){return void 0===n?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:n})),!0},deleteProperty:(e,t)=>(e.runOp({type:2,id:t}),!0)},Vy=class extends ky{constructor(e,t,n){super(),this._children={},this._parent=e,this._path=t,this._current=n,this[Ry]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse(((t,n)=>{e(t,this.data(t))}))}data(e){let{_current:t,_children:n}=this,i=void 0===n?void 0:n[e];if(void 0!==i)return i;let r=t.get(e)?.data,s=Ky(this,e,r);return s!==r?(void 0===n&&(n={},this._children=n),n[e]=s,s):r}add(e,t,n,i,r){this.runOp({type:7,parent:e,fi:t,id:n,data:i,children:r})}move(e,t,n){this.runOp({type:9,parent:e,fi:t,id:n})}insertAfter(e,t,n){let i=this._current.insertAfterHelper(e,t,n.length);for(let r=0;r<n.length;r++){let t=n[r];this.add(e,i[r],t.id,t.data,t.children)}}insertBefore(e,t,n){let i=this._current.insertBeforeHelper(e,t,n.length);for(let r=0;r<n.length;r++){let t=n[r];this.add(e,i[r],t.id,t.data,t.children)}}moveAfter(e,t,n){let i=this._current.insertAfterHelper(e,t,n.length);for(let r=0;r<n.length;r++){let t=n[r];this.move(e,i[r],t)}}moveBefore(e,t,n){let i=this._current.insertBeforeHelper(e,t,n.length);for(let r=0;r<n.length;r++){let t=n[r];this.move(e,i[r],t)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},Hy=class extends ky{constructor(e,t,n){super(),this._children={},this._parent=e,this._path=t,this._current=n,this[Ry]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let n=0;n<t;n++){let t=this._current[n].id,i=this._current[n].fi;e(this.data(this._current[n].id),t,i)}}find(e){let t=this.length;for(let n=0;n<t;n++){let t=this._current[n].id;if(e(this.data(t),t))return this.get(t)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){let{_current:t,_children:n}=this,i=void 0===n?void 0:n[e];if(void 0!==i)return i;let r=t.get(e)?.data,s=Ky(this,e,r);return s!==r?(void 0===n&&(n={},this._children=n),n[e]=s,s):r}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,n){this.runOp({type:4,fi:e,id:t,data:n})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let n=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let e=t[i];this.add(n[i],e.id,e.data)}}insertBefore(e,t){let n=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let e=t[i];this.add(n[i],e.id,e.data)}}moveAfter(e,t){let n=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let e=t[i];this.move(n[i],e)}}moveBefore(e,t){let n=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let e=t[i];this.move(n[i],e)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function Wy(e,t,n){if(e.length>0){let i=e[e.length-1];if(0===i.type&&0===t.type&&Gy.equal(i.path,n))return void Object.assign(i.props,t.props)}e.push({...t,path:n})}var Gy,qy=class extends ky{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(""!==e)throw new Error("");this._current=t}push(e,t,n,i){Wy(this.ts,t,e),Wy(this.actual,n,e),Wy(this.reverse,i,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function Ky(e,t,n){return n instanceof vy?new Vy(e,t,n):n instanceof yy?new Hy(e,t,n):n instanceof ly?new Proxy(new Uy(e,t,n),jy):null!==n&&"object"==typeof n?py(n)?n:new Proxy(new By(e,t,n),Fy):n}function Yy(e){let t=new qy(e);return[Ky(t,"",e),t]}function Qy(e,t){let[n,i]=Yy(e);return t(n),i.result()}function Xy(e){return e instanceof Vy||e instanceof Hy?e._current:null!==e&&"object"==typeof e?e[Dy]:e}function Zy(e,t){let n=[];if(!(t.length<=e.length))return null;for(var i=0;i<t.length;){if("*"===t[i])n.push(e[i]);else if(e[i]!==t[i])return null;i+=1}return n}(e=>{function t(e,t){return(e instanceof vy||e instanceof Vy)&&"string"==typeof t||(e instanceof yy||e instanceof Hy)&&"string"==typeof t?e.data(t):"number"==typeof t&&Array.isArray(e)||"string"==typeof t&&"object"==typeof e&&null!==e?e[t]:void 0}function n(e,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(;i<n.length&&void 0!==e;)e=t(e,n[i]),i+=1;return e}e.equal=function(e,t){if(t.length!==e.length)return!1;for(var n=0;n<e.length;){if(e[n]!==t[n])return!1;n+=1}return!0},e.removeOverridden=function(e,t,i){let r=n(i,e);if(void 0!==r&&"object"==typeof r&&null!==r){let e={...t};return Object.keys(r).forEach((t=>{delete e[t]})),e}return t},e.zoomOnce=t,e.zoom=n})(Gy||(Gy={}));var Jy,$y=class{},eb=class extends $y{constructor(e){super(),this.id=e}},tb=class extends $y{constructor(e){super(),this.data=e}};try{Jy=new TextDecoder}catch{}var nb,ib,rb,sb,ab,ob,lb,cb=0,hb=[],ub=hb,db=0,pb={},fb=0,mb=0,gb=[],vb={useRecords:!1,mapsAsObjects:!0},yb=class{},bb=new yb;bb.name="MessagePack 0xC1";var wb=!1,xb=class{constructor(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(nb)return qb((()=>(Kb(),this?this.unpack(e,t):xb.prototype.unpack.call(vb,e,t))));ib=t>-1?t:e.length,cb=0,db=0,mb=0,sb=null,ub=hb,ab=null,nb=e;try{lb=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(Me){throw nb=null,e instanceof Uint8Array?Me:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}if(this instanceof xb){if(pb=this,this.structures)return rb=this.structures,Eb();(!rb||rb.length>0)&&(rb=[])}else pb=vb,(!rb||rb.length>0)&&(rb=[]);return Eb()}unpackMultiple(e,t){let n,i=0;try{wb=!0;let r=e.length,s=this?this.unpack(e,r):Xb.unpack(e,r);if(!t){for(n=[s];cb<r;)i=cb,n.push(Eb());return n}for(t(s);cb<r;)if(i=cb,!1===t(Eb()))return}catch(ux){throw ux.lastPosition=i,ux.values=n,ux}finally{wb=!1,Kb()}}_mergeStructures(e,t){for(let n=0,i=(e=e||[]).length;n<i;n++){let t=e[n];t&&(t.isShared=!0,n>=32&&(t.highByte=n-32>>5))}e.sharedLength=e.length;for(let n in t||[])if(n>=0){let i=e[n],r=t[n];r&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[n]=i),e[n]=r)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function Eb(){try{if(!pb.trusted&&!wb){let e=rb.sharedLength||0;e<rb.length&&(rb.length=e)}let e=Ab();if(cb==ib)rb.restoreStructures&&Cb(),rb=null,nb=null,ob&&(ob=null);else{if(cb>ib){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}if(!wb)throw new Error("Data read, but end of buffer not reached")}return e}catch(u_){throw rb.restoreStructures&&Cb(),Kb(),(u_ instanceof RangeError||u_.message.startsWith("Unexpected end of buffer"))&&(u_.incomplete=!0),u_}}function Cb(){for(let e in rb.restoreStructures)rb[e]=rb.restoreStructures[e];rb.restoreStructures=null}function Ab(){let e=nb[cb++];if(e<160){if(e<128){if(e<64)return e;{let t=rb[63&e]||pb.getStructures&&Pb()[63&e];return t?(t.read||(t.read=_b(t,63&e)),t.read()):e}}if(e<144){if(e-=128,pb.mapsAsObjects){let t={};for(let n=0;n<e;n++)t[Vb()]=Ab();return t}{let t=new Map;for(let n=0;n<e;n++)t.set(Ab(),Ab());return t}}{e-=144;let t=new Array(e);for(let n=0;n<e;n++)t[n]=Ab();return t}}if(e<192){let t=e-160;if(mb>=cb)return sb.slice(cb-fb,(cb+=t)-fb);if(0==mb&&ib<140){let e=t<16?Ub(t):Bb(t);if(null!=e)return e}return Mb(t)}{let t;switch(e){case 192:return null;case 193:return ab?(t=Ab(),t>0?ab[1].slice(ab.position1,ab.position1+=t):ab[0].slice(ab.position0,ab.position0-=t)):bb;case 194:return!1;case 195:return!0;case 196:return zb(nb[cb++]);case 197:return t=lb.getUint16(cb),cb+=2,zb(t);case 198:return t=lb.getUint32(cb),cb+=4,zb(t);case 199:return Fb(nb[cb++]);case 200:return t=lb.getUint16(cb),cb+=2,Fb(t);case 201:return t=lb.getUint32(cb),cb+=4,Fb(t);case 202:if(t=lb.getFloat32(cb),pb.useFloat32>2){let e=Yb[(127&nb[cb])<<1|nb[cb+1]>>7];return cb+=4,(e*t+(t>0?.5:-.5)|0)/e}return cb+=4,t;case 203:return t=lb.getFloat64(cb),cb+=8,t;case 204:return nb[cb++];case 205:return t=lb.getUint16(cb),cb+=2,t;case 206:return t=lb.getUint32(cb),cb+=4,t;case 207:return pb.int64AsNumber?(t=4294967296*lb.getUint32(cb),t+=lb.getUint32(cb+4)):t=lb.getBigUint64(cb),cb+=8,t;case 208:return lb.getInt8(cb++);case 209:return t=lb.getInt16(cb),cb+=2,t;case 210:return t=lb.getInt32(cb),cb+=4,t;case 211:return pb.int64AsNumber?(t=4294967296*lb.getInt32(cb),t+=lb.getUint32(cb+4)):t=lb.getBigInt64(cb),cb+=8,t;case 212:if(t=nb[cb++],114==t)return Hb(63&nb[cb++]);{let e=gb[t];if(e)return e.read?(cb++,e.read(Ab())):e.noBuffer?(cb++,e()):e(nb.subarray(cb,++cb));throw new Error("Unknown extension "+t)}case 213:return t=nb[cb],114==t?(cb++,Hb(63&nb[cb++],nb[cb++])):Fb(2);case 214:return Fb(4);case 215:return Fb(8);case 216:return Fb(16);case 217:return t=nb[cb++],mb>=cb?sb.slice(cb-fb,(cb+=t)-fb):Nb(t);case 218:return t=lb.getUint16(cb),mb>=(cb+=2)?sb.slice(cb-fb,(cb+=t)-fb):Ib(t);case 219:return t=lb.getUint32(cb),mb>=(cb+=4)?sb.slice(cb-fb,(cb+=t)-fb):Ob(t);case 220:return t=lb.getUint16(cb),cb+=2,Lb(t);case 221:return t=lb.getUint32(cb),cb+=4,Lb(t);case 222:return t=lb.getUint16(cb),cb+=2,Rb(t);case 223:return t=lb.getUint32(cb),cb+=4,Rb(t);default:if(e>=224)return e-256;if(void 0===e){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw new Error("Unknown MessagePack token "+e)}}}var Sb=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function _b(e,t){function n(){if(n.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map((e=>Sb.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()")).join(",")+"}}")(Ab);return 0===e.highByte&&(e.read=Tb(t,e.read)),n()}let i={};for(let t=0,n=e.length;t<n;t++){i[e[t]]=Ab()}return i}return n.count=0,0===e.highByte?Tb(t,n):n}var Tb=(e,t)=>function(){let n=nb[cb++];if(0===n)return t();let i=e<32?-(e+(n<<5)):e+(n<<5),r=rb[i]||Pb()[i];if(!r)throw new Error("Record id is not defined for "+i);return r.read||(r.read=_b(r,e)),r.read()};function Pb(){let e=qb((()=>(nb=null,pb.getStructures())));return rb=pb._mergeStructures(e,rb)}var Mb=Db,Nb=Db,Ib=Db,Ob=Db;function Db(e){let t;if(e<16&&(t=Ub(e)))return t;if(e>64&&Jy)return Jy.decode(nb.subarray(cb,cb+=e));let n=cb+e,i=[];for(t="";cb<n;){let e=nb[cb++];if(0===(128&e))i.push(e);else if(192===(224&e)){let t=63&nb[cb++];i.push((31&e)<<6|t)}else if(224===(240&e)){let t=63&nb[cb++],n=63&nb[cb++];i.push((31&e)<<12|t<<6|n)}else if(240===(248&e)){let t=(7&e)<<18|(63&nb[cb++])<<12|(63&nb[cb++])<<6|63&nb[cb++];t>65535&&(t-=65536,i.push(t>>>10&1023|55296),t=56320|1023&t),i.push(t)}else i.push(e);i.length>=4096&&(t+=kb.apply(String,i),i.length=0)}return i.length>0&&(t+=kb.apply(String,i)),t}function Lb(e){let t=new Array(e);for(let n=0;n<e;n++)t[n]=Ab();return t}function Rb(e){if(pb.mapsAsObjects){let t={};for(let n=0;n<e;n++)t[Vb()]=Ab();return t}{let t=new Map;for(let n=0;n<e;n++)t.set(Ab(),Ab());return t}}var kb=String.fromCharCode;function Bb(e){let t=cb,n=new Array(e);for(let i=0;i<e;i++){let e=nb[cb++];if((128&e)>0)return void(cb=t);n[i]=e}return kb.apply(String,n)}function Ub(e){if(e<4){if(e<2){if(0===e)return"";{let e=nb[cb++];return(128&e)>1?void(cb-=1):kb(e)}}{let t=nb[cb++],n=nb[cb++];if((128&t)>0||(128&n)>0)return void(cb-=2);if(e<3)return kb(t,n);let i=nb[cb++];return(128&i)>0?void(cb-=3):kb(t,n,i)}}{let t=nb[cb++],n=nb[cb++],i=nb[cb++],r=nb[cb++];if((128&t)>0||(128&n)>0||(128&i)>0||(128&r)>0)return void(cb-=4);if(e<6){if(4===e)return kb(t,n,i,r);{let e=nb[cb++];return(128&e)>0?void(cb-=5):kb(t,n,i,r,e)}}if(e<8){let s=nb[cb++],a=nb[cb++];if((128&s)>0||(128&a)>0)return void(cb-=6);if(e<7)return kb(t,n,i,r,s,a);let o=nb[cb++];return(128&o)>0?void(cb-=7):kb(t,n,i,r,s,a,o)}{let s=nb[cb++],a=nb[cb++],o=nb[cb++],l=nb[cb++];if((128&s)>0||(128&a)>0||(128&o)>0||(128&l)>0)return void(cb-=8);if(e<10){if(8===e)return kb(t,n,i,r,s,a,o,l);{let e=nb[cb++];return(128&e)>0?void(cb-=9):kb(t,n,i,r,s,a,o,l,e)}}if(e<12){let c=nb[cb++],h=nb[cb++];if((128&c)>0||(128&h)>0)return void(cb-=10);if(e<11)return kb(t,n,i,r,s,a,o,l,c,h);let u=nb[cb++];return(128&u)>0?void(cb-=11):kb(t,n,i,r,s,a,o,l,c,h,u)}{let c=nb[cb++],h=nb[cb++],u=nb[cb++],d=nb[cb++];if((128&c)>0||(128&h)>0||(128&u)>0||(128&d)>0)return void(cb-=12);if(e<14){if(12===e)return kb(t,n,i,r,s,a,o,l,c,h,u,d);{let e=nb[cb++];return(128&e)>0?void(cb-=13):kb(t,n,i,r,s,a,o,l,c,h,u,d,e)}}{let p=nb[cb++],f=nb[cb++];if((128&p)>0||(128&f)>0)return void(cb-=14);if(e<15)return kb(t,n,i,r,s,a,o,l,c,h,u,d,p,f);let m=nb[cb++];return(128&m)>0?void(cb-=15):kb(t,n,i,r,s,a,o,l,c,h,u,d,p,f,m)}}}}}function zb(e){return pb.copyBuffers?Uint8Array.prototype.slice.call(nb,cb,cb+=e):nb.subarray(cb,cb+=e)}function Fb(e){let t=nb[cb++];if(gb[t])return gb[t](nb.subarray(cb,cb+=e));throw new Error("Unknown extension type "+t)}var jb=new Array(4096);function Vb(){let e=nb[cb++];if(!(e>=160&&e<192))return cb--,Ab();if(e-=160,mb>=cb)return sb.slice(cb-fb,(cb+=e)-fb);if(!(0==mb&&ib<180))return Mb(e);let t,n=4095&(e<<5^(e>1?lb.getUint16(cb):e>0?nb[cb]:0)),i=jb[n],r=cb,s=cb+e-3,a=0;if(i&&i.bytes==e){for(;r<s;){if(t=lb.getUint32(r),t!=i[a++]){r=1879048192;break}r+=4}for(s+=3;r<s;)if(t=nb[r++],t!=i[a++]){r=1879048192;break}if(r===s)return cb=r,i.string;s-=3,r=cb}for(i=[],jb[n]=i,i.bytes=e;r<s;)t=lb.getUint32(r),i.push(t),r+=4;for(s+=3;r<s;)t=nb[r++],i.push(t);let o=e<16?Ub(e):Bb(e);return i.string=null!=o?o:Mb(e)}var Hb=(e,t)=>{var n=Ab();let i=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,n.highByte=t);let r=rb[e];return r&&r.isShared&&((rb.restoreStructures||(rb.restoreStructures=[]))[e]=r),rb[e]=n,n.read=_b(n,i),n.read()},Wb="object"==typeof self?self:global;gb[0]=()=>{},gb[0].noBuffer=!0,gb[101]=()=>{let e=Ab();return(Wb[e[0]]||Error)(e[1])},gb[105]=e=>{let t=lb.getUint32(cb-4);ob||(ob=new Map);let n,i=nb[cb];n=i>=144&&i<160||220==i||221==i?[]:{};let r={target:n};ob.set(t,r);let s=Ab();return r.used?Object.assign(n,s):(r.target=s,s)},gb[112]=e=>{let t=lb.getUint32(cb-4),n=ob.get(t);return n.used=!0,n.target},gb[115]=()=>new Set(Ab());var Gb=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((e=>e+"Array"));function qb(e){let t=ib,n=cb,i=db,r=fb,s=mb,a=sb,o=ub,l=ob,c=ab,h=new Uint8Array(nb.slice(0,ib)),u=rb,d=rb.slice(0,rb.length),p=pb,f=wb,m=e();return ib=t,cb=n,db=i,fb=r,mb=s,sb=a,ub=o,ob=l,ab=c,nb=h,wb=f,(rb=u).splice(0,rb.length,...d),pb=p,lb=new DataView(nb.buffer,nb.byteOffset,nb.byteLength),m}function Kb(){nb=null,ob=null,rb=null}gb[116]=e=>{let t=e[0],n=Gb[t];if(!n)throw new Error("Could not find typed array for code "+t);return new Wb[n](Uint8Array.prototype.slice.call(e,1).buffer)},gb[120]=()=>{let e=Ab();return new RegExp(e[0],e[1])},gb[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],n=cb;cb+=t-4,(ab=[Ab(),Ab()]).position0=0,ab.position1=0;let i=cb;cb=n;try{return Ab()}finally{cb=i}},gb[255]=e=>4==e.length?new Date(1e3*(16777216*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+1e3*(4294967296*(3&e[3])+16777216*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+1e3*((128&e[4]?-281474976710656:0)+1099511627776*e[6]+4294967296*e[7]+16777216*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])):new Date("invalid");var Yb=new Array(147);for(let n=0;n<256;n++)Yb[n]=+("1e"+Math.floor(45.15-.30103*n));var Qb,Xb=new xb({useRecords:!1}),Zb=(Xb.unpack,Xb.unpackMultiple,Xb.unpack,new Float32Array(1));new Uint8Array(Zb.buffer,0,4);try{Qb=new TextEncoder}catch{}var Jb,$b,ew,tw,nw,iw=typeof Buffer<"u",rw=iw?Buffer.allocUnsafeSlow:Uint8Array,sw=iw?Buffer:Uint8Array,aw=iw?4294967296:2144337920,ow=0,lw=null,cw=/[\u0080-\uFFFF]/,hw=Symbol("record-id"),uw=class extends xb{constructor(e){super(e),this.offset=0;let t,n,i,r,s,a=0,o=sw.prototype.utf8Write?function(e,t,n){return ew.utf8Write(e,t,n)}:!(!Qb||!Qb.encodeInto)&&function(e,t){return Qb.encodeInto(e,ew.subarray(t)).written},l=this;e||(e={});let c=e&&e.sequential,h=e.structures||e.saveStructures,u=e.maxSharedStructures;if(null==u&&(u=h?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=e.maxOwnStructures;null==d&&(d=h?32:64),c&&!e.saveStructures&&(this.structures=[]);let p=u>32||d+u>64,f=u+64,m=u+d+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,y=0;this.pack=this.encode=function(e,o){if(ew||(ew=new rw(8192),tw=new DataView(ew.buffer,0,8192),ow=0),(nw=ew.length-10)-ow<2048?(ew=new rw(ew.length),tw=new DataView(ew.buffer,0,ew.length),nw=ew.length-10,ow=0):ow=ow+7&2147483640,t=ow,s=l.structuredClone?new Map:null,l.bundleStrings?(lw=["",""],ew[ow++]=214,ew[ow++]=98,lw.position=ow-t,ow+=4):lw=null,n=l.structures,n){n.uninitialized&&(n=l._mergeStructures(l.getStructures()));let e=n.sharedLength||0;if(e>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let t=0;t<e;t++){let e=n[t];if(!e)continue;let i,r=n.transitions;for(let t=0,n=e.length;t<n;t++){let n=e[t];i=r[n],i||(i=r[n]=Object.create(null)),r=i}r[hw]=t+64}a=e}c||(n.nextId=e+64)}i&&(i=!1),r=n||[];try{if(b(e),lw){tw.setUint32(lw.position+t,ow-lw.position-t);let e=lw;lw=null,b(e[0]),b(e[1])}if(l.offset=ow,s&&s.idsToInsert){(ow+=6*s.idsToInsert.length)>nw&&x(ow),l.offset=ow;let e=function(e,t){let n,i=6*t.length,r=e.length-i;for(t.sort(((e,t)=>e.offset>t.offset?1:-1));n=t.pop();){let t=n.offset,s=n.id;e.copyWithin(t+i,t,r),i-=6;let a=t+i;e[a++]=214,e[a++]=105,e[a++]=s>>24,e[a++]=s>>16&255,e[a++]=s>>8&255,e[a++]=255&s,r=t}return e}(ew.subarray(t,ow),s.idsToInsert);return s=null,e}return o&Aw?(ew.start=t,ew.end=ow,ew):ew.subarray(t,ow)}finally{if(n){if(y<10&&y++,v>1e4)n.transitions=null,y=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let e=0,t=g.length;e<t;e++)g[e][hw]=0;g=[]}if(i&&l.saveStructures){let i=n.sharedLength||u;n.length>i&&(n=n.slice(0,i));let r=ew.subarray(t,ow);return!1===l.saveStructures(n,a)?(l._mergeStructures(l.getStructures()),l.pack(e)):(a=i,r)}}o&Sw&&(ow=t)}};let b=e=>{ow>nw&&(ew=x(ow));var n,i=typeof e;if("string"===i){let t,i=e.length;if(lw&&i>=8&&i<4096){let t=cw.test(e);return lw[t?0:1]+=e,ew[ow++]=193,void b(t?-i:i)}t=i<32?1:i<256?2:i<65536?3:5;let r=3*i;if(ow+r>nw&&(ew=x(ow+r)),i<64||!o){let r,s,a,o=ow+t;for(r=0;r<i;r++)s=e.charCodeAt(r),s<128?ew[o++]=s:s<2048?(ew[o++]=s>>6|192,ew[o++]=63&s|128):55296===(64512&s)&&56320===(64512&(a=e.charCodeAt(r+1)))?(s=65536+((1023&s)<<10)+(1023&a),r++,ew[o++]=s>>18|240,ew[o++]=s>>12&63|128,ew[o++]=s>>6&63|128,ew[o++]=63&s|128):(ew[o++]=s>>12|224,ew[o++]=s>>6&63|128,ew[o++]=63&s|128);n=o-ow-t}else n=o(e,ow+t,r);n<32?ew[ow++]=160|n:n<256?(t<2&&ew.copyWithin(ow+2,ow+1,ow+1+n),ew[ow++]=217,ew[ow++]=n):n<65536?(t<3&&ew.copyWithin(ow+3,ow+2,ow+2+n),ew[ow++]=218,ew[ow++]=n>>8,ew[ow++]=255&n):(t<5&&ew.copyWithin(ow+5,ow+3,ow+3+n),ew[ow++]=219,tw.setUint32(ow,n),ow+=4),ow+=n}else if("number"===i)if(e>>>0===e)e<64?ew[ow++]=e:e<256?(ew[ow++]=204,ew[ow++]=e):e<65536?(ew[ow++]=205,ew[ow++]=e>>8,ew[ow++]=255&e):(ew[ow++]=206,tw.setUint32(ow,e),ow+=4);else if((e|0)===e)e>=-32?ew[ow++]=256+e:e>=-128?(ew[ow++]=208,ew[ow++]=e+256):e>=-32768?(ew[ow++]=209,tw.setInt16(ow,e),ow+=2):(ew[ow++]=210,tw.setInt32(ow,e),ow+=4);else{let t;if((t=this.useFloat32)>0&&e<4294967296&&e>=-2147483648){let n;if(ew[ow++]=202,tw.setFloat32(ow,e),t<4||((n=e*Yb[(127&ew[ow])<<1|ew[ow+1]>>7])|0)===n)return void(ow+=4);ow--}ew[ow++]=203,tw.setFloat64(ow,e),ow+=8}else if("object"===i)if(e){if(s){let n=s.get(e);if(n){if(!n.id){let e=s.idsToInsert||(s.idsToInsert=[]);n.id=e.push(n)}return ew[ow++]=214,ew[ow++]=112,tw.setUint32(ow,n.id),void(ow+=4)}s.set(e,{offset:ow-t})}let i=e.constructor;if(i===Object)w(e,!0);else if(i===Array){(n=e.length)<16?ew[ow++]=144|n:n<65536?(ew[ow++]=220,ew[ow++]=n>>8,ew[ow++]=255&n):(ew[ow++]=221,tw.setUint32(ow,n),ow+=4);for(let t=0;t<n;t++)b(e[t])}else if(i===Map){(n=e.size)<16?ew[ow++]=128|n:n<65536?(ew[ow++]=222,ew[ow++]=n>>8,ew[ow++]=255&n):(ew[ow++]=223,tw.setUint32(ow,n),ow+=4);for(let[t,n]of e)b(t),b(n)}else{for(let t=0,n=Jb.length;t<n;t++){if(e instanceof $b[t]){let n=Jb[t];if(n.write)return n.type&&(ew[ow++]=212,ew[ow++]=n.type,ew[ow++]=0),void b(n.write.call(this,e));let i,r=ew,s=tw,a=ow;ew=null;try{i=n.pack.call(this,e,(e=>(ew=r,r=null,(ow+=e)>nw&&x(ow),{target:ew,targetView:tw,position:ow-e})),b)}finally{r&&(tw=s,ow=a,nw=(ew=r).length-10)}return void(i&&(i.length+ow>nw&&x(i.length+ow),ow=fw(i,ew,ow,n.type)))}}w(e,!e.hasOwnProperty)}}else ew[ow++]=192;else if("boolean"===i)ew[ow++]=e?195:194;else if("bigint"===i){if(e<BigInt(1)<<BigInt(63)&&e>=-(BigInt(1)<<BigInt(63)))ew[ow++]=211,tw.setBigInt64(ow,e);else if(e<BigInt(1)<<BigInt(64)&&e>0)ew[ow++]=207,tw.setBigUint64(ow,e);else{if(!this.largeBigIntToFloat)throw new RangeError(e+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");ew[ow++]=203,tw.setFloat64(ow,Number(e))}ow+=8}else if("undefined"===i)this.encodeUndefinedAsNil?ew[ow++]=192:(ew[ow++]=212,ew[ow++]=0,ew[ow++]=0);else{if("function"!==i)throw new Error("Unknown type: "+i);b(this.writeFunction&&this.writeFunction())}},w=!1===this.useRecords?this.variableMapSize?e=>{let t,n=Object.keys(e),i=n.length;i<16?ew[ow++]=128|i:i<65536?(ew[ow++]=222,ew[ow++]=i>>8,ew[ow++]=255&i):(ew[ow++]=223,tw.setUint32(ow,i),ow+=4);for(let r=0;r<i;r++)b(t=n[r]),b(e[t])}:(e,n)=>{ew[ow++]=222;let i=ow-t;ow+=2;let r=0;for(let t in e)(n||e.hasOwnProperty(t))&&(b(t),b(e[t]),r++);ew[i+++t]=r>>8,ew[i+t]=255&r}:e=>{let t,n=Object.keys(e),s=r.transitions||(r.transitions=Object.create(null)),a=0;for(let i=0,r=n.length;i<r;i++){let e=n[i];t=s[e],t||(t=s[e]=Object.create(null),a++),s=t}let o=s[hw];if(o)o>=96&&p?(ew[ow++]=96+(31&(o-=96)),ew[ow++]=o>>5):ew[ow++]=o;else{o=r.nextId,o||(o=64),o<f&&this.shouldShareStructure&&!this.shouldShareStructure(n)?(o=r.nextOwnId,o<m||(o=f),r.nextOwnId=o+1):(o>=m&&(o=f),r.nextId=o+1);let e=n.highByte=o>=96&&p?o-96>>5:-1;s[hw]=o,r[o-64]=n,o<f?(n.isShared=!0,r.sharedLength=o-63,i=!0,e>=0?(ew[ow++]=96+(31&o),ew[ow++]=e):ew[ow++]=o):(e>=0?(ew[ow++]=213,ew[ow++]=114,ew[ow++]=96+(31&o),ew[ow++]=e):(ew[ow++]=212,ew[ow++]=114,ew[ow++]=o),a&&(v+=y*a),g.length>=d&&(g.shift()[hw]=0),g.push(s),b(n))}for(let i=0,r=n.length;i<r;i++)b(e[n[i]])},x=e=>{let n;if(e>16777216){if(e-t>aw)throw new Error("Packed buffer would be larger than maximum buffer size");n=Math.min(aw,4096*Math.round(Math.max((e-t)*(e>67108864?1.25:2),4194304)/4096))}else n=1+(Math.max(e-t<<2,ew.length-1)>>12)<<12;let i=new rw(n);return tw=new DataView(i.buffer,0,n),ew.copy?ew.copy(i,0,t,e):i.set(ew.slice(t,e)),ow-=t,t=0,nw=i.length-10,ew=i}}useBuffer(e){ew=e,tw=new DataView(ew.buffer,ew.byteOffset,ew.byteLength),ow=0}};function dw(e,t,n,i){let r=e.byteLength;if(r+1<256){var{target:s,position:a}=n(4+r);s[a++]=199,s[a++]=r+1}else if(r+1<65536){var{target:s,position:a}=n(5+r);s[a++]=200,s[a++]=r+1>>8,s[a++]=r+1&255}else{var{target:s,position:a,targetView:o}=n(7+r);s[a++]=201,o.setUint32(a,r+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function pw(e,t){let n=e.byteLength;var i,r;if(n<256){var{target:i,position:r}=t(n+2);i[r++]=196,i[r++]=n}else if(n<65536){var{target:i,position:r}=t(n+3);i[r++]=197,i[r++]=n>>8,i[r++]=255&n}else{var{target:i,position:r,targetView:s}=t(n+5);i[r++]=198,s.setUint32(r,n),r+=4}i.set(e,r)}function fw(e,t,n,i){let r=e.length;switch(r){case 1:t[n++]=212;break;case 2:t[n++]=213;break;case 4:t[n++]=214;break;case 8:t[n++]=215;break;case 16:t[n++]=216;break;default:r<256?(t[n++]=199,t[n++]=r):r<65536?(t[n++]=200,t[n++]=r>>8,t[n++]=255&r):(t[n++]=201,t[n++]=r>>24,t[n++]=r>>16&255,t[n++]=r>>8&255,t[n++]=255&r)}return t[n++]=i,t.set(e,n),n+=r}function mw(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");$b.unshift(e.Class),Jb.unshift(e)}!function(e){e.unpack?gb[e.type]=e.unpack:gb[e.type]=e}(e)}$b=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,yb],Jb=[{pack(e,t,n){let i=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&i>=0&&i<4294967296){let{target:e,targetView:n,position:r}=t(6);e[r++]=214,e[r++]=255,n.setUint32(r,i)}else if(i>0&&i<17179869184){let{target:n,targetView:r,position:s}=t(10);n[s++]=215,n[s++]=255,r.setUint32(s,4e6*e.getMilliseconds()+(i/1e3/4294967296|0)),r.setUint32(s+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),n(this.onInvalidDate());let{target:e,targetView:i,position:r}=t(3);e[r++]=212,e[r++]=255,e[r++]=255}else{let{target:n,targetView:r,position:s}=t(15);n[s++]=199,n[s++]=12,n[s++]=255,r.setUint32(s,1e6*e.getMilliseconds()),r.setBigInt64(s+4,BigInt(Math.floor(i)))}}},{pack(e,t,n){let i=Array.from(e),{target:r,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=115,r[s++]=0),n(i)}},{pack(e,t,n){let{target:i,position:r}=t(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=101,i[r++]=0),n([e.name,e.message])}},{pack(e,t,n){let{target:i,position:r}=t(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=120,i[r++]=0),n([e.source,e.flags])}},{pack(e,t){this.structuredClone?dw(e,16,t):pw(iw?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let n=e.constructor;n!==sw&&this.structuredClone?dw(e,Gb.indexOf(n.name),t):pw(e,t)}},{pack(e,t){let{target:n,position:i}=t(1);n[i]=193}}];var gw,vw,yw,bw=new uw({useRecords:!1}),{NEVER:ww,ALWAYS:xw,DECIMAL_ROUND:Ew,DECIMAL_FIT:Cw}=(bw.pack,bw.pack,{NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4}),Aw=512,Sw=1024,_w=new uw({structuredClone:!0});function Tw(e){if(py(e))return e;if(Array.isArray(e))return e.map(Tw);if("object"==typeof e&&null!==e){let t={};for(let n of Object.keys(e).sort())t[n]=Tw(e[n]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}function Pw(e){return"MouseDown"===e||"MouseUp"===e||"KeyDown"===e||"KeyUp"===e||"Collision"===e||"Trigger"===e}mw({Class:ly.prototype.constructor,type:1,write:e=>({...e}),read:e=>(Object.setPrototypeOf(e,ly.prototype),e)}),mw({Class:yy.prototype.constructor,type:2,write:e=>[...e],read:e=>(Object.setPrototypeOf(e,yy.prototype),e)}),mw({Class:vy.prototype.constructor,type:3,write:e=>[...e],read:e=>(Object.setPrototypeOf(e,vy.prototype),e)}),mw({Class:eb.prototype.constructor,type:4,write:e=>e.id,read:e=>new eb(e)}),mw({Class:tb.prototype.constructor,type:5,write:e=>e.data,read:e=>new tb(e)}),mw({Class:Ay.prototype.constructor,type:6,write:e=>({...e}),read:e=>(Object.setPrototypeOf(e,Ay.prototype),e)}),(e=>{function t(e){return _w.pack(e)}e.serialize=t,e.deserialize=function(e){return _w.unpack(e)},e.checksum=function(e){return function(e){var t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++)t=(t<<5)-t+e[n],t|=0;return t}(t(Tw(e))).toString()}})(gw||(gw={})),(yw=vw||(vw={})).toEventUIType=function(e){return"Conditional"===e.type?"Distance"===e.condition.type?"Distance":"StateChange":e.type},yw.fromEventUIType=function(e){return"Distance"===e||"StateChange"===e?"Conditional":e};var Mw,Nw,Iw,Ow,Dw,Lw,Rw,kw,Bw,Uw,zw,Fw,jw,Vw,Hw,Ww,Gw,qw,Kw,Yw,Qw={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],AIAssistantListener:["SetVariable"],AIAssistantTrigger:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]};(e=>{e.is=function(e){return"MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"KeyPress"===e.type},e.defaultData=function(e){return"MouseDown"===e||"MouseUp"===e||"MousePress"===e?{type:e,mode:"Object",disabled:!1,actions:new yy}:{type:e,disabled:!1,key:void 0,actions:new yy}}})(Mw||(Mw={})),(e=>{e.propertyDefaultData=function(e){return{type:"Property",value:[e??null,"position","x"]}},e.valueDefaultData={type:"Literal",value:0}})(Nw||(Nw={})),(e=>{e.comparisonDefaultData=function(e){return{type:"Comparison",operator:"==",lOperand:Nw.propertyDefaultData(e),rOperand:{...Nw.valueDefaultData}}},e.distanceDefaultData=function(e){return{type:"Distance",toObject:e??null,fromObject:e??null,distance:200}},e.stateDefaultData=function(e,t){return{type:"State",object:e??null,state:t??null}}})(Iw||(Iw={})),(e=>{e.isConditionalSubActions=function(e){return void 0!==e.find((e=>"ifActions"===e||"elseActions"===e))}})(Ow||(Ow={})),(e=>{e.is=function(e){return"Conditional"===e.type},e.defaultData=function(e){return{type:"Conditional",disabled:!1,inActions:new yy,outActions:new yy,condition:Iw.distanceDefaultData(e)}}})(Dw||(Dw={})),(e=>{e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new yy,drop:new yy}}})(Lw||(Lw={})),(e=>{e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new yy}})(Rw||(Rw={})),(e=>{e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5}})(kw||(kw={})),(e=>{e.is=function(e){return"MouseHover"===e.type},e.defaultData=function(){return{type:"MouseHover",disabled:!1,actions:new yy}}})(Bw||(Bw={})),(e=>{e.is=function(e){return"Scroll"===e.type},e.defaultData=function(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new yy}}})(Uw||(Uw={})),(e=>{e.is=function(e){return"Start"===e.type},e.defaultData=function(){return{type:"Start",disabled:!1,actions:new yy}}})(zw||(zw={})),(e=>{e.is=function(e){return"Collision"===e.type},e.defaultData=function(){return{type:"Collision",disabled:!1,target:"character",actions:new yy}}})(Fw||(Fw={})),(e=>{e.is=function(e){return"Trigger"===e.type},e.defaultData=function(e,t){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new yy,triggerZone:"box",position:t.toArray(),rotation:[0,0,0],size:e.toArray(),radius:e.length()/2,helperVisible:!0}}})(jw||(jw={})),(Hw=Vw||(Vw={})).defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]},Hw.is=function(e){return"Resize"===e.type},Hw.sizeToDevice=function(e){return"string"==typeof e?e:"custom"},Hw.deviceToSize=function(e){return"string"==typeof e?[...Hw.defaultSizes[e]]:[...e]},Hw.defaultData=function(){let e={size:"mobile",operator:"<",actions:new yy},t={size:"tablet",operator:"<",actions:new yy},n={size:[...Hw.defaultSizes.custom],operator:"<>",actions:new yy},i=new yy;return i.push({id:ui.generateUUID(),fi:0,data:e},{id:ui.generateUUID(),fi:1,data:t},{id:ui.generateUUID(),fi:2,data:n}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:i}},Hw.defaultBreakpointData=function(){return{size:[...Hw.defaultSizes.custom],operator:"<>",actions:new yy}},(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]},e.is=function(e){return"VariableChange"===e.type},e.defaultData=function(){return{disabled:!1,type:"VariableChange",actions:new yy,variableId:"",objectId:null,property:"Position X"}}})(Ww||(Ww={})),(e=>{e.is=function(e){return"API"===e.type},e.defaultData=function(){return{disabled:!1,type:"API",successActions:new yy,errorActions:new yy,userAPIId:""}}})(Gw||(Gw={})),(e=>{e.is=function(e){return"WEBHOOK"===e.type},e.defaultData=function(){return{disabled:!1,type:"WEBHOOK",actions:new yy,userWebhookId:""}}})(qw||(qw={})),(e=>{e.is=function(e){return"AIAssistantListener"===e.type},e.defaultData=function(){return{disabled:!1,type:"AIAssistantListener",actions:new yy,analysis:"average",analysisRange:[0,71],analysisSingle:0}}})(Kw||(Kw={})),(e=>{e.is=function(e){return"AIAssistantTrigger"===e.type},e.defaultData=function(){return{disabled:!1,description:"",type:"AIAssistantTrigger",actions:new yy}}})(Yw||(Yw={}));var Xw,Zw,Jw,$w,ex,tx,nx,ix,rx,sx,ax,ox,lx,cx,hx,ux,dx,px,fx,mx,gx="personal camera",vx="a218fcc3-276b-49b9-b485-49037fd14f5f",yx=5526619;function bx(e){return"string"==typeof e&&36===e.length&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)}(e=>{function t(e,t){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function n(e,n){return Math.sqrt(t(e,n))}function i(t,n,i){let r=e.sub(n,t),s=e.sub(i,t),a=e.dot(r,s)/e.dot(r,r),o=e.scalarMultiply(r,a);return e.add(t,o)}e.isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.lerp=function(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]},e.add=function(e,t){return[e[0]+t[0],e[1]+t[1]]},e.sub=function(e,t){return[e[0]-t[0],e[1]-t[1]]},e.multiply=function(e,t){return[e[0]*t[0],e[1]*t[1]]},e.divide=function(e,t){return[e[0]/t[0],e[1]/t[1]]},e.distanceSquared=t,e.distance=n,e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},e.scalarMultiply=function(e,t){return[e[0]*t,e[1]*t]},e.projectionOnto=i,e.projectionOntoDistance=function(e,t,r){return n(e,i(e,t,r))},e.center=function(e,t){return[.5*(e[0]+t[0]),.5*(e[1]+t[1])]}})(Xw||(Xw={})),(Jw=Zw||(Zw={})).isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},Jw.add=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},Jw.sub=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},Jw.div=function(e,t){return[e[0]/t[0],e[1]/t[1],e[2]/t[2]]},Jw.mul=function(e,t){return[e[0]*t[0],e[1]*t[1],e[2]*t[2]]},Jw.dist=function(e,t){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},Jw.lerp=function(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n,e[2]+(t[2]-e[2])*n]},(e=>{e.isEqual=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.lerp=function(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n,e[2]+(t[2]-e[2])*n,e[3]+(t[3]-e[3])*n]}})($w||($w={})),(e=>{let t=180/Math.PI,n=Math.PI/180;function i(e){return"number"==typeof e?e*t:e}function r(e){return"number"==typeof e?e*n:e}e.radToDeg=function(e){return[i(e[0]),i(e[1]),i(e[2])]},e.degToRad=function(e){return[r(e[0]),r(e[1]),r(e[2])]}})(ex||(ex={})),(nx=tx||(tx={})).identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],nx.isEqual=function(e,t){for(let n=0;n<16;n++)if(e[n]!==t[n])return!1;return!0},nx.simplify=function(e){return e??nx.identity},nx.applyMatrix4=function(e,t){let n=t.slice(0);for(var i=0,r=t.length;i<r;i+=3){let r=e[3]*t[i]+e[7]*t[i+1]+e[11]*t[i+2]+e[15];n[i]=(e[0]*t[i]+e[4]*t[i+1]+e[8]*t[i+2]+e[12])/r,n[i+1]=(e[1]*t[i]+e[5]*t[i+1]+e[9]*t[i+2]+e[13])/r,n[i+2]=(e[2]*t[i]+e[6]*t[i+1]+e[10]*t[i+2]+e[14])/r}return n},(rx=ix||(ix={})).isRGB=function(e){return"object"==typeof e&&"number"==typeof e.r&&"number"==typeof e.g&&"number"==typeof e.b},rx.white={r:1,g:1,b:1},rx.red={r:1,g:0,b:0},rx.black={r:0,g:0,b:0},rx.toRgb255a1=function(e){return{r:Math.round(255*e.r),g:Math.round(255*e.g),b:Math.round(255*e.b),a:1}},rx.clone=function(e){return{r:e.r,g:e.g,b:e.b}},rx.fromHex=function(e){return{r:((e=Math.floor(e))>>16&255)/255,g:(e>>8&255)/255,b:(255&e)/255}},rx.toHex=function(e){return 65536*Math.round(255*e.r)+256*Math.round(255*e.g)+Math.round(255*e.b)},rx.equals=function(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b},rx.equalsFixed=function(e,t){return e.r.toFixed(2)===t.r.toFixed(2)&&e.g.toFixed(2)===t.g.toFixed(2)&&e.b.toFixed(2)===t.b.toFixed(2)},rx.lerp=function(e,t,n){return{r:e.r+(t.r-e.r)*n,g:e.g+(t.g-e.g)*n,b:e.b+(t.b-e.b)*n}},(ax=sx||(sx={})).white={...ix.white,a:1},ax.transparent={...ix.white,a:0},ax.from0to1=function(e){return{r:e[0],g:e[1],b:e[2],a:e[3]}},ax.fromHexAndA=function(e,t){return{...ix.fromHex(e),a:t}},ax.toRgb255a1=function(e){return{r:Math.round(255*e.r),g:Math.round(255*e.g),b:Math.round(255*e.b),a:e.a}},ax.equals=function(e,t){return ix.equals(e,t)&&e.a===t.a},ax.equalsFixed=function(e,t){return ix.equalsFixed(e,t)&&e.a.toFixed(2)===t.a.toFixed(2)},ax.lerp=function(e,t,n){return{r:e.r+(t.r-e.r)*n,g:e.g+(t.g-e.g)*n,b:e.b+(t.b-e.b)*n,a:e.a+(t.a-e.a)*n}},ax.toStyle=function(){let{r:e,g:t,b:n,a:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ax.white;return`rgba(${255*e}, ${255*t}, ${255*n}, ${i})`},(e=>{e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}})(ox||(ox={})),(e=>{e.defaultData={mass:1,stiffness:80,damping:10,velocity:0}})(lx||(lx={})),(e=>{e.defaultData={control1:[.5,0],control2:[.5,1]}})(cx||(cx={})),(ux=hx||(hx={})).linear=[0,0,1,1],ux.ease=[.25,.1,.25,1],ux.easeIn=[.42,0,1,1],ux.easeOut=[0,0,.58,1],ux.easeInOut=[.42,0,.58,1],(e=>{e.all=["PerspectiveCamera","OrthographicCamera"],e.is=function(t){return e.all.includes(t)}})(dx||(dx={})),(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset},e.getZoom=function(e){return"PerspectiveCamera"===e.type?e.perspective?.zoom??1:e.orthographic?.zoom??1}})(px||(px={})),(e=>{e.defaultData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:2*Math.max(e[0],e[1]),start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[e[0]+e[0]*t,0,0]},grid:{count:[2,2,2],size:e.map((e=>e*(1+t))),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}},e.merge=function(e,t){let n={...e};if(Ix.forEach((i=>{Object.assign(n,{[i]:t[i]??e[i]})})),n.radial={...e.radial},t.radial){let i=e.radial,r=t.radial;Ox.forEach((e=>{Object.assign(n.radial,{[e]:r[e]??i[e]})}))}if(n.linear={...e.linear},t.linear){let i=e.linear,r=t.linear;Dx.forEach((e=>{Object.assign(n.linear,{[e]:r[e]??i[e]})}))}if(n.grid={...e.grid},t.grid){let i=e.grid,r=t.grid;Lx.forEach((e=>{Object.assign(n.grid,{[e]:r[e]??i[e]})}))}if(n.toObject={...e.toObject},t.toObject){let i=e.toObject,r=t.toObject;Rx.forEach((e=>{Object.assign(n.toObject,{[e]:r[e]??i[e]})}))}if(n.randomnessObject={...e.randomnessObject},t.randomnessObject){let i=e.randomnessObject,r=t.randomnessObject;kx.forEach((e=>{Object.assign(n.randomnessObject,{[e]:r[e]??i[e]})}))}return n}})(fx||(fx={})),(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];e.toOps=function(e,n){let i=[];void 0!==e.count&&i.push({type:0,path:n,props:{count:e.count}});for(let r of t){let t=e[r];t&&Object.keys(t).length>0&&i.push({type:0,path:[...n,r],props:t})}return i}})(mx||(mx={}));var wx,xx,Ex,Cx,Ax,Sx,_x,Tx,Px,Mx,Nx,Ix=["count"],Ox=["radius","start","end","position","scale","rotation"],Dx=["position","scale","rotation"],Lx=["count","size"],Rx=["count","position","scale","rotation"],kx=["strength","scale","rotation","position","movement","seed","freqScale"];(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"],e.is=function(t){return e.all.includes(t)}})(wx||(wx={})),(e=>{e.defaultData=function(e){return function(e){if("PointLight"===e)return{type:e,color:sx.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if("SpotLight"===e)return{type:e,color:sx.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if("DirectionalLight"===e)return{type:e,color:sx.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}(e)}})(xx||(xx={})),(e=>{e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1,...e.defaultCollisionData}})(Ex||(Ex={})),(e=>{e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]}})(Cx||(Cx={})),(e=>{e.defaultData={castShadow:!0,receiveShadow:!0},e.equals=function(e,t){return e.castShadow===t.castShadow&&e.receiveShadow===t.receiveShadow}})(Ax||(Ax={})),(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0},e.equals=function(e,t){return e.flatShading===t.flatShading&&e.side===t.side&&e.wireframe===t.wireframe}})(Sx||(Sx={})),(e=>{e.defaultData={...Sx.defaultData,...Ax.defaultData}})(_x||(_x={})),(e=>{e.getMaterialData=function(e,t){let n=[];if("material"in e){let i="string"==typeof e.material?t.materials[e.material]??t.lib.materials[e.material]?.asset:e.material;i&&n.push(i)}else if("materials"in e)for(let i of e.materials){let e="string"==typeof i?t.materials[i]??t.lib.materials[i]?.asset:i;e&&n.push(e)}return n}})(Tx||(Tx={})),(e=>{e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7})(Px||(Px={})),(e=>{e.is=function(e){return"texture"===e||"video"===e||"color"===e||"depth"===e||"normal"===e||"gradient"===e||"noise"===e||"fresnel"===e||"rainbow"===e||"toon"===e||"outline"===e||"particle"===e||"transmission"===e||"matcap"===e||"displace"===e||"pattern"===e||"light"===e}})(Mx||(Mx={})),(e=>{e.is=function(e){return"phong"===e||"toon"===e||"lambert"===e||"physical"===e}})(Nx||(Nx={}));var Bx,Ux,zx,Fx,jx=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],Vx=["wrapping","image","video","name","minFilter","magFilter"];(e=>{e.patch=function(e,t){let{texture:n,...i}=t;if(Object.assign(e,i),n){let t=e.texture;t&&Object.assign(t,n)}},e.defaultData=function(e,t){return"light"===e&&t?function(e){let t={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(e){case"phong":return{...t,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...t,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...t,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...t,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}(t):function(e){let t={alpha:1,mode:0,isMask:!1,visible:!0};switch(e){case"texture":return{...t,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"video":return{...t,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:Px.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"color":return{...t,type:"color",color:ix.fromHex(yx)};case"depth":return{...t,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...t,type:"normal",cnormal:[1,1,1]};case"gradient":return{...t,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...t,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...ix.fromHex(6710886),a:1},colorB:{...ix.fromHex(6710886),a:1},colorC:{...ix.fromHex(16777215),a:1},colorD:{...ix.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...t,type:"fresnel",color:sx.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...t,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...t,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:sx.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...t,type:"outline",outlineColor:sx.fromHexAndA(0,1),contourColor:sx.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...t,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}};case"transmission":return{...t,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...t,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...ix.fromHex(0),a:1},colorB:{...ix.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}(e)}})(Bx||(Bx={})),(e=>{function t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"layer1",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer2",i=new yy;return i.push({fi:0,data:Bx.defaultData("light",e),id:t}),i.push({fi:1,data:Bx.defaultData("color"),id:n}),{layers:i}}e.isMergable=function(e){return!e.layers.some((e=>"texture"===e.data.type&&0!==e.data.projection||"depth"===e.data.type&&!e.data.isWorldSpace||"noise"===e.data.type||"displace"===e.data.type))},e.getHash=function(e){let t="";return e.layers.forEach((e=>{Object.entries(e.data).forEach((e=>{let[n,i]=e;t+=`${n}${i}`,Array.isArray(i)?i.forEach((e=>t+=`${e}`)):"object"==typeof i?Object.values(i).forEach((e=>{t+="number"==typeof e?`${e.toFixed(4)}`:`${e}`})):t+=`${i}`}))})),t},e.defaultEmptyData=function(){return{layers:new yy}},e.defaultData=function(){return t("phong",arguments.length>0&&void 0!==arguments[0]?arguments[0]:"layer1",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"layer2")},e.withName=function(e,t){return{...e,name:t}},e.defaultTwoLayerData=t,e.defaultUIObjectMaterial=function(e){let t=Bx.defaultData("texture");e&&Object.assign(t.texture,{image:e});let n=new yy;return n.push({fi:0,data:t,id:"layer1"}),n.push({fi:1,data:{...Bx.defaultData("transmission"),alpha:1},id:"layer2"}),n.push({fi:2,data:{...Bx.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:n}},e.defaultTwoLayerTextureData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"phong",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer1",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"layer2",r=Bx.defaultData("texture");Object.assign(r.texture,{image:e});let s=new yy;return s.push({fi:0,data:r,id:n}),s.push({fi:1,data:Bx.defaultData("light",t),id:i}),{layers:s}},e.defaultTwoLayerVideoTextureData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"phong",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"layer1",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"layer2",r=Bx.defaultData("video");Object.assign(r.texture,{video:e});let s=new yy;return s.push({fi:0,data:r,id:n}),s.push({fi:1,data:Bx.defaultData("light",t),id:i}),{layers:s}}})(Ux||(Ux={})),(e=>{e.defaultData=function(){return{points:new yy,roundness:0,shapeHoles:[],isClosed:!1}}})(zx||(zx={})),(e=>{e.defaultData=function(){return{points:new yy,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}})(Fx||(Fx={}));var Hx,Wx={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0};(e=>{e.merge=function(e,t){let n={...e};return Qx.forEach((i=>{Object.assign(n,{[i]:t[i]??e[i]})})),n}})(Hx||(Hx={}));var Gx,qx,Kx,Yx={shape:Wx,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},Qx=["depth","offset","angle","twist","startScale","endScale"];(e=>{e.is2DParametricMesh=function(e){return"PolygonGeometry"===e||"RectangleGeometry"===e||"StarGeometry"===e||"TriangleGeometry"===e||"EllipseGeometry"===e||"UIGeometry"===e},e.isParametricMesh=function(e){return"PolygonGeometry"===e||"PolygonGeometry"===e||"RectangleGeometry"===e||"StarGeometry"===e||"TriangleGeometry"===e||"EllipseGeometry"===e||"PathGeometry"===e||"VectorGeometry"===e||"ConeGeometry"===e||"CubeGeometry"===e||"CylinderGeometry"===e||"DodecahedronGeometry"===e||"HelixGeometry"===e||"IcosahedronGeometry"===e||"LatheGeometry"===e||"PyramidGeometry"===e||"SphereGeometry"===e||"PlaneGeometry"===e||"BackdropGeometry"===e||"TorusGeometry"===e||"TorusKnotGeometry"===e||"BooleanGeometry"===e||"TextGeometry"===e||"InputGeometry"===e}})(Gx||(Gx={})),(e=>{e.merge=function(e,t){let n={...e};return Object.assign(n,t),"PathGeometry"===n.type&&"extrusion"in t&&t.extrusion&&(n.extrusion={...e.extrusion},Object.assign(n.extrusion,Hx.merge(n.extrusion,t.extrusion))),n}})(qx||(qx={})),(e=>{e.defaultData=function(t){if("RectangleGeometry"===t)return{width:320,height:320,type:t,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if("UIGeometry"===t)return{type:t,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if("PathGeometry"===t)return{type:t,width:1,height:1,depth:1,path:Fx.defaultData(),extrusion:Yx};if("VectorGeometry"===t)return{width:1,height:1,type:t,subdivisions:12,shape:zx.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if("BooleanGeometry"===t)return{type:t,operation:2,width:0,height:0,depth:0,phongAngle:35};if("ShapeBlendGeometry"===t)return{type:t,width:0,height:0,depth:0,resolutionLevel:6,blendRange:100,useChildrenColors:!1};if("TextGeometry"===t)return{type:t,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if("InputGeometry"===t)return{...e.defaultData("TextGeometry"),type:t,editable:!0};if("SphereGeometry"===t)return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}})(Kx||(Kx={}));var Xx,Zx,Jx,$x,eE,tE,nE,iE,rE,sE,aE,oE,lE,cE,hE,uE,dE,pE,fE,mE,gE,vE,yE,bE,wE,xE,EE,CE,AE,SE,_E,TE,PE,ME,NE,IE,OE,DE,LE,RE,kE,BE,UE=["width","height","depth"];function zE(e){e.layers.forEach((e=>{if("depth"===e.type&&void 0!==e.colorA){let t=e.colorA,n=e.colorB,i=[[t.r,t.g,t.b,t.a],[n.r,n.g,n.b,n.a]],r=[0,1];for(let e=2;e<10;e++)i.push(i[1]),r.push(1);let s={...Nv(Xy(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,e.near),far:Math.max(0,e.far),colors:i,steps:r,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(e,s)}else if("depth"===e.type&&1===e.gradientType&&(e.near<0||e.far<0)){let t={...Xy(e),near:Math.max(e.near,0),far:Math.max(e.far,0)};Object.assign(e,t)}}))}function FE(e,t){Object.values(e.shared.materials).forEach((e=>t(e)))}function jE(e,t){e.scene.objects.traverse(((e,n)=>{"materials"in n?n.materials.forEach(((e,i)=>{void 0===e&&(n.materials[i]=Ux.defaultData(),e=n.materials[i]),"string"!=typeof e&&t(e)})):"material"in n?"string"!=typeof n.material&&(void 0===n.material&&(n.material=Ux.defaultData()),t(n.material)):"Mesh"===n.type&&(void 0===n.material&&(n.material=Ux.defaultData()),t(n.material)),"overrides"in n&&Object.values(n.overrides).forEach((e=>{e.material&&"string"!=typeof e.material&&Object.getPrototypeOf(e.material)!==Ay.prototype&&t(e.material)}))}))}function VE(e){void 0===e.layers&&Object.assign(e,Ux.defaultTwoLayerData("lambert"))}function HE(e){!e.layers||e.layers.forEach((e=>{if("depth"===e.type&&10===e.colors.length){let t=[...e.colors];t.push(e.colors[9]);let n=[...e.steps];n.push(e.steps[9]);let i={...Xy(e),colors:t,steps:n};Object.assign(e,i)}}))}function WE(e){e.scene.objects.traverse(((e,t)=>{"materials"in t?t.materials.forEach((e=>{"string"!=typeof e&&HE(e)})):"material"in t&&"string"!=typeof t.material&&HE(t.material)})),Object.values(e.shared.materials).forEach((e=>HE(e)))}function GE(e){e.layers&&e.layers.forEach((e=>{"depth"===e.type&&void 0!==e.num&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)}))}function qE(e){e.layers&&e.layers.forEach((e=>{(function(e){return"displace"!==e.type})(e)&&void 0===e.isMask&&(e.isMask=!1),("texture"===e.type||"video"===e.type)&&void 0===e.blending&&(e.blending=0),("noise"===e.type||"displace"===e.type&&"noise"===e.displacementType)&&(void 0===e.voronoiStyle&&(e.voronoiStyle=0),void 0===e.highCut&&(e.highCut=1),void 0===e.lowCut&&(e.lowCut=0),void 0===e.smoothness&&(e.smoothness=.3),void 0===e.seed&&(e.seed=0),void 0===e.quality&&(e.quality=1))}))}function KE(e){let t=e.layers.find((e=>"light"===e.type))?.data;if("basic"===t?.category){let e=Bx.defaultData("light","phong"),n=t;Object.assign(n,e),n.visible=!1}}function YE(e){FE(e,KE),jE(e,KE)}function QE(e){e.layers.forEach((e=>{"light"===e.type&&"toon"!==e.category&&void 0===e.occlusion&&(e.occlusion=!0)}))}function XE(e){e.layers&&e.layers.forEach((e=>{"light"===e.type&&void 0===e.bumpMapIntensity&&(e.bumpMapIntensity=5)}))}function ZE(e,t){if(t<1&&(jE(e,zE),FE(e,zE),e.schema=1),t<2&&(function(e){Object.assign(e.scene.publish,{orbitControls:{...wE.defaultData,...Xy(e.scene.publish.orbitControls)}})}(e),e.schema=2),t<3&&(function(e){function t(e){if(e.layers)for(let t of Object.values(e.layers))if(t)for(let[e,n]of Object.entries(t))if((jx.includes(e)||"boolean"==typeof n)&&delete t[e],"texture"===e)for(let[t,i]of Object.entries(n))(Vx.includes(t)||"boolean"==typeof i)&&delete n[t]}e.scene.objects.traverse(((e,n)=>{n.states.forEach((e=>{let n=e;n.material?t(n.material):n.materials&&n.materials.forEach((e=>{t(e)}))}))}))}(e),e.schema=3),t<4&&(function(e){e.scene.publish.withBackground=!0}(e),e.schema=4),t<5&&(function(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}(e),e.schema=5),t<6&&(function(e){e.scene.objects.traverse(((e,t)=>{let n=t.cloner;n&&(n.radial.scale=n.radial.scale.map((e=>e+1)),n.linear.scale=n.linear.scale.map((e=>e+1)))}))}(e),e.schema=6),t<7&&(function(e){e.scene.objects.traverse(((e,t)=>{let n=t.geometry;n&&("DodecahedronGeometry"===n.type||"IcosahedronGeometry"===n.type)&&(n.detail=Math.round(n.detail))}))}(e),e.schema=7),t<8&&(e.schema=8),t<9&&(WE(e),e.schema=9),t<10&&(function(e){e.scene.objects.traverse(((e,t)=>{"Mesh"===t.type&&("BooleanGeometry"===t.geometry.type||"SubdivGeometry"===t.geometry.type)&&(t.geometry.phongAngle=35)}))}(e),e.schema=10),t<11&&(function(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse(((e,t)=>{("DirectionalLight"===t.type||"SpotLight"===t.type)&&(t.shadowResolution=1024,t.shadowRadius=1,t.depth=1e5)})),e.shared.penumbraSize=new Array(5).fill(.5)}(e),e.schema=11),t<12&&(WE(e),e.schema=12),t<13&&(function(e){e.shared.audios=Dv({},ly.prototype)}(e),e.schema=13),t<14&&(function(e){let t=e.shared.materials;Object.entries(t).forEach((e=>{let[n,i]=e;if(!i.layers){let e={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[n]:e})}}))}(e),e.schema=14),t<15&&(function(e){Object.entries(Xy(e.shared.images)).filter((e=>!1===e[1].asset)).map((e=>e[0])).forEach((t=>{delete e.shared.images[t]})),Object.entries(Xy(e.shared.audios)).filter((e=>!1===e[1].asset)).map((e=>e[0])).forEach((t=>{delete e.shared.audios[t]}))}(e),e.schema=15),t<16&&(function(e){e.scene.publish.settings.web.preload=!1}(e),e.schema=16),t<17&&(jE(e,GE),FE(e,GE),e.schema=17),t<18&&(jE(e,VE),FE(e,VE),e.schema=18),t<19&&(function(e){Object.assign(e.scene.publish.settings,{video:{...xE.defaultData.settings.video,...Xy(e.scene.publish.settings.video)}})}(e),e.schema=19),t<20&&(function(e){e.shared.fonts=Dv({},ly.prototype)}(e),function(e){let t=[];e.scene.objects.traverse(((n,i)=>{let r=i;if("TextFrame"===r.type){let i=Ux.defaultTwoLayerData("phong"),s="string"==typeof r.color?e.shared.colors[r.color]:r.color;i.layers[1].data.color={r:s.r,g:s.g,b:s.b},i.layers[1].data.alpha=r.alpha;let a=function(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}(r.font);void 0===e.shared.fonts[a]&&(e.shared.fonts[a]={name:a});let o={name:r.name,...oE.defaultData,...dE.defaultData,flatShading:!1,wireframe:!1,geometry:{...Kx.defaultData("TextGeometry"),width:r.width,height:r.height,font:a,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:1.40625*r.fontSize,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:i,states:Xy(r.states),events:Xy(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix},l=Xy(e.scene.objects).parent(n);e.scene.objects.insertAfter(l??null,n,[{id:n+"new",data:o,children:[]}]),t.push(n)}})),t.forEach((t=>{e.scene.objects.delete(t)}))}(e),e.schema=20),t<21&&(function(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse(((e,n)=>{n.events.forEach((e=>{if(t[Number(e.type)])if(Object.assign(e,{type:t[Number(e.type)]}),"Audio"===e.type&&"audioEvent"in e&&(Object.assign(e,{playAudio:e.audioEvent}),delete e.audioEvent),"GameControl"===e.type)Object.assign(e,{gameActions:{idle:new yy,move:new yy,jump:new yy}});else{let t=new yy;Object.assign(e,{actions:t}),("MouseDown"===e.type||"MouseUp"===e.type||"KeyDown"===e.type||"KeyUp"===e.type)&&"url"in e&&t.push({fi:0,id:ui.generateUUID(),data:{type:"Link",url:e.url,delay:0}}),"targets"in e&&(e.targets.forEach(((e,n,i)=>{let r={easing:e.easing,duration:e.duration};6===e.easing?Object.assign(r,Nv(e,"mass","stiffness","damping","velocity")):5===e.easing&&Object.assign(r,{control1:{...e.control1},control2:{...e.control2}});let s={repeat:e.repeat?-1:0,delay:e.delay,delayDirection:e.delayDirection,direction:e.cycle&&e.rewind?"pingpong-rewind":e.cycle?"pingpong":"normal"},a={state:e.state,...s,...r},o={allowSlerp:!0,type:"Transition",object:e.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new yy({fi:0,id:ui.generateUUID(),data:{state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4}},{fi:1,id:ui.generateUUID(),data:a})};t.push({fi:i,id:n,data:o})})),delete e.targets)}}))}))}(e),function(e){e.scene.objects.traverse(((e,t)=>{function n(e,n){let i=new yy,r=[];if(t.events.forEach(((e,t,s)=>{if("Audio"===e.type&&e.trigger===n){let n;r.push(t),"play"===e.interaction?n={...Nv(e,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in e?e.after:void 0,toggle:"after"in e?e.toggle:void 0,type:"Audio"}:("pause"===e.interaction||"stop"===e.interaction)&&(n={...Nv(e,"interaction","delay","object","playAudio"),type:"Audio"}),n&&i.push({fi:s,id:t,data:n})}})),r.forEach((e=>t.events.delete(e))),i.length){let n=t.events.find((t=>t.type===e))?.data;n?"actions"in n&&n.actions.insertBefore(null,i):t.events.insertBefore(null,[{id:ui.generateUUID(),data:{type:e,actions:i}}])}}n("Start","start"),n("MouseDown","mouseDown"),n("MouseUp","mouseUp"),n("KeyDown","keyDown"),n("KeyUp","keyUp")}))}(e),e.schema=21),t<22&&(YE(e),e.schema=22),t<23&&(function(e){e.scene.objects.traverse(((e,t)=>{"Mesh"===t.type&&"SubdivGeometry"===t.geometry.type&&(t.geometry.scaleBaked||(t.geometry.scaleBaked=[1,1,1]))}))}(e),e.schema=23),t<24&&(function(e){e.scene.objects.traverse(((e,t)=>{("Empty"===t.type||"Mesh"===t.type)&&t.cloner&&!t.cloner.randomnessObject&&!t.cloner.toObject&&!t.cloner.randomness&&(t.cloner={...t.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})}))}(e),e.schema=24),(t<25||void 0===e.shared.videos)&&(function(e){e.shared.videos=Dv({},ly.prototype)}(e),t<25&&(e.schema=25)),t<26&&(function(e){e.scene.objects.traverse(((t,n)=>{let i=e.scene.objects.unproxy().parent(t);if(i){let t=Xy(e.scene.objects.data(i));t&&"Mesh"===t.type&&"BooleanGeometry"===t.geometry.type&&"Mesh"===n.type&&(n.visible=!0!==Xy(n).booleanExclude)}}))}(e),e.schema=26),t<27&&(function(e){e.scene.objects.traverse(((e,t)=>{if("Mesh"===t.type){let e=t;"NonParametricGeometry"===t.geometry.type?void 0!==e.material&&delete e.material:void 0!==e.materials&&delete e.materials}}))}(e),e.schema=27),t<28&&(YE(e),e.schema=28),t<29&&(function(e){function t(e){Object.setPrototypeOf(e,Ay.prototype),e.texture&&Object.setPrototypeOf(e.texture,Ay.prototype)}function n(e){Object.setPrototypeOf(e,Ay.prototype);for(let n in e)t(e[n])}e.scene.objects.traverse(((e,t)=>{t.states.forEach((e=>{let t=e;if(t.material){let e=Xy(t.material).layers;n(e),t.material.layers=e}if(t.materials)for(let i=0;i<t.materials.length;i++){let e=t.materials[i],r=Xy(e).layers;n(r),e.layers=r}}))}))}(e),e.schema=29),t<30&&(function(e){e.scene.objects.traverse(((e,t)=>{"Mesh"===t.type&&"NonParametricGeometry"===t.geometry.type&&!("material"in t)&&!("materials"in t)&&(t.material=Ux.defaultTwoLayerData("phong"))}))}(e),e.schema=30),t<31&&(function(e){void 0===e.scene.publish.orbitControls.autoZoom&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse(((e,t)=>{("OrthographicCamera"===t.type||"PerspectiveCamera"===t.type)&&(void 0===t.orthographic.autoZoom&&(t.orthographic.autoZoom=!1),void 0===t.orthographic.autoZoomFrustumSize&&(t.orthographic.autoZoomFrustumSize=790))}))}(e),e.schema=31),t<33&&(function(e){e.scene.objects.traverse(((e,t)=>{void 0===t.pathSnapping&&(t.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),void 0===t.pathSnapping.offset&&(t.pathSnapping.offset=0)}))}(e),e.schema=33),t<34&&(function(e){void 0===e.scene.publish.mouseEventTarget&&(e.scene.publish.mouseEventTarget="canvas"),void 0===e.scene.publish.settings.web.hint&&(e.scene.publish.settings.web.hint=!1)}(e),e.schema=34),t<35&&(function(e){let{video:t}=e.scene.publish.settings;"gif"===t.format&&t.fps>48&&(t.fps=15)}(e),e.schema=35),t<36&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&(e.resetYPosition=Math.abs(e.resetYPosition-t.position[1]))}))}))}(e),e.schema=36),t<37&&(function(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse(((e,n)=>{t&&null===n.physics?n.collision=!1:n.collision="visibility"}))}(e),e.schema=37),t<38&&(jE(e,qE),FE(e,qE),e.schema=38),t<39&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&(e.navmesh=BE.defaultDataThirdPerson.navmesh)}))}))}(e),e.schema=39),t<40&&(function(e){e.scene.styles||(e.scene.styles=AE.defaultData())}(e),e.schema=40),t<41&&(function(e){void 0===e.scene.environment.ambientLight.occlusion&&(e.scene.environment.ambientLight.occlusion=!1),void 0===e.scene.environment.ambientLight.aoFullRes&&(e.scene.environment.ambientLight.aoFullRes=!1),void 0===e.scene.environment.ambientLight.radius&&(e.scene.environment.ambientLight.radius=256),void 0===e.scene.environment.ambientLight.bias&&(e.scene.environment.ambientLight.bias=.5),void 0===e.scene.environment.ambientLight.aoColor&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),jE(e,QE),FE(e,QE)}(e),e.schema=41),t<42&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&Object.assign(e.gameActions,{run:new yy})}))}))}(e),e.schema=42),t<43&&(function(e){e.scene.objects.traverse(((e,t)=>{t.events.forEach((e=>{"GameControl"===e.type&&(e.keyAssignments=[...e.keyAssignments,["run","\u21e7"],["none","Ctrl"]])}))}))}(e),e.schema=43),t<99){jE(e,XE),FE(e,XE),null===e.scene.publish.playCamera&&(e.scene.publish.playCamera=gx);let t=Xy(e.scene.objects),n=e.scene.objects;e.scene.publish.playPage=vx,n.insertBefore(null,null,[{id:vx,data:{...vE.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:Nv(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:Nv(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...tE.defaultData,...Nv(e.scene.environment,"usePhysics","gravity")},camera:Xy(e.scene.ownerCamera)??vE.defaultData.camera,name:"Scene"},children:[]}]);for(let e of t)e.id!==_E.TRASH_CAN_ID&&n.move(vx,e.fi,e.id);let i=0,r=0;e.shared.penumbraSize&&e.scene.objects.traverse(((t,n)=>{"DirectionalLight"===n.type?(n.penumbraSize=e.shared.penumbraSize[Math.min(i,2)],i+=1):"SpotLight"===n.type&&(n.penumbraSize=e.shared.penumbraSize[3+Math.min(r,1)],r+=1),(void 0===n.physics||null===n.physics)&&"Instance"!==n.type&&(n.physics={},Object.assign(n.physics,Cx.defaultData)),void 0!==n.physics&&null!==n.physics&&(n.physics.enabled=n.collision??"visibility",delete n.collision)})),e.schema=99}}function JE(e){e.layers&&e.layers.forEach((e=>{"light"===e.type&&void 0===e.alphaOverride&&(e.alphaOverride=1)}))}(e=>{e.defaultData={enabled:!1,useBackgroundColor:!1,color:ix.white,near:.1,far:2e3}})(Xx||(Xx={})),(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focusDistance:100,focalLength:20,bokehScale:5},noise:{...t,blendFunction:16}}})(Zx||(Zx={})),(e=>{e.defaultData={softShadowQuality:"low"}})(Jx||(Jx={})),(e=>{e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75}})($x||($x={})),(e=>{e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}}})(eE||(eE={})),(e=>{e.defaultData={usePhysics:!1,gravity:-10}})(tE||(tE={})),(e=>{e.defaultData={playCamera:gx,gameControlObject:null}})(nE||(nE={})),(e=>{e.defaultData={backgroundColor:sx.fromHexAndA(2960946,1),postprocessing:Zx.defaultData,fog:Xx.defaultData,globalPhysics:tE.defaultData,ambient:$x.defaultData,ao:eE.defaultData,shadow:Jx.defaultData,publish:nE.defaultData}})(iE||(iE={})),(e=>{e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95}})(rE||(rE={})),(e=>{e.isComponentRelated=function(e){return"Component"===e||"Instance"===e},e.isEmptyOrComponent=function(e){return"Empty"===e||"Instance"===e}})(sE||(sE={})),(e=>{e.identity={...ox.identity,hiddenMatrix:tx.identity},e.fromObject=function(e){return{position:e.position,rotation:e.rotation,scale:e.scale,hiddenMatrix:e.hiddenMatrix}},e.merge=function(e,t){return{position:t?.position||e.position,rotation:t?.rotation||e.rotation,scale:t?.scale||e.scale,hiddenMatrix:t?.hiddenMatrix||e.hiddenMatrix}},e.diff=function(e,t){return Ov({position:Zw.isEqual(e.position,t.position)?void 0:t.position,rotation:Zw.isEqual(e.rotation,t.rotation)?void 0:t.rotation,scale:Zw.isEqual(e.scale,t.scale)?null:t.scale,hiddenMatrix:tx.isEqual(e.hiddenMatrix,t.hiddenMatrix)?void 0:t.hiddenMatrix})}})(aE||(aE={})),(e=>{e.defaultData={states:new yy,events:new yy,visible:!0,raycastLock:!1,physics:Cx.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...aE.identity,cloner:null}})(oE||(oE={})),(e=>{e.defaultData={type:"Empty",...oE.defaultData}})(lE||(lE={})),(e=>{e.defaultData={type:"ParticleCollider",...rE.defaultData,...oE.defaultData}})(cE||(cE={})),(e=>{e.defaultData={type:"Component",...oE.defaultData}})(hE||(hE={})),(e=>{e.defaultData={type:"Particle",...oE.defaultData,...Ex.defaultData}})(uE||(uE={})),(e=>{e.defaultData={type:"Mesh",...oE.defaultData,..._x.defaultData}})(dE||(dE={})),(e=>{e.defaultData={...oE.defaultData,...aE.identity,position:[0,0,px.DefaultTargetOffset],...px.defaultData}})(pE||(pE={})),(e=>{e.defaultData=function(e){return{...oE.defaultData,...xx.defaultData(e)}},e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(fE||(fE={})),(e=>{function t(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(;n<t.length;){let i=e?e[t[n]]:void 0;if(t.length===n+1)return i;if(!i)return;e=i.descendants,n+=1}}e.resolveWithDes=t,e.resolve=function(e,n){let i=t(e,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0);if(i){let e=Object.keys(i);if(1===e.length&&"descendants"===e[0])return}return i}})(mE||(mE={})),(e=>{function t(e,t){return{...oE.defaultData,...t,component:e,overrides:new Ay,physics:void 0,events:void 0,type:"Instance"}}e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"],e.ofComponent=t,e.fromComponentData=function(e){let n=aE.fromObject(e.data);return t(e.id,n)}})(gE||(gE={})),(e=>{e.defaultData={type:"Page",...oE.defaultData,physics:{...Cx.defaultData,fusedBody:!1},...iE.defaultData,camera:pE.defaultData},e.isUIPage=function(e){return void 0!==e.uiScene}})(vE||(vE={})),(e=>{e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:tx.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:Cx.defaultData,states:new yy,events:new yy,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...px.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...oE.defaultData,...dE.defaultData,geometry:Kx.defaultData("RectangleGeometry"),material:Ux.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...oE.defaultData,...dE.defaultData,geometry:Kx.defaultData("BooleanGeometry"),material:Ux.defaultTwoLayerData("phong","layer1","layer2")},e.defaultShapeBlendObject={name:"Shape Blend",...oE.defaultData,...dE.defaultData,geometry:Kx.defaultData("ShapeBlendGeometry"),material:Ux.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...oE.defaultData,...dE.defaultData,geometry:Kx.defaultData("TextGeometry"),material:Ux.defaultTwoLayerData("phong","layer1","layer2")},e.defaultInputObject={name:"Input",...oE.defaultData,...dE.defaultData,geometry:Kx.defaultData("InputGeometry"),material:Ux.defaultTwoLayerData("phong","layer1","layer2")}})(yE||(yE={})),(e=>{e.newEmpty=function(e,t){let n={name:t};return"Mesh"===e.type?(n.geometry={},"material"in e&&(n.material={layers:new Ay}),"materials"in e&&(n.materials=e.materials.map((e=>({layers:new Ay}))))):dx.is(e.type)&&(n.perspective={},n.orthographic={}),n},e.toOps=function(e,t){let n,i=[],r={orthographic:0,perspective:0,geometry:0};function s(e,t){for(let[n,r]of Object.entries(t.layers)){let{texture:t,...s}=r;if(void 0!==t&&Object.keys(t).length>0){let r={path:[...e,"layers",n,"texture"],props:t,type:0};i.push(r)}if(Object.keys(s).length>0){let t={path:[...e,"layers",n],props:s,type:0};i.push(t)}}}for(let[a,o]of Object.entries(t))if("name"!==a)if("cloner"===a)i.push(...mx.toOps(o,["cloner"]));else if("pathSnapping"===a)i.push({path:[a],props:{slide:o.slide,offset:o.offset},type:0});else if("material"===a)s(["material"],o);else if("materials"===a)for(let[e,t]of Object.entries(o))s(["materials",e],t);else if(0===r[a]){if("geometry"===a&&void 0!==o.extrusion){let e={path:[a,"extrusion"],props:o.extrusion,type:0};i.push(e),o={...o},delete o.extrusion}if(Object.keys(o).length>0){let e={path:[a],props:o,type:0};i.push(e)}}else void 0===n&&(n={path:[],props:{},type:0},i.push(n)),n.props[a]=o;return i},e.patch=function(e,t){if(void 0===t)return e;let n={...e};if(Object.assign(n,aE.merge(n,t)),Object.assign(n,{pathSnapping:Object.assign({},n.pathSnapping,{slide:t.pathSnapping?.slide??n.pathSnapping?.slide??0,offset:t.pathSnapping?.offset??n.pathSnapping?.offset??0})}),dx.is(e.type)){n.orthographic={...n.orthographic},n.perspective={...n.perspective};let e=t;void 0!==e.orthographic?.zoom&&(n.orthographic.zoom=e.orthographic.zoom),void 0!==e.perspective?.zoom&&(n.perspective.zoom=e.perspective.zoom),void 0!==e.isUpVectorFlipped&&(n.isUpVectorFlipped=e.isUpVectorFlipped),void 0!==e.targetOffset&&(n.targetOffset=e.targetOffset)}else if("Mesh"===e.type)"geometry"in t&&Object.assign(n,{geometry:qx.merge(n.geometry,t.geometry)}),(t.material||t.materials)&&(n=function(e,t){if(void 0===t)return e;let n={...e};return"material"in n&&"material"in t&&t.material&&(n.material=Qy(n.material,(e=>{if("string"!=typeof e)for(let[n,i]of Object.entries(t.material.layers)){let t=e.layers.data(n);t&&Bx.patch(t,i)}})).data),n.materials&&t.materials&&(n.materials=Qy(n.materials,(e=>{for(let i=0;i<n.materials.length;i++){let n=t.materials[i];if("string"!=typeof n)for(let[t,r]of Object.entries(n.layers)){let n=e[i]?.layers?.data(t);n&&Bx.patch(n,r)}}})).data),n}(n,t)),n.cloner&&"cloner"in t&&Object.assign(n,{cloner:fx.merge(n.cloner,t.cloner)});else if("Empty"===e.type)n.cloner&&"cloner"in t&&Object.assign(n,{cloner:fx.merge(n.cloner,t.cloner)});else if(wx.is(e.type)){let e=t;void 0!==e.intensity&&(n.intensity=e.intensity),void 0!==e.color&&("string"==typeof e.color?n.color=e.color:n.color=ix.clone(e.color))}return n}})(bE||(bE={})),(e=>{e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0}})(wE||(wE={})),(e=>{e.defaultData={orbitControls:wE.defaultData,playPage:vx,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map(((e,t)=>{let n=0,i=0;return t<5?i=-30:t<10&&(i=30),0===t||10===t||5===t?n=30:(4===t||11===t||9===t)&&(n=-30),[120,[n,i],"show"]})),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70}},stopRaycast:!0,hdTransmission:!1}})(xE||(xE={})),(e=>{e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""}})(EE||(EE={})),(e=>{e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0}})(CE||(CE={})),(e=>{e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...EE.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:CE.defaultData}),e.generateSeed=()=>Math.round(1e5*Math.random())})(AE||(AE={})),(e=>{e.physicsEnabled=function(e){return void 0!==e.find((e=>"Page"===e.data.type&&e.data.globalPhysics.usePhysics))},e.traverseModuleInstances=function(e,t,n){e.scene.objects.traverseFrom(t,((t,i)=>{if("Instance"===i.type){let r=nC.getComponentData(e,i.component)?.data;r&&n(t,i,r.events)}else n(t,i,i.events)}))}})(SE||(SE={})),(e=>{function t(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[],r=yE.defaultMeshObject;t&&(i.push({...e.defaultLight}),i.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:r,children:[]})),i.push(...n);let s=new vy;return s.push({fi:1,id:vx,data:{...vE.defaultData,name:"Scene 1"},children:i}),s}function n(t){return{...e.defaultData,objects:Dv(t,vy.prototype)}}e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",e.defaultLight={fi:-1,data:fE.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]},e.createDefaultObjectTreeWithPage=t,e.defaultData={objects:t(),publish:xE.defaultData,styles:AE.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new vy,publish:xE.defaultData,styles:AE.defaultData()}},e.emptyDataWithPage=function(){return{objects:t(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]),publish:xE.defaultData,styles:AE.defaultData()}},e.emptyData=function(){return{objects:new vy,publish:{...xE.defaultData},styles:AE.defaultData()}},e.withObjs=n,e.withObj=function(e,t){return n([{id:e,data:t,children:[],fi:0}])}})(_E||(_E={})),(e=>{e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}}})(TE||(TE={})),(e=>{e.defaultData=e=>({url:e,name:"New Webhook",parametersSchemas:new yy}),e.defaultParameterValueByType=e=>"number"===e?0:"boolean"!==e&&""})(PE||(PE={})),(e=>{e.defaultData=function(e){return{url:e,method:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",name:"New API",headers:new yy,queries:new yy,autoStart:!0}}})(ME||(ME={})),(e=>{function t(e){return void 0!==e.textValue}function n(e){return"boolean"==typeof e}e.isTextValue=t,e.isNumber=function(e){return"number"==typeof e},e.isBoolean=n,e.typeOfVariable=function(e){return t(e)?"string":n(e)?"boolean":"number"},e.getDisplayedValue=function(t){return e.isTextValue(t)?Array.isArray(t.textValue)?t.textValue.map((e=>e.toString().padStart(t.padding??2,"0"))).join(t.deliminator??":")+(void 0!==t.suffix?" "+t.suffix:""):t.textValue.toString():e.isBoolean(t)?t?"True":"False":e.isNumber(t)?parseFloat(t.toFixed(3)).toString():t.toString()}})(NE||(NE={})),(e=>{e.all=["images","videos","colors","audios","particles","fonts","materials","variables"]})(IE||(IE={})),(e=>{e.all=[...IE.all,"components"]})(OE||(OE={})),(e=>{e.defaultData=function(){return{images:new ly,videos:new ly,colors:new ly,audios:new ly,particles:new ly,fonts:new ly,materials:new ly,components:new ly,variables:new ly,userAPIs:new ly,userWebhooks:new ly}}})(DE||(DE={})),(e=>{e.defaultData=function(){return{images:new ly,videos:new ly,colors:new ly,audios:new ly,particles:new ly,fonts:new ly,materials:new ly,components:new ly,variables:new ly,userAPIs:new ly,userWebhooks:new ly}}})(LE||(LE={})),(e=>{e.defaultColors=function(){let e={"89b10010-844c-11ec-a8a3-0242ac120002":{r:.5,g:.5,b:.5,a:1,name:"Default Color"}};return Dv(e,ly.prototype)},e.defaultImages=function(){return Dv({},ly.prototype)},e.emptyData=function(){return{catelogs:new ly,materials:new ly,images:new ly,videos:new ly,colors:new ly,audios:new ly,particles:new ly,fonts:new ly,variables:new yy,userAPIs:new ly,userWebhooks:new ly,lib:LE.defaultData()}},e.defaultVariables=function(e){switch(e){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let t=[0,0,0];return{name:"Time",value:{textValue:t,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:t,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",e)}},e.getFormattedTimerTime=function(e,t){if("HH:mm:ss"===t.format){let t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60);return{textValue:[t,n,Math.round(e-3600*t-60*n)]}}if("mm:ss"===t.format){let t=Math.floor(e/60);return{textValue:[t,Math.round(e-60*t)]}}return e="number"===t.format?Math.round(e):Math.round(1e3*e)/1e3}})(RE||(RE={})),(e=>{e.list=["idle","move","jump","run"]})(kE||(kE={})),(e=>{e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","\u25b2"],["rotPosY","\u25c0"],["rotNegX","\u25bc"],["rotNegY","\u25b6"],["jump","Space"],["run","\u21e7"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new yy,move:new yy,jump:new yy,run:new yy},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:sx.fromHexAndA(3728051,1)}}})(BE||(BE={}));var $E=180/Math.PI;function eC(e){e.rotation=e.rotation.slice(0,3).map((e=>e*$E))}function tC(e){eC(e),"Page"===e.type&&eC(e.camera),e.states?.forEach((e=>{void 0===e.rotation||null===e.rotation||(e.rotation=e.rotation.slice(0,3).map((e=>e*$E)))}));let t=e.geometry;t&&"SphereGeometry"===t.type&&(t.thetaLength=(t.thetaLength??180)*$E),t&&"TorusGeometry"===t.type&&(t.arc=t.arc*$E),t&&"PathGeometry"===t.type&&(t.extrusion.angle*=$E,t.extrusion.twist*=$E),"Mesh"===e.type&&"TextGeometry"===e.geometry.type&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(Xy(e.events))&&e.events?.forEach((e=>{("MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"KeyPress"===e.type||"Collision"===e.type||"Trigger"===e.type)&&(e.runMode=e.toggle?"Toggle":"Repeat")}))}var nC,iC,rC,sC,aC,oC,lC,cC,hC,uC,dC,pC,fC,mC,gC,vC,yC,bC,wC,xC,EC=115;function CC(e,t){t(e.data);for(let n of e.children)CC(n,t)}function AC(e){let t=e.schema??104;t!==EC&&t<105&&(CC(e.asset,tC),e.schema=105)}function SC(e){let t=e.schema??0;if(t!==EC){console.warn("updating from ",t,"to ",EC),ZE(e,t),t<100&&(void 0===e.scene.publish.joystickSizeAndXYOffset&&(e.scene.publish.joystickSizeAndXYOffset=xE.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(jE(e,JE),FE(e,JE),e.schema=101),t<102&&(function(e){e.scene.objects.traverse(((e,t)=>{let n=t.geometry;n&&"PathGeometry"===n.type&&(n.extrusion.capType="flat",n.extrusion.bevel=50,n.extrusion.bevelSides=6,"Custom"===n.extrusion.shape.type&&(n.extrusion.shape.shapeQuality="low"))}))}(e),e.schema=102),t<104&&(e.shared.catelogs=new ly,e.shared.lib=LE.defaultData(),e.schema=104),t<105&&(function(e){e.shared.variables=Dv({},ly.prototype)}(e),e.scene.objects.traverse(((e,t)=>{tC(t)})),e.schema=105);for(let t of Object.values(e.shared.lib.components))AC(t);t<106&&(function(e){let t=Xy(e.shared.variables);e.shared.variables=Dv(Object.entries(t??{}).map(((e,t)=>{let[n,i]=e;return{fi:t,id:n,data:i}})),yy.prototype)}(e),e.schema=106),t<107&&(e.shared.lib.variables=LE.defaultData().variables,e.schema=107),t<109&&(function(e){e.shared.particles=Dv({},ly.prototype),e.shared.lib&&(e.shared.lib.particles=LE.defaultData().particles)}(e),e.schema=109),t<110&&(function(e){e.scene.objects.traverse(((e,t)=>{"Particle"===t.type&&"number"==typeof t.renderMaterial.size&&Object.assign(t.renderMaterial,{size:[t.renderMaterial.size,t.renderMaterial.size]})}))}(e),e.schema=110),t<111&&(e.scene.objects.traverse(((e,t)=>{!function(e){Array.isArray(Xy(e.events))&&e.events?.forEach((e=>{"disabled"in e||(e.disabled=!1),("MouseDown"===e.type||"MouseUp"===e.type||"MousePress"===e.type)&&(e.mode=e.mode||"Object")}))}(t)})),e.schema=111),t<112&&(function(e){e.scene.objects.traverse(((e,t)=>{"Page"===t.type&&(t.postprocessing.depthOfField.focusDistance=100,t.postprocessing.depthOfField.focalLength=20,t.postprocessing.depthOfField.bokehScale=5)}))}(e),e.schema=112),t<113&&(function(e){e.scene.objects.traverse(((e,t)=>{!1!==Array.isArray(Xy(t.events))&&t.events?.forEach((e=>{let t=e.runMode;"MouseDown"===e.type||"MouseUp"===e.type||"KeyDown"===e.type||"KeyUp"===e.type||"Collision"===e.type||"Trigger"===e.type?e.actions?.forEach((e=>{"Transition"===e.type&&(e.runMode=t??"Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle"===t?"Toggle":"Normal")})):"MouseHover"===e.type||"MousePress"===e.type||"KeyPress"===e.type?e.actions?.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")})):"GameControl"===e.type?(delete e.actions,Object.keys(e.gameActions).forEach((t=>{e.gameActions[t]?.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),"Animation"===e.type&&(e.runMode="Normal")}))}))):"DragDrop"===e.type?(delete e.actions,e.dragDropActions?.drag?.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")})),e.dragDropActions?.drop?.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")}))):"Resize"===e.type?(delete e.actions,e.breakpoints?.forEach((e=>{e.actions?.forEach((e=>{("Transition"===e.type||"Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Toggle")}))}))):"Start"===e.type?e.actions?.forEach((e=>{"Transition"===e.type&&(e.runMode="Once"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})):"VariableChange"===e.type||"Scroll"===e.type?e.actions?.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})):"Conditional"===e.type&&(delete e.actions,e.inActions?.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})),e.outActions?.forEach((e=>{"Transition"===e.type&&(e.runMode="Repeat"),("Animation"===e.type||"SwitchCamera"===e.type)&&(e.runMode="Normal")})))}))}))}(e),e.schema=113),t<114&&(void 0===e.scene.publish.settings.web.imageQuality&&(e.scene.publish.settings.web.imageQuality=70),e.schema=114),t<115&&(function(e){e.shared.userAPIs=Dv({},ly.prototype),e.shared.userWebhooks=Dv({},ly.prototype),e.shared.lib&&(e.shared.lib.userAPIs=LE.defaultData().userAPIs,e.shared.lib.userWebhooks=LE.defaultData().userWebhooks)}(e),e.schema=115)}}function _C(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null!==e[0].index,i=new Set(Object.keys(e[0].attributes)),r=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new gs,c=0;for(let h=0;h<e.length;++h){let u=e[h],d=0;if(n!==(null!==u.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let e in u.attributes){if(!i.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+e+'" attribute exists among all geometries, or in none of them.'),null;void 0===s[e]&&(s[e]=[]),s[e].push(u.attributes[e]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(o!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let e in u.morphAttributes){if(!r.has(e))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===a[e]&&(a[e]=[]),a[e].push(u.morphAttributes[e])}if(t){let e;if(n)e=u.index.count;else{if(void 0===u.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;e=u.attributes.position.count}l.addGroup(c,e,h),c+=e}}if(n){let t=0,n=[];for(let i=0;i<e.length;++i){let r=e[i].index;for(let e=0;e<r.count;++e)n.push(r.getX(e)+t);t+=e[i].attributes.position.count}l.setIndex(n)}for(let h in s){let e=TC(s[h]);if(!e)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,e)}for(let h in a){let e=a[h][0].length;if(0===e)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[];for(let t=0;t<e;++t){let e=[];for(let i=0;i<a[h].length;++i)e.push(a[h][i][t]);let n=TC(e);if(!n)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(n)}}return l}function TC(e){let t,n,i,r=0;for(let o=0;o<e.length;++o){let s=e[o];if(s.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=s.array.constructor),t!==s.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===n&&(n=s.itemSize),n!==s.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===i&&(i=s.normalized),i!==s.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=s.array.length}let s=new t(r),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new ss(s,n,i)}(e=>{e.defaultData={schema:EC,scene:_E.defaultData,frames:(new ly).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",TE.defaultData),shared:{...RE.emptyData(),colors:RE.defaultColors()}},e.emptyDataForImports=function(){let e=_E.emptyDataWithPage();return{schema:EC,scene:e,frames:(new ly).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",TE.defaultData),shared:{...RE.emptyData(),colors:RE.defaultColors(),images:RE.defaultImages()}}},e.emptyData=function(){return{schema:EC,scene:_E.emptyDataWithPage(),frames:(new ly).add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",TE.defaultData),shared:RE.emptyData()}},e.clipboard2dData=function(){return{schema:EC,scene:_E.emptyData(),frames:new ly,shared:RE.emptyData()}},e.collabHelper={...Cy,updateSchema:e=>(e.schema??0)<EC?Qy(e,SC):(e.schema??0)-EC},e.updateSchemaDirectly=function(t){let n=e.collabHelper.updateSchema(t);return"number"==typeof n?0===n?t:null:n.data},e.withoutLib=function(e){return{...e,shared:{...e.shared,lib:LE.defaultData()}}},e.getComponentData=function(e,t){let n=e.scene.objects.get(t);if(n&&"Component"===n.data.type)return n;{let n=e.shared.lib.components[t];if(n)return n.asset}},e.hasSensitiveData=function(e){let t=Object.values(e.shared.userAPIs);for(let n of t){let e=n.headers;for(let t of e)if("authorization"===t.data.key.toLowerCase()&&""!==t.data.value)return!0}return!1}})(nC||(nC={})),(e=>{e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"}})(iC||(iC={})),(e=>{e.is=function(e){return!0}})(rC||(rC={})),(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]},e.merge=function(e,t){return{position:t?.position??e.position,rotation:t?.rotation??e.rotation,scale:t?.scale??e.scale,shear:t?.shear??e.shear}},e.diff=function(e,t){return Ov({position:Xw.isEqual(e.position,t.position)?void 0:t.position,rotation:e.rotation===t.rotation?void 0:t.rotation,scale:Xw.isEqual(e.scale,t.scale)?void 0:t.scale,shear:e.shear&&t.shear&&Xw.isEqual(e.shear,t.shear)?void 0:t.shear})}})(sC||(sC={})),(e=>{e.defaultData={horizontalConstraint:0,verticalConstraint:0}})(aC||(aC={})),(e=>{e.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8}})(oC||(oC={})),(e=>{e.defaultData={opacity:1,fill:{color:sx.fromHexAndA(yx,1),enabled:!0},stroke:{color:sx.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:sx.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:sx.from0to1([0,0,0,1]),enabled:!1,spread:0}}})(lC||(lC={})),(e=>{e.newEmpty=function(e,t){return{name:t}},e.patch=function(e,t){if(void 0===t)return e;let n={...e};return Object.assign(n,sC.merge(n,t)),n=function(e,t){if(void 0===t)return e;let n={...e},i=["width","height","cornerRadius"];for(let r of i)r in n&&r in t&&void 0!==t[r]&&Object.assign(n,{[r]:t[r]});return n}(n,t),n=function(e,t){if(void 0===t)return e;let n={...e};return"fill"in n&&"fill"in t&&void 0!==t.fill&&Object.assign(n,{fill:{...n.fill,...t.fill}}),"stroke"in n&&"stroke"in t&&void 0!==t.stroke&&Object.assign(n,{stroke:{...n.stroke,...t.stroke}}),"layerBlur"in n&&"layerBlur"in t&&void 0!==t.layerBlur&&Object.assign(n,{layerBlur:{...n.layerBlur,...t.layerBlur}}),"backgroundBlur"in n&&"backgroundBlur"in t&&void 0!==t.backgroundBlur&&Object.assign(n,{backgroundBlur:{...n.backgroundBlur,...t.backgroundBlur}}),"dropShadow"in n&&"dropShadow"in t&&void 0!==t.dropShadow&&Object.assign(n,{dropShadow:{...n.dropShadow,...t.dropShadow}}),"innerShadow"in n&&"innerShadow"in t&&void 0!==t.innerShadow&&Object.assign(n,{innerShadow:{...n.innerShadow,...t.innerShadow}}),n}(n,t),n},e.toOps=function(e,t){let n,i=[];for(let[r,s]of Object.entries(t))"name"!==r&&(void 0===n&&(n={path:[],props:{},type:0},i.push(n)),n.props[r]=s);return i}})(cC||(cC={})),(e=>{e.defaultData={...sC.defaultData,...aC.defaultData,states:new yy,events:new yy,visible:!0,raycastLock:!1}})(hC||(hC={})),(e=>{e.defaultData={...hC.defaultData,...lC.defaultData}})(uC||(uC={})),(e=>{e.defaultData={cornerRadius:[0,0,0,0]}})(dC||(dC={})),(e=>{e.defaultData={...uC.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"}})(pC||(pC={})),(e=>{e.defaultData={...uC.defaultData,...dC.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"}})(fC||(fC={})),(e=>{e.defaultData={...uC.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"}})(mC||(mC={})),(e=>{e.defaultData={...uC.defaultData,type:"path2d",path:"",name:"Path"}})(gC||(gC={})),(e=>{e.is=function(e){return"ellipse2d"===e.type||"rectangle2d"===e.type||"text2d"===e.type||"vector2d"===e.type||"path2d"===e.type}})(vC||(vC={})),(e=>{e.defaultData={...hC.defaultData,name:"Group",type:"group2d"}})(yC||(yC={})),(e=>{e.defaultData=()=>({...hC.defaultData,...dC.defaultData,...lC.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:sx.fromHexAndA(4737101,1),enabled:!0},stroke:{color:sx.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}})})(bC||(bC={})),(e=>{e.defaultData=function(e){switch(e){case"rectangle2d":case"vector2d":return{...fC.defaultData};case"ellipse2d":return{...pC.defaultData};case"text2d":return{...mC.defaultData};case"path2d":return{...gC.defaultData};case"frame2d":return{...bC.defaultData()};case"group2d":return{...yC.defaultData}}},e.getPivot=function(e){return"width"in e&&"height"in e?["number"==typeof e.width?.5*e.width:0,"number"==typeof e.height?.5*e.height:0]:[0,0]},e.isResizeable=function(e){return"rectangle2d"===e.type||"ellipse2d"===e.type||"text2d"===e.type||"frame2d"===e.type},e.isAutoLayoutable=function(e){return"frame2d"===e.type&&void 0!==e.autoLayout},e.hasCorners=function(e){return"rectangle2d"===e.type||"frame2d"===e.type}})(wC||(wC={})),(e=>{e.defaultData={name:"UI",type:"scene2d",objects:new vy},e.emptyData=function(){return{type:"scene2d",objects:new vy}}})(xC||(xC={}));var PC=Math.pow(2,-24),MC=class{constructor(){}};function NC(e,t,n){return n.min.x=t[e],n.min.y=t[e+1],n.min.z=t[e+2],n.max.x=t[e+3],n.max.y=t[e+4],n.max.z=t[e+5],n}function IC(e){let t=-1,n=-1/0;for(let i=0;i<3;i++){let r=e[i+3]-e[i];r>n&&(n=r,t=i)}return t}function OC(e,t){t.set(e)}function DC(e,t,n){let i,r;for(let s=0;s<3;s++){let a=s+3;i=e[s],r=t[s],n[s]=i<r?i:r,i=e[a],r=t[a],n[a]=i>r?i:r}}function LC(e,t,n){for(let i=0;i<3;i++){let r=t[e+2*i],s=t[e+2*i+1],a=r-s,o=r+s;a<n[i]&&(n[i]=a),o>n[i+3]&&(n[i+3]=o)}}function RC(e){let t=e[3]-e[0],n=e[4]-e[1],i=e[5]-e[2];return 2*(t*n+n*i+i*t)}function kC(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,h=-1/0,u=1/0,d=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0,v=null!==r;for(let y=6*t,b=6*(t+n);y<b;y+=6){let t=e[y+0],n=e[y+1],i=t-n,r=t+n;i<s&&(s=i),r>l&&(l=r),v&&t<u&&(u=t),v&&t>f&&(f=t);let b=e[y+2],w=e[y+3],x=b-w,E=b+w;x<a&&(a=x),E>c&&(c=E),v&&b<d&&(d=b),v&&b>m&&(m=b);let C=e[y+4],A=e[y+5],S=C-A,_=C+A;S<o&&(o=S),_>h&&(h=_),v&&C<p&&(p=C),v&&C>g&&(g=C)}i[0]=s,i[1]=a,i[2]=o,i[3]=l,i[4]=c,i[5]=h,v&&(r[0]=u,r[1]=d,r[2]=p,r[3]=f,r[4]=m,r[5]=g)}var BC=32,UC=(e,t)=>e.candidate-t.candidate,zC=new Array(BC).fill().map((()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}))),FC=new Float32Array(6);function jC(e,t){function n(e){d&&d(e/p)}function i(t,r,d){let p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!f&&m>=l&&(f=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),d<=h||m>=l)return n(r+d),t.offset=r,t.count=d,t;let g=function(e,t,n,i,r,s){let a=-1,o=0;if(0===s)a=IC(t),-1!==a&&(o=(t[a]+t[a+3])/2);else if(1===s)a=IC(e),-1!==a&&(o=function(e,t,n,i){let r=0;for(let s=t,a=t+n;s<a;s++)r+=e[6*s+2*i];return r/n}(n,i,r,a));else if(2===s){let s=RC(e),l=1.25*r,c=6*i,h=6*(i+r);for(let e=0;e<3;e++){let i=t[e],u=(t[e+3]-i)/BC;if(r<8){let t=[...zC];t.length=r;let i=0;for(let r=c;r<h;r+=6,i++){let s=t[i];s.candidate=n[r+2*e],s.count=0;let{bounds:a,leftCacheBounds:o,rightCacheBounds:l}=s;for(let e=0;e<3;e++)l[e]=1/0,l[e+3]=-1/0,o[e]=1/0,o[e+3]=-1/0,a[e]=1/0,a[e+3]=-1/0;LC(r,n,a)}t.sort(UC);let u=r;for(let e=0;e<u;e++){let n=t[e];for(;e+1<u&&t[e+1].candidate===n.candidate;)t.splice(e+1,1),u--}for(let r=c;r<h;r+=6){let i=n[r+2*e];for(let e=0;e<u;e++){let s=t[e];i>=s.candidate?LC(r,n,s.rightCacheBounds):(LC(r,n,s.leftCacheBounds),s.count++)}}for(let n=0;n<u;n++){let i=t[n],c=i.count,h=r-i.count,u=i.leftCacheBounds,d=i.rightCacheBounds,p=0;0!==c&&(p=RC(u)/s);let f=0;0!==h&&(f=RC(d)/s);let m=1+1.25*(p*c+f*h);m<l&&(a=e,l=m,o=i.candidate)}}else{for(let e=0;e<BC;e++){let t=zC[e];t.count=0,t.candidate=i+u+e*u;let n=t.bounds;for(let e=0;e<3;e++)n[e]=1/0,n[e+3]=-1/0}for(let r=c;r<h;r+=6){let t=~~((n[r+2*e]-i)/u);t>=BC&&(t=31);let s=zC[t];s.count++,LC(r,n,s.bounds)}let t=zC[31];OC(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){let t=zC[e],n=zC[e+1];DC(t.bounds,n.rightCacheBounds,t.rightCacheBounds)}let d=0;for(let n=0;n<31;n++){let t=zC[n],i=t.count,c=t.bounds,h=zC[n+1].rightCacheBounds;0!==i&&(0===d?OC(c,FC):DC(c,FC,FC)),d+=i;let u=0,p=0;0!==d&&(u=RC(FC)/s);let f=r-d;0!==f&&(p=RC(h)/s);let m=1+1.25*(u*d+p*f);m<l&&(a=e,l=m,o=t.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:o}}(t.boundingData,p,a,r,d,u);if(-1===g.axis)return n(r+d),t.offset=r,t.count=d,t;let v=function(e,t,n,i,r){let s=n,a=n+i-1,o=r.pos,l=2*r.axis;for(;;){for(;s<=a&&t[6*s+l]<o;)s++;for(;s<=a&&t[6*a+l]>=o;)a--;if(!(s<a))return s;for(let n=0;n<3;n++){let i=e[3*s+n];e[3*s+n]=e[3*a+n],e[3*a+n]=i;let r=t[6*s+2*n+0];t[6*s+2*n+0]=t[6*a+2*n+0],t[6*a+2*n+0]=r;let o=t[6*s+2*n+1];t[6*s+2*n+1]=t[6*a+2*n+1],t[6*a+2*n+1]=o}s++,a--}}(o,a,r,d,g);if(v===r||v===r+d)n(r+d),t.offset=r,t.count=d;else{t.splitAxis=g.axis;let e=new MC,n=r,o=v-r;t.left=e,e.boundingData=new Float32Array(6),kC(a,n,o,e.boundingData,s),i(e,n,o,s,m+1);let l=new MC,c=v,h=d-o;t.right=l,l.boundingData=new Float32Array(6),kC(a,c,h,l.boundingData,s),i(l,c,h,s,m+1)}return t}!function(e,t){if(!e.index){let n,i=e.attributes.position.count,r=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;n=i>65535?new Uint32Array(new r(4*i)):new Uint16Array(new r(2*i)),e.setIndex(new ss(n,1));for(let e=0;e<i;e++)n[e]=e}}(e,t);let r=new Float32Array(6),s=new Float32Array(6),a=function(e,t){let n=e.attributes.position,i=e.index.array,r=i.length/3,s=new Float32Array(6*r),a=n.normalized,o=n.array,l=n.offset||0,c=3;n.isInterleavedBufferAttribute&&(c=n.data.stride);let h=["getX","getY","getZ"];for(let u=0;u<r;u++){let e,r,d,p=3*u,f=6*u;a?(e=i[p+0],r=i[p+1],d=i[p+2]):(e=i[p+0]*c+l,r=i[p+1]*c+l,d=i[p+2]*c+l);for(let i=0;i<3;i++){let l,c,u;a?(l=n[h[i]](e),c=n[h[i]](r),u=n[h[i]](d)):(l=o[e+i],c=o[r+i],u=o[d+i]);let p=l;c<p&&(p=c),u<p&&(p=u);let m=l;c>m&&(m=c),u>m&&(m=u);let g=(m-p)/2,v=2*i;s[f+v+0]=p+g,s[f+v+1]=g+(Math.abs(p)+g)*PC,p<t[i]&&(t[i]=p),m>t[i+3]&&(t[i+3]=m)}}return s}(e,r),o=e.index.array,l=t.maxDepth,c=t.verbose,h=t.maxLeafTris,u=t.strategy,d=t.onProgress,p=e.index.count/3,f=!1,m=[],g=function(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],n=new Set;for(let r of e.groups)n.add(r.start),n.add(r.start+r.count);let i=Array.from(n.values()).sort(((e,t)=>e-t));for(let r=0;r<i.length-1;r++){let e=i[r],n=i[r+1];t.push({offset:e/3,count:(n-e)/3})}return t}(e);if(1===g.length){let e=g[0],t=new MC;t.boundingData=r,function(e,t,n,i){let r=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,c=-1/0;for(let h=6*t,u=6*(t+n);h<u;h+=6){let t=e[h+0];t<r&&(r=t),t>o&&(o=t);let n=e[h+2];n<s&&(s=n),n>l&&(l=n);let i=e[h+4];i<a&&(a=i),i>c&&(c=i)}i[0]=r,i[1]=s,i[2]=a,i[3]=o,i[4]=l,i[5]=c}(a,e.offset,e.count,s),i(t,e.offset,e.count,s),m.push(t)}else for(let v of g){let e=new MC;e.boundingData=new Float32Array(6),kC(a,v.offset,v.count,e.boundingData,s),i(e,v.offset,v.count,s),m.push(e)}return m}var VC=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let n=1/0,i=-1/0;for(let r=0,s=e.length;r<s;r++){let s=e[r][t];n=s<n?s:n,i=s>i?s:i}this.min=n,this.max=i}setFromPoints(e,t){let n=1/0,i=-1/0;for(let r=0,s=t.length;r<s;r++){let s=t[r],a=e.dot(s);n=a<n?a:n,i=a>i?a:i}this.min=n,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}};VC.prototype.setFromBox=function(){let e=new ji;return function(t,n){let i=n.min,r=n.max,s=1/0,a=-1/0;for(let o=0;o<=1;o++)for(let n=0;n<=1;n++)for(let l=0;l<=1;l++){e.x=i.x*o+r.x*(1-o),e.y=i.y*n+r.y*(1-n),e.z=i.z*l+r.z*(1-l);let c=t.dot(e);s=Math.min(c,s),a=Math.max(c,a)}this.min=s,this.max=a}}();!function(){let e=new VC}();var HC=function(){let e=new ji,t=new ji,n=new ji;return function(i,r,s){let a=i.start,o=e,l=r.start,c=t;n.subVectors(a,l),e.subVectors(i.end,i.start),t.subVectors(r.end,r.start);let h,u,d=n.dot(c),p=c.dot(o),f=c.dot(c),m=n.dot(o),g=o.dot(o)*f-p*p;h=0!==g?(d*p-m*f)/g:0,u=(d+h*p)/f,s.x=h,s.y=u}}(),WC=function(){let e=new di,t=new ji,n=new ji;return function(i,r,s,a){HC(i,r,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1)return i.at(o,s),void r.at(l,a);if(o>=0&&o<=1)return l<0?r.at(0,a):r.at(1,a),void i.closestPointToPoint(a,!0,s);if(l>=0&&l<=1)return o<0?i.at(0,s):i.at(1,s),void r.closestPointToPoint(s,!0,a);{let e,c;e=o<0?i.start:i.end,c=l<0?r.start:r.end;let h=t,u=n;return i.closestPointToPoint(c,!0,t),r.closestPointToPoint(e,!0,n),h.distanceToSquared(c)<=u.distanceToSquared(e)?(s.copy(h),void a.copy(c)):(s.copy(e),void a.copy(u))}}}(),GC=function(){let e=new ji,t=new ji,n=new Ks,i=new Pu;return function(r,s){let{radius:a,center:o}=r,{a:l,b:c,c:h}=s;if(i.start=l,i.end=c,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a||(i.start=l,i.end=h,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a)||(i.start=c,i.end=h,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a))return!0;let u=s.getPlane(n);if(Math.abs(u.distanceToPoint(o))<=a){let e=u.projectPoint(o,t);if(s.containsPoint(e))return!0}return!1}}();function qC(e){return Math.abs(e)<1e-15}var KC=class extends $r{constructor(){super(...arguments),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new ji)),this.satBounds=new Array(4).fill().map((()=>new VC)),this.points=[this.a,this.b,this.c],this.sphere=new lr,this.plane=new Ks,this.needsUpdate=!0}intersectsSphere(e){return GC(e,this)}update(){let e=this.a,t=this.b,n=this.c,i=this.points,r=this.satAxes,s=this.satBounds,a=r[0],o=s[0];this.getNormal(a),o.setFromPoints(a,i);let l=r[1],c=s[1];l.subVectors(e,t),c.setFromPoints(l,i);let h=r[2],u=s[2];h.subVectors(t,n),u.setFromPoints(h,i);let d=r[3],p=s[3];d.subVectors(n,e),p.setFromPoints(d,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};KC.prototype.closestPointToSegment=function(){let e=new ji,t=new ji,n=new Pu;return function(i){let r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,{start:o,end:l}=i,c=this.points,h=1/0;for(let u=0;u<3;u++){let o=(u+1)%3;n.start.copy(c[u]),n.end.copy(c[o]),WC(n,i,e,t),r=e.distanceToSquared(t),r<h&&(h=r,s&&s.copy(e),a&&a.copy(t))}return this.closestPointToPoint(o,e),r=o.distanceToSquared(e),r<h&&(h=r,s&&s.copy(e),a&&a.copy(o)),this.closestPointToPoint(l,e),r=l.distanceToSquared(e),r<h&&(h=r,s&&s.copy(e),a&&a.copy(l)),Math.sqrt(h)}}(),KC.prototype.intersectsTriangle=function(){let e=new KC,t=new Array(3),n=new Array(3),i=new VC,r=new VC,s=new ji,a=new ji,o=new ji,l=new ji,c=new Pu,h=new Pu,u=new Pu;return function(d){let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,f=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);let m=this.plane,g=d.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let e=this.satBounds,a=this.satAxes;n[0]=d.a,n[1]=d.b,n[2]=d.c;for(let t=0;t<4;t++){let r=e[t],s=a[t];if(i.setFromPoints(s,n),r.isSeparated(i))return!1}let o=d.satBounds,l=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let n=0;n<4;n++){let e=o[n],r=l[n];if(i.setFromPoints(r,t),e.isSeparated(i))return!1}for(let c=0;c<4;c++){let e=a[c];for(let a=0;a<4;a++){let o=l[a];if(s.crossVectors(e,o),i.setFromPoints(s,t),r.setFromPoints(s,n),i.isSeparated(r))return!1}}return p&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0)),!0}{let e=this.points,t=!1,n=0;for(let o=0;o<3;o++){let i=e[o],r=e[(o+1)%3];c.start.copy(i),c.end.copy(r),c.delta(a);let s=t?h.start:h.end,l=qC(g.distanceToPoint(i));if(qC(g.normal.dot(a))&&l){h.copy(c),n=2;break}if((g.intersectLine(c,s)||l)&&!qC(s.distanceTo(r))){if(n++,t)break;t=!0}}if(1===n&&d.containsPoint(h.end))return p&&(p.start.copy(h.end),p.end.copy(h.end)),!0;if(2!==n)return!1;let i=d.points,r=!1,s=0;for(let a=0;a<3;a++){let e=i[a],t=i[(a+1)%3];c.start.copy(e),c.end.copy(t),c.delta(o);let n=r?u.start:u.end,l=qC(m.distanceToPoint(e));if(qC(m.normal.dot(o))&&l){u.copy(c),s=2;break}if((m.intersectLine(c,n)||l)&&!qC(n.distanceTo(t))){if(s++,r)break;r=!0}}if(1===s&&this.containsPoint(u.end))return p&&(p.start.copy(u.end),p.end.copy(u.end)),!0;if(2!==s)return!1;if(h.delta(a),u.delta(o),a.dot(o)<0){let e=u.start;u.start=u.end,u.end=e}let f=h.start.dot(a),v=h.end.dot(a),y=u.start.dot(a),b=u.end.dot(a);return(f===b||y===v||v<y!==f<b)&&(p&&(l.subVectors(h.start,u.start),l.dot(a)>0?p.start.copy(h.start):p.start.copy(u.start),l.subVectors(h.end,u.end),l.dot(a)<0?p.end.copy(h.end):p.end.copy(u.end)),!0)}}}(),KC.prototype.distanceToPoint=function(){let e=new ji;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),KC.prototype.distanceToTriangle=function(){let e=new ji,t=new ji,n=["a","b","c"],i=new Pu,r=new Pu;return function(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=a||o?i:null;if(this.intersectsTriangle(s,l))return(a||o)&&(a&&l.getCenter(a),o&&l.getCenter(o)),0;let c=1/0;for(let t=0;t<3;t++){let i,r=n[t],l=s[r];this.closestPointToPoint(l,e),i=l.distanceToSquared(e),i<c&&(c=i,a&&a.copy(e),o&&o.copy(l));let h=this[r];s.closestPointToPoint(h,e),i=h.distanceToSquared(e),i<c&&(c=i,a&&a.copy(h),o&&o.copy(e))}for(let h=0;h<3;h++){let l=n[h],u=n[(h+1)%3];i.set(this[l],this[u]);for(let h=0;h<3;h++){let l=n[h],u=n[(h+1)%3];r.set(s[l],s[u]),WC(i,r,e,t);let d=e.distanceToSquared(t);d<c&&(c=d,a&&a.copy(e),o&&o.copy(t))}}return Math.sqrt(c)}}();var YC=class{constructor(e,t,n){this.isOrientedBox=!0,this.min=new ji,this.max=new ji,this.matrix=new vr,this.invMatrix=new vr,this.points=new Array(8).fill().map((()=>new ji)),this.satAxes=new Array(3).fill().map((()=>new ji)),this.satBounds=new Array(3).fill().map((()=>new VC)),this.alignedSatBounds=new Array(3).fill().map((()=>new VC)),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),n&&this.matrix.copy(n)}set(e,t,n){this.min.copy(e),this.max.copy(t),this.matrix.copy(n),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};YC.prototype.update=function(){let e=this.matrix,t=this.min,n=this.max,i=this.points;for(let l=0;l<=1;l++)for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let a=i[1*l|2*r|4*s];a.x=l?n.x:t.x,a.y=r?n.y:t.y,a.z=s?n.z:t.z,a.applyMatrix4(e)}let r=this.satBounds,s=this.satAxes,a=i[0];for(let l=0;l<3;l++){let e=s[l],t=r[l],n=i[1<<l];e.subVectors(a,n),t.setFromPoints(e,i)}let o=this.alignedSatBounds;o[0].setFromPointsField(i,"x"),o[1].setFromPointsField(i,"y"),o[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},YC.prototype.intersectsBox=function(){let e=new VC;return function(t){this.needsUpdate&&this.update();let n=t.min,i=t.max,r=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=n.x,e.max=i.x,a[0].isSeparated(e)||(e.min=n.y,e.max=i.y,a[1].isSeparated(e))||(e.min=n.z,e.max=i.z,a[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let n=s[o],i=r[o];if(e.setFromBox(n,t),i.isSeparated(e))return!1}return!0}}(),YC.prototype.intersectsTriangle=function(){let e=new KC,t=new Array(3),n=new VC,i=new VC,r=new ji;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let a=this.satBounds,o=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let e=0;e<3;e++){let i=a[e],r=o[e];if(n.setFromPoints(r,t),i.isSeparated(n))return!1}let l=s.satBounds,c=s.satAxes,h=this.points;for(let e=0;e<3;e++){let t=l[e],i=c[e];if(n.setFromPoints(i,h),t.isSeparated(n))return!1}for(let e=0;e<3;e++){let s=o[e];for(let e=0;e<4;e++){let a=c[e];if(r.crossVectors(s,a),n.setFromPoints(r,t),i.setFromPoints(r,h),n.isSeparated(i))return!1}}return!0}}(),YC.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},YC.prototype.distanceToPoint=function(){let e=new ji;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),YC.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map((()=>new Pu)),n=new Array(12).fill().map((()=>new Pu)),i=new ji,r=new ji;return function(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(o||l)&&(s.getCenter(r),this.closestPointToPoint(r,i),s.closestPointToPoint(i,r),o&&o.copy(i),l&&l.copy(r)),0;let c=a*a,h=s.min,u=s.max,d=this.points,p=1/0;for(let e=0;e<8;e++){let t=d[e];r.copy(t).clamp(h,u);let n=t.distanceToSquared(r);if(n<p&&(p=n,o&&o.copy(t),l&&l.copy(r),n<c))return Math.sqrt(n)}let f=0;for(let i=0;i<3;i++)for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let a=(i+1)%3,o=(i+2)%3,l=1<<i|r<<a|s<<o,c=d[r<<a|s<<o],p=d[l];t[f].set(c,p);let m=e[i],g=e[a],v=e[o],y=n[f],b=y.start,w=y.end;b[m]=h[m],b[g]=r?h[g]:u[g],b[v]=s?h[v]:u[g],w[m]=u[m],w[g]=r?h[g]:u[g],w[v]=s?h[v]:u[g],f++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let n=0;n<=1;n++){r.x=e?u.x:h.x,r.y=t?u.y:h.y,r.z=n?u.z:h.z,this.closestPointToPoint(r,i);let s=r.distanceToSquared(i);if(s<p&&(p=s,o&&o.copy(i),l&&l.copy(r),s<c))return Math.sqrt(s)}for(let e=0;e<12;e++){let s=t[e];for(let e=0;e<12;e++){let t=n[e];WC(s,t,i,r);let a=i.distanceToSquared(r);if(a<p&&(p=a,o&&o.copy(i),l&&l.copy(r),a<c))return Math.sqrt(a)}}return Math.sqrt(p)}}();var QC=new ji,XC=new ji,ZC=new ji,JC=new di,$C=new di,eA=new di,tA=new ji,nA=new ji,iA=new ji,rA=new ji;function sA(e,t,n,i,r){let s=3*i,a=e.index.getX(s),o=e.index.getX(s+1),l=e.index.getX(s+2),{position:c,normal:h,uv:u,uv1:d}=e.attributes,p=function(e,t,n,i,r,s,a,o,l){QC.fromBufferAttribute(t,s),XC.fromBufferAttribute(t,a),ZC.fromBufferAttribute(t,o);let c=function(e,t,n,i,r,s){let a;return a=1===s?e.intersectTriangle(i,n,t,!0,r):e.intersectTriangle(t,n,i,2!==s,r),null===a?null:{distance:e.origin.distanceTo(r),point:r.clone()}}(e,QC,XC,ZC,rA,l);if(c){i&&(JC.fromBufferAttribute(i,s),$C.fromBufferAttribute(i,a),eA.fromBufferAttribute(i,o),c.uv=$r.getInterpolation(rA,QC,XC,ZC,JC,$C,eA,new di)),r&&(JC.fromBufferAttribute(r,s),$C.fromBufferAttribute(r,a),eA.fromBufferAttribute(r,o),c.uv1=$r.getInterpolation(rA,QC,XC,ZC,JC,$C,eA,new di)),n&&(tA.fromBufferAttribute(n,s),nA.fromBufferAttribute(n,a),iA.fromBufferAttribute(n,o),c.normal=$r.getInterpolation(rA,QC,XC,ZC,tA,nA,iA,new ji),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let t={a:s,b:a,c:o,normal:new ji,materialIndex:0};$r.getNormal(QC,XC,ZC,t.normal),c.face=t,c.faceIndex=s}return c}(n,c,h,u,d,a,o,l,t);return p?(p.faceIndex=i,r&&r.push(p),p):null}function aA(e,t,n,i){let r=e.a,s=e.b,a=e.c,o=t,l=t+1,c=t+2;n&&(o=n.getX(t),l=n.getX(t+1),c=n.getX(t+2)),r.x=i.getX(o),r.y=i.getY(o),r.z=i.getZ(o),s.x=i.getX(l),s.y=i.getY(l),s.z=i.getZ(l),a.x=i.getX(c),a.y=i.getY(c),a.z=i.getZ(c)}function oA(e,t,n,i,r,s,a){let o=n.index,l=n.attributes.position;for(let c=e,h=t+e;c<h;c++)if(aA(a,3*c,o,l),a.needsUpdate=!0,i(a,c,r,s))return!0;return!1}var lA=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function cA(e,t){return 65535===t[e+15]}function hA(e,t){return t[e+6]}function uA(e,t){return t[e+14]}function dA(e){return e+8}function pA(e,t){return t[e+6]}var fA=new Wi,mA=new ji,gA=["x","y","z"];function vA(e,t,n,i,r){let s=2*e,a=CA,o=AA,l=SA;if(cA(s,o)){!function(e,t,n,i,r,s){for(let a=i,o=i+r;a<o;a++)sA(e,t,n,a,s)}(t,n,i,hA(e,l),uA(s,o),r)}else{let s=dA(e);xA(s,a,i,mA)&&vA(s,t,n,i,r);let o=pA(e,l);xA(o,a,i,mA)&&vA(o,t,n,i,r)}}function yA(e,t,n,i){let r=2*e,s=CA,a=AA,o=SA;if(cA(r,a)){return function(e,t,n,i,r){let s=1/0,a=null;for(let o=i,l=i+r;o<l;o++){let i=sA(e,t,n,o);i&&i.distance<s&&(a=i,s=i.distance)}return a}(t,n,i,hA(e,o),uA(r,a))}{let r,a,l=function(e,t){return t[e+7]}(e,o),c=gA[l],h=i.direction[c]>=0;h?(r=dA(e),a=pA(e,o)):(r=pA(e,o),a=dA(e));let u=xA(r,s,i,mA)?yA(r,t,n,i):null;if(u){let e=u.point[c];if(h?e<=s[a+l]:e>=s[a+l+3])return u}let d=xA(a,s,i,mA)?yA(a,t,n,i):null;return u&&d?u.distance<=d.distance?u:d:u||d||null}}var bA=function(){let e,t,n=[],i=new lA((()=>new Wi));return function(){e=i.getPrimitive(),t=i.getPrimitive(),n.push(e,t);let s=r(...arguments);i.releasePrimitive(e),i.releasePrimitive(t),n.pop(),n.pop();let a=n.length;return a>0&&(t=n[a-1],e=n[a-2]),s};function r(n,i,s,a){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;function h(e){let t=2*e,n=AA,i=SA;for(;!cA(t,n);)t=2*(e=dA(e));return hA(e,i)}function u(e){let t=2*e,n=AA,i=SA;for(;!cA(t,n);)t=2*(e=pA(e,i));return hA(e,i)+uA(t,n)}let d=2*n,p=CA,f=AA,m=SA;if(cA(d,f)){let t=hA(n,m),i=uA(d,f);return NC(n,p,e),a(t,i,!1,c,l+n,e)}{let d,g,v,y,b=dA(n),w=pA(n,m),x=b,E=w;if(o&&(v=e,y=t,NC(x,p,v),NC(E,p,y),d=o(v),g=o(y),g<d)){x=w,E=b;let e=d;d=g,g=e,v=y}v||(v=e,NC(x,p,v));let C,A=s(v,cA(2*x,f),d,c+1,l+x);if(2===A){let e=h(x);C=a(e,u(x)-e,!0,c+1,l+x,v)}else C=A&&r(x,i,s,a,o,l,c+1);if(C)return!0;y=t,NC(E,p,y);let S,_=s(y,cA(2*E,f),g,c+1,l+E);if(2===_){let e=h(E);S=a(e,u(E)-e,!0,c+1,l+E,y)}else S=_&&r(E,i,s,a,o,l,c+1);return!!S}}}(),wA=function(){let e=new KC,t=new KC,n=new vr,i=new YC,r=new YC;return function s(a,o,l,c){let h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=2*a,d=CA,p=AA,f=SA;if(null===h&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,c),h=i),!cA(u,p)){let e=a+8,t=f[a+6];return NC(e,d,fA),!!(h.intersectsBox(fA)&&s(e,o,l,c,h)||(NC(t,d,fA),h.intersectsBox(fA)&&s(t,o,l,c,h)))}{let i=o,s=i.index,h=i.attributes.position,m=l.index,g=l.attributes.position,v=hA(a,f),y=uA(u,p);if(n.copy(c).invert(),l.boundsTree)return NC(a,d,r),r.matrix.copy(n),r.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:e=>r.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(c),e.b.applyMatrix4(c),e.c.applyMatrix4(c),e.needsUpdate=!0;for(let n=3*v,i=3*(y+v);n<i;n+=3)if(aA(t,n,s,h),t.needsUpdate=!0,e.intersectsTriangle(t))return!0;return!1}});for(let r=3*v,a=y+3*v;r<a;r+=3){aA(e,r,s,h),e.a.applyMatrix4(n),e.b.applyMatrix4(n),e.c.applyMatrix4(n),e.needsUpdate=!0;for(let n=0,i=m.count;n<i;n+=3)if(aA(t,n,m,g),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}}}();function xA(e,t,n,i){return NC(e,t,fA),n.intersectBox(fA,i)}var EA,CA,AA,SA,_A=[];function TA(e){EA&&_A.push(EA),EA=e,CA=new Float32Array(e),AA=new Uint16Array(e),SA=new Uint32Array(e)}function PA(){EA=null,CA=null,AA=null,SA=null,_A.length&&TA(_A.pop())}var MA=Symbol("skip tree generation"),NA=new Wi,IA=new Wi,OA=new vr,DA=new YC,LA=new YC,RA=new ji,kA=new ji,BA=new ji,UA=new ji,zA=new ji,FA=new Wi,jA=new lA((()=>new KC)),VA=class{static serialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),VA.serialize(arguments[0],{cloneBuffers:void 0===arguments[2]||arguments[2]});t={cloneBuffers:!0,...t};let n,i=e.geometry,r=e._roots,s=i.getIndex();return n=t.cloneBuffers?{roots:r.map((e=>e.slice())),index:s.array.slice()}:{roots:r,index:s.array},n}static deserialize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("boolean"==typeof n)return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),VA.deserialize(arguments[0],arguments[1],{setIndex:void 0===arguments[2]||arguments[2]});n={setIndex:!0,...n};let{index:i,roots:r}=e,s=new VA(t,{...n,[MA]:!0});if(s._roots=r,n.setIndex){let n=t.getIndex();if(null===n){let n=new ss(e.index,1,!1);t.setIndex(n)}else n.array!==i&&(n.array.set(i),n.needsUpdate=!0)}return s}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[MA]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[MA]||(this._roots=function(e,t){let n,i,r,s=jC(e,t),a=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let h=0;h<s.length;h++){let e=s[h],t=new o(32*l(e));n=new Float32Array(t),i=new Uint32Array(t),r=new Uint16Array(t),c(0,e),a.push(t)}return a;function l(e){return e.count?1:1+l(e.left)+l(e.right)}function c(e,t){let s=e/4,a=e/2,o=!!t.count,l=t.boundingData;for(let i=0;i<6;i++)n[s+i]=l[i];if(o){let n=t.offset,o=t.count;return i[s+6]=n,r[a+14]=o,r[a+15]=65535,e+32}{let n,r=t.left,a=t.right,o=t.splitAxis;if(n=c(e+32,r),n/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return i[s+6]=n/4,n=c(n,a),i[s+7]=o,n}}}(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Wi))),this.geometry=e}refit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&Array.isArray(e)&&(e=new Set(e));let t,n,i,r,s=this.geometry,a=s.index.array,o=s.attributes.position,l=0,c=this._roots;for(let u=0,d=c.length;u<d;u++)t=c[u],n=new Uint32Array(t),i=new Uint16Array(t),r=new Float32Array(t),h(0,l),l+=t.byteLength;function h(t,s){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=2*t;if(65535===i[c+15]){let e=n[t+6],s=1/0,l=1/0,h=1/0,u=-1/0,d=-1/0,p=-1/0;for(let t=3*e,n=3*(e+i[c+14]);t<n;t++){let e=a[t],n=o.getX(e),i=o.getY(e),r=o.getZ(e);n<s&&(s=n),n>u&&(u=n),i<l&&(l=i),i>d&&(d=i),r<h&&(h=r),r>p&&(p=r)}return(r[t+0]!==s||r[t+1]!==l||r[t+2]!==h||r[t+3]!==u||r[t+4]!==d||r[t+5]!==p)&&(r[t+0]=s,r[t+1]=l,r[t+2]=h,r[t+3]=u,r[t+4]=d,r[t+5]=p,!0)}{let i=t+8,a=n[t+6],o=i+s,c=a+s,u=l,d=!1,p=!1;e?u||(d=e.has(o),p=e.has(c),u=!d&&!p):(d=!0,p=!0);let f=u||p,m=!1;(u||d)&&(m=h(i,s,u));let g=!1;f&&(g=h(a,s,u));let v=m||g;if(v)for(let e=0;e<3;e++){let n=i+e,s=a+e,o=r[n],l=r[n+3],c=r[s],h=r[s+3];r[t+e]=o<c?o:c,r[t+e+3]=l>h?l:h}return v}}}traverse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._roots[t],i=new Uint32Array(n),r=new Uint16Array(n);!function t(s){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=2*s,l=65535===r[o+15];if(l){let t=i[s+6],c=r[o+14];e(a,l,new Float32Array(n,4*s,6),t,c)}else{let r=s+8,o=i[s+6],c=i[s+7];e(a,l,new Float32Array(n,4*s,6),c)||(t(r,a+1),t(o,a+1))}}(0)}raycast(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._roots,i=this.geometry,r=[],s=t.isMaterial,a=Array.isArray(t),o=i.groups,l=s?t.side:t;for(let c=0,h=n.length;c<h;c++){let s=a?t[o[c].materialIndex].side:l,h=r.length;if(TA(n[c]),vA(0,i,s,e,r),PA(),a){let e=o[c].materialIndex;for(let t=h,n=r.length;t<n;t++)r[t].face.materialIndex=e}}return r}raycastFirst(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._roots,i=this.geometry,r=t.isMaterial,s=Array.isArray(t),a=null,o=i.groups,l=r?t.side:t;for(let c=0,h=n.length;c<h;c++){let r=s?t[o[c].materialIndex].side:l;TA(n[c]);let h=yA(0,i,r,e);PA(),null!=h&&(null==a||h.distance<a.distance)&&(a=h,s&&(h.face.materialIndex=o[c].materialIndex))}return a}intersectsGeometry(e,t){let n=this.geometry,i=!1;for(let r of this._roots)if(TA(r),i=wA(0,n,e,t),PA(),i)break;return i}shapecast(e,t,n){let i=this.geometry;if(e instanceof Function){if(t){let e=t;t=(t,n,i,r)=>{let s=3*n;return e(t,s,s+1,s+2,i,r)}}e={boundsTraverseOrder:n,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let r=jA.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let e=o;o=(t,n,s,a,o)=>!!e(t,n,s,a,o)||oA(t,n,i,l,s,a,r)}else o||(o=l?(e,t,n,s)=>oA(e,t,i,l,n,s,r):(e,t,n)=>n);let c=!1,h=0;for(let u of this._roots){if(TA(u),c=bA(0,i,a,o,s,h),PA(),c)break;h+=u.byteLength}return jA.releasePrimitive(r),c}bvhcast(e,t,n){let{intersectsRanges:i,intersectsTriangles:r}=n,s=this.geometry.index,a=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;OA.copy(t).invert();let c=jA.getPrimitive(),h=jA.getPrimitive();if(r){let e=function(e,n,i,u,d,p,f,m){for(let g=i,v=i+u;g<v;g++){aA(h,3*g,o,l),h.a.applyMatrix4(t),h.b.applyMatrix4(t),h.c.applyMatrix4(t),h.needsUpdate=!0;for(let t=e,i=e+n;t<i;t++)if(aA(c,3*t,s,a),c.needsUpdate=!0,r(c,h,t,g,d,p,f,m))return!0}return!1};if(i){let t=i;i=function(n,i,r,s,a,o,l,c){return!!t(n,i,r,s,a,o,l,c)||e(n,i,r,s,a,o,l,c)}}else i=e}e.getBoundingBox(IA),IA.applyMatrix4(t);let u=this.shapecast({intersectsBounds:e=>IA.intersectsBox(e),intersectsRange:(t,n,r,s,a,o)=>(NA.copy(o),NA.applyMatrix4(OA),e.shapecast({intersectsBounds:e=>NA.intersectsBox(e),intersectsRange:(e,r,o,l,c)=>i(t,n,e,r,s,a,l,c)}))});return jA.releasePrimitive(c),jA.releasePrimitive(h),u}intersectsBox(e,t){return DA.set(e.min,e.max,t),DA.needsUpdate=!0,this.shapecast({intersectsBounds:e=>DA.intersectsBox(e),intersectsTriangle:e=>DA.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0;e.boundingBox||e.computeBoundingBox(),DA.set(e.boundingBox.min,e.boundingBox.max,t),DA.needsUpdate=!0;let a=this.geometry,o=a.attributes.position,l=a.index,c=e.attributes.position,h=e.index,u=jA.getPrimitive(),d=jA.getPrimitive(),p=kA,f=BA,m=null,g=null;i&&(m=UA,g=zA);let v=1/0,y=null,b=null;return OA.copy(t).invert(),LA.matrix.copy(OA),this.shapecast({boundsTraverseOrder:e=>DA.distanceToBox(e),intersectsBounds:(e,t,n)=>n<v&&n<s&&(t&&(LA.min.copy(e.min),LA.max.copy(e.max),LA.needsUpdate=!0),!0),intersectsRange:(n,i)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:e=>LA.distanceToBox(e),intersectsBounds:(e,t,n)=>n<v&&n<s,intersectsRange:(e,s)=>{for(let a=3*e,w=3*(e+s);a<w;a+=3){aA(d,a,h,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let e=3*n,t=3*(n+i);e<t;e+=3){aA(u,e,l,o),u.needsUpdate=!0;let t=u.distanceToTriangle(d,p,m);if(t<v&&(f.copy(p),g&&g.copy(m),v=t,y=e/3,b=a/3),t<r)return!0}}}});for(let e=0,s=h?h.count:c.count;e<s;e+=3){aA(d,e,h,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let t=3*n,s=3*(n+i);t<s;t+=3){aA(u,t,l,o),u.needsUpdate=!0;let n=u.distanceToTriangle(d,p,m);if(n<v&&(f.copy(p),g&&g.copy(m),v=n,y=t/3,b=e/3),n<r)return!0}}}}),jA.releasePrimitive(u),jA.releasePrimitive(d),v===1/0?null:(n.point?n.point.copy(f):n.point=f.clone(),n.distance=v,n.faceIndex=y,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(OA),f.applyMatrix4(OA),i.distance=f.sub(i.point).length(),i.faceIndex=b),n)}closestPointToPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,r=n*n,s=i*i,a=1/0,o=null;if(this.shapecast({boundsTraverseOrder:t=>(RA.copy(e).clamp(t.min,t.max),RA.distanceToSquared(e)),intersectsBounds:(e,t,n)=>n<a&&n<s,intersectsTriangle:(t,n)=>{t.closestPointToPoint(e,RA);let i=e.distanceToSquared(RA);return i<a&&(kA.copy(RA),a=i,o=n),i<r}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(kA):t.point=kA.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach((t=>{NC(0,new Float32Array(t),FA),e.union(FA)})),e}},HA=Mt(It()),WA=.5*(Math.sqrt(3)-1),GA=(3-Math.sqrt(3))/6,qA=1/3,KA=1/6,YA=(Math.sqrt(5),Math.sqrt(5),e=>0|Math.floor(e)),QA=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),XA=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function ZA(e){let t=new Uint8Array(512);for(let n=0;n<256;n++)t[n]=n;for(let n=0;n<255;n++){let i=n+~~(e()*(256-n)),r=t[n];t[n]=t[i],t[i]=r}for(let n=256;n<512;n++)t[n]=t[n-256];return t}var JA,$A=new $r,eS=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||3!==t.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let n=1;$A.a.fromBufferAttribute(e,i),$A.b.fromBufferAttribute(e,i+1),$A.c.fromBufferAttribute(e,i+2),n*=$A.getArea(),t[i/3]=n}this.distribution=new Float32Array(e.count/3);let n=0;for(let i=0;i<t.length;i++)n+=t[i],this.distribution[i]=n;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let n=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*n);return this.sampleFace(i,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,n=0,i=t.length-1,r=-1;for(;n<=i;){let s=Math.ceil((n+i)/2);if(0===s||t[s-1]<=e&&t[s]>e){r=s;break}e<t[s]?i=s-1:n=s+1}return r}sampleFace(e,t,n){let i=this.randomFunction(),r=this.randomFunction();return i+r>1&&(i=1-i,r=1-r),$A.a.fromBufferAttribute(this.positionAttribute,3*e),$A.b.fromBufferAttribute(this.positionAttribute,3*e+1),$A.c.fromBufferAttribute(this.positionAttribute,3*e+2),t.set(0,0,0).addScaledVector($A.a,i).addScaledVector($A.b,r).addScaledVector($A.c,1-(i+r)),$A.getNormal(n),this}},tS=Mt(Ot()),nS=new vr,iS=new vr,rS=new vr;(e=>{e.is=function(e){return e&&e.__isSPEObject}})(JA||(JA={}));var sS,aS=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new vr,this.copyPreviousMatrix=!0,this.hiddenMatrix=new vr,this.matrixWorldRigid=new vr,this.shearScale=new vr,this.shearScaleInv=new vr}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof Vr&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let t of this.children)t.updateMatrixWorld(e)}updateWorldMatrix(e,t){let n=this.parent;if(e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),t)for(let i of this.children)i.updateWorldMatrix(!1,!0)}traverseChildren(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n of this.children)JA.is(n)&&n.traverseObject(e,t+1)}traverseObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let n of this.children)JA.is(n)&&n.traverseObject(e,t+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,t=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:n,v:i,q:r}=(0,tS.SVD)(t),s=nS.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),a=iS.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),o=rS.copy(a).transpose();this.shearScale.makeScale(r[0],r[1],r[2]).multiply(o).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(s,o).copyPosition(this.matrixWorld),r.every((e=>Math.abs(r[0]-e)<.01))?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,t){this.updateWorldMatrix(!0,!1);let n=(new vr).copy(this.matrixWorld).invert();return null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),n.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof vr?e.hiddenMatrix.premultiply(n):e.applyMatrix4(n),e.updateWorldMatrix(!1,!1),this.add(e),void 0!==t&&(this.children.pop(),this.children.splice(t,0,e)),this}copy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return super.copy(e,t),this.hasNonUniformScale=e.hasNonUniformScale,this}onAfterRender(e,t,n,i,r,s){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},oS=class extends(aS(Vr)){},lS=class extends oS{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let n=this.children[e];n?.object!==t&&(n&&this.remove(n),n=new lS(t),this.add(n),this.children.splice(e,0,this.children.pop()),n.matrixWorldNeedsUpdate=!0,n.matrixAutoUpdate=!1,n.matrix=t.matrix,n.hiddenMatrix=t.hiddenMatrix),n.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){return void 0!==this.playModeVisible?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&!0===this.object.dataPatched.cloner?.hideBase}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return"Mesh"===this.object.type}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},cS=new ji,hS=new ji,uS=new vr,dS=[new ji(-1,1,1),new ji(-1,-1,1),new ji(1,-1,1),new ji(1,1,1),new ji(-1,1,-1),new ji(-1,-1,-1),new ji(1,-1,-1),new ji(1,1,-1)],pS=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],fS=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],mS=(e,t,n)=>{e.updateEntityBoxSize(cS,hS),uS.copy(t).multiply(e.matrixWorld),0===hS.x&&0===hS.y&&0===hS.z?n.push(new ji(cS.x,cS.y,cS.z).applyMatrix4(uS)):dS.forEach((e=>{n.push(e.clone().multiply(hS).add(cS).applyMatrix4(uS))}))},gS=class extends Wi{constructor(){super(...arguments),this.matrix=new vr,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map((e=>e.clone())),this.faces=e.faces.map((e=>e.clone())),this.edges=e.edges.map((e=>e.clone())),this.centerEdges=e.centerEdges.map((e=>e.clone())),this}setFromObjectSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let n=(new vr).copy(e.matrixWorld).invert();return this.expandByObjectSize(e,n,t)}expandByObjectSize(e,t){let n=[];return!0===(arguments.length>2&&void 0!==arguments[2]&&arguments[2])?e.traverseEntity((e=>{if(e.visible||e.cloner&&e.data.visible){if(!("geometry"in e))return void n.push(new ji);mS(e,t,n)}})):mS(e,t,n),this.setFromPoints(n)}getCenter(e){return(e=super.getCenter(e)).applyMatrix4(this.matrix),e}getPositionToCenter(e){return(e=super.getCenter(e)).applyMatrix4(uS.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(hS).multiplyScalar(.5),this.getCenter(cS),uS.copy(this.matrix).setPosition(cS),this.vertices=dS.map((e=>e.clone().multiply(hS).applyMatrix4(uS)))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=pS.map((e=>{let[t,n]=e;return new Pu(this.vertices[t],this.vertices[n])})),this.centerEdges=this.edges.map((e=>e.getCenter(new ji)))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=fS.map((e=>{let[t,n]=e;return this.vertices[t].clone().add(this.vertices[n]).multiplyScalar(.5)}))}},vS={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},yS=class extends Cc{constructor(){super()}getPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],i=this.getCurveLengths(),r=i[i.length-1]/i.length;for(let s=0,a=this.curves;s<a.length;s++){let o=a[s],l=0===s?i[s]:i[s]-i[s-1],c=Math.ceil(t*l/r),h=o.getPoints(c);for(let t=0;t<h.length;t++){let i=h[t];e&&e.equals(i)||(n.push(i),e=i)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},bS=.001;function wS(e,t,n){return t.clone().sub(e).cross(t.clone().sub(n)).length()<=bS}function xS(e,t){let n=new ji(...e.position),i=new ji(...e.controlNext.position),r=new ji(...t.controlPrevious.position),s=new ji(...t.position);return wS(n,i,s)&&wS(n,r,s)}function ES(e){let t=e.points.map((e=>new ji(...e.data.position))),n=[e.points[0]],i=new ji(...n[0].data.position);for(let h=0;h<e.points.length-1;h++)wS(i,t[h],t[h+1])||(n.push(e.points[h]),i=t[h]);n.push(e.points[e.points.length-1]);let r=e.isClosed,s=n.length-(r?0:1),a=n.length,o=[];for(let h=0;h<a;h++){let t=n[h].data,i=new ji(...t.position),s=new ji(...t.controlPrevious.position),l=new ji(...t.controlNext.position),c={position:i,baseRoundness:t.roundness,controlPrevious:s,controlNext:l};if(0===t.roundness||!e.isClosed&&(0===h||h===a-1)){o[h]={...c,removedLength:0};continue}let u=r&&h==a-1?0:h+1,d=n[r&&0==h?a-1:h-1].data,p=n[u].data,f=new ji(...d.position),m=new ji(...p.position),g=f.clone().sub(i).normalize(),v=m.clone().sub(i).normalize();Object.assign(c,{prevDir:g,nextDir:v});let y=xS(d,t),b=xS(t,p);if(y&&b){let e=g.clone().add(v).normalize(),n=e.clone().cross(g).length()/g.dot(e);o[h]={...c,tan:n,removedLength:t.roundness/n}}else o[h]={...c,removedLength:0}}for(let h=0;h<s;h++){let e=r&&h===a-1?0:h+1,t=o[h],n=o[e];if(0!==t.removedLength||0!==n.removedLength){let e=t.position.distanceTo(n.position);t.removedLength=Math.min(t.removedLength,e/2),n.removedLength=Math.min(n.removedLength,e/2)}}let l=[];for(let h=0;h<s;h++){let e=h,t=r&&h===a-1?0:h+1,i=o[e],s=o[t],c=null;if(xS(n[e].data,n[t].data)){let e=i.position.clone(),t=s.position.clone();(0!==i.removedLength||0!==s.removedLength)&&(i.nextDir&&e.add(i.nextDir.clone().setLength(i.removedLength)),s.prevDir&&t.add(s.prevDir.clone().setLength(s.removedLength))),e.distanceTo(t)>bS&&(c=new vc(e,e.clone().lerp(t,.3),t.clone().lerp(e,.3),t))}else i.position.distanceTo(s.position)>bS&&(c=new vc(i.position,i.controlNext,s.controlPrevious,s.position));l[2*h+1]=c}for(let h=0;h<a;h++){let e=o[h];if(0===e.removedLength){l[2*h]=null;continue}let t=e.position,n=e.prevDir.clone().multiplyScalar(e.removedLength).add(t),i=e.nextDir.clone().multiplyScalar(e.removedLength).add(t),r=e.tan*e.removedLength,s=e.prevDir.clone().add(e.nextDir).normalize(),a=n.clone().lerp(i,.5),c=n.distanceTo(i)/2,u=s.clone().multiplyScalar(Math.sqrt(Math.pow(r,2)-Math.pow(c,2))).add(a),d=s.clone().multiplyScalar(-r).add(u),p=t.distanceTo(d)/t.distanceTo(a),f=e.prevDir.clone().multiplyScalar(p*t.distanceTo(n)).add(t),m=f.clone().lerp(d,2),g=n.clone().lerp(f,4/3),v=i.clone().lerp(m,4/3);l[2*h]=new vc(n,g,v,i)}let c=new yS;return l.forEach((e=>{e&&c.add(e)})),c}(e=>{e.is=function(e){return e&&e.__isEntity}})(sS||(sS={}));var CS=e=>sS.is(e),AS={type:"completeState",isfromEntity:!0},SS=["x","y","z"],_S=new ji,TS=(new ji).set(0,1,0),PS=e=>class extends(aS(e)){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new gS,this._recursiveBBox=new gS,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let t=this.children[e];if(sS.is(t))return t}entityChildrenCount(){let e=this.children.length;for(;e--;)if(sS.is(this.children[e]))return e+1;return 0}get isConcreteEntity(){return"string"==typeof this.identity}get isVirtualEntity(){return"string"!=typeof this.identity}get isInstanceRoot(){return this.isConcreteEntity&&"Instance"===this.data.type}nearestInstanceSelfOrParent(){let e=this;for(;"Instance"!==e.data.type;){let t=e.parent;if(!sS.is(t))return;e=t}return e}forInstancesRec(e){this.instances.forEach((t=>{t.disposed||e(t),t.forInstancesRec(e)}))}super_Entity(e,t){"string"==typeof e&&(this.uuid=e),this.identity=e,this.data=t,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==this.data.states.length||n){for(let e of this.data.states)bE.toOps(this.data,e.data).forEach((e=>{let n=xy.replaceProps(e,this.data);this.dataPatched=this.data,this.updateByPatchedOp(n,this.data,t)}));if(null!==e){let n=this.data.states.data(e);n&&(this.dataPatched=bE.patch(this.data,n),bE.toOps(this.data,n).forEach((e=>{this.updateByPatchedOp(e,this.dataPatched,t)})))}n&&this.updateTransformState(this.dataPatched,t),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,t){e.setScalar(0),t.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors((e=>{CS(e)&&e.resetBBoxNeedsUpdateSelf()})),this.traverseEntity((e=>{e.resetBBoxNeedsUpdateSelf()}))}find(e){let t;return this.traverseEntity((n=>{n.uuid===e&&(t=n)})),t}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children,n=t.indexOf(this)+1;if(sS.is(t[n]))return t[n];if(sS.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&sS.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let t=this;for(;e>0&&null!==t;)t=t.parent,e-=1;return t}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let t=this.parent;for(;t;){if(e===t)return!0;t=t.parent}return!1}countToAccestor(e){let t=0,n=this;for(;n!==e;){if(null===n)return-1;n=n.parent,t+=1}return t}forEachEntity(e){for(let t of this.children)CS(t)&&e(t)}traverseEntityAncestors(e){this.traverseAncestors((t=>{sS.is(t)&&e(t)}))}traverseConcreteEntity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let n of this.children)CS(n)&&n.isConcreteEntity&&n.traverseEntity(e,t+1)}traverseEntity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t))for(let n of this.children)CS(n)&&n.traverseEntity(e,t+1)}traverseVisibleEntity(e){e(this);for(let t of this.children)CS(t)&&t.visible&&t.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(e){super.updateMatrixWorld(e),this.dispatchEvent({type:"updateMatrixWorld"})}copy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return super.copy(e,t),this.dataPatched=e.dataPatched,this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some((e=>CS(e)))}isAncestorOf(e){if(this.uuid===e)return!1;let t=!1;return this.traverseEntity((n=>{n.uuid===e&&(t=!0)})),t}toObjectTransformState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.updateWorldMatrix(!0,!1);let t={position:this.position.toArray(),rotation:[this.rotation.x*ui.RAD2DEG,this.rotation.y*ui.RAD2DEG,this.rotation.z*ui.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return Sv(t,e)}getTransformValues(e,t,n){return t[e].map(((t,i)=>n?.shared.getVariable(t,[this.uuid,e,SS[i]])??t))}updateTransformState(e,t){let n=!1;return e.position&&(this.position.fromArray(this.getTransformValues("position",e,t)),n=!0),e.rotation&&(_S.fromArray(this.getTransformValues("rotation",e,t)).multiplyScalar(ui.DEG2RAD),this.rotation.setFromVector3(_S),n=!0),e.scale&&(this.scale.fromArray(this.getTransformValues("scale",e,t)),n=!0),void 0!==e.hiddenMatrix&&(n=!0,this.hiddenMatrix.fromArray(e.hiddenMatrix??tx.identity)),n&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors((e=>{e.invalidateClonerTransform(this)}))),e.position&&e.rotation&&e.scale&&void 0!==e.hiddenMatrix&&this.updateWorldMatrix(!1,!0),n}onVariableUpdate(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.resetBBoxNeedsUpdate():(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors((e=>{e.invalidateClonerTransform(this)})))}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)sS.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach((e=>{sS.is(e)&&e.disposeRecursively()}))}toState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(e)};return Sv(t,e)}updateByObjUpdateOp(e,t){void 0!==e&&this.updateByOp({type:0,props:e,path:[]},{...this.data,...e},t,!1)}updateByOp(e,t,n,i){let r=this.data;this.data=t;let s=e,a=Zy(e.path,["states","*"]);if(null!==a){if(0===e.type){let[t]=a;if(this?.stateSelection===t){let t={...e.props};if(delete t.name,Object.values(e.props).some((e=>void 0===e))){let n=this.data;if(void 0!==n){let i=Gy.zoom(n,e.path.slice(2));if(i)for(let n in e.props)void 0===e.props[n]&&n in i&&(t[n]=i[n])}}s={...e,props:t,path:e.path.slice(2)}}}}else if(0===e.type){let t=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(void 0!==t){if(void 0!==e.props.name&&t.name){let{name:e,...n}=t;t=n}if(void 0!==e.props.material&&"material"in t){let{material:e,...n}=t;t=n}let n=Gy.removeOverridden(e.path,e.props,t);s={...e,props:n}}}if(this.updateByPatchedOpBase(s,bE.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),n),Zy(e.path,["overrides"])){let i=[],r=[...e.path];for(i.push(r[1]),r.splice(0,2);r.length>0&&"descendants"===r[0];)i.push(r[1]),r.splice(0,2);if(void 0===i[i.length-1]){if(0===e.type)for(let t of Object.keys(e.props)){i[i.length-1]=t;let r=n.scene.findInstance([this.uuid,...i]);r&&(r.overrideData=e.props[t],r.updateState(wy.apply(r.component.data,r.overrideData),n))}}else{let s=n.scene.findInstance([this.uuid,...i]);if(s){let a=Gy.zoom(s.component.data,r);if(0===(e={...e,path:r}).type){let t=e.props;if(a)for(let[n,i]of Object.entries(e.props))void 0===i&&(t===e.props&&(t={...e.props}),t[n]=a[n]);e={...e,props:t}}s.overrideData=mE.resolve(t.overrides,i),s.updateByOp(e,Ey.applySimple(s.data,e),n,!1)}}}else if(this.instances.length>0){let i;if(0===e.path.length&&0===e.type){let t;for(let n of gE.rootOverrideProps)n in e.props&&(void 0===t&&(t={}),t[n]=e.props[n]);t&&(i={...e,props:t})}else for(let t of gE.rootOverrideProps)if(Zy(e.path,[t])){i=e;break}void 0!==i&&this.instances.forEach((e=>{if(e.isInstanceRoot){let t=wy.filterOp(e.overrideData,i);t&&e.updateByOp(t,Ey.applySimple(e.data,t),n,!0)}})),this.instances.forEach((i=>{if(!i.isInstanceRoot){let s=wy.filterOp(i.overrideData,e);if(s){let a;a=r===i.data&&e===s?t:Ey.applySimple(i.data,s),i.updateByOp(s,a,n,!0)}}}))}}updateByPatchedOpBase(e,t,n){if(this.dataPatched=t,0===e.path.length&&0===e.type)void 0!==e.props.type&&!dx.is(e.props.type)&&vS.changeEntityProptotype(this,t,n);else if(1===e.path.length&&"geometry"===e.path[0]&&0===e.type&&"type"in e.props){vS.changeEntityProptotype(this,t,n);for(let e of this.children)sS.is(e)&&e.updateVisible(n.scene)}this.updateByPatchedOp(e,t,n)}updateByPatchedOp(e,t,n){if(0===e.path.length&&0===e.type?this.updateState(e.props,n):0===e.type&&("resolutionLevel"in e.props||"useChildrenColors"in e.props)&&this.updateState(t,n),"morphTargetInfluences"===e.path[0]&&0===e.type){let i=t.morphTargetInfluences.get(e.path[1])?.data.name;i&&this.updateMorphInfluences(i,n.shared.getVariable(e.props.value,[this.uuid,"morphTargetInfluences",i]))}if(null!==Zy(e.path,["pathSnapping"])&&this.updatePathSnapping(t.pathSnapping),null!==Zy(e.path,["cloner"])){let i=Ey.drop(e,1);0===i.path.length&&0===i.type&&!0===i.props.disabled?this.setFromClonerState(null,n):this.cloner?this.cloner.updateState(t.cloner,n.scene):(this.setFromClonerState(t.cloner,n),this.expandCloner(n.scene)),this.updateVisible(n.scene)}}updatePathSnapping(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dataPatched.pathSnapping;this._updatedPathSnapping=e,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(e){let t=this._updatedPathSnapping?.pathId??this.dataPatched.pathSnapping.pathId,n=this._updatedPathSnapping?.slide??this.dataPatched.pathSnapping.slide??0,i=this._updatedPathSnapping?.offset??this.dataPatched.pathSnapping.offset??0,r=this._updatedPathSnapping?.orientation??this.dataPatched.pathSnapping.orientation;if(null===t)return;let s=e.find(t);if(!s||!1===this._needApplyPathSnapping)return;this._needApplyPathSnapping=!1;let a=s.data;if(a.geometry.path.points.length<=1)return;let o=ES(a.geometry.path),l=(n+i)%1;n+i===1&&0===l&&(l=1);let c=null;try{c=o.curves.length?o.getPointAt(l):null}catch(p){}if(null===c)return;let h=this.parent?this.parent?.matrixWorld:new vr;s.updateMatrixWorld();let u=(new vr).multiplyMatrices(h.clone().invert(),s.matrixWorld);c.applyMatrix4(u);let d={position:c.toArray(),rotation:a.rotation};if("tangential"===r){let e=(new vr).extractRotation(s.matrixWorld),t=o.getTangentAt(l).applyMatrix4(e).add(c),n=(new vr).lookAt(c,t,TS),i=_S.setFromEuler((new Tr).setFromRotationMatrix(n)).multiplyScalar(ui.RAD2DEG);d={...d,rotation:i.toArray()}}this.updateTransformState(d),this.traverseEntity((e=>{e._cameraType&&e.dispatchEvent(AS)}))}updateVisible(e){if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||!0!==this.dataPatched.cloner?.hideBase),!e)return;let t=!1;this.traverseEntity((e=>{if("Splat"===e.data.type)return t=!0,!0})),t&&e.reloadSplats()}updateState_Entity(e,t){void 0!==e.name&&(this.name=e.name),void 0!==e.raycastLock&&(this.raycastLock=e.raycastLock),void 0!==e.visible&&(this.updateVisible(t?.scene),this.resetBBoxNeedsUpdate()),t&&"cloner"in e&&void 0!==e.cloner&&(this.setFromClonerState(e.cloner,t),this.updateVisible(t.scene)),this.updateTransformState(e,t)}get attachedSurfaceCloners(){return this.children.filter((e=>e instanceof vS.Cloner&&"toObject"===e.parameters.type))}setFromClonerState(e,t){this.disposed||(null===e||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):void 0===this.cloner?(this.cloner=new vS.Cloner(this,e),t.scene.addPendingExpandCloner(this)):this.cloner.updateState(e,t.scene))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}requestRender(){this.dispatchEvent({type:"requestRender"})}},MS=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=e.parameters?.radiusTop,i=e.parameters?.radiusBottom,r=Object.assign({},t?.parameters??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);r.thetaLength=ui.clamp(r.thetaLength,0,360);let s=r.width/2,a=r.radiusTop??s,o=r.radiusBottom??s;if(a===o?(a=s,o=s):a>o?(a=s,o=o*s/a):(a=a*s/o,o=s),r.shapeBlendNode){a=n??s,o=i??s;let e=2*Math.max(a,o);r.width=e,r.depth=e}return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),radiusTop:a,radiusBottom:o})}}static build(e){let t,{width:n,depth:i,height:r,radialSegments:s,heightSegments:a,openEnded:o,thetaStart:l,thetaLength:c,radiusTop:h,radiusBottom:u,cornerRadius:d,cornerSegments:p,hollow:f}=e.parameters;return 0===c?(t=new gs,t.setAttribute("position",new ls([],3))):t=d||f?new OS(h,u,r,s,a,o,l,c*Math.PI/180,d,d,p,f):new _c(h,u,r,s,a,o,l,c*Math.PI/180),t.scale(1,1,i/n),Object.assign(t,{userData:{...e,type:"CylinderGeometry"}})}};function NS(e,t,n){n.x=e.x*t.x,n.y=e.y,n.z=e.x*t.y}function IS(e){return new di(e.y,-e.x)}var OS=class extends gs{constructor(e,t,n,i,r,s,a,o,l,c,h,u){let d=arguments.length>12&&void 0!==arguments[12]&&arguments[12];super(),this.type="RoundedCylinderBufferGeometry",e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,s=void 0!==s&&s,a=void 0!==a?a:0,o=void 0!==o?o:2*Math.PI,s&&(l=0,c=0);let p=[],f=[],m=[],g=[],v=0,y=n/2,b=new ji,w=new ji;d&&0==e&&(e=l),d&&0==t&&(t=c);let x=new di(e,y),E=new di(t,-y),C=null,A=null,S=null,_=null,T=x.clone().sub(E),P=0,M=0,N=0;u>0&&(P=Math.min(e,t)*(1-u),M=e-P,N=t-P);let I=x.clone();I.x-=P;let O=Math.PI-T.angle(),D=T.angle(),L=Math.tan(D/2),R=Math.tan(O/2),k=L+R,B=u?k:R,U=u?k:L;if(l=Math.min(l,(e-M)/B,T.length()/k),c=Math.min(c,(t-N)/U,T.length()/k),l>0){let e=l/L;C=x.clone().sub(new di(e,l)),u&&(S=C.clone(),S.x-=P-k*l),x.sub(T.clone().setLength(e))}if(c>0){let e=c/R;A=E.clone().sub(new di(e,-c)),E.add(T.clone().setLength(e)),u&&(_=A.clone(),_.x-=P-k*c,I.sub(T.clone().setLength(e)))}T=x.clone().sub(E);let z=T.length()<.5,F=[];for(let W=0;W<=i;W++){let h=[],d=W/i,p=d*o+a,y=new di(Math.sin(p),Math.cos(p));if(_&&A?(j(h,d,y,O,c,_,-1,!0),j(h,d,y,D,c,A,-1,!1)):A?(V(h,y,A.x,0,-1),j(h,d,y,D,c,A,-1,!1)):s||V(h,y,t,N,-1),NS(IS(T).normalize(),y,b),!z)for(let e=0;e<=r;e++){let t=e/r;NS(T.clone().multiplyScalar(t).add(E),y,w),f.push(w.x,w.y,w.z),m.push(b.x,b.y,b.z),g.push(d,.5+w.y/n),h.push(v++)}if(S&&C?(j(h,d,y,O,l,C,1,!1),j(h,d,y,D,l,S,1,!0)):C?(j(h,d,y,O,l,C,1,!1),V(h,y,C.x,0,1)):s||V(h,y,e,M,1),u&&!z){NS(IS(T).multiplyScalar(-1).normalize(),y,b);for(let e=0;e<=r;e++){let t=e/r;NS(T.clone().multiplyScalar(-t).add(I),y,w),f.push(w.x,w.y,w.z),m.push(b.x,b.y,b.z),g.push(d,.5+w.y/n),h.push(v++)}}u&&!s&&h.push(h[0]),F.push(h)}for(let W=0;W<F.length-1;W++)for(let e=0;e<F[0].length-1;e++){if(s&&u&&e==r)continue;let t=F[W][e],n=F[W+1][e],i=F[W+1][e+1],a=F[W][e+1],o=f[3*i+0],l=f[3*i+2];p.push(t,n,a),(0!=o||0!=l)&&p.push(n,i,a)}function j(e,t,i,r,s,a,o,l){for(let c=0;c<h+1;c++){let u=c/h,d=o<0?u:1-u;l&&(d-=1),d*=r;let p=new di(Math.sin(d),Math.cos(d)*o);NS(p.clone().multiplyScalar(s).add(a),i,w),f.push(w.x,w.y,w.z),NS(p,i,b),m.push(b.x,b.y,b.z),g.push(t,.5+w.y/n),e.push(v++)}}function V(e,t,n,i,r){let s=new ji,a=new di,o=[n,i];r<0&&o.reverse();for(let l of o)a.set(l,y*r),NS(a,t,s),f.push(s.x,s.y,s.z),m.push(0,r,0),g.push(.5,.5),e.push(v++)}function H(n,i,r){let s=new di(Math.sin(r),Math.cos(r)),a=new di(-Math.cos(r),Math.sin(r)),o=new ji,l=n<0?(e,t,n)=>p.push(e,t,n):(e,t,n)=>p.push(e,n,t);NS(new di((e+t+M+N)/4,0),s,o),f.push(o.x,o.y,o.z),m.push(a.x,0,a.y),g.push(.5,.5);let c=v++;for(let e of i){let t=f.slice(3*e,3*e+3);f.push(...t),m.push(a.x,0,a.y);let n=g.slice(2*e,2*e+2);g.push(...n),v++}for(let e=c+1;e<v-1;e++)l(c,e,e+1);l(c,v-1,c+1)}o<2*Math.PI&&(H(-1,F[0],a),H(1,F[F.length-1],a+o)),this.setIndex(p),this.setAttribute("position",new ls(f,3)),this.setAttribute("normal",new ls(m,3)),this.setAttribute("uv",new ls(g,2))}},DS=Math.PI/2,LS=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:4;super(),this.type="BoxGeometry",i=Math.floor(i),r=Math.floor(r),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,n/2);let l=[],c=[],h=[],u=[],d=0;function p(e,t,n,i,r,s,o,p,f,m){let g=(s-2*a)/f,v=(o-2*a)/m,y=s/2-a,b=o/2-a,w=p/2,x=f+1,E=m+1,C=0,A=new ji;for(let a=0;a<E;a++){let s=a*v-b;for(let o=0;o<x;o++){let l=o*g-y;A[e]=l*i,A[t]=s*r,A[n]=w,c.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=p>0?1:-1,h.push(A.x,A.y,A.z),u.push(o/f),u.push(1-a/m),C+=1}}for(let a=0;a<m;a++)for(let e=0;e<f;e++){let t=d+e+x*a,n=d+e+x*(a+1),i=d+(e+1)+x*(a+1),r=d+(e+1)+x*a;l.push(t,n,r),l.push(n,i,r)}d+=C}function f(e,t,n,i,r,s,p,f,m,g){let v=(p-2*a)/g,y=p/2-a,b=f/2-a,w=m/2,x=g+1,E=0,C=new ji,A=new ji;for(let l=0;l<o+1;l++){let d=l/o*DS,p=Math.sin(d)*a,f=(1-Math.cos(d))*a,m=Math.sin(d),S=Math.cos(d);C[t]=(b+p)*r,C[n]=(w-f)*s,A[e]=0,A[t]=m*Math.sign(C[t]),A[n]=S*Math.sign(C[n]);for(let t=0;t<x;t++){let n=t*v-y;C[e]=n*i,c.push(C.x,C.y,C.z),h.push(A.x,A.y,A.z),u.push(t/g),u.push(0),E+=1}}for(let a=0;a<o;a++)for(let e=0;e<g;e++){let t=d+e+x*a,n=d+e+x*(a+1),i=d+(e+1)+x*(a+1),r=d+(e+1)+x*a;l.push(t,n,r),l.push(n,i,r)}d+=E}function m(i,r,s){let p=new ji,f=new ji(e/2,t/2,n/2);f.subScalar(a);let m=[],g=i*r*s>0?(e,t,n)=>l.push(e,t,n):(e,t,n)=>l.push(e,n,t);for(let e=0;e<=o;e++){let t=[],n=DS*(1-e/o),l=Math.cos(n),g=Math.sin(n),v=0;for(let o=0;o<=e;o++){let n=Math.cos(v),o=Math.sin(v);p.x=l*n,p.y=g,p.z=l*o;let m=f.clone().addScaledVector(p,a);c.push(i*m.x,r*m.y,s*m.z),h.push(i*p.x,r*p.y,s*p.z),u.push(0,0),t.push(d++),v+=DS/e}m.push(t)}let v=m.length-1;for(let e=0;e<v;e++){let t=m[e],n=m[e+1],i=t.length-1;g(t[0],n[1],n[0]);for(let e=1;e<=i;e++)g(t[e-1],t[e],n[e]),g(t[e],n[e+1],n[e])}}p("z","y","x",-1,-1,n,t,e,s,r),p("z","y","x",1,-1,n,t,-e,s,r),p("x","z","y",1,1,e,n,t,i,s),p("x","z","y",1,-1,e,n,-t,i,s),p("x","y","z",1,-1,e,t,n,i,r),p("x","y","z",-1,-1,e,t,-n,i,r),a>0&&(f("z","y","x",-1,-1,1,n,t,e,s),f("z","y","x",1,-1,-1,n,t,e,s),f("z","y","x",-1,1,-1,n,t,e,s),f("z","y","x",1,1,1,n,t,e,s),f("x","y","z",-1,-1,-1,e,t,n,i),f("x","y","z",1,-1,1,e,t,n,i),f("x","y","z",-1,1,1,e,t,n,i),f("x","y","z",1,1,-1,e,t,n,i),f("y","x","z",-1,-1,1,t,e,n,r),f("y","x","z",1,-1,-1,t,e,n,r),f("y","x","z",1,1,1,t,e,n,r),f("y","x","z",-1,1,-1,t,e,n,r),m(1,1,1),m(-1,1,1),m(1,-1,1),m(-1,-1,1),m(1,1,-1),m(-1,1,-1),m(1,-1,-1),m(-1,-1,-1)),this.setIndex(l),this.setAttribute("position",new ls(c,3)),this.setAttribute("normal",new ls(h,3)),this.setAttribute("uv",new ls(u,2))}},RS=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4;super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];return function(){r=Math.min(.99999,r),0==r&&(s=0);let o={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[n],c=new ji,h=c.clone(),u=new $r,d=r*i,p=i-d,f=s+1,m=new ji,g=(e,t)=>m.subVectors(e,t).normalize(),v=(e,t)=>Array(e).fill(void 0).map(t),y=v(e.length/3,((t,n)=>(new ji).fromArray(e,3*n).setLength(i))),b=[],w=1e6;for(let e=0;e<y.length;e++){let n,i,r,s=y[e],a=[],o=1e10,l=-1;for(;-1!=(l=t.indexOf(e,l+1));){let e=l-l%3;n=t[e+(l+1)%3],i=t[e+(l+2)%3],r=s.distanceToSquared(y[n]),o=Math.min(o,r),a.push([n,i,r])}o+=1e-6;let c=[],h=0,u=a.length;for(let t=0;t<u;t++){[n,i,r]=a[h];let t=1==b[n]?.includes(e);r<=o&&c.push(n+ +t*w),h=a.findIndex((e=>e[0]==i))}b.push(c)}let x=[];{let e,t,n=0,i=0,r=3==o;for(let a=0;a<=s;a++){e=a*(a+1)/2,t=(a+1)*(a+2)/2;for(let o=0;o<s-a;o++)[n,i]=[e+o+a+2,t+o+a+3],x.push(e,t,...r?[i,e]:[n,t],i,n),[e,t]=[n,i];x.push(e,t,e+s+2)}}let E=c.clone(),C=c.clone(),A=c.clone(),S=c.clone(),_=c.clone(),T=[],P=v(y.length,(()=>v(o,(()=>c.clone()))));for(let e=0;e<y.length;e++){c.copy(y[e]).normalize(),E.copy(c).multiplyScalar(p);let t=b[e];for(let s=0;s<t.length;s++){let n=t[s],i=t[(s+1)%o];u.setFromPointsAndIndices(y,e,n%w,i%w),u.b.sub(u.a).setLength(1e10).add(u.a),u.c.sub(u.a).setLength(1e10).add(u.a),u.closestPointToPoint(E,P[e][s])}let n=[],i=[],r=[],v=new ji;0==s&&[...P[e]].reduce(((e,t)=>e.add(t)),v).multiplyScalar(1/o);for(let a=0;a<o;a++){let t=[],l=(a-1+o)%o,u=P[e][l],y=P[e][a];c.copy(u).sub(E),h.copy(y).sub(E);let b=E.angleTo(c),w=c.angleTo(h),x=Math.cos(b)*d;0==s?C.copy(v):C.copy(E).setLength(p+x),i.push(x);let T=[C,u,y];for(let e=0;e<2;e++){let i=T[e],r=T[e+1];S.subVectors(i,E),_.subVectors(r,E),A.crossVectors(S,_).normalize();for(let s=0;s<f;s++){let r=[b,w][e]*s/f;c.copy(S).applyAxisAngle(A,r).add(E),n.push(c.clone()),e&&(g(c,E),t.push([0==s?i:c.clone(),m.clone()]))}e&&(g(r,E),t.push([r,m.clone()]))}r.push(t)}T.push(r);let M=2*f,N=2;for(let e=0;e<o;e++){let t=M*e,r=M*((e+1)%o),s=[n[t]];for(let a=1;a<f;a++){S=n[t+a],_=n[r+a],s.push(S);for(let t=1,n=a-N+1;t<=n;t++)c.lerpVectors(S,_,t/(n+1)),c.sub(E).setLength(i[e]).add(E),s.push(c.clone());s.push(_)}for(let e=0;e<f;e++)s.push(n[e+f+t]);s.push(n[r+f]);let h=x.map((e=>s[e]));a.push(...h.map((e=>[e.x,e.y,e.z])).flat()),l.push(...h.map((e=>(g(e,E),[m.x,m.y,m.z]))).flat())}}let M=[];for(let e=0;e<b.length;e++)for(let t=0;t<o;t++){let n=b[e][t];if(n<w){let i=b[n].findIndex((t=>t%w==e)),r=T[e][t],s=T[n][i];for(let e=0;e<f;e++){let t=r[e],n=s[f-e],i=r[e+1];[t,n,i,i,n,s[f-(e+1)]].forEach((e=>{a.push(e[0].x,e[0].y,e[0].z),l.push(e[1].x,e[1].y,e[1].z)}))}M.push(r[0][0],s[f][0],r[f][0],s[0][0])}}for(;M.length;){let e,t,n,i;[e,t]=M.splice(0,2);let r=[e];for(;e!=t;)r.push(t),n=M.indexOf(t),i=n%2,t=M.splice(n-i,2)[1-i];m.subVectors(r[0],r[1]).cross(c.subVectors(r[0],r[2])).normalize();let s=m.dot(r[0])<0;s&&m.negate();for(let o=1;o<=r.length-2;o++)[r[o+ +s],r[o+1-+s],r[0]].forEach((e=>{a.push(e.x,e.y,e.z),l.push(m.x,m.y,m.z)}))}}(),function(){let e=new ji;for(let p=0;p<a.length;p+=3){e.x=a[p+0],e.y=a[p+1],e.z=a[p+2];let t=u(e)/2/Math.PI+.5,n=d(e)/Math.PI+.5;o.push(t,1-n)}let t=new ji,n=new ji,i=new ji,r=new ji,s=new di,l=new di,c=new di,h=(e,t,n,i)=>{i<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=i/2/Math.PI+.5)};for(let p=0,f=0;p<a.length;p+=9,f+=6){t.set(a[p+0],a[p+1],a[p+2]),n.set(a[p+3],a[p+4],a[p+5]),i.set(a[p+6],a[p+7],a[p+8]),s.set(o[f+0],o[f+1]),l.set(o[f+2],o[f+3]),c.set(o[f+4],o[f+5]),r.copy(t).add(n).add(i).divideScalar(3);let e=u(r);h(s,f+0,t,e),h(l,f+2,n,e),h(c,f+4,i,e)}for(let a=0;a<o.length;a+=6){let e=o[a+0],t=o[a+2],n=o[a+4],i=Math.max(e,t,n),r=Math.min(e,t,n);i>.9&&r<.1&&(e<.2&&(o[a+0]+=1),t<.2&&(o[a+2]+=1),n<.2&&(o[a+4]+=1))}function u(e){return Math.atan2(e.z,-e.x)}function d(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}}(),this.setAttribute("position",new ls(a,3)),this.setAttribute("normal",new ls(l,3)),void this.setAttribute("uv",new ls(o,2))}static fromJSON(e){return new RS(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},kS=class extends RS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=(1+Math.sqrt(5))/2,r=1/i,s="DodecahedronGeometry";super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],s,e,t,n),this.type=s}static fromJSON(e){return new kS(e.radius,e.corner,e.cornerSides)}},BS=1e-12,US=class{constructor(e){this.position=new di,this.startPosition=new di,this.uuid=ui.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new US(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},zS=class extends US{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new zS(this.parent).copy(this)}},FS=class extends US{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new zS(this),new zS(this))}static create(e,t){let n=new FS(e,new di(...t.position));return n.controls[0].position.set(...t.controlPrevious.position),n.controls[1].position.set(...t.controlNext.position),n.roundness=t.roundness,n.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,n}getOppositeControl(e){let t=this.controls.indexOf(e);return 0===t?this.controls[1]:1===t?this.controls[0]:null}applyOffsetToControls(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(let n=0,i=this.controls.length;n<i;n++){let i=this.controls[n];this.position.distanceTo(i.position)<=t?i.position.copy(this.position):i.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new FS(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){let e=this.curveBefore?.getTangentAt(1),t=this.curveAfter?.getTangentAt(0);return[e,t]}computeNormals(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new di,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di,[n,i]=this.computeTangents();return n&&i&&(jS(n,e),jS(i,t)),[e,t]}computeTangent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new di,[t,n]=this.computeTangents();return t&&n&&e.copy(t).add(n).normalize(),e}computeNormal(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new di,[t,n]=this.computeNormals();return e.copy(t).add(n).normalize(),e}};function jS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di,n=e.length();return t.set(-e.y/n,e.x/n)}var VS=new di,HS=new di,WS=new di,GS=new di,qS=new di,KS=new di,YS=new ji,QS=new ji;function XS(e){let t=new di;t.addVectors(e.v0,VS.subVectors(e.v1,e.v0).multiplyScalar(2/3));let n=new di;return n.addVectors(e.v2,HS.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new gc(e.v0,t,n,e.v2)}function ZS(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return Math.abs(e-t)<n}function JS(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return e.distanceTo(t)<n}function $S(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return e.distanceTo(t)<n}function e_(e,t,n){let i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),s=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2));return Math.acos((r*r+i*i-s*s)/(2*r*i))}function t_(e,t,n){return o_(e,t)&&o_(t,n)&&n_(e.position,t.position,n.position)}function n_(e,t,n){return 0===VS.copy(t).sub(e).cross(HS.copy(n).sub(e))}function i_(e,t,n,i,r){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(e.y-t.y)/s,c=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return i.set(o+l,a+c),r.set(o-l,a-c),[i,r]}function r_(e,t,n){return e.distanceTo(n)<t.distanceTo(n)?t:e}function s_(e,t,n,i,r,s){let a,o=t.x-e.x,l=t.y-e.y,c=n.x-e.x,h=n.y-e.y,u=Math.sqrt((o+c)*(o+c)+(l+h)*(l+h));return e_(t,e,n)>Math.PI&&(u*=-1),a=ZS(h,l)?(l+h)*(i/u-.5)*8/3/(o-c):(o+c)*(i/u-.5)*8/3/(h-l),r.set(t.x-a*l,t.y+a*o),s.set(n.x+a*h,n.y-a*c),[r,s]}function a_(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function o_(e,t){return n_(e.position,e.controls[1].position,t.position)&&n_(e.position,t.controls[0].position,t.position)}function l_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];for(let r=0,s=e.length;r<s;r++){let s=e[r],a=0;if(n&&void 0!==s.roundedCurveCorner){let e=.5*c_(s.roundedCurveCorner,t);r>0&&(i[r-1]+=e),a+=e}void 0!==s.curveAfter&&(a+=c_(s.curveAfter,t)),i.push(a)}return e.length>0&&n&&void 0!==e[0].roundedCurveCorner&&(i[e.length-1]+=.5*c_(e[0].roundedCurveCorner,t)),i}function c_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e&&e instanceof oc?2*t:e&&(e instanceof yc||e instanceof bc)?1:e&&e instanceof xc?t*e.points.length:t}var h_,u_,d_,p_=new di,f_=new di,m_=new di,g_=new di,v_=new di,y_=new di,b_=class extends Nc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;super(),this.points=[],this.shapeHoles=[],this.plane=new Ks(new ji(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=ui.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,n){let i=new b_;return i.isClosed=e.isClosed,i.points=e.points.map((e=>FS.create(e.id,e.data))),"number"==typeof e.roundness&&(i.roundness=e.roundness),i.shapeHoles=e.shapeHoles.map((e=>b_.createFromState(e))),void 0!==t&&void 0!==n&&i.applySize(t,n),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,n=this.points.length;t<n;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map((e=>this.getPointIndexById(e))).filter((e=>e>=0))}getPointIndexById(e){let t=this.points.length,n=this.points.findIndex((t=>t.uuid===e));if(n<0){let n=t;for(let t=0,i=this.shapeHoles.length;t<i;t++){let i=this.shapeHoles[t],r=i.points.length,s=i.getPointIndexById(e);if(!(s<0))return s+n;n+=r}}return n}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let n=0,i=this.shapeHoles.length;n<i;n++){let i=this.shapeHoles[n],r=e-t;if(r<=i.points.length-1)return i.points[r];t+=i.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let n=0,i=this.shapeHoles.length;n<i;n++){let i=this.shapeHoles[n],r=i.points.indexOf(e);if(r>=0)return t+r;t+=i.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map((e=>e.points)));return[...this.points,...e]}applySize(e,t){0===e&&(e=.001),0===t&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let n=p_.set(e,t);for(let i=0,r=this.points.length;i<r;i++){let e=this.points[i];e.position.multiply(n),e.controls[0].position.multiply(n),e.controls[1].position.multiply(n)}for(let i=0,r=this.shapeHoles.length;i<r;i++)this.shapeHoles[i].applyScale(e,t);this._update()}createPoint(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ui.generateUUID();t=e instanceof di?e:new di(e,n);let r=new FS(i,t);return r.roundness=this.roundness,r}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,n=this.points.length;t<n;t++){let n=this.points[t];if(n.uuid===e)return n}for(let t=0,n=this.shapeHoles.length;t<n;t++){let n=this.shapeHoles[t].getPointByUuid(e);if(n)return n}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find((t=>t.uuid===e));t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.subdivision=t,void 0===this.curveDivisions&&this.computeCurveDivisions(t);let i=n?this.roundedCurveDivisions:this.curveDivisions;return function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=QS.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){let r=t[l],c=VS,h=c_(r,i);o.push(h);for(let t=0;t<=h;t++)if(r instanceof gc||r instanceof wc||r instanceof yc){if(r.getPoint(t/h,c),s.set(c.x,c.y,0),void 0!==n&&$S(n,s))continue;void 0===n&&(n=YS),n.copy(s),e.setXYZ(a,s.x,s.y,s.z),a++}}r&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++)}(e,n?this.roundedCurves:this.curves,t,this.autoClose),i.reduce(((e,t)=>e+t),0)+1}computeCurveDivisions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;return this.curveDivisions=l_(this.points,e,!1),this.roundedCurveDivisions=l_(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;return 2*function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=QS.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){if(!1===n[l])continue;let r,c=t[l],h=VS,u=c_(c,i);o.push(u);for(let t=0;t<=u;t++)if(c instanceof gc||c instanceof wc||c instanceof yc){if(c.getPoint(t/u,h),s.set(h.x,h.y,0),r?.equals(s))continue;void 0===r?r=YS:(e.setXYZ(a,r.x,r.y,r.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),r.copy(s)}}return r&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}(e,this.curves,t,n,this.autoClose).reduce(((e,t)=>e+t),0)}extractShapePointsToFlatArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return this.subdivision=t,void 0===this.curveDivisions&&this.computeCurveDivisions(t),function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=0;for(let a=0;a<t.length;a++){let r=t[a],o=c_(r,i),l=VS;for(let t=0;t<=o;t++)if(r instanceof gc||r instanceof wc||r instanceof yc){if(r.getPoint(t/o,l),void 0!==n&&JS(n,l,BS))continue;void 0===n&&(n=HS),n.copy(l),e.push(l.x,l.y),s++}}return ZS(e[0],e[e.length-2],BS)&&ZS(e[1],e[e.length-1],BS)&&(e.pop(),e.pop()),r&&s>1&&!(ZS(e[s-1],e[1],BS)&&ZS(e[s-2],e[0],BS))&&(e.push(e[0],e[1]),s++),e}(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;void 0===this.curveDivisions&&this.computeCurveDivisions(this.subdivision);let i=t?this.roundedCurveDivisions:this.curveDivisions,r=0;t&&void 0!==this.points[0].roundedCurveCorner&&(r=.5*c_(this.points[0].roundedCurveCorner,this.subdivision));let s=e-r;s<0&&(s+=i.reduce(((e,t)=>e+t),0));for(let a=0,o=i.length;a<o;a++){let e=i[a];if(s<n+e)return[a,(s-n+1)/e];n+=e}return[0,1]}getCurveT(e,t,n){let i=this.points[e],r=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,a=s[e];if(a_(i,r)){let e=i.position.distanceTo(r.position);return i.position.distanceTo(p_.set(n.x,n.y))/e}let o=0;for(let l=0;l<e;l++)o+=s[l];return(t-o)/a}dispose(){}_applyCurveForPoint(e,t){a_(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let n=this.curves[this.curves.length-1];e.curveBefore=n,t.curveAfter=n;let i=n.clone();e.roundedCurveBefore=i,t.roundedCurveAfter=i,e.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,n=this.points.length;t<n;t++){let e=this.points[t];if(0===t)this.moveTo(e.position.x,e.position.y);else{let n=this.points[t-1];this._applyCurveForPoint(e,n)}}let e=this.getLastPoint();if(e?.curveAfter&&(e.curveAfter=void 0),this.isClosed){let e=this.points[0],t=this.points[this.points.length-1];this._applyCurveForPoint(e,t)}if(this.points.length>2){let e=0;for(let t=0,n=this.points.length;t<n;t++){let n=this.points[t],i=this.points[t-1]??this.points[this.points.length-1],r=this.points[t+1]??this.points[0],s=n.roundness,a=i&&r&&t_(i,n,r);if(!n.controlsMoved()&&s>0&&!a){let i=n.curveBefore,r=n.curveAfter;if(void 0===i||void 0===r)continue;let a,o=n.roundedCurveBefore,l=n.roundedCurveAfter,c=i.getLength(),h=r.getLength(),u=Math.min(s,.499*c),d=Math.min(s,.499*h),p=Math.min(u,d),f=1-p/c,m=p/h,g=i.getPointAt(f,p_),v=r.getPointAt(m,f_);if(this._subSplitCurve(i,o,f,g,void 0),this._subSplitCurve(r,l,m,void 0,v),this.useCubicForRoundedCorners){let e=e_(g,n.position,v)/2,t=Math.tan(e)*g.distanceTo(n.position),[i,r]=i_(g,v,t,m_,g_),s=r_(i,r,n.position),[o,l]=s_(s,g,v,t,v_,y_);a=new gc(g.clone(),o.clone(),l.clone(),v.clone())}else a=new wc(g.clone(),n.position.clone(),v.clone());n.roundedCurveCorner=a,this.roundedCurves.splice(t+e,0,a),e++}}}}_subSplitCurve(e,t,n,i,r){if(!(e instanceof yc)){let s=e,a=t,o=s.getUtoTmapping(n,0),l=function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,s=VS.subVectors(t,e).multiplyScalar(r).add(e),a=HS.subVectors(n,t).multiplyScalar(r).add(t),o=WS.subVectors(i,n).multiplyScalar(r).add(n),l=s,c=GS.subVectors(a,s).multiplyScalar(r).add(s),h=qS.subVectors(o,a).multiplyScalar(r).add(a),u=o,d=KS.subVectors(h,c).multiplyScalar(r).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,d.x,d.y,h.x,h.y,u.x,u.y,i.x,i.y]}(s.v0,s.v1,s.v2,s.v3,o);return void 0!==i&&(a.v0.set(l[0],l[1]),a.v1.set(l[2],l[3]),a.v2.set(l[4],l[5]),a.v3.set(l[6],l[7])),void 0!==r&&(a.v0.set(l[6],l[7]),a.v1.set(l[8],l[9]),a.v2.set(l[10],l[11]),a.v3.set(l[12],l[13])),a}return void 0!==i&&t.v2.copy(i),void 0!==r&&t.v1.copy(r),t}clone(){let e=new b_(this._width,this._height);return e.points=this.points.map((e=>e.clone())),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map((e=>e.clone())),e}toJSON(){return{points:this.points.reduce(((e,t)=>e.concat(t.toJSON())),[]),shapeHoles:this.shapeHoles.map((e=>e.toJSON())),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let n=0;n<t;n++){let t=7*n,i=e.points[t+0],r=e.points[t+1],s=e.points[t+2],a=e.points[t+3],o=e.points[t+4],l=e.points[t+5],c=e.points[t+6],h=new FS(ui.generateUUID(),new di(i,r));h.controls[0].position.set(s,a),h.controls[1].position.set(o,l),h.roundness=c,this.points.push(h)}return this.shapeHoles=e.shapeHoles?.length?e.shapeHoles.map((e=>{let t=new b_;return t.fromJSON(e),t})):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isText=t;let n=(e,t)=>{t instanceof gc&&t.v3.equals(e.position)&&e.controls[0].position.copy(t.v2)};return this.points=(e=>{let t,i,r=[];for(t=0,i=e.length;t<i;t++)e[t]instanceof wc&&(e[t]=XS(e[t]));for(t=0,i=e.length;t<i;t++){let i,s=e[t],a=t>0?e[t-1]:null;s instanceof gc?(i=this.createPoint(s.v0),i.controls[1].position.copy(s.v1)):s instanceof yc&&(i=this.createPoint(s.v1)),void 0!==i&&(null!==a&&n(i,a),r.push(i))}let s=e[e.length-1],a=!1;return s instanceof gc?s.v3.equals(r[0].position)&&(r[0].controls[0].position.copy(s.v2),a=!0):s instanceof yc&&s.v2.equals(r[0].position)&&(a=!0),this.isClosed=a,r})(e.curves),e instanceof Nc&&(this.shapeHoles=e.holes.map((e=>{let t=new b_;return t.fromShape(e),t}))),this.update(),this}updatePoint(e,t){let n=this.getPointByUuid(e);n&&(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.roundness&&(n.roundness=t.roundness),void 0!==t.areControlsDirectionsMirrored&&(n.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){let n=this.getPointByUuid(e)?.controls[0];n&&(t.position&&n.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){let n=this.getPointByUuid(e)?.controls[1];n&&(t.position&&n.position.fromArray(t.position),this.needsUpdate=!0)}},w_=2*Math.PI;function x_(e,t,n,i,r){let{x:s,y:a}=e;return{x:s*t+i,y:a*n+r}}function E_(e,t){let n=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),r=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:i-r*n,y:r+i*n},{x:s+a*n,y:a-s*n},{x:s,y:a}]}function C_(e,t,n,i){let r=e*i-t*n<0?-1:1,s=Math.min(1,Math.max(-1,e*n+t*i));return r*Math.acos(s)}function A_(e){let{px:t,py:n,cx:i,cy:r,rx:s,ry:a,largeArcFlag:o,sweepFlag:l}=e,c=[];if(0===s||0===a)return[];let h=(t-i)/2,u=(n-r)/2;if(0===h&&0===u)return[];s=Math.abs(s),a=Math.abs(a);let d=Math.pow(h,2)/Math.pow(s,2)+Math.pow(u,2)/Math.pow(a,2);d>1&&(s*=Math.sqrt(d),a*=Math.sqrt(d));let p=function(e,t,n,i,r,s,a,o,l,c){let h=Math.pow(r,2),u=Math.pow(s,2),d=Math.pow(a,2),p=Math.pow(o,2),f=h*u-h*p-u*d;f<0&&(f=0),f/=h*p+u*d,f=Math.sqrt(f)*(l===c?-1:1);let m=f*r/s*o,g=f*-s/r*a,v=m+(e+n)/2,y=g+(t+i)/2,b=(a-m)/r,w=(o-g)/s,x=(-a-m)/r,E=(-o-g)/s,C=C_(1,0,b,w),A=C_(b,w,x,E);return!c&&A>0&&(A-=w_),c&&A<0&&(A+=w_),{centerx:v,centery:y,ang1:C,ang2:A}}(t,n,i,r,s,a,h,u,o,l),{ang1:f,ang2:m}=p,{centerx:g,centery:v}=p,y=Math.abs(m)/(w_/4);Math.abs(1-y)<1e-7&&(y=1);let b=Math.max(Math.ceil(y),1);m/=b;for(let w=0;w<b;w++)c.push(E_(f,m)),f+=m;return c.map((e=>{let{x:t,y:n}=x_(e[0],s,a,g,v),{x:i,y:r}=x_(e[1],s,a,g,v),{x:o,y:l}=x_(e[2],s,a,g,v);return{x1:t,y1:n,x2:i,y2:r,x:o,y:l}}))}function S_(e,t){if(!e)throw t||"Assertion Failed!"}(u_=h_||(h_={}))[u_.ODD=0]="ODD",u_[u_.NONZERO=1]="NONZERO",u_[u_.POSITIVE=2]="POSITIVE",u_[u_.NEGATIVE=3]="NEGATIVE",u_[u_.ABS_GEQ_TWO=4]="ABS_GEQ_TWO",function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"}(d_||(d_={}));var __=function(){function e(){}return e.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},e.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},e.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},e.edgeEval=function(t,n,i){S_(e.vertLeq(t,n)&&e.vertLeq(n,i));var r=n.s-t.s,s=i.s-n.s;return r+s>0?r<s?n.t-t.t+(t.t-i.t)*(r/(r+s)):n.t-i.t+(i.t-t.t)*(s/(r+s)):0},e.edgeSign=function(t,n,i){S_(e.vertLeq(t,n)&&e.vertLeq(n,i));var r=n.s-t.s,s=i.s-n.s;return r+s>0?(n.t-i.t)*r+(n.t-t.t)*s:0},e.transEval=function(t,n,i){S_(e.transLeq(t,n)&&e.transLeq(n,i));var r=n.t-t.t,s=i.t-n.t;return r+s>0?r<s?n.s-t.s+(t.s-i.s)*(r/(r+s)):n.s-i.s+(i.s-t.s)*(s/(r+s)):0},e.transSign=function(t,n,i){S_(e.transLeq(t,n)&&e.transLeq(n,i));var r=n.t-t.t,s=i.t-n.t;return r+s>0?(n.s-i.s)*r+(n.s-t.s)*s:0},e.vertCCW=function(e,t,n){return e.s*(t.t-n.t)+t.s*(n.t-e.t)+n.s*(e.t-t.t)>=0},e.interpolate=function(e,t,n,i){return(e=e<0?0:e)<=(n=n<0?0:n)?0===n?(t+i)/2:t+e/(e+n)*(i-t):i+n/(e+n)*(t-i)},e.intersect=function(t,n,i,r,s){var a,o,l;e.vertLeq(t,n)||(l=t,t=n,n=l),e.vertLeq(i,r)||(l=i,i=r,r=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=n,n=r,r=l),e.vertLeq(i,n)?e.vertLeq(n,r)?((a=e.edgeEval(t,i,n))+(o=e.edgeEval(i,n,r))<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,n.s)):((a=e.edgeSign(t,i,n))+(o=-e.edgeSign(t,r,n))<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,r.s)):s.s=(i.s+n.s)/2,e.transLeq(t,n)||(l=t,t=n,n=l),e.transLeq(i,r)||(l=i,i=r,r=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=n,n=r,r=l),e.transLeq(i,n)?e.transLeq(n,r)?((a=e.transEval(t,i,n))+(o=e.transEval(i,n,r))<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,n.t)):((a=e.transSign(t,i,n))+(o=-e.transSign(t,r,n))<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,r.t)):s.t=(i.t+n.t)/2},e}(),T_=function(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1},P_=function(){function e(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),e}(),M_=function(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0},N_=function(){function e(){var e=new M_,t=new T_,n=new P_(0),i=new P_(1);e.next=e.prev=e,e.anEdge=null,t.next=t.prev=t,n.next=n,n.Sym=i,i.next=i,i.Sym=n,this.vHead=e,this.fHead=t,this.eHead=n,this.eHeadSym=i}return e.prototype.makeEdge_=function(e){var t=new P_(0),n=new P_(1);e.Sym.side<e.side&&(e=e.Sym);var i=e.Sym.next;return n.next=i,i.Sym.next=t,t.next=e,e.Sym.next=n,t.Sym=n,t.Onext=t,t.Lnext=n,t.Org=null,t.Lface=null,t.winding=0,t.activeRegion=null,n.Sym=t,n.Onext=n,n.Lnext=t,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,t},e.prototype.splice_=function(e,t){var n=e.Onext,i=t.Onext;n.Sym.Lnext=t,i.Sym.Lnext=e,e.Onext=i,t.Onext=n},e.prototype.makeVertex_=function(e,t,n){var i=e;S_(i,"Vertex can't be null!");var r=n.prev;i.prev=r,r.next=i,i.next=n,n.prev=i,i.anEdge=t;var s=t;do{s.Org=i,s=s.Onext}while(s!==t)},e.prototype.makeFace_=function(e,t,n){var i=e;S_(i,"Face can't be null");var r=n.prev;i.prev=r,r.next=i,i.next=n,n.prev=i,i.anEdge=t,i.trail=null,i.marked=!1,i.inside=n.inside;var s=t;do{s.Lface=i,s=s.Lnext}while(s!==t)},e.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var t=e.next,n=e.Sym.next;t.Sym.next=n,n.Sym.next=t},e.prototype.killVertex_=function(e,t){var n=e.anEdge,i=n;do{i.Org=t,i=i.Onext}while(i!==n);var r=e.prev,s=e.next;s.prev=r,r.next=s},e.prototype.killFace_=function(e,t){var n=e.anEdge,i=n;do{i.Lface=t,i=i.Lnext}while(i!==n);var r=e.prev,s=e.next;s.prev=r,r.next=s},e.prototype.makeEdge=function(){var e=new M_,t=new M_,n=new T_,i=this.makeEdge_(this.eHead);return this.makeVertex_(e,i,this.vHead),this.makeVertex_(t,i.Sym,this.vHead),this.makeFace_(n,i,this.fHead),i},e.prototype.splice=function(e,t){var n=!1,i=!1;if(e!==t){if(t.Org!==e.Org&&(i=!0,this.killVertex_(t.Org,e.Org)),t.Lface!==e.Lface&&(n=!0,this.killFace_(t.Lface,e.Lface)),this.splice_(t,e),!i){var r=new M_;this.makeVertex_(r,t,e.Org),e.Org.anEdge=e}if(!n){var s=new T_;this.makeFace_(s,t,e.Lface),e.Lface.anEdge=e}}},e.prototype.delete=function(e){var t=e.Sym,n=!1;if(e.Lface!==e.Rface&&(n=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!n){var i=new T_;this.makeFace_(i,e,e.Lface)}t.Onext===t?(this.killVertex_(t.Org,null),this.killFace_(t.Lface,null)):(e.Lface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev)),this.killEdge_(e)},e.prototype.addEdgeVertex=function(e){var t=this.makeEdge_(e),n=t.Sym;this.splice_(t,e.Lnext),t.Org=e.Dst;var i=new M_;return this.makeVertex_(i,n,t.Org),t.Lface=n.Lface=e.Lface,t},e.prototype.splitEdge=function(e){var t=this.addEdgeVertex(e).Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,t),e.Dst=t.Org,t.Dst.anEdge=t.Sym,t.Rface=e.Rface,t.winding=e.winding,t.Sym.winding=e.Sym.winding,t.idx=e.idx,t.Sym.idx=e.Sym.idx,t},e.prototype.connect=function(e,t){var n=!1,i=this.makeEdge_(e),r=i.Sym;if(t.Lface!==e.Lface&&(n=!0,this.killFace_(t.Lface,e.Lface)),this.splice_(i,e.Lnext),this.splice_(r,t),i.Org=e.Dst,r.Org=t.Org,i.Lface=r.Lface=e.Lface,e.Lface.anEdge=r,!n){var s=new T_;this.makeFace_(s,i,e.Lface)}return i},e.prototype.zapFace=function(e){var t,n,i,r,s,a=e.anEdge;n=a.Lnext;do{n=(t=n).Lnext,t.Lface=null,null===t.Rface&&(t.Onext===t?this.killVertex_(t.Org,null):(t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev)),(i=t.Sym).Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),this.killEdge_(t))}while(t!=a);r=e.prev,(s=e.next).prev=r,r.next=s},e.prototype.countFaceVerts_=function(e){var t=e.anEdge,n=0;do{n++,t=t.Lnext}while(t!==e.anEdge);return n},e.prototype.mergeConvexFaces=function(e){var t,n,i,r,s;for(t=this.fHead.next;t!==this.fHead;t=t.next)if(t.inside)for(s=(n=t.anEdge).Org;i=n.Lnext,(r=n.Sym)&&r.Lface&&r.Lface.inside&&(this.countFaceVerts_(t)+this.countFaceVerts_(r.Lface)-2<=e&&__.vertCCW(n.Lprev.Org,n.Org,r.Lnext.Lnext.Org)&&__.vertCCW(r.Lprev.Org,r.Org,n.Lnext.Lnext.Org)&&(i=r.Lnext,this.delete(r),n=null,r=null)),!n||n.Lnext.Org!==s;)n=i;return!0},e.prototype.check=function(){var e,t,n,i,r,s,a=this.fHead,o=this.vHead,l=this.eHead;for(t=a,t=a;(e=t.next)!==a;t=e){S_(e.prev===t),r=e.anEdge;do{S_(r.Sym!==r),S_(r.Sym.Sym===r),S_(r.Lnext.Onext.Sym===r),S_(r.Onext.Sym.Lnext===r),S_(r.Lface===e),r=r.Lnext}while(r!==e.anEdge)}for(S_(e.prev===t&&null===e.anEdge),i=o,i=o;(n=i.next)!==o;i=n){S_(n.prev===i),r=n.anEdge;do{S_(r.Sym!==r),S_(r.Sym.Sym===r),S_(r.Lnext.Onext.Sym===r),S_(r.Onext.Sym.Lnext===r),S_(r.Org===n),r=r.Onext}while(r!==n.anEdge)}for(S_(n.prev===i&&null===n.anEdge),s=l,s=l;(r=s.next)!==l;s=r)S_(r.Sym.next===s.Sym),S_(r.Sym!==r),S_(r.Sym.Sym===r),S_(null!==r.Org),S_(null!==r.Dst),S_(r.Lnext.Onext.Sym===r),S_(r.Onext.Sym.Lnext===r);S_(r.Sym.next===s.Sym&&r.Sym===this.eHeadSym&&r.Sym.Sym===r&&null===r.Org&&null===r.Dst&&null===r.Lface&&null===r.Rface)},e}(),I_=function(){this.handle=null},O_=function(){this.key=null,this.node=0},D_=function(){function e(e,t){this.leq=t,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var n=0;n<e+1;n++)this.nodes[n]=new I_,this.handles[n]=new O_;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(e){var t,n,i,r=this.nodes,s=this.handles;for(t=r[e].handle;;){if((i=e<<1)<this.size&&this.leq(s[r[i+1].handle].key,s[r[i].handle].key)&&++i,S_(i<=this.max),n=r[i].handle,i>this.size||this.leq(s[t].key,s[n].key)){r[e].handle=t,s[t].node=e;break}r[e].handle=n,s[n].node=e,e=i}},e.prototype.floatUp_=function(e){var t,n,i,r=this.nodes,s=this.handles;for(t=r[e].handle;;){if(n=r[i=e>>1].handle,0===i||this.leq(s[n].key,s[t].key)){r[e].handle=t,s[t].node=e;break}r[e].handle=n,s[n].node=e,e=i}},e.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(e){var t,n;if(2*(t=++this.size)>this.max){var i,r;for(this.max*=2,r=this.nodes.length,this.nodes.length=this.max+1,i=r;i<this.nodes.length;i++)this.nodes[i]=new I_;for(r=this.handles.length,this.handles.length=this.max+1,i=r;i<this.handles.length;i++)this.handles[i]=new O_}return 0===this.freeList?n=t:(n=this.freeList,this.freeList=this.handles[n].node),this.nodes[t].handle=n,this.handles[n].node=t,this.handles[n].key=e,this.initialized&&this.floatUp_(t),n},e.prototype.extractMin=function(){var e=this.nodes,t=this.handles,n=e[1].handle,i=t[n].key;return this.size>0&&(e[1].handle=e[this.size].handle,t[e[1].handle].node=1,t[n].key=null,t[n].node=this.freeList,this.freeList=n,--this.size,this.size>0&&this.floatDown_(1)),i},e.prototype.delete=function(e){var t,n=this.nodes,i=this.handles;S_(e>=1&&e<=this.max&&null!==i[e].key),n[t=i[e].node].handle=n[this.size].handle,i[n[t].handle].node=t,--this.size,t<=this.size&&(t<=1||this.leq(i[n[t>>1].handle].key,i[n[t].handle].key)?this.floatDown_(t):this.floatUp_(t)),i[e].key=null,i[e].node=this.freeList,this.freeList=e},e}(),L_=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},R_=function(){this.key=null,this.next=null,this.prev=null},k_=function(){function e(e,t){this.frame=e,this.leq=t,this.head=new R_,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(e){return this.insertBefore(this.head,e)},e.prototype.search=function(e){var t=this.head;do{t=t.next}while(null!==t.key&&!this.leq(this.frame,e,t.key));return t},e.prototype.insertBefore=function(e,t){do{e=e.prev}while(null!==e.key&&!this.leq(this.frame,e.key,t));var n=new R_;return n.key=t,n.next=e.next,e.next.prev=n,n.prev=e,e.next=n,n},e.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},e}(),B_=function(){function e(){}return e.regionBelow=function(e){return e.nodeUp.prev.key},e.regionAbove=function(e){return e.nodeUp.next.key},e.debugEvent=function(e){},e.addWinding=function(e,t){e.winding+=t.winding,e.Sym.winding+=t.Sym.winding},e.edgeLeq=function(e,t,n){var i=e.event,r=t.eUp,s=n.eUp;return r.Dst===i?s.Dst===i?__.vertLeq(r.Org,s.Org)?__.edgeSign(s.Dst,r.Org,s.Org)<=0:__.edgeSign(r.Dst,s.Org,r.Org)>=0:__.edgeSign(s.Dst,i,s.Org)<=0:s.Dst===i?__.edgeSign(r.Dst,i,r.Org)>=0:__.edgeEval(r.Dst,i,r.Org)>=__.edgeEval(s.Dst,i,s.Org)},e.deleteRegion=function(e,t){t.fixUpperEdge&&S_(0===t.eUp.winding),t.eUp.activeRegion=null,e.dict.delete(t.nodeUp)},e.fixUpperEdge=function(e,t,n){S_(t.fixUpperEdge),e.mesh.delete(t.eUp),t.fixUpperEdge=!1,t.eUp=n,n.activeRegion=t},e.topLeftRegion=function(t,n){var i,r=n.eUp.Org;do{n=e.regionAbove(n)}while(n.eUp.Org===r);if(n.fixUpperEdge){if(null===(i=t.mesh.connect(e.regionBelow(n).eUp.Sym,n.eUp.Lnext)))return null;e.fixUpperEdge(t,n,i),n=e.regionAbove(n)}return n},e.topRightRegion=function(t){var n=t.eUp.Dst;do{t=e.regionAbove(t)}while(t.eUp.Dst===n);return t},e.addRegionBelow=function(e,t,n){var i=new L_;return i.eUp=n,i.nodeUp=e.dict.insertBefore(t.nodeUp,i),i.fixUpperEdge=!1,i.sentinel=!1,i.dirty=!1,n.activeRegion=i,i},e.isWindingInside=function(e,t){switch(e.windingRule){case h_.ODD:return 0!==(1&t);case h_.NONZERO:return 0!==t;case h_.POSITIVE:return t>0;case h_.NEGATIVE:return t<0;case h_.ABS_GEQ_TWO:return t>=2||t<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,n){n.windingNumber=e.regionAbove(n).windingNumber+n.eUp.winding,n.inside=e.isWindingInside(t,n.windingNumber)},e.finishRegion=function(t,n){var i=n.eUp,r=i.Lface;r.inside=n.inside,r.anEdge=i,e.deleteRegion(t,n)},e.finishLeftRegions=function(t,n,i){for(var r,s=null,a=n,o=n.eUp;a!==i;){if(a.fixUpperEdge=!1,(r=(s=e.regionBelow(a)).eUp).Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}r=t.mesh.connect(o.Lprev,r.Sym),e.fixUpperEdge(t,s,r)}o.Onext!==r&&(t.mesh.splice(r.Oprev,r),t.mesh.splice(o,r)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,n,i,r,s,a){var o,l,c,h,u=!0;c=i;do{S_(__.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,n,c.Sym),c=c.Onext}while(c!==r);for(null===s&&(s=e.regionBelow(n).eUp.Rprev),l=n,h=s;(c=(o=e.regionBelow(l)).eUp.Sym).Org===h.Org;)c.Onext!==h&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(h.Oprev,c)),o.windingNumber=l.windingNumber-c.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!u&&e.checkForRightSplice(t,l)&&(e.addWinding(c,h),e.deleteRegion(t,l),t.mesh.delete(h)),u=!1,l=o,h=c;l.dirty=!0,S_(l.windingNumber-c.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(e,t,n){e.mesh.splice(t,n)},e.vertexWeights=function(e,t,n){var i=__.vertL1dist(t,e),r=__.vertL1dist(n,e),s=.5*r/(i+r),a=.5*i/(i+r);e.coords[0]+=s*t.coords[0]+a*n.coords[0],e.coords[1]+=s*t.coords[1]+a*n.coords[1],e.coords[2]+=s*t.coords[2]+a*n.coords[2]},e.getIntersectData=function(t,n,i,r,s,a){n.coords[0]=n.coords[1]=n.coords[2]=0,n.idx=-1,e.vertexWeights(n,i,r),e.vertexWeights(n,s,a)},e.checkForRightSplice=function(t,n){var i=e.regionBelow(n),r=n.eUp,s=i.eUp;if(__.vertLeq(r.Org,s.Org)){if(__.edgeSign(s.Dst,r.Org,s.Org)>0)return!1;__.vertEq(r.Org,s.Org)?r.Org!==s.Org&&(t.pq.delete(r.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,r)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(r,s.Oprev),n.dirty=i.dirty=!0)}else{if(__.edgeSign(r.Dst,s.Org,r.Org)<0)return!1;e.regionAbove(n).dirty=n.dirty=!0,t.mesh.splitEdge(r.Sym),t.mesh.splice(s.Oprev,r)}return!0},e.checkForLeftSplice=function(t,n){var i,r=e.regionBelow(n),s=n.eUp,a=r.eUp;if(S_(!__.vertEq(s.Dst,a.Dst)),__.vertLeq(s.Dst,a.Dst)){if(__.edgeSign(s.Dst,a.Dst,s.Org)<0)return!1;e.regionAbove(n).dirty=n.dirty=!0,i=t.mesh.splitEdge(s),t.mesh.splice(a.Sym,i),i.Lface.inside=n.inside}else{if(__.edgeSign(a.Dst,s.Dst,a.Org)>0)return!1;n.dirty=r.dirty=!0,i=t.mesh.splitEdge(a),t.mesh.splice(s.Lnext,a.Sym),i.Rface.inside=n.inside}return!0},e.checkForIntersect=function(t,n){var i,r,s=e.regionBelow(n),a=n.eUp,o=s.eUp,l=a.Org,c=o.Org,h=a.Dst,u=o.Dst,d=new M_;if(S_(!__.vertEq(u,h)),S_(__.edgeSign(h,t.event,l)<=0),S_(__.edgeSign(u,t.event,c)>=0),S_(l!==t.event&&c!==t.event),S_(!n.fixUpperEdge&&!s.fixUpperEdge),l===c||Math.min(l.t,h.t)>Math.max(c.t,u.t))return!1;if(__.vertLeq(l,c)){if(__.edgeSign(u,l,c)>0)return!1}else if(__.edgeSign(h,c,l)<0)return!1;return e.debugEvent(t),__.intersect(h,l,u,c,d),S_(Math.min(l.t,h.t)<=d.t),S_(d.t<=Math.max(c.t,u.t)),S_(Math.min(u.s,h.s)<=d.s),S_(d.s<=Math.max(c.s,l.s)),__.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),i=__.vertLeq(l,c)?l:c,__.vertLeq(i,d)&&(d.s=i.s,d.t=i.t),__.vertEq(d,l)||__.vertEq(d,c)?(e.checkForRightSplice(t,n),!1):!__.vertEq(h,t.event)&&__.edgeSign(h,t.event,d)>=0||!__.vertEq(u,t.event)&&__.edgeSign(u,t.event,d)<=0?u===t.event?(t.mesh.splitEdge(a.Sym),t.mesh.splice(o.Sym,a),n=e.topLeftRegion(t,n),a=e.regionBelow(n).eUp,e.finishLeftRegions(t,e.regionBelow(n),s),e.addRightEdges(t,n,a.Oprev,a,a,!0),!0):h===t.event?(t.mesh.splitEdge(o.Sym),t.mesh.splice(a.Lnext,o.Oprev),s=n,n=e.topRightRegion(n),r=e.regionBelow(n).eUp.Rprev,s.eUp=o.Oprev,o=e.finishLeftRegions(t,s,null),e.addRightEdges(t,n,o.Onext,a.Rprev,r,!0),!0):(__.edgeSign(h,t.event,d)>=0&&(e.regionAbove(n).dirty=n.dirty=!0,t.mesh.splitEdge(a.Sym),a.Org.s=t.event.s,a.Org.t=t.event.t),__.edgeSign(u,t.event,d)<=0&&(n.dirty=s.dirty=!0,t.mesh.splitEdge(o.Sym),o.Org.s=t.event.s,o.Org.t=t.event.t),!1):(t.mesh.splitEdge(a.Sym),t.mesh.splitEdge(o.Sym),t.mesh.splice(o.Oprev,a),a.Org.s=d.s,a.Org.t=d.t,a.Org.pqHandle=t.pq.insert(a.Org),e.getIntersectData(t,a.Org,l,h,c,u),e.regionAbove(n).dirty=n.dirty=s.dirty=!0,!1)},e.walkDirtyRegions=function(t,n){for(var i,r,s=e.regionBelow(n);;){for(;s.dirty;)n=s,s=e.regionBelow(s);if(!n.dirty&&(s=n,null===(n=e.regionAbove(n))||!n.dirty))return;if(n.dirty=!1,i=n.eUp,r=s.eUp,i.Dst!==r.Dst&&e.checkForLeftSplice(t,n)&&(s.fixUpperEdge?(e.deleteRegion(t,s),t.mesh.delete(r),r=(s=e.regionBelow(n)).eUp):n.fixUpperEdge&&(e.deleteRegion(t,n),t.mesh.delete(i),i=(n=e.regionAbove(s)).eUp)),i.Org!==r.Org)if(i.Dst===r.Dst||n.fixUpperEdge||s.fixUpperEdge||i.Dst!==t.event&&r.Dst!==t.event)e.checkForRightSplice(t,n);else if(e.checkForIntersect(t,n))return;i.Org===r.Org&&i.Dst===r.Dst&&(e.addWinding(r,i),e.deleteRegion(t,n),t.mesh.delete(i),n=e.regionAbove(s))}},e.connectRightVertex=function(t,n,i){var r,s=i.Onext,a=e.regionBelow(n),o=n.eUp,l=a.eUp,c=!1;o.Dst!==l.Dst&&e.checkForIntersect(t,n),__.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),n=e.topLeftRegion(t,n),s=e.regionBelow(n).eUp,e.finishLeftRegions(t,e.regionBelow(n),a),c=!0),__.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,a,null),c=!0),c?e.addRightEdges(t,n,i.Onext,s,s,!0):(r=__.vertLeq(l.Org,o.Org)?l.Oprev:o,r=t.mesh.connect(i.Lprev,r),e.addRightEdges(t,n,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,n))},e.connectLeftDegenerate=function(t,n,i){var r,s,a,o,l;return r=n.eUp,__.vertEq(r.Org,i)?(S_(!1),void e.spliceMergeVertices(t,r,i.anEdge)):__.vertEq(r.Dst,i)?(S_(!1),n=e.topRightRegion(n),s=o=(a=(l=e.regionBelow(n)).eUp.Sym).Onext,l.fixUpperEdge&&(S_(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(i.anEdge,a),__.edgeGoesLeft(s)||(s=null),void e.addRightEdges(t,n,a.Onext,o,s,!0)):(t.mesh.splitEdge(r.Sym),n.fixUpperEdge&&(t.mesh.delete(r.Onext),n.fixUpperEdge=!1),t.mesh.splice(i.anEdge,r),void e.sweepEvent(t,i))},e.connectLeftVertex=function(t,n){var i,r,s,a,o,l,c=new L_;if(c.eUp=n.anEdge.Sym,i=t.dict.search(c).key,r=e.regionBelow(i)){if(a=i.eUp,o=r.eUp,0===__.edgeSign(a.Dst,n,a.Org))return void e.connectLeftDegenerate(t,i,n);if(s=__.vertLeq(o.Dst,a.Dst)?i:r,i.inside||s.fixUpperEdge){if(s===i)l=t.mesh.connect(n.anEdge.Sym,a.Lnext);else l=t.mesh.connect(o.Dnext,n.anEdge).Sym;s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,n)}else e.addRightEdges(t,i,n.anEdge,n.anEdge,null,!0)}},e.sweepEvent=function(t,n){t.event=n,e.debugEvent(t);for(var i=n.anEdge;null===i.activeRegion;)if((i=i.Onext)===n.anEdge)return void e.connectLeftVertex(t,n);var r=e.topLeftRegion(t,i.activeRegion);S_(null!==r);var s=e.regionBelow(r),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,r,o):e.addRightEdges(t,r,o.Onext,a,a,!0)},e.addSentinel=function(e,t,n,i){var r=new L_,s=e.mesh.makeEdge();s.Org.s=n,s.Org.t=i,s.Dst.s=t,s.Dst.t=i,e.event=s.Dst,r.eUp=s,r.windingNumber=0,r.inside=!1,r.fixUpperEdge=!1,r.sentinel=!0,r.dirty=!1,r.nodeUp=e.dict.insert(r)},e.initEdgeDict=function(t){t.dict=new k_(t,e.edgeLeq);var n=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],r=t.bmin[0]-n,s=t.bmax[0]+n,a=t.bmin[1]-i,o=t.bmax[1]+i;e.addSentinel(t,r,s,a),e.addSentinel(t,r,s,o)},e.doneEdgeDict=function(t){for(var n,i=0;null!==(n=t.dict.min().key);)n.sentinel||(S_(n.fixUpperEdge),S_(1===++i)),S_(0===n.windingNumber),e.deleteRegion(t,n)},e.removeDegenerateEdges=function(t){var n,i,r,s=t.mesh.eHead;for(n=s.next;n!==s;n=i)i=n.next,r=n.Lnext,__.vertEq(n.Org,n.Dst)&&n.Lnext.Lnext!==n&&(e.spliceMergeVertices(t,r,n),t.mesh.delete(n),r=(n=r).Lnext),r.Lnext===n&&(r!==n&&((r===i||r===i.Sym)&&(i=i.next),t.mesh.delete(r)),(n===i||n===i.Sym)&&(i=i.next),t.mesh.delete(n))},e.initPriorityQ=function(e){var t,n,i,r=0;for(n=(i=e.mesh.vHead).next;n!==i;n=n.next)r++;for(r+=8,t=e.pq=new D_(r,__.vertLeq),n=(i=e.mesh.vHead).next;n!==i;n=n.next)n.pqHandle=t.insert(n);return n===i&&(t.init(),!0)},e.donePriorityQ=function(e){e.pq=null},e.removeDegenerateFaces=function(t,n){var i,r,s;for(i=n.fHead.next;i!==n.fHead;i=r)r=i.next,S_((s=i.anEdge).Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,n){var i,r;if(void 0===n&&(n=!0),e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);null!==(i=t.pq.extractMin());){for(;null!==(r=t.pq.min())&&__.vertEq(r,i);)r=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,r.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),!!e.removeDegenerateFaces(t,t.mesh)&&(n&&t.mesh.check(),!0)},e}(),U_=function(){function e(){this.mesh=new N_,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=h_.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.prototype.normalize_=function(e){var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!t)throw"Zero-size vector!";t=Math.sqrt(t),e[0]/=t,e[1]/=t,e[2]/=t},e.prototype.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},e.prototype.computeNormal_=function(e){var t,n,i,r,s,a,o=[0,0,0],l=[0,0,0],c=[0,0,0],h=[0,0,0],u=[0,0,0],d=[null,null,null],p=[null,null,null],f=this.mesh.vHead;t=f.next;for(var m=0;m<3;++m)r=t.coords[m],l[m]=r,p[m]=t,o[m]=r,d[m]=t;for(t=f.next;t!==f;t=t.next)for(var g=0;g<3;++g)(r=t.coords[g])<l[g]&&(l[g]=r,p[g]=t),r>o[g]&&(o[g]=r,d[g]=t);var v=0;if(o[1]-l[1]>o[0]-l[0]&&(v=1),o[2]-l[2]>o[v]-l[v]&&(v=2),l[v]>=o[v])return e[0]=0,e[1]=0,void(e[2]=1);for(a=0,n=p[v],i=d[v],c[0]=n.coords[0]-i.coords[0],c[1]=n.coords[1]-i.coords[1],c[2]=n.coords[2]-i.coords[2],t=f.next;t!==f;t=t.next)h[0]=t.coords[0]-i.coords[0],h[1]=t.coords[1]-i.coords[1],h[2]=t.coords[2]-i.coords[2],u[0]=c[1]*h[2]-c[2]*h[1],u[1]=c[2]*h[0]-c[0]*h[2],u[2]=c[0]*h[1]-c[1]*h[0],(s=u[0]*u[0]+u[1]*u[1]+u[2]*u[2])>a&&(a=s,e[0]=u[0],e[1]=u[1],e[2]=u[2]);a<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(c)]=1)},e.prototype.checkOrientation_=function(){for(var e,t,n=this.mesh.fHead,i=this.mesh.vHead,r=0,s=n.next;s!==n;s=s.next)if(!((t=s.anEdge).winding<=0))do{r+=(t.Org.s-t.Dst.s)*(t.Org.t+t.Dst.t),t=t.Lnext}while(t!==s.anEdge);if(r<0){for(e=i.next;e!==i;e=e.next)e.t=-e.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var e,t,n=this.mesh.vHead,i=[0,0,0],r=!1;i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],!i[0]&&!i[1]&&!i[2]&&(this.computeNormal_(i),r=!0),e=this.sUnit,t=this.tUnit;var s=this.longAxis_(i);e[s]=0,e[(s+1)%3]=1,e[(s+2)%3]=0,t[s]=0,t[(s+1)%3]=0,t[(s+2)%3]=i[s]>0?1:-1;for(var a=n.next;a!==n;a=a.next)a.s=this.dot_(a.coords,e),a.t=this.dot_(a.coords,t);r&&this.checkOrientation_();for(var o=!0,l=n.next;l!==n;l=l.next)o?(this.bmin[0]=this.bmax[0]=l.s,this.bmin[1]=this.bmax[1]=l.t,o=!1):(l.s<this.bmin[0]&&(this.bmin[0]=l.s),l.s>this.bmax[0]&&(this.bmax[0]=l.s),l.t<this.bmin[1]&&(this.bmin[1]=l.t),l.t>this.bmax[1]&&(this.bmax[1]=l.t))},e.prototype.addWinding_=function(e,t){e.winding+=t.winding,e.Sym.winding+=t.Sym.winding},e.prototype.tessellateMonoRegion_=function(e,t){var n,i;if((n=t.anEdge).Lnext===n||n.Lnext.Lnext===n)throw"Mono region invalid";for(;__.vertLeq(n.Dst,n.Org);n=n.Lprev);for(;__.vertLeq(n.Org,n.Dst);n=n.Lnext);i=n.Lprev;for(;n.Lnext!==i;)if(__.vertLeq(n.Dst,i.Org)){for(;i.Lnext!==n&&(__.edgeGoesLeft(i.Lnext)||__.edgeSign(i.Org,i.Dst,i.Lnext.Dst)<=0);)i=e.connect(i.Lnext,i).Sym;i=i.Lprev}else{for(;i.Lnext!==n&&(__.edgeGoesRight(n.Lprev)||__.edgeSign(n.Dst,n.Org,n.Lprev.Org)>=0);)n=e.connect(n,n.Lprev).Sym;n=n.Lnext}if(i.Lnext===n)throw"Mono region invalid";for(;i.Lnext.Lnext!==n;)i=e.connect(i.Lnext,i).Sym;return!0},e.prototype.tessellateInterior_=function(e){for(var t,n=e.fHead.next;n!==e.fHead;n=t)if(t=n.next,n.inside&&!this.tessellateMonoRegion_(e,n))return!1;return!0},e.prototype.discardExterior_=function(e){for(var t,n=e.fHead.next;n!==e.fHead;n=t)t=n.next,n.inside||e.zapFace(n)},e.prototype.setWindingNumber_=function(e,t,n){for(var i,r=e.eHead.next;r!==e.eHead;r=i)i=r.next,r.Rface.inside!==r.Lface.inside?r.winding=r.Lface.inside?t:-t:n?e.delete(r):r.winding=0},e.prototype.getNeighbourFace_=function(e){return e.Rface&&e.Rface.inside?e.Rface.n:-1},e.prototype.outputPolymesh_=function(e,t,n,i){var r,s,a=0,o=0;n>3&&e.mergeConvexFaces(n);for(var l=e.vHead.next;l!==e.vHead;l=l.next)l.n=-1;for(var c=e.fHead.next;c!==e.fHead;c=c.next)if(c.n=-1,c.inside){r=c.anEdge,s=0;do{-1===(l=r.Org).n&&(l.n=o,o++),s++,r=r.Lnext}while(r!==c.anEdge);if(s>n)throw"Face vertex greater that support polygon";c.n=a,++a}this.elementCount=a,t===d_.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*n,this.vertexCount=o,this.vertices=[],this.vertices.length=o*i,this.vertexIndices=[],this.vertexIndices.length=o;for(l=e.vHead.next;l!==e.vHead;l=l.next)if(-1!==l.n){var h=l.n*i;this.vertices[h+0]=l.coords[0],this.vertices[h+1]=l.coords[1],i>2&&(this.vertices[h+2]=l.coords[2]),this.vertexIndices[l.n]=l.idx}var u=0;for(c=e.fHead.next;c!==e.fHead;c=c.next)if(c.inside){r=c.anEdge,s=0;do{l=r.Org;this.elements[u++]=l.n,s++,r=r.Lnext}while(r!==c.anEdge);for(var d=s;d<n;++d)this.elements[u++]=-1;if(t===d_.CONNECTED_POLYGONS){r=c.anEdge;do{this.elements[u++]=this.getNeighbourFace_(r),r=r.Lnext}while(r!==c.anEdge);for(var p=s;p<n;++p)this.elements[u++]=-1}}},e.prototype.outputContours_=function(e,t){var n,i,r=0,s=0;this.vertexCount=0,this.elementCount=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){i=n=a.anEdge;do{this.vertexCount++,n=n.Lnext}while(n!==i);this.elementCount++}this.elements=[],this.elements.length=2*this.elementCount,this.vertices=[],this.vertices.length=this.vertexCount*t,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var o=0,l=0,c=0;r=0;for(a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){s=0,i=n=a.anEdge;do{this.vertices[o++]=n.Org.coords[0],this.vertices[o++]=n.Org.coords[1],t>2&&(this.vertices[o++]=n.Org.coords[2]),this.vertexIndices[l++]=this.vertexIdCallback?this.vertexIdCallback(n):n.Org.idx,s++,n=n.Lnext}while(n!==i);this.elements[c++]=r,this.elements[c++]=s,r+=s}},e.prototype.addContour=function(e,t){null===this.mesh&&(this.mesh=new N_),e<2&&(e=2),e>3&&(e=3);for(var n=null,i=0;i<t.length;i+=e)null===n?(n=this.mesh.makeEdge(),this.mesh.splice(n,n.Sym)):(this.mesh.splitEdge(n),n=n.Lnext),n.Org.coords[0]=t[i+0],n.Org.coords[1]=t[i+1],n.Org.coords[2]=e>2?t[i+2]:0,n.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(n),n.winding=1,n.Sym.winding=-1},e.prototype.tesselate=function(e,t,n,i,r,s){if(void 0===e&&(e=h_.ODD),void 0===t&&(t=d_.POLYGONS),void 0===s&&(s=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,r&&(this.normal[0]=r[0],this.normal[1]=r[1],this.normal[2]=r[2]),this.windingRule=e,i<2&&(i=2),i>3&&(i=3),!this.mesh)return!1;this.projectPolygon_(),B_.computeInterior(this,s);var a=this.mesh;return t===d_.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),s&&a.check(),t===d_.BOUNDARY_CONTOURS?this.outputContours_(a,i):this.outputPolymesh_(a,t,n,i),!0},e}();function z_(e){var t=e.windingRule,n=void 0===t?h_.ODD:t,i=e.elementType,r=void 0===i?d_.POLYGONS:i,s=e.polySize,a=void 0===s?3:s,o=e.vertexSize,l=void 0===o?2:o,c=e.normal,h=void 0===c?[0,0,1]:c,u=e.contours,d=void 0===u?[]:u,p=e.strict,f=void 0===p||p,m=e.debug,g=void 0!==m&&m;if(!d&&f)throw new Error("Contours can't be empty");if(d){var v=new U_;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<d.length;y++)v.addContour(l||2,d[y]);return v.tesselate(n,r,a,l,h,f),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}h_.ODD,h_.NONZERO,h_.POSITIVE,h_.NEGATIVE,h_.ABS_GEQ_TWO,d_.POLYGONS,d_.CONNECTED_POLYGONS,d_.BOUNDARY_CONTOURS;var F_=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let n=e*F_.eSize;this.buffer=new ArrayBuffer(n);let i=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*i,3*e),r+=3*e,this.normals=new Float32Array(this.buffer,r*i,3*e),r+=3*e,this.uvs=new Float32Array(this.buffer,r*i,2*e)}realloc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} \u2192 ${e}`);let n=e*F_.eSize,i=new ArrayBuffer(n),r=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(i,s*r,3*e);s+=3*e;let o=new Float32Array(i,s*r,3*e);s+=3*e;let l=new Float32Array(i,s*r,2*e);t?(a.set(this.positions.subarray(0,3*this.size)),o.set(this.normals.subarray(0,3*this.size)),l.set(this.uvs.subarray(0,2*this.size))):(a.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=i,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.size+e;if(t>this.capacity){let e=this.capacity;for(;t>e;)e*=2;this.realloc(e)}let n=this.size;return this.size=t,n}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} \u2192 ${this.size}`),this.realloc(this.size,!0)}},j_=F_;j_.eSize=8*Float32Array.BYTES_PER_ELEMENT;var V_=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>e<t?-1:e>t?1:0;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;let e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:n}=this,i=t[e];for(;e>0;){let r=e-1>>1,s=t[r];if(n(i,s)>=0)break;t[e]=s,e=r}t[e]=i}_down(e){let{data:t,compare:n}=this,i=this.length>>1,r=t[e];for(;e<i;){let i=1+(e<<1),s=i+1;if(s<this.length&&n(t[s],t[i])<0&&(i=s),n(t[i],r)>=0)break;t[e]=t[i],e=i}t[e]=r}};function H_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1/0,s=1/0,a=-1/0,o=-1/0;for(let[y,b]of e[0])y<r&&(r=y),b<s&&(s=b),y>a&&(a=y),b>o&&(o=b);let l=a-r,c=o-s,h=Math.max(n,Math.min(l,c));if(h===n){let e=[r,s];return e.distance=0,e.distance}let u=new V_([],((e,t)=>t.max-e.max)),d=function(e){let t=0,n=0,i=0,r=e[0];for(let a=0,o=r.length,l=o-1;a<o;l=a++){let e=r[a],s=r[l],o=e[0]*s[1]-s[0]*e[1];n+=(e[0]+s[0])*o,i+=(e[1]+s[1])*o,t+=3*o}let s=new W_(n/t,i/t,0,e);return 0===t||s.d<0?new W_(r[0][0],r[0][1],0,e):s}(e),p=new W_(r+l/2,s+c/2,0,e);p.d>d.d&&(d=p);let f=2;function m(r,s,a){let o=new W_(r,s,a,e);if(f++,o.max>d.d+n&&u.push(o),o.d>d.d&&(d=o,i&&console.log(`found best ${Math.round(1e4*o.d)/1e4} after ${f} probes`),d.d>t))return t}let g=h/2;for(let y=r;y<a;y+=h)for(let e=s;e<o;e+=h)m(y+g,e+g,g);for(;u.length;){let{max:e,x:t,y:i,h:r}=u.pop();if(e-d.d<=n)break;g=r/2,m(t-g,i-g,g),m(t+g,i-g,g),m(t-g,i+g,g),m(t+g,i+g,g)}i&&console.log(`num probes: ${f}\nbest distance: ${d.d}`);let v=[d.x,d.y];return v.distance=d.d,v.distance}function W_(e,t,n,i){this.x=e,this.y=t,this.h=n,this.d=function(e,t,n){let i=!1,r=1/0;for(let s of n)for(let n=0,a=s.length,o=a-1;n<a;o=n++){let a=s[n],l=s[o];a[1]>t!=l[1]>t&&e<(l[0]-a[0])*(t-a[1])/(l[1]-a[1])+a[0]&&(i=!i),r=Math.min(r,G_(e,t,a,l))}return 0===r?0:(i?1:-1)*Math.sqrt(r)}(e,t,i),this.max=this.d+this.h*Math.SQRT2}function G_(e,t,n,i){let r=n[0],s=n[1],a=i[0]-r,o=i[1]-s;if(0!==a||0!==o){let n=((e-r)*a+(t-s)*o)/(a*a+o*o);n>1?(r=i[0],s=i[1]):n>0&&(r+=a*n,s+=o*n)}return a=e-r,o=t-s,a*a+o*o}var q_={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},K_={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},Y_={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},Q_=(e,t)=>n=>{let[i,r]=n;return r<i&&(r+=t),(e>=i?e:e+t)<=r},X_=class extends gs{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:h_.ODD,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(),this.forPathBevel=a,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=i,this._bevelSegmentsInput=r;let o,l,c,h=this._shape.extractShapePointsToFlatArray([],i),u=this._shape.shapeHoles.map((e=>{let t=e.extractShapePointsToFlatArray([],i),n=[];for(let i=t.length-1;i>=1;i-=2){let e=t[i-1],r=t[i-0];n.push(e,r)}return n})),d=[],p=[];for(let S=0;S<h.length;S+=2)p.push([h[S],h[S+1]]);d.push(p);for(let S=0;S<u.length;S++){let e=u[S],t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);d.push(t)}o=e.isText?.1*(new Su).setFromPoints(e.points.map((e=>e.position))).getSize(new di).length():0===d[0].length?n:n>0?H_(d,n):1e-5,n<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(n,o,t/2),this._bevelSegments=Math.floor(r));try{l=z_({windingRule:s,elementType:d_.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[h]})}catch{l=q_}try{c=z_({windingRule:h_.ODD,elementType:d_.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...u]})}catch{c=K_}if(!l)throw new Error("error generating geometry");let f=l.elementCount;if(c){l.elementCount+=c.elementCount;for(let e=0;e<c.elements.length;e++){let t=c.elements[e],n=e%2===0?l.vertexCount:0;l.elements.push(t+n)}for(let e=0;e<c.vertexIndices.length;e++){let t=c.vertexIndices[e],n=l.vertexCount;l.vertexIndices.push(t+n)}for(let e=0;e<c.vertices.length;e++){let t=c.vertices[e];l.vertices.push(t)}}let m=1/0,g=-1/0,v=1/0,y=-1/0;for(let S=0,_=l.vertexCount;S<_;S++){let e=2*S,t=l.vertices[e+0],n=l.vertices[e+1];t<m&&(m=t),t>g&&(g=t),n<v&&(v=n),n>y&&(y=n)}this._minX=m,this._minY=v,this._width=g-m,this._height=y-v,this._buffer=new j_(this._computeBufferEstimatedSize(l));let b=[],w=[];for(let S=l.elementCount-1;S>=0;S--){let e=S>=f,t=2*S,n=l.elements[t+0],r=l.elements[t+1],s=n+r,c={start:n,count:r,normals:[],continuous:[],concave:[]},h=n,d=s-1,p=n+1,m=this._shape.roundedCurves.length;do{let t=h-n,i=l.vertices[2*d+0],a=l.vertices[2*d+1],o=l.vertices[2*h+0],u=l.vertices[2*h+1],f=l.vertices[2*p+0],g=l.vertices[2*p+1],v=o-i,y=u-a,b=Math.sqrt(v*v+y*y);v/=b,y/=b;let w=o-f,x=u-g,E=Math.sqrt(w*w+x*x);w/=E,x/=E,c.normals[2*t+0]=-x,c.normals[2*t+1]=w,c.concave[t]=v*x-y*w>0;let C=l.vertexIndices[h];if(Array.isArray(C))c.continuous[t]=!1;else{let[e,n]=this._shape.getCurveIndexFromVertexId(C-1,!0);if(n>0&&n<1)c.continuous[t]=!0;else{let i=1===n?e+1:e-1;i=(i+m)%m;let r=1===n?0:1,s=this._shape.roundedCurves[e].getTangent(n),a=this._shape.roundedCurves[i].getTangent(r);c.continuous[t]=s.dot(a)>.95}}e&&(c.normals[2*t+0]*=-1,c.normals[2*t+1]*=-1),[d,h,p]=[h,p,p+1],p>=s&&(p-=r)}while(p!==n+1);let g=[];g.push({bevelI:0,angle:0,size:0,boundary:{vertices:l.vertices.slice(2*n,2*s),vertexCount:r,vertexIndices:new Array(r).fill(!0).map(((e,t)=>[t,t])),elements:[0,r],elementCount:1,mesh:null},reverseMap:[],insetPoints:l.vertices.slice(2*n,2*s)});let v=0;for(let a=1;a<=this._bevelSegments;a++){let t=a/this._bevelSegments*Math.PI/2,n=(1-Math.cos(t))*this._bevel,s=[],o=[],h=[],u=[],d=0;for(let a=0;a<r;a++){let t=2*a,p=(a-1+r)%r*2,f=l.vertices[2*c.start+t+0],m=l.vertices[2*c.start+t+1],g=-c.normals[p+0]*n,v=-c.normals[p+1]*n,y=-c.normals[t+0]*n,b=-c.normals[t+1]*n;if(c.concave[a]||!c.concave[a]&&e){let t=Math.atan2(v,g),r=Math.atan2(b,y);r>t&&(r-=2*Math.PI);let o=r-t;if(c.continuous[a]||e){let i=t+o/2,r=Math.cos(i)*n,l=Math.sin(i)*n;s[2*d+0]=f+r*(e?-1:1),s[2*d+1]=m+l*(e?-1:1),u[d]=a,d++}else{let e=Math.max(1,Math.floor(i/4*Math.abs(o)/Math.PI));for(let i=0;i<=e;i++){let r=t+o*(i/e),l=Math.cos(r)*n,c=Math.sin(r)*n;s[2*d+0]=f+l,s[2*d+1]=m+c,u[d]=a,d++}}}else s[2*d+0]=f+g,s[2*d+1]=m+v,u[d]=a,o[a]=d,d++,s[2*d+0]=f,s[2*d+1]=m,u[d]=a,d++,s[2*d+0]=f+y,s[2*d+1]=m+b,u[d]=a,h[a]=d,d++}let p=z_({windingRule:h_.POSITIVE,elementType:d_.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[s],edgeCreateCallback:e=>{let t=e.Org.idx,n=u[t],i=u[(t+1)%u.length];e.idx=[n,i],e.Sym.idx=[i,n]},vertexIdCallback:e=>{let t=e.Lprev.idx;return[t?t[1]:0,e.idx?e.idx[0]:0]}});if(!p)throw console.log("Error"),new Error(`error generating bevel geometry for ${a}'th loop`);if(!p.vertexCount){let e=(a-1)/this._bevelSegments*Math.PI/2;v=(1-Math.sin(e))*this._bevel;break}for(let e=0;e<p.vertexIndices.length;e++){let[t,n]=p.vertexIndices[e];if(t===n)continue;let i=n;n<t&&(i+=r);for(let s=t;s<i;s++){let i=s%r,a=(s+1)%r;if(!c.continuous[i]||!c.continuous[a]){p.vertexIndices[e]=[t,i],p.vertexIndices.splice(e+1,0,[a,n]),p.vertices.splice(2*(e+1),0,p.vertices[2*e],p.vertices[2*e+1]);break}}}g.push({bevelI:a,angle:t,size:n,boundary:p,reverseMap:u,insetPoints:s})}let y=(e,t,n)=>{let i=0,r=e.boundary.vertexIndices.length;for(;i<r&&n(e.boundary.vertexIndices[t]);)t=(t+1)%r,i++;return i},x=b.length;for(let i=1;i<g.length;i++){let e=g[i-1],t=g[i],n=e.boundary.vertexIndices.length,s=t.boundary.vertexIndices.length;if(!n||!s)break;let o=c.concave.length,l=0,h=Q_(l,r);for(;!e.boundary.vertexIndices.filter(h).length||!t.boundary.vertexIndices.filter(h).length;)l++,h=Q_(l,r);let u=e.boundary.vertexIndices.findIndex(h),d=t.boundary.vertexIndices.findIndex(h);do{u=(u+1)%n}while(h(e.boundary.vertexIndices[u]));do{d=(d+1)%s}while(h(t.boundary.vertexIndices[d]));l=(l+1)%r;let p,f,m=l,v=0,w=this._buildBevelVert(c,e,(u-1+n)%n,void 0,v),x=this._buildBevelVert(c,t,(d-1+s)%s,void 0,v),E=!1;do{v=(l||o)/o,h=Q_(l,r);let i=y(e,u,h),m=y(t,d,h),g=E;if(E=!1,i&&!m){for(let t=0;t<i;t++)p=this._buildBevelVert(c,e,(u+t)%n,t/(i-1),v),b.push(w.topN,p.topP,x.topN),!1===a&&b.push(p.bottomP,w.bottomN,x.bottomN),w=p;E=!0}else if(!i&&m)for(let e=0;e<m;e++)f=this._buildBevelVert(c,t,(d+e)%s,e/(m-1),v),b.push(x.topN,w.topP,f.topP),!1===a&&b.push(w.bottomP,x.bottomN,f.bottomP),x=f;else if(i&&m)if(p=this._buildBevelVert(c,e,u,0,v),f=this._buildBevelVert(c,t,d,0,v),g?(b.push(w.topN,f.topP,x.topN),b.push(w.topN,p.topP,f.topP),!1===a&&(b.push(f.bottomP,w.bottomN,x.bottomN),b.push(f.bottomP,p.bottomP,w.bottomN))):(b.push(x.topN,w.topN,p.topP),b.push(x.topN,p.topP,f.topP),!1===a&&(b.push(p.bottomP,w.bottomN,x.bottomN),b.push(p.bottomP,x.bottomN,f.bottomP))),w=p,x=f,i===m)for(let r=1;r<i;r++)p=this._buildBevelVert(c,e,(u+r)%n,r/(i-1),v),f=this._buildBevelVert(c,t,(d+r)%s,r/(m-1),v),b.push(w.topN,p.topP,x.topN),b.push(x.topN,p.topP,f.topP),!1===a&&(b.push(p.bottomP,w.bottomN,x.bottomN),b.push(p.bottomP,x.bottomN,f.bottomP)),w=p,x=f;else if(i>m){let r=i/m,o=0;for(let l=1;l<i;l++)p=this._buildBevelVert(c,e,(u+l)%n,l/(i-1),v),b.push(w.topN,p.topP,x.topN),!1===a&&b.push(p.bottomP,w.bottomN,x.bottomN),w=p,l>(o+1)*r&&(o++,f=this._buildBevelVert(c,t,(d+o)%s,o/(m-1),v),b.push(x.topN,p.topP,f.topP),!1===a&&b.push(p.bottomP,x.bottomN,f.bottomP),x=f)}else{let r=m/i,o=0;for(let l=1;l<m;l++)f=this._buildBevelVert(c,t,(d+l)%s,l/(m-1),v),b.push(x.topN,p.topP,f.topP),!1===a&&b.push(p.bottomP,x.bottomN,f.bottomP),x=f,l>(o+1)*r&&(o++,p=this._buildBevelVert(c,e,(u+o)%n,o/(i-1),v),b.push(w.topN,p.topP,x.topN),!1===a&&b.push(p.bottomP,w.bottomN,x.bottomN),w=p)}u=(u+i)%n,d=(d+m)%s,l=(l+1)%o}while(l!==m)}if(!1===a&&this._depth>2*this._bevel&&this._buildWall(g,c,b),e){let e=[];for(let t=b.length-1;t>=x+2;t-=3){let n=b[t-2],i=b[t-1],r=b[t-0];e.push(r,i,n)}b.splice(x,b.length-x,...e)}if(e){let e=[];for(let t=g[g.length-1].boundary.vertices.length-1;t>=1;t-=2){let n=g[g.length-1].boundary.vertices[t-1],i=g[g.length-1].boundary.vertices[t-0];e.push(n,i)}w.push(e)}if(!e){let e,t=g[g.length-1];try{e=z_({windingRule:g.length>1?h_.POSITIVE:h_.ODD,elementType:d_.POLYGONS,vertexSize:2,strict:!0,contours:[t.insetPoints,...w]})}catch{e=Y_}if(!e)throw new Error("Error generating geometry for surface");0===u.length&&this._bevel<o&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let n=0;n<3*e.elementCount;n+=3){let t=this._buildSurfaceVert(e,e.elements[n+0],v),i=this._buildSurfaceVert(e,e.elements[n+1],v),r=this._buildSurfaceVert(e,e.elements[n+2],v);b.push(t.top,i.top,r.top),!1===a&&b.push(r.bottom,i.bottom,t.bottom)}}this.vertexCache={}}this._buffer.shrink();let x=new ss(Uint32Array.from(b),1),E=new ss(this._buffer.positions,3),C=new ss(this._buffer.normals,3),A=new ss(this._buffer.uvs,2);E.needsUpdate=!0,C.needsUpdate=!0,A.needsUpdate=!0,x.needsUpdate=!0,this.setAttribute("position",E),this.setAttribute("normal",C),this.setAttribute("uv",A),this.setIndex(x)}_computeBufferEstimatedSize(e){return 2*e.vertexCount*(2+this._bevelSegments)}_buildWall(e,t,n){let i=e[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let e=this._buildBevelVert(t,i,r),a=this._buildBevelVert(t,i,(r+1)%s);n.push(a.topP,e.topN,e.bottomN),n.push(a.topP,e.bottomN,a.bottomP)}}_buildSurfaceVert(e,t,n){let i=t.toString();if(i in this.vertexCache)return this.vertexCache[i];let r=e.vertices[2*t+0],s=e.vertices[2*t+1],a=(r-this._minX)/this._width,o=(s-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),c=3*l,h=2*l,u={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=r,this._buffer.positions[c+1]=s,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-n,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[h+0]=a,this._buffer.uvs[h+1]=o,!1===this.forPathBevel&&(this._buffer.positions[c+3]=r,this._buffer.positions[c+4]=s,this._buffer.positions[c+5]=n,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[h+2]=a,this._buffer.uvs[h+3]=o),this.vertexCache[i]=u,u}_buildBevelVert(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4?arguments[4]:void 0,s=`${t.bevelI}:${n}`;if(s in this.vertexCache&&0!==r&&1!==r&&(!r||r===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let a,o,l,c,[h,u]=t.boundary.vertexIndices[n];h!==u?(o=h,a=u,c=!1,l=e.continuous[o]&&e.continuous[a]):(a=h,o=(a-1+e.count)%e.count,c=e.concave[a]&&t.bevelI>0,l=e.continuous[a]||c);let d=Math.cos(t.angle),p=Math.sin(t.angle),f=2*n,m=2*a,g=2*o,v=t.boundary.vertices[f+0],y=t.boundary.vertices[f+1],b=(1-p)*this._bevel,w=(v-this._minX)/this._width,x=(y-this._minY)/this._height;this.forPathBevel&&(void 0!==r&&(w=r),x=1);let E=e.normals[m+0],C=e.normals[m+1],A=e.normals[g+0],S=e.normals[g+1];if(c){E+=(A-E)*(1-i),C+=(S-C)*(1-i);let e=Math.sqrt(E*E+C*C);E/=e,C/=e}let _=this.forPathBevel?this._buffer.get(l?1:2):this._buffer.get(l?2:4),T=3*_,P=2*_,M={i:n,fi:a,topP:_+0,topN:_+0,bottomP:_+1,bottomN:_+1,pathBevelUCoord:r};return this._buffer.positions[T+0]=v,this._buffer.positions[T+1]=y,this._buffer.positions[T+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[T+0]=E*d,this._buffer.normals[T+1]=C*d,this._buffer.normals[T+2]=p,this._buffer.uvs[P+0]=w,this._buffer.uvs[P+1]=x,!1===this.forPathBevel&&(this._buffer.positions[T+3]=v,this._buffer.positions[T+4]=y,this._buffer.positions[T+5]=b,this._buffer.normals[T+3]=E*d,this._buffer.normals[T+4]=C*d,this._buffer.normals[T+5]=-p,this._buffer.uvs[P+2]=x,this._buffer.uvs[P+3]=w),l||(this.forPathBevel?(_+=1,T+=3,P+=2):(_+=2,T+=6,P+=4),M.topP=_+0,M.bottomP=_+1,this._buffer.positions[T+0]=v,this._buffer.positions[T+1]=y,this._buffer.positions[T+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[T+0]=A*d,this._buffer.normals[T+1]=S*d,this._buffer.normals[T+2]=p,this._buffer.uvs[P+0]=w,this._buffer.uvs[P+1]=x,!1===this.forPathBevel&&(this._buffer.positions[T+3]=v,this._buffer.positions[T+4]=y,this._buffer.positions[T+5]=b,this._buffer.normals[T+3]=A*d,this._buffer.normals[T+4]=S*d,this._buffer.normals[T+5]=-p,this._buffer.uvs[P+2]=x,this._buffer.uvs[P+3]=w)),this.vertexCache[s]=M,M}clone(){let e=new X_(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=Vg(this.userData),e}},Z_=class extends gs{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.type="ShapeGeometry",this.windingRule=h_.ODD,this.elementType=d_.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:h_.ODD,elementType:d_.POLYGONS,polySize:3,vertexSize:2,strict:!0},n);let i,r,s,a=this._shape.extractShapePointsToFlatArray([],this._curveSegments),o=this._shape.shapeHoles.map((e=>e.extractShapePointsToFlatArray([],this._curveSegments))),l=!0,c=!0;for(let d=0,p=a.length/2;d<p;d++){let e=2*d,t=a[e+0],n=a[e+1];if(void 0!==r&&t!==r&&(l=!1),void 0!==s&&n!==s&&(c=!1),r=t,s=n,!l&&!c)break}if(!l&&!c)try{i=z_({contours:[a,...o],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{i=q_}let h=i?.vertexCount??1,u=i?.elementCount??1;if(this._positionAttribute=new ss(new Float32Array(3*h),3),this._normalAttribute=new ss(new Float32Array(3*h),3),this._uvAttribute=new ss(new Float32Array(2*h),2),this._indexAttribute=new ss(new Uint32Array(3*u),1),i){let e=1/0,t=-1/0,n=1/0,r=-1/0;for(let o=0,l=h;o<l;o++){let s=2*o,a=i.vertices[s+0],l=i.vertices[s+1];a<e&&(e=a),a>t&&(t=a),l<n&&(n=l),l>r&&(r=l)}let s=t-e,a=r-n;for(let o=0,l=h;o<l;o++){let t=2*o,r=i.vertices[t+0],l=i.vertices[t+1],c=(r-e)/s,h=(l-n)/a;this._positionAttribute.setXYZ(o,r,l,0),this._normalAttribute.setXYZ(o,0,0,1),this._uvAttribute.setXY(o,c,h)}for(let o=0,l=u;o<l;o++){let e=3*o,t=i.elements[e+0],n=i.elements[e+1],r=i.elements[e+2];this._indexAttribute.setX(e+0,t),this._indexAttribute.setX(e+1,n),this._indexAttribute.setX(e+2,r)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,3*(i?.elementCount??1))}clone(){let e=new Z_(this._shape,this._curveSegments);return e.userData=Vg(this.userData),e}},J_=class extends X_{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,arguments.length>5&&void 0!==arguments[5]?arguments[5]:h_.ODD),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return 2*e.vertexCount*(2+this._bevelSegments)}_buildWall(e,t,n){let i=e[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let e=this._buildBevelVert(t,i,r),a=this._buildBevelVert(t,i,(r+1)%s);n.push(a.topP,e.topN,e.bottomN),n.push(a.topP,e.bottomN,a.bottomP)}}clone(){let e=new J_(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=Vg(this.userData),e}},$_=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:h_.ODD},e.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.abs(n.depth??0),a=e.shape??t?.shape,o=a?.roundness??n.roundness;void 0!==a&&(a instanceof b_?(a.width!==i||a.height!==r)&&a.applySize(i,r):a=new b_(i,r).fromJSON(a),void 0!==e.parameters?.roundness&&e.parameters?.roundness>0&&a.update());let l=a??new b_(i,r);return{parameters:Object.assign(n,{width:i,height:r,depth:s,roundness:o}),shape:l}}static build(e){let t,{depth:n,extrudeBevelSize:i,extrudeBevelSegments:r,subdivisions:s,roundness:a,windingRule:o}=e.parameters;return e.shape.roundness=a,t=n<=0?new Z_(e.shape,s,{windingRule:o}):new J_(e.shape,n,i,s,r,o),Object.assign(t,{userData:{...e,type:"VectorGeometry"}})}},eT=2*Math.PI,tT=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return n.angle=ui.clamp(n.angle,0,360),{shape:e.shape&&e.shape instanceof b_?e.shape:new b_,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(e){let t,{width:n,height:i,spikes:r,angle:s,innerRadius:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,h=e.shape,u=function(e,t,n,i,r,s){if(i>=eT)return r>30||r%4===0?(function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=.5522847498,o=t*a,l=n*a;e.addPoint(rT(r-t,s,r-t,s-l,r-t,s+l)),e.addPoint(rT(r,s+n,r-o,s+n,r+o,s+n)),e.addPoint(rT(r+t,s,r+t,s+l,r+t,s-l)),e.addPoint(rT(r,s-n,r+o,s-n,r-o,s-n)),i>0&&aT(e,t,n,i)}(e,t,n,s),Math.round(r/4)):nT(e,i,r,t,n,s);i=Math.max(i,.001);let a={x:0,y:n},o=i+.5*Math.PI,l={x:Math.cos(o)*t,y:Math.sin(o)*n},c=A_({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:n,largeArcFlag:i>Math.PI,sweepFlag:!0});return r>30||r%c.length===0?function(e,t,n,i,r,s,a,o){let l=Math.round(r/i.length);e.addPoint(iT(t,n));for(let c=0,h=i.length;c<h;c++){let t=i[c],n=e.points[c],r=iT(t.x,t.y);n.controls[1].position.set(t.x1,t.y1),r.controls[0].position.set(t.x2,t.y2),e.addPoint(r)}return o>0?sT(e,s,a,o):e.addPoint(iT(0,0)),l}(e,a.x,a.y,c,r,t,n,s):nT(e,i,r,t,n,s)}(h,.5*n,.5*i,s*Math.PI/180,r,a);return h.isClosed=!0,h.update(),0===s?(t=new gs,t.setAttribute("position",new ls([],3))):t=$_.create({shape:h,parameters:{subdivisions:u,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}}),Object.assign(t,{userData:{...e,type:"EllipseGeometry"}})}};function nT(e,t,n,i,r,s){let a=-t/n;for(let o=0;o<=n;o++){let t=a*o,n=Math.sin(t)*i,s=Math.cos(t)*r;e.addPoint(iT(n,s))}return t<eT?s>0?sT(e,i,r,s):e.addPoint(iT(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&aT(e,i,r,s)),1}function iT(e,t){return new FS(ui.generateUUID(),new di(e,t))}function rT(e,t,n,i,r,s){let a=iT(e,t);return a.controls[0].position.set(n,i),a.controls[1].position.set(r,s),a}function sT(e,t,n,i){oT(e,t,n,i).forEach((t=>e.addPoint(t)))}function aT(e,t,n,i){let r=oT(e,t,n,i),s=new b_;r.forEach((e=>s.addPoint(e))),s.isClosed=!0,e.shapeHoles.push(s)}function oT(e,t,n,i){let r=i*t/100,s=r*(Math.abs(n)/Math.abs(t)),a=new di(r/t,s/n),o=e.points.map((e=>{let t=e.clone();return t.uuid=ui.generateUUID(),t})).reverse();return o.forEach((e=>{e.position.multiply(a);let t=e.controls[0].position.clone().multiply(a),n=e.controls[1].position.clone().multiply(a);e.controls[0].position.copy(n),e.controls[1].position.copy(t)})),o}var lT=new os([0,0,0],1),cT=class extends gs{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,a=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,o=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,l=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1;if(super(),0===i)return;let c=e&&1===i;c&&(l=0),o>100&&(o=100),0===o&&(l=0);let h,u,d,p,f,m,g,v,y=()=>new ji,b=new ji,w=y(),x=y(),E=y(),C=y(),A=y(),S=y(),_=y(),T=y(),P=y(),M=y(),N=y(),I=t-2*s+.001,O=I/i,D=Math.ceil(r*i),L=D+1,R=I/D,k=-I/2,B=a+1,U=2*Math.PI/a,z=Math.PI/2/l,F=Math.min((1-o/100)*s,s-.01),j=s-F,V=0,H=2*l+2,W=B*H/2,G=W+B*L,q=Math.max(0,B*(L+H)),[K,Y,Q]=[3,3,2].map((e=>Array(q*e).fill(0))),X=[],Z=n-s;function J(t,n){let i=Math.PI/2;m=n*R,v=2*Math.PI*(m%O)/O+i,m+=k,g=Math.sin(v)*Z,f=Math.cos(v)*Z,e?t.set(f,g,m):t.set(f,m,g)}J(b,-1e-10),J(w,0),C.copy(b),J(b,1);let $=b.distanceTo(w),ee=c?0:j+F,te=$*D+2*ee,ne=F,ie=te-ee;for(let oe=0;oe<=D;oe++){J(x,oe),N.subVectors(x,C).normalize(),C.copy(x),P.copy(x).setComponent(+e+1,0).normalize(),M.crossVectors(N,P).normalize();let t=0===oe,n=oe===D,i=t?3*Math.PI/2:z,r=t?ne:ie,o=t?B:G,h=t?0:q-B,u=N.clone().multiplyScalar(t?-j:j).add(x),d=N.clone().multiplyScalar(t?-1:1).normalize();for(let e=0;e<B;e++){let p=e*U;if(A.addVectors(b.copy(P).multiplyScalar(s*Math.cos(p)),w.copy(M).multiplyScalar(s*Math.sin(p))),S.copy(A).normalize(),t||n){c||(V=h+e,[0,1,2].forEach((e=>{K[3*V+e]=u.getComponent(e),Y[3*V+e]=d.getComponent(e)})),Q[2*V]=+n,Q[2*V+1]=e/a),w.copy(S).multiplyScalar(F),E.addVectors(x,w);for(let n=0;n<l;n++){let s=n*z+i;_.addVectors(b.copy(N).multiplyScalar(j*Math.sin(s)),w.copy(S).multiplyScalar(j*Math.cos(s))),T.copy(_).normalize(),w.addVectors(E,_),_.normalize(),V=o+n*B+e,[0,1,2].forEach((e=>{K[3*V+e]=w.getComponent(e),Y[3*V+e]=T.getComponent(e)}));let l=+t+Math.sin(s);Q[2*V]=(r+j*l)/te,Q[2*V+1]=e/a}}w.addVectors(x,A),V=W+oe*B+e,[0,1,2].forEach((e=>{K[3*V+e]=w.getComponent(e),Y[3*V+e]=S.getComponent(e)})),Q[2*V]=(ee+oe*$)/te,Q[2*V+1]=e/a}}let re=L+2*l+2,[se,ae]=[+c,re-1];for(let oe=se;oe<=ae-1;oe++){let e=c&&oe===ae-1;for(let t=0;t<B-1;t++)h=oe*B+t,u=h+1,d=(e?t:h)+B,p=(e?t+1:u)+B,0===oe?X.push(u,p,d):oe===re-2?X.push(h,u,d):X.push(h,u,d,u,p,d)}this.setIndex(X),this.setAttribute("position",new ls(K,3)),this.setAttribute("normal",new ls(Y,3)),this.setAttribute("uv",new ls(Q,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e,t,n,i,r=this.userData.parameters,s=Math.ceil(r.tubularSegments),a=r.radialSegments+1,o=Array.from(this.getIndex().array),l=6*(s-1)*r.radialSegments,c=s,h=c===s;for(let u=0;u<r.radialSegments;u++)e=c*a+u,t=e+1,n=(h?u:e)+a,i=(h?u+1:t)+a,o[l++]=e,o[l++]=t,o[l++]=n,o[l++]=t,o[l++]=i,o[l++]=n;return o.length=l,lT.array=o,lT.count=o.length,lT}},hT=class extends RS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=(1+Math.sqrt(5))/2,r="IcosahedronGeometry";super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],r,e,t,n),this.type=r}static fromJSON(e){return new hT(e.radius,e.corner,e.cornerSides)}},uT=new vr,dT=new Vr,pT=new ji,fT=class extends Zn{constructor(){super(),this.uuid=ui.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=(new pi).getNormalMatrix(e);for(let n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(e);for(let n=0,i=this.faces.length;n<i;n++){let e=this.faces[n];e.normal.applyMatrix3(t).normalize();for(let n=0,i=e.vertexNormals.length;n<i;n++)e.vertexNormals[n].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return uT.makeRotationX(e),this.applyMatrix4(uT),this}rotateY(e){return uT.makeRotationY(e),this.applyMatrix4(uT),this}rotateZ(e){return uT.makeRotationZ(e),this.applyMatrix4(uT),this}translate(e,t,n){return uT.makeTranslation(e,t,n),this.applyMatrix4(uT),this}scale(e,t,n){return uT.makeScale(e,t,n),this.applyMatrix4(uT),this}lookAt(e){return dT.lookAt(e),dT.updateMatrix(),this.applyMatrix4(dT.matrix),this}fromBufferGeometry(e){let t=this,n=null!==e.index?e.index:void 0,i=e.attributes;if(void 0===i.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=i.position,s=i.normal,a=i.color,o=i.uv,l=i.uv2;void 0!==l&&(this.faceVertexUvs[1]=[]);for(let u=0;u<r.count;u++)t.vertices.push((new ji).fromBufferAttribute(r,u)),void 0!==a&&t.colors.push((new Mi).fromBufferAttribute(a,u));function c(e,n,i,r){let c=void 0===a?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[i].clone()],h=void 0===s?[]:[(new ji).fromBufferAttribute(s,e),(new ji).fromBufferAttribute(s,n),(new ji).fromBufferAttribute(s,i)],u=new gT(e,n,i,h,c,r);t.faces.push(u),void 0!==o&&t.faceVertexUvs[0].push([(new di).fromBufferAttribute(o,e),(new di).fromBufferAttribute(o,n),(new di).fromBufferAttribute(o,i)]),void 0!==l&&t.faceVertexUvs[1].push([(new di).fromBufferAttribute(l,e),(new di).fromBufferAttribute(l,n),(new di).fromBufferAttribute(l,i)])}let h=e.groups;if(h.length>0)for(let u=0;u<h.length;u++){let e=h[u],t=e.start;for(let i=t,r=t+e.count;i<r;i+=3)void 0!==n?c(n.getX(i),n.getX(i+1),n.getX(i+2),e.materialIndex):c(i,i+1,i+2,e.materialIndex)}else if(void 0!==n)for(let u=0;u<n.count;u+=3)c(n.getX(u),n.getX(u+1),n.getX(u+2));else for(let u=0;u<r.count;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(pT).negate(),this.translate(pT.x,pT.y,pT.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,i=new vr;return i.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let e=new ji,t=new ji;for(let n=0,i=this.faces.length;n<i;n++){let i=this.faces[n],r=this.vertices[i.a],s=this.vertices[i.b],a=this.vertices[i.c];e.subVectors(a,s),t.subVectors(r,s),e.cross(t),e.normalize(),i.normal.copy(e)}}computeVertexNormals(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=new Array(this.vertices.length);for(let n=0,i=this.vertices.length;n<i;n++)t[n]=new ji;if(e){let e=new ji,n=new ji;for(let i=0,r=this.faces.length;i<r;i++){let r=this.faces[i],s=this.vertices[r.a],a=this.vertices[r.b],o=this.vertices[r.c];e.subVectors(o,a),n.subVectors(s,a),e.cross(n),t[r.a].add(e),t[r.b].add(e),t[r.c].add(e)}}else{this.computeFaceNormals();for(let e=0,n=this.faces.length;e<n;e++){let n=this.faces[e];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let n=0,i=this.vertices.length;n<i;n++)t[n].normalize();for(let n=0,i=this.faces.length;n<i;n++){let e=this.faces[n],i=e.vertexNormals;3===i.length?(i[0].copy(t[e.a]),i[1].copy(t[e.b]),i[2].copy(t[e.c])):(i[0]=t[e.a].clone(),i[1]=t[e.b].clone(),i[2]=t[e.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let t=this.faces[e],n=t.vertexNormals;3===n.length?(n[0].copy(t.normal),n[1].copy(t.normal),n[2].copy(t.normal)):(n[0]=t.normal.clone(),n[1]=t.normal.clone(),n[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,n=this.faces.length;t<n;t++){let e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(let t=0,n=e.vertexNormals.length;t<n;t++)e.__originalVertexNormals[t]?e.__originalVertexNormals[t].copy(e.vertexNormals[t]):e.__originalVertexNormals[t]=e.vertexNormals[t].clone()}let e=new fT;e.faces=this.faces;for(let t=0,n=this.morphTargets.length;t<n;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let e=this.morphNormals[t].faceNormals,n=this.morphNormals[t].vertexNormals;for(let t=0,i=this.faces.length;t<i;t++){let t=new ji,i={a:new ji,b:new ji,c:new ji};e.push(t),n.push(i)}}let n=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let e=0,t=this.faces.length;e<t;e++){let t=this.faces[e],i=n.faceNormals[e],r=n.vertexNormals[e];i.copy(t.normal),r.a.copy(t.vertexNormals[0]),r.b.copy(t.vertexNormals[1]),r.c.copy(t.vertexNormals[2])}}for(let t=0,n=this.faces.length;t<n;t++){let e=this.faces[t];e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals}}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Wi),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new lr),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!e.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);let i,r=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,c=this.colors,h=e.colors;void 0!==t&&(i=(new pi).getNormalMatrix(t));for(let u=0,d=a.length;u<d;u++){let e=a[u].clone();void 0!==t&&e.applyMatrix4(t),s.push(e)}for(let u=0,d=h.length;u<d;u++)c.push(h[u].clone());for(let u=0,d=l.length;u<d;u++){let e,t,s=l[u],a=s.vertexNormals,c=s.vertexColors,h=new gT(s.a+r,s.b+r,s.c+r);h.normal.copy(s.normal),void 0!==i&&h.normal.applyMatrix3(i).normalize();for(let n=0,r=a.length;n<r;n++)e=a[n].clone(),void 0!==i&&e.applyMatrix3(i).normalize(),h.vertexNormals.push(e);h.color.copy(s.color);for(let n=0,i=c.length;n<i;n++)t=c[n],h.vertexColors.push(t.clone());h.materialIndex=s.materialIndex+n,o.push(h)}for(let u=0,d=e.faceVertexUvs.length;u<d;u++){let t=e.faceVertexUvs[u];void 0===this.faceVertexUvs[u]&&(this.faceVertexUvs[u]=[]);for(let e=0,n=t.length;e<n;e++){let n=t[e],i=[];for(let e=0,t=n.length;e<t;e++)i.push(n[e].clone());this.faceVertexUvs[u].push(i)}}}mergeMesh(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)}mergeVertices(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t={},n=[],i=[],r=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let e=this.vertices[o],s=Math.round(e.x*r)+"_"+Math.round(e.y*r)+"_"+Math.round(e.z*r);void 0===t[s]?(t[s]=o,n.push(this.vertices[o]),i[o]=n.length-1):i[o]=i[t[s]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let e=this.faces[o];e.a=i[e.a],e.b=i[e.b],e.c=i[e.c];let t=[e.a,e.b,e.c];for(let n=0;n<3;n++)if(t[n]===t[(n+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let e=s[o];this.faces.splice(e,1);for(let t=0,n=this.faceVertexUvs.length;t<n;t++)this.faceVertexUvs[t].splice(e,1)}let a=this.vertices.length-n.length;return this.vertices=n,a}setFromPoints(e){this.vertices=[];for(let t=0,n=e.length;t<n;t++){let n=e[t];this.vertices.push(new ji(n.x,n.y,n.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let a=0;a<t;a++)e[a]._id=a;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));let n,i,r=this.faceVertexUvs[0],s=this.faceVertexUvs[1];r&&r.length===t&&(n=[]),s&&s.length===t&&(i=[]);for(let a=0;a<t;a++){let t=e[a]._id;n&&n.push(r[t]),i&&i.push(s[t])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){let t=this.parameters;for(let n in t)void 0!==t[n]&&(e[n]=t[n]);return e}let t=[];for(let p=0;p<this.vertices.length;p++){let e=this.vertices[p];t.push(e.x,e.y,e.z)}let n=[],i=[],r={},s=[],a={},o=[],l={};for(let p=0;p<this.faces.length;p++){let e=this.faces[p],t=!0,i=!1,r=void 0!==this.faceVertexUvs[0][p],s=e.normal.length()>0,a=e.vertexNormals.length>0,o=1!==e.color.r||1!==e.color.g||1!==e.color.b,l=e.vertexColors.length>0,f=0;if(f=c(f,0,0),f=c(f,1,t),f=c(f,2,i),f=c(f,3,r),f=c(f,4,s),f=c(f,5,a),f=c(f,6,o),f=c(f,7,l),n.push(f),n.push(e.a,e.b,e.c),n.push(e.materialIndex),r){let e=this.faceVertexUvs[0][p];n.push(d(e[0]),d(e[1]),d(e[2]))}if(s&&n.push(h(e.normal)),a){let t=e.vertexNormals;n.push(h(t[0]),h(t[1]),h(t[2]))}if(o&&n.push(u(e.color)),l){let t=e.vertexColors;n.push(u(t[0]),u(t[1]),u(t[2]))}}function c(e,t,n){return n?e|1<<t:e&~(1<<t)}function h(e){let t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==r[t]||(r[t]=i.length/3,i.push(e.x,e.y,e.z)),r[t]}function u(e){let t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==a[t]||(a[t]=s.length,s.push(e.getHex())),a[t]}function d(e){let t=e.x.toString()+e.y.toString();return void 0!==l[t]||(l[t]=o.length/2,o.push(e.x,e.y)),l[t]}return e.data={},e.data.vertices=t,e.data.normals=i,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=n,e}clone(){return(new fT).copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let u=0,d=t.length;u<d;u++)this.vertices.push(t[u].clone());let n=e.colors;for(let u=0,d=n.length;u<d;u++)this.colors.push(n[u].clone());let i=e.faces;for(let u=0,d=i.length;u<d;u++)this.faces.push(i[u].clone());for(let u=0,d=e.faceVertexUvs.length;u<d;u++){let t=e.faceVertexUvs[u];void 0===this.faceVertexUvs[u]&&(this.faceVertexUvs[u]=[]);for(let e=0,n=t.length;e<n;e++){let n=t[e],i=[];for(let e=0,t=n.length;e<t;e++){let t=n[e];i.push(t.clone())}this.faceVertexUvs[u].push(i)}}let r=e.morphTargets;for(let u=0,d=r.length;u<d;u++){let e={};if(e.name=r[u].name,void 0!==r[u].vertices){e.vertices=[];for(let t=0,n=r[u].vertices.length;t<n;t++)e.vertices.push(r[u].vertices[t].clone())}if(void 0!==r[u].normals){e.normals=[];for(let t=0,n=r[u].normals.length;t<n;t++)e.normals.push(r[u].normals[t].clone())}this.morphTargets.push(e)}let s=e.morphNormals;for(let u=0,d=s.length;u<d;u++){let e={};if(void 0!==s[u].vertexNormals){e.vertexNormals=[];for(let t=0,n=s[u].vertexNormals.length;t<n;t++){let n=s[u].vertexNormals[t],i={};i.a=n.a.clone(),i.b=n.b.clone(),i.c=n.c.clone(),e.vertexNormals.push(i)}}if(void 0!==s[u].faceNormals){e.faceNormals=[];for(let t=0,n=s[u].faceNormals.length;t<n;t++)e.faceNormals.push(s[u].faceNormals[t].clone())}this.morphNormals.push(e)}let a=e.skinWeights;for(let u=0,d=a.length;u<d;u++)this.skinWeights.push(a[u].clone());let o=e.skinIndices;for(let u=0,d=o.length;u<d;u++)this.skinIndices.push(o[u].clone());let l=e.lineDistances;for(let u=0,d=l.length;u<d;u++)this.lineDistances.push(l[u]);let c=e.boundingBox;null!==c&&(this.boundingBox=c.clone());let h=e.boundingSphere;return null!==h&&(this.boundingSphere=h.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=(new mT).fromGeometry(this),t=new gs,n=new Float32Array(3*e.vertices.length);if(t.setAttribute("position",wT.call(new ss(n,3),e.vertices)),e.normals.length>0){let n=new Float32Array(3*e.normals.length);t.setAttribute("normal",wT.call(new ss(n,3),e.normals))}if(e.colors.length>0){let n=new Float32Array(3*e.colors.length);t.setAttribute("color",yT.call(new ss(n,3),e.colors))}if(e.uvs.length>0){let n=new Float32Array(2*e.uvs.length);t.setAttribute("uv",bT.call(new ss(n,2),e.uvs))}if(e.uvs2.length>0){let n=new Float32Array(2*e.uvs2.length);t.setAttribute("uv2",bT.call(new ss(n,2),e.uvs2))}t.groups=e.groups;for(let i in e.morphTargets){let n=[],r=e.morphTargets[i];for(let e=0,t=r.length;e<t;e++){let t=r[e],i=new ls(3*t.data.length,3);i.name=t.name,n.push(wT.call(i,t.data))}t.morphAttributes[i]=n}if(e.skinIndices.length>0){let n=new ls(4*e.skinIndices.length,4);t.setAttribute("skinIndex",xT.call(n,e.skinIndices))}if(e.skinWeights.length>0){let n=new ls(4*e.skinWeights.length,4);t.setAttribute("skinWeight",xT.call(n,e.skinWeights))}return null!==e.boundingSphere&&(t.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new gs,n=e.geometry;if(e.isPoints||e.isLine){let e=new ls(3*n.vertices.length,3),i=new ls(3*n.colors.length,3);if(t.setAttribute("position",wT.call(e,n.vertices)),t.setAttribute("color",yT.call(i,n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length){let e=new ls(n.lineDistances.length,1);t.setAttribute("lineDistance",vT.call(e,n.lineDistances))}null!==n.boundingSphere&&(t.boundingSphere=n.boundingSphere.clone()),null!==n.boundingBox&&(t.boundingBox=n.boundingBox.clone())}else e.isMesh&&(t=n.toBufferGeometry());return t}};fT.prototype.isGeometry=!0;var mT=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t,n,i,r=[],s=e.faces;for(n=0;n<s.length;n++){let e=s[n];e.materialIndex!==i&&(i=e.materialIndex,void 0!==t&&(t.count=3*n-t.start,r.push(t)),t={start:3*n,materialIndex:i})}void 0!==t&&(t.count=3*n-t.start,r.push(t)),this.groups=r}fromGeometry(e){let t,n=e.faces,i=e.vertices,r=e.faceVertexUvs,s=r[0]&&r[0].length>0,a=r[1]&&r[1].length>0,o=e.morphTargets,l=o.length;if(l>0){t=[];for(let e=0;e<l;e++)t[e]={name:o[e].name,data:[]};this.morphTargets.position=t}let c,h=e.morphNormals,u=h.length;if(u>0){c=[];for(let e=0;e<u;e++)c[e]={name:h[e].name,data:[]};this.morphTargets.normal=c}let d=e.skinIndices,p=e.skinWeights,f=d.length===i.length,m=p.length===i.length;i.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<n.length;g++){let e=n[g];this.vertices.push(i[e.a],i[e.b],i[e.c]);let v=e.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{let t=e.normal;this.normals.push(t,t,t)}let y=e.vertexColors;if(3===y.length)this.colors.push(y[0],y[1],y[2]);else{let t=e.color;this.colors.push(t,t,t)}if(!0===s){let e=r[0][g];void 0!==e?this.uvs.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new di,new di,new di))}if(!0===a){let e=r[1][g];void 0!==e?this.uvs2.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new di,new di,new di))}for(let n=0;n<l;n++){let i=o[n].vertices;t[n].data.push(i[e.a],i[e.b],i[e.c])}for(let t=0;t<u;t++){let e=h[t].vertexNormals[g];c[t].data.push(e.a,e.b,e.c)}f&&this.skinIndices.push(d[e.a],d[e.b],d[e.c]),m&&this.skinWeights.push(p[e.a],p[e.b],p[e.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}},gT=class{constructor(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new ji,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new Mi,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return(new this.constructor).copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function vT(e){return this.array.set(e),this}function yT(e){let t=this.array,n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new Mi),t[n++]=r.r,t[n++]=r.g,t[n++]=r.b}return this}function bT(e){let t=this.array,n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new di),t[n++]=r.x,t[n++]=r.y}return this}function wT(e){let t=this.array,n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new ji),t[n++]=r.x,t[n++]=r.y,t[n++]=r.z}return this}function xT(e){let t=this.array,n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new ki),t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n++]=r.w}return this}var ET=["a","b","c"];function CT(e,t){switch(t){case"c":return e.c;case"b":return e.b;default:return e.a}}function AT(e,t,n){let i=Math.min(e,t)+"_"+Math.max(e,t);return n.get(i)}function ST(e,t,n,i,r,s){let a,o=Math.min(e,t),l=Math.max(e,t),c=o+"_"+l;if(i.has(c))a=i.get(c);else{a={a:n[o],b:n[l],newEdge:null,faces:[]},i.set(c,a)}a.faces.push(r),s[e].edges.push(a),s[t].edges.push(a)}function _T(e,t,n,i,r){e.push(new gT(t,n,i,void 0,void 0,r))}function TT(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function PT(e,t,n,i){e.push([t.clone(),n.clone(),i.clone()])}var MT=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.subdivisions=e}modify(e){(e=e instanceof gs?(new fT).fromBufferGeometry(e):e.clone()).mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t,n,i,r,s,a=new ji,o=e.vertices,l=e.faces,c=e.faceVertexUvs[0],h=void 0!==c&&c.length>0,u=[],d=new Map;!function(e,t,n,i){let r,s,a;for(r=0,s=e.length;r<s;r++)n[r]={edges:[]};for(r=0,s=t.length;r<s;r++)a=t[r],ST(a.a,a.b,e,i,a,n),ST(a.b,a.c,e,i,a,n),ST(a.c,a.a,e,i,a,n)}(o,l,u,d);let p,f,m,g,v,y,b,w=[];for(let H of Array.from(d.keys())){for(f=d.get(H),m=new ji,v=3/8,y=1/8,b=f.faces.length,2!=b&&(v=.5,y=0),m.addVectors(f.a,f.b).multiplyScalar(v),a.set(0,0,0),r=0;r<b;r++){for(g=f.faces[r],s=0;s<3&&(p=o[CT(g,ET[s])],p===f.a||p===f.b);s++);p&&a.add(p)}a.multiplyScalar(y),m.add(a),f.newEdge=w.length,w.push(m)}let x,E,C,A,S,_,T,P=[];for(n=0,i=o.length;n<i;n++){for(_=o[n],S=u[n].edges,t=S.length,3==t?x=3/16:t>3&&(x=3/(8*t)),E=1-t*Number(x),C=x,t<=2&&(2==t&&(E=3/4,C=1/8)),T=_.clone().multiplyScalar(E),a.set(0,0,0),r=0;r<t;r++)A=S[r],p=A.a!==_?A.a:A.b,a.add(p);a.multiplyScalar(Number(C)),T.add(a),P.push(T)}let M,N,I,O,D,L,R,k=P.concat(w),B=P.length,U=[],z=[],F=new di,j=new di,V=new di;for(n=0,i=l.length;n<i;n++)g=l[n],M=Number(AT(g.a,g.b,d).newEdge)+B,N=Number(AT(g.b,g.c,d).newEdge)+B,I=Number(AT(g.c,g.a,d).newEdge)+B,_T(U,M,N,I,g.materialIndex),_T(U,g.a,M,I,g.materialIndex),_T(U,g.b,N,M,g.materialIndex),_T(U,g.c,I,N,g.materialIndex),h&&(O=c[n],D=O[0],L=O[1],R=O[2],F.set(TT(D.x,L.x),TT(D.y,L.y)),j.set(TT(L.x,R.x),TT(L.y,R.y)),V.set(TT(D.x,R.x),TT(D.y,R.y)),PT(z,F,j,V),PT(z,D,F,V),PT(z,L,j,F),PT(z,R,V,j));e.vertices=k,e.faces=U,h&&(e.faceVertexUvs[0]=z)}},NT=new ji,IT=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof b_?e.shape:new b_,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(e){let{width:t,height:n,spikes:i,cornerRadius:r,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,c=.5*t,h=.5*n,u=2*Math.PI/i;for(let p=0;p<i;p++){let e=u*p,t=0+Math.sin(e)*c,n=0+Math.cos(e)*h;l.addPoint(l.createPoint(t,n))}l.isClosed=!0;for(let p=0,f=l.points.length;p<f;p++)l.points[p].roundness=r;l.roundness=r,l.update();let d=$_.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(d,{userData:{...e,type:"PolygonGeometry"}})}};function OT(e,t,n){n.x=e.x*t.x,n.y=e.y,n.z=e.x*t.y}function DT(e,t,n,i,r,s){let a=t.clone().sub(e),o=n.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),i===r){let t=a.add(o).normalize();s.copy(e).addScaledVector(t,i/Math.sin(l/2))}else{let t=a.angleTo(o);s.copy(e),s.addScaledVector(a,r/Math.sin(t)),s.addScaledVector(o,i/Math.sin(t))}}function LT(e,t,n){let i=e.clone().sub(t),r=n.clone().sub(t);return i.projectOnVector(r),i.add(t)}var RT=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:4;super(),n=Math.floor(Math.max(3,n)),i=Math.floor(i),a=Math.floor(a);let o,l=[],c=[],h=[],u=[],d=0,p=t/2,f=Math.PI/n,m=e*Math.cos(Math.PI/n),g=2*Math.PI/n,v=(n-2)*Math.PI/n,y=Math.PI-v,b=new ji(0,-p,0),w=new ji(0,p,0),x=new di(e,-p),E=new di(m,-p),C=new di(0,w.y).sub(E),A=new di(0,w.y).sub(x),S=new di(C.y,-C.x).normalize(),_=new di(A.y,-A.x).normalize(),T=e*Math.cos(Math.PI/n)*Math.tan((Math.PI-C.angle())/2)-1e-8;s=Math.min(s,T);{let e=new ji(S.x,S.y,0),t=new ji(Math.cos(g)*e.x,e.y,Math.sin(g)*e.x);o=e.angleTo(t)}let P=s/Math.tan((Math.PI-C.angle())/2),M=s/Math.tan((Math.PI-o)/2),N=new ji;if(!r){c.push(b.x,b.y,b.z),h.push(0,-1,0),u.push(0,0);let e=d++,t=[],i=x.clone(),r=P/Math.cos(Math.PI/n);i.x-=r;for(let s=0;s<n;s++){let e=s/n*Math.PI*2+f;OT(i,new di(Math.sin(e),Math.cos(e)),N),c.push(N.x,N.y,N.z),h.push(0,-1,0),u.push(0,0),t.push(d++)}for(let n=0;n<t.length;n++)l.push(t[n],e,t[(n+1)%t.length])}let I=[];{let e=new ji,t=new ji,i=new ji,r=new ji,p=new ji,m=new ji;for(let g=0;g<n;g++){let v=g/n*Math.PI*2+f,y=(g+.5)/n*Math.PI*2+f,E=(g+1)/n*Math.PI*2+f,A=new di(Math.sin(v),Math.cos(v)),T=new di(Math.sin(y),Math.cos(y)),N=new di(Math.sin(E),Math.cos(E));OT(x,A,t),OT(x,N,i),OT(S,T,e),DT(w,t,i,M,M,r),c.push(r.x,r.y,r.z),DT(t,w,i,M,P,p),c.push(p.x,p.y,p.z),DT(i,t,w,P,M,m),c.push(m.x,m.y,m.z),h.push(e.x,e.y,e.z),h.push(e.x,e.y,e.z),h.push(e.x,e.y,e.z),u.push(0,0),u.push(0,0),u.push(0,0);let L=d++,R=d++,k=d++;if(l.push(L,R,k),s>0){{let e=t.clone().add(i).multiplyScalar(.5),n=w.clone().sub(e).normalize(),r=b.clone().sub(e).normalize().add(n).normalize().multiplyScalar(-1);O(e,m.clone().sub(p),r,C.angle())}let f,g;{let e=new ji;OT(_,N,e);let t=m.clone().add(r).multiplyScalar(.5);t=LT(t,i,w);let n=m.clone().sub(r);[f,g]=O(t,n,e,o,r.y)}{let e=f,t=e.clone().setY(0).normalize(),n=new ji(0,-1,0),i=t.clone().cross(n);D(e,t,n,i)}I.concat(g);{let t=C.angle(),i=Math.PI-t,r=w.clone();r.y-=s/Math.sin(t-Math.PI/2);let o=new ji,p=[];for(let l=0;l<a;l++){let t=[],f=Math.PI/2-i*l/a,m=Math.cos(f),g=Math.sin(f),v=y;for(let i=0;i<=l;i++){let i=Math.cos(v),a=Math.sin(v);e.x=m*a,e.y=g,e.z=m*i,o.copy(r).addScaledVector(e,s),c.push(o.x,o.y,o.z),h.push(e.x,e.y,e.z),u.push(0,0),t.push(d++),v+=2*Math.PI/l/n}p.push(t)}g.reverse(),p.push(g);let f=p.length-1;for(let e=0;e<f;e++){let t=p[e],n=p[e+1],i=t.length-1;l.push(n[1],t[0],n[0]);for(let e=1;e<=i;e++)l.push(t[e],t[e-1],n[e]),l.push(n[e+1],t[e],n[e])}}}}}function O(e,t,n,i,r){let o=-i/2,p=(Math.PI-i)/2,f=t.clone().normalize().cross(n);e.addScaledVector(n,-s/Math.sin(p));let m=new ji,g=new ji,v=d,y=[];for(let l=0;l<=a;l++){let p=o+l/a*i;g.set(0,0,0),g.addScaledVector(f,Math.sin(p)),g.addScaledVector(n,Math.cos(p));for(let n=0;n<=1;n++){let i=n/1-.5;if(m.copy(e),m.addScaledVector(t,i),m.addScaledVector(g,s),null!=r){let e=Math.max(0,m.y-r);m.addScaledVector(t,-e/t.y)}c.push(m.x,m.y,m.z),h.push(g.x,g.y,g.z),u.push(0,0),0===n&&y.push(d),d++}}for(let s=0;s<a;s++)for(let e=0;e<1;e++){let t=v+e+2*s,n=t+2,i=n+1,r=t+1;l.push(t,n,r),l.push(n,i,r)}return[e.clone().addScaledVector(t,.5),y]}function D(e,t,n,i){let r=Math.PI/2,o=A.angle()-r,p=[],f=new ji,m=new ji;for(let l=0;l<=a;l++){let g=[],v=l/a;for(let a=0;a<=l;a++){let p=((l?a/l:0)-.5)*y,b=Math.cos(p),w=Math.sin(p),x=(r+Math.atan(Math.tan(o)*b))*v,E=Math.cos(x),C=Math.sin(x);f.set(0,0,0),f.addScaledVector(t,C*b),f.addScaledVector(n,E),f.addScaledVector(i,C*w),m.copy(e).addScaledVector(f,s),c.push(m.x,m.y,m.z),h.push(f.x,f.y,f.z),u.push(0,0),g.push(d++)}p.push(g)}let g=p.length-1;for(let s=0;s<g;s++){let e=p[s],t=p[s+1],n=e.length-1;l.push(e[0],t[1],t[0]);for(let i=1;i<=n;i++)l.push(e[i-1],e[i],t[i]),l.push(e[i],t[i+1],t[i])}}this.setIndex(l),this.setAttribute("position",new ls(c,3)),this.setAttribute("normal",new ls(h,3)),this.setAttribute("uv",new ls(u,2))}},kT=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),i=Object.assign(t?.ui??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof b_?e.shape:new b_,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)}),ui:i}}static build(e){let t=e.shape,{width:n,height:i,cornerRadius:r,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c={x:.5*n,y:.5*i},h={x:-c.x,y:-c.y},u={x:c.x,y:c.y};function d(e,t,r){return t>n&&r>i?Math.min(e*n/t,e*i/r):t>n?e*n/t:r>i?e*i/r:e}let p=[];p[0]=0===r[0]?0:d(r[0],r[0]+r[3],r[0]+r[1]),p[1]=0===r[1]?0:d(r[1],r[1]+r[2],r[1]+r[0]),p[2]=0===r[2]?0:d(r[2],r[2]+r[1],r[2]+r[3]),p[3]=0===r[3]?0:d(r[3],r[3]+r[0],r[3]+r[2]);let f=h.x,m=u.x,g=u.y,v=h.y;t.addPoint(t.createPoint(f,g)),t.addPoint(t.createPoint(m,g)),t.addPoint(t.createPoint(m,v)),t.addPoint(t.createPoint(f,v)),t.isClosed=!0;let y=!0;for(let w=0,x=t.points.length;w<x;w++)t.points[w].roundness=p[w],w>0&&p[w]!==p[w-1]&&(y=!1);y&&(t.roundness=p[0]),t.useCubicForRoundedCorners=1!==s,t.update();let b=$_.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(b,{userData:{...e,type:"RectangleGeometry"}})}},BT=class extends gs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:90,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:24;super(),this.type="BackdropGeometry";let a=[],o=[],l=[],c=.001;0==r&&(s=1),s=Math.max(1,Math.floor(s)),r=Math.min(r,100),i=Math.min(180-c,i),i*=Math.PI/180;let h=[],u=Math.PI/2,d=function(){return new ji(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)},p=d(),f=d(),[m,g,v]=[t/2,e/2,n/2],y=-g,b=+g,[w,x,E]=[d(y,-m,+v),d(y,-m,-v),d(y,+m,-v)],C=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.sin(e-Math.PI/(+t+1))},A=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.cos(e-Math.PI/(+t+1))};E.y=Math.sin(i)*t-m;let S=Math.cos(i)*t-v,_=w.z-c;i<=u?(E.z=Math.min(S,_),E.z==_&&(E.y-=(S-_)/Math.tan(u-i))):x.z=Math.min(x.z-S-v,w.z-c),p.subVectors(w,x),f.subVectors(E,x);let T=Math.min(p.length(),f.length())*r/100,P=T*Math.tan(i/2),M=T/Math.cos(i/2),N=p.clone().normalize().add(f.normalize()).setLength(M).add(x);p.set(0,C(i,!0),A(i,!0)),h.push([E,p.clone()]);let I=(Math.PI-i)/s;for(let V=0;V<=s;V++){let e=u+i+V*I;p.set(0,Math.sin(e)*P,Math.cos(e)*P),p.add(N),f.set(0,C(e),A(e)),h.push([p.clone(),f.clone()])}h.push([w,d(0,1,0)]);let O=Math.sin(I/2)*P*2,D=h.length-1,L=h[0][0].distanceTo(h[1][0]),R=L+O*s+h[D-1][0].distanceTo(h[D][0]);h[0].push(1);for(let V=0;V<=s;V++)h[V+1].push(1-(L+V*O)/R);h[D].push(0);let k,B,U,[z,F,j]=h[0];for(let V=1;V<h.length;V++)[k,B,U]=h[V],a.push(y,z.y,z.z,y,k.y,k.z,b,z.y,z.z,b,z.y,z.z,y,k.y,k.z,b,k.y,k.z),o.push(0,F.y,F.z,0,B.y,B.z,0,F.y,F.z,0,F.y,F.z,0,B.y,B.z,0,B.y,B.z),l.push(0,j,0,U,1,j,1,j,0,U,1,U),[z,F,j]=[k,B,U];this.setAttribute("position",new ls(a,3)),this.setAttribute("normal",new ls(o,3)),this.setAttribute("uv",new ls(l,2))}},UT=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof b_?e.shape:new b_,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(e){let{width:t,height:n,innerRadiusPercent:i,spikes:r,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,h=e.shape,u=.5*t,d=.5*n,p=a*Math.PI/360/r,f=Math.PI/2*3*-1,m=u*i/100,g=d*i/100;if(3===r&&50===i){p=2*Math.PI/r;for(let e=0;e<r;e++){let t=p*e,n=0+Math.sin(t)*u,i=0+Math.cos(t)*d;h.addPoint(h.createPoint(n,i))}}else for(let y=0;y<r;y++){let e=0+Math.cos(f)*u,t=0+Math.sin(f)*d;h.addPoint(h.createPoint(e,t)),f+=p,e=0+Math.cos(f)*m,t=0+Math.sin(f)*g,h.addPoint(h.createPoint(e,t)),f+=p}h.isClosed=!0;for(let y=0,b=h.points.length;y<b;y++)h.points[y].roundness=s;h.roundness=s,h.update();let v=$_.create({shape:h,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(v,{userData:{...e,type:"StarGeometry"}})}};var zT={parseRgba:function(e){return/^(rgba)?\(\s*(\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e.toLowerCase())},hsvToRgb:function(e,t,n){let i,r,s,a=Math.floor(6*e),o=6*e-a,l=n*(1-t),c=n*(1-o*t),h=n*(1-(1-o)*t);switch(a%6){case 0:i=n,r=h,s=l;break;case 1:i=c,r=n,s=l;break;case 2:i=l,r=n,s=h;break;case 3:i=l,r=c,s=n;break;case 4:i=h,r=l,s=n;break;default:i=n,r=l,s=c}return{r:255*i,g:255*r,b:255*s}},rgbToHsv:function(e,t,n){e/=255,t/=255,n/=255;let i,r=Math.max(e,t,n),s=Math.min(e,t,n),a=r,o=r-s,l=0==r?0:o/r;if(r==s)i=0;else{switch(r){case e:i=(t-n)/o+(t<n?6:0);break;case t:i=(n-e)/o+2;break;default:i=(e-t)/o+4}i/=6}return{h:i,s:l,v:a}},hexToRgb:function(e){return{r:(e=Math.floor(e))>>16&255,g:e>>8&255,b:255&e}},rgbToHex:function(e,t,n){return(e<<16)+(t<<8)+n},rgbToHexString:function(e,t,n){return"#"+[e=Math.round(e),t=Math.round(t),n=Math.round(n)].map((e=>e.toString(16).padStart(2,"0"))).join("").toUpperCase()},hexStringToRgb:function(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,n,i)=>String(t+t+n+n+i+i)));let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}},FT=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+FT.version}static addUnaryOp(e){return FT.max_unop_len=Math.max(e.length,FT.max_unop_len),FT.unary_ops[e]=1,FT}static addBinaryOp(e,t,n){return FT.max_binop_len=Math.max(e.length,FT.max_binop_len),FT.binary_ops[e]=t,n?FT.right_associative.add(e):FT.right_associative.delete(e),FT}static addIdentifierChar(e){return FT.additional_identifier_chars.add(e),FT}static addLiteral(e,t){return FT.literals[e]=t,FT}static removeUnaryOp(e){return delete FT.unary_ops[e],e.length===FT.max_unop_len&&(FT.max_unop_len=FT.getMaxKeyLen(FT.unary_ops)),FT}static removeAllUnaryOps(){return FT.unary_ops={},FT.max_unop_len=0,FT}static removeIdentifierChar(e){return FT.additional_identifier_chars.delete(e),FT}static removeBinaryOp(e){return delete FT.binary_ops[e],e.length===FT.max_binop_len&&(FT.max_binop_len=FT.getMaxKeyLen(FT.binary_ops)),FT.right_associative.delete(e),FT}static removeAllBinaryOps(){return FT.binary_ops={},FT.max_binop_len=0,FT}static removeLiteral(e){return delete FT.literals[e],FT}static removeAllLiterals(){return FT.literals={},FT}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new FT(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map((e=>e.length)))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return FT.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!FT.binary_ops[String.fromCharCode(e)]||FT.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return FT.isIdentifierStart(e)||FT.isDecimalDigit(e)}throwError(e){let t=new Error(e+" at character "+this.index);throw t.index=this.index,t.description=e,t}runHook(e,t){if(FT.hooks[e]){let n={context:this,node:t};return FT.hooks.run(e,n),n.node}return t}searchHook(e){if(FT.hooks[e]){let t={context:this};return FT.hooks[e].find((function(e){return e.call(t.context,t),t.node})),t.node}}gobbleSpaces(){let e=this.code;for(;e===FT.SPACE_CODE||e===FT.TAB_CODE||e===FT.LF_CODE||e===FT.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let e=this.gobbleExpressions(),t=1===e.length?e[0]:{type:FT.COMPOUND,body:e};return this.runHook("after-all",t)}gobbleExpressions(e){let t,n,i=[];for(;this.index<this.expr.length;)if(t=this.code,t===FT.SEMCOL_CODE||t===FT.COMMA_CODE)this.index++;else if(n=this.gobbleExpression())i.push(n);else if(this.index<this.expr.length){if(t===e)break;this.throwError('Unexpected "'+this.char+'"')}return i}gobbleExpression(){let e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,FT.max_binop_len),t=e.length;for(;t>0;){if(FT.binary_ops.hasOwnProperty(e)&&(!FT.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!FT.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=t,e;e=e.substr(0,--t)}return!1}gobbleBinaryExpression(){let e,t,n,i,r,s,a,o,l;if(s=this.gobbleToken(),!s||(t=this.gobbleBinaryOp(),!t))return s;for(r={value:t,prec:FT.binaryPrecedence(t),right_a:FT.right_associative.has(t)},a=this.gobbleToken(),a||this.throwError("Expected expression after "+t),i=[s,r,a];t=this.gobbleBinaryOp();){if(n=FT.binaryPrecedence(t),0===n){this.index-=t.length;break}r={value:t,prec:n,right_a:FT.right_associative.has(t)},l=t;let o=e=>r.right_a&&e.right_a?n>e.prec:n<=e.prec;for(;i.length>2&&o(i[i.length-2]);)a=i.pop(),t=i.pop().value,s=i.pop(),e={type:FT.BINARY_EXP,operator:t,left:s,right:a},i.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+l),i.push(r,e)}for(o=i.length-1,e=i[o];o>1;)e={type:FT.BINARY_EXP,operator:i[o-1].value,left:i[o-2],right:e},o-=2;return e}gobbleToken(){let e,t,n,i;if(this.gobbleSpaces(),i=this.searchHook("gobble-token"),i)return this.runHook("after-token",i);if(e=this.code,FT.isDecimalDigit(e)||e===FT.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===FT.SQUOTE_CODE||e===FT.DQUOTE_CODE)i=this.gobbleStringLiteral();else if(e===FT.OBRACK_CODE)i=this.gobbleArray();else{for(t=this.expr.substr(this.index,FT.max_unop_len),n=t.length;n>0;){if(FT.unary_ops.hasOwnProperty(t)&&(!FT.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!FT.isIdentifierPart(this.expr.charCodeAt(this.index+t.length)))){this.index+=n;let e=this.gobbleToken();return e||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:FT.UNARY_EXP,operator:t,argument:e,prefix:!0})}t=t.substr(0,--n)}FT.isIdentifierStart(e)?(i=this.gobbleIdentifier(),FT.literals.hasOwnProperty(i.name)?i={type:FT.LITERAL,value:FT.literals[i.name],raw:i.name}:i.name===FT.this_str&&(i={type:FT.THIS_EXP})):e===FT.OPAREN_CODE&&(i=this.gobbleGroup())}return i?(i=this.gobbleTokenProperty(i),this.runHook("after-token",i)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let t=this.code;for(;t===FT.PERIOD_CODE||t===FT.OBRACK_CODE||t===FT.OPAREN_CODE||t===FT.QUMARK_CODE;){let n;if(t===FT.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==FT.PERIOD_CODE)break;n=!0,this.index+=2,this.gobbleSpaces(),t=this.code}this.index++,t===FT.OBRACK_CODE?(e={type:FT.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()},this.gobbleSpaces(),t=this.code,t!==FT.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):t===FT.OPAREN_CODE?e={type:FT.CALL_EXP,arguments:this.gobbleArguments(FT.CPAREN_CODE),callee:e}:(t===FT.PERIOD_CODE||n)&&(n&&this.index--,this.gobbleSpaces(),e={type:FT.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),n&&(e.optional=!0),this.gobbleSpaces(),t=this.code}return e}gobbleNumericLiteral(){let e,t,n="";for(;FT.isDecimalDigit(this.code);)n+=this.expr.charAt(this.index++);if(this.code===FT.PERIOD_CODE)for(n+=this.expr.charAt(this.index++);FT.isDecimalDigit(this.code);)n+=this.expr.charAt(this.index++);if(e=this.char,"e"===e||"E"===e){for(n+=this.expr.charAt(this.index++),e=this.char,("+"===e||"-"===e)&&(n+=this.expr.charAt(this.index++));FT.isDecimalDigit(this.code);)n+=this.expr.charAt(this.index++);FT.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+n+this.char+")")}return t=this.code,FT.isIdentifierStart(t)?this.throwError("Variable names cannot start with a number ("+n+this.char+")"):(t===FT.PERIOD_CODE||1===n.length&&n.charCodeAt(0)===FT.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:FT.LITERAL,value:parseFloat(n),raw:n}}gobbleStringLiteral(){let e="",t=this.index,n=this.expr.charAt(this.index++),i=!1;for(;this.index<this.expr.length;){let t=this.expr.charAt(this.index++);if(t===n){i=!0;break}if("\\"===t)switch(t=this.expr.charAt(this.index++),t){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=t}else e+=t}return i||this.throwError('Unclosed quote after "'+e+'"'),{type:FT.LITERAL,value:e,raw:this.expr.substring(t,this.index)}}gobbleIdentifier(){let e=this.code,t=this.index;for(FT.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,FT.isIdentifierPart(e));)this.index++;return{type:FT.IDENTIFIER,name:this.expr.slice(t,this.index)}}gobbleArguments(e){let t=[],n=!1,i=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let r=this.code;if(r===e){n=!0,this.index++,e===FT.CPAREN_CODE&&i&&i>=t.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}if(r===FT.COMMA_CODE){if(this.index++,i++,i!==t.length)if(e===FT.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===FT.CBRACK_CODE)for(let e=t.length;e<i;e++)t.push(null)}else if(t.length!==i&&0!==i)this.throwError("Expected comma");else{let e=this.gobbleExpression();(!e||e.type===FT.COMPOUND)&&this.throwError("Expected comma"),t.push(e)}}return n||this.throwError("Expected "+String.fromCharCode(e)),t}gobbleGroup(){this.index++;let e=this.gobbleExpressions(FT.CPAREN_CODE);if(this.code===FT.CPAREN_CODE)return this.index++,1===e.length?e[0]:!!e.length&&{type:FT.SEQUENCE_EXP,expressions:e};this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:FT.ARRAY_EXP,elements:this.gobbleArguments(FT.CBRACK_CODE)}}},jT=new class{add(e,t,n){if("string"!=typeof arguments[0])for(let i in arguments[0])this.add(i,arguments[0][i],arguments[1]);else(Array.isArray(e)?e:[e]).forEach((function(e){this[e]=this[e]||[],t&&this[e][n?"unshift":"push"](t)}),this)}run(e,t){this[e]=this[e]||[],this[e].forEach((function(e){e.call(t&&t.context?t.context:t,t)}))}};Object.assign(FT,{hooks:jT,plugins:new class{constructor(e){this.jsep=e,this.registered={}}register(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>{if("object"!=typeof e||!e.name||!e.init)throw new Error("Invalid JSEP plugin format");this.registered[e.name]||(e.init(this.jsep),this.registered[e.name]=e)}))}}(FT),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"}),FT.max_unop_len=FT.getMaxKeyLen(FT.unary_ops),FT.max_binop_len=FT.getMaxKeyLen(FT.binary_ops);var VT=e=>new FT(e).parse();Object.getOwnPropertyNames(FT).forEach((e=>{void 0===VT[e]&&"prototype"!==e&&(VT[e]=FT[e])})),VT.Jsep=FT;var HT={name:"ternary",init(e){e.hooks.add("after-expression",(function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let n=t.node,i=this.gobbleExpression();if(i||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let r=this.gobbleExpression();if(r||this.throwError("Expected expression"),t.node={type:"ConditionalExpression",test:n,consequent:i,alternate:r},n.operator&&e.binary_ops[n.operator]<=.9){let i=n;for(;i.right.operator&&e.binary_ops[i.right.operator]<=.9;)i=i.right;t.node.test=i.right,i.right=t.node,t.node=n}}else this.throwError("Expected :")}}))}};function WT(e){return{all:e=e||new Map,on:function(t,n){var i=e.get(t);i?i.push(n):e.set(t,[n])},off:function(t,n){var i=e.get(t);i&&(n?i.splice(i.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var i=e.get(t);i&&i.slice().map((function(e){e(n)})),(i=e.get("*"))&&i.slice().map((function(e){e(t,n)}))}}}VT.plugins.register(HT);var GT=class{constructor(e,t,n){this.id=e,this.userAPI=t,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise((e=>e())),this.emitter=WT(),this._innerCallUserAPI=async e=>{this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await async function(e,t){let n,i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new AbortController,s=e.url,a=e.proxy?.enabled??!1;if("OpenAI"===e.integration?.type){let n=YT(""===e.integration.prompt?[]:JSON.parse(e.integration.prompt),t),r=""===e.integration.behavior?[]:YT(JSON.parse(e.integration.behavior),t);i=`{\n\t\t"model": "${e.integration.model}",\n\t\t"messages": [${e.integration.useBehavior?`\n\t\t{\n\t\t\t"role": "system",\n\t\t\t"content": "${r}"\n\t\t},`:""}\n\t\t{\n\t\t\t"role": "user",\n\t\t\t"content": "${n}"\n\t\t}\n\t\t]\n\t}`}if(a){let n;s=`https://apis.spline.design/file/${e.proxy.fileId}/external-api/request?uuidexternalapi=${e.proxy.proxyId}`,void 0!==i?n=i:"POST"===e.method&&e.body&&(n=YT(JSON.parse(e.body),t)),void 0!==n&&(s+=`&data=${encodeURIComponent(n.replace(/(\r\n|\n|\r|\t)/gm,""))}`)}else"OpenAI"===e.integration?.type?n=i:"POST"===e.method&&e.body&&(n=YT(JSON.parse(e.body),t));let o=await fetch(s,{method:a?"GET":e.method,headers:a?void 0:qT(e),signal:r.signal,body:n});if(!o.ok)throw new Error("status:"+o.status+"_:_"+o.statusText);if("OpenAI"===e.integration?.type){let e=await o.json();return a&&(e=e.response),{content:e.choices[0].message.content}}{let e=await o.json();return a&&(e=e.response),e}}(this.userAPI,e),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(t){let n=t.message?.split("_:_")?.[0]?.replace("status:","")??"null";this.error=n,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0},"OpenAI"===t?.integration?.type?this.result={content:""}:"GET"===t.method&&""!==t.url&&(this.prefetchPromise=this.prefetch(n)),this._debouncedCallUserAPI=this._innerCallUserAPI,this._updateDebouncedCallUserAPI(),this._debouncedPrefetch=mv(this.prefetch,1e3,{trailing:!0})}_updateDebouncedCallUserAPI(){this._debouncedCallUserAPI=void 0!==this.userAPI.debounce&&this.userAPI.debounce>0?mv(this._innerCallUserAPI,this.userAPI.debounce,{leading:!0,trailing:!0}):this._innerCallUserAPI}async prefetch(e){await this.callUserAPI(e)}async callUserAPI(e){await this._debouncedCallUserAPI(e)}update(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.userAPI=e,this._updateDebouncedCallUserAPI(),""!==this.userAPI.url&&"GET"===this.userAPI.method&&n&&this._debouncedPrefetch(t)}retrieveValue(e){if(this.result)try{return Gy.zoom(this.result,e)}catch(yw){console.error(yw)}}retrieveZoomedKeyValues(e){if(this.result){let t=e&&e.length?Gy.zoom(this.result,e):this.result;if(function(e){return"object"==typeof e&&null!==e}(t))return Object.entries(t);if(function(e){return Array.isArray(e)}(t))return t.map(((e,t)=>[t.toString(),e]));throw function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(t)?new Error("This path points to a value, use retrieveValue() instead. "+e?.join(".")):new Error("Path error"+e?.join("."))}}dispose(){}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}get autostart(){return this.userAPI.autoStart}};function qT(e){let t=new Headers;return e.headers.forEach((e=>{""!==e.data.key&&t.append(e.data.key,e.data.value)})),t}var KT=(e,t)=>{if("string"==typeof e){let n=t.getVariable(e);if(n)return KT(n,t)}return NE.isBoolean(e)?NE.getDisplayedValue(e).toLowerCase():NE.getDisplayedValue(e)},YT=(e,t)=>e.map(((e,n)=>{if("text"in e)return e.text;if("type"in e){if("paragraph"===e.type)return(n>0?"\n":"")+YT(e.children,t);if("variable"===e.type){let n=t.getVariable(e.variableId);if(void 0!==n)return KT(n,t)}}return""})).join(""),QT=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],XT=["0","1","2","3","4","5","6","7","8","9","."],ZT=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function JT(e){return"string"==typeof e&&(!isNaN(e)&&!isNaN(parseFloat(e)))}function $T(e,t){let n,i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"number",s="";for(let a=0;a<e.length;a++){let n=e[a];if("objType"in n&&"api"===n.objType){let e=JSON.parse(n.id),i=e[0],r=t.getUserAPI(i);if(void 0!==r&&r instanceof GT){let t=r.retrieveValue(e.slice(1));void 0!==t&&(s+=t)}}else if("objType"in n&&"webhook"===n.objType){let e=JSON.parse(n.id),[i,r]=e,a=t.getUserWebhook(i);if(void 0!==a){let e=a.getParameterValue(r);void 0!==e&&(s+=e)}}else if("objType"in n&&"aiAssistant"===n.objType){let e=t.openAIRealtime;if("objId"in n&&void 0!==n.objId){let i;if(t.scene.data.objects.traverse(((e,t)=>{let r=t.events?.find((e=>e.id===n.objId));r&&(i=r)})),void 0!==i&&"AIAssistantListener"===i.data.type){let t=e?.computeAnalysisForListenerEvent(i.data);if(void 0!==t){s+=t;continue}}}s+=e?.voice??0}else if("id"in n){let i=e[a-1];if(a>0&&"id"in i)return void console.error("Two variables in a row",e);let o=t.getVariable(n.id),l=NE.getDisplayedValue(o);"number"===r&&NE.isTextValue(o)&&Array.isArray(o.textValue)&&1===o.textValue.length?l=parseFloat(l).toString():"boolean"===r&&NE.isBoolean(o)?l=o?"true":"false":"boolean"===r&&NE.isTextValue(o)&&!Array.isArray(o.textValue)&&(l='"'+l+'"'),s+=l}else"string"!==r?"and"!==n.name?"or"!==n.name?"True"!==n.name?"False"!==n.name?"boolean"!==r||JT(n.name)||XT.includes(n.name)||QT.includes(n.name)||ZT.includes(n.name.replace(/\($/g,""))?s+=n.name:s+='"'+n.name+'"':s+="false":s+="true":s+="||":s+="&&":('"'!==n.name&&("+"!==n.name||n.escaped)&&(s+=n.name),"+"===n.name&&!n.escaped&&"\\"===s[s.length-1]&&(s=s.slice(0,-1)+n.name))}if("string"===r)return s;if(0===e.length){if("number"===r)return 0;if("boolean"===r)return!1}try{n=VT(s)}catch(Hw){return void console.error(s,Hw)}try{i=eP(n)}catch(Hw){console.error(s,n,Hw)}return i}function eP(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return Number(eP(e.left)===eP(e.right));case"!=":return Number(eP(e.left)!==eP(e.right));case">":return Number(eP(e.left)>eP(e.right));case">=":return Number(eP(e.left)>=eP(e.right));case"<":return Number(eP(e.left)<eP(e.right));case"<=":return Number(eP(e.left)<=eP(e.right));case"+":return eP(e.left)+eP(e.right);case"-":return eP(e.left)-eP(e.right);case"*":return eP(e.left)*eP(e.right);case"/":return eP(e.left)/eP(e.right);case"%":return eP(e.left)%eP(e.right);case"&&":return eP(e.left)&&eP(e.right);case"||":return eP(e.left)||eP(e.right);case"^":return Math.pow(eP(e.left),eP(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-eP(e.argument);case"!":return Number(!eP(e.argument));default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if("Identifier"===e.callee.type){if("random"===e.callee.name){let t=0,n=1;if(e.arguments.length>=1)try{t=eP(e.arguments[0])}catch(Me){console.warn(Me)}if(e.arguments.length>=2)try{n=eP(e.arguments[1])}catch(Me){console.warn(Me)}return t=Math.min(n,t),n=Math.max(n,t),t+Math.random()*(n-t)}return Math[e.callee.name].apply(null,e.arguments.map(eP))}throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}VT.addBinaryOp("^",11,!0);var tP=new vr,nP=new vr;var iP=class extends gs{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&1===this.inputs.parameters.extrusion.depth}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&1===e.depth)||!function(e,t){let n=2*Math.PI;return(e%n+n)%n===(t%n+n)%n}(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:n,offset:i}=this.inputs.parameters.extrusion;n=Math.max(0,Math.min(n,1)),i=Math.max(0,Math.min(i,1));let r=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(i*r),a=this.inputs.path.isClosed?Math.ceil((n+i)*r):Math.ceil(Math.min(1,n+i)*r),o=Math.min(Math.max(2,a-s+1),r+2),l=[],c=[];for(let D=0;D<o;D++){let n=this.inputs.path.isClosed?(D+s)%e.length:Math.min(D+s,e.length-1);l.push(e[n].clone()),c.push(t[n].clone())}let h=(e,t,n)=>{l[e]=l[e].clone().lerp(l[t],n),c[e]=function(e,t,n){let i=[new ji,new ji,new ji],r=[new ji,new ji,new ji];return e.extractBasis(i[0],i[1],i[2]),t.extractBasis(r[0],r[1],r[2]),i.forEach(((e,t)=>{let i=r[t],s=ui.lerp(e.length(),i.length(),n);e.lerp(i,n).setLength(s)})),(new vr).makeBasis(i[0],i[1],i[2])}(c[e],c[t],n)},u=0,d=i*r%1;(!this.inputs.path.isClosed||n<=1)&&(d||0===i)&&(u=d,h(0,1,u));let p=0,f=(i+n)*r%1;if((this.inputs.path.isClosed&&n<=1||!this.inputs.path.isClosed&&i+n<1)&&f&&(p=f,h(l.length-1,l.length-2,1-p)),0===n){let e=l.length-1;l[e].copy(l[0]),c[e].copy(c[0])}this._applyPathModifiers(c,u,p);let{bevel:m,bevelSides:g}=this.inputs.parameters.extrusion,v=m>0?this.inputs.parameters.extrusion.capType:"flat",y=5;"Custom"===this.inputs.parameters.extrusion.shape.type&&(y="low"===this.inputs.parameters.extrusion.shape.shapeQuality?5:12);let b,{regions:w,infos:x,vertices:E}=this._computeShapePoints(y),C=0;"round"===v&&(b=new X_(this.inputs.shapeData,2*m,m,y,g,void 0,!0),C=b.getAttribute("position").count);let A=0,S=0;x.sort(((e,t)=>e.start-t.start)),x.forEach((e=>{e.verticesStart=A,e.verticesCount=e.continuous.reduce(((e,t,n)=>e+(0!==n&&t?1:2)),0),S+=e.verticesCount,A=S}));let _,T=S*o,P=0;if(this._isOpenEnded()&&"flat"===v){try{_=z_({windingRule:h_.ODD,elementType:d_.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:w})}catch{_=Y_}P=_.vertexCount}let M=T+2*P+2*C,N=T+2*P,I={positions:new Float32Array(3*M),normals:new Float32Array(3*M),uvs:new Float32Array(2*M)},O=[];if(x.forEach((e=>{this._extrudeRegion(e,E,c,l,I,O,this._isGeometryClosed()&&!this._isOpenEnded())})),_&&(this._closeEnd(_,T,O,I,c[0],l[0],!1),this._closeEnd(_,T+P,O,I,c[c.length-1],l[l.length-1],!0)),b){I.positions.set(b.getAttribute("position").array,3*N),I.normals.set(b.getAttribute("normal").array,3*N),I.uvs.set(b.getAttribute("uv").array,2*N);for(let i=N;i<N+C;i++)I.uvs[2*i+1]=1e-4;let e=O.length;O.push(...b.getIndex().array.map((e=>e+N))),N+=C,I.positions.set(b.getAttribute("position").array,3*N),I.normals.set(b.getAttribute("normal").array,3*N),I.uvs.set(b.getAttribute("uv").array,2*N);let t=O.length;O.push(...b.getIndex().array.map((e=>e+N))),this.setAttribute("position",new ss(I.positions,3)),this.setAttribute("normal",new ss(I.normals,3)),this.setAttribute("uv",new ss(I.uvs,2)),this.setIndex(O);let n=tP;n.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(n,N,M),n.copy(c[0]).setPosition(l[0]).multiply(nP.makeScale(1,1,-1)),this.applyMatrix4OnRange(n,N-C,N),this.reverseIndicesOnRange(e,t)}else this.setAttribute("position",new ss(I.positions,3)),this.setAttribute("normal",new ss(I.normals,3)),this.setAttribute("uv",new ss(I.uvs,2)),this.setIndex(O)}_extractPathPoints(){let e=ES(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach((e=>{t[t.length-1].distanceToSquared(e)>.001&&t.push(e)})),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],n=e.length,i=this.inputs.path.isClosed,r=new ji,s=new ji,a=new ji,o=new ji,l=new ji(0,1,0);for(let f=0;f<n;f++){let c,h,u=e[f];c=0===f?i?e[e.length-2]:u.clone().multiplyScalar(2).sub(e[1]):e[f-1],h=f===n-1?i?e[1]:u.clone().multiplyScalar(2).sub(e[f-1]):e[f+1];let d=u.clone().sub(c).normalize(),p=h.clone().sub(u).normalize(),m=d.clone().add(p).normalize();a.copy(m),0===f&&(m.equals(l)||m.clone().negate().equals(l))&&l.set(0,0,1);let g=l.clone().cross(m).normalize(),v=m.clone().cross(g).normalize();l.copy(v),o.copy(g),0===f&&(r.copy(v),s.copy(m));let y=(new vr).makeBasis(g,v,m);t.push(y)}let c=i?s:a,h=i?r:new ji(0,1,0),u=c.clone().cross(o).normalize(),d=Math.acos(h.dot(u));if(isNaN(d))return t;let p=h.clone().cross(u);c.dot(p)>0&&(d*=-1);for(let f=1;f<t.length;f++){let e=(new vr).makeRotationZ(d*f/t.length);t[f].multiply(e)}return t}_applyPathModifiers(e,t,n){let i=e.length,{angle:r,twist:s,startScale:a,endScale:o}=this.inputs.parameters.extrusion,l=new vr,c=new vr;return e.forEach(((e,h)=>{let u=0===h?0:h===i-1?1:(h-t)/(i-(0===n?0:1)-(t+(1-n)));l.makeRotationZ(ui.lerp(r,r+s,u)*ui.DEG2RAD);let d=ui.lerp(a,o,u);c.makeScale(d,d,d),e.multiply(l).multiply(c)})),e}_computeShapePoints(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h_.ODD,r=this.inputs.shapeData,s=r.extractShapePointsToFlatArray([],n),a=r.shapeHoles.map((e=>{let t=e.extractShapePointsToFlatArray([],n),i=[];for(let n=t.length-1;n>=1;n-=2){let e=t[n-1],r=t[n-0];i.push(e,r)}return i}));try{e=z_({windingRule:i,elementType:d_.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[s]})}catch{e=q_}try{t=z_({windingRule:h_.ODD,elementType:d_.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...a]})}catch{t=K_}if(!e)throw new Error("error generating geometry");let o=e.elementCount;if(t){e.elementCount+=t.elementCount;for(let n=0;n<t.elements.length;n++){let i=t.elements[n],r=n%2===0?e.vertexCount:0;e.elements.push(i+r)}for(let n=0;n<t.vertexIndices.length;n++){let i=t.vertexIndices[n],r=e.vertexCount;e.vertexIndices.push(i+r)}for(let n=0;n<t.vertices.length;n++){let i=t.vertices[n];e.vertices.push(i)}}let l=1/0,c=-1/0,h=1/0,u=-1/0;for(let p=0,f=e.vertexCount;p<f;p++){let t=2*p,n=e.vertices[t+0],i=e.vertices[t+1];n<l&&(l=n),n>c&&(c=n),i<h&&(h=i),i>u&&(u=i)}let d=[];for(let p=e.elementCount-1;p>=0;p--){let t=p>=o,n=2*p,i=e.elements[n+0],s=e.elements[n+1],a=i+s,l={start:i,count:s,normals:[],isHole:t,continuous:[],verticesStart:0,verticesCount:0};d.push(l);let c=i,h=a-1,u=i+1,f=r.roundedCurves.length;do{let n=c-i,o=e.vertices[2*h+0],d=e.vertices[2*h+1],p=e.vertices[2*c+0],m=e.vertices[2*c+1],g=e.vertices[2*u+0],v=e.vertices[2*u+1],y=p-o,b=m-d,w=Math.sqrt(y*y+b*b);y/=w,b/=w;let x=p-g,E=m-v,C=Math.sqrt(x*x+E*E);x/=C,E/=C,l.normals[2*n+0]=-E,l.normals[2*n+1]=x;let A=e.vertexIndices[c];if(Array.isArray(A))l.continuous[n]=!1;else{let[e,t]=r.getCurveIndexFromVertexId(A-1,!0);if(t>0&&t<1)l.continuous[n]=!0;else{let i=1===t?e+1:e-1;i=(i+f)%f;let s=1===t?0:1,a=r.roundedCurves[e].getTangent(t),o=r.roundedCurves[i].getTangent(s);l.continuous[n]=a.dot(o)>.95}}t&&(l.normals[2*n+0]*=-1,l.normals[2*n+1]*=-1),[h,c,u]=[c,u,u+1],u>=a&&(u-=s)}while(u!==i+1)}return{regions:[s,...a],infos:d,vertices:e.vertices}}_insertVertex(e,t,n,i,r){let s=2*t,a=3*t;e.positions[a+0]=n.x,e.positions[a+1]=n.y,e.positions[a+2]=n.z,e.normals[a+0]=i.x,e.normals[a+1]=i.y,e.normals[a+2]=i.z,e.uvs[s+0]=r.x,e.uvs[s+1]=r.y}_extrudeRegion(e,t,n,i,r,s,a){let o=new ji,l=new ji,c=new ji,h=new ji,u=new di;n.forEach(((s,a)=>{let d=i[a],p=e.verticesStart*n.length+e.verticesCount*a;for(let i=0;i<e.count;i++){let f=2*(e.start+i);if(o.set(t[f+0],t[f+1],0),c.copy(o).applyMatrix4(s).add(d),e.continuous[i])h.set(e.normals[2*i+0],e.normals[2*i+1],0);else{let n=0===i?2*(e.start+e.count-1):f-2;l.set(t[n+0],t[n+1],0),h.copy(o).sub(l),h.set(-h.y,h.x,0),e.isHole||h.negate()}if(h.applyMatrix4(s).normalize(),u.set(0===i?1:i/e.count,a/(n.length-1)),this._insertVertex(r,p,c,h,u),p++,!e.continuous[i]||0===i){if(0===i)h.set(e.normals[2*i+0],e.normals[2*i+1],0),u.set(0,a/(n.length-1));else{let n=i===e.count-1?2*e.start:f+2;l.set(t[n+0],t[n+1],0),h.copy(l).sub(o),h.set(-h.y,h.x,0),e.isHole||h.negate()}h.applyMatrix4(s).normalize(),this._insertVertex(r,p,c,h,u),p++}}}));let d=n.length-1;for(let p=0;p<d;p++){let t=e.verticesStart*n.length+e.verticesCount*p,i=e.verticesStart*n.length+e.verticesCount*(p+1),r=0;for(let n=0;n<e.count;n++){(!e.continuous[n]||0===n)&&r++;let a=n===e.count-1?0:r+1,o=t+r,l=t+a,c=i+a,h=i+r;e.isHole?s.push(o,c,l,o,h,c):s.push(o,l,c,o,c,h),r++}}}_closeEnd(e,t,n,i,r,s,a){let o=e.vertexCount,l=new ji(0,0,a?-1:1).applyMatrix4(r),c=new ji,h=new di;for(let d=0;d<o;d++){let n=2*d;c.set(e.vertices[n+0],e.vertices[n+1],0).applyMatrix4(r).add(s),this._insertVertex(i,t+d,c,l,h)}let u=e.elements;for(let d=0;d<e.elementCount;d++){let e=3*d,i=u[e+0]+t,r=u[e+(a?1:2)]+t,s=u[e+(a?2:1)]+t;n.push(i,r,s)}}applyMatrix4OnRange(e,t,n){let i,r,s,a,o=e.elements,l=(new pi).getNormalMatrix(e).elements,c=this.attributes.position,h=this.attributes.normal;if(!c||!h)return;let u=c.array,d=h.array,p=c.itemSize;for(let f=t*p,m=n*p;f<m;f+=p)i=u[f+0],r=u[f+1],s=u[f+2],a=1/(o[3]*i+o[7]*r+o[11]*s+o[15]),u[f+0]=(o[0]*i+o[4]*r+o[8]*s+o[12])*a,u[f+1]=(o[1]*i+o[5]*r+o[9]*s+o[13])*a,u[f+2]=(o[2]*i+o[6]*r+o[10]*s+o[14])*a,i=d[f+0],r=d[f+1],s=d[f+2],d[f+0]=l[0]*i+l[3]*r+l[6]*s,d[f+1]=l[1]*i+l[4]*r+l[7]*s,d[f+2]=l[2]*i+l[5]*r+l[8]*s;c.needsUpdate=!0,h.needsUpdate=!0}reverseIndicesOnRange(e,t){let n=this.index;if(n){for(let i=e;i<t;i+=3){let e=n.getX(i),t=n.getX(i+1),r=n.getX(i+2);n.setXYZ(i,r,t,e)}n.needsUpdate=!0}}};function rP(){let e=new gs;return e.setAttribute("position",new ss(new Float32Array([]),3)),e.setIndex(new ss(new Uint16Array([]),1)),e}var sP=rP().attributes,aP=class extends gs{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,sP),this.userData={parameters:e,type:"TextGeometry"};let n=t.getFont(e.font);n?.isLoaded?(this.font=n,this.update(e)):this.updateFont(e.font,t).then((()=>{this.update(e),t?.requestRender()}))}async updateFont(e,t){let n=t.getFont(e);n&&(this.font=n,await n.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!t?.isLoaded)return void console.warn("Cannot update text because its font is not loaded");let{width:n,height:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:a,text:o,textTransform:l}=e,c=NE.getDisplayedValue(o),h=function(e,t,n){let i=[""],r="";for(let s of n)r+=s," "===s||"\n"===s?(i[i.length-1]+=r,r="","\n"===s&&i.push("")):t.getTextWidth(i[i.length-1]+r,e)>e.width&&(i[i.length-1].length&&i.push(""),t.getTextWidth(i[i.length-1]+r,e)>e.width&&(1===r.length?(i[i.length-1]+=r,r=""):(i[i.length-1]+=r.slice(0,-1),r=r[r.length-1],i.push(""))));return i[i.length-1]+=r,i}(e,t,2===l?c.toUpperCase():3===l?c.toLowerCase():c),{shapes:u,charWidths:d,charCoords:p}=t.generateShapes(h,e),f=.5*("number"==typeof n?n:1),m=.5*("number"==typeof i?i:1),g=u.map((e=>(new b_).fromShape(e,!0)));this.vectorShapes=g;let v=g.map((e=>$_.create({shape:e,parameters:{depth:r,extrudeBevelSegments:a,extrudeBevelSize:s,windingRule:r<=0?h_.NONZERO:h_.ODD,subdivisions:this.isLowResolution&&r>0?1:12}}))),y=v.length?_C(v):rP();y.translate(-f,m,0),this.dispose(),this.wrappedText=h,this.charCoords=p,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(y.attributes).forEach((e=>{let[t,n]=e;this.setAttribute(t,n)})),this.setIndex(y.index),this.computeBoundingSphere()}clone(){let e=Dv(new gs,aP.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach((e=>{let[t,n]=e;this.setAttribute(t,n)})),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:{textValue:e}})}get text(){return this.userData.parameters.text??""}};var oP,lP,cP=new Promise((e=>{oP=e})),hP=!1;function uP(){if(!hP)return lP||(lP=async function(){let e=n.e(917).then(n.bind(n,30917)),[t,i]=await Promise.all([e,fetch("https://unpkg.com/@splinetool/modelling-wasm@1.9.87/build/process.wasm").then((e=>e.arrayBuffer()))]),r=t.default,s=await r({wasmBinary:i});oP(s),hP=!0}(),lP)}var dP=["font"];function pP(e,t,n,i){let r,s,a;"PathGeometry"===e.type?(s=JSON.parse(JSON.stringify(e)),a=[[],["extrusion"]]):(s={...e},a=[[]]);for(let c of a){let e=s;for(let t of c)e=e[t];for(r in e){let n=e[r];bx(n)&&!dP.includes(r)&&(e[r]=t.getVariable(n,[i.uuid,"geometry",...c,r]),bx(e[r])&&(e[r]=1))}}let o,l={parameters:s,type:s.type};if("PathGeometry"===s.type)l.path=s.path;else if("VectorGeometry"===s.type){let e=b_.createFromState(s.shape,s.width,s.height);l.shape=e}else if("NonParametricGeometry"===s.type){if(s.data.groups&&s.data.groups?.forEach((e=>e.materialIndex=Math.max(e.materialIndex??0,0))),l.geometry=(new tu).parse(s),0===l.geometry.groups.length){let e=l.geometry;e.addGroup(0,Math.max(e.getIndex()?.count??0,e.getAttribute("position").count),0)}}else{if("SubdivGeometry"===s.type){let t=new EP(s,n);return t.data=e,t}if("TextGeometry"===s.type)return new aP(s,t);if("InputGeometry"===s.type)return new aP(s,t);if("UIGeometry"===s.type)return kT.create({parameters:{width:s.width,height:s.height,cornerRadius:s.cornerRadius,cornerType:s.cornerType}})}try{o=qP(l)}catch(ax){console.error(ax)}if(!o){let e=b_.createFromState(zx.defaultData(),100,100);l.shape=e,o=qP(l)}return o}var fP=new vr;function mP(e,t,n,i){let r,s,a,o=e.position.array,l=e.normal.array,c=fP.makeScale(t,n,i).invert().elements;for(var h=0,u=o.length;h<u;h+=3)o[h]*=t,o[h+1]*=n,o[h+2]*=i,r=l[h],s=l[h+1],a=l[h+2],l[h]=c[0]*r+c[4]*s+c[8]*a,l[h+1]=c[1]*r+c[5]*s+c[9]*a,l[h+2]=c[2]*r+c[6]*s+c[10]*a;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var gP,vP=new Wi,yP=new ji;cP.then((e=>{gP=e}));var bP=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),wP=new Uint32Array([0,1,2,3]),xP=new Uint8Array([4]),EP=class extends gs{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let n=this.data.scaleBaked,i=Zw.div(t,n);this.subdividedGeometry&&mP(this.subdividedGeometry.attributes,...i),this.originalGeometry&&mP(this.originalGeometry.attributes,...i),this.data=e;let r=this.userData.parameters;this.userData.parameters={width:r.width*i[0],height:r.height*i[1],depth:r.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(yP.fromArray(i));let s=yP.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return 0===this.subdivPointer&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,n;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:n}=EP.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new Os(100,100,100),n=0}this.subdivPointer=n,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(EP.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;null===e.boundingSphere&&(e.boundingSphere=new lr,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,n=e.boundingSphere.center;vP.setFromBufferAttribute(t),vP.getCenter(n),e.boundingSphere.radius=n.distanceTo(vP.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),vP.getSize(yP);let i={width:yP.x,height:yP.y,depth:yP.z};return this.userData.parameters=i,i}static build(e,t,n,i){let r,s,a,o=e?.phongAngle??35;!1===n&&(o=-1),t&&(gP.free_bvh(t),gP.free_subdivision_surface(t));try{r=EP.allocate(e,i)}catch(l){console.error(l,e),r=EP.allocate({positionWASM:bP,indexWASM:wP,verticesPerFaceWASM:xP},i)}if(gP.set_destination_refinement_level(r,0),s=EP.buildLevel(r,!0,o),e.subdivisions>0)try{gP.set_destination_refinement_level(r,e.subdivisions),a=EP.buildLevel(r,!1,o)}catch{try{gP.set_destination_refinement_level(r,e.subdivisions-1),a=EP.buildLevel(r,!1,o)}catch{a=null}}else a=null;return{subdivPointer:r,originalGeometry:s,subdividedGeometry:a}}static primitiveToQuads(e,t,n){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),"DodecahedronGeometry"===e.type&&(e.detail=0);let i,r,s,a,o,l,c=void 0!==e.shape||void 0!==e.path?t.geometry:pP(e,n,!1);if(i="TorusGeometry"===e.type&&e.arc===2*Math.PI?c.getClosedTorusIndicesForBooleanOrSubdiv():c.getIndex(),({positions:r,triIndices:o}=AP(c.getAttribute("position"),i)),"CylinderGeometry"===e.type&&0===e.cornerRadius&&0===e.hollow&&!1===e.openEnded){let t=e.radialSegments*e.heightSegments*3*2;l=[t,t+3*e.radialSegments]}return({indices:s,verticesPerFace:a}=MP(r,o,c,l)),{positions:r,indices:s,verticesPerFace:a}}static allocate(e,t){let n,i,r,s=[],a=[];e.positionWASM&&e.positionWASM.length>0?(n=e.positionWASM,i=e.indexWASM,r=e.verticesPerFaceWASM):(n=bP,i=wP,r=xP);let o,l=n.length,c=i.length,h=r.length,u=n.length+s.length+a.length,d=i.length+r.length,p=u*Float32Array.BYTES_PER_ELEMENT+d*Uint32Array.BYTES_PER_ELEMENT,f=u*Float32Array.BYTES_PER_ELEMENT,m=(Uint32Array.BYTES_PER_ELEMENT,gP._malloc(p)),g=new Float32Array(gP.HEAPF32.buffer,m,u),v=new Uint32Array(gP.HEAPU32.buffer,m+f,d);g.set(n,0),g.set(s,n.length),g.set(a,n.length+s.length),v.set(i,0),v.set(r,i.length),e?.scaleBaked?.some((e=>1!==e))&&(o=(new vr).makeScale(...e.scaleBaked)),t&&(o?o.premultiply(t):o=t);let y=o?gP.alloc_subdivision_surface2(m,l,m+f,c,m+f+i.length*Uint32Array.BYTES_PER_ELEMENT,h,o.elements):gP.alloc_subdivision_surface(m,l,m+f,c,m+f+i.length*Uint32Array.BYTES_PER_ELEMENT,h);return gP._free(m),y}static buildLevel(e,t,n,i,r){let s=r?gP.get_mesh_data2(e,t?gP.Level.CONTROL:gP.Level.REFINED,n,r.elements):gP.get_mesh_data(e,t?gP.Level.CONTROL:gP.Level.REFINED,n),a=gP.HEAPU32.subarray(s>>2,8+(s>>2)),o=a.subarray(4,8),l=0,c=gP.HEAPU32[a[l]>>2],h=gP.HEAPF32.subarray(c>>2,(c>>2)+o[l]);l++;let u=gP.HEAPU32[a[l]>>2],d=gP.HEAPF32.subarray(u>>2,(u>>2)+o[l]);l++;let p=gP.HEAPU32[a[l]>>2],f=gP.HEAPU32.subarray(p>>2,(p>>2)+o[l]);l++;let m=gP.HEAPU32[a[l]>>2],g=gP.HEAPU32.subarray(m>>2,(m>>2)+o[l]);if(l++,void 0===i){let e=new gs;if(e.setIndex(new os(g,1)),e.setAttribute("position",new ls(h,3)),e.setAttribute("normal",new ls(d,3)),t){e.setAttribute("faceMap",new os(f,1));let t=new Float32Array(d.length/3*4).fill(0);e.setAttribute("color",new ss(t,4))}return gP.free_mesh_data(s),e.userData.type="SubdivGeometry",e}i.getAttribute("position").copyArray(h),i.getAttribute("normal").copyArray(d),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,gP.free_mesh_data(s)}static freeSubdivPointer(e){gP.free_bvh(e),gP.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,n){let i=gP.get_wireframe_data_for_base_level(e),r=gP.HEAPU32.subarray(i>>2,4+(i>>2)),s=r.subarray(2,4),a=0,o=gP.HEAPU32[r[a]>>2],l=gP.HEAPF32.subarray(o>>2,(o>>2)+s[a]);a++;let c=gP.HEAPU32[r[a]>>2],h=gP.HEAPU32.subarray(c>>2,(c>>2)+s[a]);if(void 0===t){let e=new gs;e.setAttribute("position",new ls(l,3));let t=new Float32Array(l.length);for(let i=0,r=l.length;i<r;)t[i++]=n.r,t[i++]=n.g,t[i++]=n.b;return e.setAttribute("color",new ss(t,3)),e.setIndex(new os(h,1)),gP.free_wireframe_data_for_base_level(i),e}t.getAttribute("position").copyArray(l),t.attributes.position.needsUpdate=!0,gP.free_wireframe_data_for_base_level(i)}static updateCollabMesh(e,t,n){let i=0===t;i||gP.set_destination_refinement_level(e,t);let r=n?gP.get_topological_data2(e,i?gP.Level.CONTROL:gP.Level.REFINED,n.elements):gP.get_topological_data(e,i?gP.Level.CONTROL:gP.Level.REFINED),s=gP.HEAPU32.subarray(r>>2,6+(r>>2)),a=s.subarray(3,6),o=0,l=gP.HEAPU32[s[o]>>2],c=new Float32Array(gP.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let h=gP.HEAPU32[s[o]>>2],u=new Uint32Array(gP.HEAPU32.subarray(h>>2,(h>>2)+a[o]));o++;let d=gP.HEAPU32[s[o]>>2],p=new Uint8Array(gP.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return gP.free_topological_data(r),{positions:c,indices:u,verticesPerFace:p}}},CP=["getX","getY","getZ"];function AP(e,t){let n={},i=t?t.count:e.count,r=0,s=[],a=[];for(let l=0;l<i;l++){let i=t?t.getX(l):l,o="";for(let t=0;t<3;t++)o+=~~(1e4*e[CP[t]](i))+",";if(o in n)s.push(n[o]);else{for(let t=0;t<3;t++)a.push(e[CP[t]](i));n[o]=r,s.push(r),r++}}let o=[];for(let l=0;l<s.length;l+=3)s[l]===s[l+1]||s[l]===s[l+2]||s[l+1]===s[l+2]||o.push(s[l],s[l+1],s[l+2]);return{positions:a,triIndices:o}}var SP=new ji,_P=new ji,TP=new ji,PP=new ji;function MP(e,t,n,i){let r=[],s=[];if(void 0!==n.userData.shape&&0===n.userData.parameters.depth&&0===n.userData.shape.shapeHoles.length){let t=n.userData.shape.extractShapePointsToFlatArray([]),i=n.userData.parameters.spikes;if("EllipseGeometry"===n.userData.type&&i<=24&&i%4===0&&n.userData.parameters.angle>=360){let e=t.length/2/i;t=t.filter(((t,n)=>Math.floor(n/2)%e===0))}let a=0;for(let e=0;e<t.length;e+=2)a+=(t[e]-t[(0===e?t.length:e)-2])*(t[e+1]+t[(0===e?t.length:e)-1]);e.length=0;let o=0;if(a<0)for(let n=0;n<t.length;n+=2)e.push(t[n],t[n+1],0),r.push(o++);else for(let n=t.length-2;n>=0;n-=2)e.push(t[n],t[n+1],0),r.push(o++);return s.push(o),{indices:r,verticesPerFace:s}}let a=new Float32Array([n.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(n.useNgonForTopBottomFaceDuringBake){let n=0;if((e[3*t[o]+2]===a||0===e[3*t[o]+2])&&n++,(e[3*t[o+1]+2]===a||0===e[3*t[o+1]+2])&&n++,(e[3*t[o+2]+2]===a||0===e[3*t[o+2]+2])&&n++,3===n)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){SP.set(e[3*t[o]],e[3*t[o]+1],e[3*t[o]+2]),_P.set(e[3*t[o+1]],e[3*t[o+1]+1],e[3*t[o+1]+2]),TP.set(e[3*t[o+4]],e[3*t[o+4]+1],e[3*t[o+4]+2]),PP.set(e[3*t[o+5]],e[3*t[o+5]+1],e[3*t[o+5]+2]),_P.sub(SP).normalize(),TP.sub(SP).normalize(),PP.sub(SP).normalize();let n=_P.cross(TP).dot(PP);Math.abs(n)>.005||i&&i.some(((e,t)=>t%2!==1&&(o>=i[t]&&o<i[t+1])))?(r.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(r.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else r.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3}if(n.useNgonForTopBottomFaceDuringBake){let t=[],i=[],o=0;for(let n=0,r=0;n<e.length;n+=3,r++)0===e[n+2]&&(t.push(r),o++),e[n+2]===a&&i.push(r);if(0===n.userData.parameters.extrudeBevelSize){let e=i[0];i[0]=i[1],i[1]=e}t.reverse(),r.push(...t,...i),s.push(o,o)}return{indices:r,verticesPerFace:s}}var NP={};((e,t)=>{for(var n in t)Ct(e,n,{get:t[n],enumerable:!0})})(NP,{calcBoolean:()=>FP,calcBooleanTopological:()=>zP,freeMeshSet:()=>WP,getMeshSet:()=>jP,hasOpenEdges:()=>VP,transformMeshSet:()=>HP});var IP,OP,DP,LP,RP=new Promise((e=>{IP=e}));function kP(){if(OP)return OP;return OP=async function(){let e=n.e(3516).then(n.bind(n,63516)),[t,i]=await Promise.all([e,fetch("https://unpkg.com/@splinetool/boolean-wasm@1.9.87/build/boolean.wasm").then((e=>e.arrayBuffer()))]),r=t.default,s=await r({wasmBinary:i});IP(s)}(),OP}function BP(e){let t=e.length,n=t*Uint32Array.BYTES_PER_ELEMENT,i=t*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(e[0])?n:i,s=DP._malloc(r);return(Number.isInteger(e[0])?new Uint32Array(DP.HEAPU32.buffer,s,t):new Float32Array(DP.HEAPF32.buffer,s,t)).set(e,0),s}function UP(e){switch(e){case 0:return DP.OP.UNION;case 1:return DP.OP.INTERSECTION;case 2:return DP.OP.A_MINUS_B;default:throw new Error("Unknown boolean operation "+e)}}function zP(e,t){void 0===LP&&(LP=DP.init_csg());let n=BP(e),i=DP.csg_calc_topological(LP,n,e.length,UP(t));DP._free(n);let r=DP.HEAPU32.subarray(i>>2,6+(i>>2)),s=r.subarray(3,6),a=0,o=DP.HEAPU32[r[a]>>2],l=new Float32Array(DP.HEAPF32.subarray(o>>2,(o>>2)+s[a]));a++;let c=DP.HEAPU32[r[a]>>2],h=new Uint32Array(DP.HEAPU32.subarray(c>>2,(c>>2)+s[a]));a++;let u=DP.HEAPU32[r[a]>>2],d=new Uint8Array(DP.HEAPU32.subarray(u>>2,(u>>2)+s[a]));return DP.free_mesh_data(i),{positions:l,indices:h,verticesPerFace:d}}function FP(e,t,n,i){void 0===LP&&(LP=DP.init_csg());let r=BP(e),s=DP.csg_calc(LP,r,e.length,i,UP(t));DP._free(r);let a=DP.HEAPU32.subarray(s>>2,5+(s>>2)),o=a.subarray(2,5),l=0,c=DP.HEAPU32[a[l]>>2],h=DP.HEAPF32.subarray(c>>2,(c>>2)+o[l]);l++;let u=DP.HEAPU32[a[l]>>2],d=DP.HEAPF32.subarray(u>>2,(u>>2)+o[l]);l++;let p=o[l];n.setAttribute("position",new ls(h,3)),n.setAttribute("normal",new ls(d,3));let f=DP.HEAPF32.subarray(5+(s>>2),5+(s>>2)+6);return null===n.boundingSphere&&(n.boundingSphere=new lr),n.boundingSphere.center.set(f[0],f[1],f[2]),n.boundingSphere.radius=(f[3]**2+f[4]**2+f[5]**2)**.5,n.userData.parameters={width:2*f[3],height:2*f[4],depth:2*f[5]},DP.free_mesh_data(s),p}function jP(e,t,n){if(void 0===DP)return-1;let i,r,s;if(t&&void 0!==e.userData.positions){let t=e.userData;s=t.verticesPerFace.length,i=t.positions,r=Array(t.verticesPerFace.reduce(((e,t)=>e+t),0)+s);for(let e=0,n=0,i=0;e<t.verticesPerFace.length;e++){r[i++]=t.verticesPerFace[e];for(let s=0;s<t.verticesPerFace[e];s++)r[i++]=t.indices[n++]}}else({positions:i,faceIndices:r,nFaces:s}=function(e,t,n){let i,r;r="TorusGeometry"===e.userData.parameters.type&&e.userData.parameters.arc===2*Math.PI?e.getClosedTorusIndicesForBooleanOrSubdiv():e.getIndex();let s,{positions:a,triIndices:o}=AP(e.getAttribute("position"),r);if(t&&n){let{indices:t,verticesPerFace:n}=MP(a,o,e);s=n.length,i=[];for(let e=0,r=0;e<s;e++){i.push(n[e]);for(let s=0;s<n[e];s++)i.push(t[r++])}}else{let e=o.length;i=Array(e+e/3),s=0;for(let t=0,n=0;n<i.length;)i[n++]=3,s++,i[n++]=o[t++],i[n++]=o[t++],i[n++]=o[t++]}return{positions:a,faceIndices:i,nFaces:s}}(e,t,n));let a=i.length,o=r.length,l=i.length,c=r.length,h=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,u=l*Float32Array.BYTES_PER_ELEMENT,d=(Uint32Array.BYTES_PER_ELEMENT,DP._malloc(h)),p=new Float32Array(DP.HEAPF32.buffer,d,l),f=new Uint32Array(DP.HEAPU32.buffer,d+u,c);p.set(i,0),f.set(r,0);let m=DP.get_csg_mesh(d,a,d+u,o,s);return DP._free(d),m}function VP(e){return DP.has_open_edges(e)}function HP(e,t){DP.transform_csg_mesh(e,t.elements)}function WP(e){DP.free_csg_mesh(e)}RP.then((e=>DP=e));var GP={ConeGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return n.thetaLength=ui.clamp(n.thetaLength,0,360),{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(e){let t,{width:n,depth:i,height:r,radialSegments:s,heightSegments:a,openEnded:o,thetaStart:l,thetaLength:c,cornerRadiusTop:h,cornerRadiusBottom:u,cornerSegments:d}=e.parameters;return 0===c?(t=new gs,t.setAttribute("position",new ls([],3))):t=h>0||u>0||c<360?new OS(0,n/2,r,s,a,o,l,c*Math.PI/180,h,u,d,0,!0):new Tc(n/2,r,s,a,o),t.scale(1,1,i/n),Object.assign(t,{userData:{...e,type:"ConeGeometry"}})}},CubeGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(e){let t,{width:n,height:i,depth:r,widthSegments:s,heightSegments:a,depthSegments:o,cornerRadius:l,cornerSegments:c}=e.parameters;return t=0===l?new Os(n,i,r,s,a,o):new LS(n,i,r,s,a,o,l,c),Object.assign(t,{userData:{...e,type:"CubeGeometry"}})}},CylinderGeometry:MS,DodecahedronGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(e){let{width:t,height:n,depth:i,detail:r,corner:s,cornerSides:a}=e.parameters,o=0===r&&0!==s?new kS(.5*t,s,a):new Mc(.5*t,r);return o.scale(1,n/t,i/t),Object.assign(o,{userData:{...e,type:"DodecahedronGeometry"}})}},EllipseGeometry:tT,HelixGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),i=Math.abs(n.width),r=Math.abs(n.height??i),s=Math.abs(n.depth??i),a=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(n,{width:i,height:r,depth:s,radius:a,segments:Math.round(n.segments),pathSegments:Math.round(n.pathSegments),cornerSegments:Math.round(n.cornerSegments)})}}static build(e){let{width:t,height:n,depth:i,radius:r,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:c,cornerRadius:h,cornerSegments:u}=e.parameters,d=new cT(!1,t,n,i,r,s,a,o,l,c,h,u);return Object.assign(d,{userData:{...e,type:"HelixGeometry"}})}},IcosahedronGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(e){let{width:t,height:n,depth:i,detail:r,corner:s,cornerSides:a}=e.parameters,o=0===r&&0!==s?new hT(.5*t,s,a):new sh(.5*t,r);return o.scale(1,n/t,i/t),Object.assign(o,{userData:{...e,type:"IcosahedronGeometry"}})}},LatheGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){(e.parameters?.points??[]).forEach((e=>{Array.isArray(e)&&(e.x=e[0],e.y=e[1])}));let n=Object.assign({},t?.parameters??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(e){let{points:t,segments:n,verticalSegments:i}=e.parameters,r=new Nc;r.moveTo(t[0].x,t[0].y),r.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new Sc(r.extractPoints(i).shape,n);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...e,type:"LatheGeometry"}})}},NonParametricGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n,i=e.geometry??t?.geometry??(new gs).copy(new Os(100,100,100));void 0===t?(i.computeBoundingBox(),i.boundingBox.getSize(NT),n={width:NT.x,height:NT.y,depth:NT.z,subdivisions:0}):n=t.parameters;let r={...n,...e.parameters};return{parameters:{width:Math.abs(r.width),height:Math.abs(r.height),depth:Math.abs(r.depth),subdivisions:Math.abs(r.subdivisions)},geometry:i}}static build(e){let{width:t,height:n,depth:i,subdivisions:r}=e.parameters,s=e.geometry??(new gs).copy(new Os(100,100,100)),a=s.userData.parameters;void 0===a?(s.computeBoundingBox(),s.boundingBox.getSize(NT)):NT.set(a.width,a.height,a.depth),(t!==NT.x||n!==NT.y||i!==NT.z)&&s.scale(0===NT.x?1:t/NT.x,0===NT.y?1:n/NT.y,0===NT.z?1:i/NT.z);let o=s.originalGeometry;try{r>0?(void 0===o||a?.subdivisions!==r)&&(void 0===o&&(o=s),s=new MT(r).modify(o).toBufferGeometry()):(void 0!==o&&(s=o),o=void 0,void 0===s.getAttribute("normal")&&s.computeVertexNormals())}catch{void 0!==o&&(s=o),o=void 0,void 0===s.getAttribute("normal")&&s.computeVertexNormals()}return void 0!==o&&Object.assign(s,{originalGeometry:o}),delete e.geometry,Object.assign(s,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,n){new tu(n).load(e,(e=>{let n=this.normalizeInputs({geometry:e});e.boundingBox.getSize(NT);let i=100/NT.x;Object.assign(n.parameters,{width:100,height:NT.y*i,depth:NT.z*i}),t(this.build(n))}))}},PolygonGeometry:IT,PyramidGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(e){let{width:t,height:n,depth:i,radialSegments:r,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=new RT(.5*t,n,r,s,a,o,l);return c.scale(1,1,i/t),Object.assign(c,{userData:{...e,type:"PyramidGeometry"}})}},RectangleGeometry:kT,SphereGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return n.thetaLength=ui.clamp(n.thetaLength,0,180),{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(e){let t,{width:n=100,height:i=n,depth:r=n,widthSegments:s=64,heightSegments:a=64,phiStart:o,phiLength:l,thetaStart:c,thetaLength:h}=e.parameters;return 0===h?(t=new gs,t.setAttribute("position",new ls([],3))):t=new ah(.5*n,s,a,o,l,c,h*ui.DEG2RAD),t.scale(1,i/n,r/n),Object.assign(t,{userData:{...e,type:"SphereGeometry"}})}},PlaneGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:0})}}static build(e){let{width:t=100,height:n=t,widthSegments:i=8,heightSegments:r=8}=e.parameters,s=new $s(t,n,i,r);return s.scale(1,1,1),Object.assign(s,{userData:{...e,type:"PlaneGeometry"}})}},BackdropGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(e){let{width:t,height:n,depth:i,angle:r,cornerRadius:s,cornerSegments:a}=e.parameters,o=new BT(t,n,i,r,s,a);return Object.assign(o,{userData:{...e,type:"BackdropGeometry"}})}},StarGeometry:UT,TextFrameGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,depth:0},e.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(e){let{width:t,height:n}=e.parameters,i=new $s(t,n);return Object.assign(i,{userData:{...e,type:"TextFrameGeometry"}})}},TorusGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width);n.shapeBlendNode&&(r=i);let s=Math.round(Math.abs(n.depth??.25*n.width));return{parameters:Object.assign(n,{width:i,height:r,depth:s})}}static build(e){let{width:t,height:n,depth:i,radialSegments:r,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=function(e,t,n,i,r,s,a,o,l,c,h){[t,n]=[n,t],a=t/2;let u=ui.clamp(r/360,0,1);if(0===u){let e=new gs;return e.setAttribute("position",new ls([],3)),e}return 1===u&&(c=0),new cT(!0,e,t,n,i,u,s,a,o,l,c,h)}(t,n,i,.5*t,a,s,0,0,r,o,l);return c.scale(1,n/t,1),Object.assign(c,{userData:{...e,type:"TorusGeometry"}})}},TorusKnotGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),tube:n.tube??.125*n.width})}}static build(e){let{width:t,tube:n,tubularSegments:i,radialSegments:r,p:s,q:a}=e.parameters,o=.5*t;o!==n&&(o-=n);let l=new lh(o,n,i,r,s,a);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},TriangleGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof b_?e.shape:new b_,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width*(n.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(n.depth??0)})}}static build(e){let{width:t=100,height:n,cornerRadius:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,c=.5*t,h=.5*n;o?(l.addPoint(l.createPoint(-c,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))):(l.addPoint(l.createPoint(0,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))),l.isClosed=!0;for(let d=0,p=l.points.length;d<p;d++)l.points[d].roundness=i;l.roundness=i,l.update();let u=$_.create({shape:l,parameters:{roundness:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(u,{userData:{...e,type:"TriangleGeometry"}})}},PathGeometry:class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let n=Object.assign({},t?.parameters??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.abs(n.depth??0),a=t?.shapeData??tT.create({parameters:Wx}).userData.shape;return{path:e.path??Fx.defaultData(),parameters:Object.assign(n,{width:i,height:r,depth:s,extrusion:{...Yx,...n.extrusion}}),shapeData:a}}static build(e){if(e.path.points.length>=2){let t=new iP(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}return Object.assign(new gs,{userData:{...e,type:"PathGeometry"}})}},VectorGeometry:$_},qP=e=>GP[e.type].create(e);function KP(e){return null!==e&&"booleanOp"in e}var YP=class extends(PS(Ns)){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new vr}updateVisible(e){super.updateVisible(e),this.visible=!KP(this.parent)&&this.visible,KP(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){-1!==this.booleanMeshSetAddress&&(NP.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.booleanWasTransformed=!0:this.freeBooleanPointer(),KP(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof YP&&(e.freeBooleanPointer(),KP(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let n=super.updateTransformState(e,t);return n&&KP(this.parent)&&this.invalidateDownstreamBooleanData(!0),n}onVariableUpdate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super.onVariableUpdate(e),KP(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},QP=new Wi;function XP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.count,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,h=-1/0;for(let u=t;u<n;u++){let t=e.getX(u),n=e.getY(u),i=e.getZ(u);t<s&&(s=t),n<a&&(a=n),i<o&&(o=i),t>l&&(l=t),n>c&&(c=n),i>h&&(h=i)}QP.min.set(s,a,o),QP.max.set(l,c,h),QP.getCenter(i),QP.getSize(r).multiplyScalar(.5)}var ZP=new gs,JP=new ns,$P=class extends YP{constructor(e,t){super(ZP,JP),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let n=this.geometry.getAttribute("position");void 0!==n?XP(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,e,t):super.updateEntityBoxSize(e,t)}},eM=class{constructor(e){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},null===eM.uuidContext)throw new Error("plz startContext");eM.uuidContext===eM.globalContext?this.uuid="_gid"+eM.uuidContext.nodeContextUuid++:this.uuid="_uid"+eM.uuidContext.nodeContextUuid++,this.type=e,this.name=""}static startContext(e){null===this.uuidContext||this.uuidContext===eM.globalContext?this.uuidContext=e:console.error("Can't start context twice")}static endContext(e){this.uuidContext!==e&&console.error("Can't end context twice"),this.uuidContext=null}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,n){return n=n??{},this.analyze(e,n),this.flow(e,t,n)}flow(e,t,n){n=n??{},e.addFlow(n.slot,n.cache,n.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,n){t=t??this.getType(e,t);let i=e.getNodeData(n??this);return e.analyzing&&this.appendDepsNode(e,i,t),-1===e.nodes.indexOf(this)&&e.nodes.push(this),void 0!==this.updateFrame&&-1===e.updaters.indexOf(this)&&e.updaters.push(this),this.generate(e,t,n)}updateFrame(e){}generateReadonly(e,t,n,i,r,s){return""}generate(e,t,n,i,r){return""}parse(e,t,n,i){}appendDepsNode(e,t,n){t.deps=(t.deps||0)+1;let i=e.getTypeLength(n);(i>(t.outputMax||0)||this.getType(e,n))&&(t.outputMax=i,t.output=n)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return"sampler2D"===t||"samplerCube"===t?t:this.type}},tM=eM;tM.globalContext={nodeContextUuid:0},tM.uuidContext=eM.globalContext;var nM=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},iM=new class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,n){n=void 0===n||n,this.keywords[e]={callback:t,cache:n}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return void 0!==this.nodes[e]}containsKeyword(e){return void 0!==this.keywords[e]}},rM=class extends tM{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=void 0===t.shared||t.shared,this.unique=void 0!==t.unique&&t.unique}build(e,t,n,i){if(t=t??this.getType(e),this.getShared(e,t)){let r=this.getUnique(e,t);r&&void 0===this.uuid&&(this.uuid=ui.generateUUID()),n=e.getUUID(n??this.getUUID(),!r);let s=e.getNodeData(n),a=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,n)):super.build(e,t,n);if(r)return s.name=s.name||super.build(e,t,n),s.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||1===s.deps))return super.build(e,t,n);n=this.getUUID(!1);let o=this.getTemp(e,n);if(o)return e.format(o,a,t);{o=super.generate(e,t,n,s.output,i);let r=this.generate(e,a,n);return e.addNodeCode(o+" = "+r+";"),e.format(o,a,t)}}return super.build(e,t,n)}getShared(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return"string"==typeof this.scope&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let n=e.getVars()[t];return n?n.name:void 0}generate(e,t,n,i,r){return this.getShared(e,t)||console.error("TempNode is not shared"),n=n??this.uuid,e.getTempVar(n,i??this.getType(e),r,this.getLabel()).name}},sM=class extends rM{constructor(e,t){(t=t??{}).shared=void 0!==t.shared&&t.shared,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,n,i,r,s){n=e.getUUID(n??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(n);return this.getReadonly()&&void 0!==this.generateReadonly?this.generateReadonly(e,t,n,i,r,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,r,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,r,s,this.getLabel())),e.format(a.fragment.name,i,t))}},aM=class extends sM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;super("v2"),this.nodeType="Vector2",this.value=e instanceof di?e:new di(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,n,i,r,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}},oM=class extends sM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;super("v3"),this.nodeType="Vector3",this.value=e instanceof ji?e:new ji(e,t,n)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,n,i,r,s){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,t)}},lM=class extends Mi{constructor(e,t,n,i){super(e,t,n),this.isColorA=!0,this.a=i}setRGBA(e,t,n,i){super.setRGB(e,t,n),this.a=i}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(e){return super.equals(e)&&this.a===e.a}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"srgb";if("transparent"===e)return this.setRGBA(0,0,0,0),this;if(t=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let i,r=t[1],s=t[2];switch(r){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a="rgba"===r?parseFloat(i[4]):1,super.setStyle(e,n);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a="hsla"===r?parseFloat(i[4]):1,super.setStyle(e,n)}}return super.setStyle(e,n)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},cM=class extends sM{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof lM?e:new lM(e.r,e.g,e.b,e.a)}generateReadonly(e,t,n,i,r,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,t)}},hM=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,uM=/[a-z_0-9]+/gi,dM=class extends rM{constructor(e,t,n,i,r){super(r),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=void 0===r,this.isInterface=!1,this.parse(e,t,n,i)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,n,i,r){let s,a=0,o=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;s=uM.exec(this.src);)l.push(s);for(let c=0;c<l.length;c++){let t=l[c],n=t[0],i=!this.isMethod||!this.getInputByName(n),r=n;if(this.keywords[n]||this.useKeywords&&i&&iM.containsKeyword(n)){let t=this.keywords[n];if(!t){let i=iM.getKeywordData(n);i.cache&&(t=e.keywords[n]),t=t||iM.getKeyword(n,e),i.cache&&(e.keywords[n]=t)}r=t.build(e)}n!==r&&"."!==o[t.index+a-1]&&(o=o.substring(0,t.index+a)+r+o.substring(t.index+n.length+a),a+=r.length-n.length),void 0===this.getIncludeByName(r)&&iM.contains(r)&&e.include(iM.get(r))}return"source"===t?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,n,i){if(this.src=e||"",this.includes=t??[],this.extensions=n??{},this.keywords=i??{},this.isMethod){let e=hM.exec(this.src);if(this.inputs=[],e&&4==e.length){this.type=e[1],this.name=e[2];let t=e[3].match(uM);if(t){let e=0;for(;e<t.length;){let n,i=t[e++];"in"===i||"out"===i||"inout"===i?n=t[e++]:(n=i,i="");let r=t[e++];this.inputs.push({name:r,type:n,qualifier:i})}}this.isInterface=-1===this.src.indexOf("{")}else this.type="",this.name=""}}},pM=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,fM=class extends rM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||fM.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,n,i,r){this.src=e||"";let s,a,o="",l=pM.exec(e);this.useDefine=r??"#"===this.src.charAt(0),l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if("source"===t){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,n,i,r){return e.format(this.name,this.getType(e),t)}},mM=fM;mM.PI="PI",mM.PI2="PI2",mM.RECIPROCAL_PI="RECIPROCAL_PI",mM.RECIPROCAL_PI2="RECIPROCAL_PI2",mM.LOG2="LOG2",mM.EPSILON="EPSILON";var gM=new RegExp("^structs*([a-z_0-9]+)s*{s*((.|\n)*?)}","gim"),vM=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),yM=class extends rM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,n,i,r){return"source"===t?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.src=e,this.inputs=[];let t=gM.exec(e);if(t){let e,n=t[2];for(;e=vM.exec(n);)this.inputs.push({type:e[1],name:e[2]});this.name=t[1]}else this.name="";this.type=this.name}},bM=class extends rM{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let n=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+n:"vUv"+n;return e.format(i,this.getType(e),t)}};iM.addKeyword("uv",(function(){return new bM})),iM.addKeyword("uv2",(function(){return new bM(1)}));var wM=class extends rM{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??wM.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case Vn:return["Linear"];case Hn:return["sRGB"];default:return[]}}generate(e,t){let n=this.input.build(e,"v4"),i=this.getType(e),r=wM.Nodes[this.method],s=e.include(r);if(s===wM.LINEAR_TO_LINEAR)return e.format(n,i,t);if(2===r.inputs?.length){let r=this.factor.build(e,"f");return e.format(s+"( "+n+", "+r+" )",i,t)}return e.format(s+"( "+n+" )",i,t)}fromEncoding(e){let t=wM.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=wM.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},xM=wM;xM.Nodes={LinearToLinear:new dM(["vec4 LinearToLinear( in vec4 value ) {","\treturn value;","}"].join("\n")),sRGBToLinear:new dM(["vec4 sRGBToLinear( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join("\n")),LinearTosRGB:new dM(["vec4 LinearTosRGB( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join("\n"))},xM.LINEAR_TO_LINEAR="LinearToLinear",xM.SRGB_TO_LINEAR="sRGBToLinear",xM.LINEAR_TO_SRGB="LinearTosRGB";var EM=class extends dM{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",arguments.length>4?arguments[4]:void 0,arguments.length>3?arguments[3]:void 0,arguments.length>2?arguments[2]:void 0,arguments.length>1?arguments[1]:void 0),this.nodeType="Expression"}},CM=class extends sM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ri,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new bM,this.bias=n,this.project=void 0!==i&&i}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if("sampler2D"===t)return this.getTexture(e,t);let n,i,r=this.getTexture(e,t),s=this.uv.build(e,this.project?"v4":"v2"),a=this.bias?this.bias.build(e,"f"):void 0;void 0===a&&e.context.bias&&(a=e.context.bias.setTexture(this).build(e,"f")),n=this.project?"texture2DProj":a?"tex2DBias":"tex2D",i=a?n+"( "+r+", "+s+", "+a+" )":n+"( "+r+", "+s+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new xM(new EM("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(i),i=this.colorSpace.build(e,l),e.removeContext(),e.format(i,l,t)}},AM=class extends sM{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,n,i,r,s){return e.format(this.value+(this.value%1?"":".0"),i,t)}},SM=class extends rM{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,n,i,r){i=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let t=0;t<s.inputs.length;t++){let n=s.inputs[t],i=this.inputs[t]||this.inputs[n.name];o.push(i.build(e,e.getTypeByFormat(n.type)))}a+=o.join(", ")+" )"}return e.format(a,i,t)}},_M=class extends rM{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_M.ADD;super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=n}getType(e){let t=this.a.getType(e),n=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(n)>e.getTypeLength(t)?n:t}generate(e,t){let n=this.getType(e);this.type=n;let i=this.a.build(e,n),r=this.b.build(e,n);return e.format("( "+i+" "+this.op+" "+r+" )",n,t)}},TM=_M;TM.ADD="+",TM.SUB="-",TM.MUL="*",TM.DIV="/";var PM=class extends rM{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:PM.ABS,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;super(),this.nodeType="Math",this.a=e,"string"!=typeof t?this.b=t:i=t,"string"!=typeof n?this.c=n:i=n,this.method=i,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case PM.MIX:case PM.CLAMP:case PM.REFRACT:case PM.SMOOTHSTEP:case PM.FACEFORWARD:return 3;case PM.MIN:case PM.MAX:case PM.MOD:case PM.STEP:case PM.REFLECT:case PM.DISTANCE:case PM.DOT:case PM.CROSS:case PM.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),n=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>n&&t>i?this.a.getType(e):n>i?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case PM.LENGTH:case PM.DISTANCE:case PM.DOT:return"f";case PM.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let n,i,r,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case PM.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case PM.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case PM.CROSS:n=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case PM.STEP:n=this.a.build(e,1===s?"f":l),i=this.b.build(e,l);break;case PM.MIN:case PM.MAX:case PM.MOD:n=this.a.build(e,l),i=this.b.build(e,1===a?"f":l);break;case PM.REFRACT:n=this.a.build(e,l),i=this.b.build(e,l),r=this.c.build(e,"f");break;case PM.MIX:n=this.a.build(e,l),i=this.b.build(e,l),r=this.c.build(e,1===o?"f":l);break;default:n=this.a.build(e,l),this.b&&(i=this.b.build(e,l)),this.c&&(r=this.c.build(e,l))}let h=[];h.push(n),i&&h.push(i),r&&h.push(r);let u=this.getNumInputs(e);if(h.length!==u)throw Error(`Arguments not match used in "${this.method}". Require ${u}, currently ${h.length}.`);return e.format(this.method+"( "+h.join(", ")+" )",c,t)}},MM=PM;MM.RAD="radians",MM.DEG="degrees",MM.EXP="exp",MM.EXP2="exp2",MM.LOG="log",MM.LOG2="log2",MM.SQRT="sqrt",MM.INV_SQRT="inversesqrt",MM.FLOOR="floor",MM.CEIL="ceil",MM.NORMALIZE="normalize",MM.FRACT="fract",MM.SATURATE="saturate",MM.SIN="sin",MM.COS="cos",MM.TAN="tan",MM.ASIN="asin",MM.ACOS="acos",MM.ARCTAN="atan",MM.ABS="abs",MM.SIGN="sign",MM.LENGTH="length",MM.NEGATE="negate",MM.INVERT="invert",MM.MIN="min",MM.MAX="max",MM.MOD="mod",MM.STEP="step",MM.REFLECT="reflect",MM.DISTANCE="distance",MM.DOT="dot",MM.CROSS="cross",MM.POW="pow",MM.MIX="mix",MM.CLAMP="clamp",MM.REFRACT="refract",MM.SMOOTHSTEP="smoothstep",MM.FACEFORWARD="faceforward";var NM=class extends rM{constructor(e,t,n){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=n}bilinearCubeUV(e,t,n,i){let r=new SM(NM.Nodes.bilinearCubeUV,[t,n,i]);this.colorSpaceTL=this.colorSpaceTL??new xM(new EM("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(r.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new xM(new EM("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(r.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new xM(new EM("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(r.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new xM(new EM("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(r.build(e)+".br");let s={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(s),this.colorSpaceTLExp=new EM(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new EM(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new EM(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new EM(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let a=new EM("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return a.keywords.cubeUV_TL=this.colorSpaceTLExp,a.keywords.cubeUV_TR=this.colorSpaceTRExp,a.keywords.cubeUV_BL=this.colorSpaceBLExp,a.keywords.cubeUV_BR=this.colorSpaceBRExp,a.keywords.cubeUV=r,a}generate(e,t){if(e.isShader("fragment")){let n=this.uv,i=this.bias||e.context.roughness,r=new SM(NM.Nodes.roughnessToMip,[i]),s=new MM(r,NM.Nodes.m0,NM.Nodes.cubeUV_maxMipLevel,MM.CLAMP),a=new MM(s,MM.FLOOR),o=new MM(s,MM.FRACT),l=this.bilinearCubeUV(e,this.value,n,a),c=this.bilinearCubeUV(e,this.value,n,new TM(a,new AM(1).setReadonly(!0),TM.ADD)),h=new MM(l,c,o,MM.MIX);return e.format(h.build(e),"v4",t)}return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},IM=NM;IM.Nodes=function(){let e=new yM("struct TextureCubeUVData {\n\t\t\tvec4 tl;\n\t\t\tvec4 tr;\n\t\t\tvec4 br;\n\t\t\tvec4 bl;\n\t\t\tvec2 f;\n\t\t}"),t=new mM("float cubeUV_maxMipLevel 8.0",!0),n=new mM("float cubeUV_minMipLevel 4.0",!0),i=new mM("float cubeUV_maxTileSize 256.0",!0),r=new mM("float cubeUV_minTileSize 16.0",!0),s=new dM("float getFace(vec3 direction) {\n\t\t\t\tvec3 absDirection = abs(direction);\n\t\t\t\tfloat face = -1.0;\n\t\t\t\tif (absDirection.x > absDirection.z) {\n\t\t\t\t\tif (absDirection.x > absDirection.y)\n\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t} else {\n\t\t\t\t\tif (absDirection.z > absDirection.y)\n\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t}\n\t\t\t\treturn face;\n\t\t}");s.useKeywords=!1;let a=new dM("vec2 getUV(vec3 direction, float face) {\n\t\t\t\tvec2 uv;\n\t\t\t\tif (face == 0.0) {\n\t\t\t\t\tuv = vec2(direction.z, direction.y) / abs(direction.x); // pos x\n\t\t\t\t} else if (face == 1.0) {\n\t\t\t\t\tuv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y\n\t\t\t\t} else if (face == 2.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z\n\t\t\t\t} else if (face == 3.0) {\n\t\t\t\t\tuv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x\n\t\t\t\t} else if (face == 4.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y\n\t\t\t\t} else {\n\t\t\t\t\tuv = vec2(direction.x, direction.y) / abs(direction.z); // neg z\n\t\t\t\t}\n\t\t\t\treturn 0.5 * (uv + 1.0);\n\t\t}");a.useKeywords=!1;let o=new dM("TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n\t\t\tfloat face = getFace(direction);\n\t\t\tfloat filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n\t\t\tmipInt = max(mipInt, cubeUV_minMipLevel);\n\t\t\tfloat faceSize = exp2(mipInt);\n\t\t\tfloat texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\t\t\tvec2 uv = getUV(direction, face) * (faceSize - 1.0);\n\t\t\tvec2 f = fract(uv);\n\t\t\tuv += 0.5 - f;\n\t\t\tif (face > 2.0) {\n\t\t\t\tuv.y += faceSize;\n\t\t\t\tface -= 3.0;\n\t\t\t}\n\t\t\tuv.x += face * faceSize;\n\t\t\tif(mipInt < cubeUV_maxMipLevel){\n\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t\t}\n\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\t\tuv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n\t\t\tuv *= texelSize;\n\t\t\tvec4 tl = texture2D(envMap, uv);\n\t\t\tuv.x += texelSize;\n\t\t\tvec4 tr = texture2D(envMap, uv);\n\t\t\tuv.y += texelSize;\n\t\t\tvec4 br = texture2D(envMap, uv);\n\t\t\tuv.x -= texelSize;\n\t\t\tvec4 bl = texture2D(envMap, uv);\n\t\t\treturn TextureCubeUVData( tl, tr, br, bl, f );\n\t\t}",[e,s,a,t,n,i,r]);o.useKeywords=!1;let l=new mM("float r0 1.0",!0),c=new mM("float v0 0.339",!0),h=new mM("float m0 -2.0",!0),u=new mM("float r1 0.8",!0),d=new mM("float v1 0.276",!0),p=new mM("float m1 -1.0",!0),f=new mM("float r4 0.4",!0),m=new mM("float v4 0.046",!0),g=new mM("float m4 2.0",!0),v=new mM("float r5 0.305",!0),y=new mM("float v5 0.016",!0),b=new mM("float m5 3.0",!0),w=new mM("float r6 0.21",!0),x=new mM("float v6 0.0038",!0),E=new mM("float m6 4.0",!0);return{bilinearCubeUV:o,roughnessToMip:new dM("float roughnessToMip(float roughness) {\n\t\t\tfloat mip = 0.0;\n\t\t\tif (roughness >= r1) {\n\t\t\t\tmip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n\t\t\t} else if (roughness >= r4) {\n\t\t\t\tmip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n\t\t\t} else if (roughness >= r5) {\n\t\t\t\tmip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n\t\t\t} else if (roughness >= r6) {\n\t\t\t\tmip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n\t\t\t} else {\n\t\t\t\tmip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\n\t\t\t}\n\t\t\treturn mip;\n\t\t}",[l,c,h,u,d,p,f,m,g,v,y,b,w,x,E]),m0:h,cubeUV_maxMipLevel:t}}();var OM=class extends rM{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??OM.VIEW}getShared(){return this.scope===OM.WORLD}build(e,t,n,i){let r=e.context[this.scope+"Normal"];return r?r.build(e,t,n,i):super.build(e,t,n)}generate(e,t,n,i,r){let s;switch(this.scope){case OM.VIEW:s=e.isShader("vertex")?"transformedNormal":"geometryNormal";break;case OM.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case OM.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal")}return e.format(s,this.getType(e),t)}},DM=OM;DM.LOCAL="local",DM.WORLD="world",DM.VIEW="view",DM.NORMAL="normal",iM.addKeyword("viewNormal",(function(){return new DM(DM.VIEW)})),iM.addKeyword("localNormal",(function(){return new DM(DM.NORMAL)})),iM.addKeyword("worldNormal",(function(){return new DM(DM.WORLD)}));var LM=class extends rM{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??LM.LOCAL}getType(){return this.scope===LM.PROJECTION?"v4":this.type}getShader(){switch(this.scope){case LM.LOCAL:case LM.WORLD:return!1}return!0}generate(e,t,n,i,r){let s;switch(this.scope){case LM.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case LM.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case LM.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case LM.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return e.format(s,this.getType(),t)}},RM=LM;RM.LOCAL="local",RM.WORLD="world",RM.VIEW="view",RM.PROJECTION="projection",iM.addKeyword("position",(function(){return new RM})),iM.addKeyword("worldPosition",(function(){return new RM(RM.WORLD)})),iM.addKeyword("viewPosition",(function(){return new RM(RM.VIEW)}));var kM=class extends rM{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??kM.CUBE}getUnique(e){return!e.context.viewNormal}getType(){return this.scope===kM.SPHERE?"v2":this.type}generate(e,t){let n=this.getUnique(e);if(e.isShader("fragment")){let i;switch(this.scope){case kM.VECTOR:{let t=new DM(DM.VIEW),r=e.context.roughness,s=t.build(e,"v3"),a=new RM(RM.VIEW).build(e,"v3"),o=r?r.build(e,"f"):void 0,l=`reflect( -normalize( ${a} ), ${s} )`;o&&(l=`normalize( mix( ${l}, ${s}, ${o} * ${o} ) )`);let c=`inverseTransformDirection( ${l}, viewMatrix )`;n?(e.addNodeCode(`vec3 reflectVec = ${c};`),i="reflectVec"):i=c;break}case kM.CUBE:{let t=new kM(kM.VECTOR).build(e,"v3"),r="vec3( -"+t+".x, "+t+".yz )";n?(e.addNodeCode(`vec3 reflectCubeVec = ${r};`),i="reflectCubeVec"):i=r;break}case kM.SPHERE:{let t="normalize( ( viewMatrix * vec4( "+new kM(kM.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";n?(e.addNodeCode(`vec2 reflectSphereVec = ${t};`),i="reflectSphereVec"):i=t;break}}return e.format(i,this.getType(),t)}return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},BM=kM;BM.CUBE="cube",BM.SPHERE="sphere",BM.VECTOR="vector";var UM=class extends rM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new CM,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new IM(this.value,t??new BM(BM.VECTOR),n),this.irradianceNode=new IM(this.value,new DM(DM.WORLD),new AM(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),("irradiance"===e.slot?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},zM=class extends sM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Vs,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new BM,this.bias=n}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){if("samplerCube"===t)return this.getTexture(e,t);let n,i=this.getTexture(e,t),r=this.uv?.build(e,"v3"),s=this.bias?this.bias.build(e,"f"):void 0;void 0===s&&e.context.bias&&(s=e.context.bias.setTexture(this).build(e,"f")),n=s?"texCubeBias( "+i+", "+r+", "+s+" )":"texCube( "+i+", "+r+" )";let a={include:e.isShader("vertex"),ignoreCache:!0},o=this.getType(e);return e.addContext(a),this.colorSpace=this.colorSpace??new xM(new EM("",o)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(n),n=this.colorSpace.build(e,o),e.removeContext(),e.format(n,o,t)}},FM=["x","y","z","w"],jM=["float","vec2","vec3","vec4"],VM={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},HM={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},WM=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(e,t){return e.deps.length-t.deps.length}return function(t,n){let i=this.getIncludes(t,n);if(!i)return"";let r="";i=i.sort(e);for(let e=0;e<i.length;e++)i[e].src&&(r+=i[e].src+"\n");return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","\n\t\t\t// NOTE: Include Spline's blending modes. This could be part of BlendNode\n\t\t\t#define SPE_BLENDING_NORMAL 0\n\t\t\t#define SPE_BLENDING_MULTIPLY 1\n\t\t\t#define SPE_BLENDING_SCREEN 2\n\t\t\t#define SPE_BLENDING_OVERLAY 3\n\n\t\t\tvec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, a * b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );\n\t\t\t\treturn mix( a, tmp, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );\n\t\t\t\treturn clamp( mix( a, tmp, alpha ), 0.0, 1.0 );\n\t\t\t}\n\n\t\t\tvec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {\n\t\t\t\tif ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );\n\t\t\t\treturn vec3( 1.0 );\n\t\t\t}\n\t\t\t","#include <packing>","#include <common>"].join("\n"),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join("\n"),fragment:["float accumAlpha = 0.0;","void accumulateAlpha(float alpha) {\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * alpha;\n\t\t\t\t}",""].join("\n")},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode("\nuniform int frameIndex;\nuniform vec2 resolution;\nuniform mat4 previousModelViewMatrix;\nuniform mat4 previousProjectionMatrix;\n\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n"),this.addFragmentParsCode("\nlayout(location = 1) out vec4 gVelocity;\n\nuniform int frameIndex;\nuniform vec2 resolution;\n\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n\nconst vec2 haltonSequence[16] = vec2[16](\nvec2( 0.000000,-0.333334),\nvec2(-0.500000, 0.333334),\nvec2( 0.500000,-0.777778),\nvec2(-0.750000,-0.111112),\nvec2( 0.250000, 0.555556),\nvec2(-0.250000,-0.555556),\nvec2( 0.750000, 0.111112),\nvec2(-0.875000, 0.777778),\nvec2(0.125000, -0.925926),\nvec2(-0.375000, -0.259260),\nvec2(0.625000, 0.407408),\nvec2(-0.625000, -0.703704),\nvec2(0.375000, -0.037038),\nvec2(-0.125000, 0.629630),\nvec2(0.875000, -0.481482),\nvec2(-0.937500, 0.185186));\n\nvec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {\n  const float goldenAngle = 2.399963f; // radians\n  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));\n  float theta = float(sampleIndex) * goldenAngle + angle;\n  float sine = sin(theta);\n  float cosine = cos(theta);\n  return vec2(cosine, sine) * r;\n}\n\n// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso\nfloat getNoiseInterleavedGradient(vec2 screenPos) {\n    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);\n    return fract(magic.z * fract(dot(screenPos, magic.xy)));\n}\n\n"),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let n=0;n<this.requires.uv.length;n++)if(this.requires.uv[n]){let e=n>0?n+1:"";this.addVaryCode("varying vec2 vUv"+e+";"),n>0&&this.addVertexParsCode("attribute vec2 uv"+e+";"),this.addVertexFinalCode("vUv"+e+" = uv"+e+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("\n\t\t\t\t#ifndef SHAPEBLEND \n\t\t\t\t\tvObjectNormal = normal;\n\t\t\t\t#else\n\t\t\t\t\tvObjectNormal = objectNormal;\n\t\t\t\t#endif\n\t\t\t")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode("\n// TODO: This could be generated CPU side and passed to the shader every frame\nconst vec2 haltonSequence[16] = vec2[16](\nvec2( 0.000000,-0.333334),\nvec2(-0.500000, 0.333334),\nvec2( 0.500000,-0.777778),\nvec2(-0.750000,-0.111112),\nvec2( 0.250000, 0.555556),\nvec2(-0.250000,-0.555556),\nvec2( 0.750000, 0.111112),\nvec2(-0.875000, 0.777778),\nvec2(0.125000, -0.925926),\nvec2(-0.375000, -0.259260),\nvec2(0.625000, 0.407408),\nvec2(-0.625000, -0.703704),\nvec2(0.375000, -0.037038),\nvec2(-0.125000, 0.629630),\nvec2(0.875000, -0.481482),\nvec2(-0.937500, 0.185186));\n\n// TODO: Pass correct view size\nvec2 offset = haltonSequence[frameIndex];\noffset.x /= resolution.x;\noffset.y /= resolution.y;\n\nvec4 currentPosition = gl_Position;\nvec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);\n\n// We want to calculate the velocity with unjittered positions\n// so that things that are not moving get a velocity = 0\nvCurrentPosition = currentPosition;\nvPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);\n#ifdef OUTLINE_COMPENSATION\nvPreviousPosition.xy += OUTLINE_COMPENSATION;\n#endif\ngl_Position = currentPositionJittered;\n\n"),this.addFragmentFinalCode("\nvec2 oldPos = vPreviousPosition.xy;\n    oldPos /= vPreviousPosition.w;\n    oldPos.xy = (oldPos.xy+1.)/2.0;\n\nvec2 newPos = vCurrentPosition.xy;\n    newPos /= vCurrentPosition.w;\n    newPos.xy = (newPos.xy+1.)/2.0;\n\nvec2 velocity = (newPos - oldPos);\n\n// Discard fully transparent pixels \nif (gl_FragColor.a <= 0.0) discard;\n\ngVelocity = vec4(velocity, 0.0, 1.0);\n")),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,n){return this.addSlot(e).addCache(t).addContext(n)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){void 0===this.fragmentVariables[e]&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){void 0===this.fragmentParsVariables[e]&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){void 0===this.vertexParsVariables[e]&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+"\n"}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+"\n"}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+"\n"}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+"\n"}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return-1!==this.caches.indexOf(e)}isSlot(e){return-1!==this.slots.indexOf(e)}define(e,t){this.defines[e]=void 0===t?1:t}require(e){this.requires[e]=!0}isDefined(e){return void 0!==this.defines[e]}getVar(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"varying",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=this.getVars(i),o=a[e];if(!o){let i=a.length;o={name:n||"node"+r+i+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,n,i){return this.getVar(e,t,n,this.shader,"T",i)}getAttribute(e,t){if(!this.attributes[e]){let n=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(n.name+" = "+e+";"),this.attributes[e]={varying:n,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join("\n")}getVarListCode(e,t){t=t??"";let n="";for(let i=0,r=e.length;i<r;++i){let r=e[i],s=r.type,a=r.name,o=r.size,l=this.getFormatByType(s);if(void 0===l)throw new Error("Node pars "+l+" not found.");l.includes("[]")?n+=t+" "+l.substring(0,l.length-2)+" "+a+`[${o}];\n`:n+=t+" "+l+" "+a+";\n"}return n}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof tM?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,n,i,r,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new nM({type:t,size:n.size,name:i||"nodeUA"+o+(s?"_"+s:""),node:n,needsUpdate:r});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}{let a=this.inputs.uniforms,o=a.list.length,l=new nM({type:t,name:i||"nodeU"+o+(s?"_"+s:""),node:n,needsUpdate:r});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,n,i,r){return this.createUniform("vertex",e,t,n,i,r)}createFragmentUniform(e,t,n,i,r){return this.createUniform("fragment",e,t,n,i,r)}include(e,t,n){let i;if(e="string"==typeof e?iM.get(e):e,!1===this.context.include)return e.name;e instanceof dM?i=this.includes.functions:e instanceof mM?i=this.includes.consts:e instanceof yM&&(i=this.includes.structs);let r=i[this.shader]=i[this.shader]||[];if(e){let i=r[e.name];if(i||(i=r[e.name]={node:e,deps:[]},r.push(i),i.src=e.build(this,"source")),e instanceof dM&&t&&r[t.name]&&-1===r[t.name].deps.indexOf(e)&&(r[t.name].deps.push(e),e.includes?.length)){let n=0;do{this.include(e.includes[n++],t)}while(n<e.includes.length)}return n&&(i.src=n),e.name}throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return jM[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return"f"===e?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return 1===e?"f":"v"+e}findNode(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<arguments.length;i++){let e=t[i];if(e?.isNode)return e}}resolve(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let i=0;i<arguments.length;i++){let e=t[i];if(void 0!==e){if(e.isNode)return e;if(e.isTexture)switch(e.mapping){case on:case ln:return new zM(e);case cn:return new UM(new CM(e));default:return new CM(e)}else{if(e.isVector2)return new aM(e);if(e.isVector3)return new oM(e);if(e.isVector4)return new cM(e)}}}}format(e,t,n){switch(this.colorToVector(n+" <- "+t)){case"f <- v2":case"f <- v3":case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return VM[e]||e}getFormatByType(e){return HM[e]||e}getUUID(e,t){return(t=void 0===t||t)&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return FM[e]}getIndexByElement(e){return FM.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=Vn,t===Vn&&this.context.gamma&&(t=Hn),t}},GM=class extends sM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;super("c"),this.nodeType="Color",this.value=e instanceof lM?e:new lM(e||0,t,n,i)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,n,i,r,s){n=e.getUUID(n??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(n),o=this.getReadonly()&&void 0!==this.generateReadonly;if(this.alpha){let t=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${t};`)}return o?this.generateReadonly(e,t,n,i,r,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,r,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,r,s,this.getLabel())),e.format(a.fragment.name,i,t))}generateReadonly(e,t,n,i,r,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},qM=class extends sM{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,n,i,r,s){return e.format(this.value.toString(),i,t)}},KM=class extends sM{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,n,i){return e.format(this.value?"true":"false",i,t)}},YM=class extends sM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:"number"==typeof t?new Array(e).fill(t):new Array(e).fill(0)}},QM=class extends sM{},XM=class extends QM{constructor(e){super("v3"),this.image=e,this._value=new ji}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},ZM=class extends QM{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1008,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1006;super("t"),this.image=e,this.wrap=t,this.minFilter=n,this.magFilter=i}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},JM=class extends sM{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new pi}generateReadonly(e,t,n,i,r,s){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},$M=class extends sM{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new vr}generateReadonly(e,t,n,i,r,s){return e.format("mat4("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function eN(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e.setUvTransform(n[0],n[1],t[0],t[1],0,0,0).premultiply((new pi).makeRotation(i*ui.DEG2RAD))}var tN=class extends JM{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(new pi),this.repeat=e,this.offset=t,this.rotation=n,eN(this.value,e,t,n)}updateMatrix(){eN(this.value,this.repeat,this.offset,this.rotation)}},nN=class extends sM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof ki?new Array(e).fill(t):new Array(e).fill(new ki(0))}},iN=class extends rM{constructor(e,t,n,i){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=n,this.mode=i}generate(e,t){if(e.isShader("fragment")){let n=[];return n.push(this.a.build(e,"c")),n.push(this.b.build(e,"c")),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),e.format("spe_blend("+n.join(",")+")",this.getType(e),t)}return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},rN=class extends rM{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let n=e.include(rN.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.color.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},sN=rN;sN.Nodes={customColor:new dM("vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {\n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\n\t\t\t\treturn color;\n\t\t\t}")};var aN=class extends rM{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let n=e.include(aN.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.cnormal.build(e,"v3")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},oN=aN;oN.Nodes={customNormal:new dM("vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {\n\t\t\t\tvec3 normal = packNormalToRGB( norm ).rgb;\n\t\t\t\tnormal *= step( vec3(0.5), cnormal );\n\n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\n\t\t\t\treturn normal;\n\t\t\t}")};var lN=class extends rM{constructor(e,t,n,i,r,s,a,o,l,c,h,u){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=n,this.projection=i,this.axis=r,this.side=s,this.size=a,this.blending=o,this.mat=l,this.isMask=u,this.alpha=c,this.mode=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let n,i=`g${this.uuid.toString().replace(/-/g,"")}`;switch(this.projection.value){case 3:n=e.include(lN.Nodes.cylindrical);break;case 2:n=e.include(lN.Nodes.spherical);break;case 1:let t=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],r=["zy","xz","xy"][this.axis.value],s=new dM(`\n\t\tvec3 ${i}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n\t\t\t\tvec2 projected = (1. + (position.${r})) / 2.;\n\t\t\t\tvec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\t${2===this.side.value?"":`lalpha *= step(0.0, ${1===this.side.value?"-1.0 * ":""}dot(vObjectNormal, ${t}));`}\n\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}`);n=e.include(s);break;case 4:n=e.include(lN.Nodes.triplanar);break;default:n=e.include(lN.Nodes.uv)}e.addFragmentVariable(this.calpha,"float");let r=[];if(r.push("normal"),r.push(this.texture.generate(e,"t")),r.push(this.textureSize.build(e,"v2")),r.push(this.crop.build(e,"f")),r.push(this.mat.build(e,"mat3")),r.push(this.size.build(e,"v2")),r.push(this.blending.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),4===this.projection.value){let t=`${i}_writeUvs`,n=t+"0",s=t+"1",a=t+"2",o=`${i}_triplanarWeights`;e.addFragmentVariable(n,"vec2"),e.addFragmentVariable(s,"vec2"),e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec3"),r.push(n),r.push(s),r.push(a),r.push(o)}else{let t=`${i}_writeUvs`;e.addFragmentVariable(t,"vec2"),r.push(t)}return e.format(n+"("+r.join(",")+")",this.getType(e),t)}},cN=lN;cN.Nodes={cylindrical:new dM("\nvec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n                vec3 posN = normalize(position);\n                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);\n                float scaledHeight = position.y / (size.y * 0.5);\n                float v =  (scaledHeight / 2.) + .5;\n\n                vec2 calculatedUv = vec2(u,v);\n\t\t\t\tvec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n                vec2 df = fwidth(uvs);\n               \tif(df.x > 0.5) df.x = 0.;\n\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#else\n                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\t\t\t\t\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}\n"),spherical:new dM("\nvec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n                vec3 posN = normalize(vPosition);\n                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);\n                float v = 0.5 + asin(posN.y) / 3.1415;\n\n                vec2 calculatedUv = vec2(u,v);\n\t\t\t\tvec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n                vec2 df = fwidth(uvs);\n               \tif(df.x > 0.5) df.x = 0.;\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#else\n                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}\n"),uv:new dM("vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {\n\t\t\t\tvec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\twriteUv = uvs;\n\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\n\t\t\t\tvec3 col = tmp.rgb;\n\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlalpha *= mask;\n\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;\n\t\t\t}"),triplanar:new dM("vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {\n\t\t\t\tvec3 p = position;\n\t\t\t\tvec2 uv0 = (1.0 + p.xy) / 2.0;     \n\t\t\t\tvec2 uv1 = (1.0 + p.zy) / 2.0;\t\t\n\t\t\t\tvec2 uv2 = (1.0 + p.xz) / 2.0;\t\t\n\t\n\t\t\t\tuv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\t\t\t\tuv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\t\t\t\tuv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;\n\n\t\t\t\t// Range from 3 to 128 seems to be good\n\t\t\t\tfloat exponent = (1.0 - blending) * 125.0 + 3.0;\n\n\t\t\t\tvec3 n = vObjectNormal;\n\t\t\t\tvec3 weights = abs(normalize(n));\n\t\t\t\tweights = pow(weights, vec3(exponent));\n\t\t\t\tweights /= dot(weights, vec3(1.0));\n\n\t\t\t\t// Write out all sets of UVs that we generated\n\t\t\t\twriteUvs0 = uv0;\n\t\t\t\twriteUvs1 = uv1;\n\t\t\t\twriteUvs2 = uv2;\n\t\t\t\twriteWeights = weights;\n\n\t\t\t\t// Derivatives for LOD\n\t\t\t\tvec2 df0 = fwidth(uv0);\n\t\t\t\tvec2 df1 = fwidth(uv1);\n\t\t\t\tvec2 df2 = fwidth(uv2);\n\t\t\t\tif (df0.x > 0.5) df0.x = 0.0;\n\t\t\t\tif (df1.x > 0.5) df1.x = 0.0;\n\t\t\t\tif (df2.x > 0.5) df2.x = 0.0;\n\n\t\t\t\t#ifdef GL_EXT_shader_texture_lod\n                \tvec4 tmp = \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + \n\t\t\t\t\t\ttexture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;\n\t\t\t\t#else\n                \tvec4 tmp = \n\t\t\t\t\t\ttextureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + \n\t\t\t\t\t\ttextureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + \n\t\t\t\t\t\ttextureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;\n\t\t\t\t#endif\n\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\n\t\t\t\t// Apply cropping across all 3 planes\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\tif ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t\tif ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlalpha *= mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn col;//n * 0.5 + 0.5;\n\t\t\t}\t\t\t\n\t\t\t")};var hN=class extends rM{constructor(e,t,n,i,r,s,a,o,l,c,h,u){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=n,this.far=i,this.isVector=r,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=c,this.isMask=u,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let n=`g${this.uuid.toString().replace(/-/g,"")}`,i=new dM(`vec3 ${n}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${n}_MAX_COLORS], float steps[${n}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {\n               vec4 color = colors[0];\n               #ifdef ${n}_IS_VECTOR\n                   #ifdef ${n}_LINEAR\n                       #ifdef ${n}_WORLDSPACE\n                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);\n                       #else\n                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);\n                       #endif\n                   #else\n                       #ifdef ${n}_WORLDSPACE\n                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);\n                       #else\n                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);\n                       #endif\n                   #endif\n               #else\n                   float dist = length(vWPosition - cameraPosition);\n\t\t\t       float depth = ( dist - near ) / ( far - near );\n               #endif\n\n\n              float p;\n              #ifdef ${n}_SMOOTH\n\t\t\t\tfor ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {\n\t\t\t\t\t\tp = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t\t}\n              #else\n                for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {\n                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);\n                   color = mix(color, colors[i], p);\n                 }\n              #endif\n\n               float lalpha = alpha * color.a * mask;\n               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t   \n               return color.rgb;\n\t\t\t}`,[hN.Nodes.vectorLinearWorldSpaceDepth,hN.Nodes.vectorLinearObjectSpaceDepth,hN.Nodes.vectorSphericalObjectSpaceDepth,hN.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${n}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${n}_SMOOTH`),this.isVector.value>.5&&e.define(`${n}_IS_VECTOR`),0===this.gradientType.value&&e.define(`${n}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${n}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let r=e.include(i),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(r+"("+s.join(",")+")",this.getType(e),t)}return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},uN=hN;uN.Nodes={vectorLinearWorldSpaceDepth:new dM("float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {\n               vec3 n = normalize(direction);\n               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));\n               return ( dist - near ) / ( far - near );\n            }"),vectorLinearObjectSpaceDepth:new dM("float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {\n               vec3 n = normalize(direction);\n               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));\n               return ( dist - near ) / ( far - near );\n            }"),vectorSphericalWorldSpaceDepth:new dM("float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {\n               float dist = length(vWPosition - origin);\n               return ( dist - near ) / ( far - near );\n            }"),vectorSphericalObjectSpaceDepth:new dM("float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {\n               float dist = length(position - origin);\n               return ( dist - near ) / ( far - near );\n            }")};var dN=class extends rM{constructor(e,t,n,i,r,s,a,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=n,this.intensity=i,this.factor=r,this.isMask=o,this.alpha=s,this.mode=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let n=new dM("vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {\n\t\t\t\t\tfloat fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );\n\n\t\t\t\t\tfloat lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\t\treturn color;\n\t\t\t\t}"),i=e.include(n),r=[];return r.push(this.color.build(e,"c")),r.push(this.bias.build(e,"f")),r.push(this.scale.build(e,"f")),r.push(this.intensity.build(e,"f")),r.push(this.factor.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),e.format(i+"("+r.join(",")+")",this.getType(e),t)}return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},pN=class extends rM{constructor(e,t,n,i,r,s,a,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=n,this.steps=i,this.offset=r,this.morph=s,this.angle=a,this.isMask=l,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let n=e.include(pN.Nodes.gradient),i=[];return i.push(this.gradientType.build(e,"i")),i.push(this.smooth.build(e,"b")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.offset.build(e,"v2")),i.push(this.morph.build(e,"v2")),i.push(this.angle.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},fN=pN;fN.Nodes={gradient:new dM("vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tvec2 m = morph / vUv.xy;\n\t\t\t\tvec2 rot = vec2( 0.5 + m.x, m.y );\n\t\t\t\tvec2 dt = vec2(\n\t\t\t\t\tcos( angle ) * rot.x - sin( angle ) * rot.y,\n\t\t\t\t\tsin( angle ) * rot.x + cos( angle ) * rot.y\n\t\t\t\t);\n\t\t\t\tvec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;\n\t\t\t\tfloat t = dot( pt, dt ) / dot( dt, dt );\n\t\t\t\tif ( gradientType == 1 ) {\n\t\t\t\t\tt = distance (\n\t\t\t\t\t\t( vUv + morph ) * 3.0,\n\t\t\t\t\t\t( vUv + offset ) + 1.0\n\t\t\t\t\t) + angle;\n\t\t\t\t} else if ( gradientType == 2 ) {\n\t\t\t\t\tfloat polar = atan(\n\t\t\t\t\t\tvUv.x + morph.x - 0.5 + offset.x,\n\t\t\t\t\t\tvUv.y + morph.y - 0.5 + offset.y\n\t\t\t\t\t) * -1.0;\n\t\t\t\t\tt = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );\n\t\t\t\t}\n\n\t\t\t\tfloat p;\n\t\t\t\tif (smoothed) {\n\t\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix(color, colors[i], p);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t\t\n\t\t\t\treturn color.xyz;\n\t\t\t}")};var mN=class extends rM{constructor(e,t,n,i,r){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=i,this.alpha=t,this.mode=n,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`,this.rotation=r}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let n=e.include(mN.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let i=[];return i.push(this.texture.generate(e,"t")),i.push("normal"),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),i.push(this.rotation.build(e,"f")),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},gN=mN;gN.Nodes={matcap:new dM("vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {\n\t\t\t\t\tvec3 viewDir = normalize( vViewPosition );\n\t\t\t\t\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\t\t\t\t\tvec3 y = cross( viewDir, x );\n\t\t\t\t\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) );\n\t\t\t\t\tuv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;\n\t\t\t\t\tuv = uv * 0.495 + 0.5;\n\t\t\t\t\tvec4 matcapColor = texture2D( matcapTex, uv );\n\n\t\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\t\t\t\t\t\n\t\t\t\t\treturn matcapColor.rgb;\n            \t}")};var vN=function(){let e=new dM("vec3 random3(vec3 c) {\n\t\t\tfloat j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n\t\t\tvec3 r;\n\t\t\tr.z = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.x = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.y = fract(512.0*j);\n\t\t\treturn r-0.5;\n\t\t}"),t=new dM("float simplexFast(vec3 p) {\n\t\t\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t\t\t mediump vec3 x = p - s + dot(s, vec3(G3));\n\t\t\t mediump vec3 hs = s;\n\t\t\t \n\t\t\t mediump vec3 e = step(vec3(0.0), x - x.yzx);\n\t\t\t mediump vec3 i1 = e*(1.0 - e.zxy);\n\t\t\t mediump vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\t\n\t\t\t mediump vec3 x1 = x - i1 + G3;\n\t\t\t mediump vec3 x2 = x - i2 + 2.0*G3;\n\t\t\t mediump vec3 x3 = x - 1.0 + 3.0*G3;\n\t\t\t \n\t\t\t mediump vec4 w, d;\n\t\t\t \n\t\t\t w.x = dot(x, x);\n\t\t\t w.y = dot(x1, x1);\n\t\t\t w.z = dot(x2, x2);\n\t\t\t w.w = dot(x3, x3);\n\t\t\t \n\t\t\t w = max(0.6 - w, 0.0);\n\t\t\t \n\t\t\t d.x = dot(random3(hs), x);\n\t\t\t d.y = dot(random3(hs + i1), x1);\n\t\t\t d.z = dot(random3(hs + i2), x2);\n\t\t\t d.w = dot(random3(hs + 1.0), x3);\n\t\t\t \n\t\t\t w *= w;\n\t\t\t w *= w;\n\t\t\t d *= w;\n\t\t\t \n\t\t\t return dot(d, vec4(52.0));\n\t\t}",[e]);t.keywords.F3=new mM("float F3 0.3333333"),t.keywords.G3=new mM("float G3 0.1666667");let n=new dM("float simplexPrecise(vec3 p) {\n\t\t\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t\t\t vec3 x = p - s + dot(s, vec3(G3));\n\t\t\t \n\t\t\t vec3 e = step(vec3(0.0), x - x.yzx);\n\t\t\t vec3 i1 = e*(1.0 - e.zxy);\n\t\t\t vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\t\n\t\t\t vec3 x1 = x - i1 + G3;\n\t\t\t vec3 x2 = x - i2 + 2.0*G3;\n\t\t\t vec3 x3 = x - 1.0 + 3.0*G3;\n\t\t\t \n\t\t\t vec4 w, d;\n\t\t\t \n\t\t\t w.x = dot(x, x);\n\t\t\t w.y = dot(x1, x1);\n\t\t\t w.z = dot(x2, x2);\n\t\t\t w.w = dot(x3, x3);\n\t\t\t \n\t\t\t w = max(0.6 - w, 0.0);\n\t\t\t \n\t\t\t d.x = dot(random3(s), x);\n\t\t\t d.y = dot(random3(s + i1), x1);\n\t\t\t d.z = dot(random3(s + i2), x2);\n\t\t\t d.w = dot(random3(s + 1.0), x3);\n\t\t\t \n\t\t\t w *= w;\n\t\t\t w *= w;\n\t\t\t d *= w;\n\t\t\t \n\t\t\t return dot(d, vec4(52.0));\n\t\t}",[e]);n.keywords.F3=new mM("float F3 0.3333333"),n.keywords.G3=new mM("float G3 0.1666667");let i=new dM("float simplexFractal(vec3 m) {\n\t\t\tmat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);\n\t\t\tmat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);\n\t\t\tmat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);\n\t\t\treturn 0.5333333 * simplexFast(m * rot1)\n\t\t\t\t + 0.2666667 * simplexFast(2.0 * m * rot2)\n\t\t\t\t + 0.1333333 * simplexFast(4.0 * m * rot3)\n\t\t\t\t + 0.0666667 * simplexFast(8.0 * m);\n\t\t}",[t]),r=new dM("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),s=new dM("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),a=new dM("float simplexAshima(vec3 v) {\n\t\t  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n\t\t  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\t\t  vec3 i  = floor(v + dot(v, C.yyy) );\n\t\t  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\t\t  vec3 g = step(x0.yzx, x0.xyz);\n\t\t  vec3 l = 1.0 - g;\n\t\t  vec3 i1 = min( g.xyz, l.zxy );\n\t\t  vec3 i2 = max( g.xyz, l.zxy );\n\t\t  vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n\t\t  vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n\t\t  vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\t\t  i = mod(i, 289.0 ); \n\t\t  vec4 p = permute( permute( permute( \n\t\t\t\t\t i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n\t\t\t\t   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n\t\t\t\t   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\t\t  float n_ = 1.0/7.0; // N=7\n\t\t  vec3  ns = n_ * D.wyz - D.xzx;\n\t\t  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\n\t\t  vec4 x_ = floor(j * ns.z);\n\t\t  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\t\t  vec4 x = x_ *ns.x + ns.yyyy;\n\t\t  vec4 y = y_ *ns.x + ns.yyyy;\n\t\t  vec4 h = 1.0 - abs(x) - abs(y);\n\t\t  vec4 b0 = vec4( x.xy, y.xy );\n\t\t  vec4 b1 = vec4( x.zw, y.zw );\n\t\t  vec4 s0 = floor(b0)*2.0 + 1.0;\n\t\t  vec4 s1 = floor(b1)*2.0 + 1.0;\n\t\t  vec4 sh = -step(h, vec4(0.0));\n\t\t  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n\t\t  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\t\t  vec3 p0 = vec3(a0.xy,h.x);\n\t\t  vec3 p1 = vec3(a0.zw,h.y);\n\t\t  vec3 p2 = vec3(a1.xy,h.z);\n\t\t  vec3 p3 = vec3(a1.zw,h.w);\n\t\t  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n\t\t  p0 *= norm.x;\n\t\t  p1 *= norm.y;\n\t\t  p2 *= norm.z;\n\t\t  p3 *= norm.w;\n\t\t  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n\t\t  m = m * m;\n\t\t  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n\t\t\t\t\t\t\t\t\t\tdot(p2,x2), dot(p3,x3) ) );\n\t\t}",[r,s]),o=new dM("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),l=new dM("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),c=new dM("float noise(vec3 p){\n\t\t\tvec3 a = floor(p);\n\t\t\tvec3 d = p - a;\n\t\t\td = d * d * (3.0 - 2.0 * d);\n\t\t\tvec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n\t\t\tvec4 k1 = perm(b.xyxy);\n\t\t\tvec4 k2 = perm(k1.xyxy + b.zzww);\n\t\t\tvec4 c = k2 + a.zzzz;\n\t\t\tvec4 k3 = perm(c);\n\t\t\tvec4 k4 = perm(c + 1.0);\n\t\t\tvec4 o1 = fract(k3 * (1.0 / 41.0));\n\t\t\tvec4 o2 = fract(k4 * (1.0 / 41.0));\n\t\t\tvec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n\t\t\tvec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\t\t\treturn o4.y * d.y + o4.x * (1.0 - d.y);\n\t\t}",[l]),h=new dM("float fbm(vec3 x) {\n\t\t\tfloat v = 0.0;\n\t\t\tfloat a = 0.5;\n\t\t\tvec3 shift = vec3(100);\n\t\t\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\t\t\tv += a * noise(x);\n\t\t\t\tx = x * 2.0 + shift;\n\t\t\t\ta *= 0.5;\n\t\t\t}\n\t\t\treturn v;\n\t\t}",[c]);h.keywords.NUM_OCTAVES=new mM("int NUM_OCTAVES 5");let u=new dM("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),d=new dM("float perlin(vec3 P){\n\t\t  vec3 Pi0 = floor(P);\n\t\t  vec3 Pi1 = Pi0 + vec3(1.0);\n\t\t  Pi0 = mod(Pi0, 289.0);\n\t\t  Pi1 = mod(Pi1, 289.0);\n\t\t  vec3 Pf0 = fract(P);\n\t\t  vec3 Pf1 = Pf0 - vec3(1.0);\n\t\t  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n\t\t  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n\t\t  vec4 iz0 = Pi0.zzzz;\n\t\t  vec4 iz1 = Pi1.zzzz;\n\t\t  vec4 ixy = permute(permute(ix) + iy);\n\t\t  vec4 ixy0 = permute(ixy + iz0);\n\t\t  vec4 ixy1 = permute(ixy + iz1);\n\t\t  vec4 gx0 = ixy0 / 7.0;\n\t\t  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n\t\t  gx0 = fract(gx0);\n\t\t  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n\t\t  vec4 sz0 = step(gz0, vec4(0.0));\n\t\t  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n\t\t  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\t\t  vec4 gx1 = ixy1 / 7.0;\n\t\t  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n\t\t  gx1 = fract(gx1);\n\t\t  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n\t\t  vec4 sz1 = step(gz1, vec4(0.0));\n\t\t  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n\t\t  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\t\t  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n\t\t  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n\t\t  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n\t\t  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n\t\t  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n\t\t  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n\t\t  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n\t\t  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\t\t  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n\t\t  g000 *= norm0.x;\n\t\t  g010 *= norm0.y;\n\t\t  g100 *= norm0.z;\n\t\t  g110 *= norm0.w;\n\t\t  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n\t\t  g001 *= norm1.x;\n\t\t  g011 *= norm1.y;\n\t\t  g101 *= norm1.z;\n\t\t  g111 *= norm1.w;\n\t\t  float n000 = dot(g000, Pf0);\n\t\t  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n\t\t  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n\t\t  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n\t\t  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n\t\t  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n\t\t  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n\t\t  float n111 = dot(g111, Pf1);\n\t\t  vec3 fade_xyz = fade(Pf0);\n\t\t  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n\t\t  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n\t\t  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n\t\t  return 2.2 * n_xyz;\n\t\t}",[r,s,u]),p=new dM("float hashwithoutsine13(vec3 p3)\n\t\t{\n\t\t\tp3  = fract(p3 * .1031);\n\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t}"),f=new dM("vec3 hashwithoutsine33(vec3 p3)\n\t\t{\n\t\t\tp3 = fract(p3 * vec3(.1031, .1030, .0973));\n\t\t\tp3 += dot(p3, p3.yxz+33.33);\n\t\t\treturn fract((p3.xxy + p3.yxx)*p3.zyx);\n\t\t}"),m=new dM("float metric(in vec3 p)\n\t\t{\n\t\t\t// L2 \n\t\t\treturn length(p);\n\n\t\t\t// Chebyshev \n\t\t\t// vec3 a = abs(p);\n\t\t\t// return max(a.x, max(a.y, a.z));\n\t\t}"),g=new dM("float smin( float a, float b, float k )\n\t\t{\n\t\t\tfloat h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);\n\t\t\tfloat correction = k * h * (1.0 - h);\n\t\t\treturn mix(b, a, h) - correction;\n\t\t}"),v=new dM("float smax( float a, float b, float k )\n\t\t{\n\t\t\tfloat h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);\n\t\t\tfloat correction = k * h * (1.0 - h);\n\t\t\treturn mix(a, b, h) + correction;\n\t\t}"),y=new dM("float remap(float value, float input_min, float input_max, float output_min, float output_max) {\n\t\t\t// Compute width of each interval\n\t\t\tfloat input_width = input_max - input_min;\n\t\t\tfloat output_width = output_max - output_min;\n\t\t\n\t\t\t// Convert input range into a 0-1 range \n\t\t\tfloat scaled = (value - input_min) / input_width;\n\t\t\n\t\t\t// Convert the 0-1 range into a value in output range\n\t\t\treturn output_min + (scaled * output_width);\n\t\t}");return{simplexFast:t,simplexPrecise:n,simplexFractal:i,simplexAshima:a,fbm:h,perlin:d,voronoi:new dM('float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) \n\t\t{\n\t\t\t// Integer and fractional parts of this point\'s coordinates\n\t\t\tivec3 p = ivec3(floor(x));\n\t\t\tvec3 f = fract(x);\n\n\t\t\t// Different variables that we will use to construct noise:\n\t\t\t//\n\t\t\t// f1: distance to the closest feature point\n\t\t\t// f2: distance to the second closest feature point\n\t\t\t// e: distance to the closest edge (cell boundary)\n\t\t\t//\n\t\t\t// We also compute "smooth" versions of all of the above quantites, essentially\n\t\t\t// replacing "hard" minimums with "smooth" minimums (described by IQ)\n\t\t\tfloat f1_smooth = 8.0;\n\t\t\tfloat f1 = 8.0;\n\t\t\tfloat f2_smooth = 8.0;\n\t\t\tfloat f2 = 8.0;\n\t\t\tfloat e_smooth = 8.0;\n\t\t\tfloat e = 8.0;\n\n\t\t\t// Variables stored from closest cell\n\t\t\tivec3 mb;\n\t\t\tvec3 mr; \n\n\t\t\tint steps = quality;\n\t\t\t\n\t\t\tfor (int x = -steps; x <= steps; x++) \n\t\t\tfor (int y = -steps; y <= steps; y++)\n\t\t\tfor (int z = -steps; z <= steps; z++)\n\t\t\t{\n\t\t\t\tivec3 b = ivec3(x, y, z);\n\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\tfloat d = length(r);\n\t\t\t\t\n\t\t\t\tf1_smooth = smin(d, f1_smooth, smoothness);\n\n\t\t\t\t// Store un-smoothed distances too \n\t\t\t\tif (d < f1) \n\t\t\t\t{\n\t\t\t\t\tf2 = f1;\n\t\t\t\t\tf1 = d;\n\n\t\t\t\t\tmb = ivec3(x, y, z);\n\t\t\t\t\tmr = r;\n\t\t\t\t} \n\t\t\t\telse if (d < f2) \n\t\t\t\t{\n\t\t\t\t\tf2 = d;\n\t\t\t\t}\n\t\t\t}\t\n\t\t\t\n\t\t\t// Second pass for edge distance  \n\t\t\t// skip for styles don\'t need\n\t\t\tif (style != 0 &&  style != 5 && style != 7)\n\t\t\tfor (int x = -steps; x <= steps; x++) \n\t\t\tfor (int y = -steps; y <= steps; y++)\n\t\t\tfor (int z = -steps; z <= steps; z++)\n\t\t\t{\n\t\t\t\t// Start search at the cell that contains the closest point to "x" (found in 1st pass)\n\t\t\t\tivec3 b = mb + ivec3(x, y, z);\n\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\tfloat d1 = dot(0.5 * (mr + r), (r - mr)); \t\t\t\t// IQ normalizes "r - mr" but that breaks things for the smooth version?\n\t\t\t\tfloat d2 = dot(0.5 * (mr + r), normalize(r - mr));\n\n\t\t\t\te_smooth = smin(d1, e_smooth, smoothness);\n\n\t\t\t\te = min(e, d2);\n\n\t\t\t\t// Also compute a smooth version of F2 in this pass\n\t\t\t\t{\n\t\t\t\t\tivec3 b = ivec3(x, y, z);\n\t\t\t\t\tif (b != mb) \n\t\t\t\t\t{\n\t\t\t\t\t\tvec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;\n\t\t\t\t\t\tfloat d = length(r);\n\n\t\t\t\t\t\tf2_smooth = smin(d, f2_smooth, smoothness);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Different visualization modes \n\t\t\tif (style == 0) \n\t\t\t{\n\t\t\t\treturn f1_smooth;\n\t\t\t}\n\t\t\tif (style == 1) \n\t\t\t{\n\t\t\t\treturn f2_smooth;\n\t\t\t}\n\t\t\tif (style == 2) \n\t\t\t{\n\t\t\t\treturn f2_smooth - f1_smooth;\n\t\t\t\t\n\t\t\t\t// "Pebbles" also cool\n\t\t\t\t//return step(0.2, f2_smooth - f1_smooth);\n\t\t\t}\n\t\t\tif (style == 3) \n\t\t\t{\n\t\t\t\t// This one is really good for rock / stone effects\n\t\t\t\tfloat a = f1; \n\t\t\t\tfloat b = f2;\n\t\t\t\tfloat k = 3.0;\n\t\t\t\tfloat h = max(k - abs(a - b), 0.0) / k;\n\t\t\t\tfloat final = min(a, b) - h * h * k * (1.0 / 4.0);\n\t\t\t\treturn final;\n\t\t\t}\n\t\t\tif (style == 4) \n\t\t\t{\n\t\t\t\t// Some random adjustments to make this style stand out more \n\t\t\t\treturn exp(5.0 * e_smooth);\n\t\t\t}\n\t\t\tif (style == 5) \n\t\t\t{\n\t\t\t\treturn pow(f1_smooth, 3.0);\n\t\t\t}\n\t\t\tif (style == 6) \n\t\t\t{\t\t\t\t\n\t\t\t\tconst float eps = 0.0125;\n\n\t\t\t\t// Thicker lines as the user increases the smoothness slider\n\t\t\t\tfloat thickness = smoothness * 0.25 + eps;\n\n\t\t\t\t// Blurrier lines as the user increases the smoothness slider\n\t\t\t\tfloat blur = pow(smoothness, 3.0) * 0.25 + eps;\n\n\t\t\t\treturn smoothstep(\n\t\t\t\t\tthickness - thickness * blur, \n\t\t\t\t\tthickness + thickness * blur, \n\t\t\t\t\te\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (style == 7) \n\t\t\t{\n\t\t\t\treturn hashwithoutsine13(vec3(p + mb) + seed);\n\t\t\t}\n\t\t}\n\t',[p,f,m,g,v,y])}}(),yN=class extends rM{constructor(e,t,n,i,r,s,a,o,l,c,h,u,d,p,f,m,g,v,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=n,this.fA=i,this.fB=r,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=c,this.noiseType=u,this.voronoiStyle=p,this.highCut=f,this.lowCut=m,this.smoothness=g,this.seed=v,this.quality=y,this.isMask=d,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,n,i,r){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=["simplexFast","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseType.value],a=new dM(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) \n\t\t\t{\n                // Prevent scale of zero \n\t\t\t\tscale = max(abs(scale), 0.001);\n\n\t\t\t\tvec3 st = position / size;\n\t\t\t\tst /= scale;\n\n\t\t\t\t${"voronoi"==s?`\n\t\tfloat v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);\n\n\t\t// Apply clipping to colors\n\t\tv = remap(v, lowCut, highCut, 0.0, 1.0);\n\t\tv = smax(v, 0.0, smoothness * 0.25);\n\t\tv = smin(v, 1.0, smoothness * 0.25);\n\n\t\t// Note that the voronoi mode only uses colors "A" and "C" from the UI \n\t\tvec4 color = mix(colorA, colorC, v); \n\t\t`:`\n\t\tvec3 q = vec3(${s}(st),\n\t\t\t\t\t   ${s}(st + vec3(1.0)),\n\t\t\t\t\t   ${s}(st + vec3(1.0)));\n\t\tvec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),\n\t\t\t\t\t  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), \n\t\t\t\t\t  ${s}(st * q));\n\t\tfloat f = ${s}(st + r);\n\t\tvec4 color;\n\t\tcolor = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));\n\t\tcolor = mix(color, colorC, clamp(length(q), 0.0, 1.0));\n\t\tcolor = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));\n\t\t`}\n\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn clamp(color, 0.0, 1.0).rgb;\n\t\t\t}`,[vN.simplexFast,vN.simplexFractal,vN.simplexAshima,vN.fbm,vN.perlin,vN.voronoi]),o=e.include(a),l=[];return l.push(this.scale.build(e,"f")),l.push(this.size.build(e,"v3")),l.push(this.move.build(e,"f")),l.push(this.fA.build(e,"v2")),l.push(this.fB.build(e,"v2")),l.push(this.distortion.build(e,"v2")),l.push(this.colorA.build(e,"v4")),l.push(this.colorB.build(e,"v4")),l.push(this.colorC.build(e,"v4")),l.push(this.colorD.build(e,"v4")),l.push(this.voronoiStyle.build(e,"i")),l.push(this.highCut.build(e,"f")),l.push(this.lowCut.build(e,"f")),l.push(this.smoothness.build(e,"f")),l.push(this.seed.build(e,"f")),l.push(this.quality.build(e,"i")),l.push(this.isMask.build(e,"b")),l.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),l.push(this.alpha.build(e,"f")),l.push(this.calpha),e.format(o+"("+l.join(",")+")",this.getType(e),t)}};yN.numOctaves=5;var bN=class extends rM{constructor(e,t,n,i,r,s,a,o,l,c,h,u,d,p,f,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=n,this.contourWidth=i,this.contourThreshold=r,this.outlineThreshold=s,this.contourFrequency=a,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=c,this.compensation=h,this.resolution=u,this.normalMap=d,this.depthMap=p,this.pixelRatio=f,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let n=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${n}_offset`),this.firstTime){let t=this.outlineWidth.build(e,"f"),i=this.resolution.build(e,"v2"),r=this.compensation.build(e,"b"),s=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(t,"uniform float"),e.addVertexParsVariable(i,"uniform vec2"),e.addVertexParsVariable(r,"uniform bool"),e.addVertexParsVariable(s,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`\n                vID = randomColor.r;\n                vec2 ${n}_offset = vec2(0.0);\n                if (${r}) {\n                    vec4 ${n}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));\n                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the\n                    // normals face the camera directly. So we hackily fix this by offsetting the normal\n                    // by a tiny amount.\n                    vec3 ${n}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;\n                    ${n}_offset = normalize(${n}_clipNormal.xy) / ${i} * (${t} / 2.0) * ${n}_clipPosition.w * 2.0 * ${s};\n                    ${n}_clipPosition.xy += ${n}_offset;\n                    // TODO(MAX): To handle multiple outline layers, we only want to extrude\n                    // if this offset is the biggest of all the potential offsets\n                    gl_Position = ${n}_clipPosition;\n                }\n            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let n=e.include(bN.Nodes.outline),i=[];return i.push(this.outlineColor.build(e,"c")),i.push(this.contourColor.build(e,"c")),i.push(this.outlineWidth.build(e,"f")),i.push(this.contourWidth.build(e,"f")),i.push(this.contourThreshold.build(e,"f")),i.push(this.outlineThreshold.build(e,"f")),i.push(this.contourFrequency.build(e,"f")),i.push(this.outlineSmoothing.build(e,"f")),i.push(this.contourDirection.build(e,"v3")),i.push(this.positionalLines.build(e,"b")),i.push(this.resolution.build(e,"v2")),i.push(this.normalMap.getTexture(e,"t")),i.push(this.depthMap.getTexture(e,"t")),i.push(this.pixelRatio.build(e,"f")),i.push(this.compensation.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),this.firstTime=!this.firstTime,e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},wN=bN;wN.Nodes=function(){let e=new dM("\nfloat sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)\n{\n    vec2 halton = haltonSequence[frameIndex];\n    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n    float temporalAngle  = temporalOffset * PI2;\n\n    vec2 texelSize = (vec2(1.0) / resolution);\n    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;\n\n    vec2 uvSamples[9];\n    vec4 normalSamples[9];\n\n\tuvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);\n\tuvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);\n\tuvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);\n\tuvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);\n\tuvSamples[4] = uv;\n\tuvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);\n\tuvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);\n\tuvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);\n\tuvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);\n\n\n    normalSamples[0] = texture2D(t, uvSamples[0]);\n    normalSamples[1] = texture2D(t, uvSamples[1]);\n    normalSamples[2] = texture2D(t, uvSamples[2]);\n    normalSamples[3] = texture2D(t, uvSamples[3]);\n    normalSamples[4] = texture2D(t, uvSamples[4]);\n    normalSamples[5] = texture2D(t, uvSamples[5]);\n    normalSamples[6] = texture2D(t, uvSamples[6]);\n    normalSamples[7] = texture2D(t, uvSamples[7]);\n    normalSamples[8] = texture2D(t, uvSamples[8]);\n\n    float depthBias = 0.0001;\n    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!\n    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n\n    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {\n        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;\n        if (gl_FragCoord.z > depthAtSample) {\n           return 0.0;\n        }\n    }\n\n    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);\n  \tvec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);\n\n    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));\n    return edgeNormal;\n}\n");return{outline:new dM("vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {\n                vec3 result = outlineColor;\n                float resultAlpha = 0.0;\n\n                vec3 N = normalize(vWNormal);\n                vec2 nuv = (gl_FragCoord.xy / resolution);\n                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);\n                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);\n\n                //resultAlpha = 1.0;\n                //result = vec3(sobelSample);\n\n                float t = 1.0 - contourThreshold;\n                if(positionalLines) {\n                    vec3 NDir = position * contourDirection;\n                    float NT = NDir.x + NDir.y + NDir.z;\n                    float f  = fract(NT * contourFrequency * 0.01);\n                    float df = fwidth(NT * contourFrequency);\n\n                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);\n                    if (g < 1.0 && resultAlpha == 0.0) {\n                        result = contourColor;\n                        resultAlpha = 1.0;\n                    }\n                 }\n                 else {\n                    vec3 NDir = N * contourDirection;\n                    float NT = NDir.x + NDir.y + NDir.z;\n                    float df = fwidth(NT * contourThreshold);\n                    float f = sin(NT * 1.0 * contourFrequency);\n                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);\n\n                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {\n                        result = contourColor;\n                        resultAlpha = 1.0 - g;\n                    }\n                 }\n\n                 float lalpha = alpha * resultAlpha * mask;\n                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\t\t\t\t \n                 return result;\n             }",[e])}}();var xN=class extends rM{constructor(e,t,n,i,r,s,a,o,l,c,h,u,d,p,f,m,g,v){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=n,this.blending=i,this.offset=r,this.colorA=s,this.colorB=a,this.frequency=o,this.size=l,this.variation=c,this.smoothness=h,this.zigzag=u,this.rotation=d,this.vertical=p,this.horizontal=f,this.sides=m,this.isMask=v,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let n;switch(e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float"),this.style.value){case 0:default:n="circle";break;case 1:n="ring";break;case 2:n="polygon";break;case 3:n="xcross";break;case 4:n="diamond";break;case 5:n="checkerboard";break;case 6:n="line";break;case 7:n="wave"}let i=`g${this.uuid.toString().replace(/-/g,"")}`,r=new dM("float hashwithoutsine12(vec2 p)\n\t\t\t\t{\n\t\t\t\t\tvec3 p3 = fract(vec3(p.xyx) * .1031);\n\t\t\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t\t\t}"),s=new dM("vec2 rotate_uv(in vec2 uv, float a, bool repeat) \n\t\t\t\t{\n\t\t\t\t\tconst float mid = 0.5;\n\t\t\t\t\tfloat radians = a * (PI / 180.0);\n\t\t\t\t\tvec2 rotated = vec2(\n\t\t\t\t\t\tcos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,\n\t\t\t\t\t\tcos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid\n\t\t\t\t\t);\n\t\t\t\t\treturn repeat ? fract(rotated): rotated;\n\t\t\t\t}"),a="";if(4===this.projection.value){a=`\n\t\t\t\tvec3 p = position;\n\t\t\t\tfloat factor = 0.0125;\n\t\t\t\tvec2 uv0 = fract(p.xy * factor);\n\t\t\t\tvec2 uv1 = fract(p.zy * factor);\n\t\t\t\tvec2 uv2 = fract(p.xz * factor);\n\t\t\t\t\n\t\t\t\tuv0 = rotate_uv(uv0 + offset, rotation, true);\n\t\t\t\tuv1 = rotate_uv(uv1 + offset, rotation, true);\n\t\t\t\tuv2 = rotate_uv(uv2 + offset, rotation, true);\n\t\n\t\t\t\tfloat d0 = ${2===this.style.value?`${n}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`};\n\t\t\t\tfloat d1 = ${2===this.style.value?`${n}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`};\n\t\t\t\tfloat d2 = ${2===this.style.value?`${n}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`};\n\t\t\t\t\n\t\t\t\t// Range from 3 to 128 seems to be good\n\t\t\t\tfloat exponent = (1.0 - blending) * 125.0 + 3.0;\n\n\t\t\t\tvec3 n = vObjectNormal;\n\t\t\t\tvec3 weights = abs(normalize(n));\n\t\t\t\tweights = pow(weights, vec3(exponent));\n\t\t\t\tweights /= dot(weights, vec3(1.0));\n\t\t\t\td0 *= weights.z;\n\t\t\t\td1 *= weights.x;\n\t\t\t\td2 *= weights.y;\n\t\t\t\tfloat draw = d0 + d1 + d2;\n\t\n\t\t\t\tvec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;\n\t\t\t\t`}else{let e=2===this.style.value?`${n}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,t="";0===this.axis.value?t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.y, p.z);\n\t\t\t\t\tfloat phi = acos(p.x / radius);":1===this.axis.value?t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.x, p.z);\n\t\t\t\t\tfloat phi = acos(p.y / radius);":(this.axis.value,t="float radius = length(p);\n\t\t\t\t\tfloat theta = atan(p.y, p.x);\n\t\t\t\t\tfloat phi = acos(p.z / radius);");let i="";switch(this.projection.value){case 0:i="custom_uv = vUv.st;";break;case 1:case 3:default:break;case 2:i=`\n\t\t\t\t\t\t\tvec3 p = position;\n\t\t\t\t\t\t\t${t}\n\t\t\t\t\t\t\tcustom_uv = vec2(theta, phi);\n\t\t\t\t\t\t\tcustom_uv /= PI;\n\t\t\t\t\t\t\t`}a=`\n\t\t\t\tvec2 custom_uv;\n\t\t\t\t${i}\n\t\n\t\t\t\tcustom_uv += offset;\n\t\t\t\tcustom_uv = fract(custom_uv);\n\t\t\t\tcustom_uv = rotate_uv(custom_uv, rotation, true);\n\t\n\t\t\t\tfloat draw = ${e};\n\t\t\t\t`}let o=new dM(`vec3 ${i}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\t\tconst float TWO_PI = PI * 2.0;\n\t\t\t\t\tfloat smoothness_remapped = pow(smoothness, 5.0);\t\n\n\t\t\t\t\t${a}\n\n\t\t\t\t\t// Construct final output color\n\t\t\t\t\tvec4 color = mix(colorA, colorB, draw);\n\t\t\t\t\tcolor.a = clamp(color.a, 0.0, 1.0);\n\n\t\t\t\t\t// Apply cuts\n\t\t\t\t\tcolor.a *= \n\t\t\t\t\t\tstep(vertical.x, custom_uv.y) * \n\t\t\t\t\t\tstep(custom_uv.y, vertical.y);\n\t\t\t\t\tcolor.a *= \n\t\t\t\t\t\tstep(horizontal.x, abs(custom_uv.x)) * \n\t\t\t\t\t\tstep(abs(custom_uv.x), horizontal.y);\n\n\t\t\t\t\t// Accumulate alpha \n\t\t\t\t\tfloat lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;\n\t\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\t\treturn clamp(color, 0.0, 1.0).rgb;\n\t\t\t\t}`,[s,r,xN.DrawFunctions.circle,xN.DrawFunctions.ring,xN.DrawFunctions.polygon,xN.DrawFunctions.cross,xN.DrawFunctions.diamond,xN.DrawFunctions.checkerboard,xN.DrawFunctions.line,xN.DrawFunctions.wave]),l=e.include(o),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},EN=xN;EN.DrawFunctions=function(){let e=new dM("float hashwithoutsine12(vec2 p) {\n\t\t\t\tvec3 p3 = fract(vec3(p.xyx) * 0.1031);\n\t\t\t\tp3 += dot(p3, p3.yzx + 33.33);\n\t\t\t\treturn fract((p3.x + p3.y) * p3.z);\n\t\t\t}"),t=new dM("vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {\n                // Create tiles in UV-space\n                uv *= frequency;\n\n                // Integer coords\n                vec2 i = floor(uv);\n\n                // Offset every other row based on zigzag param, then compute fractional coords\n                float row_offset = mod(i.y, 2.0);\n                uv.x += row_offset * zigzag;\n                vec2 f = fract(uv);\n\n\t\t\t\t// Rotate the tile itself:\n\t\t\t\t// const float mid = 0.5;\n\t\t\t\t// f = vec2(\n\t\t\t\t// \tcos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,\n\t\t\t\t// \tcos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid\n\t\t\t\t// );\n\t\t\t\t// f = fract(f);\n\n                f = f * 2.0 - 1.0;\n\n\t\t\t\t// Recompute integer coords after shifting - then, random value per tile \n\t\t\t\ti = floor(uv);\n\t\t\t\tfloat rand = (hashwithoutsine12(i) * 5.0 + 1.0);\n\t\t\t\tfloat jitter = mix(1.0, rand, variation);\n\t\t\t\tf *= jitter;\n\n                return f;\n            }",[e]);return{tileAndCenter:t,circle:new dM("float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(\n                    -smoothness, \n                     smoothness, \n                     length(f) - size\n                );\n            }",[t]),ring:new dM("float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n\n\t\t\t\tfloat d = length(f);\n                const float inner_width = 0.5;\n\n                float outer = smoothstep(-smoothness, smoothness, d - size);\n                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);\n\t\t\t\treturn outer + (1.0 - inner);   \n            }",[t]),polygon:new dM("float sdf_ngon(in vec2 p, in float r, in int n) {\n                float an = (PI * 2.0) / float(n);\n                float he = r * tan(0.5 * an);\n                \n                // Rotate to first sector\n                p = -p.yx; \n                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);\n                vec2  cs = vec2(cos(bn), sin(bn));\n                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;\n            \n                // Side of polygon\n                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);\n            }\n            \n            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));\n            }",[t]),cross:new dM("float sdf_cross(in vec2 p, in vec2 b, float r ) {\n                p = abs(p); \n\t\t\t\tp = (p.y > p.x) ? p.yx : p.xy;\n                vec2  q = p - b;\n                float k = max(q.y, q.x);\n                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);\n                return sign(k) * length(max(w, 0.0)) + r;\n            }\n            \n            // Avoid namespace conflicts \n            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));\n            }",[t]),diamond:new dM("float ndot(vec2 a, vec2 b) { \n                return a.x*b.x - a.y*b.y; \n            }\n            \n            float sdf_diamond(in vec2 p, in vec2 b) {\n                p = abs(p);\n                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);\n                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));\n                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);\n            }\n\n            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);\n\t            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));\n            }",[t]),checkerboard:new dM("float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                uv *= frequency;\n                vec2 i = floor(uv);\n\n                float offset = mod(i.y, 2.0);\n\n                uv.x += offset + zigzag * offset;\n                float x = floor(uv.x);\n                \n                return mod(x, 2.0);\n            }"),line:new dM("float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);\n\t\t\t\t\n\t\t\t\t// Different approach for variation param here\n\t\t\t\tfloat row = floor(uv * frequency).y;\n\t\t\t\tfloat rand = hashwithoutsine12(vec2(row));\n\t\t\t\tfloat s = mix(size, size * rand, variation);\n\n\t\t\t\treturn smoothstep(\n\t\t\t\t\ts - smoothness, \n\t\t\t\t\ts + smoothness, \n\t\t\t\t\tabs(f.y)\n\t\t\t\t);\n            }",[t]),wave:new dM("// Uses bisection \n            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {\n                // Convert all data to a primitive cosine wave\n                p = c * (p - vec2(d, a));\n                \n                const float TWO_PI = PI * 2.0;\n\n                // Reduce to principal half cycle\n                p.x = mod(p.x, TWO_PI); \n                if (p.x > PI) {\n                    p.x = TWO_PI - p.x;\n                }\n            \n                // Find zero of derivative (minimize distance)\n                float xa = 0.0;\n                float xb = TWO_PI;\n\n                // 24 bit precision\n                for (int i = 0; i < 24; i++) {\n                    float x = 0.5 * (xa + xb);\n                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));\n                    if (y < 0.0) xa = x; \n                    else xb = x;\n                }\n                float x = 0.5 * (xa + xb);\n                \n                // Compute distance    \n                vec2 q = vec2(x, b * c * cos(x));\n                return length(p - q) / c;\n            }\n\n            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {\n                float repeat = frequency.x;\n                uv *= repeat;\n                vec2 i = floor(uv);\n                float row_offset = mod(i.y, 2.0);\n                uv.x += row_offset * zigzag;\n                vec2 f = vec2(uv.x, fract(uv.y));\n\n                // Generalized cosine: y(x) = a + b * cos(cx + d)\n                const float amplitude = 0.125;\n                float wave_frequency = frequency.y * 0.1;\n                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);\n\n\t\t\t\t// Different approach for variation param here\n\t\t\t\tfloat rand = hashwithoutsine12(vec2(i.y));\n\t\t\t\tfloat s = mix(size, size * rand, variation);\n\n                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);\n            }")}}();var CN=class extends rM{constructor(e,t,n,i,r,s,a,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=n,this.noiseStrength=i,this.noiseScale=r,this.offset=s,this.isMask=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let n=e.include(CN.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(e,"f")),i.push(this.movement.build(e,"f")),i.push(this.wavelengths.build(e,"v3")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.offset.build(e,"v3")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},AN=CN;AN.Nodes=function(){let e=new dM("vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {\n\t\t\t\tfloat f = 0.0;\n\t\t\t\t\n\t\t\t\tif (noiseStrength != 0.0) {\n\t\t\t\t\tvec3 st = position / noiseScale;\n\t\t\t\t\tfloat noise = simplexFast(1.6 * st + vec3(1.8, 1.5, 1.9) * simplexFast(st) + vec3(1.7, 9.2, 1.0));\n\t\t\t\t\tf = noise * noiseStrength;\n\t\t\t\t}\n\n\t\t\t\tvec3 waves = wavelengths * vec3(1.0, 0.8, 0.6) + 1.0;\n\t\t\t\tfloat angle = dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal));\n\n\t\t\t\tmediump vec3 color = cos((((filmThickness + f) / waves) * angle) + movement);\n\t\t\t\treturn .5 + .5 * color;\n\t\t\t }",[vN.simplexFast]);return{rainbow:new dM("vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {\n\t\t\t\tmediump vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);\n\n\t\t\t\tfloat rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);\n\n\t\t\t\tfloat lalpha = alpha * rainbowContribution * mask;\n\t\t\t\tcalpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));\n\n\t\t\t\treturn res;\n\t\t\t }",[e])}}();var SN=class extends rM{constructor(e,t,n,i,r,s,a,o,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=n,this.source=i,this.isWorldSpace=r,this.noiseStrength=s,this.noiseScale=a,this.shadowColor=o,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let n=e.include(SN.Nodes.toon),i=[];return i.push(this.positioning.build(e,"i")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.source.build(e,"v3")),i.push(this.isWorldSpace.build(e,"b")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.shadowColor.build(e,"v4")),i.push(this.offset.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},_N=SN;_N.Nodes=function(){let e=new dM("float rand(float n) {\n\t\t\t\treturn fract(sin(n) * 43758.5453123);\n\t\t\t}"),t=new dM("float hash1(float p) { \n\t\t\t\tp = fract(p * 0.011); \n\t\t\t\tp *= p + 7.5; \n\t\t\t\tp *= p + p; \n\t\t\t\treturn fract(p); \n\t\t\t}"),n=new dM("float valueNoise(vec3 x) {\n\t\t\t\tconst vec3 step = vec3(110, 241, 171);\n\t\t\t\n\t\t\t\tvec3 i = floor(x);\n\t\t\t\tvec3 f = fract(x);\n\t\t\t \n\t\t\t\t// For performance, compute the base input to a 1D hash from the integer part of the argument and the \n\t\t\t\t// incremental change to the 1D based on the 3D -> 1D wrapping\n\t\t\t\tfloat n = dot(i, step);\n\t\t\t\n\t\t\t\tvec3 u = f * f * (3.0 - 2.0 * f);\n\t\t\t\treturn mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),\n\t\t\t\t\t\t\t   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),\n\t\t\t\t\t\t   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),\n\t\t\t\t\t\t\t   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);\n\t\t\t}",[t]),i=new dM("vec3 hash3(vec3 x) {\n\t\t\t\tx = vec3(dot(x,vec3(127.1, 311.7, 74.7)),\n\t\t\t\t\t\t dot(x,vec3(269.5, 183.3, 246.1)),\n\t\t\t\t\t\t dot(x,vec3(113.5, 271.9, 124.6)));\n\t\t\t\n\t\t\t\treturn fract(sin(x)*43758.5453123);\n\t\t\t}"),r=new dM('vec3 voronoiNoise(in vec3 x)\n\t\t\t{\n\t\t\t\tvec3 p = floor(x);\n\t\t\t\tvec3 f = fract(x);\n\n\t\t\t\tfloat id = 0.0;\n\t\t\t\tvec2 res = vec2(100.0);\n\n\t\t\t\tfor(int k=-1; k<=1; k++)\n\t\t\t\tfor(int j=-1; j<=1; j++)\n\t\t\t\tfor(int i=-1; i<=1; i++)\n\t\t\t\t{\n\t\t\t\t\tvec3 b = vec3(float(i), float(j), float(k));\n\n\t\t\t\t\t// Comment out the "+ hash(p + b);" part below to get "square" cells\n\t\t\t\t\tvec3 r = vec3(b) - f + hash3(p + b);\n\t\t\t\t\tfloat d = dot(r, r);\n\n\t\t\t\t\tif (d < res.x)\n\t\t\t\t\t{\n\t\t\t\t\t\tid = dot(p + b, vec3(1.0, 57.0, 113.0));\n\t\t\t\t\t\tres = vec2(d, res.x);\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\telse if (d < res.y)\n\t\t\t\t\t{\n\t\t\t\t\t\tres.y = d;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn vec3(sqrt(res), abs(id));\n\t\t\t}\n\t\t\t',[i]);return{toon:new dM('vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {\n\t\t\t\tfloat t = 0.0;\n\t\t\t\tfloat shadow = 1.0;\n\n\t\t\t\tif (positioning == 0) {\n\n\t\t\t\t\t// Can\'t do this mode if lighting is "none"\n\t\t\t\t\t#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))\n\n\t\t\t\t\t\t// Algorithm from Chapter 10 of Graphics Shaders\n\t\t\t\t\t\tconst vec3 weights = vec3(0.2125, 0.7154, 0.0721);\n\t\t\t\t\t\tvec3 lpos;\n\t\t\t\t\t\tvec3 l;\n\t\t\t\t\t\tfloat dproduct;\n\n\t\t\t\t\t\t#if (NUM_POINT_LIGHTS > 0)\n\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tPointLightShadow pointLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_POINT_LIGHTS; i++) {\n\t\t\t\t\t\t\t\t// Light positions are in view-space for some reason?\n\t\t\t\t\t\t\t\tlpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;\n\t\t\t\t\t\t\t\tl = normalize(lpos - worldPosition);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// TODO: we want to use "intensity" but it isn\'t available in the shader code\n\t\t\t\t\t\t\t\t//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);\n\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tpointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getPointShadow( \n\t\t\t\t\t\t\t\t\t\t\tpointShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowRadius,\n\t\t\t\t\t\t\t\t\t\t\tvPointShadowCoord[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowCameraNear, \n\t\t\t\t\t\t\t\t\t\t\tpointLightShadow.shadowCameraFar);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#if NUM_DIR_LIGHTS > 0 \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tDirectionalLightShadow directionalLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_DIR_LIGHTS; i++) {\n\t\t\t\t\t\t\t\t// Use the direction vector for directional lights instead\n\t\t\t\t\t\t\t\tl = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;\n\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tdirectionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getShadow( \n\t\t\t\t\t\t\t\t\t\tUNROLLED_LOOP_INDEX,\n\t\t\t\t\t\t\t\t\t\tdirectionalShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\tdirectionalLightShadow.shadowRadius, \n\t\t\t\t\t\t\t\t\t\tvDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0 \n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)\n\t\t\t\t\t\t\t\tSpotLightShadow spotLightShadow;\n\t\t\t\t\t\t\t#endif \n\n\t\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\t\tfor (int i = 0; i < NUM_SPOT_LIGHTS; i++) {\n\t\t\t\t\t\t\t\tlpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;\n\t\t\t\t\t\t\t\tl = normalize(lpos - worldPosition);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tdproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;\n\t\t\t\t\t\t\t\tt = max(t, dproduct);\n\n\t\t\t\t\t\t\t\t// Accumulate shadow contribution\n\t\t\t\t\t\t\t\t#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)\n\t\t\t\t\t\t\t\t\tspotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];\n\t\t\t\t\t\t\t\t\tshadow *= getShadow(\n\t\t\t\t\t\t\t\t\t\tUNROLLED_LOOP_INDEX,\n\t\t\t\t\t\t\t\t\t\tspotShadowMap[UNROLLED_LOOP_INDEX], \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowMapSize, \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowBias, \n\t\t\t\t\t\t\t\t\t\tspotLightShadow.shadowRadius, \n\t\t\t\t\t\t\t\t\t\tvSpotLightCoord[UNROLLED_LOOP_INDEX]);\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t#pragma unroll_loop_end\n\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\tt = clamp(t, 0.0, 1.0);\n\t\t\t\t\n\t\t\t\t\t#endif\n\n\t\t\t\t} else if (positioning == 1) {\n\t\t\t\t\t\n\t\t\t\t\tvec3 origin = mix(position, worldPosition, float(isWorldSpace));\n\t\t\t\t\tvec3 direction = normalize(source - origin);\n\t\t\t\t\tt = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;\t\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvec3 origin = worldPosition;\n\t\t\t\t\tvec3 source = cameraPosition - offset;\n\t\t\t\t\tvec3 direction = normalize(source - origin);\n\t\t\t\t\tt = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;\t\n\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\tif (noiseStrength > 0.0) {\n\t\t\t\t\t// Distort with noise\n\t\t\t\t\tvec3 st = position / noiseScale;\n\t\t\t\t\t\n\t\t\t\t\t// Voronoi "smooth" noise\n\t\t\t\t\tfloat noise = 1.0 - voronoiNoise(st).x;\n\n\t\t\t\t\t// Voronoi cellular noise\n\t\t\t\t\t//float noise = 1.0 - rand(voronoiNoise(st).z);\n\n\t\t\t\t\t// Position warp noise\n\t\t\t\t\t// vec3 offset = vec3(\n\t\t\t\t\t// \tsimplexFast(st),\n\t\t\t\t\t// \tsimplexFast(st + vec3(111.1, 143.89, 217.19)),\n\t\t\t\t\t// \tsimplexFast(st + vec3(171.1, 247.89, 117.23))\n\t\t\t\t\t// );\n\t\t\t\t\t// st += offset;\n\t\t\t\t\t// float noise = valueNoise(st);\n\n\t\t\t\t\tt += noise * noiseStrength;\n\t\t\t\t}\n\n\t\t\t\tt = clamp(t, 0.0, 1.0);\n\n\t\t\t\t// Compute ramp color\n\t\t\t\tfloat p;\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tfor (int i = 1; i < COLORS_MAX; i++) {\n\t\t\t\t\tp = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);\n\t\t\t\t\tcolor = mix(color, colors[i], smoothstep(0.0, 1.0, p));\n\t\t\t\t}\n\n\t\t\t\t// Incorporate custom shadow color\n\t\t\t\tif (positioning == 0) {\n\n\t\t\t\t\tvec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);\n\t\t\t\t\tcolor.rgb = mix(blendedShadow, color.rgb, shadow);\n\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\t// Accumulate alpha as usual\n\t\t\t\tfloat lalpha = alpha * color.a * mask;\n\t\t\t\tcalpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\n\t\t\t\treturn color.xyz;\n\n            }',[vN.simplexFast,e,n,r])}}();var TN={textureBicubic:new dM("float w0( float a ) {\n            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n        }\n    \n        float w1( float a ) {\n            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n        }\n    \n        float w2( float a ){\n            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n        }\n    \n        float w3( float a ) {\n            return ( 1.0 / 6.0 ) * ( a * a * a );\n        }\n    \n        // g0 and g1 are the two amplitude functions\n        float g0( float a ) {\n            return w0( a ) + w1( a );\n        }\n    \n        float g1( float a ) {\n            return w2( a ) + w3( a );\n        }\n    \n        // h0 and h1 are the two offset functions\n        float h0( float a ) {\n            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n        }\n    \n        float h1( float a ) {\n            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n        }\n    \n        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n            uv = uv * texelSize.zw + 0.5;\n    \n            vec2 iuv = floor( uv );\n            vec2 fuv = fract( uv );\n    \n            float g0x = g0( fuv.x );\n            float g1x = g1( fuv.x );\n            float h0x = h0( fuv.x );\n            float h1x = h1( fuv.x );\n            float h0y = h0( fuv.y );\n            float h1y = h1( fuv.y );\n    \n            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n    \n            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + \n                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n        }\n\n        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n            vec2 fLodSizeInv = 1.0 / fLodSize;\n            vec2 cLodSizeInv = 1.0 / cLodSize;\n            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n            return mix( fSample, cSample, fract( lod ) );\n        }")};var PN=class extends rM{constructor(e,t,n,i,r,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=n,this.transmissionSamplerSize=i,this.transmissionSamplerMap=r,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,DN.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let n=e.include(PN.Nodes.transmission),i=[];return i.push(this.thickness.build(e,"f")),i.push(this.ior.build(e,"f")),i.push(this.roughness.build(e,"f")),i.push(this.transmissionSamplerSize.build(e,"v2")),i.push(this.transmissionSamplerMap.getTexture(e,"t")),i.push(this.transmissionDepthMap.getTexture(e,"t")),i.push(this.aspectRatio.build(e,"v2")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},MN=PN;MN.Nodes=function(){let e=new dM("vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {\n                // Slightly modified version of this:\n                // https://www.shadertoy.com/view/ltScRG\n\n\t\t\t\t// Special case for blur == 0.0\n\t\t\t\tif (lod == 0.0) {\n\t\t\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\t\treturn texture2DLodEXT( sp, U, 0.0).rgb;\n\t\t\t\t\t#else\n\t\t\t\t\treturn textureLod( sp, U, 0.0).rgb;\n\t\t\t\t\t#endif\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec2 texelSize = vec2(1.0) / resolution;\n                vec2 halton = haltonSequence[frameIndex];\n                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n                float temporalAngle  = temporalOffset * PI2;\n\t\t\t\tvec3 res = vec3(0.0);\n                vec2 uv = vec2(0.0);\n                vec2 offset = vec2(0.0);\n                vec2 vogelSample = vec2(0.0);\n                for (int i = 0; i < NUM_SAMPLES; i++) {\n                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;\n                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20\n                    uv = U + offset;\n                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));\n                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {\n                        uv = unrefractedU;\n                        lod = lod > 4.0 ? lod : lod / 2.0;\n                    }\n                    res += textureLod(sp, uv, lod).rgb;\n                }\n                return res / float(NUM_SAMPLES);\n            }"),t=new dM("vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\t        // Direction of refracted light.\n\t\t        vec3 refractionVector = refract( -v,  n, 1.0 / ior );\n\t\t        \n\t\t\t\t// Compute rotation-independant scaling of the model matrix.\n\t\t        vec3 modelScale;\n\t\t        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\t        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\t        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\n\t\t        // The thickness is specified in local space\n\t\t        return normalize( refractionVector ) * thickness * modelScale;\n\t        }"),n=new dM("float applyIorToRoughness( float roughness, float ior ) {\n\t\t\t\t// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n\t\t\t\t// an IOR of 1.5 results in the default amount of microfacet refraction.\n\t\t\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t\t\t}"),i=new dM('vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {\n\t\t\t\t// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see\n\t\t\t\t// also the code in convertTransmission.ts, which runs during export\n\t\t\t\t#ifdef IS_THREEJS_EXPORT\n\t\t\t\t\tfloat lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);\n\t\t\t\t\treturn textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;\n\t\t\t\t#else\n\t\t\t\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t\t\t\tfloat lod = applyIorToRoughness(roughness, ior);\n\t\t\t\t\treturn blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);\n\t\t\t\t#endif\n\t\t\t}',[TN.textureBicubic,n,e]),r=new dM("vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\n\t\t\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\n\t\t\t\tvec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );\n\t\t\t\tvec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;\n\t\t\t\tunrefractedCoords += 1.0;\n\t\t\t\tunrefractedCoords /= 2.0;\n\n\t\t\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\t\t\treturn getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );\n    \t\t}",[i,t]);return{transmission:new dM("vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {\n                vec3 v = vec3(0.);\n                if (isOrthographic) {\n                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n                } else {\n                    v = normalize(vWPosition - cameraPosition);\n                }\n                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );\n                \n\t\t\t\tfloat lalpha = alpha * mask;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * alpha;\n\n\t\t\t\treturn transmission;\n            }",[r])}}();var NN=(e=>(e.NOISE="noise",e.MAP="map",e))(NN||{}),IN=class extends rM{constructor(e,t,n,i,r,s,a,o,l,c,h){super("v3"),this.displacementTypeIndex=new qM(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,"map"===Object.values(NN)[this.displacementTypeIndex.value]&&(this.mat=new JM(this.movementOrTexture.value.matrix)),this.cropOrOffset=n,this.scale=c,this.noiseFunctionIndex=h,this.voronoiStyle=i,this.smoothness=r,this.seed=s,this.highCut=a,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let n,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(NN)[this.displacementTypeIndex.value]){case"map":n=e.include(IN.Nodes.map),i.push(this.movementOrTexture.getTexture(e,"t")),i.push("uv"),i.push(this.cropOrOffset.build(e,"f")),this.mat&&i.push(this.mat.build(e,"mat3"));break;case"noise":{let t=["simplexPrecise","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseFunctionIndex.value],r=new dM("vec3 orthogonal(vec3 v) {\n\t\t\t\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t\t\t\t}"),s=new dM(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {\n\t\t\t\t\t\t\t${"voronoi"==t?`\n\t\t\t\t\tfloat v = ${t}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);\n\t\t\t\t\tv = remap(v, lowCut, highCut, 0.0, 1.0);\n\t\t\t\t\tv = smax(v, 0.0, smoothness * 0.25);\n\t\t\t\t\tv = smin(v, 1.0, smoothness * 0.25);\n\n\t\t\t\t\treturn p + n * v * intensity;\n\t\t\t\t\t`:`\n\t\t\t\t\treturn p + n * ${t}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;\n\t\t\t\t\t`}\n\t\t\t\t\t\t}`,[vN.simplexPrecise,vN.simplexFractal,vN.simplexAshima,vN.fbm,vN.perlin,vN.voronoi]),a=new dM("vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {\n\t\t\t\t\t\t\tvec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tvec3 tangent1 = orthogonal(normal);\n\t\t\t\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\n                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.\n                            // This caused some small oval/circular visual artifacts in the lighting.\n                            // For now, simply using neighbors further away betters the problem,\n                            // but we should figure out the underlying cause when we have some time.\n                            // Maybe its related to how we calculate the tangent and bitangent?\n\t\t\t\t\t\t\tvec3 nearby1 = position + tangent1;\n\t\t\t\t\t\t\tvec3 nearby2 = position + tangent2;\n\t\t\t\t\t\t\tvec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tvec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);\n\t\t\t\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\t\t\t\treturn displaced_position;\n\t\t\t\t\t\t}",[s,r]);n=e.include(a),i.push(this.scale.build(e,"f")),i.push(this.cropOrOffset.build(e,"v3")),i.push(this.movementOrTexture.build(e,"f")),i.push(this.voronoiStyle.build(e,"i")),i.push(this.smoothness.build(e,"f")),i.push(this.seed.build(e,"f")),i.push(this.highCut.build(e,"f")),i.push(this.lowCut.build(e,"f")),i.push(this.quality.build(e,"i"));break}}return i.push(this.intensity.build(e,"f")),i.push("displaced_normal"),e.format(n+"("+i.join(",")+")",this.getType(e),t)}return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},ON=IN;ON.Nodes=function(){let e=new dM("vec3 orthogonal(vec3 v) {\n\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t}"),t=new dM("float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {\n\t\t\t\tvec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;\n\t\t\t\tvec4 tmp = texture2D(tex, uvs);\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tif (crop > 0.5) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\treturn 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn col.r;\n\t\t\t}");return{map:new dM("vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {\n\t\t\t\tvec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;\n\t\t\t\tvec3 tangent1 = normalize(orthogonal(normal));\n\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\t\t\t\tvec3 nearby1 = position + tangent1 * 0.1;\n\t\t\t\tvec3 nearby2 = position + tangent2 * 0.1;\n\t\t\t\tvec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tvec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\treturn displaced_position;\n\t\t\t}",[e,t])}}();var DN={normalRenderTarget:new CM,normalRenderTargetDepth:new CM,transmissionRenderTarget:new CM,aspectRatio:new aM,transmissionSize:new aM(2048,2048),transmissionRenderTargetDepth:new CM,aoRenderTarget:new CM,aoEnabled:new KM,pixelRatioNode:new AM(1),resolution:new aM,penumbraSize:new YM(5,.5),frameIndex:new qM(0),transmissionLod:new qM(2)};for(let n of Object.values(DN))n.isRenderGlobal=!0;var LN,RN={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.9.87/build/ui.wasm"},kN=class extends tM{constructor(){super("basic"),this.nodeType="Basic",this.color=new GM(yx),this.shadingAlpha=new AM(1),this.shadingBlend=new qM(0),this.previousModelViewMatrix=new $M,this.previouseProjectionMatrix=new $M}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:DN.frameIndex}),e.mergeUniform({resolution:DN.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(ks.merge([ta.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>"].join("\n"));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","\tvNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join("\n")}else{void 0===this.color&&(this.color=new GM(yx)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let n=this.color.flow(e,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(e,"f"):void 0,r=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=void 0!==i,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join("\n"));let a=["#include <normal_fragment_begin>",n.code];i&&a.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),s?a.push(s.code,`vec3 outgoingLight = ${n.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):a.push(`vec3 finalColor = ${n.result};`);let o="1.0";this.mask&&(this.mask.analyze(e),o=`luminance(${this.mask.flow(e,"v3").result})`),i?a.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} * ${o} );`):a.push("gl_FragColor = vec4("+n.result+", 1.0 );"),r&&a.push(`gl_FragColor.a *= ${r.result};`),a.push("#include <fog_fragment>","#include <dithering_fragment>"),t=a.join("\n")}return t}},BN=class extends tM{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new GM(yx),this.emissive=new GM(0),this.emissiveIntensity=new AM(1),this.previousModelViewMatrix=new $M,this.previouseProjectionMatrix=new $M,this.shadingAlpha=new AM(1),this.shadingBlend=new qM(0),this.occlusion=new KM(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:DN.frameIndex}),e.mergeUniform({resolution:DN.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(ks.merge([ta.fog,ta.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("\t#include <project_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\n\t\t\t\t\tvec3 diffuse = vec3( 1.0 );\n\t\t\t\t\tGeometricContext geometry;\n\t\t\t\t\tgeometry.position = mvPosition.xyz;\n\t\t\t\t\tgeometry.normal = normalize( transformedNormal );\n\t\t\t\t\tgeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\t\t\t\t"),i.push("\n\t\t\t\t\tGeometricContext backGeometry;\n\t\t\t\t\tbackGeometry.position = geometry.position;\n\t\t\t\t\tbackGeometry.normal = -geometry.normal;\n\t\t\t\t\tbackGeometry.viewDir = geometry.viewDir;\n\t\t\t\t\tvLightFront = vec3( 0.0 );\n\t\t\t\t\tvIndirectFront = vec3( 0.0 );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvLightBack = vec3( 0.0 );\n\t\t\t\t\t\tvIndirectBack = vec3( 0.0 );\n\t\t\t\t\t#endif\n\t\t\t\t\tIncidentLight directLight;\n\t\t\t\t\tfloat dotNL;\n\t\t\t\t\tvec3 directLightColor_Diffuse;\n\t\t\t\t\tvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\n\t\t\t\t\tvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\t\t\t\t\t\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_POINT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_DIR_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_HEMI_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join("\n")}else{e.mergeUniform({penumbraSize:DN.penumbraSize}),e.mergeUniform({frameIndex:DN.frameIndex}),e.mergeUniform({aoMap:DN.aoRenderTarget}),e.mergeUniform({aoEnabled:DN.aoEnabled}),void 0===this.color&&(this.color=new GM(yx)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let n=this.color.flow(e,"c",{slot:"color"}),i=this.emissive.flow(e,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==c,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join("\n"));let u=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx, viewdy));\n\t\t\t\tbool isFrontFacing = (dot(normal, faceNormal) >= 0.0);\n\t\t\t\t","#include <clipping_planes_fragment>"];u.push(n.code,"vec3 diffuseColor = "+n.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("#ifdef DOUBLE_SIDED","\treflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","\treflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","\treflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","\treflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&u.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+r.result+";"),u.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );\n\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&u.push(`gl_FragColor.a *= ${h.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join("\n")}return t}},UN={dHdxy:new dM("vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {\n\n            // Gradient of UVs w.r.t. X coordinate (in screen-space)\n            vec2 dSTdx = dFdx(bumpMapUv);\n\n            // Gradient of UVs w.r.t. Y coordinate (in screen-space)\n            vec2 dSTdy = dFdy(bumpMapUv);\n            \n            // Forward differencing\n            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);\n            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;\n            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;\n            \n            return vec2( dBx, dBy );\n        }"),perturbNormalArb:new dM("vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n            vec3 vSigmaX = dFdx( surf_pos.xyz );\n            vec3 vSigmaY = dFdy( surf_pos.xyz );\n            vec3 vN = surf_norm; // normalized\n            \n            vN = normalize(vN);\n\n            vec3 R1 = cross( vSigmaY, vN );\n            vec3 R2 = cross( vN, vSigmaX );\n\n            R1 = normalize(R1);\n            R2 = normalize(R2);\n    \n            float fDet = dot( vSigmaX, R1 ) * faceDirection;\n    \n            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n            return normalize( abs( fDet ) * vN - vGrad );\n        }")},zN=class extends tM{constructor(){super("phong"),this.nodeType="Phong",this.color=new GM(yx),this.specular=new GM(1118481),this.shininess=new AM(30),this.previousModelViewMatrix=new $M,this.previouseProjectionMatrix=new $M,this.shadingAlpha=new AM(1),this.shadingBlend=new qM(0),this.occlusion=new KM(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:DN.frameIndex}),e.mergeUniform({resolution:DN.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(ks.merge([ta.fog,ta.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("\t#include <project_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join("\n")}else{e.mergeUniform({penumbraSize:DN.penumbraSize}),e.mergeUniform({frameIndex:DN.frameIndex}),e.mergeUniform({aoMap:DN.aoRenderTarget}),e.mergeUniform({aoEnabled:DN.aoEnabled}),void 0===this.color&&(this.color=new GM(yx)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let n=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),r=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==c,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join("\n"));let u=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tBlinnPhongMaterial material;"];if(this.bumpMap){e.include(UN.dHdxy),e.include(UN.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),n=this.bumpMap.flow(e,"v3"),i=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",r="";r=4===this.bumpMap.projection.value?`\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(${t.result}, uv0, ${i});\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(${t.result}, uv1, ${i});\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(${t.result}, uv2, ${i});\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t`:`\n\t\t\t\t\tvec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(${t.result}, bumpMapCachedUv, ${i});\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t${n.result};\n\t\t\t\t\t${r}\n\t\t\t\t\t`)}u.push(i.code,"\tvec3 diffuseColor = "+i.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","\tvec3 totalEmissiveRadiance = emissive;",r.code,"\tvec3 specular = "+r.result+";",s.code,"\tfloat shininess = max( 0.0001, "+s.result+" );","\tfloat specularStrength = 1.0;"),c&&u.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );\n\t\t\t\t\t\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&u.push(`gl_FragColor.a *= ${h.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join("\n")}return t}},FN=class extends tM{constructor(){super("standard"),this.nodeType="Standard",this.color=new GM(yx),this.roughness=new AM(.3),this.metalness=new AM(0),this.reflectivity=new AM(.5),this.previousModelViewMatrix=new $M,this.previouseProjectionMatrix=new $M,this.shadingAlpha=new AM(1),this.shadingBlend=new qM(0),this.occlusion=new KM(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:DN.frameIndex}),e.mergeUniform({resolution:DN.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(ks.merge([ta.fog,ta.lights])),ta.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join("\n")}else{e.mergeUniform({penumbraSize:DN.penumbraSize}),e.mergeUniform({frameIndex:DN.frameIndex}),e.mergeUniform({aoMap:DN.aoRenderTarget}),e.mergeUniform({aoEnabled:DN.aoEnabled});let n={gamma:!0};void 0===this.color&&(this.color=new GM(yx)),this.color.analyze(e,{slot:"color",context:n}),this.roughness.analyze(e),this.metalness.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let r=this.color.flow(e,"c",{slot:"color",context:n}),s=this.roughness.flow(e,"f"),a=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,h=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=void 0!==h,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join("\n"));let p=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(UN.dHdxy),e.include(UN.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),n=this.bumpMap.flow(e,"v3"),i=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",r="";r=4===this.bumpMap.projection.value?`\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(${t.result}, uv0, ${i});\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(${t.result}, uv1, ${i});\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(${t.result}, uv2, ${i});\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t`:`\n\t\t\t\t\tvec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(${t.result}, bumpMapCachedUv, ${i});\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t${n.result};\n\t\t\t\t\t${r}\n\t\t\t\t\t`)}if(p.push(r.code,"\tvec3 diffuseColor = "+r.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",a.code,"\tfloat metalnessFactor = "+a.result+";"),this.roughnessMap){let t=this.roughnessMap.texture.flow(e,"t"),n=this.roughnessMap.flow(e,"v3"),i="";i=4===this.roughnessMap.projection.value?`\n\t\t\t\t\tfloat roughnessChange = 1.0;\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;\n\n\t\t\t\t\t\tfloat r0 = luminance(texture(${t.result}, uv0).rgb) * roughnessScale;\n\t\t\t\t\t\tfloat r1 = luminance(texture(${t.result}, uv1).rgb) * roughnessScale;\n\t\t\t\t\t\tfloat r2 = luminance(texture(${t.result}, uv2).rgb) * roughnessScale;\n\n\t\t\t\t\t\troughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);\n\t\t\t\t\t}\n\t\t\t\t\tfloat roughnessFactor = roughnessChange * ${s.result};\n\t\t\t\t\t`:`\n\t\t\t\t\tvec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;\n\n\t\t\t\t\tvec4 vals = texture(${t.result},  roughnessMapCachedUv);\n\t\t\t\t\tfloat roughnessFactor = luminance(vals.rgb) * ${s.result};\n\t\t\t\t\t`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t${n.result};\n\n\t\t\t\t\tconst float roughnessScale = 1.0;\n\n\t\t\t\t\t${i}\n\t\t\t\t`)}else p.push(s.code,"\tfloat roughnessFactor = "+s.result+";");h&&p.push(h.code,"#ifdef ALPHATEST","\tif ( "+h.result+" <= ALPHATEST ) discard;","#endif"),p.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),p.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?p.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):p.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),p.push("#include <lights_fragment_begin>"),p.push("#include <lights_fragment_end>"),p.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let f="1.0";this.mask&&(this.mask.analyze(e),f=`luminance(${this.mask.flow(e,"v3").result})`),p.push(`\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${f} * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${f}, ${l.result} );\n\t\t\t\t\t\n\t\t\t\t\toutgoingLight *= ao;\n\t\t\t\t}\n\t\t\t\t`),c&&p.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),h?p.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${h.result} );`):p.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&p.push(`gl_FragColor.a *= ${u.result};`),p.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=p.join("\n")}return t}},jN=class extends tM{constructor(){super("toon"),this.nodeType="Toon",this.color=new GM(yx),this.specular=new GM(1118481),this.shininess=new AM(30),this.previousModelViewMatrix=new $M,this.previouseProjectionMatrix=new $M,this.shadingAlpha=new AM(1),this.shadingBlend=new qM(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:DN.frameIndex}),e.mergeUniform({resolution:DN.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(ks.merge([ta.fog,ta.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","\n\t\t\t\t#include <skinbase_vertex>\n\t\t\t\t#include <skinnormal_vertex>\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = objectNormal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#include <normal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join("\n")}else{e.mergeUniform({penumbraSize:DN.penumbraSize}),e.mergeUniform({frameIndex:DN.frameIndex}),e.mergeUniform({aoMap:DN.aoRenderTarget}),e.mergeUniform({aoEnabled:DN.aoEnabled}),void 0===this.color&&(this.color=new GM(yx)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let n=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),r=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=void 0!==l,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>","\n\t\t\t\t\tvarying vec3 vViewPosition;\n\t\t\t\t\tstruct ToonMaterial {\n\t\t\t\t\t\tvec3\tdiffuseColor;\n\t\t\t\t\t\tvec3\tspecularColor;\n\t\t\t\t\t\tfloat\tspecularShininess;\n\t\t\t\t\t\tfloat\tspecularStrength;\n\t\t\t\t\t};\n\t\t\t\t\tvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t\t\t\n\t\t\t\t\t\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\t\t\t\t\t\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n\t\t\t\t\t}\n\t\t\t\t\tvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\t\t\t\t\t}\n\t\t\t\t\t#define RE_Direct\t\t\t\tRE_Direct_Toon\n\t\t\t\t\t#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\t\t\t\t\t#define Material_LightProbeLOD( material )\t(0)\n\t\t\t\t\t","#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join("\n"));let h=["#include <normal_fragment_begin>","\n\t\t\t\t// NOTE: gl_FrontFacing alternative using face normal estimation.\n\t\t\t\tvec3 viewdx = dFdx(vViewPosition);\n\t\t\t\tvec3 viewdy = dFdy(vViewPosition);\n\t\t\t\tvec3 faceNormal = normalize(cross(viewdx,viewdy));\n\t\t\t\tif (dot(normal, faceNormal) < 0.0) {\n\t\t\t\t\tnormal *= -1.0;\n\t\t\t\t}\n\t\t\t\t","\tToonMaterial material;"];if(this.bumpMap){e.include(UN.dHdxy),e.include(UN.perturbNormalArb);let t=this.bumpMap.texture.flow(e,"t"),n=this.bumpMap.flow(e,"v3"),i=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",r="";r=4===this.bumpMap.projection.value?`\n\t\t\t\t\tvec3 bumpNormal = vec3(0.0);\n\t\t\t\t\t{\n\t\t\t\t\t\tvec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;\n\t\t\t\t\t\tvec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;\n\t\t\t\t\t\tvec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;\n\t\t\t\t\t\tvec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;\n\n\t\t\t\t\t\tvec2 grad0 = dHdxy(${t.result}, uv0, ${i});\n\t\t\t\t\t\tvec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);\n\n\t\t\t\t\t\tvec2 grad1 = dHdxy(${t.result}, uv1, ${i});\n\t\t\t\t\t\tvec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);\n\n\t\t\t\t\t\tvec2 grad2 = dHdxy(${t.result}, uv2, ${i});\n\t\t\t\t\t\tvec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;\n\t\t\t\t\t\tbumpNormal = normalize(bumpNormal);\n\t\t\t\t\t}\n\n\t\t\t\t\tnormal = bumpNormal;\n\t\t\t\t\t`:`\n\t\t\t\t\tvec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;\n\t\t\t\t\tvec2 grad = dHdxy(${t.result}, bumpMapCachedUv, ${i});\n\t\t\t\t\tnormal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );\n\t\t\t\t\t`,h.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates\n\t\t\t\t\t${n.result};\n\t\t\t\t\t${r}\n\t\t\t\t\t`)}h.push(n.code,"\tvec3 diffuseColor = "+n.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"\tvec3 specular = "+i.result+";",r.code,"\tfloat shininess = max( 0.0001, "+r.result+" );","\tfloat specularStrength = 1.0;"),l&&h.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let u="1.0";this.mask&&(this.mask.analyze(e),u=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${u} * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${u}, ${a.result} );\n\t\t\t\t}\n\t\t\t\t`),o&&h.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&h.push(`gl_FragColor.a *= ${c.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join("\n")}return t}},VN=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout((()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")}),this.timeout+1e3))}has(e){return this.cache.get(e)?.data}load(e){let t=Date.now(),n=this.cache.get(e);return void 0===n?(n={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,n)):(n.time=t,n.prev.next=n.next,n.next.prev=n.prev),n.prev=this.tail.prev,n.next=this.tail,this.tail.prev.next=n,this.tail.prev=n,this.scheduleCleanup(),n.data}},HN=class extends VN{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}};var WN=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,0===this.refCount&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount,0}},GN=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data),0}load(e){let t=this.cache.get(e);return void 0===t&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},qN=class extends WN{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo="video"===e.type,this.isBuffer=!0===e.isWebGLRenderTarget,this.loadPromise=this.updateSrc(this.isBuffer?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let e of Object.values(this._cache))for(let t of Object.values(e))for(let e of Object.values(t))e&&(e.image=this.img,e.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,"string"!=typeof e){var n=new FileReader;let t;n.readAsDataURL(new Blob([e],{type:"video/mp4"})),await new Promise((e=>{n.onloadend=n=>{t=n.target?.result,e(null)}})),this.img.src=t}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=function(e){return"string"==typeof e?e:(LN||(LN=new HN),LN.load(e))}(e),this.img.onload=t,await new Promise((e=>{this.img.onload=()=>{t(),e(null)}}))}getTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1008,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1006,i=this._cache[e]?.[t]?.[n];if(i)return i;{let i;return i=this.isBuffer?this.img.texture:this.isVideo?new rc(this.img,void 0,e,e):new Ri(this.img,void 0,e,e,n,t),this.loaded&&(i.needsUpdate=!0),void 0===this._cache[e]&&(this._cache[e]={}),void 0===this._cache[e][t]&&(this._cache[e][t]={}),this._cache[e][t][n]=i,i}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let n of Object.values(t))for(let t of Object.values(n))t&&(t.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[n,i]of Object.entries(t))for(let[t,r]of Object.entries(i))r?.dispose(),void 0!==this._cache[e]&&void 0!==this._cache[e][n]&&(this._cache[e][n][t]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},KN=class extends qN{};function YN(e,t){var n=function(e){if(!XN[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),n="06/25/2014, 00:00:00"===t||"\u200e06\u200e/\u200e25\u200e/\u200e2014\u200e \u200e00\u200e:\u200e00\u200e:\u200e00"===t;XN[e]=n?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return XN[e]}(t);return n.formatToParts?function(e,t){try{for(var n=e.formatToParts(t),i=[],r=0;r<n.length;r++){var s=QN[n[r].type];s>=0&&(i[s]=parseInt(n[r].value,10))}return i}catch(Hw){if(Hw instanceof RangeError)return[NaN];throw Hw}}(n,e):function(e,t){var n=e.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n);return[i[3],i[1],i[2],i[4],i[5],i[6]]}(n,e)}var QN={year:0,month:1,day:2,hour:3,minute:4,second:5};var XN={};function ZN(e,t,n,i,r,s,a){var o=new Date(0);return o.setUTCFullYear(e,t,n),o.setUTCHours(i,r,s,a),o}var JN=36e5,$N={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function eI(e,t,n){var i,r,s;if(!e||(i=$N.timezoneZ.exec(e)))return 0;if(i=$N.timezoneHH.exec(e))return nI(s=parseInt(i[1],10))?-s*JN:NaN;if(i=$N.timezoneHHMM.exec(e)){s=parseInt(i[1],10);var a=parseInt(i[2],10);return nI(s,a)?(r=Math.abs(s)*JN+6e4*a,s>0?-r:r):NaN}if(function(e){if(iI[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),iI[e]=!0,!0}catch{return!1}}(e)){t=new Date(t||Date.now());var o=n?t:function(e){return ZN(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}(t),l=tI(o,e),c=n?l:function(e,t,n){var i=e.getTime(),r=i-t,s=tI(new Date(r),n);if(t===s)return t;r-=s-t;var a=tI(new Date(r),n);return s===a?s:Math.max(s,a)}(t,l,e);return-c}return NaN}function tI(e,t){var n=YN(e,t),i=ZN(n[0],n[1]-1,n[2],n[3]%24,n[4],n[5],0).getTime(),r=e.getTime(),s=r%1e3;return i-(r-=s>=0?s:1e3+s)}function nI(e,t){return-23<=e&&e<=23&&(null==t||0<=t&&t<=59)}var iI={};var rI=Mt(Dt(),1),sI=Mt(Lt(),1),aI=36e5,oI=6e4,lI={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/};function cI(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(null===e)return new Date(NaN);var n=t||{},i=null==n.additionalDigits?2:(0,rI.default)(n.additionalDigits);if(2!==i&&1!==i&&0!==i)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());if("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))return new Date(e);if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var r=function(e){var t,n={},i=lI.dateTimePattern.exec(e);if(i?(n.date=i[1],t=i[3]):(i=lI.datePattern.exec(e),i?(n.date=i[1],t=i[2]):(n.date=null,t=e)),t){var r=lI.timeZone.exec(t);r?(n.time=t.replace(r[1],""),n.timeZone=r[1].trim()):n.time=t}return n}(e),s=function(e,t){var n,i=lI.YYY[t],r=lI.YYYYY[t];if(n=lI.YYYY.exec(e)||r.exec(e),n){var s=n[1];return{year:parseInt(s,10),restDateString:e.slice(s.length)}}if(n=lI.YY.exec(e)||i.exec(e),n){var a=n[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(r.date,i),a=s.year,o=function(e,t){if(null===t)return null;var n,i,r,s;if(0===e.length)return i=new Date(0),i.setUTCFullYear(t),i;if(n=lI.MM.exec(e),n)return i=new Date(0),r=parseInt(n[1],10)-1,fI(t,r)?(i.setUTCFullYear(t,r),i):new Date(NaN);if(n=lI.DDD.exec(e),n){i=new Date(0);var a=parseInt(n[1],10);return function(e,t){if(t<1)return!1;var n=pI(e);return!(n&&t>366||!n&&t>365)}(t,a)?(i.setUTCFullYear(t,0,a),i):new Date(NaN)}if(n=lI.MMDD.exec(e),n){i=new Date(0),r=parseInt(n[1],10)-1;var o=parseInt(n[2],10);return fI(t,r,o)?(i.setUTCFullYear(t,r,o),i):new Date(NaN)}if(n=lI.Www.exec(e),n)return s=parseInt(n[1],10)-1,mI(t,s)?hI(t,s):new Date(NaN);if(n=lI.WwwD.exec(e),n){s=parseInt(n[1],10)-1;var l=parseInt(n[2],10)-1;return mI(t,s,l)?hI(t,s,l):new Date(NaN)}return null}(s.restDateString,a);if(isNaN(o))return new Date(NaN);if(o){var l,c=o.getTime(),h=0;if(r.time&&(h=function(e){var t,n,i;if(t=lI.HH.exec(e),t)return n=parseFloat(t[1].replace(",",".")),gI(n)?n%24*aI:NaN;if(t=lI.HHMM.exec(e),t)return n=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),gI(n,i)?n%24*aI+i*oI:NaN;if(t=lI.HHMMSS.exec(e),t){n=parseInt(t[1],10),i=parseInt(t[2],10);var r=parseFloat(t[3].replace(",","."));return gI(n,i,r)?n%24*aI+i*oI+1e3*r:NaN}return null}(r.time),isNaN(h)))return new Date(NaN);if(r.timeZone||n.timeZone){if(l=eI(r.timeZone||n.timeZone,new Date(c+h)),isNaN(l))return new Date(NaN)}else l=(0,sI.default)(new Date(c+h)),l=(0,sI.default)(new Date(c+h+l));return new Date(c+h+l)}return new Date(NaN)}function hI(e,t,n){t=t||0,n=n||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var r=7*t+n+1-(i.getUTCDay()||7);return i.setUTCDate(i.getUTCDate()+r),i}var uI=[31,28,31,30,31,30,31,31,30,31,30,31],dI=[31,29,31,30,31,30,31,31,30,31,30,31];function pI(e){return e%400===0||e%4===0&&e%100!==0}function fI(e,t,n){if(t<0||t>11)return!1;if(null!=n){if(n<1)return!1;var i=pI(e);if(i&&n>dI[t]||!i&&n>uI[t])return!1}return!0}function mI(e,t,n){return!(t<0||t>52||null!=n&&(n<0||n>6))}function gI(e,t,n){return!(null!=e&&(e<0||e>=25)||null!=t&&(t<0||t>=60)||null!=n&&(n<0||n>=60))}function vI(e,t){return t.color(e)}function yI(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1?arguments[1]:void 0,n=t.format,i=e.getSeconds(),r=e;t&&null!==t.timeZone&&(r=function(e,t,n){var i=cI(e,n),r=eI(t,i,!0),s=new Date(i.getTime()-r),a=new Date(0);return a.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),a.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),a}(new Date,t.timeZone));let s,a=r.getHours(),o=r.getMinutes();"12ampm"===t.format12h24h&&(s=a>=12?"PM":"AM");let l,c,h=a;switch("24"!==t.format12h24h&&(h=a%12,0===h&&(h=12)),n){case"HH:mm:ss":l=[h,o,i];break;case"HH:mm":l=[h,o];break;case"HH":l=[h],s=void 0;break;case"mm":l=[o],s=void 0;break;case"ss":l=[i],s=void 0;break;case"year":c=r.getFullYear();break;case"month":c=r.getMonth()+1;break;case"dayOfYear":c=Math.floor((r.getTime()-new Date(r.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":c=r.getDate();break;case"secondOfDay":c=60*a*60+60*o+i;break;default:console.error("Unknown time format",n),c=0}return void 0!==l?{textValue:l,suffix:s}:c}function bI(e,t){switch(e.type){case"fresnel":return function(e,t){let{bias:n,scale:i,intensity:r,factor:s,color:a}=e;return{...xI(e,t),color:vI(a,t),bias:n,scale:i,intensity:r,factor:s}}(e,t);case"gradient":return function(e,t){let{gradientType:n,smooth:i,colors:r,steps:s,angle:a,offset:o,morph:l}=e;return{...xI(e,t),gradientType:n,smooth:i,colors:r.map((e=>new ki(e[0],e[1],e[2],e[3]))),num:r.length,steps:s,offset:new di(...o),morph:new di(...l),angle:a}}(e,t);case"depth":return function(e,t){let{gradientType:n,near:i,far:r,isVector:s,isWorldSpace:a,origin:o,direction:l,colors:c,steps:h,smooth:u}=e;return{...xI(e,t),gradientType:n,near:i,far:r,isVector:s,isWorldSpace:a,origin:new ji(...o),direction:l?new ji(...l):new ji(1,0,0),colors:c.map((e=>void 0!==e?new ki(e[0],e[1],e[2],e[3]):new ki(0,0,0,0))),steps:h.slice(0,c.length),smooth:u}}(e,t);case"normal":return function(e,t){let{cnormal:n}=e;return{...xI(e,t),cnormal:new ji(n[0],n[1],n[2])}}(e,t);case"noise":return function(e,t){return{...xI(e,t),scale:e.scale,move:e.move,fA:new di(...e.fA),fB:new di(...e.fB),size:new ji(...e.size),distortion:new di(...e.distortion),colorA:vI(e.colorA,t),colorB:vI(e.colorB,t),colorC:vI(e.colorC,t),colorD:vI(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}(e,t);case"rainbow":return function(e,t){return{...xI(e,t),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new ji(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new ji(...e.offset)}}(e,t);case"toon":return function(e,t){return{...xI(e,t),positioning:e.positioning,colors:e.colors.map((e=>new ki(e[0],e[1],e[2],e[3]))),num:e.colors.length,steps:e.steps,source:new ji(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:vI(e.shadowColor,t),offset:new ji(...e.offset)}}(e,t);case"outline":return function(e,t){return{...xI(e,t),outlineColor:vI(e.outlineColor,t),contourColor:vI(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new ji(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}(e,t);case"transmission":return function(e,t){return{...xI(e,t),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}(e,t);case"color":return function(e,t){return{...xI(e,t),color:vI(e.color,t)}}(e,t);case"pattern":return function(e,t){return{...xI(e,t),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new di(...e.offset),colorA:vI(e.colorA,t),colorB:vI(e.colorB,t),frequency:new di(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new di(...e.vertical),horizontal:new di(...e.horizontal),sides:e.sides}}(e,t)}}function wI(e){return{type:e.type}}function xI(e,t){let{alpha:n,mode:i,isMask:r}=e,s="string"==typeof n?(Number(t.getVariable(n))??100)/100:n;return{...wI(e),alpha:s,mode:i,isMask:r}}var EI=class extends lM{},CI={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},AI={depth:["colors"]};function SI(e,t,n){if("isMask"===t)return!0;let i=CI[e.type],r=AI[e.type];if(void 0!==r){let i=e.color;if(r.includes(t)){let e=i[t]?.value?.length;if(void 0!==e&&e!==n.length)return!0}}return void 0!==i&&i.includes(t)}function _I(e,t,n){let i=n.uniforms[`f${n.id}_texture`];if(!i)return!1;let r=!1,s=e;if("image"in s){let e=s.image,n=t.image(e),r=i;r.image instanceof KN||r.image.deref(),r.image=n}if("video"in s){let e=s.video,n=t.video(e),r=i;r.image instanceof KN||r.image.deref(),r.image=n}if("wrapping"in s){i.wrap=s.wrapping}if("minFilter"in s){i.minFilter=s.minFilter}if("magFilter"in s){i.magFilter=s.magFilter}if("rotation"in s&&n.uniforms[`f${n.id}_rotation`])return n.uniforms[`f${n.id}_rotation`].value=(s.rotation??0)*ui.DEG2RAD,r;if("repeat"in s||"offset"in s||"rotation"in s){let e="mat",t=n.uniforms[`f${n.id}_${e}`];"repeat"in s&&(t.repeat=s.repeat),"offset"in s&&(t.offset=s.offset),"rotation"in s&&(t.rotation=s.rotation??0),t.updateMatrix()}return r}var TI=(e,t,n)=>Math.max(0,Math.min(1,Number(t.getVariable("number"==typeof e?100*e:e,n)??100)/100))??1,PI=class{constructor(e,t,n,i,r){this.id=e,this.uuid=t,this.data=n,this.uniforms={};for(let s in i)this.uniforms[`f${this.id}_${s}`]=i[s];for(let s in n)DI(s,this,n,r)}get type(){return this.data.type}static create(e,t,n,i){if("light"===n.type)return II.createLightLayer(e,t,n,i);if("texture"===n.type||"video"===n.type){let r="texture"===n.type?i.uiBuffer(n.texture.image)??i.image(n.texture.image):i.video(n.texture.video),s=new ZM(r,n.texture.wrapping,n.texture.minFilter??1008,n.texture.magFilter??1006),a=new XM(r),o=new tN(n.texture.repeat,n.texture.offset,n.texture.rotation??0),l=new AM(n.crop?1:0),c=new qM(n.projection??0),h=new qM(["x","y","z"].indexOf(n.axis)??0),u=new qM(n.side??0),d=new aM(n.size?new di(n.size[0],n.size[1]):new di(100,100)),p=new AM(n.blending??0),f=new AM(TI(n.alpha,i)),m=new qM(n.mode??0),g=new KM(n.isMask??!1),v=new cN(s,a,l,c,h,u,d,p,o,f,m,g),y=new EM(v.calpha,"f");return new MI(e,t,n,{texture:s,textureSize:a,crop:l,projection:c,axis:h,side:u,size:d,blending:p,mat:o,alpha:f,mode:m,isMask:g},v,m,y,g,i)}if("matcap"===n.type){let r=i.image(n.texture.image),s=new ZM(r,n.texture.wrapping,n.texture.minFilter??1008,n.texture.magFilter??1006),a=new AM(TI(n.alpha,i)),o=new qM(n.mode??0),l=new KM(n.isMask??!1),c=new AM((n.texture.rotation??0)*ui.DEG2RAD),h=new gN(s,a,o,l,c),u=new EM(h.calpha,"f");return new MI(e,t,n,{texture:s,alpha:a,mode:o,isMask:l,rotation:c},h,o,u,l,i)}if("displace"===n.type){if("noise"===n.displacementType){let r=new oM(new ji(...n.offset)),s=new AM(n.scale??10),a=new AM(n.intensity??8),o=new AM(n.movement??1),l=new qM(n.noiseType??0),c=new qM(n.voronoiStyle??0),h=new AM(n.smoothness??.5),u=new AM(n.seed??0),d=new AM(n.highCut??1),p=new AM(n.lowCut??0),f=new qM(n.quality??1),m=new ON(a,o,r,c,h,u,d,p,f,s,l);return new NI(e,t,n,{offset:r,scale:s,intensity:a,movement:o,noiseType:l,voronoiStyle:c,smoothness:h,seed:u,highCut:d,lowCut:p,quality:f},m,i)}throw new Error}return function(e,t,n,i){let r=bI(n,i);return function(e,t,n,i,r){switch(e.type){case"color":{let s=new GM(i.color??yx),a=OI(i),o=new sN(s,a.alpha),l=new EM(o.calpha,"f");return new MI(t,n,e,{color:s,...a},o,a.mode,l,a.isMask,r)}case"fresnel":{let s=new GM(i.color??16777215),a=new AM(i.bias??.1),o=new AM(i.scale??1),l=new AM(i.intensity??2),c=new AM(i.factor??1),h=OI(i),u=new dN(s,a,o,l,c,h.alpha,h.mode,h.isMask),d=new EM(u.calpha,"f");return new MI(t,n,e,{color:s,bias:a,scale:o,intensity:l,factor:c,...h},u,h.mode,d,h.isMask,r)}case"rainbow":{let s=new AM(i.filmThickness??30),a=new AM(i.movement??0),o=new oM(i.wavelengths??new ji(0,0,0)),l=new AM(i.noiseStrength??0),c=new AM(i.noiseScale??1),h=new oM(i.offset??new ji(0,0,0)),u=OI(i),d=new AN(s,a,o,l,c,h,u.alpha,u.isMask),p=new EM(d.calpha,"f");return new MI(t,n,e,{filmThickness:s,movement:a,wavelengths:o,noiseStrength:l,noiseScale:c,offset:h,...u},d,u.mode,p,u.isMask,r)}case"transmission":{let s=new AM(i.thickness??10),a=new AM(i.ior??1.5),o=new AM(i.roughness??.5),l=DN.transmissionSize,c=DN.transmissionRenderTarget,h=DN.transmissionRenderTargetDepth,u=window.innerWidth,d=window.innerHeight,p=u>=d?new aM(d/u,1):new aM(1,u/d),f=OI(i),m=new MN(s,a,o,l,c,h,p,f.alpha),g=new EM(m.calpha,"f");return new MI(t,n,e,{thickness:s,ior:a,roughness:o,aspectRatio:p,...f},m,f.mode,g,f.isMask,r)}case"toon":{let s,a,o=new qM(i.positioning??0);i.colors?s=new nN(i.colors.length,i.colors):(s=new nN(10,new ki(0,0,0,1)),s.value[1]=new ki(1,1,1,1)),i.steps?a=new YM(i.steps.length,i.steps):(a=new YM(10,1),a.value[0]=0);let l=new oM(i.source??new ji(0,0,0)),c=new KM(i.isWorldSpace??!0),h=new AM(i.noiseStrength??0),u=new AM(i.noiseScale??1),d=new cM(i.shadowColor),p=new oM(i.offset??new ji(0,0,0)),f=OI(i),m=new _N(o,s,a,l,c,h,u,d,p,f.alpha),g=new EM(m.calpha,"f");return new MI(t,n,e,{positioning:o,colors:s,steps:a,source:l,isWorldSpace:c,noiseStrength:h,noiseScale:u,shadowColor:d,offset:p,...f},m,f.mode,g,f.isMask,r)}case"outline":{let s=new GM(i.outlineColor??16777215),a=new GM(i.contourColor??16777215),o=new AM(i.outlineWidth??.1),l=new AM(i.contourWidth??.1),c=new AM(i.outlineThreshold??.1),h=new AM(i.contourThreshold??.1),u=new AM(i.outlineSmoothing??.1),d=new AM(i.contourFrequency??.1),p=new oM(i.contourDirection??new ji(0,1,0)),f=new KM(i.positionalLines??!1),m=new KM(i.compensation??!0),g=DN.normalRenderTarget,v=DN.normalRenderTargetDepth,y=DN.pixelRatioNode,b=DN.resolution,w=OI(i),x=new wN(s,a,o,l,c,h,u,d,p,f,m,b,g,v,y,w.alpha),E=new EM(x.calpha,"f");return new MI(t,n,e,{outlineColor:s,contourColor:a,outlineWidth:o,contourWidth:l,outlineThreshold:c,contourThreshold:h,outlineSmoothing:u,contourFrequency:d,contourDirection:p,positionalLines:f,compensation:m,...w},x,w.mode,E,w.isMask,r)}case"depth":{let s,a,o=new qM(i.gradientType??0),l=new KM(i.smooth??!1),c=new AM(i.near??50),h=new AM(i.far??200),u=new AM(i.isVector??1),d=new AM(i.isWorldSpace??0),p=new oM(i.origin??new ji),f=new oM(i.direction??new ji);i.colors?s=new nN(i.colors.length,i.colors):(s=new nN(2,new ki(0,0,0,1)),s.value[1]=new ki(1,1,1,1)),i.steps?a=new YM(i.steps.length,i.steps):(a=new YM(2,1),a.value[0]=0);let m=OI(i),g=new uN(o,l,c,h,u,d,p,f,s,a,m.alpha,m.isMask),v=new EM(g.calpha,"f");return new MI(t,n,e,{gradientType:o,smooth:l,near:c,far:h,isVector:u,isWorldSpace:d,origin:p,direction:f,colors:s,steps:a,...m},g,m.mode,v,m.isMask,r)}case"noise":{let s=new AM(i.scale??1),a=new oM(i.size??new ji(100,100,100)),o=new AM(i.move??1),l=new aM(i.fA??new di(1.7,9.2)),c=new aM(i.fB??new di(8.3,2.8)),h=new aM(i.distortion??new di(1,1)),u=new cM(i.colorA),d=new cM(i.colorB),p=new cM(i.colorC),f=new cM(i.colorD),m=new qM(i.noiseType??0),g=new qM(i.voronoiStyle??0),v=new AM(i.highCut??1),y=new AM(i.lowCut??0),b=new AM(i.smoothness??.5),w=new AM(i.seed??.5),x=new qM(i.quality??1),E=OI(i),C=new yN(s,a,o,l,c,h,u,d,p,f,E.alpha,m,E.isMask,g,v,y,b,w,x),A=new EM(C.calpha,"f");return new MI(t,n,e,{scale:s,size:a,move:o,fA:l,fB:c,distortion:h,colorA:u,colorB:d,colorC:p,colorD:f,noiseType:m,...E,voronoiStyle:g,highCut:v,lowCut:y,smoothness:b,seed:w,quality:x},C,E.mode,A,E.isMask,r)}case"normal":{let s=new oM(i.cnormal??new ji(1,1,1)),a=OI(i),o=new oN(s,a.alpha),l=new EM(o.calpha,"f");return new MI(t,n,e,{cnormal:s,...a},o,a.mode,l,a.isMask,r)}case"gradient":{let s,a,o=new qM(i.gradientType??0),l=new KM(i.smooth??!1);i.colors?s=new nN(i.colors.length,i.colors):(s=new nN(10,new ki(0,0,0,1)),s.value[1]=new ki(1,1,1,1)),i.steps?a=new YM(i.steps.length,i.steps):(a=new YM(10,1),a.value[0]=0);let c=new aM(i.offset??new di(0,0)),h=new aM(i.morph??new di(0,0)),u=new AM(i.angle??0),d=OI(i),p=new fN(o,l,s,a,c,h,u,d.alpha,d.isMask),f=new EM(p.calpha,"f");return new MI(t,n,e,{gradientType:o,smooth:l,colors:s,steps:a,offset:c,morph:h,angle:u,...d},p,d.mode,f,d.isMask,r)}case"pattern":{let s=new qM(i.style??0),a=new qM(i.projection??0),o=new qM(["x","y","z"].indexOf(i.axis)??0),l=new AM(i.blending??0),c=new aM(i.offset??new di(0,0)),h=new cM(i.colorA),u=new cM(i.colorB),d=new aM(i.frequency??new di(10,10)),p=new AM(i.size??.5),f=new AM(i.variation??0),m=new AM(i.smoothness??.5),g=new AM(i.zigzag??0),v=new AM(i.rotation??0),y=new aM(i.vertical??new di(0,1)),b=new aM(i.horizontal??new di(0,1)),w=new qM(i.sides??6),x=OI(i),E=new EN(s,a,o,l,c,h,u,d,p,f,m,g,v,y,b,w,x.alpha,x.isMask),C=new EM(E.calpha,"f");return new MI(t,n,e,{style:s,projection:a,axis:o,blending:l,offset:c,colorA:h,colorB:u,frequency:d,size:p,variation:f,smoothness:m,zigzag:g,rotation:v,vertical:y,horizontal:b,sides:w,...x},E,x.mode,C,x.isMask,r)}default:{let s=new GM(1,0,0,1),a=OI(i),o=new sN(s,a.alpha),l=new EM(o.calpha,"f");return new MI(t,n,e,{color:s,...a},o,a.mode,l,a.isMask,r)}}}(n,e,t,r,i)}(e,t,n,i)}updateByOp(e,t,n){let i=e;if(void 0===i.path[0]){if(0===i.type)return"type"in i.props||"category"in i.props||"visible"in i.props||"noiseType"in i.props?(n.scene.markNeedsUpdateRendererDirty(),!0):function(e,t,n,i){let r=!1;for(let[s,a]of Object.entries(e)){if("bumpMap"===s||"roughnessMap"===s){r=!0;continue}if(!s||void 0===a)continue;if(DI(s,n,i,t)){"visible"===s&&"light"===n.type&&(r=!0);continue}n.visible=i.visible;let e=n.uniforms[`f${n.id}_${s}`];if(e&&!(e instanceof QM))switch(r=r||SI(n,s,a),e.constructor){case GM:if("string"==typeof a){let n=t.getColor(a);n&&(e.value=n);break}{let t=a;e.value instanceof EI?e.value=new lM(t.r,t.g,t.b,t.a):e.setRGBA(t);break}case cM:if("string"==typeof a){let n=t.getColor(a);n&&(e.value=n);break}{let t=a;e.value instanceof EI?e.value=new lM(t.r,t.g,t.b,t.a):e.value.setRGBA(t.r,t.g,t.b,t.a);break}case aM:{let t=a;e.value.setX(t[0]),e.value.setY(t[1]);break}case oM:{let t=a;e.value.setX(t[0]),e.value.setY(t[1]),e.value.setZ(t[2]);break}case CM:_I(a,t,n);break;case nN:e.value=a.map((e=>new ki(...e)));break;default:e.value=a}}return r}(i.props,n.shared,this,t)}else if("texture"===i.path[0])return!("texture"in t)&&!("video"in t)||_I(i.props,n.shared,this);return!1}dispose(){if(function(e){let t=e instanceof PI?e.type:e;return"texture"===t||"video"===t||"displace_map"===t||"matcap"===t}(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof KN||t.image.deref()}}hasValueByKey(e){return void 0!==this.uniforms[e]}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let n=`f${this.id}_${e}`;this.hasValueByKey(n)&&void 0!==t&&(this.uniforms[n].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let n=this.getName(t);n&&e.push(n)}return e}},MI=class extends PI{constructor(e,t,n,i,r,s,a,o,l){super(e,t,n,i,l),this.params=i,this.color=r,this.mode=s,this.alpha=a,this.isMask=o}},NI=class extends PI{constructor(e,t,n,i,r,s){super(e,t,n,i,s),this.position=r}},II=class extends PI{constructor(e,t,n,i,r,s){super(e,t,n,r,s),this.node=i}static createLightLayer(e,t,n,i){let r,s,a=new AM(TI(n.alpha,i)),o=new qM(n.mode),l=new AM(n.bumpMapIntensity),c=new AM(TI(n.alphaOverride,i));if(n.visible)if("lambert"===n.category){r=new BN;let e=new GM(i.color(n.emissive)??0),t=new KM(n.occlusion??!0);s={emissive:e,occlusion:t},r.emissive=e,r.occlusion=t}else if("toon"===n.category){r=new jN;let e=new AM(n.shininess??30),t=new GM(i.color(n.specular)??1118481);s={shininess:e,specular:t},r.shininess=e,r.specular=t}else if("physical"===n.category){r=new FN;let e=new AM(n.roughness??.3),t=new AM(n.metalness??0),i=new AM(n.reflectivity??.5),a=new KM(n.occlusion??!0);s={roughness:e,metalness:t,reflectivity:i,occlusion:a},r.roughness=e,r.metalness=t,r.reflectivity=i,r.occlusion=a}else{r=new zN;let e=new AM(n.shininess??30),t=new GM(void 0!==n.specular?i.color(n.specular)??1118481:1118481),a=new KM(n.occlusion??!0);s={shininess:e,specular:t,occlusion:a},r.shininess=e,r.specular=t,r.occlusion=a}else r=new kN,s={};return r.alpha=new AM(1),r.shadingAlpha=a,r.shadingBlend=o,r.bumpMapIntensity=l,r.alphaOverride=c,s.alpha=r.shadingAlpha,s.mode=r.shadingBlend,s.bumpMapIntensity=r.bumpMapIntensity,s.alphaOverride=r.alphaOverride,new II(e,t,n,r,s,i)}get category(){return this.node.category}};function OI(e){return{alpha:new AM(e.alpha??1),mode:new qM(e.mode??0),isMask:new KM(e.isMask??!1)}}function DI(e,t,n,i){if("displace"===n.type&&("intensity"===e||"visible"===e)){let e=t.uniforms[`f${t.id}_intensity`];return e?(e.value=n.intensity*(n.visible?1:0),e):void 0}if("displace"!==n.type&&("alpha"===e||"visible"===e)){let r=t.uniforms[`f${t.id}_alpha`];if(!r)return;if(r.value=TI(n.alpha,i)*(n.visible?1:0),"outline"===n.type&&"visible"===e){let e=t.uniforms[`f${t.id}_compensation`];e&&(e.value=n.compensation&&n.visible)}return r}}function LI(e,t){let n=0,i=e.layers.find((e=>"light"===e.data.type));if(i){let e=i.data,n=Number(t.getVariable(e.alphaOverride));if(("string"==typeof e.alphaOverride?n/100:e.alphaOverride)<1)return!0}for(let r of e.layers){if("displace"!==r.data.type&&r.data.isMask)return!0;if("displace"!==r.data.type&&"alpha"in r.data&&"light"!==r.data.type&&"fresnel"!==r.data.type&&"texture"!==r.data.type&&"matcap"!==r.data.type&&"rainbow"!==r.data.type&&"outline"!==r.data.type&&"pattern"!==r.data.type){let e=r.data.visible?r.data.alpha:0;if("string"==typeof e&&(e=Math.max(0,Math.min(1,Number(t.getVariable(e)??100)/100))),1===e&&"depth"===r.data.type||"gradient"===r.data.type){for(let t of r.data.colors)if(t[3]<1){e=t[3];break}}else if(1===e&&"noise"===r.data.type){let n=t.color(r.data.colorA).a,i=t.color(r.data.colorB).a,s=t.color(r.data.colorC).a,a=t.color(r.data.colorD).a,o=Math.min(n,Math.min(i,Math.min(s,a)));o<1&&(e=o)}n+=(1-n)*e}}return n<1}var RI=class extends Bs{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.shadersPatchedForShapeBlend=!1,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},kI=class extends RI{constructor(e,t,n,i){super(),this.flatShading=e,this.side=t,this.wireframe=n,this.root=i}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,Object.assign(this.defines,e.defines),Object.assign(this.uniforms,e.uniforms),this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,n,i){return this.root.getFlavor(e,t,n,i)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,n){this.root.updateByOp(e,t,n)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},BI=class extends RI{constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.data=e,this.allowVariableSaves=n,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=t.shared.needsJitter,tM.startContext(this),this.reset0(e,t),tM.endContext(this)}get nodeMaterial(){return this}getFlavor(e,t,n,i){let r=n?6:(e?3:0)+t;if(r+=7*((i?.resolutionLevel??0)-(i?.useChildrenColors?4:0)),0===r)return this;void 0===this.flavors&&(this.flavors=[]),r-=1;let s=this.flavors[r];return void 0===s&&(s=new kI(e,t,n,this),s.needsJitter=this.needsJitter,this.flavors[r]=s,s.flatShading=e,s.side=t,s.updateAfterBuild(),i&&(s.defines.SHAPEBLEND=i.resolutionLevel,s.defines.SHAPEBLEND_C=i.useChildrenColors?1:0)),s}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){return this.lightLayer.getNode("occlusion")?.value??!1}reset(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];tM.startContext(this),(this.data!==e||n)&&this.reset0(e,t),tM.endContext(this)}reset0(e,t){this.data=e;let n=e.layers??Ux.defaultTwoLayerData("phong").layers;try{this.layers=n.map((e=>PI.create(this.layerIdGen++,e.id,e.data,t.shared)))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(t.shared),this.transparent=LI(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,n){if("alphaOverride"===e[0])this.transparent=LI(this.data,n.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if("layer"===e[0]){let i=e[1],r=e[2];if(i&&r){let e=this.layers.find((e=>e.uuid===i));e?.hasValue(r)&&("alpha"===r?(this.transparent=LI(this.data,n.shared),e.setValue(r,Math.max(0,Math.min(Number(t)/100,1)))):e.setValue(r,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find((e=>"light"===e.data.type));t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach((t=>{"alpha"in t.data&&"string"==typeof t.data.alpha&&e.shared.getVariable(t.data.alpha,["material",this.uuid,"layer",t.id,"alpha"])}))}getLayersOfType(e){return this.layers.filter((t=>t.type===e))}getLayerByUuid(e){return this.layers.find((t=>t.uuid===e))}onUpdate(e){this.lightLayer=this.layers.find((e=>e instanceof II)),void 0===this.lightLayer&&(this.lightLayer=new II(0,"",{...Bx.defaultData("light","phong"),visible:!1},new kN,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let e=this.layers.find((e=>e instanceof II));if(!e)return;let t=e.data,n=t.bumpMap,i=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let r=0;r<this.layers.length;++r){let t=this.layers[r];t instanceof MI&&t.color instanceof cN&&(t.uuid===n&&(e.node.bumpMap=t.color),t.uuid===i&&(e.node.roughnessMap=t.color))}}updateByOp(e,t,n){if(tM.startContext(this),void 0!==t?this.data=t:t=this.data,this.transparent=LI(t,n.shared),"layers"===e.path[0]){let i=n.shared,r=e.path[1];if(void 0===r)n.scene.markNeedsUpdateRendererDirty(),this.reset0(t,n);else{0===e.type&&void 0!==e.props.occlusion&&n.scene.markNeedsUpdateRendererDirty();let s=this.layers.find((e=>e.uuid===r));if(s){let a,o=t.layers.data(r);0===e.type&&("alpha"in e.props||"alphaOverride"in e.props)&&(a="alpha"in e.props?{...e.props,alpha:TI(e.props.alpha,i,["material",this.uuid,"layer",r,"alpha"])}:{...e.props,alphaOverride:TI(e.props.alphaOverride,i,["material",this.uuid,"alphaOverride"])}),s.updateByOp({...e,...a?{props:a}:{},path:e.path.slice(2)},o,n)&&this.reset0(t,n)}}}else this.reset0(t,n);tM.endContext(this)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof MI?t.color.mask=void 0:t instanceof II&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof MI&&t.isMask.value&&t.data.visible&&e>0){let n=e-1,i=this.layers[n];i instanceof II?i.node.mask=new TM(t.color,t.alpha,TM.MUL):i instanceof MI&&(i.isMask.value||(i.color.mask=new TM(t.color,t.alpha,TM.MUL)))}}}blendColors(){let e=this.layers.findIndex((e=>e instanceof MI)),t=this.layers.findIndex((e=>e instanceof II));if(-1!==e&&e<t){let n=this.layers[e].color;for(let i=e+1;i<t;++i){let e=this.layers[i];if(e instanceof MI){if(e.isMask.value)continue;n=new iN(n,e.color,e.alpha,e.mode)}}this.fragment.color=n}else this.fragment.color=void 0}blendAfterColors(){let e=new EM("outgoingLight","f"),t=this.layers.findIndex((e=>e instanceof II));if(this.layers.length>t+1){for(let n=t+1;n<this.layers.length;++n){let t=this.layers[n];if(t instanceof MI){if(t.isMask.value)continue;e=new iN(e,t.color,t.alpha,t.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter((e=>e instanceof NI));if(e.length>0){let t=e[0].position;for(let n=1;n<e.length;++n)e[n]&&(t=new TM(t,e[n].position,TM.ADD),t=new TM(t,new AM(.5).setReadonly(!0),TM.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.shapeBlendhack&&this.shapeBlendhack(this),e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=!0===this.extensions.derivatives,e.extensionFragDepth=!0===this.extensions.fragDepth,e.extensionDrawBuffers=!0===this.extensions.drawBuffers,e.extensionShaderTextureLOD=!0===this.extensions.shaderTextureLOD}clampUniformsForPreview(e,t){let n=(e,t,n)=>Math.min(Math.max(e,t),n);for(let i of this.layers)if("displace"===i.type){let r=n(i.uniforms[`f${i.id}_intensity`].value,e,t);i.uniforms[`f${i.id}_intensity`].value=r}}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new WM;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this.shadersPatchedForShapeBlend=!1,this}nodeMaterialDispose(){this.layers.forEach((e=>e.dispose())),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof MI){let t=e.params.texture;if(t instanceof ZM&&!t.image.loaded)return!1}return!0}};Object.defineProperties(RI.prototype,{properties:{get:function(){return this.fragment.properties}}});var UI=class extends BI{constructor(e,t,n){super(e,t,!1),this.uuid=n,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},zI=new Map;function FI(e){if("string"==typeof e)return e;let t=zI.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},zI.set(e,t)),t.url}var jI,VI,HI,WI=new Promise((e=>{jI=e})),GI=!1;function qI(){if(!GI)return VI||(VI=async function(){await n.e(5519).then(n.bind(n,95519)),jI(void 0!==window?window:global),GI=!0}())}function KI(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{if(void 0===n.events||!1===Array.isArray(n.events))return!0;let i=[];n.events.forEach((e=>{"dragDropActions"in e.data?(i.push(...e.data.dragDropActions.drag),i.push(...e.data.dragDropActions.drop)):"inActions"in e.data?(i.push(...e.data.inActions),i.push(...e.data.outActions)):"gameActions"in e.data?(i.push(...e.data.gameActions.idle),i.push(...e.data.gameActions.move),i.push(...e.data.gameActions.jump),i.push(...e.data.gameActions.run)):"breakpoints"in e.data?e.data.breakpoints.forEach((e=>{i.push(...e.data.actions)})):"actions"in e.data&&i.push(...e.data.actions),t=t||i.some((e=>"Audio"===e.data.type))}))})),t}WI.then((e=>HI=e));var YI,QI,XI=class{constructor(e){let t,{src:n,volume:i,delay:r,loop:s}=e;this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)},t="string"==typeof n?{src:n}:{src:FI(n),format:"wav"},this.sound=new HI.Howl(t),this.sound.on("end",this.onEnd),this.src=n,void 0!==i&&(this.volume=i),void 0!==r&&(this.delay=r),void 0!==s&&(this.loop=s)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout((()=>{this.sound.play(),this.clearDelay()}),this.delay)}fade(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout((()=>{this.sound.fade(this._volume,0,t),this.clearFade()}),e)):this.sound.fade(this._volume,0,t)}on(e,t,n){this.sound.on(e,t,n)}off(e,t,n){this.sound.off(e,t,n)}play(){"playing"===this._status||this.sound.playing()||("paused"===this._status?(0===this.sound.seek()?this.replay():this.sound.play(),this._status="playing"):"stopped"===this._status&&(this.replay(),this._status="playing"))}pause(){"playing"===this._status&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},ZI=class{constructor(){this.type="ShapePath",this.color=new Mi,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Ac,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath?.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath?.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,s){return this.currentPath?.bezierCurveTo(e,t,n,i,r,s),this}splineThru(e){return this.currentPath?.splineThru(e),this}toShapes(){let e=0,t=1,n=2,i=3,r=4,s=5,a=6,o={loc:e,t:0};function l(t,i,r,s){let a=t.x,l=i.x,h=r.x,u=s.x,d=t.y,p=i.y,f=r.y,m=s.y,g=(u-h)*(d-f)-(m-f)*(a-h),v=(m-f)*(l-a)-(u-h)*(p-d),y=g/v,b=((l-a)*(d-f)-(p-d)*(a-h))/v;if(0===v&&0!==g||y<=0||y>=1||b<0||b>1)return null;if(0===g&&0===v){for(let h=0;h<2;h++){if(c(0===h?r:s,t,i),o.loc===e){let e=0===h?r:s;return{x:e.x,y:e.y,t:o.t}}if(o.loc===n){return{x:+(a+o.t*(l-a)).toPrecision(10),y:+(d+o.t*(p-d)).toPrecision(10),t:o.t}}}return null}for(let n=0;n<2;n++)if(c(0===n?r:s,t,i),o.loc===e){let e=0===n?r:s;return{x:e.x,y:e.y,t:o.t}}return{x:+(a+y*(l-a)).toPrecision(10),y:+(d+y*(p-d)).toPrecision(10),t:y}}function c(l,c,h){let u,d=h.x-c.x,p=h.y-c.y,f=l.x-c.x,m=l.y-c.y,g=d*m-f*p;return l.x===c.x&&l.y===c.y?(o.loc=e,void(o.t=0)):l.x===h.x&&l.y===h.y?(o.loc=t,void(o.t=1)):void(g<-Number.EPSILON?o.loc=i:g>Number.EPSILON?o.loc=r:d*f<0||p*m<0?o.loc=s:Math.sqrt(d*d+p*p)<Math.sqrt(f*f+m*m)?o.loc=a:(u=0!==d?f/d:m/p,o.loc=n,o.t=u))}function h(e,t,n){let i=new di;t.getCenter(i);let r=[];return n.forEach((t=>{t.boundingBox.containsPoint(i)&&function(e,t){let n=[],i=[];for(let r=1;r<e.length;r++){let s=e[r-1],a=e[r];for(let e=1;e<t.length;e++){let r=l(s,a,t[e-1],t[e]);null!==r&&void 0===n.find((e=>e.t<=r.t+Number.EPSILON&&e.t>=r.t-Number.EPSILON))&&(n.push(r),i.push(new di(r.x,r.y)))}}return i}(e,t.points).forEach((e=>{r.push({identifier:t.identifier,isCW:t.isCW,point:e})}))})),r.sort(((e,t)=>e.point.x-t.point.x)),r}let u=0,d=999999999,p=-999999999,f=[];this.subPaths.forEach((e=>{let t=e.getPoints(),n=-999999999,i=999999999,r=-999999999,s=999999999;for(let a=0;a<t.length;a++){let e=t[a];e.y>n&&(n=e.y),e.y<i&&(i=e.y),e.x>r&&(r=e.x),e.x<s&&(s=e.x)}p<=r&&(p=r+1),d>=s&&(d=s-1),t.length&&f.push({curves:e.curves,points:t,isCW:nh.isClockWise(t),identifier:u++,boundingBox:new Su(new di(s,i),new di(r,n))})}));let m=f.map((e=>function(e,t,n,i,r){(null==r||""===r)&&(r="nonzero");let s=new di;e.boundingBox.getCenter(s);let a=h([new di(n,s.y),new di(i,s.y)],e.boundingBox,t);a.sort(((e,t)=>e.point.x-t.point.x));let o=[],l=[];a.forEach((t=>{t.identifier===e.identifier?o.push(t):l.push(t)}));let c=o[0].point.x,u=[],d=0;for(;d<l.length&&l[d].point.x<c;)u.length>0&&u[u.length-1]===l[d].identifier?u.pop():u.push(l[d].identifier),d++;if(u.push(e.identifier),"evenodd"===r){let t=u.length%2===0,n=u[u.length-2];return{identifier:e.identifier,isHole:t,for:n}}if("nonzero"===r){let n=!0,i=null,r=null;for(let e=0;e<u.length;e++){let s=u[e];t[s]&&(n?(r=t[s].isCW,n=!1,i=s):r!==t[s].isCW&&(r=t[s].isCW,n=!0))}return{identifier:e.identifier,isHole:n,for:i}}console.warn('fill-rule: "'+r+'" is currently not implemented.')}(e,f,d,p,this.userData?.style.fillRule))),g=[];return f.forEach((e=>{let t=m[e.identifier];if(t&&!t.isHole){let t=new Nc;t.curves=e.curves,m.filter((t=>t?.isHole&&t.for===e.identifier)).forEach((e=>{if(e){let n=f[e.identifier],i=new Ac;i.curves=n.curves,t.holes.push(i)}})),g.push(t)}})),g}},JI=!1,$I=new Promise((e=>{YI=e})),eO=!1;function tO(){if(JI=!0,!eO)return QI||(QI=async function(){let e=await n.e(8946).then(n.bind(n,68946));YI(e),eO=!0}(),QI)}var nO=new class{async load(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},{load:i}=await $I;i(e,((e,i)=>{e||!i?n(e??"Something went wrong"):t(i)}))}async parse(e){let{parse:t,Bidi:n}=await $I;try{let i=t(e),r=new n,s=e=>i.charToGlyphIndex(e.char);return r.registerModifier("glyphIndex",null,s),r.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:r}}catch(nx){console.error(nx)}}};async function iO(e){let t,n,i=!1;if(e.url?(t=await async function(e){return await(await fetch(e)).arrayBuffer()}(e.url),n=e.url,i=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t){if(!JI)return{font:void 0,url:n,intercepted:i,arr:t,bidi:null};{let e=await nO.parse(t);if(e)return{font:e.font,url:n,intercepted:i,arr:t,bidi:e.bidi}}}}function rO(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var sO=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=iO(e).then((e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)}))}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=iO(e).then((e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)}))}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,n){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(t);let r=i.tokenizer.tokens,s=[],a=0,o=n.length===r.length;for(let l=0;l<n.length;l++){let i=n[l].index,c=String.fromCharCode(n[l].unicode),h=r[a];if(rO(i,h)||o)s.push({char:c,index:i,replacements:[h.state.glyphIndex],replacementChars:[h.char]}),a++;else{let n=h.char,r="",o=[h.state.glyphIndex],l=[],u=!1;for(;!u;)a++,r=t.charAt(a),n+=r,o.push(e.charToGlyphIndex(r)),l=e.stringToGlyphs(n),1===l.length&&l[0].index===i&&(u=!0),a>t.length&&(u=!0);s.push({char:c,index:i,replacements:o,replacementChars:Array.from(n)}),a++}}return s}generateShapes(e,t){if(!this._isLoaded)return;let n,i=this.font,r=t.fontSize/this.unitsPerEm,s=t.fontSize*t.lineHeight,a=e.map((e=>this.getTextWidth(e,t))),o=t.width,l=this.getCharWidth("\n",t),c=1===t.horizontalAlign?l:0,h=this.computeSpaceWidthForLine(e,0,t),u=this.getLineInitialOffsetX(a[0],o,t.horizontalAlign,e[0],l),d=this.getLineInitialOffsetY(s,e.length,t.height,r,t.verticalAlign),p=[],f=e.map((e=>[])),m=e.map((e=>[]));for(let y=0;y<e.length;y++){let g=e[y],b={features:{liga:!0}},w=[];try{w=i.stringToGlyphs(g,b)}catch(v){console.warn(v)}u=this.getLineInitialOffsetX(a[y],o,t.horizontalAlign,g,l);let x=[];try{x=this.reverseLigaturesTable(i,g,w)}catch(v){console.warn(v)}h=this.computeSpaceWidthForLine(e,y,t);for(let e=0;e<w.length;e++){let s=w[e],a=0===s.index?"\n":s.unicode?String.fromCharCode(s.unicode):void 0,o=x[e],l=0,g=0;0===e&&2===t.horizontalAlign&&void 0!==s.leftSideBearing&&(g=-s.leftSideBearing*r),n&&(l=i.getKerningValue(s,n)*r),u+=g+l;let v=0;if("\n"===a)v=c;else if(" "===a)v=h;else{let e=this.createPath(s,r,u,d,t);e&&(v=e.offsetX-(l+g),p.push(e.path))}if(1===o.replacements.length)m[y].push([u,d]),f[y].push(v);else{let e=o.replacements.map((e=>(i.glyphs.get(e).advanceWidth??0)*r)),t=e.reduce(((e,t)=>e+t),0),n=e.map((e=>e/t)),s=u;for(let i=0;i<n.length;i++){let e=v*n[i];m[y].push([s,d]),f[y].push(e),s+=e}}u+=v,n=s}d-=s}let g=[];for(let y=0,b=p.length;y<b;y++)g.push(...p[y].toShapes());return{shapes:g,charWidths:f,lineWidths:a,charCoords:m}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){return this.font?.ascender??0}get descender(){return this.font?.descender??0}get familyName(){return this.font?.names.fontFamily??""}get subfamilyName(){return this.font?.names.fontSubfamily??""}get unitsPerEm(){return this.font?.unitsPerEm??1}getLineInitialOffsetX(e,t,n,i,r){return(3===n||2===n)&&i.indexOf("\n")>=0&&(e-=r),3===n?.5*t-.5*e:2===n?t-e:0}getLineInitialOffsetY(e,t,n,i,r){let s=t*e,a=e-Math.abs(this.ascender-this.descender)*i,o=-this.ascender*i-a/2;return 3===r?-(n-s-o):2===r?-(.5*n-.5*s-o):o}createPath(e,t,n,i,r){let s=e.getPath(n,-i,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!s)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");let a=new ZI,o=(e.advanceWidth??1)*t;if(e)for(let l of s.commands){let e=a.currentPath?.currentPoint;if(!e||"Z"===l.type||e.x!==l.x||-e.y!==l.y)switch(l.type){case"M":a.moveTo(l.x,-l.y);break;case"L":a.lineTo(l.x,-l.y);break;case"Q":a.quadraticCurveTo(l.x1,-l.y1,l.x,-l.y);break;case"C":a.bezierCurveTo(l.x1,-l.y1,l.x2,-l.y2,l.x,-l.y)}}return a.subPaths.forEach((e=>{let t=function(e){if(e.length){let t=e[0];if(t instanceof yc)return t.v1;if(t instanceof gc||t instanceof wc)return t.v0}}(e.curves);void 0!==t&&e.currentPoint.distanceTo(t)>0&&e.lineTo(t.x,t.y)})),{offsetX:o+r.fontSize*r.letterSpacing,path:a}}getCharWidth(e,t){return this.font?.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing})??0}getTextWidth(e,t){return this.font?.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing})??0}computeSpaceWidthForLine(e,t,n){let i=this.getCharWidth(" ",n),r=e[t];if(r){let s=this.countSpaces(r.trimEnd());if(4===n.horizontalAlign&&t<e.length-1&&s){return(n.width-(this.getTextWidth(r,n)-s*i))/s}}return i}countSpaces(e){return(e.match(/ /g)||[]).length}};var aO=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,n){let i=this.objects.get(e);return void 0===i?(i=this.createObject(e,t,n),this.objects.set(e,i)):i.isShared=!0,i}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let n=this.objects.get(e);if(n&&!0!==n.isShared)return this.objects.delete(e),this.objects.set(t,n),n}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){t===this.objects.get(e)&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach((e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)})),this.unreachable.clear()}dispose(){this.objects.forEach((e=>{this.disposeObject(e)})),this.objects.clear()}},oO=class extends aO{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,n){let i=pP(e,t,this.flatShading,n);return i.computeBoundingSphere(),i}},lO={markNeedsUpdateRendererDirty:()=>{}},cO=1e3,hO=512e3;var uO="https://hooks.spline.design",dO=`${uO}/events?hashFile=`,pO=class{constructor(e,t){this.id=e,this.userWebhook=t,this.result=void 0,this._connected=!1,this.emitter=WT(),this.reconnectWaitFor=cO,this._onError=e=>{this.eventSource?.removeEventListener("message",this._onMessage),this.eventSource?.removeEventListener("error",this._onError),this.eventSource?.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=e=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=cO,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=cO,this._connected=!1},this._onMessage=e=>{let t,n=e.data;try{t=JSON.parse(n)}catch(nx){console.error("Error parsing webhook message",nx)}if(t){let e=!1;this.userWebhook.parametersSchemas.forEach((n=>{let{data:i}=n;void 0!==t[i.name]&&function(e,t){let n=typeof e;return!!(("string"===t||"number"===t)&&n===t||"boolean"===t&&("true"===e||"false"===e||!0===e||!1===e)||"image"===t&&"string"===n&&e.startsWith("http"))}(t[i.name],i.type)&&(void 0===this.result&&(this.result={}),this.result[i.name]=t[i.name],e=!0)})),e&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(dO+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){this.eventSource?.removeEventListener("message",this._onMessage),this.eventSource?.removeEventListener("error",this._onError),this.eventSource?.removeEventListener("open",this._onConnected),this.eventSource?.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>hO&&(this.reconnectWaitFor=hO),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout((()=>{this.scheduledReconnectHandle=void 0,this.connect()}),this.reconnectWaitFor)}update(e){this.userWebhook=e}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}getParametersKeys(){return this.userWebhook.parametersSchemas.map((e=>e.data.name))}getParameterValue(e){if(this.getParametersKeys().includes(e)){if(this.result)return this.result?.[e];for(let t of this.userWebhook.parametersSchemas)if(t.data.name===e)return PE.defaultParameterValueByType(t.data.type)}}},fO=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],mO=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],gO=[],vO=[];for(let n=1;n<=8;n++)for(let e=0;e<fO.length;e++){let t=fO[e];gO.push(t/Math.pow(2,8-n)),vO.push(mO[e]+n)}var yO=[32,2e3],bO=gO.filter(((e,t)=>gO[t]>yO[0]&&gO[t]<yO[1])),wO=vO.filter(((e,t)=>gO[t]>yO[0]&&gO[t]<yO[1])),xO=class{static getFrequencies(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"frequency",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-100,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-30;n||(n=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(n));let a,o,l,c=t/2,h=1/n.length*c;if("music"===i||"voice"===i){let e="voice"===i?bO:gO,t=Array(e.length).fill(r);for(let i=0;i<n.length;i++){let r=i*h,s=n[i];for(let n=e.length-1;n>=0;n--)if(r>e[n]){t[n]=Math.max(t[n],s);break}}a=t,o="voice"===i?bO:gO,l="voice"===i?wO:vO}else a=Array.from(n),o=a.map(((e,t)=>h*t)),l=o.map((e=>`${e.toFixed(2)} Hz`));let u=a.map((e=>Math.max(0,Math.min((e-r)/(s-r),1))));return{values:new Float32Array(u),frequencies:o,labels:l}}};var EO=class{constructor(e){this.value=0,this.frequencies=new Float32Array(0);let t=new AudioContext;this.source=t.createMediaStreamSource(e),this.analyser=t.createAnalyser(),this.source.connect(this.analyser),this.analyser.fftSize=8192,this.analyser.smoothingTimeConstant=.1}getFrequencies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-30;if(!this.analyser)throw new Error("Not connected, please call .connect() first");return xO.getFrequencies(this.analyser,44100,void 0,"voice",e,t)}update(){let e=this.getFrequencies(),t=e.values.reduce(((e,t)=>e+t),0)/e.values.length;this.value=t,this.frequencies=e.values}disconnect(){this.source.disconnect(),this.analyser.disconnect()}},CO=class{constructor(e,t,n){this.data=e,this.id=t,this.shared=n,this.emitter=WT(),this.rafId=0,this.voice=0,this.frequencies=new Float32Array([0]),this.events=[],this.isConnected=!1,this.isToolsAdded=!1,this.tools=[],this.onMessage=e=>{let t=JSON.parse(e.data);if(this.appendEvent(t),"session.created"===t.type&&this.onSessionCreated(),"response.done"===t.type&&t.response?.output)for(let n of t.response.output)if("function_call"===n.type)for(let[e,t]of this.tools)n.name===e.name&&(t(JSON.parse(n.arguments)),setTimeout((()=>{this.sendClientEvent({type:"response.create",response:{instructions:"notice the user about what you just did"}})})))},this.onSessionCreated=()=>{this.isToolsAdded||this.registerTools()},this.onOpen=()=>{this.events=[],this.isConnected=!0,this.sendClientEvent({type:"response.create",response:{instructions:"Say hi"}})},this.animate=()=>{if(this.rafId=requestAnimationFrame(this.animate),this.isConnected&&this.analyser){this.analyser.update();let e=this.analyser.value,t=this.analyser.frequencies;this.voice=e,this.frequencies=t,this.emitter.emit("voice",{value:e,frequencies:t})}}}update(e){this.data=e}setColorByName(e,t){let n=this.shared.getColorByName(e);if(n){let{id:e}=n,{r:i,g:r,b:s}=zT.hexStringToRgb(t)??{r:0,g:0,b:0};this.shared.updateColor(e,{r:i/255,g:r/255,b:s/255})}}async connect(){if(this.isConnected)return;let e=await async function(t){try{return(await(await fetch("https://relayserver.spline.design/session?uuidfile="+t)).json()).token}catch(e){console.error("Token generation error:",e)}}(this.data.integration.hash);this.pc=new RTCPeerConnection,this.audioElement=document.createElement("audio"),this.audioElement.autoplay=!0,this.pc.ontrack=e=>{let t=e.streams[0];this.audioElement.srcObject=t,this.analyser=new EO(t)};let t=await navigator.mediaDevices.getUserMedia({audio:!0});this.pc.addTrack(t.getTracks()[0]),this.dc=this.pc.createDataChannel("oai-events"),this.dc.addEventListener("message",this.onMessage),this.dc.addEventListener("open",this.onOpen);let n=await this.pc.createOffer();await this.pc.setLocalDescription(n);let i={type:"answer",sdp:await(await fetch("https://api.openai.com/v1/realtime?model=gpt-4o-realtime-preview-2024-12-17",{method:"POST",body:n.sdp,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/sdp"}})).text()};await this.pc.setRemoteDescription(i),this.animate()}appendEvent(e){this.events=[e,...this.events]}sendClientEvent(e){this.dc?(e.event_id=e.event_id||crypto.randomUUID(),this.dc.send(JSON.stringify(e)),this.appendEvent(e)):console.error("Failed to send message - no data channel available",e)}registerTools(){this.isToolsAdded=!0,this.registerTool({type:"function",name:"set_personality_color",description:"returns a color based on the voice personality of the ai assistant. This should be called by the voice assistant each time it is asks to speak differently. If a color cannot be associated to the personality, the color should be a neutral color.",parameters:{type:"object",properties:{color:{type:"string",description:"css hex color string, reflecting the personality"},personality:{type:"string",description:"the personality of the voice assistant"}},required:["color","personality"]}},(e=>{let{color:t}=e;this.setColorByName("Voice Assistant Color",t)}));let e=this.shared.getVariablesNames().join(", ");this.registerTool({type:"function",name:"set_variable",description:"Sets a Spline variable value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:`The name of the variable that needs to be set. Here's a list of available variables: ${e}. It the variable does not exist, don't call the function and warn the user about it.`},value:{type:"string",description:"The new value for this variable, should always be a string even for number and boolean variables, assume that the value will be cast to the proper type afterwards."}},required:["name","value","type"]}},(e=>{let{name:t,value:n}=e,i=this.shared.getVariableByName(t);if(i){let e,t=this.shared.getVariable(i.id);e="number"==typeof t?parseFloat(n):"boolean"==typeof t?"true"===n.toLowerCase():{textValue:n},this.shared.updateVariable(i.id,e)}}));let t=this.shared.getColorNames().join(", ");this.registerTool({type:"function",name:"set_color",description:"Sets a Spline color asset value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:`The name of the color asset that needs to be set. Here's a list of available color assets: ${t}. It the color asset does not exist, don't call the function and warn the user about it.`},value:{type:"string",description:"css hex color string"}},required:["name","value"]}},(e=>{let{name:t,value:n}=e;this.setColorByName(t,n)}));let n=this.shared.scene,i=[];n.traverseEntity((e=>{e.data.events.forEach((e=>{if("AIAssistantTrigger"===e.data.type){let{description:t}=e.data;i.push(t)}}))})),this.registerTool({type:"function",name:"trigger_event",description:"Trigger an event by name, here are the available events, please match what the user is asking for to one of these if it applies, otherwise don't call the function and warn the user.",parameters:{type:"object",properties:{description:{type:"string",description:`The name of the event that needs to be triggered. Here's a list of available events: ${JSON.stringify(i)}.`},direction:{type:"string",description:"default is forward, but can be forward or backward. Always set to forward unless the user ask to reverse or cancel the event, then set to backward."}},required:["description","direction"]}},(e=>{let{description:t,direction:n}=e;this.emitter.emit("trigger_event",{description:t,direction:n})})),this.sendClientEvent({type:"session.update",session:{tools:this.tools.map((e=>{let[t]=e;return t}))}})}registerTool(e,t){this.tools.push([e,t])}disconnect(){cancelAnimationFrame(this.rafId),this.analyser?.disconnect(),this.voice=0,this.isConnected=!1,this.isToolsAdded=!1,this.dc?.removeEventListener("message",this.onMessage),this.dc?.removeEventListener("open",this.onOpen),this.dc?.close(),this.pc?.getSenders().forEach((e=>{e.track&&e.track.stop()})),this.pc?.close(),this.pc=void 0}computeAnalysisForListenerEvent(e){if("range"===e.analysis){let t=this.frequencies.slice(...e.analysisRange);return t.reduce(((e,t)=>e+t),0)/t.length}return"single"===e.analysis?this.frequencies[e.analysisSingle]:this.voice}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}};function AO(e){return"variable_"+e}var SO=class extends GN{constructor(e){super(),this.shared=e}create(e){return new qN(e,this.shared)}},_O=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.data=e,this.needsJitter=n,this.enableLocalStorageForPersistentVariables=i,this.geometryCache=new oO(!0),this.geometryCache2=new oO(!1),this.imageHolderCache=new SO(this),this.thisContext={scene:lO,shared:this},this.deletedMaterial=new UI(Ux.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new KN(iC.emptyImage,this),this.deletedVideo=new KN(Px.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[r,s]of Object.entries(t.images))this.addImage(r,s);if(t.videos)for(let[r,s]of Object.entries(t.videos))this.addVideo(r,s);if(t.audios)for(let[r,s]of Object.entries(t.audios))this.addAudio(r,s);if(t.particles)for(let[r,s]of Object.entries(t.particles))this.addParticle(r,s);this.reset(e)}setRequestRender(e){this._requestRender=e}getImageLoadPromises(){return Object.values(this.images).map((e=>e.loadPromise))}setEntityOpContext(e){this.entityOpContext=e}reset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.data=e,this.resetLib(e.lib);for(let{id:n,data:i}of e.variables)this.addVariableHolder(n,i),t&&this.updateVariableHolder(n,i);for(let[n,i]of Object.entries(e.userAPIs))this.addUserAPI(n,i);for(let[n,i]of Object.entries(e.userWebhooks))this.addUserWebhook(n,i);for(let[n,i]of Object.entries(e.images))this.addImage(n,i);for(let[n,i]of Object.entries(e.videos))this.addVideo(n,i);for(let[n,i]of Object.entries(e.colors))this.addColor(n,i);for(let[n,i]of Object.entries(e.materials))this.addMaterial(n,i);for(let[n,i]of Object.entries(e.audios))this.addAudio(n,i);for(let[n,i]of Object.entries(e.particles))this.addParticle(n,i);for(let[n,i]of Object.entries(e.fonts))this.addFont(n,i)}addMaterial(e,t){if(this.materials[e]){let n=this.materials[e];n.reset(t,this.thisContext),n.dispose()}else{let n=new UI(t,this.thisContext,e);this.materials[e]=n}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return"string"==typeof e?this.getMaterialOrDeletedPlaceholder(e):null==e?(console.error("material is undefined or null"),this.deletedMaterial):new BI(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new KN(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return"string"==typeof e?this.getImage(e):this.imageHolderCache.load(e)}addUIBuffer(e,t){return this.uiBuffers[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[e].updateSrc(t),!0):(this.uiBuffers[e]=new KN(t,this),!1)}uiBuffer(e){return this.uiBuffers[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new KN(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return"string"==typeof e?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):(this.colors[e]=new EI(t.r,t.g,t.b,"a"in t?t.a:1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let n=this.colors[e];return this.colors[e].r=t.r??n.r,this.colors[e].g=t.g??n.g,this.colors[e].b=t.b??n.b,this.colors[e].a=t.a??n.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}getColorNames(){return Object.values(this.data.colors).map((e=>e.name))}getColorByName(e){for(let t in this.data.colors)if(this.data.colors[t].name===e)return{color:this.colors[t],id:t}}color(e){let t;if("string"!=typeof e)return new lM(e.r,e.g,e.b,"a"in e?e.a:1);{let n=this.getColor(e);n?t=n:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new lM(0,0,0,0))}return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof XI)return t;{let n=new XI({src:t.data});return this.audios[e]=n,n}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof XI&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new sO(t),this.fonts[e].loadingPromise.then((()=>this.requestRender()))}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach((e=>this.deleteMaterial(e))),this._requestRender=void 0,Object.values(this.audios).forEach((e=>{e instanceof XI&&e.dispose()})),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){if(void 0===this.variables[e]){let n=t.value;if(this.enableLocalStorageForPersistentVariables&&t.persistent){let i=localStorage.getItem(AO(e));n=null!==i?JSON.parse(i):t.value}return this.variables[e]={value:n,locations:[],persistent:t.persistent},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0}return this.variables[e].value=t.value,!1}resetDynamicVariablePlayState(){for(let e in this.variables)void 0!==this.variables[e].dynamicVariablePlayState&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(void 0===this.variables[e])return!1;this.variables[e].value=t,this.enableLocalStorageForPersistentVariables&&this.variables[e].persistent&&localStorage.setItem(AO(e),JSON.stringify(t));let n=t;for(;"string"==typeof n;)n=this.variables[n].value;let i=this.entityOpContext.scene;for(let r=this.variables[e].locations.length-1;r>=0;r--){let t=this.variables[e].locations[r];if("material"===t[0]){let e=t[1],r=n,s={scene:i,shared:this},a=t.slice(2);i.traverseMaterial((t=>{let n=t.root??t;n.uuid===e&&n.onVariableUpdate(a,r,s)}));let o=this.materials[e];o&&o.onVariableUpdate(a,r,s)}else{let s=i.find(t[0]);if(void 0===s){this.variables[e].locations.splice(r,1);continue}if("geometry"!==t[1]&&"particles"!==t[1]){for(let e=1;e<t.length-1;e++)s=s[t[e]];"rotation"===t[1]?s[t[t.length-1]]=n*ui.DEG2RAD:s[t[t.length-1]]=n}if(s=i.find(t[0]),"ParticleEmitter"===s.type&&s.updateVariableState(n,t),sS.is(s))if("position"===t[1]||"rotation"===t[1]||"scale"===t[1])s.onVariableUpdate();else if("geometry"===t[1]){let e=s;s.component&&(e=s.component);let t=e.dataPatched;e.chooseGeoemtryCache(this).forceDelete(t.geometry),e.createGeometryDelayed(this.entityOpContext),e.onVariableUpdate(!0),e.invalidateDownstreamBooleanData(),e.instances.forEach((e=>{let t=e.dataPatched;e.chooseGeoemtryCache(this).forceDelete(t.geometry),e.createGeometryDelayed(this.entityOpContext),e.onVariableUpdate(!0),e.invalidateDownstreamBooleanData()}))}else"morphTargetInfluences"===t[1]&&s.updateMorphInfluences(t[2],n)}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){if(Array.isArray(e)){if("mouse"===e[0])return this.mouseProperty?.[e[1]]??0;if("raycast"===e[0])return this.raycastProperty?.[e[1]]??0;let t=this.entityOpContext.scene.find(e[0]);if("width"===e[1]||"height"===e[1]||"depth"===e[1])return t.geometry.userData.parameters[e[1]];for(let n=1;n<e.length;n++)t=t[e[n]];return"rotation"===e[1]&&(t*=ui.RAD2DEG),t}for(let n in this.variables){if(void 0===t)break;let e=this.variables[n],i=e.locations?.findIndex((e=>Gy.equal(e,t)));void 0!==i&&-1!==i&&e.locations.splice(i,1)}if("string"==typeof e){let n=e,i=e;do{if(i=n,void 0===this.variables[n])break;let e=this.variables[n].value;t&&void 0!==this.variables[i]&&this.variables[i].locations.push(t),n=e}while("string"==typeof n);return n}return e}getVariables(){return this.variables}getVariablesNames(){return this.data.variables.map((e=>e.data.name))}getVariableByName(e){for(let t of this.data.variables)if(t.data.name===e)return{variable:t.data,id:t.id}}getDynamicVariablePlayState(e){return this.variables[e]?.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){void 0!==this.variables[e]&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){return this.variables[e]?.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){void 0!==this.variables[e]&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,n]of Object.entries(e.images))this.addImage(t,n.asset);for(let[t,n]of Object.entries(e.audios))this.addAudio(t,n.asset);for(let[t,n]of Object.entries(e.particles))this.addParticle(t,n.asset);for(let[t,n]of Object.entries(e.colors))this.addColor(t,n.asset);for(let[t,n]of Object.entries(e.fonts))this.addFont(t,n.asset);for(let[t,n]of Object.entries(e.materials))this.addMaterial(t,n.asset);for(let[t,n]of Object.entries(e.videos))this.addVideo(t,n.asset);for(let[t,n]of Object.entries(e.variables))this.addVariableHolder(t,n.asset)}updateLibByOp(e,t){"images"===e.path[0]?1===e.path.length&&1===e.type?this.addImage(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteImage(e.id):"videos"===e.path[0]?1===e.path.length&&1===e.type?this.addVideo(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteVideo(e.id):"audios"===e.path[0]?1===e.path.length&&1===e.type?this.addAudio(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteAudio(e.id):"particles"===e.path[0]?1===e.path.length&&1===e.type?this.addParticle(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteParticle(e.id):"colors"===e.path[0]?1===e.path.length&&1===e.type?this.addColor(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteColor(e.id):"materials"===e.path[0]?1===e.path.length&&1===e.type?this.addMaterial(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteMaterial(e.id):"fonts"===e.path[0]?1===e.path.length&&1===e.type?this.addFont(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteFont(e.id):"variables"===e.path[0]?1===e.path.length&&1===e.type?this.addVariableHolder(e.id,e.data.asset):1===e.path.length&&2===e.type&&this.deleteVariable(e.id):"components"===e.path[0]&&t.updateByLibOp(e,this)}updateByOp(e,t,n){if(this.data=t,"images"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):1===e.path.length&&1===e.type?this.addImage(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteImage(e.id);else if("videos"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):1===e.path.length&&1===e.type?this.addVideo(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteVideo(e.id);else if("audios"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):1===e.path.length&&1===e.type?this.addAudio(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteAudio(e.id);else if("particles"===e.path[0])2===e.path.length&&0===e.type?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):1===e.path.length&&1===e.type?this.addParticle(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteParticle(e.id);else if("colors"===e.path[0])2===e.path.length&&0===e.type?this.updateColor(e.path[1],e.props):1===e.path.length&&1===e.type?this.addColor(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteColor(e.id);else if("materials"===e.path[0])1===e.path.length&&1===e.type?this.addMaterial(e.id,e.data):1===e.path.length&&2===e.type?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(Ey.drop(e,2),t.materials[e.path[1]],{shared:this,scene:n});else if("fonts"===e.path[0])2===e.path.length&&0===e.type?this.updateFont(e.path[1],e,n):1===e.path.length&&1===e.type?this.addFont(e.id,e.data):1===e.path.length&&2===e.type&&this.deleteFont(e.id);else if("variables"===e.path[0])2===e.path.length&&0===e.type?"value"in e.props?this.updateVariable(e.path[1],e.props.value):"persistent"in e.props&&(this.variables[e.path[1]].persistent=e.props.persistent):1===e.path.length&&4===e.type?this.addVariableHolder(e.id,e.data):1===e.path.length&&5===e.type&&this.deleteVariable(e.id);else if("userAPIs"===e.path[0]){if(1===e.path.length&&1===e.type)this.addUserAPI(e.id,e.data);else if(1===e.path.length&&2===e.type)this.deleteUserAPI(e.id);else if("string"==typeof e.path[1]){let n=t.userAPIs[e.path[1]];if(n){let t=0===e.type&&void 0===e.props.debounce,i=this.getUserAPI(e.path[1]);i instanceof CO?i.update(n):i?.update(n,this,t)}}}else if("userWebhooks"===e.path[0]){if(1===e.path.length&&1===e.type)this.addUserWebhook(e.id,e.data);else if(1===e.path.length&&2===e.type)this.deleteUserWebhook(e.id);else if("string"==typeof e.path[1]){let n=t.userWebhooks[e.path[1]];n&&this.getUserWebhook(e.path[1])?.update(n)}}else"lib"===e.path[0]&&this.updateLibByOp(Ey.drop(e,1),n)}updateFont(e,t,n){if(t.props.url){let i=this.getFont(e),r={...this.data.fonts[e],url:t.props.url};i.update(r),i.loadingPromise.then((()=>this.requestRender())),n.updateFont(e,this)}}addUserAPI(e,t){return this.userAPIs[e]?(this.userAPIs[e].update(t,this),!0):this.openAIRealtime?.id===e?(this.openAIRealtime.update(t),!0):"VoiceAssistant"===t.integration?.type?(this.openAIRealtime=new CO(t,e,this),!1):(this.userAPIs[e]=new GT(e,t,this),!1)}getUserAPI(e){return this.openAIRealtime?.id===e?this.openAIRealtime:this.userAPIs[e]}getUserAPIs(){return this.userAPIs}deleteUserAPI(e){let t=this.userAPIs[e];t&&(t.dispose(),delete this.userAPIs[e])}addUserWebhook(e,t){return this.userWebhooks[e]?(this.userWebhooks[e].update(t),!0):(this.userWebhooks[e]=new pO(e,t),!1)}getUserWebhook(e){return this.userWebhooks[e]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(e){let t=this.userWebhooks[e];t&&(t.dispose(),delete this.userWebhooks[e])}get scene(){return this.entityOpContext.scene}},TO=(new _O(RE.emptyData()),class extends $P{updateByPatchedOp(e,t,n){if(super.updateByPatchedOp(e,t,n),null!==function(e,t){let n=[];if(t.length!==e.length)return null;for(var i=0;i<e.length;){if("*"===t[i])n.push(e[i]);else if(e[i]!==t[i])return null;i+=1}return n}(e.path,["materials"])&&0===e.type&&Array.isArray(this.material))for(let[i,r]of Object.entries(e.props)){let e=n.shared.material(r);this.material[Number(i)]=e}else if(Zy(e.path,["material"])&&this.material instanceof RI)"material"in t&&"string"!=typeof t.material&&this.material.updateByOp(Ey.drop(e,1),t.material,n);else if(Zy(e.path,["materials","*"])&&Array.isArray(this.material)){let i=e.path[1];if("materials"in t&&i<this.material.length){let r=t.materials[i];"string"!=typeof r&&this.material[i].updateByOp(Ey.drop(e,2),r,n)}}}get needsAO(){return void 0!==this.material&&(Array.isArray(this.material)?this.material[0]:this.material).hasAO}updateState(e,t){super.updateState(e,t),void 0!==e.castShadow&&(this.castShadow=e.castShadow),void 0!==e.receiveShadow&&(this.receiveShadow=e.receiveShadow);let n,i=this.dataPatched;if("Mesh"===this.dataPatched.type&&this.dataPatched.geometry.shapeBlendNode&&this.layers.set(9),"Mesh"===this.dataPatched.type&&"ShapeBlendGeometry"===this.dataPatched.geometry.type&&(n={resolutionLevel:this.dataPatched.geometry.resolutionLevel,useChildrenColors:this.dataPatched.geometry.useChildrenColors}),"NonParametricGeometry"!==e.geometry?.type&&"material"in e&&void 0!==e.material&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(i.flatShading,i.side,i.wireframe,n),t.scene.markNeedsUpdateRendererDirty()),("NonParametricGeometry"===e.geometry?.type||"materials"in e)&&("materials"in e&&void 0!==e.materials?(this.disposeMaterial(),this.material=e.materials.map((e=>t.shared.material(e).getFlavor(i.flatShading,i.side,i.wireframe))),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&void 0!==e.material&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(i.flatShading,i.side,i.wireframe)],t.scene.markNeedsUpdateRendererDirty())),void 0!==e.flatShading||void 0!==e.wireframe||void 0!==e.side)if(Array.isArray(this.material))for(let r=0;r<this.material.length;r++)this.material[r]=this.material[r].getFlavor(i.flatShading,i.side,i.wireframe);else this.material=this.material.getFlavor(i.flatShading,i.side,i.wireframe,n)}disposeMaterial(){this.material&&jv(this.material).forEach((e=>{e instanceof RI&&(e instanceof UI||e.nodeMaterialDispose())}))}dispose(){this.disposeMaterial(),super.dispose()}}),PO=new ji,MO=new ki,NO=new ki,IO=new ji,OO=new vr,DO=class extends TO{constructor(e,t,n){super(e,t),this.data=t,this.isSkinnedMesh=!1,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.bindMode=t.bindMode,this.bindMatrix=(new vr).fromArray(t.bindMatrix),this.bindMatrixInverse=new vr)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof gs&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(void 0!==this.localGeometry)return this.localGeometry;if(this.geometryCreateDeleyed instanceof _O){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e,this)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return Gx.is2DParametricMesh(e.type)&&0===e.depth}get is2DType(){return Gx.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return"NonParametricGeometry"===this.geometry.userData.type}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),Zy(e.path,["geometry"])&&this.updateByPatchedOpGeometry(Ey.drop(e,1),t.geometry,n)}removeInteractionGeometry(e){this.localGeometry?.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){this.invalidateDownstreamBooleanData();let n=this.data.geometry.type;if("NonParametricGeometry"===n||"SubdivGeometry"===n){let n,i,r,s=e;if(void 0===this.localGeometry){let e={...this.data.geometry,...s};this.localGeometry=pP(e,t,this.data.flatShading,this)}s.scaleBaked?[n,i,r]=s.scaleBaked:({width:n,height:i,depth:r}=s);let a=this.localGeometry.userData;void 0!==a.sxPrev&&mP(this.localGeometry.attributes,n/a.sxPrev,i/a.syPrev,r/a.szPrev),a.sxPrev=n,a.syPrev=i,a.szPrev=r}else{let n={...this.data.geometry,...e};this.localGeometry?.dispose(),this.localGeometry=pP(n,t,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let e of this.attachedSurfaceCloners)e.update()}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand((()=>t.updateShape()))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,n){let i=!1;0===e.type&&0===e.path.length&&Object.keys(e.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof EP&&this.chooseGeoemtryCache(n.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(n),this.refreshAttachedPaths(n)),i||(n.scene?.markGeometryCacheDirty(),this.createGeometryDelayed(n)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){void 0!==e.geometry&&this.updateGeometryOnStateUpdate(e.geometry,t);let n=e.morphTargetInfluences;if(n){this.updateMorphTargets(),this.geometry.morphTargetsRelative=!0;for(let{data:{name:e,value:i}}of n)this.updateMorphInfluences(e,t.shared.getVariable(i,[this.uuid,"morphTargetInfluences",e]))}super.updateState(e,t)}updateMorphInfluences(e,t){if(void 0===this.morphTargetDictionary)return;let n=this.morphTargetDictionary[e];void 0!==n&&(this.morphTargetInfluences[n]=t)}updateGeometryGroupsIfNeeded(){Array.isArray(this.material)&&0===this.geometry.groups.length&&this.geometry.addGroup(0,Math.max(this.geometry.getIndex()?.count??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let n=this.geometry.userData.parameters;this.is2DType?e.set(0,0,.5*n.depth):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(n.width,n.height,n.depth??0).multiplyScalar(.5)):n.centerOffset?e.fromArray(n.centerOffset):e.setScalar(0),t.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,this.isSkinnedMesh=!0,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new ki,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){t.fromBufferAttribute(n,i);let e=1/t.manhattanLength();e!==1/0?t.multiplyScalar(e):t.set(1,0,0,0),n.setXYZW(i,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let n=this.skeleton;if(void 0===n)return;let i=this.geometry;MO.fromBufferAttribute(i.attributes.skinIndex,e),NO.fromBufferAttribute(i.attributes.skinWeight,e),PO.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){let e=NO.getComponent(r);if(0!==e){let i=MO.getComponent(r);OO.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),t.addScaledVector(IO.copy(PO).applyMatrix4(OO),e)}}return t.applyMatrix4(this.bindMatrixInverse)}};function LO(e){if(Array.isArray(e.material)){for(let t of e.material)if(0===t.getLayersOfType("outline").length)return}else if(!(e.material instanceof RI)||0===e.material.getLayersOfType("outline").length)return;e instanceof DO&&e.is2DAndNoDepth?function(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,n=new Float32Array(t.length),i=new ji;for(let r=0;r<t.length;r+=3)i.set(t[r],t[r+1],t[r+2]).normalize(),n[r]=i.x,n[r+1]=i.y,n[r+2]=i.z;e.geometry.setAttribute("extrudeNormal",new ls(n,3))}(e):function(e){if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,n=e.geometry.attributes,i=n.position.array,r=n.normal.array,s=new Float32Array(i.length);for(let a=0;a<i.length;a+=3){let e=`${i[a]}_${i[a+1]}_${i[a+2]}`,n=new ji(r[a],r[a+1],r[a+2]);t.has(e)?t.get(e)?.normals.push(n):t.set(e,{normals:[n],result:new ji})}t.forEach(((e,t)=>{for(let n of e.normals)e.result.add(n);e.result.divideScalar(e.normals.length)}));for(let a=0;a<i.length;a+=3){let e=`${i[a]}_${i[a+1]}_${i[a+2]}`,n=t.get(e)?.result;n&&(s[a]=n.x,s[a+1]=n.y,s[a+2]=n.z)}e.geometry.setAttribute("extrudeNormal",new ls(s,3))}(e)}function RO(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,n=new Float32Array(t.length),i=parseInt(e.uuid.replace(/\D/g,"")),r=[ui.seededRandom(i),ui.seededRandom(i+1e4),ui.seededRandom(i+2e4)];for(let s=0;s<t.length;s++)n[s]=r[s%3];e.geometry.setAttribute("randomColor",new ss(n,3))}var kO=new Wi,BO=new ji;function UO(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{"Mesh"===n.type&&"SubdivGeometry"===n.geometry.type&&(t=!0)})),t}var zO=class extends DO{constructor(e,t,n){super(e,t,n),this.data=t,this.hiddenMatrixOld=new vr,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return void 0!==this.localGeometry?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return void 0!==this.localGeometry?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let n=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}createGeometryByControls(e){if(!0===this.skipReactionUpdate)return;let t=this.localGeometry?.uuid,{originalGeometry:n,subdividedGeometry:i,subdivPointer:r}=EP.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=r,void 0!==n&&(this.originalGeometry?.dispose(),this.originalGeometry=n),void 0!==i&&(this.subdividedGeometry?.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,LO(this),RO(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),void 0!==e.flatShading){let n=this.material;this.material=Array.isArray(n)?n.map((e=>e.getFlavor(!1,e.side,e.wireframe))):n.getFlavor(!1,n.side,n.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];EP.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&EP.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=EP.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=EP.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let n=this.localGeometry;this.localGeometry=this.originalGeometryNew,$P.prototype.raycast.call(this,e,t),this.localGeometry=n}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;null===e.boundingSphere&&(e.boundingSphere=new lr,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,n=e.boundingSphere.center;kO.setFromBufferAttribute(t),kO.getCenter(n),e.boundingSphere.radius=n.distanceTo(kO.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),kO.getSize(BO),this.hasNonUniformScale&&BO.divide(this.scale);let i={width:BO.x,height:BO.y,depth:BO.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(e){let t=this.originalGeometry;kO.min.set(e[0],e[2],e[4]),kO.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(kO.min.applyMatrix4(this.shearScaleInv),kO.max.applyMatrix4(this.shearScaleInv)),null===t.boundingSphere&&(t.boundingSphere=new lr);let n=t.boundingSphere.center;kO.getCenter(n),t.boundingSphere.radius=n.distanceTo(kO.max)}freeSubdivPointer(){this.subdivPointer&&(EP.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,this.originalGeometry?.dispose(),this.subdividedGeometry?.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,n){super.updateByPatchedOpGeometry(e,t,n),this.localGeometry&&this.createGeometryByControls(t)}},FO={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},jO={polygon_center:0,edge:1,vertex:2},VO=(e,t)=>(n,i)=>t&&0!==n&&0!==e?e*i/100:0,HO=(e,t)=>{let n=Math.abs(t),i=-1*n;return(e- -1)*(n-i)/2+i},WO=new ji,GO=new ji,qO=new ji,KO=new ji;function YO(e,t){let n=qO.fromArray(e),i=KO.fromArray(t);GO.copy(i).sub(n);let r=GO.length();return GO.normalize().multiplyScalar(.5*r),WO.copy(n).add(GO).toArray()}var QO=new $r,XO=new ji,ZO=new ji,JO=new ji;var $O=e=>.5*(1-Math.cos(e*Math.PI)),eD=class{constructor(){this.perlin=new Array(4096)}noise(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null==this.perlin){this.perlin=new Array(4096);for(let e=0;e<4096;e++)this.perlin[e]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),n<0&&(n=-n);let i,r,s,a,o,l=Math.floor(e),c=Math.floor(t),h=Math.floor(n),u=e-l,d=t-c,p=n-h,f=0,m=.5;for(let g=0;g<4;g++){let e=l+(c<<4)+(h<<8);i=$O(u),r=$O(d),s=this.perlin[4095&e],s+=i*(this.perlin[e+1&4095]-s),a=this.perlin[e+16&4095],a+=i*(this.perlin[e+16+1&4095]-a),s+=r*(a-s),e+=256,a=this.perlin[4095&e],a+=i*(this.perlin[e+1&4095]-a),o=this.perlin[e+16&4095],o+=i*(this.perlin[e+16+1&4095]-o),a+=r*(o-a),s+=$O(p)*(a-s),f+=s*m,m*=.5,l<<=1,u*=2,c<<=1,d*=2,h<<=1,p*=2,u>=1&&(l++,u--),d>=1&&(c++,d--),p>=1&&(h++,p--)}return f}noiseSeed(e){let t=(()=>{let e,t;return{setSeed(n){t=e=(n??4294967296*Math.random())>>>0},getSeed:()=>e,rand:()=>(t=(1664525*t+1013904223)%4294967296,t/4294967296)}})();t.setSeed(e),this.perlin=new Array(4096);for(let n=0;n<4096;n++)this.perlin[n]=t.rand()}},tD=new ji,nD=new vr,iD=new gr;function rD(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{"Mesh"===n.type&&("TextGeometry"===n.geometry.type||"InputGeometry"===n.geometry.type)&&(t=!0)})),t}var sD,aD,oD,lD,cD=class extends DO{constructor(e,t,n){super(e,t,n),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){let e=this.dataPatched;return this.font?.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign)??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){return(this.font?.ascender??1)*this.fontScale}get descender(){return(this.font?.descender??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:n}=this;if(!isNaN(e.ray.origin.x)&&0!==this.scale.x&&0!==this.scale.y&&0!==this.scale.z&&(nD.copy(n).invert(),iD.copy(e.ray).applyMatrix4(nD),iD.intersectBox(this.singleBBox,tD))){let i=tD.applyMatrix4(n),r=e.ray.origin.distanceTo(i);t.push({distance:r,point:i.clone(),object:this})}}},hD=1e-4,uD=new ji,dD=new ji;cP.then((e=>{aD=[(sD=e).get_face_center,sD.get_edge_midpoint,sD.get_vertex_position],oD=[sD.get_face_normal,sD.get_edge_normal,sD.get_vertex_normal],lD=[sD.face_count,sD.edge_count,sD.vertex_count]}));var pD=new vr,fD=new vr,mD=new ji,gD=new ji,vD=new ji,yD=new ji,bD=new ji,wD=new ji,xD=class{constructor(e,t){this.data=e,this.is3D=t,this.perlin=new eD,"perlin"===e.noiseType?(this.perlin.noiseSeed(e.seed),this.noise=t?(e,t,n)=>this.perlin.noise(e,t,n):e=>this.perlin.noise(e)):this.noise=t?function(){let e=ZA(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random),t=new Float64Array(e).map((e=>XA[e%12*3])),n=new Float64Array(e).map((e=>XA[e%12*3+1])),i=new Float64Array(e).map((e=>XA[e%12*3+2]));return function(r,s,a){let o,l,c,h,u,d,p,f,m,g,v=(r+s+a)*qA,y=YA(r+v),b=YA(s+v),w=YA(a+v),x=(y+b+w)*KA,E=r-(y-x),C=s-(b-x),A=a-(w-x);E>=C?C>=A?(u=1,d=0,p=0,f=1,m=1,g=0):E>=A?(u=1,d=0,p=0,f=1,m=0,g=1):(u=0,d=0,p=1,f=1,m=0,g=1):C<A?(u=0,d=0,p=1,f=0,m=1,g=1):E<A?(u=0,d=1,p=0,f=0,m=1,g=1):(u=0,d=1,p=0,f=1,m=1,g=0);let S=E-u+KA,_=C-d+KA,T=A-p+KA,P=E-f+2*KA,M=C-m+2*KA,N=A-g+2*KA,I=E-1+.5,O=C-1+.5,D=A-1+.5,L=255&y,R=255&b,k=255&w,B=.6-E*E-C*C-A*A;if(B<0)o=0;else{let r=L+e[R+e[k]];B*=B,o=B*B*(t[r]*E+n[r]*C+i[r]*A)}let U=.6-S*S-_*_-T*T;if(U<0)l=0;else{let r=L+u+e[R+d+e[k+p]];U*=U,l=U*U*(t[r]*S+n[r]*_+i[r]*T)}let z=.6-P*P-M*M-N*N;if(z<0)c=0;else{let r=L+f+e[R+m+e[k+g]];z*=z,c=z*z*(t[r]*P+n[r]*M+i[r]*N)}let F=.6-I*I-O*O-D*D;if(F<0)h=0;else{let r=L+1+e[R+1+e[k+1]];F*=F,h=F*F*(t[r]*I+n[r]*O+i[r]*D)}return 32*(o+l+c+h)}}((0,HA.default)(e.seed)):function(){let e=ZA(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random),t=new Float64Array(e).map((e=>QA[e%12*2])),n=new Float64Array(e).map((e=>QA[e%12*2+1]));return function(i,r){let s,a,o=0,l=0,c=0,h=(i+r)*WA,u=YA(i+h),d=YA(r+h),p=(u+d)*GA,f=i-(u-p),m=r-(d-p);f>m?(s=1,a=0):(s=0,a=1);let g=f-s+GA,v=m-a+GA,y=f-1+2*GA,b=m-1+2*GA,w=255&u,x=255&d,E=.5-f*f-m*m;if(E>=0){let i=w+e[x];E*=E,o=E*E*(t[i]*f+n[i]*m)}let C=.5-g*g-v*v;if(C>=0){let i=w+s+e[x+a];C*=C,l=C*C*(t[i]*g+n[i]*v)}let A=.5-y*y-b*b;if(A>=0){let i=w+1+e[x+1];A*=A,c=A*A*(t[i]*y+n[i]*b)}return 70*(o+l+c)}}((0,HA.default)(e.seed))}},ED=class extends(aS(Vr)){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.random=null,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(null===this.parent)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof lS&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse((t=>{t instanceof lS&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)}))}onObjUpdateMatrix(){"toObject"!==this.parameters.type&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(t=void 0!==e?e:"grid"===this.parameters.type?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,"toObject"===this.parameters.type)if(this.parameters.toObject.object){if(void 0===e&&"random"!==this.parameters.toObject.spreadType)return}else t=0;if("toObject"===this.parameters.type&&this.objectForSample){let e=this.children;if(e.length===t)return;if(e.length<t)for(let n=0,i=t-e.length;n<i;++n){let e=new lS(this.object);e.expand(),this.add(e)}else for(let n=0,i=e.length-t;n<i;++n)this.remove(e[n])}else{if(this.children.length===t)return;if(this.children.length<t)for(let e=0,n=t-this.children.length;e<n;++e){let e=new lS(this.object);e.expand(),this.add(e)}else for(let e=0,n=this.children.length-t;e<n;++e)this.remove(this.children[e])}}getRandom(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(null===this.random||this.random.data.seed!==e.seed||this.random.is3D!==t)&&(this.random=new xD(e,t)),this.random}_updateRadial(e){let t,n=e.radial,i=n.start*ui.DEG2RAD,r=i-n.end*ui.DEG2RAD,s=new Tr(n.rotation[0],n.rotation[1],n.rotation[2]);switch(n.axis){case"z":t=new ji(0,0,1);break;case"y":t=new ji(0,1,0);break;default:t=new ji(1,0,0)}let a=e.randomnessObject??fx.defaultData([1,1,1]).randomnessObject,o=this.getRandom(a),l=VO(a.strength,this.parameters.randomness);for(let[c,h]of this.children.entries()){let u=c*(a.freqScale/10)+a.movement,d=o.noise(u,u,u),p=c+1;h.scale.x=n.scale[0]+l(p,HO(d,a.scale[0]))||hD,h.scale.y=n.scale[1]+l(p,HO(d,a.scale[1]))||hD,h.scale.z=n.scale[2]+l(p,HO(d,a.scale[2]))||hD,h.position.setScalar(0);let f=r/e.count*c-i;switch(n.axis){case"x":h.rotation.set(0,f,0);break;case"y":h.rotation.set(0,0,f);break;case"z":h.rotation.set(f,0,0)}h.translateOnAxis(t,n.radius),h.position.x+=n.position[0]+l(p,HO(d,a.position[0])),h.position.y+=n.position[1]+l(p,HO(d,a.position[1])),h.position.z+=n.position[2]+l(p,HO(d,a.position[2]));let m=l(p,HO(d,a.rotation[0])),g=l(p,HO(d,a.rotation[1])),v=l(p,HO(d,a.rotation[2]));!0===n.alignment?(h.rotation.x+=s.x+m,h.rotation.y+=s.y+g,h.rotation.z+=s.z+v):h.rotation.set(s.x+m,s.y+g,s.z+v)}}_updateLinear(e){if("linear"!==e.type)throw new Error;let t=e.linear,n=new Tr(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??fx.defaultData([1,1,1]).randomnessObject,r=this.getRandom(i),s=VO(i.strength,this.parameters.randomness);for(let[a,o]of this.children.entries()){let e=a*(i.freqScale/10)+i.movement,l=r.noise(e,e,e),c=a+1,h=s(c,HO(l,i.rotation[0])),u=s(c,HO(l,i.rotation[1])),d=s(c,HO(l,i.rotation[2]));o.scale.x=1+(t.scale[0]-1)*a+s(c,HO(l,i.scale[0]))||hD,o.scale.y=1+(t.scale[1]-1)*a+s(c,HO(l,i.scale[1]))||hD,o.scale.z=1+(t.scale[2]-1)*a+s(c,HO(l,i.scale[2]))||hD,o.rotation.x=n.x*a+h,o.rotation.y=n.y*a+u,o.rotation.z=n.z*a+d,o.position.x=t.position[0]*a+s(c,HO(l,i.position[0])),o.position.y=t.position[1]*a+s(c,HO(l,i.position[1])),o.position.z=t.position[2]*a+s(c,HO(l,i.position[2]))}}_updateGrid(e){let t=0,n=e.grid,i=e.randomnessObject??fx.defaultData([1,1,1]).randomnessObject,r=this.getRandom(i,!0),s=VO(i.strength,this.parameters.randomness);if(!0===n.useCenter){let e={x:n.count[0]%2===0?2:1,y:n.count[1]%2===0?2:1,z:n.count[2]%2===0?2:1},a=new ji(n.size[0]*(n.count[0]-e.x)*.5,n.size[1]*(n.count[1]-e.y)*.5,n.size[2]*(n.count[2]-e.z)*.5);for(let o=0;o<n.count[0];o++)for(let e=0;e<n.count[1];e++)for(let l=0;l<n.count[2];l++){let c=r.noise((o+1)*(i.freqScale/10)+i.movement,(e+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement),h=this.children[t++];h.scale.x=1+s(t,HO(c,i.scale[0]))||hD,h.scale.y=1+s(t,HO(c,i.scale[1]))||hD,h.scale.z=1+s(t,HO(c,i.scale[2]))||hD;let u=s(t,HO(c,i.rotation[0])),d=s(t,HO(c,i.rotation[1])),p=s(t,HO(c,i.rotation[2]));h.rotation.set(u,d,p),h.position.x=n.size[0]*o-a.x+s(t,HO(c,i.position[0])),h.position.y=n.size[1]*e-a.y+s(t,HO(c,i.position[1])),h.position.z=n.size[2]*l-a.z+s(t,HO(c,i.position[2]))}}else for(let a=0;a<n.count[0];a++)for(let e=0;e<n.count[1];e++)for(let o=0;o<n.count[2];o++){let l=r.noise((a+1)*(i.freqScale/10)+i.movement,(e+1)*(i.freqScale/10)+i.movement,(o+1)*(i.freqScale/10)+i.movement),c=this.children[t++];c.scale.x=1+s(t,HO(l,i.scale[0]))||hD,c.scale.y=1+s(t,HO(l,i.scale[1]))||hD,c.scale.z=1+s(t,HO(l,i.scale[2]))||hD;let h=s(t,HO(l,i.rotation[0])),u=s(t,HO(l,i.rotation[1])),d=s(t,HO(l,i.rotation[2]));c.rotation.set(h,u,d),c.position.x=n.size[0]*a+s(t,HO(l,i.position[0])),c.position.y=-n.size[1]*e+s(t,HO(l,i.position[1])),c.position.z=-n.size[2]*o+s(t,HO(l,i.position[2]))}}_updateToObject(e){if("toObject"!==e.type)throw new Error;let{toObject:t}=e,n=new Tr(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??fx.defaultData([1,1,1]).randomnessObject,r=this.getRandom(i),s=VO(i.strength,this.parameters.randomness);if(!t.object){for(let[,e]of this.children.entries())e.position.set(0,0,0),e.scale.setScalar(1),e.rotation.set(0,0,0);return void(this.objectForSample=void 0)}if(!this.objectForSample)return;if(this.objectForSample instanceof cD){if(!this.objectForSample.font?.isLoaded||void 0===this.objectForSample.geometry.attributes.position)return void(this._pendingMediaLoad=!0);this._pendingMediaLoad=!1}if(void 0===this.objectForSample.geometry&&this.objectForSample.isAncestorOf(this.object.uuid))return void console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);let a=this.getSubdivData();if(a.length>0){let e=Math.round(a.length*t.count/100);this._updateCount(e)}else{let e=this.objectForSample.geometry.getAttribute("position");if(!e||isNaN(e.count)||0===e.count)return void console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`)}this.objectForSample.updateMatrixWorld();let o=new eS(this.objectForSample).build(),l=FO[t.axis],c=this.children;o.setRandomGenerator((0,HA.default)(this.object.uuid+t.seed));for(let[h,u]of c.entries()){let e=h*(i.freqScale/10)+i.movement,c=r.noise(e,e,e),d=h+1,p=s(d,HO(c,i.rotation[0])),f=s(d,HO(c,i.rotation[1])),m=s(d,HO(c,i.rotation[2]));"random"===t.spreadType?o.sample(vD,yD):(a.length&&(vD.fromArray(a[h].pos),yD.fromArray(a[h].norm)),this.objectForSample instanceof zO&&vD.applyMatrix4(pD.copy(this.objectForSample.matrixWorld).invert())),vD.applyMatrix4(this.object.hiddenMatrix.clone().invert()),u.position.copy(vD),mD.fromArray(l);let g="normal"===t.align?yD:this.object.getWorldDirection(wD),v=gD.fromArray(t.position);gD.x+=s(d,HO(c,i.position[0])),gD.y+=s(d,HO(c,i.position[1])),gD.z+=s(d,HO(c,i.position[2]));let y=Math.acos(g.dot(mD)),b=bD.crossVectors(mD,g).normalize(),w=fD.makeRotationAxis(b,y),x=g.clone().cross(this.object.up).normalize(),E=x.clone().cross(g).normalize(),C=(new vr).makeBasis(x,g,E),A=new ji(mD.y,mD.z,mD.x).normalize(),S=A.clone().cross(mD).normalize(),_=(new vr).makeBasis(A,mD,S).invert(),T=(new vr).multiplyMatrices(C,_);u.rotation.setFromRotationMatrix(T),v.applyMatrix4(w),u.position.add(v),u.rotation.x=u.rotation.x+n.x+p,u.rotation.y=u.rotation.y+n.y+f,u.rotation.z=u.rotation.z+n.z+m,u.scale.setScalar(1),u.scale.x=u.scale.x+t.scale[0]+s(d,HO(c,i.scale[0]))||hD,u.scale.y=u.scale.y+t.scale[1]+s(d,HO(c,i.scale[1]))||hD,u.scale.z=u.scale.z+t.scale[2]+s(d,HO(c,i.scale[2]))||hD,u.scale.multiply(this.object.scale),u.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType,t=new Map,n=(e,n)=>{let i=Math.round(1e4*e[0])+"_"+Math.round(1e4*e[1])+"_"+Math.round(1e4*e[2]),r=t.get(i);r?(r.pos[0]+=e[0],r.pos[1]+=e[1],r.pos[2]+=e[2],r.norm[0]+=n[0],r.norm[1]+=n[1],r.norm[2]+=n[2],r.count+=1):t.set(i,{pos:[...e],norm:[...n],count:1})};if("random"===e)return[];if(this.objectForSample instanceof zO){let t=this.objectForSample,i=jO[e],r=lD[i],s=aD[i],a=oD[i],o=r(t.subdivPointerNew);for(let e=0;e<=o-1;e++){let i=s(t.subdivPointerNew,e),r=a(t.subdivPointerNew,e);uD.fromArray(i).applyMatrix4(t.matrixWorld),dD.fromArray(r),n(uD.toArray(),dD.toArray())}}else(this.objectForSample.geometry.index?function(e){let t=[];for(let n=0;n<=e.index.count;n++)if(XO.fromArray(e.index.array,3*n),QO.setFromAttributeAndIndices(e.attributes.position,XO.x,XO.y,XO.z),QO.getNormal(ZO),QO.getMidpoint(JO),!(isNaN(JO.x)||isNaN(JO.y)||isNaN(JO.z))){let{a:e,b:n,c:i}=QO,r=e.toArray(),s=n.toArray(),a=i.toArray(),o=e.distanceTo(n),l=n.distanceTo(i),c=i.distanceTo(e),h=YO(r,s),u=YO(s,a),d=YO(a,r),p=[o,l,c],f=Math.max(...p),m=p.filter((e=>Math.round(e)===Math.round(f))).length>1,g=[],v=QO.getMidpoint(JO).toArray();f===o&&!m&&(g=[u,d,d],v=h),f===l&&!m&&(g=[h,d,d],v=u),f===c&&!m&&(g=[h,u,u],v=d),m&&(g=[h,u,d]),t.push({vertices:[r,s,a],faceCenters:g,midpoint:v,norm:QO.getNormal(ZO).toArray()})}return t}(this.objectForSample.geometry):function(e){let t=[],{position:n}=e.attributes;for(let i=0;i<n.count;i++){QO.setFromAttributeAndIndices(n,3*i,3*i+1,3*i+2),QO.getNormal(ZO),QO.getMidpoint(JO);let e=QO.a.toArray(),r=QO.b.toArray(),s=QO.c.toArray();t.push({vertices:[e,r,s],faceCenters:[YO(e,r),YO(r,s),YO(s,e)],midpoint:JO.toArray(),norm:ZO.toArray()})}return t}(this.objectForSample.geometry)).forEach(((t,i)=>{"polygon_center"===e&&n(t.midpoint,t.norm),"vertex"===e&&(n(t.vertices[0],t.norm),n(t.vertices[1],t.norm),n(t.vertices[2],t.norm)),"edge"===e&&(n(t.faceCenters[0],t.norm),n(t.faceCenters[1],t.norm),n(t.faceCenters[2],t.norm))}));let i=Array.from(t.values());for(let r of i)r.pos[0]/=r.count,r.pos[1]/=r.count,r.pos[2]/=r.count,r.norm[0]/=r.count,r.norm[1]/=r.count,r.norm[2]/=r.count;return i}updateState(e,t){if(this.parameters=Vg(e),"toObject"!==this.parameters.type)(null===this.parent||this.parent!==this.object)&&(this.removeFromParent(),this.object.parent?.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(null===this.parent||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let e=t.find(this.parameters.toObject.object);this.objectForSample=e instanceof $P?e:void 0,this.matrix=new vr,this.hiddenMatrix=new vr,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,e&&e.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},CD=e=>{var t;return(t=class extends e{}).geometryHelper=new Os(30,30,30),t},AD=new gr,SD=new lr,_D=new vr,TD=function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,a=t,o=s.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),SD.copy(a.boundingSphere),SD.applyMatrix4(o),!1===n.ray.intersectsSphere(SD)||(_D.copy(o).invert(),AD.copy(n.ray).applyMatrix4(_D),null!==a.boundingBox&&!1===AD.intersectsBox(a.boundingBox)))return;let l,c,h,u,d,p,f=a.index,m=a.attributes.position,g=a.drawRange;if(!1===r){for(d=Math.max(0,g.start),p=Math.min(f.count,g.start+g.count);d<p;d+=3)if(c=f.getX(d),h=f.getX(d+1),u=f.getX(d+2),l=v(e,n,AD,m,c,h,u),l)return l.faceIndex=Math.floor(d/3),void i.push(l)}else{let t=a.attributes.position,r=new ji,o=new ji,l=new ji,c=new ji,h=2,u=1/((s.scale.x+s.scale.y+s.scale.z)/3),d=u*u;for(let a=Math.max(0,g.start),p=Math.min(t.count,g.start+g.count)-1;a<p;a+=h){if(r.fromBufferAttribute(t,a),o.fromBufferAttribute(t,a+1),AD.distanceSqToSegment(r,o,c,l)>d)continue;c.applyMatrix4(s.matrixWorld);let h=n.ray.origin.distanceTo(c);h<n.near||h>n.far||i.push({distance:h,point:l.clone().applyMatrix4(s.matrixWorld),object:e})}}function v(e,t,n,i,r,s,a){let o=new ji,l=new ji,c=new ji,h=new ji,u=new ji;if(o.fromBufferAttribute(i,r),l.fromBufferAttribute(i,s),c.fromBufferAttribute(i,a),null===n.intersectTriangle(o,l,c,!1,h))return null;u.copy(h),u.applyMatrix4(e.matrixWorld);let d=t.ray.origin.distanceTo(u);return d<t.near||d>t.far?null:{faceIndex:1,distance:d,point:u.clone(),object:e}}},PD=new ji,MD=new Us,ND=class extends ic{constructor(e){let t=new gs,n=new Yl({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={},a=new Mi(15711266),o=new Mi(15711266),l=new Mi(2857471);function c(e,t,n){h(e,n),h(t,n)}function h(e,t){i.push(0,0,0),r.push(t.r,t.g,t.b),void 0===s[e]&&(s[e]=[]),s[e].push(i.length/3-1)}c("n1","n2",a),c("n2","n4",a),c("n4","n3",a),c("n3","n1",a),c("f1","f2",a),c("f2","f4",a),c("f4","f3",a),c("f3","f1",a),c("n1","f1",a),c("n2","f2",a),c("n3","f3",a),c("n4","f4",a),c("p","n1",o),c("p","n2",o),c("p","n3",o),c("p","n4",o),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l),t.setAttribute("position",new ls(i,3)),t.setAttribute("color",new ls(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;MD.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let n=.8;ID("n1",t,e,MD,-1,-1,n),ID("n2",t,e,MD,1,-1,n),ID("n3",t,e,MD,-1,1,n),ID("n4",t,e,MD,1,1,n);let i=n;ID("f1",t,e,MD,-1,-1,i),ID("f2",t,e,MD,1,-1,i),ID("f3",t,e,MD,-1,1,i),ID("f4",t,e,MD,1,1,i);let r=i;ID("u1",t,e,MD,.35,1.1,r),ID("u2",t,e,MD,-.35,1.1,r),ID("u3",t,e,MD,0,1.55,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function ID(e,t,n,i,r,s,a){PD.set(r,s,a).unproject(i);let o=t[e];if(void 0!==o){let e=n.getAttribute("position");for(let t=0,n=o.length;t<n;t++)e.setXYZ(o[t],PD.x,PD.y,PD.z)}}var OD,DD=class extends(CD(ND)){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){TD(this.object,this.geometry,e,t,!0)}};(e=>{e.is=e=>"objectHelper"in e})(OD||(OD={}));var LD=(e,t)=>class extends(PS(e)){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(e,t){this.objectHelper.raycast(e,t)}showGizmos(){for(let e in this.gizmos){let t=this.gizmos[e];t instanceof Fu&&(t.visible=!0)}}updateEntityBoxSize(e,t){this.objectHelper.visible&&this.geometryHelper instanceof Os?(e.setScalar(0),t.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(e,t)}hideGizmos(){for(let e in this.gizmos){let t=this.gizmos[e];t instanceof Fu&&(t.visible=!1)}}},RD=new ji,kD=new ji,BD=new Fi,UD=new ji,zD=new ji,FD=new ji,jD=class extends(LD(Us,DD)){constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{...pE.defaultData,name:""};super(),this._cameraType="OrthographicCamera",this.targetOffset=px.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new vr,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let n=this.width,i=this.height;this.orthoCamera=new ha(-.5*n,.5*n,.5*i,-.5*i,-5e4,1e4),this.perspCamera=new zs(45,n/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return"PerspectiveCamera"===this.cameraType}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){"PerspectiveCamera"===e?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&("PerspectiveCamera"===e?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){"PerspectiveCamera"===e?this.toPerspective():"OrthographicCamera"===e&&this.toOrthographic()}get near(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.near:this.orthoCamera.near}set near(e){"PerspectiveCamera"===this._cameraType?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&("PerspectiveCamera"===this._cameraType?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,n){"number"==typeof e&&(e=new ji(e,t,n)),super.lookAt(e),this.getWorldPosition(RD),this.targetOffset=RD.distanceTo(e)}getTarget(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ji;return this.getWorldDirection(kD),this.getWorldPosition(RD),kD.multiplyScalar(this.targetOffset),e.copy(RD).add(kD),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(RD),RD.distanceTo(e)}updateUp(){this.getWorldQuaternion(BD),UD.set(0,0,1).applyQuaternion(BD),zD.copy(Vr.DEFAULT_UP),this.isUpVectorFlipped&&zD.negate(),zD.applyQuaternion(BD),FD.copy(Vr.DEFAULT_UP).projectOnPlane(UD),this.angleOffsetFromUp=FD.angleTo(zD),this.angleOffsetFromUp*=FD.cross(zD).dot(UD)>=0?1:-1}updateTransformState(e,t){let n=super.updateTransformState(e,t);return void 0!==e.isUpVectorFlipped&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),n}getViewFrontToObject(e){let t=e.getWorldPosition(new ji),n=e.getWorldDirection(new ji).multiplyScalar(this.targetOffset);return{position:t.clone().add(n),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new ji).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new ji;e.getWorldPosition(t);return this.getViewToTarget(t)}setViewplaneSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.aspect=e/t,n){let n=e>t?this.aspect:1,i=e>t?1:this.aspect;this.left=-395*n,this.right=395*n,this.top=1/i*395,this.bottom=1/i*-395}else this.left=.5*-e,this.right=.5*e,this.top=.5*t,this.bottom=.5*-t;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,n,i,r,s){"PerspectiveCamera"===this._cameraType?this.perspCamera.setViewOffset(e,t,n,i,r,s):this.orthoCamera.setViewOffset(e,t,n,i,r,s)}clearViewOffset(){"PerspectiveCamera"===this._cameraType?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){"PerspectiveCamera"===this._cameraType?this.toPerspective():"OrthographicCamera"===this._cameraType&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=null===e.view?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return Sv(t,e)}updateCameraSubtype(e,t){let n="perspective"===e?"PerspectiveCamera":"OrthographicCamera";void 0!==t.zoom&&this.setZoom(n,t.zoom),void 0!==t.near&&this.setNear(n,t.near),void 0!==t.fov&&"PerspectiveCamera"===n&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),void 0!==e.far&&(this.far=e.far),void 0!==e.orthographic&&this.updateCameraSubtype("orthographic",e.orthographic),void 0!==e.perspective&&this.updateCameraSubtype("perspective",e.perspective),void 0!==e.type&&(this.cameraType=e.type),void 0!==e.up&&this.up.fromArray(e.up),void 0!==e.targetOffset&&(this.targetOffset=e.targetOffset),void 0!==e.isUpVectorFlipped&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),1===e.path.length&&0===e.type&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},VD=new vr,HD=new vr;function WD(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{"BooleanGeometry"===n.geometry?.type&&(t=!0)})),t}var GD,qD=class extends TO{constructor(e,t,n){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new gs,this.onAfterRender=(e,t,n,i,r,s)=>{super.onAfterRender(e,t,n,i,r,s),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),1===e.path.length&&"geometry"===e.path[0]&&0===e.type&&void 0!==e.props.operation&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(-1!==this.booleanMeshSetAddress&&!e)return;for(let i=0;i<this.children.length;i++){let n=this.children[i];n instanceof qD&&!0===n.dataPatched.visible&&n.recomputeBoolean(!0===e,t)}this.meshSetAddresses=[];for(let i=0;i<this.children.length;i++){let n=this.children[i];if(n instanceof $P&&!0===n.dataPatched.visible&&n.geometry.attributes.position?.count>0&&n.geometry.drawRange.count>0&&0!==n.booleanMeshSetAddress){VD.multiplyMatrices(n.hiddenMatrix,n.matrix);try{if(-1===n.booleanMeshSetAddress){if((n.geometry.index??n.geometry.getAttribute("position")).count/3<15e5&&(n.booleanMeshSetAddress=NP.getMeshSet(n.geometry,!0===e,t)),-1===n.booleanMeshSetAddress)return;NP.transformMeshSet(n.booleanMeshSetAddress,VD),n.booleanMatrixInvOld.copy(VD).invert(),n.booleanWasTransformed=!1}else n instanceof qD&&!0===n.needsTransformForDownstream?(NP.transformMeshSet(n.booleanMeshSetAddress,VD),n.needsTransformForDownstream=!1):!0===n.booleanWasTransformed&&(NP.transformMeshSet(n.booleanMeshSetAddress,HD.multiplyMatrices(VD,n.booleanMatrixInvOld)),n.booleanMatrixInvOld.copy(VD).invert(),n.booleanWasTransformed=!1)}catch(Jw){console.error(Jw),n.booleanMeshSetAddress=0,n.geometry.userData.booleanOperationDidFail=!0;continue}!1===NP.hasOpenEdges(n.booleanMeshSetAddress)||i===this.children.length-1&&2===this.booleanOp?(this.meshSetAddresses.push(n.booleanMeshSetAddress),n.geometry.userData.booleanOperationDidFail=!1):n.geometry.userData.booleanOperationDidFail="openEdges"}}if(0===this.meshSetAddresses.length)return this.geometry.setAttribute("position",new ls([],0)),void this.geometry.setDrawRange(0,0);if(!0===e)return NP.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let n=this.geometry;n.dispose(),this.geometry=new gs,this.geometry.userData=n.userData,this.geometry.boundingSphere=n.boundingSphere;try{this.booleanMeshSetAddress=NP.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(ux){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(ux)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,LO(this),RO(this)}dispose(){super.dispose(),this.geometry.dispose()}};(e=>{e.is=function(e){return sS.is(e)&&e instanceof zh}})(GD||(GD={}));var KD=(e,t)=>class extends(LD(e,t)){updateState_Light(e,t){this.updateState_Entity(e,t),void 0!==e.color&&(this.color=t.shared.color(e.color)),void 0!==e.intensity&&(this.intensity=e.intensity),void 0!==e.depth&&(this.shadow.camera.far=e.depth,this.shadow.needsUpdate=!0),void 0!==e.shadows&&(this.castShadow=e.shadows)}},YD=e=>e instanceof $P,QD=e=>null!==e&&e instanceof qD,XD=e=>OD.is(e),ZD=new ji(1,1,1),JD=new ji,$D=new ji,eL=new Fi,tL=class extends(CD(ju)){constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:15),this.object=e,this.dummy=new Cl,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){TD(this.object,tL.geometryHelper,e,t,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(e){this.object.matrixWorld.decompose(JD,eL,$D),this.matrix.compose(JD,eL,ZD),super.updateMatrixWorld(e)}updateWorldMatrix(e,t){}},nL=class extends(LD(Cl,tL)){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&1===Object.keys(e).length&&t.scene.reloadSplats()}},iL=class extends(LD(Cl,tL)){constructor(e,t,n){super(),this.super_Entity(e,t),this.context=n,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},rL=0,sL=1,aL="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",oL=class extends Bs{constructor(){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super({name:"BokehMaterial",defines:{PASS:arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"2":"1"},uniforms:{kernel64:new bu(null),kernel16:new bu(null),inputBuffer:new bu(null),cocBuffer:new bu(null),texelSize:new bu(new di),scale:new bu(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){\n#ifdef FOREGROUND\nvec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;\n#else\nfloat CoC=texture2D(cocBuffer,vUv).g*scale;\n#endif\nif(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{\n#ifdef FOREGROUND\nvec2 step=texelSize*max(CoC,CoCNearFar.g*scale);\n#else\nvec2 step=texelSize*CoC;\n#endif\nvec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}",vertexShader:aL}),this.toneMapped=!1,e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=new Float32Array(128),t=new Float32Array(32),n=0,i=0;for(let a=0;a<80;++a){let r=2.39996323*a,s=Math.sqrt(a)/Math.sqrt(80),o=s*Math.cos(r),l=s*Math.sin(r);a%5===0?(t[i++]=o,t[i++]=l):(e[n++]=o,e[n++]=l)}let r=[],s=[];for(let a=0;a<128;)r.push(new ki(e[a++],e[a++],e[a++],e[a++]));for(let a=0;a<32;)s.push(new ki(t[a++],t[a++],t[a++],t[a++]));this.uniforms.kernel64.value=r,this.uniforms.kernel16.value=s}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function lL(e,t,n){return e*(t-n)-t}function cL(e,t,n){return Math.min(Math.max((e+t)/(t-n),0),1)}var hL=class extends Bs{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new bu(null),focusDistance:new bu(0),focusRange:new bu(0),cameraNear:new bu(.3),cameraFar:new bu(1e3)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <packing>\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}void main(){float depth=readDepth(vUv);\n#ifdef PERSPECTIVE_CAMERA\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\n#else\nfloat linearDepth=depth;\n#endif\nfloat signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}",vertexShader:aL}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wn;this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-lL(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=cL(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-lL(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=cL(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof zs?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},uL=class extends Bs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new di;super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new bu(null),texelSize:new bu(new di),halfTexelSize:new bu(new di),kernel:new bu(0),scale:new bu(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#include <dithering_pars_fragment>\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nvarying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;\n#include <encodings_fragment>\n#include <dithering_fragment>\n}",vertexShader:"uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let n=this.uniforms;n.texelSize.value.set(1/e,1/t),n.halfTexelSize.value.copy(n.texelSize.value).multiplyScalar(.5)}},dL=class extends Bs{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new bu(null),opacity:new bu(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\n#include <encodings_fragment>\n}",vertexShader:aL}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},pL={DEPTH:0,LUMA:1,COLOR:2},fL={DISABLED:0,DEPTH:1,CUSTOM:2},mL=class extends Bs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new di,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pL.COLOR;super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:Ut.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new bu(null),depthBuffer:new bu(null),predicationBuffer:new bu(null),texelSize:new bu(e)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#if EDGE_DETECTION_MODE != 0\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\n#endif\n#if EDGE_DETECTION_MODE == 1\n#include <common>\n#endif\n#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}\n#elif PREDICATION_MODE == 2\nuniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}\n#endif\n#if PREDICATION_MODE != 0\nvec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}\n#endif\n#if EDGE_DETECTION_MODE != 0\nuniform sampler2D inputBuffer;\n#endif\nvoid main(){\n#if EDGE_DETECTION_MODE == 0\nconst vec2 threshold=vec2(DEPTH_THRESHOLD);\n#elif PREDICATION_MODE != 0\nvec2 threshold=calculatePredicatedThreshold();\n#else\nconst vec2 threshold=vec2(EDGE_THRESHOLD);\n#endif\n#if EDGE_DETECTION_MODE == 0\nvec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);\n#elif EDGE_DETECTION_MODE == 1\nfloat l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\n#elif EDGE_DETECTION_MODE == 2\nvec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\n#endif\n}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\n#if EDGE_DETECTION_MODE != 0\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\n#endif\nvoid main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);\n#if EDGE_DETECTION_MODE != 0\nvUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);\n#endif\ngl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wn;this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(.1*e).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},gL="#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#define packFloatToRGBA(v) packDepthToRGBA(v)\n#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#if THREE_REVISION >= 137\nvec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}float getViewZ(const in float depth){\n#ifdef PERSPECTIVE_CAMERA\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\n#else\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\n#endif\n}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;\n#ifdef ENCODE_OUTPUT\n#include <encodings_fragment>\n#endif\n#include <dithering_fragment>\n}",vL={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},yL=class extends Bs{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super({name:"EffectMaterial",defines:{THREE_REVISION:Ut.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new bu(null),depthBuffer:new bu(null),resolution:new bu(new di),texelSize:new bu(new di),cameraNear:new bu(.3),cameraFar:new bu(1e3),aspect:new bu(1),time:new bu(0)},blending:0,depthWrite:!1,depthTest:!1,dithering:r}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),n&&this.setUniforms(n),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wn;this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=gL.replace(vL.FRAGMENT_HEAD,e.get(vL.FRAGMENT_HEAD)).replace(vL.FRAGMENT_MAIN_UV,e.get(vL.FRAGMENT_MAIN_UV)).replace(vL.FRAGMENT_MAIN_IMAGE,e.get(vL.FRAGMENT_MAIN_IMAGE)),this.vertexShader="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}".replace(vL.VERTEX_HEAD,e.get(vL.VERTEX_HEAD)).replace(vL.VERTEX_MAIN_SUPPORT,e.get(vL.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return void 0!==this.defines.ENCODE_OUTPUT}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof zs?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let n=this.uniforms;n.resolution.value.set(e,t),n.texelSize.value.set(1/e,1/t),n.aspect.value=e/t}static get Section(){return vL}},bL=class extends Bs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super({name:"LuminanceMaterial",defines:{THREE_REVISION:Ut.replace(/\D+/g,"")},uniforms:{inputBuffer:new bu(null),threshold:new bu(0),smoothing:new bu(1),range:new bu(null)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#include <common>\n#if THREE_REVISION < 143\n#define luminance(v) linearToRelativeLuminance(v)\n#endif\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef RANGE\nuniform vec2 range;\n#elif defined(THRESHOLD)\nuniform float threshold;uniform float smoothing;\n#endif\nvarying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);\n#ifdef RANGE\nfloat low=step(range.x,l);float high=step(l,range.y);l*=low*high;\n#elif defined(THRESHOLD)\nl=smoothstep(threshold,threshold+smoothing,l);\n#endif\n#ifdef COLOR\ngl_FragColor=vec4(texel.rgb*l,l);\n#else\ngl_FragColor=vec4(l);\n#endif\n}",vertexShader:aL}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return void 0!==this.defines.COLOR}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return null!==this.luminanceRange}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){null!==e?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},wL=0,xL=1,EL=class extends Bs{constructor(){super({name:"MaskMaterial",uniforms:{maskTexture:new bu(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),inputBuffer:new bu(null),strength:new bu(1)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\n#ifdef MASK_PRECISION_HIGH\nuniform mediump sampler2D maskTexture;\n#else\nuniform lowp sampler2D maskTexture;\n#endif\n#if MASK_FUNCTION != 0\nuniform float strength;\n#endif\nvarying vec2 vUv;void main(){\n#if COLOR_CHANNEL == 0\nfloat mask=texture2D(maskTexture,vUv).r;\n#elif COLOR_CHANNEL == 1\nfloat mask=texture2D(maskTexture,vUv).g;\n#elif COLOR_CHANNEL == 2\nfloat mask=texture2D(maskTexture,vUv).b;\n#else\nfloat mask=texture2D(maskTexture,vUv).a;\n#endif\n#if MASK_FUNCTION == 0\n#ifdef INVERTED\nmask=step(mask,0.0);\n#else\nmask=1.0-step(mask,0.0);\n#endif\n#else\nmask=clamp(mask*strength,0.0,1.0);\n#ifdef INVERTED\nmask=1.0-mask;\n#endif\n#endif\n#if MASK_FUNCTION == 2\ngl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);\n#else\ngl_FragColor=mask*texture2D(inputBuffer,vUv);\n#endif\n}",vertexShader:aL}),this.toneMapped=!1,this.setColorChannel(rL),this.setMaskFunction(wL)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==bn&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return void 0!==this.defines.INVERTED}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},CL=class extends Bs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new di,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new di;super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new bu(null),searchTexture:new bu(null),areaTexture:new bu(null),resolution:new bu(t),texelSize:new bu(e)},blending:0,depthWrite:!1,depthTest:!1,fragmentShader:"#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)\n#if __VERSION__ < 300\n#define round(v) floor(v + 0.5)\n#endif\n#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D inputBuffer;\n#else\nuniform lowp sampler2D inputBuffer;\n#endif\nuniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\n#if !defined(DISABLE_CORNER_DETECTION)\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);\n#endif\n}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\n#if !defined(DISABLE_CORNER_DETECTION)\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);\n#endif\n}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){\n#if !defined(DISABLE_DIAG_DETECTION)\nweights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){\n#endif\nvec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);\n#if !defined(DISABLE_DIAG_DETECTION)\n}else{e.r=0.0;}\n#endif\n}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}",vertexShader:"uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}"}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return void 0===this.defines.DISABLE_DIAG_DETECTION}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return void 0===this.defines.DISABLE_CORNER_DETECTION}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let n=this.uniforms;n.texelSize.value.set(1/e,1/t),n.resolution.value.set(e,t)}},AL=new Us,SL=null;var _L=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Pass",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ol,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:AL;this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();null!==t&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return null!==this.screen?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;null!==t?t.material=e:(t=new Ns(function(){if(null===SL){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);void 0!==(SL=new gs).setAttribute?(SL.setAttribute("position",new ss(e,3)),SL.setAttribute("uv",new ss(t,2))):(SL.addAttribute("position",new ss(e,3)),SL.addAttribute("uv",new ss(t,2)))}return SL}(),e),t.frustumCulled=!1,null===this.scene&&(this.scene=new Ol),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e){}render(e,t,n,i,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(null!==t&&"object"==typeof t&&"function"==typeof t.dispose){if(t instanceof Ol||t===this.renderer)continue;this[e].dispose()}}}},TL=class extends _L{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super("CopyPass"),this.fullscreenMaterial=new dL,this.needsSwap=!1,this.renderTarget=e,void 0===e&&(this.renderTarget=new Bi(1,1,{minFilter:gn,magFilter:gn,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,n,i,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,n){void 0!==n&&(this.renderTarget.texture.type=n,n!==bn?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===Hn&&(this.renderTarget.texture.encoding=Hn))}},PL=class extends _L{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,n,i,r){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},ML=new Mi,NL=class extends _L{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,n){this.color=e,this.depth=t,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,n,i,r){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=null!==s,c=a>=0;l?(ML.copy(e.getClearColor(ML)),e.setClearColor(s,c?a:o)):c&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(ML,o):c&&e.setClearAlpha(o)}},IL=-1,OL=class extends Zn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:IL,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:IL,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.resizable=e,this.base=new di(1,1),this.preferred=new di(t,n),this.target=this.preferred,this.s=i}get width(){let e,{base:t,preferred:n,scale:i}=this;return e=n.width!==IL?n.width:n.height!==IL?Math.round(n.height*(t.width/Math.max(t.height,1))):Math.round(t.width*i),e}set width(e){this.preferredWidth=e}get height(){let e,{base:t,preferred:n,scale:i}=this;return e=n.height!==IL?n.height:n.width!==IL?Math.round(n.width/Math.max(t.width/Math.max(t.height,1),1)):Math.round(t.height*i),e}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(IL),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return IL}},DL=!1,LL=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case 2:t=this.materialsFlatShadedDoubleSide;break;case 1:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded}else switch(e.material.side){case 2:t=this.materialsDoubleSide;break;case 1:t=this.materialsBackSide;break;default:t=this.materials}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,null!==e){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let n of t)n.uniforms=Object.assign({},e.uniforms),n.side=0;t[2].skinning=!0,this.materialsBackSide=t.map((t=>{let n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=1,n})),this.materialsDoubleSide=t.map((t=>{let n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=2,n})),this.materialsFlatShaded=t.map((t=>{let n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n})),this.materialsFlatShadedBackSide=t.map((t=>{let n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=1,n})),this.materialsFlatShadedDoubleSide=t.map((t=>{let n=t.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=2,n}))}}render(e,t,n){let i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,DL){let i=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,n);for(let e of i)e[0].material=e[1];this.meshCount!==i.size&&i.clear()}else{let i=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,n),t.overrideMaterial=i}e.shadowMap.enabled=i}disposeMaterials(){if(null!==this.material){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return DL}static set workaroundEnabled(e){DL=e}},RL=class extends _L{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new NL,this.overrideMaterialManager=null===n?null:new LL(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return null!==e?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;null!==e?null!==t?t.setMaterial(e):this.overrideMaterialManager=new LL(e):null!==t&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,n,i,r){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=s.background,h=e.shadowMap.autoUpdate,u=this.renderToScreen?null:t;null!==o&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||null!==this.clearPass.overrideClearColor)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(u),null!==this.overrideMaterialManager?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=c,e.shadowMap.autoUpdate=h}},kL=class extends _L{constructor(e,t){let{resolutionScale:n=1,width:i=OL.AUTO_SIZE,height:r=OL.AUTO_SIZE,renderTarget:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super("DepthPass"),this.needsSwap=!1,this.renderPass=new RL(e,t,new gl({depthPacking:3201}));let a=this.renderPass;a.skipShadowMapUpdate=!0,a.ignoreBackground=!0;let o=a.getClearPass();o.overrideClearColor=new Mi(16777215),o.overrideClearAlpha=1,this.renderTarget=s,void 0===this.renderTarget&&(this.renderTarget=new Bi(1,1,{minFilter:pn,magFilter:pn,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new OL(this,i,r,n);l.addEventListener("change",(e=>this.setSize(l.baseWidth,l.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,r){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}},BL=(new Float32Array([255/256/256**3,255/256/65536,255/256/256,255/256]),{SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18}),UL=new Map([[BL.SKIP,null],[BL.ADD,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}"],[BL.ALPHA,"vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}"],[BL.AVERAGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}"],[BL.COLOR_BURN,"float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[BL.COLOR_DODGE,"float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[BL.DARKEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}"],[BL.DIFFERENCE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}"],[BL.EXCLUSION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}"],[BL.LIGHTEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}"],[BL.MULTIPLY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}"],[BL.DIVIDE,"float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[BL.NEGATION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}"],[BL.NORMAL,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}"],[BL.OVERLAY,"float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[BL.REFLECT,"float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[BL.SCREEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}"],[BL.SOFT_LIGHT,"float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[BL.SUBTRACT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}"]]),zL=class extends Zn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.f=e,this.opacity=new bu(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return UL.get(this.blendFunction)}},FL={NONE:0,DEPTH:1,CONVOLUTION:2},jL=class extends Zn{constructor(e,t){let{attributes:n=FL.NONE,blendFunction:i=BL.SCREEN,defines:r=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.name=e,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=o,this.defines=r,this.uniforms=s,this.extensions=a,this.blendMode=new zL(i),this.blendMode.addEventListener("change",(e=>this.setChanged()))}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e){}update(e,t,n){}setSize(e,t){}initialize(e,t,n){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(null!==t&&"object"==typeof t&&"function"==typeof t.dispose){if(t instanceof Ol||t===this.renderer)continue;this[e].dispose()}}}};function VL(e,t,n){for(let i of t){let t="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),r=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let e of n.entries())null!==e[1]&&n.set(e[0],e[1].replace(r,t))}}function HL(e,t,n,i,r,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=void 0!==o.get("fragment")&&/mainImage/.test(o.get("fragment")),c=void 0!==o.get("fragment")&&/mainUv/.test(o.get("fragment")),h=[],u=[],d=!1,p=!1;if(void 0===o.get("fragment"))console.error("Missing fragment shader",t);else if(c&&0!==(a&FL.CONVOLUTION))console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(l||c){let f=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=yL.Section;if(c){let t=`\t${e}MainUv(UV);\n`;n.set(m.FRAGMENT_MAIN_UV,n.get(m.FRAGMENT_MAIN_UV)+t),d=!0}if(null!==o.get("vertex")&&/mainSupport/.test(o.get("vertex"))){let t=`\t${e}MainSupport(`;t+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?"vUv);\n":");\n",n.set(m.VERTEX_MAIN_SUPPORT,n.get(m.VERTEX_MAIN_SUPPORT)+t),h=h.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map((e=>e[1]))),u=u.concat(h).concat([...o.get("vertex").matchAll(f)].map((e=>e[1])))}u=u.concat([...o.get("fragment").matchAll(f)].map((e=>e[1]))),u=u.concat([...t.defines.keys()].map((e=>e.replace(/\([\w\s,]*\)/g,"")))),u=u.concat([...t.uniforms.keys()]),t.uniforms.forEach(((t,n)=>s.set(e+n.charAt(0).toUpperCase()+n.slice(1),t))),t.defines.forEach(((t,n)=>r.set(e+n.charAt(0).toUpperCase()+n.slice(1),t))),VL(e,u,r),VL(e,u,o);let g=t.blendMode;if(i.set(g.blendFunction,g),l){let t=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,i=`${e}MainImage(color0, UV, `;0!==(a&FL.DEPTH)&&t.test(o.get("fragment"))&&(i+="depth, ",p=!0),i+="color1);\n\t";let r=e+"BlendOpacity";s.set(r,g.opacity),i+=`color0 = blend${g.blendFunction}(color0, color1, ${r});\n\n\t`,n.set(m.FRAGMENT_MAIN_IMAGE,n.get(m.FRAGMENT_MAIN_IMAGE)+i),i=`uniform float ${r};\n\n`,n.set(m.FRAGMENT_HEAD,n.get(m.FRAGMENT_HEAD)+i)}n.set(m.FRAGMENT_HEAD,n.get(m.FRAGMENT_HEAD)+o.get("fragment")+"\n"),null!==o.get("vertex")&&n.set(m.VERTEX_HEAD,n.get(m.VERTEX_HEAD)+o.get("vertex")+"\n")}else console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);return{varyings:h,transformedUv:d,readDepth:p}}var WL=class extends _L{constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];super("EffectPass"),this.fullscreenMaterial=new yL(null,null,null,e),this.effects=n.sort(((e,t)=>t.attributes-e.attributes)),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=yL.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),n=new Map,i=new Map,r=new Map,s=new Set,a=0,o=0,l=0,c=!1,h=!1;for(let d of this.effects)if(d.blendMode.blendFunction===BL.SKIP)l|=d.getAttributes()&FL.DEPTH;else if(0!==(l&d.getAttributes()&FL.CONVOLUTION))console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let e=HL("e"+a++,d,t,n,i,r,l);if(o+=e.varyings.length,c=c||e.transformedUv,h=h||e.readDepth,null!==d.extensions)for(let t of d.extensions)s.add(t)}let u=/\bblend\b/g;for(let d of n.values()){let n=d.getShaderCode().replace(u,`blend${d.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+n+"\n")}if(0!==(l&FL.DEPTH)){if(h){let n="float depth = readDepth(UV);\n\n\t";t.set(e.FRAGMENT_MAIN_IMAGE,n+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=null===this.getDepthTexture()}else this.needsDepthTexture=!1;if(c){let n="vec2 transformedUv = vUv;\n";t.set(e.FRAGMENT_MAIN_UV,n+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")}else i.set("UV","vUv");t.forEach(((e,t,n)=>n.set(t,e.trim().replace(/^#/,"\n#")))),this.uniformCount=r.size,this.varyingCount=o,this.skipRendering=0===a,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(r).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wn;this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let n of this.effects)n.setDepthTexture(e,t)}render(e,t,n,i,r){for(let s of this.effects)s.update(e,t,i);if(!this.skipRendering||this.renderToScreen){let r=this.fullscreenMaterial;r.inputBuffer=t.texture,r.time+=i,e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let n of this.effects)n.setSize(e,t)}initialize(e,t,n){this.renderer=e;for(let i of this.effects)i.initialize(e,t,n),i.addEventListener("change",(e=>this.handleEvent(e)));this.updateMaterial(),this.verifyResources(),void 0!==n&&n!==bn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){if("change"===e.type)this.recompile()}},GL=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],qL=class extends _L{constructor(){let{resolutionScale:e=.5,width:t=OL.AUTO_SIZE,height:n=OL.AUTO_SIZE,kernelSize:i=JL.LARGE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("KawaseBlurPass"),this.renderTargetA=new Bi(1,1,{minFilter:gn,magFilter:gn,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let r=this.resolution=new OL(this,t,n,e);r.addEventListener("change",(e=>this.setSize(r.baseWidth,r.baseHeight))),this.blurMaterial=new uL,this.ditheredBlurMaterial=new uL,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,n,i,r){let s,a,o=this.scene,l=this.camera,c=this.renderTargetA,h=this.renderTargetB,u=GL[this.kernelSize],d=this.blurMaterial,p=t;for(this.fullscreenMaterial=d,s=0,a=u.length-1;s<a;++s){let t=0===(1&s)?c:h;d.kernel=u[s],d.inputBuffer=p.texture,e.setRenderTarget(t),e.render(o,l),p=t}this.dithering&&(d=this.ditheredBlurMaterial,this.fullscreenMaterial=d),d.kernel=u[s],d.inputBuffer=p.texture,e.setRenderTarget(this.renderToScreen?null:n),e.render(o,l)}setSize(e,t){let n=this.resolution;n.setBaseSize(e,t);let i=n.width,r=n.height;this.renderTargetA.setSize(i,r),this.renderTargetB.setSize(i,r),this.blurMaterial.setSize(i,r),this.ditheredBlurMaterial.setSize(i,r)}initialize(e,t,n){void 0!==n&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==bn?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===Hn&&(this.renderTargetA.texture.encoding=Hn,this.renderTargetB.texture.encoding=Hn))}static get AUTO_SIZE(){return OL.AUTO_SIZE}},KL=class extends _L{constructor(){let{width:e=OL.AUTO_SIZE,height:t=OL.AUTO_SIZE,renderTarget:n,luminanceRange:i,colorOutput:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("LuminancePass"),this.fullscreenMaterial=new bL(r,i),this.needsSwap=!1,this.renderTarget=n,void 0===this.renderTarget&&(this.renderTarget=new Bi(1,1,{minFilter:gn,magFilter:gn,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new OL(this,e,t);s.addEventListener("change",(e=>this.setSize(s.baseWidth,s.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,n,i,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height)}initialize(e,t,n){void 0!==n&&n!==bn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},YL=class extends _L{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new NL(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,n,i,r){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,h=this.inverted?0:1,u=1-h;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,h,4294967295),a.stencil.setClear(u),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,n))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(n),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},QL=class extends _L{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inputBuffer";super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,null!==this.fullscreenMaterial){let t=this.fullscreenMaterial.uniforms;void 0!==t&&void 0!==t[e]&&(this.inputBufferUniform=t[e])}}render(e,t,n,i,r){null!==this.inputBufferUniform&&null!==t&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:n),e.render(this.scene,this.camera)}initialize(e,t,n){void 0!==n&&n!==bn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},XL=.001,ZL=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&void 0!==document.hidden&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*XL}getFixedDelta(){return this.fixedDelta*XL}setFixedDelta(e){return this.fixedDelta=1e3*e,this}getElapsed(){return this.elapsed*XL}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=void 0!==e?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},JL={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},$L=class extends jL{constructor(){let{blendFunction:e=BL.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:n=.025,resolutionScale:i=.5,intensity:r=1,width:s=OL.AUTO_SIZE,height:a=OL.AUTO_SIZE,kernelSize:o=JL.LARGE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BloomEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D map;\n#else\nuniform lowp sampler2D map;\n#endif\nuniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}",{blendFunction:e,uniforms:new Map([["map",new bu(null)],["intensity",new bu(r)]])}),this.renderTarget=new Bi(1,1,{minFilter:gn,magFilter:gn,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new KL({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=n,this.blurPass=new qL({resolutionScale:i,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",(e=>this.setSize(l.baseWidth,l.baseHeight)))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,n){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){let n=this.resolution;n.setBaseSize(e,t),this.renderTarget.setSize(n.width,n.height),this.luminancePass.resolution.copy(n)}initialize(e,t,n){this.blurPass.initialize(e,t,n),void 0!==n&&(this.renderTarget.texture.type=n,e.outputEncoding===Hn&&(this.renderTarget.texture.encoding=Hn))}},eR=class extends jL{constructor(){let{blendFunction:e=BL.NORMAL,brightness:t=0,contrast:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("BrightnessContrastEffect","uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",{blendFunction:e,uniforms:new Map([["brightness",new bu(t)],["contrast",new bu(n)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},tR=class extends jL{constructor(){super("ColorAverageEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",{blendFunction:arguments.length>0&&void 0!==arguments[0]?arguments[0]:BL.NORMAL})}},nR=class extends jL{constructor(){let{blendFunction:e=BL.NORMAL,offset:t=new di(.001,5e-4)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("ChromaticAberrationEffect","varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",{vertexShader:"uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",blendFunction:e,attributes:FL.CONVOLUTION,uniforms:new Map([["offset",new bu(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},iR=class extends jL{constructor(e){let{blendFunction:t=BL.NORMAL,worldFocusDistance:n,worldFocusRange:i,focusDistance:r=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=OL.AUTO_SIZE,height:c=OL.AUTO_SIZE}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super("DepthOfFieldEffect","#ifdef FRAMEBUFFER_PRECISION_HIGH\nuniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;\n#else\nuniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;\n#endif\nuniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}",{blendFunction:t,attributes:FL.DEPTH,uniforms:new Map([["nearColorBuffer",new bu(null)],["farColorBuffer",new bu(null)],["nearCoCBuffer",new bu(null)],["scale",new bu(1)]])}),this.camera=e,this.renderTarget=new Bi(1,1,{minFilter:gn,magFilter:gn,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new QL(new hL(e));let h=this.cocMaterial;h.focusDistance=r,h.focusRange=a,void 0!==n&&(h.worldFocusDistance=n),void 0!==i&&(h.worldFocusRange=i),this.blurPass=new qL({kernelSize:JL.MEDIUM,width:l,height:c});let u=this.blurPass.getResolution();u.addEventListener("change",(e=>this.setSize(u.getBaseWidth(),u.getBaseHeight()))),this.maskPass=new QL(new EL(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=xL,d.colorChannel=sL,this.bokehNearBasePass=new QL(new oL(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new QL(new oL(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new QL(new oL(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new QL(new oL(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let n of t)n.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera;return cL(-t.position.distanceTo(e),t.near,t.far)}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wn;this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,n){let i=this.renderTarget,r=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(null!==this.target){let e=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=e}this.cocPass.render(e,null,r),this.blurPass.render(e,r,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){let n=this.resolution;n.setBaseSize(e,t);let i=n.width,r=n.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach((n=>n.setSize(e,t))),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach((e=>e.setSize(i,r))),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach((e=>e.fullscreenMaterial.setSize(i,r)))}initialize(e,t,n){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach((i=>i.initialize(e,t,n))),this.blurPass.initialize(e,t,bn),void 0!==n&&(this.renderTarget.texture.type=n,this.renderTargetNear.texture.type=n,this.renderTargetFar.texture.type=n,this.renderTargetMasked.texture.type=n,e.outputEncoding===Hn&&(this.renderTarget.texture.encoding=Hn,this.renderTargetNear.texture.encoding=Hn,this.renderTargetFar.texture.encoding=Hn,this.renderTargetMasked.texture.encoding=Hn))}},rR=(new ji,new vr,class extends jL{constructor(){let{blendFunction:e=BL.NORMAL,hue:t=0,saturation:n=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("HueSaturationEffect","uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",{blendFunction:e,uniforms:new Map([["hue",new bu(new ji)],["saturation",new bu(n)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((3*e.x-1)/2)}set hue(e){let t=Math.sin(e),n=Math.cos(e);this.uniforms.get("hue").value.set((2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}}),sR=(new Mi,class extends jL{constructor(){let{blendFunction:e=BL.SCREEN,premultiply:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("NoiseEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));\n#ifdef PREMULTIPLY\noutputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);\n#else\noutputColor=vec4(noise,inputColor.a);\n#endif\n}",{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}}),aR=class extends jL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;super("PixelationEffect","uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",{uniforms:new Map([["active",new bu(!1)],["d",new bu(new di)]])}),this.resolution=new di,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}},oR=(Math.PI,new ji,new ji,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC"),lR="data:image/png;base64,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",cR={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},hR=class extends jL{constructor(){let e,t,{preset:n=cR.MEDIUM,edgeDetectionMode:i=pL.COLOR,predicationMode:r=fL.DISABLED}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("SMAAEffect","uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",{vertexShader:"varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",blendFunction:BL.NORMAL,attributes:FL.CONVOLUTION|FL.DEPTH,uniforms:new Map([["weightMap",new bu(null)]])}),arguments.length>1&&(e=arguments[0],t=arguments[1],arguments.length>2&&(n=arguments[2]),arguments.length>3&&(i=arguments[3])),this.renderTargetEdges=new Bi(1,1,{minFilter:gn,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new NL(!0,!1,!1),this.clearPass.overrideClearColor=new Mi(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new QL(new mL),this.edgeDetectionMaterial.edgeDetectionMode=i,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new QL(new CL);let s=new Ih;s.onLoad=()=>{let n=new Ri(e);n.name="SMAA.Search",n.magFilter=pn,n.minFilter=pn,n.generateMipmaps=!1,n.needsUpdate=!0,n.flipY=!0,this.weightsMaterial.searchTexture=n;let i=new Ri(t);i.name="SMAA.Area",i.magFilter=gn,i.minFilter=gn,i.generateMipmaps=!1,i.needsUpdate=!0,i.flipY=!1,this.weightsMaterial.areaTexture=i,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),void 0!==e&&void 0!==t?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(e=new Image,t=new Image,e.addEventListener("load",(()=>s.itemEnd("search"))),t.addEventListener("load",(()=>s.itemEnd("area"))),e.src=oR,t.src=lR),this.applyPreset(n)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,n=this.weightsMaterial;switch(e){case cR.LOW:t.edgeDetectionThreshold=.15,n.orthogonalSearchSteps=4,n.diagonalDetection=!1,n.cornerDetection=!1;break;case cR.MEDIUM:t.edgeDetectionThreshold=.1,n.orthogonalSearchSteps=8,n.diagonalDetection=!1,n.cornerDetection=!1;break;case cR.HIGH:t.edgeDetectionThreshold=.1,n.orthogonalSearchSteps=16,n.diagonalSearchSteps=8,n.cornerRounding=25,n.diagonalDetection=!0,n.cornerDetection=!0;break;case cR.ULTRA:t.edgeDetectionThreshold=.05,n.orthogonalSearchSteps=32,n.diagonalSearchSteps=16,n.cornerRounding=25,n.diagonalDetection=!0,n.cornerDetection=!0}}setDepthTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wn;this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,n){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;null!==e&&null!==t&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return oR}static get areaImageDataURL(){return lR}},uR={DEFAULT:0,ESKIL:1},dR=class extends jL{constructor(){let{blendFunction:e=BL.NORMAL,technique:t=uR.DEFAULT,eskil:n=!1,offset:i=.5,darkness:r=.5}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super("VignetteEffect","uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;\n#if VIGNETTE_TECHNIQUE == 0\nfloat d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));\n#else\nvec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));\n#endif\noutputColor=vec4(color,inputColor.a);}",{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new bu(i)],["darkness",new bu(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===uR.ESKIL}set eskil(e){this.technique=e?uR.ESKIL:uR.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}};new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array(3),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([1,0,0]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([1,0,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([1,1,0]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,1,0]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array([0,0,0]),new Float32Array([0,0,1]),new Float32Array([0,1,1]),new Float32Array([1,1,1]),new Float32Array(2),new Float32Array(2),new Float32Array([0,-.25,.25,-.125,.125,-.375,.375]),new Float32Array([0,0]),new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([.125,-.125]),new Float32Array([-.125,.125]),new Uint8Array([0,0]),new Uint8Array([3,0]),new Uint8Array([0,3]),new Uint8Array([3,3]),new Uint8Array([1,0]),new Uint8Array([4,0]),new Uint8Array([1,3]),new Uint8Array([4,3]),new Uint8Array([0,1]),new Uint8Array([3,1]),new Uint8Array([0,4]),new Uint8Array([3,4]),new Uint8Array([1,1]),new Uint8Array([4,1]),new Uint8Array([1,4]),new Uint8Array([4,4]),new Uint8Array([0,0]),new Uint8Array([1,0]),new Uint8Array([0,2]),new Uint8Array([1,2]),new Uint8Array([2,0]),new Uint8Array([3,0]),new Uint8Array([2,2]),new Uint8Array([3,2]),new Uint8Array([0,1]),new Uint8Array([1,1]),new Uint8Array([0,3]),new Uint8Array([1,3]),new Uint8Array([2,1]),new Uint8Array([3,1]),new Uint8Array([2,3]),new Uint8Array([3,3]),new Map([[fR(0,0,0,0),new Float32Array([0,0,0,0])],[fR(0,0,0,1),new Float32Array([0,0,0,1])],[fR(0,0,1,0),new Float32Array([0,0,1,0])],[fR(0,0,1,1),new Float32Array([0,0,1,1])],[fR(0,1,0,0),new Float32Array([0,1,0,0])],[fR(0,1,0,1),new Float32Array([0,1,0,1])],[fR(0,1,1,0),new Float32Array([0,1,1,0])],[fR(0,1,1,1),new Float32Array([0,1,1,1])],[fR(1,0,0,0),new Float32Array([1,0,0,0])],[fR(1,0,0,1),new Float32Array([1,0,0,1])],[fR(1,0,1,0),new Float32Array([1,0,1,0])],[fR(1,0,1,1),new Float32Array([1,0,1,1])],[fR(1,1,0,0),new Float32Array([1,1,0,0])],[fR(1,1,0,1),new Float32Array([1,1,0,1])],[fR(1,1,1,0),new Float32Array([1,1,1,0])],[fR(1,1,1,1),new Float32Array([1,1,1,1])]]);function pR(e,t,n){return e+(t-e)*n}function fR(e,t,n,i){let r=pR(e,t,.75),s=pR(n,i,.75);return pR(r,s,.875)}var mR=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(e){this.effect.blendMode.opacity.value=e},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(e){this.effect.blendMode.setBlendFunction(Number(e))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=BL.NORMAL}},gR=class extends mR{constructor(){super($L),this.blendFunction=BL.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},vR=class extends mR{constructor(){super(eR)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},yR=class extends mR{constructor(){super(nR),this.effect.offset=new di(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[1e3*this.effect.offset.x,1e3*this.effect.offset.y]}},bR=class extends mR{constructor(){super(tR)}},wR=class extends mR{constructor(){super(rR),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},xR=class extends mR{constructor(){super(sR),this.blendFunction=BL.OVERLAY}},ER=class extends mR{constructor(){super(dR)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},CR=class extends mR{constructor(e){super(iR)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?e/2e3:(e+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}setCamera(e){let t=!1;(e.isPerspectiveCamera&&!1===this.isPerspectiveCamera||!e.isPerspectiveCamera&&!0===this.isPerspectiveCamera)&&(t=!0),e.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e),this.isPerspectiveCamera=!1),t&&this.effect.setChanged()}},AR=class extends mR{constructor(){super(aR)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},SR=class extends Bs{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new bu(null)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}",fragmentShader:"#define GLSLIFY 1\nlayout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}"})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},_R=class extends _L{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new SR,this.resolutionVector=new di,this.resolveMaterial=new Bs({name:"TAAResolveMaterial",uniforms:{inputBuffer:new bu(null),historyBuffer:new bu(null),velocityBuffer:new bu(null),depthBuffer:new bu(null),resolution:new bu(new di)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}",fragmentShader:"#define GLSLIFY 1\n#include <common>\nvarying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;\n#define USE_YCOCG\n#define USE_CATMULL_ROM\nconst float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){\n#ifdef USE_YCOCG\nvec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);\n#else\nreturn texture(tex,uv);\n#endif\n}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){\n#ifdef CHOOSE_LONGEST_MOTION_VECTOR\nfloat longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;\n#else\nfloat closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;\n#endif\n}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);\n#ifdef USE_CATMULL_ROM\nvec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);\n#else\nvec4 previousColor=sample_color(historyBuffer,previousPixelPos);\n#endif\n#ifdef USE_YCOCG\npreviousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);\n#endif\nvec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);\n#ifdef USE_YCOCG\nvec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;\n#endif\nvec4 previousColorClipped=clamp(previousColor,cmin,cmax);\n#ifdef LUMINANCE_DIFFERENCES\n#ifdef USE_YCOCG\nfloat lum0=currentColor.r;float lum1=previousColorClipped.r;\n#else\nfloat lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);\n#endif\nfloat unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));\n#else\nconst float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);\n#endif\n#ifdef USE_YCOCG\ngl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);\n#else\ngl_FragColor=result;\n#endif\n}"}),this.historyRenderTarget=new Bi(1024,1024,{minFilter:gn,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Bi(1024,1024,{minFilter:gn,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let n=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(n),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},TR=class extends _L{constructor(e,t,n){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new kL(e,t,{renderTarget:n.transmissionDepthTarget}),this.passThroughMaterial=new SR,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new SR,this.depthPass=new kL(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,n){let i=this.camera.layers.mask,r=e;r.setRenderTarget(r.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],r.clear(),r.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,n),r.shadowMap.needsUpdate=!1,r.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=i}},PR=new Ol,MR=new Bs({transparent:!0,vertexShader:"\n        void main() {\n            gl_Position = vec4(0.0);\n        }\n    ",fragmentShader:"\n        layout(location = 1) out vec4 gVelocity;\n\n        void main() {\n            gl_FragColor = vec4(0.0);\n\t\t\tgVelocity = vec4(0.0);\n        }\n    "}),NR=class extends _L{constructor(e,t,n){super("OpaquePass",t??PR,n),this.MRTCompatible=!0,this.originalMaterials=[],this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??PR}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.length=0,this.scene.traverse((e=>{e.layers.isEnabled(3)&&e instanceof $P&&(this.originalMaterials.push([e,e.material]),e.material=MR)})),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let n=this.renderToScreen?null:t;e.setRenderTarget(n),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((e=>{e[0].material=e[1]}))}},IR=class{constructor(e){let{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:r=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.renderer=e,this.helperStartIndex=0,this.copyPass=new TL,this.depthTexture=null,this.timer=new ZL,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,n,r,i,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,n,r,i,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,n,r,i,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,null!==e){let t=e.getSize(new di),n=e.getContext().getContextAttributes()?.alpha??!1,i=this.inputBuffer.texture[0].type;i===bn&&e.outputEncoding===Hn&&(this.inputBuffer.texture[0].encoding=Hn,this.outputBuffer.texture[0].encoding=Hn,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(t.width,t.height,!1);for(let r of this.passes)r.initialize(e,n,i)}}replaceRenderer(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(e),t&&null!==i&&(i.removeChild(n.domElement),i.appendChild(e.domElement)),n}createDepthTexture(){let e=this.depthTexture=new _l(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.stencilBuffer?(e.format=_n,e.type=Cn):e.type=wn,e}deleteDepthTexture(){if(null!==this.depthTexture){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,n,i,r,s){let a,o=this.renderer,l=null===o?new di:o.getDrawingBufferSize(new di),c={minFilter:gn,magFilter:gn,wrapS:un,wrapT:un,stencilBuffer:t,depthBuffer:e};return i>0?(a=new Bi(l.width,l.height,c),a.samples=i):(r?(a=new zi(l.width,l.height,2,c),a.texture[1].type=En):a=new Bi(l.width,l.height,c),a.depthTexture=new _l(2048,2048),a.depthTexture.type=xn),n===bn&&null!==o&&o.outputEncoding===Hn&&(Array.isArray(a.texture)?a.texture.forEach((e=>e.encoding=Hn)):a.texture.encoding=Hn),Array.isArray(a.texture)?a.texture.forEach(((e,t)=>{e.name=`EffectComposer.Buffer ${r} ${t}`,e.generateMipmaps=!1})):(a.texture.name=`EffectComposer.Buffer ${r}`,a.texture.generateMipmaps=!1),a.name=s,a}addPass(e,t){let n,i=this.passes,r=this.renderer,s=r.getDrawingBufferSize(new di),a=r.getContext().getContextAttributes()?.alpha??!1;if(e.MRTCompatible&&(n=this.inputBuffer.texture[0].type),e.MRTCompatible||(n=this.inputBuffer.texture.type),e.setRenderer(r),e.setSize(s.width,s.height),e.initialize(r,a,n),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),void 0!==t?i.splice(t,0,e):i.push(e),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),e.needsDepthTexture||null!==this.depthTexture)if(null===this.depthTexture){let t=this.createDepthTexture();for(e of i)e.setDepthTexture(t)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,n=t.indexOf(e);if(-1!==n&&t.splice(n,1).length>0){if(null!==this.depthTexture){let n=(e,t)=>e||t.needsDepthTexture;t.reduce(n,!1)||e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null)}this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t,n,i,r,s=this.renderer,a=this.copyPass,o=this.inputBuffer,l=this.outputBuffer,c=this.inputBufferSingle,h=this.outputBufferSingle,u=!1;void 0===e&&(e=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(s,o,l,e,u):d.render(s,c,h,e,u),d.needsSwap&&(u&&(a.renderToScreen=d.renderToScreen,t=s.getContext(),n=s.state.buffers.stencil,n.setFunc(t.NOTEQUAL,1,4294967295),a.render(s,o,l,e,u),n.setFunc(t.EQUAL,1,4294967295)),i=o,r=c,o=l,c=h,l=i,h=r),d instanceof YL?u=!0:d instanceof PL&&(u=!1))}setSize(e,t,n){let i=this.renderer;if(this._width=e,this._height=t,void 0===e||void 0===t){let n=i.getSize(new di);e=n.width,t=n.height}i.setSize(e,t,n);let r=i.getDrawingBufferSize(new di);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height),this.inputBufferSingle.setSize(r.width,r.height),this.outputBufferSingle.setSize(r.width,r.height);for(let s of this.passes)s.setSize(r.width,r.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],null!==this.inputBuffer&&this.inputBuffer.dispose(),null!==this.outputBuffer&&this.outputBuffer.dispose(),null!==this.inputBufferSingle&&this.inputBufferSingle.dispose(),null!==this.outputBufferSingle&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},OR=new Bs({name:"CombineMaterial",uniforms:{inputBufferA:new bu(null),inputBufferB:new bu(null)},blending:0,depthWrite:!1,depthTest:!1,vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    gl_Position = vec4(position.xy, 1.0, 1.0);\n    vUv = position.xy * 0.5 + 0.5;\n}\n",fragmentShader:"\n    varying vec2 vUv;\n    uniform sampler2D inputBufferA;\n    uniform sampler2D inputBufferB;\n\n    // TODO: Why do we need these when postpro of framemode is enabled???\n    layout(location = 1) out vec4 gVelocity;\n\n    void main() {\n\tvec4 resA = texture2D(inputBufferA, vUv);\n\tvec4 resB = texture2D(inputBufferB, vUv);\n    float a = resA.a + resB.a * ( 1.0 - resA.a );\n\n\tvec4 res;\n\tres.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));\n\tres.a = resA.a + resB.a * (1.0 - resA.a);\n\tgl_FragColor = res;\n    gVelocity = vec4(0.0);\n    }\n"}),DR=class extends _L{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=OR,this.helperPass=new NR(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new NR(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new hR({preset:cR.LOW,edgeDetectionMode:pL.COLOR});this.effectPass=new WL(this.camera,t),this.rt=new Bi(10,10,{minFilter:gn,magFilter:gn,wrapS:un,wrapT:un,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,n){super.initialize(e,t,n),this.effectPass.initialize(e,t,n)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,n){this.rt.depthTexture=t.depthTexture;let i=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,n),this.fullscreenMaterial.uniforms.inputBufferA.value=n.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(i),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},LR=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],RR=new Bs({vertexShader:"#define GLSLIFY 1\n#include <skinning_pars_vertex>\n#include <morphtarget_pars_vertex>\nout vec3 n;void main(){\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\nvec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}",fragmentShader:"#define GLSLIFY 1\nin vec3 n;void main(){gl_FragColor=vec4(n,1.0);}"}),kR=new Bs({vertexShader:"#define GLSLIFY 1\nout vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}",fragmentShader:"#define GLSLIFY 1\nin vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){\n#ifdef DEBUG\nfloat d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);\n#else\nvec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;\n#endif\n}",uniforms:{texture_ao_lrez:new bu(null),texture_depth_lrez:new bu(null),texture_depth_hrez:new bu(null),near:new bu(null),far:new bu(null)}}),BR=class extends _L{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let n=1024,i=1024;this.gBuffer=new Bi(n,i,{type:kv?En:xn,depthTexture:new _l(n,i),minFilter:gn,magFilter:gn}),this.depthBufferHighRes=new Bi(n,i,{depthTexture:new _l(n,i)}),this.aoBuffer=new Bi(n,i,{minFilter:gn,magFilter:gn}),this.splineScene=e,this.splineCamera=t;let r=new Float32Array(2*LR.length);for(let a=0;a<LR.length;a++){let e=2*a;r[e+0]=LR[a][0],r[e+1]=LR[a][1]}this.blueNoiseInDiskTexture=new Bl(r,LR.length,1,Pn,xn),this.blueNoiseInDiskTexture.wrapS=hn,this.blueNoiseInDiskTexture.wrapT=hn,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new Bs({vertexShader:"#define GLSLIFY 1\nout vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}",fragmentShader:"#define GLSLIFY 1\nin vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}\n#define USE_GBUFFER_NORMALS\nvoid main(){vec3 view_space_p=get_view_position(v_uv);\n#ifdef USE_GBUFFER_NORMALS\nvec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;\n#else\nvec3 view_space_n=-rebuild_normal(v_uv,view_space_p);\n#endif\nfloat radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}",uniforms:{near:new bu(null),far:new bu(null),fov:new bu(null),proj_info:new bu(new ki),is_ortho:new bu(!1),resolution:new bu(new di),radius_of_influence:new bu(8),radius_in_screen_space:new bu(1),exponent:new bu(1),ao_color:new bu(new ji),bias:new bu(.5),texture_depth:new bu(null),texture_normals:new bu(null),texture_blue_noise:new bu(null),texture_blue_noise_in_disk:new bu(this.blueNoiseInDiskTexture),frame_index:new bu(0),fog_enabled:new bu(!1),fog_near:new bu(1),fog_far:new bu(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Bi(n,i,{minFilter:gn,magFilter:gn,wrapS:un,wrapT:un,depthBuffer:!1,type:xn});let s=new hR({preset:cR.ULTRA,edgeDetectionMode:pL.COLOR});this.effectPass=new WL(this.camera,s)}initialize(e,t,n){super.initialize(e,t,n),this.effectPass.initialize(e,t,n)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let n=this._runHalfRes?.5:1,i=e*n,r=t*n;this.gBuffer.setSize(i,r),this.aoBuffer.setSize(i,r),this.hbaoMaterial.uniforms.resolution.value.set(i,r),this.aaBuffer.setSize(i,r),this.effectPass.setSize(i,r)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}setDepthTexture(e){this.depthBufferHighRes.depthTexture=e,kR.uniforms.texture_depth_hrez.value=e,kR.needsUpdate=!0}render(e,t,n){this.splineScene.overrideMaterial=RR;let i=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=i,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let e=this.splineCamera.perspCamera.projectionMatrix.elements,t=2/e[0],n=2/e[5],i=-(1-e[8])/e[0],r=-(1+e[9])/e[5];this.hbaoMaterial.uniforms.proj_info.value.set(t,n,i,r);let s=this.splineCamera.perspCamera.fov*(Math.PI/180),a=this.hbaoMaterial.uniforms.resolution.value.y/(2*Math.tan(.5*s)),o=.5*this.hbaoMaterial.uniforms.radius_of_influence.value*a;this.hbaoMaterial.uniforms.radius_in_screen_space.value=o,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let e=this.splineCamera.orthoCamera.projectionMatrix.elements,t=2/e[0],n=2/e[5],i=-(1+e[12])/e[0],r=-(1-e[13])/e[5];this.hbaoMaterial.uniforms.proj_info.value.set(t,n,i,r);let s=this.hbaoMaterial.uniforms.resolution.value.y/n*.5,a=this.hbaoMaterial.uniforms.radius_of_influence.value*s;this.hbaoMaterial.uniforms.radius_in_screen_space.value=a,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=kR,kR.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,kR.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,kR.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},UR=class extends QL{constructor(){super(new Bs({vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D tInput;\nuniform sampler2D tMap;\nuniform vec2 resolution;\nvarying vec2 vUv;\n\nuniform vec2 uResolution;\nuniform vec2 uCoords;\n\n// Draws a rectangle at center <st> with size <size>\nfloat rectangle(vec2 st, vec2 size) {\n    size = vec2(0.5) - size * 0.5;\n    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));\n    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));\n\n    return uv.x * uv.y;\n}\n\nuniform vec2 uSize;\nuniform float uScale;\nuniform float uDPR;\nuniform float uCurrent;\nuniform vec3 uSceneColor;\n\nvoid main() {\n    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n    screenUv *= 1.0 / uDPR;\n\n    vec2 center = vec2(0.5, -0.5);\n    vec2 outsideUv = screenUv;\n    outsideUv += center;\n    outsideUv -= uCoords.xy / uResolution.xy;\n    outsideUv = (outsideUv - 0.5) + 0.5;\n    outsideUv -= center;\n    vec2 s = (uSize / uResolution) * uScale;\n    float isOutside = 1.0 - rectangle(outsideUv, s);\n    \n    vec2 mid = vec2(0.5);\n    vec2 insideUv = (screenUv - mid + s * mid) / s;\n    vec4 background = texture2D(tInput, screenUv);\n    vec4 image = texture2D(tMap, insideUv);\n    gl_FragColor = mix(image, background, isOutside);\n}\n",uniforms:{tInput:new bu(null),tMap:new bu(null),uResolution:new bu(new di),uSize:new bu(new di),uCoords:new bu(new di),uScale:new bu(1),uSceneColor:new bu(new Mi(16711680)),uDPR:new bu(1),uCurrent:new bu(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},zR=[],FR=class extends QL{constructor(){super(new Bs({vertexShader:"\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D toScene;\nuniform sampler2D fromScene;\nuniform vec2 resolution;\n\nuniform vec2 uResolution;\nuniform float uDPR;\n\nuniform float mixRatio;\nuniform sampler2D tMixTexture;\nuniform int useTexture;\nuniform float threshold;\n\nvoid main() {\n\tvec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n\tscreenUv *= 1.0 / uDPR;\n\n\tvec4 texel1 = texture2D( fromScene, screenUv );\n\tvec4 texel2 = texture2D( toScene, screenUv );\n\n\tif (useTexture==1) {\n\t\t\n\t\tvec4 transitionTexel = texture2D( tMixTexture, screenUv );\n\t\tfloat r = mixRatio * (1.0 + threshold * 2.0) - threshold;\n\t\tfloat mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);\n\t\t\n\t\tgl_FragColor = mix( texel1, texel2, mixf );\n\t} else {\n\t\t\n\t\tgl_FragColor = mix( texel1, texel2, mixRatio );\n\t\t\n\t}\n}\n",uniforms:{toScene:new bu(null),fromScene:new bu(null),uResolution:new bu(new di),uDPR:new bu(1),mixRatio:new bu(0),threshold:new bu(.1),useTexture:new bu(0),tMixTexture:{value:zR[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},jR=class extends QL{constructor(){super(new Bs({vertexShader:"\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D inputBuffer;\nuniform sampler2D blurredInputBuffer;\nuniform sampler2D overlay;\nuniform float blurIntensity;\n\nuniform vec2 uResolution;\nuniform float uDPR;\n\nvoid main() {\n\tvec2 screenUv = gl_FragCoord.xy / uResolution.xy;\n\tscreenUv *= 1.0 / uDPR;\n\n\tvec4 texel1 = texture2D( overlay, screenUv );\n\tvec4 texel2 = texture2D( inputBuffer, screenUv );\n\tvec4 texel3 = texture2D( blurredInputBuffer, screenUv );\n\n\tfloat blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;\n    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );\n}\n",uniforms:{inputBuffer:new bu(null),blurredInputBuffer:new bu(null),overlay:new bu(null),uResolution:new bu(new di),uDPR:new bu(1),blurIntensity:new bu(0)}})),this._blurEnabled=!1,this.blurTarget=new Bi(1,1,{minFilter:gn,magFilter:gn,wrapS:un,wrapT:un}),this.blurPass=new qL({width:window.innerWidth,height:window.innerHeight,kernelSize:JL.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.uniforms.uResolution.value.set(e,t),this.uniforms.uDPR.value=n,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let e=t.data.backgroundBlur,n=e.radius;this._blurEnabled=e.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=n/3}}render(e,t,n,i,r){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,i,r)),super.render(e,t,n,i,r)}},VR=class extends QL{constructor(){super(new Bs({vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D tInput;\nuniform sampler2D tOverlayImage;\nvarying vec2 vUv;\nuniform vec2 uResolution;\nuniform vec2 uRightBottom;\nuniform vec2 uImageSize;\nuniform float uScale;\nuniform float uDPR;\n\nvec3 blendNormal(vec3 base, vec3 blend) {\n\treturn blend;\n}\n\nvec3 blendNormal(vec3 base, vec3 blend, float opacity) {\n\treturn (blendNormal(base, blend) * opacity + base * (1.0 - opacity));\n}\n\nvec4 drawFixedSizeImage(sampler2D image, vec2 screenUV, vec2 imageSize, vec2 imageCoords, vec2 screenSize, float dpr) {\n\tvec2 uv = (screenUV * screenSize * dpr - imageCoords) / (imageSize * dpr);\n\tif (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\n\t\treturn vec4(0.0);\n\t}\n\treturn texture2D(image, uv);\n}\n\nvoid main() {\n    vec2 screenUV = gl_FragCoord.xy / (uResolution.xy * uDPR);\n\tvec2 imageCoords = vec2(uResolution.x * uDPR - uImageSize.x * uScale * uDPR - uRightBottom.x * uDPR, uRightBottom.y * uDPR);\n    vec4 background = texture2D(tInput, screenUV);\n    vec4 image = drawFixedSizeImage(tOverlayImage, screenUV, uImageSize * uScale, imageCoords, uResolution, uDPR);\n    gl_FragColor = vec4(blendNormal(background.rgb, image.rgb, image.a), max(background.a, image.a));\n}\n",uniforms:{tInput:new bu(null),tOverlayImage:new bu(null),uResolution:new bu(new di),uImageSize:new bu(new di),uRightBottom:new bu(new di(20,20)),uScale:new bu(.25),uDPR:new bu(1)}}),"tInput")}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tOverlayImage.value}set texture(e){this.uniforms.tOverlayImage.value=e,this.uniforms.uImageSize.value.set(e.image.width,e.image.height)}};function HR(e,t){return t&&t.enabled&&e.push(t.effect),e}var WR=e=>Object.values(BL).includes(e)?e:BL.NORMAL,GR=class extends Zn{constructor(e,t){super(),this._needsDOFResize=t,this.postprocessingState=Zx.defaultData,this._scene=new Ol,this._camera=new jD,this.effects=new Map,this.blueNoiseTexture=new Bl,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new nu,this.renderer=e,this.debug=!1,this.effects.set("bloom",new gR),this.effects.set("chromaticAberration",new yR),this.effects.set("vignette",new ER),this.effects.set("noise",new xR),this.effects.set("colorAverage",new bR),this.effects.set("hueSaturation",new wR),this.effects.set("brightnessContrast",new vR),this.effects.set("depthOfField",new CR),this.effects.set("pixelation",new AR),this.effectComposer=new IR(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new NR(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new TR(this.scene,this.camera,this.renderer),this.aoPass=new BR(this.scene,this.camera),this.taaPass=new _R,this.taaPass.renderToScreen=!1,this.helperPass=new DR(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new UR,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new jR,this.uiOverlayPass.enabled=!1,this.logoOverlayPass=new VR,this.logoOverlayPass.enabled=!1,this.sceneTransitionPass=new FR,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){void 0!==e?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){let t=this._camera!==e;this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),t&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(e),this.helperPass.setCamera(e),this.effects.get("depthOfField").setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let n=this.effectComposer.passes[t];!0!==n.enabled||e||!this._renderToScreen?n.renderToScreen=!1:(n.renderToScreen=!0,e=!0)}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new Bl(e,128,128),this.blueNoiseTexture.wrapS=hn,this.blueNoiseTexture.wrapT=hn,this.blueNoiseTexture.minFilter=pn,this.blueNoiseTexture.magFilter=pn,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,n,i,r,s,a,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=n,this.aoPass.aoColor=i,this.aoPass.fogEnabled=r,this.aoPass.fogNear=s,this.aoPass.fogFar=a,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){if(this.uvEffectPass?.dispose(),this.effectPass?.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let e=[this.effects.get("pixelation")].reduce(HR,[]);e.length>0&&(this.uvEffectPass=new WL(this.camera,...e),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let t=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(HR,[]);if(t.length>0&&(this.effectPass=new WL(this.camera,...t),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&this.effects.get("depthOfField")?.enabled&&void 0!==window)){let e=this.renderer.viewportWidth,t=this.renderer.viewportHeight;this.renderer.setSize(e-1,t-1),this.renderer.setSize(e,t)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass),this.effectComposer.addPass(this.logoOverlayPass)}_initCopyPass(){if(this._savePass)return;let e=new di;this.renderer.getDrawingBufferSize(e),this._rt=new Bi(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:hn,wrapT:hn}),this._rt.samples=0,this._savePass=new TL(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new TL(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(!0===e?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(null!==e?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}setWatermark(e){this.logoOverlayPass.enabled=null!==e,e&&(this.logoOverlayPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...n}=e,i=!1;t!==this.postprocessingState.enabled&&(i=!0);for(let r of Object.entries(n)){let e=r[1],t=this.effects.get(r[0]);if(t){t.enabled!==e.enabled&&(i=!0),t.enabled=e.enabled;for(let[n,i]of Object.entries(e))"blendFunction"===n?t.blendFunction=WR(i):t[n]=i}}this.postprocessingState=e,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,n,i){e instanceof ki?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,n,i),this.effectComposer.outputBuffer.scissor.set(e,t,n,i));let r=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(r),this.effectComposer.outputBuffer.scissor.multiplyScalar(r),this.renderer.setScissor(e,t,n,i)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,n,i){e instanceof ki?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,n,i),this.effectComposer.outputBuffer.viewport.set(e,t,n,i))}resize(e,t,n){if(this.effectComposer.setSize(e,t,n),this._rt){let n=this.renderer.getPixelRatio();this._rt.setSize(e*n,t*n)}}dispose(){this.uvEffectPass?.dispose(),this.effectPass?.dispose(),this.effectComposer.dispose()}},qR=ea.lights_fragment_begin,KR=ea.shadowmask_pars_fragment,YR=null,QR=new Bs({vertexShader:"\nattribute vec3 randomColor;\nvarying vec3 vNormal;\nflat out vec3 vColor;\n#include <skinning_pars_vertex>\n#include <morphtarget_pars_vertex>\n\t\nvoid main()\n{\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\nvec3 transformed = vec3(position);\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n\nvNormal = normal;\nvColor = randomColor;\ngl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));\n}\n",fragmentShader:"\nuniform float depthContrast;\nvarying vec3 vNormal;\nflat in vec3 vColor;\nvoid main()\n{\nvec3 normal = (normalize(vNormal)).rgb;\n\nfloat contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;\n\nvec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);\ngl_FragColor = vec4(resultColor, vColor.r);\ngl_FragColor = vec4(resultColor, vColor.r);\n}\n",uniforms:{depthContrast:{value:1}}}),XR=new Ri,ZR=new di,JR=class extends Nl{constructor(e){var t;super(e),t=this,this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new di,this.dummyCamera=new jD,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.getContext(),s=0;e&&(s|=r.COLOR_BUFFER_BIT),n&&(s|=r.DEPTH_BUFFER_BIT),i&&(s|=r.STENCIL_BUFFER_BIT),r.clear(s),r.clearBufferfv(r.COLOR,1,[0,0,0,1])},this.pipeline=new GR(this,e?.needsDOFResize??!1),this.autoClear=!1;let n=this.setPixelRatio.bind(this),i=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=1,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let r=this.getContext();if(r&&"drawingBufferColorSpace"in r)try{r.drawingBufferColorSpace="display-p3"}catch(Hw){console.warn(Hw)}this.setPixelRatio=e=>{this._pixelRatio!==e&&(this._pixelRatio=e,n(e))},this.setSize=function(e,n){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(t.viewportWidth!==e||t.viewportHeight!==n)&&(t.viewportWidth=e,t.viewportHeight=n,i(e,n,r),t.normalRenderTarget?.setSize(e*t._pixelRatio,n*t._pixelRatio),t._resizeTransmission(e,n),t.transmissionDepthTarget?.setSize(e*t._pixelRatio/2,n*t._pixelRatio/2),t.pipeline.resize(e,n,r))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){void 0===this.aoRenderTarget&&(this.aoRenderTarget=new Bi(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:gn,magFilter:gn,wrapS:un,wrapT:un,depthBuffer:!1}))}_resizeTransmission(e,t){this.transmissionRenderTarget?.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),this.aoRenderTarget?.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return 1===DN.transmissionLod.value}set hdTransmission(e){DN.transmissionLod.value=!0===e?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){void 0===this.transmissionRenderTarget&&(this.transmissionRenderTarget=new Bi(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:yn,magFilter:gn,wrapS:un,wrapT:un,depthBuffer:!1}),this.transmissionDepthTarget=new Bi(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:pn,magFilter:pn,depthBuffer:!1}))}createNormalRenderTarget(){void 0===this.normalRenderTarget&&(this.normalRenderTarget=new Bi(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:pn,magFilter:pn,type:xn,depthTexture:new _l(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,n){this.normalRenderTarget&&(this.setClearColor(0),n.layers.enable(8),n.layers.disable(0),n.layers.disable(3),t.traverseEntity((e=>{e.layers.isEnabled(8)&&(e.copyPreviousMatrix=!1)})),this.setRenderTarget(this.normalRenderTarget),this.clear(),QR.uniforms.depthContrast.value=n instanceof jD?(n.far-n.near)/1e4:1,t.overrideMaterial=QR,this.render(t,n),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?EU:null,n.layers.enable(0),n.layers.enable(3),t.traverseEntity((e=>{e.layers.isEnabled(8)&&(e.copyPreviousMatrix=!0)})))}renderSplineSceneWithDummyCamera(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let i=t.height,r=t.width,s=this.viewportWidth/this.viewportHeight;r<i?r=i*s:i=r/s,this.dummyCamera.setViewplaneSize(r,i);for(let a=0;a<n;a++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t){let{sceneHelpers:n=this.sceneHelpers,sceneHelpersOnTop:i=this.sceneHelpersOnTop,overrideTransmission:r,overrideNormal:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=e instanceof AU?e.activePage:e,o=a.visible;a.visible=!0;let l=a.scene;this.xr.enabled&&(!1===this.isXRCopyPassSet&&null!==this.getRenderTarget()&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(a.bgColor,a.bgColor.a),a.penumbraSizeArray.forEach(((e,t)=>{DN.penumbraSize.value[t]=e})),DN.pixelRatioNode.value=this.getPixelRatio(),0!==this.resolution.x&&0!==this.resolution.y?DN.resolution.value.set(this.resolution.x,this.resolution.y):DN.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),void 0!==s?(DN.normalRenderTarget.value=s,DN.normalRenderTargetDepth.value=XR):l.needsNormal()&&(this.createNormalRenderTarget(),DN.normalRenderTarget.value=this.normalRenderTarget.texture,DN.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,a,t));let c=a.data.ao,h=c.occlusion;if(h&&(this.createAORenderTarget(),DN.aoRenderTarget.value=this.aoRenderTarget.texture),DN.aoEnabled.value=h,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,a.aoColor,null!==a.fog,a.backupFog.near,a.backupFog.far,c.aoFullRes&&!kv),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&a.uiCanvas?.enabled&&a.uiCanvas.texture&&a.uiCanvas.texture.image.width>0){let e=this.getSize(ZR),t=this.getPixelRatio();(a.uiCanvas.width!==this.viewportWidth||a.uiCanvas.height!==this.viewportHeight||a.uiCanvas.dpr!==t)&&a.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},t),a.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=a.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(e.x,e.y,t),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();if(this.pipeline.logoOverlayPass.enabled){let e=this.getSize(ZR),t=this.getPixelRatio();this.pipeline.logoOverlayPass.uniforms.uResolution.value.set(e.x,e.y),this.pipeline.logoOverlayPass.uniforms.uDPR.value=t}let u=!1;if(void 0!==r)DN.transmissionRenderTarget.value=r,DN.transmissionRenderTargetDepth.value=XR,this.pipeline.setTransmissionPassEnabled(!1);else{let e=l.needsTransmission();e&&(void 0===this.transmissionRenderTarget&&(u=!0),this.createTransmissionRenderTarget(),DN.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,DN.aspectRatio.value=function(e,t){return e>=t?new di(t/e,1):new di(1,e/t)}(this.viewportWidth,this.viewportHeight),DN.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(e)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=n,this.pipeline.sceneHelpersOnTop=i,this.pipeline.scene=a,this.pipeline.camera=t,u&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==a.postprocessing&&(this.pipeline.updatePostprocessing(a.postprocessing),!n&&!i&&this.pipeline.disableHelpers()),void 0!==this.clearAlphaOverride&&this.setClearAlpha(this.clearAlphaOverride),l.shapeBlendIntances.forEach((e=>{e.onBeforeShadowPass(this)})),a.overrideMaterial=l.wireframeState?EU:null,this.pipeline.render(),DN.frameIndex.value=(DN.frameIndex.value+1)%16,t instanceof jD&&t.copyHistory(),a.visible=o}renderFromSceneForSceneTransitionPass(e,t,n){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=n,this.sceneTransitionTimeRemaining=n,this.pipeline.renderToScreen=!0;let i=this.pipeline.sceneTransitionPass.uniforms;i.uDPR.value=window.devicePixelRatio,i.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){this._superDispose(),this.pipeline.dispose(),this.aoRenderTarget?.dispose(),this.transmissionRenderTarget?.dispose(),this.transmissionDepthTarget?.dispose(),this.normalRenderTarget?.dispose(),this.normalRenderTarget?.depthTexture?.dispose()}},$R=class extends(CD(Ru)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,arguments.length>2&&void 0!==arguments[2]?arguments[2]:10066329),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){TD(this.object,$R.geometryHelper,e,t)}},ek=class extends(CD(Iu)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,arguments.length>2&&void 0!==arguments[2]?arguments[2]:6710886),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){TD(this.object,ek.geometryHelper,e,t)}},tk=class extends(CD(Nu)){constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:6710886),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){TD(this.object,tk.geometryHelper,e,t)}update(){if(void 0!==this.object){let e=tk._vector,t=this.object.distance?this.object.distance:1e3,n=t*Math.tan(this.object.angle);this.cone.scale.set(n,n,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let i=void 0!==this.color?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,s=this.cone.material.length;r<s;r++)this.cone.material[r].color.set(i);else this.cone.material.color.set(i)}}},nk=tk;nk._vector=new ji;var ik=class extends Cl{constructor(){super(),this.caretIndex=0,this._caretVisibleAlpha=1,this._selectionVisibleAlpha=.3,this.current={start:0,end:void 0},this.matrixAutoUpdate=!1,this.caretMesh=new Ns(new $s(1,1),new ns({transparent:!0,opacity:0,side:2})),this.add(this.caretMesh),this.selectionMesh=new Ns(new $s(1,1),new ns({color:2857471,transparent:!0,depthTest:!1,depthWrite:!1,opacity:0,side:2})),this.add(this.selectionMesh),this.hide()}get caretHeight(){return this.object?.AD??0}show(e){this.visible=!0,this.object=e,this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.y=.5*-this.caretHeight,this.setCaretPosition(this.caretIndex),this.update()}hide(){this.visible=!1}update(){if(void 0===this.object)return;this.updateHelperMatrix();let{depth:e}=this.object.geometry.userData.parameters;this.caretMesh.position.z=e,this.selectionMesh.position.z=e}updateHelperMatrix(){if(void 0===this.object)return;let e=this.object,t=e.parent;null!==t&&t.updateWorldMatrix(!0,!1),e.matrixAutoUpdate&&e.updateMatrix(),null!==t?(this.matrixWorld.multiplyMatrices(t.matrixWorld,e.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,e.matrix)):this.matrixWorld.multiplyMatrices(e.hiddenMatrix,e.matrix),this.matrix.copy(this.matrixWorld);for(let n of this.children)n.matrixWorld.copy(this.matrixWorld);e.updateWorldMatrix(!0,!0)}setCaretColor(e){let t=this.caretMesh.material;t.color.setRGB(e.r,e.g,e.b);let n=this._caretVisibleAlpha===t.opacity;this._caretVisibleAlpha=e.a,n&&(t.opacity=this._caretVisibleAlpha)}setSelectionColor(e){this.selectionMesh.material.color.setRGB(e.r,e.g,e.b)}setCaretPosition(e){if(void 0===this.object)return;this.caretIndex=e;let t=this.object.wrappedText,[n,i]=sk(t,e),[r,s]=e>0?sk(t,e-1):[null,null];"\n"===(e>0&&t.length?t[r].charAt(s):null)&&(n++,i=0),this.current.start=e,this.current.end=void 0;let[a,o]=rk(this.object,n,i),{AD:l,descender:c}=this.object,h=c+.5*l,{width:u,height:d,depth:p}=this.object.geometry.userData.parameters,f="string"==typeof u?0:u,m="string"==typeof d?0:d;this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.set(a-.5*f,o+h+.5*m,p),this.hideSelectionMesh(),this.showCaretMesh()}setSelection(e,t){if(void 0===this.object)return;let n=this.object.wrappedText;this.current.start=e,this.current.end=t;let i=[],r=[],s=function(e,t,n){let[i,r]=sk(e,t),[s,a]=sk(e,n),o=[];r>=e[i].length&&(i++,r=0);for(let l=i;l<=s;l++){let t=e[l],n=l===i?r:0,c=l===s?a:t.length;o.push([l,n,c])}return o}(n,e,t),{lineHeight:a,AD:o,descender:l}=this.object,c=l+.5*o-.5*a;for(let[g,v,y]of s)if(v!==y){let[e,t]=rk(this.object,g,v),[n,s]=rk(this.object,g,y);t+=c,s+=c,s+=a;let o=i.length/3;i.push(e,t,0),i.push(n,t,0),i.push(n,s,0),i.push(e,s,0),r.push(o+0,o+1,o+2),r.push(o+2,o+3,o+0)}let h=new gs;h.setIndex(r),h.setAttribute("position",new ls(i,3));let{width:u,height:d,depth:p}=this.object.geometry.userData.parameters,f="string"==typeof u?0:u,m="string"==typeof d?0:d;this.selectionMesh.geometry.dispose(),this.selectionMesh.geometry=h,this.selectionMesh.position.x=.5*-f,this.selectionMesh.position.y=.5*m,this.selectionMesh.position.z=p,this.showSelectionMesh(),this.hideCaretMesh()}getSelectionFromPosition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"previous";if(void 0===this.object||void 0===this.object.font)return;let i=this.object.wrappedText,r=i.length,s=this.object.lineHeight,a=r*s,{height:o,verticalAlign:l}=this.object.geometry.userData.parameters,c="string"==typeof o?0:o,h=0;3===l?h=c-a:2===l&&(h=.5*c-.5*a);let u=Math.min(Math.floor(Math.max(Math.min(-t-h,a),0)/s),r-1),d=this.object.charCoords[u],p=this.object.charWidths[u],f=0,m=!1;if("previous"===n){for(let g=0;g<d.length;g++)if(d[g][0]+.5*p[g]-e>0){f=g,m=!0;break}}else if("closest"===n){let t=1/0;for(let n=0;n<d.length;n++){let i=d[n][0]+.5*p[n],r=Math.abs(i-e);r<t&&(t=r,f=n,m=!0)}}else for(let g=0;g<d.length;g++){let t=d[g][0],n=d[g][0]+p[g];if(e>=t&&e<n){f=g,m=!0;break}}return m||(f=d.length),{index:this.getGlobalIndexFromLineAndCharIndexes(i,u,f),lineIndex:u,characterIndex:f}}getGlobalIndexFromLineAndCharIndexes(e,t,n){return e.slice(0,t).reduce(((e,t)=>e+t.length),0)+n}showSelectionMesh(){this.selectionMesh.material.opacity=this._selectionVisibleAlpha}hideSelectionMesh(){this.selectionMesh.material.opacity=0}showCaretMesh(){this.caretMesh.material.opacity=this._caretVisibleAlpha}hideCaretMesh(){this.caretMesh.material.opacity=0}};function rk(e,t,n){let{charCoords:i,charWidths:r,initialOffsetY:s,lineHeight:a}=e;if(i[t]&&0===i[t].length||0===i.length){let n=0,{horizontalAlign:i}=e.data.geometry,r=e.wrappedText,{width:o}=e.geometry.userData.parameters;return 1===r.length&&0===r[0].length&&(3===i?n=.5*o:2===i&&(n=o)),[n,s-a*t]}let o=i[t];if(void 0===o||0===o.length)return[0,0];let[l,c]=o[Math.min(n,o.length-1)];return n>=o.length&&(l+=r[t][n-1]),[l,c]}function sk(e,t){let n=0;for(let i=0;i<e.length;i++){let r=e[i],s=t-n;if(s<=r.length)return[i,s];n+=r.length}return[Math.max(0,e.length-1),e[e.length-1]?.length??0]}function ak(e,t){return"string"==typeof e?t.data.colors[e]:e}function ok(e){return e.colors[0]}var lk,ck=class extends(KD($h,$R)){constructor(e,t,n){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let r=new Uu(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof Uu&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let n=void 0!==e.depth&&e.depth!==this.shadow.camera.far||void 0!==e.size&&e.size/2!==this.shadow.camera.right;void 0!==e.size&&function(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}(this,e.size),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),void 0!==e.penumbraSize&&t.scene.markPenumbraSizeDirty(),n&&this.update()}},hk=new ji,uk=new ji,dk=new Fi,pk=class extends(KD(qh,nk)){constructor(e,t,n){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=2*ui.RAD2DEG*this.angle,i.aspect=1,i.near=100,i.far=2500;let r=new Uu(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof Uu&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),uk.setFromMatrixPosition(this.matrixWorld),dk.setFromRotationMatrix(this.matrixWorld),hk.copy(this.up).applyQuaternion(dk).negate().multiplyScalar(this.distance),this.target.position.copy(uk).add(hk),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),void 0!==e.distance&&(this.distance=e.distance),void 0!==e.decay&&(this.decay=e.decay),void 0!==e.angle&&(this.angle=e.angle),void 0!==e.penumbra&&(this.penumbra=e.penumbra),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.penumbraSize&&t.scene.markPenumbraSizeDirty(),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function fk(e,t){return[[e[0][0]*t[0][0]+e[0][1]*t[1][0],e[0][0]*t[0][1]+e[0][1]*t[1][1]],[e[1][0]*t[0][0]+e[1][1]*t[1][0],e[1][0]*t[0][1]+e[1][1]*t[1][1]]]}function mk(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]}function gk(e){let[t,n,i]=function(e){let t=(e[0][0]+e[1][1])/2,n=(e[0][0]-e[1][1])/2,i=(e[1][0]+e[0][1])/2,r=(e[1][0]-e[0][1])/2,s=Math.sqrt(t*t+r*r),a=Math.sqrt(n*n+i*i),o=s+a,l=s-a,c=Math.atan2(i,n),h=Math.atan2(r,t),u=(h-c)/2,d=(h+c)/2,p=[[Math.cos(d),Math.sin(d)],[-Math.sin(d),Math.cos(d)]],f=[[o,0],[0,l]],m=[[Math.cos(u),Math.sin(u)],[-Math.sin(u),Math.cos(u)]];return p[0][0]*=-1,p[0][1]*=-1,m[0][0]*=-1,m[1][0]*=-1,[p,f,m]}(e),r=fk(t,mk(i)),s=fk(fk(i,n),mk(i));return{rotation:Math.atan2(r[1][0],r[0][0]),scale:[s[0][0],s[1][1]],shear:[s[0][1]/s[1][1],s[1][0]/s[0][0]]}}(e=>{function t(e){return[e[0],e[3],e[1],e[4],e[2],e[5]]}e.identity=function(){return[1,0,0,0,1,0,0,0,1]},e.copy=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.identity();for(let e=0,i=t.length;e<i;e++)n[e]=t[e];return n},e.create=function(t,n,i,r,s,a){return e.setAbcdef(e.identity(),t,n,i,r,s,a)},e.setAbcdef=function(e,t,n,i,r,s,a){return e[0]=t,e[1]=i,e[2]=s,e[3]=n,e[4]=r,e[5]=a,e},e.append=function(n,i){let[r,s,a,o,l,c]=t(n),[h,u,d,p,f,m]=t(i),g=h*r+u*a,v=h*s+u*o,y=d*r+p*a,b=d*s+p*o,w=f*r+m*a+l,x=f*s+m*o+c;return e.create(g,v,y,b,w,x)},e.prepend=function(n,i){let[r,s,a,o,l,c]=t(n),[h,u,d,p,f,m]=t(i),g=r,v=s,y=a,b=o;(1!==h||0!==u||0!==d||1!==p)&&(g=r*h+s*d,v=r*u+s*p,y=a*h+o*d,b=a*u+o*p);let w=l*h+c*d+f,x=l*u+c*p+m;return e.create(g,v,y,b,w,x)},e.getAbcdef=t,e.invert=function(t){let[n,i,r,s,a,o]=e.getAbcdef(t),l=n*s-i*r,c=s/l,h=-i/l,u=-r/l,d=n/l,p=(r*o-s*a)/l,f=-(n*o-i*a)/l;return e.create(c,h,u,d,p,f)},e.apply=function(t,n){let[i,r]=t,[s,a,o,l,c,h]=e.getAbcdef(n);return[s*i+o*r+c,a*i+l*r+h]},e.applyInverse=function(t,n){let[i,r,s,a,o,l]=e.getAbcdef(n),c=1/(i*a+s*-r),[h,u]=t;return[a*c*h+-s*c*u+(l*s-o*a)*c,i*c*u+-r*c*h+(-l*i+o*r)*c]},e.scale=function(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,[r,s,a,o,l,c]=e.getAbcdef(t);return e.setAbcdef(t,r*n,s*i,a*n,o*i,l*n,c*i),t},e.rotate=function(t,n){let i=Math.cos(n),r=Math.sin(n),[s,a,o,l,c,h]=e.getAbcdef(t);return e.setAbcdef(t,s*i-a*r,s*r+a*i,o*i-l*r,o*r+l*i,c*i-h*r,c*r+h*i),t},e.rotateAround=function(t,n,i){let[r,s]=i,a=e.translate(t,-r,-s);return a=e.rotate(a,n),a=e.translate(a,r,s),a},e.translate=function(t,n,i){let[r,s,a,o,l,c]=e.getAbcdef(t);return e.setAbcdef(t,r,s,a,o,l+n,c+i),t},e.setTranslate=function(t,n,i){let[r,s,a,o]=e.getAbcdef(t);return e.setAbcdef(t,r,s,a,o,n,i),t},e.setPosition=function(t,n,i){let[r,s,a,o]=e.getAbcdef(t);return e.setAbcdef(t,r,s,a,o,n,i),t},e.getScale=function(t){let[n,i,r,s]=e.getAbcdef(t);return[Math.sqrt(n*n+i*i),Math.sqrt(r*r+s*s)]},e.getPosition=function(t){let[,,,,n,i]=e.getAbcdef(t);return[n,i]},e.getRotation=function(t,n){return e.decompose(t,n).rotation},e.decompose=function(t,n){let[i,r,s,a,o,l]=e.getAbcdef(t),{rotation:c,scale:h,shear:u}=gk([[i,s],[r,a]]);return{position:[o+(n[0]*i+n[1]*s)-n[0],l+(n[0]*r+n[1]*a)-n[1]],scale:h,rotation:c,shear:u,pivot:n}},e.compose=function(t,n,i,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],[a,o]=t,[l,c]=r,[h,u,d,p]=function(e){let{rotation:t,scale:n,shear:i}=e,r=Math.cos(t),s=Math.sin(t),a=fk([[r,-s],[s,r]],[[n[0],i[0]*n[1]],[i[1]*n[0],n[1]]]);return[a[0][0],a[1][0],a[0][1],a[1][1]]}({rotation:i,scale:n,shear:s}),f=a-(l*h+c*d)+l,m=o-(l*u+c*p)+c;return e.create(h,u,d,p,f,m)}})(lk||(lk={}));var vk=Math.PI/180;Math.PI;var yk=class{constructor(e,t,n){this.uuid=e,this.data=t,this.localMatrix=lk.identity(),this.worldMatrix=lk.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new Pk,this._recursiveBBox=new Pk,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=WT(),this.dpr=n.dpr??1,this.dataPatched=t}project(e,t){let n=this.worldMatrix;return t&&(n=lk.append(t.worldMatrix,n)),lk.applyInverse(e,n)}intersects(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],n),i)}intersectsInLocalSpace(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{min:i,max:r}=n?this.recursiveBBox:this.singleBBox;return e>=i[0]&&e<=r[0]&&t>=i[1]&&t<=r[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=lk.compose(this.position,this.scale,function(e){return e*vk}(this.rotation),wC.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(e,t,n){let i=this.parent;t&&null!==i&&void 0!==i&&i.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=lk.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=lk.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return wC.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors((e=>{e.resetBBoxNeedsUpdateSelf()}))}updateTransformState(e){let t=!1;void 0!==e.position&&(t=!0,this.position=e.position),void 0!==e.rotation&&(t=!0,this.rotation=e.rotation),void 0!==e.scale&&(t=!0,this.scale=e.scale),void 0!==e.shear&&(t=!0,this.shear=e.shear),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,n){0===e.type&&void 0!==e.props.visible&&(this.visible=e.props.visible),this.data=t,this.data=t;let i=e,r=Zy(e.path,["states","*"]);if(null!==r){if(0===e.type){let[t]=r;if(this?.stateSelection===t){let t={...e.props};if(delete t.name,Object.values(e.props).some((e=>void 0===e))){let n=this.data;if(void 0!==n){let i=Gy.zoom(n,e.path.slice(2));if(i)for(let n in e.props)void 0===e.props[n]&&n in i&&(t[n]=i[n])}}i={...e,props:t,path:e.path.slice(2)}}}}else if(0===e.type){let t=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(void 0!==t){if(void 0!==e.props.name&&t.name){let{name:e,...n}=t;t=n}let n=Gy.removeOverridden(e.path,e.props,t);i={...e,props:n}}}this.updateByPatchedOpBase(i,cC.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),n)}changeSelectedState(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==this.data.states.length||n){for(let e of this.data.states)cC.toOps(this.data,e.data).forEach((e=>{let n=xy.replaceProps(e,this.data);this.dataPatched=this.data,this.updateByPatchedOp(n,this.data,t)}));if(null!==e){let n=this.data.states.data(e);n&&(this.dataPatched=cC.patch(this.data,n),cC.toOps(this.data,n).forEach((e=>{this.updateByPatchedOp(e,this.dataPatched,t)})))}n&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){void 0!==e.name&&(this.name=e.name),void 0!==e.visible&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,n){this.dataPatched=t,this.updateByPatchedOp(e,t,n)}updateByPatchedOp(e,t,n){0===e.path.length&&0===e.type&&this.updateState(e.props,n),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors((t=>{"frame2d"===t.data.type&&e(t)}))}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors((e=>{e.requestRender()}))}clone(e){let t=new yk(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){this.emitter.emit(e.type,{...e,target:e.target??this})}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let n=t.indexOf(this)+1;return t[n]?t[n]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof yk&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},bk=class extends yk{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.context=n,this.children=[]}add(e){e.parent&&e.parent instanceof bk&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(!0!==t)for(let n of this.children)n instanceof bk?n.traverse(e):t=e(n)}intersectsChildrenHelper(e,t,n,i,r){for(let s of this.children)if(s.intersects(e,t,n,!1)&&(r.push(s),i)||s instanceof bk&&s.intersectsChildrenHelper(e,t,n,i,r))return!0;return!1}intersectsChildren(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.intersectsChildrenHelper(e,t,n,i,r),r}intersectsChildrenHelperReverse(e,t,n,i,r){for(let s of this.children)if(s instanceof bk&&s.intersectsChildrenHelperReverse(e,t,n,i,r)||s.intersects(e,t,n,!1)&&(r.push(s),i))return!0;return!1}intersectsChildrenReverse(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.intersectsChildrenHelperReverse(e,t,n,i,r),r}updateWorldMatrix(e,t,n){if(super.updateWorldMatrix(e,t,n),n&&this.children)for(let i of this.children)i.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse((n=>{n.uuid===e&&(t=n)})),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse((e=>{e.resetBBoxNeedsUpdateSelf()}))}clone(e){let t=new bk(this.uuid,this.data,e);t.parent=void 0;for(let n of this.children)t.add(n.clone(e));return t}},wk=class extends bk{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.updateState(t,n)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new wk(this.uuid,this.data,e);t.parent=void 0;for(let n of this.children)t.add(n.clone(e));return t}};function xk(e,t){let[[n,i],[r,s]]=e,[[a,o],[l,c]]=t,h=(n-r)*(o-c)-(i-s)*(a-l);if(0===h)return!1;let u=((n-a)*(o-c)-(i-o)*(a-l))/h,d=-((n-r)*(i-o)-(i-s)*(n-a))/h;return u>=0&&u<=1&&d>=0&&d<=1}var Ek,Ck,Ak,Sk,_k=[[-1,1],[-1,-1],[1,-1],[1,1]],Tk=(e,t,n)=>{let i=e.getCenter(),r=e.getHalfSize(),s=lk.append(t,e.worldMatrix);0===r[0]&&0===r[1]?n.push(lk.apply(i,s)):_k.forEach((e=>{let t=[e[0]*r[0]+i[0],e[1]*r[1]+i[1]];n.push(lk.apply(t,s))}))},Pk=class{constructor(){this.matrix=lk.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(),this.makeEmpty(),lk.copy(e.worldMatrix,this.matrix);let n=lk.invert(e.worldMatrix);this.expandByObjectSize(e,n,t)}expandByObjectSize(e,t){let n=[];!0===(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&e instanceof bk?e.traverse((e=>{e.visible&&Tk(e,t,n)})):Tk(e,t,n),this.setFromPoints(n)}setFromSize(e,t,n){this.makeEmpty(),lk.copy(n,this.matrix),this.expandBySize(e,t,n)}expandBySize(e,t,n){[lk.apply([0,0],n),lk.apply([0,t],n),lk.apply([e,t],n),lk.apply([e,0],n)].forEach((e=>this.expandByPoint(e)))}getCenter(){let[e,t]=this.min,[n,i]=this.getHalfSize();return lk.apply([e+n,t+i],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[.5*(this.max[0]-this.min[0]),.5*(this.max[1]-this.min[1])]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),n=this.getCenter(),[i,r,s,a]=lk.getAbcdef(this.matrix),o=lk.create(i,r,s,a,n[0],n[1]);this.vertices=_k.map((n=>{let[i,r]=n;return lk.apply([i*e,r*t],o)}))}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let n=this.matrix;return t&&(n=lk.append(t.worldMatrix,n)),lk.applyInverse(e,n)}intersects(e,t,n){return this.intersectsInLocalSpace(...this.project([e,t],n))}intersectsInLocalSpace(e,t){let{min:n,max:i}=this;return e>=n[0]&&e<=i[0]&&t>=n[1]&&t<=i[1]}containsPoint(e){let[t,n]=e,[i,r]=this.min,[s,a]=this.max;return t>=i&&t<=s&&n>=r&&n<=a}intersectsBBox2D(e){for(let t=0,n=this.edges.length;t<n;t++){let n=this.edges[t];for(let t=0,i=e.edges.length;t<i;t++){if(xk(n,e.edges[t]))return!0}}for(let t=0,n=e.vertices.length;t<n;t++){let n=e.vertices[t];if(this.containsPoint(n))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],lk.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new Pk;return e.copy(this),e}},Mk=new Promise((e=>{Ek=e})),Nk=!1;function Ik(){if(!Nk)return Ck||(Ck=async function(){let e=await n.e(1160).then(n.bind(n,91160));Ek(e.default??e),Nk=!0}(),Ck)}function Ok(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{("Mesh"===n.type&&"UIGeometry"===n.geometry.type||"Page"===n.type&&void 0!==n.uiFrame)&&(t=!0)})),t}var Dk=lk.identity(),Lk=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.canvas=e,this._dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=sx.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=sx.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let n=e.getBoundingClientRect();e.width=n.width*t,e.height=n.height*t}catch{console.log(e.width,t)}this._currentM3Transform=Dk,this._currentTransform=new Float32Array(Dk)}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this._isSizeDirty=!0}async init(){if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await async function(e){let t=await Mk;Ak||(Sk||(Sk=t({locateFile:()=>e})),Ak=await Sk)}(this.wasmURL),this._surface=Ak.MakeWebGLCanvasSurface(this.canvas),this.ctx=this._surface?.getCanvas(),this._paint=new Ak.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(Ak.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(Ak.PaintStyle.Stroke),this.ctx?.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let n=await(await fetch(e)).arrayBuffer();this.registerFont(n,t)}registerFont(e,t){if(this._fonts.has(t))return;let n=Ak.FontMgr.FromData(e);if(!n)throw new Error("Invalid font data for "+t);this._fonts.set(t,n)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(kk(e),Ak.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(kk(e),Ak.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth("center"===this._strokeMode?e:2*e)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){this.ctx?.clear(Ak.TRANSPARENT)}save(){this.ctx?.save()}restore(){this.ctx?.restore()}beginPath(){this._currentPath?.delete(),this._currentPath=new Ak.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=Ak.XYWHRect(e,t,n,i);if(0===r&&0===s&&0===o&&0===a)this.ctx?.clipRect(l,Ak.ClipOp.Intersect,!0);else{let e=Ak.RRectXY(l,r,r);e[4]=e[5]=r,e[6]=e[7]=s,e[8]=e[9]=a,e[10]=e[11]=o,this.ctx?.clipRRect(e,Ak.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=lk.invert(this.currentTransform);this.ctx.concat(e);let t=lk.translate(lk.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.ctx&&this._currentPath){let i,r=!1;if(n&&this._hasDropShadow()){let n,i=e.copy();i.setColor(kk(this._dropShadowColor)),this._dropShadowBlur>0&&(n=Ak.MaskFilter.MakeBlur(Ak.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(this.camera?.scale??1),!1),i.setMaskFilter(n)),this.ctx.save(),this.ctx.clipPath(this._currentPath,Ak.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(i),this.ctx.restore(),i.delete(),n?.delete()}if(this._backgroundBlur>0&&n){this.ctx.save(),this.ctx.clipPath(this._currentPath,Ak.ClipOp.Intersect,!0);let t=Ak.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,Ak.TileMode.Clamp,null),n=e.copy();n.setImageFilter(t),n.setAlphaf(1);let i=this._currentPath.computeTightBounds();this.ctx.saveLayer(n,i,null,Ak.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),n.delete(),t.delete(),r=!0}if(this._layerBlur>0){let n=e.copy();i=Ak.MaskFilter.MakeBlur(Ak.BlurStyle.Normal,this._layerBlur*this.dpr*(this.camera?.scale??1),!1),n.setMaskFilter(i),t(n),n.delete(),i.delete(),r=!0}if(r||t(e),n&&this._hasInnerShadow()){let e,t=new Ak.Paint;t.setAntiAlias(!0),t.setStyle(Ak.PaintStyle.Fill),t.setColor(kk(this._innerShadowColor)),this._innerShadowBlur>0&&(e=Ak.MaskFilter.MakeBlur(Ak.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(this.camera?.scale??1),!1),t.setMaskFilter(e));let n=this._currentPath.computeTightBounds(),[i,r,s,a]=n,o=s-i,l=a-r;this.ctx.save(),this.ctx.clipPath(this._currentPath,Ak.ClipOp.Intersect,!0),this.ctx.saveLayer(t,n,null,Ak.SaveLayerInitWithPrevious),this.ctx?.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(Ak.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+o+Math.abs(2*this._innerShadowOffsetX),2e3+l+Math.abs(2*this._innerShadowOffsetY)),t),t.setBlendMode(Ak.BlendMode.Clear),this.ctx.drawPath(this._currentPath,t),this.ctx.restore(),this.ctx.restore(),t.delete(),e?.delete()}}}_paintInner(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.ctx&&this._currentPath&&e){let n=this.ctx,i=this._currentPath;this._applyEffectsToPaint(e,(e=>{let r=!1;!t&&"center"!==this._strokeMode&&(n.save(),n.clipPath(i,"outside"===this._strokeMode?Ak.ClipOp.Difference:Ak.ClipOp.Intersect,!0),r=!0),n.drawPath(i,e),r&&n.restore()}),t)}}_hasDropShadow(){return this._dropShadowColor?.a>0}_hasInnerShadow(){return this._innerShadowColor?.a>0}path(e){this._currentPath?.addPath(Ak.Path.MakeFromSVGString(e))}ellipse(e,t,n,i,r,s,a,o){if(!Rk([e,t,n,i])||!this._currentPath)return;if(n<0||i<0)throw Error("radii cannot be negative");let l=Ak.XYWHRect(e-n,t-i,2*n,2*i);this._currentPath?.addOval(l)}rect(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=Ak.XYWHRect(e,t,n,i);if(Rk(l))if(0===r&&0===s&&0===o&&0===a)this._currentPath?.addRect(l);else{let e=Ak.RRectXY(l,r,r);e[4]=e[5]=r,e[6]=e[7]=s,e[8]=e[9]=a,e[10]=e[11]=o,this._currentPath?.addRRect(e)}}getHorizontalAlign(e){switch(e){case 2:return Ak.TextAlign.Right;case 3:return Ak.TextAlign.Center;case 4:return Ak.TextAlign.Justify;default:return Ak.TextAlign.Left}}drawTextInner(e,t,n,i,r,s){let[a,o,l,c]=i,h=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=0,{ctx:d}=this;if(!d)return u;let p=s.copy(),f=s.copy();return f.setAlphaf(0),this._applyEffectsToPaint(p,(i=>{t.pushPaintStyle(n,i,f),t.addText(e);let s=t.build();s.layout(l);let h=o;2===r?h+=(c-s.getHeight())/2:3===r&&(h+=c-s.getHeight()),d.drawParagraph(s,a,h),u=s.getHeight(),t.reset(),s.delete()}),h),p.delete(),f.delete(),u}drawText(e,t){let n=0,i=this._fonts.get(t.font),{ctx:r,_paintFill:s,_paintStroke:a}=this;if(i&&r){let r=new Ak.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),o=new Ak.ParagraphStyle({textStyle:r,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),l=Ak.XYWHRect(t.x,t.y,t.width,t.height),c=Ak.ParagraphBuilder.Make(o,i);s&&(n=this.drawTextInner(e,c,r,l,t.verticalAlign,s,!0)),a&&(n=this.drawTextInner(e,c,r,l,t.verticalAlign,a,!1)),c.delete()}return{height:n}}render(){this._surface?.flush()}moveTo(e,t){this._currentPath?.moveTo(e,t)}lineTo(e,t){this._currentPath?.lineTo(e,t)}bezierCurveTo(e,t,n,i,r,s){this._currentPath?.cubicTo(e,t,n,i,r,s)}quadraticCurveTo(e,t,n,i){this._currentPath?.quadTo(e,t,n,i)}setTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.ctx)return;let n=this.ctx.getTotalMatrix(),i=lk.invert(n);if(i&&this.ctx.concat(i),this.ctx?.scale(this.dpr,this.dpr),this.camera?.enabled&&(this.ctx?.concat(this.camera.worldMatrix),t)){let e=lk.getScale(this.camera.worldMatrix);this.ctx?.scale(1/e[0],1/e[1])}this.ctx?.concat(e),this.currentTransform=e}transform(e){this.ctx?.concat(e)}setSize(e,t){!this._isSizeDirty&&e===this._width&&t===this._height||(this._isSizeDirty=!1,this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=Ak.MakeWebGLCanvasSurface(this.canvas),this.ctx=this._surface?.getCanvas()))}};function Rk(e){for(let t=0;t<e.length;t++)if(void 0!==e[t]&&!Number.isFinite(e[t]))return!1;return!0}function kk(e){let{r:t,g:n,b:i,a:r}=e;return Ak.Color4f(t,n,i,r)}var Bk,Uk,zk,Fk=class{constructor(e,t,n){this.uuid=e,this.data=t,this.enabled=!1,this.color=sx.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){void 0!==e.color&&(this.color=e.color),void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.blurRadius&&(this.blurRadius=e.blurRadius),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.spread&&(this.spread=e.spread)}},jk=class{constructor(e,t,n){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.radius&&(this.radius=e.radius)}},Vk=class{constructor(e,t,n){this.uuid=e,this.data=t,this.enabled=!1,this.color=sx.transparent,this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.color&&(this.color=e.color)}},Hk=class{constructor(e,t,n){this.uuid=e,this.data=t,this.enabled=!1,this.color=sx.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.color&&(this.color=e.color),void 0!==e.thickness&&(this.thickness=e.thickness),void 0!==e.mode&&(this.mode=e.mode)}},Wk=class extends yk{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.autoClose=!0,this.fill=new Vk(e+"-fill",t.fill,n),this.stroke=new Hk(e+"-stroke",t.stroke,n),this.dropShadow=new Fk(e+"-dropShadow",t.dropShadow,n),this.innerShadow=new Fk(e+"-innerShadow",t.innerShadow,n),this.backgroundBlur=new jk(e+"-backgroundBlur",t.backgroundBlur,n),this.layerBlur=new jk(e+"-layerBlur",t.layerBlur,n)}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:sx.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:sx.transparent,e.strokeMode=this.stroke.mode,e.lineWidth=this.stroke.thickness}applyFilters(e){this.layerBlur.enabled?e.layerBlur=5*this.layerBlur.radius:e.layerBlur=0,this.backgroundBlur.enabled?e.backgroundBlur=5*this.backgroundBlur.radius:e.backgroundBlur=0,this.dropShadow.enabled?(e.dropShadowBlur=5*this.dropShadow.blurRadius,e.dropShadowColor=this.dropShadow.color,e.dropShadowOffsetX=this.dropShadow.offset[0],e.dropShadowOffsetY=this.dropShadow.offset[1]):e.dropShadowColor=sx.transparent,this.innerShadow.enabled?(e.innerShadowSpread=this.innerShadow.spread,e.innerShadowBlur=5*this.innerShadow.blurRadius,e.innerShadowColor=this.innerShadow.color,e.innerShadowOffsetX=this.innerShadow.offset[0],e.innerShadowOffsetY=this.innerShadow.offset[1]):e.innerShadowColor=sx.transparent}innerDraw(e){}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.applyFilters(e),this.applyFillStroke(e),e.beginPath(),this.innerDraw(e),this.autoClose&&e.closePath(),this.fill.enabled&&e.fill(),this.stroke.enabled&&e.stroke(),e.restore())}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),0===e.type&&(Zy(e.path,["fill"])?this.fill.update(e.props):Zy(e.path,["stroke"])?this.stroke.update(e.props):Zy(e.path,["dropShadow"])?this.dropShadow.update(e.props):Zy(e.path,["innerShadow"])?this.innerShadow.update(e.props):Zy(e.path,["layerBlur"])?this.layerBlur.update(e.props):Zy(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}updateState(e,t){super.updateState(e,t),void 0!==e.fill&&this.fill.update(e.fill),void 0!==e.stroke&&this.stroke.update(e.stroke),void 0!==e.dropShadow&&this.dropShadow.update(e.dropShadow),void 0!==e.innerShadow&&this.innerShadow.update(e.innerShadow),void 0!==e.layerBlur&&this.layerBlur.update(e.layerBlur),void 0!==e.backgroundBlur&&this.backgroundBlur.update(e.backgroundBlur)}clone(e){let t=new Wk(this.uuid,this.data,e);return t.parent=void 0,t}},Gk=class extends Wk{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,n)}innerDraw(e){e.ellipse(.5*this.width,.5*this.height,.5*this.width,.5*this.height,0,0,2*Math.PI)}intersectsInLocalSpace(e,t){return function(e,t,n,i,r,s){let a=e-n,o=t-i;return a*a/(r*r)+o*o/(s*s)<=1}(e,t,.5*this.width,.5*this.height,.5*this.width,.5*this.height)}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new Gk(this.uuid,this.data,e);return t.parent=void 0,t}},qk=class extends Wk{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,n)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateCornerState(e){void 0!==e.cornerRadius&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new qk(this.uuid,this.data,e);return t.parent=void 0,t}},Kk=class extends Wk{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,n)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:sx.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:sx.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){this._fontHolder?.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let t=this.data.textTransform,n=this.data.text.textValue.toString(),i=2===t?n.toUpperCase():3===t?n.toLowerCase():n,{height:r}=e.drawText(i,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=r}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,t){let{shared:n}=t;void 0!==e.font&&(this._fontHolder=n.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then((()=>{this.requestRender()})))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new Kk(this.uuid,this.data,e);return t.parent=void 0,t}},Yk=class extends Wk{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,n)}computeExtremas(){0===this.curves.length&&this.computeCurves();let e=this.curves.map((e=>Bk.extremas(e))),t=[1/0,1/0],n=[-1/0,-1/0];for(let i=0,r=e.length;i<r;i++){let r=e[i];r[0][0]<t[0]&&(t[0]=r[0][0]),r[0][1]<t[1]&&(t[1]=r[0][1]),r[1][0]>n[0]&&(n[0]=r[1][0]),r[1][1]>n[1]&&(n[1]=r[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[n[0],n[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let n=1,i=this.data.points.length;n<i;n++){let e=this.data.points[n].data,t=this.data.points[n-1].data,i={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(i)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let n={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(n)}}getCenter(){let[e,t]=this.extremasBBox.min,[n,i]=this.getHalfSize();return[e+n,t+i]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[.5*(t[0]-e[0]),.5*(t[1]-e[1])]}innerDraw(e){for(let i=0,r=this.data.points.length;i<r;i++){let t=this.data.points[i].data;if(0===i){let[n,i]=t.position;e.moveTo(n,i)}else{let n=this.data.points[i-1].data,[r,s]=n.controlNext.position,[a,o]=t.controlPrevious.position,[l,c]=t.position,h={start:n.position,cp1:n.controlNext.position,cp2:t.controlPrevious.position,end:t.position};Bk.derive(h),e.bezierCurveTo(r,s,a,o,l,c)}}let t=this.data.points[0].data,n=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[i,r]=n.controlNext.position,[s,a]=t.controlPrevious.position,[o,l]=t.position;e.bezierCurveTo(i,r,s,a,o,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new Yk(this.uuid,this.data,e);return t.parent=void 0,t}};(e=>{function t(e,t,n){let i=e-2*t+n;if(0!==i){let r=-Math.sqrt(Math.abs(t*t-e*n)),s=-e+t;return[-(r+s)/i,-(-r+s)/i]}return t!==n&&0===i?[(2*t-n)/(2*(t-n))]:[]}e.derive=function(e){let t=e.start,n=e.cp1,i=e.cp2,r=e.end,s={start:[3*(n[0]-t[0]),3*(n[1]-t[1])],cp:[3*(i[0]-n[0]),3*(i[1]-n[1])],end:[3*(r[0]-i[0]),3*(r[1]-i[1])]};return e.derivative=s,s.derivative=Uk.derive(s),s},e.droot=function(n){let i=n.derivative??e.derive(n),r=i.start,s=i.cp,a=i.end;return[t(r[0],s[0],a[0]),t(r[1],s[1],a[1])]},e.extremas=function(t){let[n,i]=e.droot(t),r=[t.start[0],t.end[0]],s=[t.start[1],t.end[1]];for(let a of n)r.push(e.compute(t,Math.min(1,Math.max(0,a)))[0]);for(let a of i)s.push(e.compute(t,Math.min(1,Math.max(0,a)))[1]);return r.sort(((e,t)=>e-t)),s.sort(((e,t)=>e-t)),[[r[0],s[0]],[r[r.length-1],s[s.length-1]]]},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let n=1-t,i=n*n,r=t*t,s=i*n,a=i*t*3,o=n*r*3,l=t*r;return[s*e.start[0]+a*e.cp1[0]+o*e.cp2[0]+l*e.end[0],s*e.start[1]+a*e.cp1[1]+o*e.cp2[1]+l*e.end[1]]}})(Bk||(Bk={})),(e=>{e.derive=function(e){let t=e.start,n=e.cp,i=e.end,r={start:[2*(n[0]-t[0]),2*(n[1]-t[1])],end:[2*(i[0]-n[0]),2*(i[1]-n[1])]};return r.derivative=zk.derive(r),e.derivative=r,r},e.droot=function(t){let n=t.derivative??e.derive(t),i=n.start,r=n.end;return[i[0]!==r[0]?i[0]/(i[0]-r[0]):0,i[1]!==r[1]?i[1]/(i[1]-r[1]):0]},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let n=1-t,i=n*n,r=n*t*2,s=t*t;return[i*e.start[0]+r*e.cp[0]+s*e.end[0],i*e.start[1]+r*e.cp[1]+s*e.end[1]]}})(Uk||(Uk={})),(e=>{e.derive=function(e){let t=e.start,n=e.end,i=[n[0]-t[0],n[1]-t[1]];return e.derivative=i,e.derivative},e.compute=function(e,t){if(0===t)return[...e.start];if(1===t)return[...e.end];let n=e.start,i=e.end;return[n[0]+(i[0]-n[0])*t,n[1]+(i[1]-n[1])*t]}})(zk||(zk={}));var Qk=class extends bk{constructor(e,t,n){super(e,t,n),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new qk(e+"-background",fC.defaultData,n),this.background.parent=this,this.updateState(t,n)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){super.updateLocalMatrix(),this.background?.updateLocalMatrix()}updateWorldMatrix(e,t,n){super.updateWorldMatrix(e,t,n),this.background?.updateWorldMatrix(e,t,n)}draw(e){if(!this.visible)return;e.save();let t=this.width,n=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=n,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,n,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[.5*this.width,.5*this.height]}getHalfSize(){return[.5*this.width,.5*this.height]}updateCornerState(e){void 0!==e.cornerRadius&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;void 0!==e.width&&(this.width="number"==typeof e.width?e.width:this.width,t=!0),void 0!==e.height&&(this.height="number"==typeof e.height?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),void 0!==e.fill&&this.fill.update(e.fill),void 0!==e.stroke&&this.stroke.update(e.stroke),void 0!==e.dropShadow&&this.dropShadow.update(e.dropShadow),void 0!==e.innerShadow&&this.innerShadow.update(e.innerShadow),void 0!==e.layerBlur&&this.layerBlur.update(e.layerBlur),void 0!==e.backgroundBlur&&this.backgroundBlur.update(e.backgroundBlur),void 0!==e.clipped&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),0===e.type&&(Zy(e.path,["fill"])?this.fill.update(e.props):Zy(e.path,["stroke"])?this.stroke.update(e.props):Zy(e.path,["dropShadow"])?this.dropShadow.update(e.props):Zy(e.path,["innerShadow"])?this.innerShadow.update(e.props):Zy(e.path,["layerBlur"])?this.layerBlur.update(e.props):Zy(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new Qk(this.uuid,this.data,e);t.parent=void 0;for(let n of this.children)t.add(n.clone(e));return t}},Xk=Mt(kt(),1),Zk=class extends Wk{constructor(e,t,n){super(e,t,n),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,n),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),void 0!==e.path&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new Zk(this.uuid,this.data,e);return t.parent=void 0,t}};var Jk=class{constructor(e,t,n){this.uuid=e,this.data=t,this.group=new wk(Jk.GROUP_ID,{...yC.defaultData},n),this.createChildrenObjects(t.objects,this.group,n)}createObject(e,t,n,i,r,s){let a=function(e,t,n){switch(t.type){case"ellipse2d":return new Gk(e,t,n);case"rectangle2d":return new qk(e,t,n);case"text2d":return new Kk(e,t,n);case"vector2d":return new Yk(e,t,n);case"path2d":return new Zk(e,t,n);case"frame2d":return new Qk(e,t,n);default:return new wk(e,t,n)}}(e,t,s);a&&(i.add(a),i.children.splice(r,0,i.children.pop()),a.updateWorldMatrix(),n.length>0&&(a instanceof wk||a instanceof Qk)&&this.createChildrenObjects(n,a,s))}createChildrenObjects(e,t,n){let i=0;for(let r of e)this.createObject(r.id,r.data,r.children,t,i,n),i+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,n,i){let r=this.find(e);if(r)try{r.updateByOp(t,n,{shared:i})}catch(Hw){console.error(Hw)}}updateTreeByOp(e,t){if(0===e.path.length&&7===e.type){let n=null===e.parent?this.group:this.find(e.parent);void 0!==n&&n instanceof bk&&(this.createObject(e.id,e.data,e.children,n,e.localIndex,t),n.requestRender())}else if(0===e.path.length&&8===e.type){let t=this.find(e.id);if(void 0!==t&&void 0!==t.parent&&t.parent instanceof bk){let e=t.parent;t.resetBBoxNeedsUpdate(),e?.remove(t),e?.requestRender()}}else if(0===e.path.length&&9===e.type){let t=this.find(e.id);if(void 0!==t){let n=t.parent,i=null===e.parent?this:this.find(e.parent);if(i instanceof bk||i===this){i.add(t);let r=e.localIndex;i.children.splice(r,0,i.children.pop()),t.updateWorldMatrix(!0,!1,!0),n?.requestRender(),t.requestRender()}t.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse((t=>{t!==this.group&&e(t)}))}intersectsChildren(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.group.intersectsChildren(e,t,n,i,r,!0)}intersectsChildrenReverse(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return this.group.intersectsChildrenReverse(e,t,n,i,r,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(void 0===t)return;let n=[],i=t;for(;i!==this.group;){let e=i;i=i.parent;let t=i.children.indexOf(e);n.splice(0,0,t)}return{entity:t,sortKey:n}}getAllSorted(e){let t=[];for(let n of e){let e=this.getWithSortKey(n.id);void 0!==e&&t.push(e)}return t.sort(((e,t)=>Vv(e.sortKey,t.sortKey))),t.map((e=>e.entity))}},$k=Jk;function eB(e){let{constraints:t,newParentWidth:n,newParentHeight:i,initialParentWidth:r,initialParentHeight:s,objectInitialWidth:a,objectInitialHeight:o,objectInitialPosition:l}=e,{horizontalConstraint:c,verticalConstraint:h}=t,u=n-r,d=i-s,p=a,f=o,m=l[0],g=l[1];if(0!==c)if(1===c)m+=u;else if(3===c)m+=u/2;else if(2===c)p=Math.max(1,p+u);else if(4===c){let e=n/r;p*=e,m*=e}if(0!==h)if(1===h)g+=d;else if(3===h)g+=d/2;else if(2===h)f=Math.max(1,f+d);else if(4===h){let e=i/s;f*=e,g*=e}return{width:p,height:f,position:[m,g]}}$k.GROUP_ID="scene2d";Mt(kt(),1);var tB=new ha(-1,1,1,-1,0,1),nB=new class extends gs{constructor(){super(),this.setAttribute("position",new ls([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new ls([0,2,0,0,2,0],2))}},iB=new Bs({defines:{},uniforms:{tDiffuse:new bu(null)},vertexShader:"\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tvUv = uv;\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t}",fragmentShader:"\n\tuniform sampler2D tDiffuse;\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\tgl_FragColor = texel;\n\t}"}),rB=new class{constructor(e){this._mesh=new Ns(nB,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,tB)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}(iB),sB=null,aB=null,oB=lk.identity(),lB=class{constructor(e,t,n,i){this.uuid=e,this.width=t,this.height=n,this.context=i,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let e=this.width,t=this.height,n=this.dpr;this.renderer.dpr=this.isScreenSpace?n:Math.floor(2048/Math.max(e,t)),this.renderer.setSize(e,t)},this.onFrameOverrideObjectEvent=e=>{if(void 0!==e.target?.uuid){let t=this.frameRoot?.find(e.target.uuid);t&&t.dispatchEvent({...e,target:t})}},this.scene2d=new $k(ui.generateUUID(),xC.defaultData,{dpr:window.devicePixelRatio,shared:i.shared}),this.canvas=(null===sB&&(sB=document.createElement("canvas")),sB),this.renderer=(e=>(null===aB&&(aB=new Lk(e)),aB))(this.canvas),this.promise=this.init(),this.renderTarget=new Bi(1,1,{type:En,stencilBuffer:!1,depthBuffer:!1}),i.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=i.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new sc(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof Lk&&(this.renderer.wasmURL=RN.skiaWasmUrl),await this.renderer.init()}render(e){if(this.isFrameDirty){this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),this.frameOverride?.draw(this.renderer),this.renderer.render(),iB.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let t=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.clear(),rB.render(e),e.setRenderTarget(t),this.textureHolder?.setNeedsUpdate(!0)}}updateEntity2DByOp(e,t,n,i){this.scene2d.updateEntityByOp(e,t,n,i),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let t=e?.width??this.width,n=e?.height??this.height;this.frameOverride.width=t,this.frameOverride.height=n,this.frameOverride.localMatrix=oB,this.isScreenSpace&&(this.frameOverride.fill.color=sx.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:t,height:n},cB({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.devicePixelRatio,n=Math.max(1,e?.width??this.width),i=Math.max(1,e?.height??this.height);this.dpr=t,this.width=n,this.height=i,this._innerApplySize();let r=1;(n*t<512||i*t<512)&&(r=Math.max(512/(n*t),512/(i*t))),this.renderTarget.setSize(n*t*r,i*t*r),this._canvasTexture?.dispose(),this._canvasTexture=void 0,this.applyOverrides(e),this.frameOverride?.requestRender()}applyFrame(e){let t=this.context.scene.find2D(e);if(t&&t instanceof Qk)return this.disposeFrameOverride(),this.frameRoot=t,this.frameOverride=t.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),this.frame?.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse((e=>{e.addEventListener("beginState",this.onFrameOverrideObjectEvent)})),this.frameOverride.traverse((e=>{e.addEventListener("completeState",this.onFrameOverrideObjectEvent)})),this.frame?.requestRender(),t}get frame(){return this.frameOverride}get frameId(){return this.frame?.uuid}find(e){return this.scene2d.find(e)}get texture(){return this.textureHolder?.getTexture(1001)}disposeFrameOverride(){this.frameOverride?.removeEventListener("render",this.onRenderRequestedDownstream),this.frameOverride?.traverse((e=>{e.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)})),this.frameOverride?.traverse((e=>{e.removeEventListener("completeState",this.onFrameOverrideObjectEvent)})),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function cB(e){let{objectOverride:t,objectRoot:n,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a}=e;if(t instanceof Qk&&n instanceof Qk||t instanceof wk&&n instanceof wk)for(let o=0,l=t.children.length;o<l;o++){let e=t.children[o],l=n.children[o];e&&l&&e.uuid===l.uuid&&hB({objectOverride:e,objectRoot:l,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a})}}function hB(e){let{objectOverride:t,objectRoot:n,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a}=e,[o,l]=function(e){if(dB(e))return[e.width,e.height];if(e instanceof Zk){let[t,n]=e.getHalfSize();return[2*t,2*n]}if(e instanceof wk){let[t,n]=e.recursiveBBox.getHalfSize();return[2*t,2*n]}return[0,0]}(n),{width:c,height:h,position:u}=eB({constraints:t.data,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a,objectInitialWidth:o,objectInitialHeight:l,objectInitialPosition:n.position});if(t.position=u,t.data={...t.data,position:u},t.states)for(let d in t.states)uB({stateId:d,objectOverride:t,objectRoot:n,newParentWidth:i,newParentHeight:r,initialParentWidth:s,initialParentHeight:a});if(dB(t)||t instanceof wk)dB(t)&&(t.width=c,t.height=h,t.data={...t.data,width:c,height:h}),cB({objectOverride:t,objectRoot:n,newParentWidth:c,newParentHeight:h,initialParentWidth:o,initialParentHeight:l});else if(t instanceof Zk){let e=n,i=0!==o?c/o:1,r=0!==l?h/l:1;t.path=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t<=0||n<=0)return e;let i=(0,Xk.parseSVG)(e).map((e=>{let i={...e};return"x"in i&&(i.x=i.x*t),"y"in i&&(i.y=i.y*n),"x1"in i&&(i.x1=i.x1*t),"x2"in i&&(i.x2=i.x2*t),"y1"in i&&(i.y1=i.y1*n),"y2"in i&&(i.y2=i.y2*n),"rx"in i&&(i.rx=i.rx*t),"ry"in i&&(i.ry=i.ry*n),i}));return function(e){let t,n=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"];return e.map((e=>{let i=[];n.forEach((t=>{if(t in e){let n=1*e[t];i.length&&n>=0&&i.push(","),i.push(n)}}));let r=(t===e.code?i[0]<0?"":",":e.code)+i.join("");return t=e.code,r})).join("")}(i)}(e.path,i,r),t.data={...t.data,path:t.path}}}function uB(e){let{stateId:t,objectOverride:n,objectRoot:i,newParentWidth:r,newParentHeight:s,initialParentWidth:a,initialParentHeight:o}=e,l=n.states?.[t],c=i.states?.[t];if(l&&c){let{width:e,height:i,position:h}=eB({constraints:n.data,newParentWidth:r,newParentHeight:s,initialParentWidth:a,initialParentHeight:o,objectInitialWidth:wC.isResizeable(c)?c.width:0,objectInitialHeight:wC.isResizeable(c)?c.height:0,objectInitialPosition:c.position});Object.assign(n.states[t],{position:h}),wC.isResizeable(l)&&Object.assign(n.states[t],{width:e,height:i})}}function dB(e){return e instanceof qk||e instanceof Qk||e instanceof Gk||e instanceof Kk}var pB=class extends(PS(Ol)){constructor(e,t,n){super(),this.data=t,this.bgColor=new lM(1,1,1,1),this.fog=null,this.backupFog=new Il(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new Mi,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new jD(gx,{...pE.defaultData,...t.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new Fh(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),t.uiScene?this.uiScene=new $k((Array.isArray(e)?e[0]:e)+"-ui",t.uiScene,{dpr:window.devicePixelRatio,shared:n.shared}):t.uiFrame&&this.createUICanvas(t.uiFrame,n)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){return this.uiCanvas?.frame}createUICanvas(e,t){this.uiCanvas=new lB(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,t),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then((()=>{this.uiCanvas?.applyFrame(e),this.uiCanvas?.applySize()}))}updateVisible(){}setBackgroundColor(e){this.bgColor=e,!0===this.fogUseBGColor&&(this.backupFog.color=e)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(e,t){void 0!==e.color&&(this.ambientLight.color=vI(e.color,t)),void 0!==e.intensity&&(this.ambientLight.intensity=e.intensity),void 0!==e.enabled&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.traverseEntity((e=>{e instanceof qD&&e.recomputeBoolean()})),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity((e=>{if(e instanceof TO)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()}))}updateShadow(e){void 0!==e.softShadowQuality&&this.isActive&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"medium";if(YR===e)return!1;YR=e;let t=(e=>{switch(e){case"low":return 8;case"medium":default:return 16;case"high":return 32}})(e);ea.shadowmap_pars_fragment=(e=>`\n\n// PCSS implementation based on:\n// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/\n// NOTE: This number affects how big the shadow blur can\n// possibly get. Bigger number == bigger blur, but less precise results\n\nconst float  gPenumbraFilterSize = 80.0;\nconst int   gPenumbraSamples = ${e};\nconst int gShadowSamples = ${e};\nconst float gShadowSamplesRpc = 1.0f / float(gShadowSamples);\n\n#ifdef USE_SHADOWMAP\n    #if NUM_DIR_LIGHT_SHADOWS > 0\n\n        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n        struct DirectionalLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n        };\n\n        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n    #endif\n\n    #if NUM_SPOT_LIGHT_SHADOWS > 0\n\n        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n        struct SpotLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n        };\n\n        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n    #endif\n\n    #if NUM_POINT_LIGHT_SHADOWS > 0\n\n        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n        struct PointLightShadow {\n            float shadowBias;\n            float shadowNormalBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n            float shadowCameraNear;\n            float shadowCameraFar;\n        };\n\n        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n    #endif\n\n    /*\n    #if NUM_RECT_AREA_LIGHTS > 0\n\n        // TODO (abelnation): create uniforms for area light shadows\n\n    #endif\n    */\n\nfloat computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)\n{\n    float penumbra = 1.0;\n    float blockerDepthAvg = 0.0;\n    float blockerCount = 0.0;\n\n    #pragma unroll_loop_start\n    for(int i = 0; i < gPenumbraSamples; i ++)\n    {\n        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;\n        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );\n\n        if(depth < compare + 0.0001)\n        {\n            blockerDepthAvg += depth;\n            blockerCount++;\n        }\n    }\n    #pragma unroll_loop_end\n\n    if (blockerCount > 0.0)\n    {\n        blockerDepthAvg /= blockerCount;\n\n        // Compute penumbra\n        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);\n        penumbra *= penumbra;\n        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows\n\n        return clamp(penumbra, 0.00, 1.0);\n    }\n    return 0.0;\n}\n\nfloat vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)\n{\n    float shadow         = 0.0f;\n\n    // NOTE: When using TAA, we should use screen space interleaved gradient noise\n    vec2 halton = haltonSequence[frameIndex];\n    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n    float temporalAngle  = temporalOffset * PI2;\n\n    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);\n    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);\n    if (penumbra == -1.0) {\n        return 1.0;\n    }\n\n    #pragma unroll_loop_start\n    for (int i = 0; i < gShadowSamples; i++)\n    {\n        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n        // Overall blurring offset\n        vec2 offset = vogelSample * (shadowRadius * 2.);\n\n        // Penumbra offset\n        offset += vogelSample * (penumbra * texelScalar);\n\n        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );\n    }\n    #pragma unroll_loop_end\n\n    return shadow * gShadowSamplesRpc;\n}\n\n\n    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n    }\n\n    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n        return unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n    }\n\n    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n        float occlusion = 1.0;\n\n        vec2 distribution = texture2DDistribution( shadow, uv );\n\n        float hard_shadow = step( compare , distribution.x ); // Hard Shadow\n\n        if (hard_shadow != 1.0 ) {\n\n            float distance = compare - distribution.x ;\n            float variance = max( 0.00000, distribution.y * distribution.y );\n            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality\n            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed\n            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n        }\n        return occlusion;\n\n    }\n\n    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n        float shadow = 1.0;\n\n        shadowCoord.xyz /= shadowCoord.w;\n        shadowCoord.z += shadowBias;\n\n        // if ( something && something ) breaks ATI OpenGL shader compiler\n        // if ( all( something, something ) ) using this instead\n\n        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n        bool inFrustum = all( inFrustumVec );\n\n        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n        bool frustumTest = all( frustumTestVec );\n\n        if ( frustumTest ) {\n\n        #if defined( SHADOWMAP_TYPE_PCF )\n\n            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );\n\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n            float dx = texelSize.x;\n            float dy = texelSize.y;\n\n            vec2 uv = shadowCoord.xy;\n            vec2 f = fract( uv * shadowMapSize + 0.5 );\n            uv -= f * texelSize;\n\n            shadow = (\n                texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n                     f.x ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n                     f.x ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n                     f.y ) +\n                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n                     f.y ) +\n                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n                          f.x ),\n                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n                          f.x ),\n                     f.y )\n            ) * ( 1.0 / 9.0 );\n\n        #elif defined( SHADOWMAP_TYPE_VSM )\n\n            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n        #else // no percentage-closer filtering:\n\n            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n        #endif\n\n        }\n\n        return shadow;\n\n    }\n\n    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n    // vector suitable for 2D texture mapping. This code uses the following layout for the\n    // 2D texture:\n    //\n    // xzXZ\n    //  y Y\n    //\n    // Y - Positive y direction\n    // y - Negative y direction\n    // X - Positive x direction\n    // x - Negative x direction\n    // Z - Positive z direction\n    // z - Negative z direction\n    //\n    // Source and test bed:\n    // https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n    vec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n        // Number of texels to avoid at the edge of each square\n\n        vec3 absV = abs( v );\n\n        // Intersect unit cube\n\n        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n        absV *= scaleToCube;\n\n        // Apply scale to avoid seams\n\n        // two texels less per square (one texel will do for NEAREST)\n        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n        // Unwrap\n\n        // space: -1 ... 1 range for each square\n        //\n        // #X##         dim    := ( 4 , 2 )\n        //  # #         center := ( 1 , 1 )\n\n        vec2 planar = v.xy;\n\n        float almostATexel = 1.5 * texelSizeY;\n        float almostOne = 1.0 - almostATexel;\n\n        if ( absV.z >= almostOne ) {\n\n            if ( v.z > 0.0 )\n                planar.x = 4.0 - v.x;\n\n        } else if ( absV.x >= almostOne ) {\n\n            float signX = sign( v.x );\n            planar.x = v.z * signX + 2.0 * signX;\n\n        } else if ( absV.y >= almostOne ) {\n\n            float signY = sign( v.y );\n            planar.x = v.x + 2.0 * signY + 2.0;\n            planar.y = v.z * signY - 2.0;\n\n        }\n\n        // Transform to UV space\n\n        // scale := 0.5 / dim\n        // translate := ( center + 0.5 ) / dim\n        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n    }\n\n    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n        float shadow = 1.0;\n        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n        // for point lights, the uniform @vShadowCoord is re-purposed to hold\n        // the vector from the light to the world-space position of the fragment.\n        vec3 lightToPosition = shadowCoord.xyz;\n\n        // dp = normalized distance from light to fragment position\n        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n        compare += shadowBias;\n\n        // bd3D = base direction 3D\n        vec3 bd3D = normalize( lightToPosition );\n\n        vec2 halton = haltonSequence[frameIndex];\n        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);\n        float temporalAngle  = temporalOffset * PI2;\n\n        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )\n            for (int i = 0; i < gShadowSamples; i++) {\n                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n\n                // Overall blurring offset\n                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);\n\n                // NOTE: Removed for now\n                // Penumbra offset\n                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);\n\n                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );\n\n            }\n            return shadow * gShadowSamplesRpc;\n\n        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n            for (int i = 0; i < 16; i++) {\n                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;\n\n                // Overall blurring offset\n                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);\n\n                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );\n\n            }\n            return shadow * (1.0 / 16.0);\n        #else // no percentage-closer filtering\n\n            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );\n\n        #endif\n\n    }\n\n#endif\n`)(t);let n=qR.slice();n=n.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),n=n.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),ea.lights_fragment_begin=n;let i=KR.slice();return i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),ea.shadowmask_pars_fragment=i,!0}(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){this.scene.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=vI(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){void 0!==e.aoColor&&(this.aoColor=vI(e.aoColor,t))}updateByOp(e,t,n,i){let r=this.data.uiFrame;super.updateByOp(e,t,n,i);let s=t;Zy(e.path,["fog"])?this.updateFog(s.fog,n.shared):Zy(e.path,["ao"])?this.updateAo(s.ao,n.shared):Zy(e.path,["ambient"])?this.updateAmbientLight(s.ambient,n.shared):Zy(e.path,["shadow"])?this.updateShadow(s.shadow):0===e.type&&0===e.path.length&&(void 0!==e.props.uiFrame||r!==s.uiFrame)&&this.updateUIFrame(e.props.uiFrame,n)}updateUIFrame(e,t){e?(this.uiCanvas||this.createUICanvas(e,t),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(e)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(e,t){this.updateState_Entity(e,t),void 0!==e.backgroundColor&&this.setBackgroundColor(vI(e.backgroundColor,t.shared)),void 0!==e.fog&&this.updateFog(e.fog,t.shared),void 0!==e.ambient&&this.updateAmbientLight(e.ambient,t.shared),void 0!==e.ao&&this.updateAo(e.ao,t.shared),void 0!==e.shadow&&this.updateShadow(e.shadow)}createFrame(e,t){}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){return this.scene?.find(this.data.publish.playCamera)??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return null===this.penumbraSizeArrayCache&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity((n=>{if(!n.visible)return!0;n instanceof ck&&n.visible&&e<3&&(this.penumbraSizeArrayCache[e]=n.data.penumbraSize??.5,e+=1),n instanceof pk&&n.visible&&e<2&&(this.penumbraSizeArrayCache[3+t]=n.data.penumbraSize??.5,t+=1)}))}raycastWithClones(e){let t=[],n=i=>{for(let r of i.children){let i=r.cloner;sS.is(r)&&(r.visible||i?.object.data.visible)&&((YD(r)||XD(r)&&this.scene.enableHelpers&&r.objectHelper.visible)&&(e.intersectObject(r,!1,t),aU(r,e,t,!0)),n(r))}};return n(this),t}updateEntity2DByOp(e,t,n,i){this.uiCanvas?.updateEntity2DByOp(e,t,n,i)}},fB=class extends(KD(Zh,ek)){constructor(e,t,n){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let r=new ji(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new ji(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),a=new Wi(r,s),o=new Fu(a,new Mi(16755200));o.visible=!1,this.gizmos.shadowmap=o,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof Fu){let e=this.shadow.camera,n=new ji(-e.far+this.position.x,-e.far+this.position.y,-e.far+this.position.z),i=new ji(e.far+this.position.x,e.far+this.position.y,e.far+this.position.z);t.box.set(n,i),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),void 0!==e.distance&&(this.distance=e.distance),void 0!==e.decay&&(this.decay=e.decay),void 0!==e.shadowRadius&&(this.shadow.radius=e.shadowRadius),void 0!==e.shadowResolution&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},mB=class extends DO{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let n=this.geometry.getAttribute("position");void 0!==n?XP(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,e,t):super.updateEntityBoxSize(e,t)}},gB=class extends DO{constructor(e,t,n){super(e,t,n),this._shapeId=null,this._context=n}updateState(e,t){super.updateState(e,t),this.updateShape(),this.refreshAttachedCloners(t)}updateShape(){let e,t={...this.data.geometry.extrusion.shape};for(let i in t)"string"==typeof t[i]&&(t[i]=this._context.shared.getVariable(t[i],[this.uuid,"geometry","extrusion","shape",i]));if("Custom"===t.type){let n=t.shapeId;if(n!==this._shapeId&&this.detachShape(),n){this._shapeId=n;let t=this._context.scene.find(n);t?.data&&(t.attachedPaths.add(this),e=t.geometry.userData?.shape),e||this._context.scene.addPendingCommand((()=>this.updateShape()))}}else{let n;switch(t.type){case"Rectangle":n=kT;break;case"Ellipse":n=tT;break;case"Polygon":n=IT;break;case"Star":n=UT;break;default:throw new Error(`Unknown shape type: ${t.type}`)}e=n.create({parameters:t}).userData.shape}let n=this.geometry;e&&n.inputs&&(n.inputs.shapeData=e,n.build())}detachShape(){null!==this._shapeId&&this._context.scene.find(this._shapeId)?.attachedPaths.delete(this)}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let n=this.geometry.getAttribute("position");void 0!==n?XP(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,e,t):super.updateEntityBoxSize(e,t)}},vB=class extends cD{constructor(e,t,n){super(e,t,n),this.data=t}},yB=class extends(LD(Cl,tL)){constructor(e,t,n){super(),"Instance"===t.type&&"string"==typeof e&&(t=this.transformAssignData(t,n)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return"Component"===this.data.type&&"string"==typeof this.identity}get isInstanceRoot(){return"Instance"===this.data.type&&"string"==typeof this.identity}transformAssignData(e,t){let n=nC.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(n){let t,i;for(let r of gE.rootOverrideProps)void 0===e[r]?(void 0===t&&(t={...e}),t[r]=n.data[r]):(void 0===i&&(i={}),i[r]=e[r],void 0===t&&(t={...e}),t[r]=wy.apply(n.data[r],e[r]));return this.overrideData=i,t}return{...oE.defaultData,...e,...Nv(oE.defaultData,gE.rootOverrideProps)}}updateByOp(e,t,n,i){let r;if(this.isInstanceRoot&&!i)if(t=this.transformAssignData(t,n),0===e.type&&0===e.path.length&&this.component)for(let s of gE.rootOverrideProps)s in e.props&&void 0===e.props[s]&&(void 0===r&&(r={...e,props:{...e.props}}),r.props[s]=this.component.data[s]);else if(0===e.type&&e.path.length>0&&gE.rootOverrideProps.includes(e.path[0])){let n=e.path[0];void 0===r&&(r={...e,path:[],props:{[n]:t[n]}})}super.updateByOp(r??e,t,n,i)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(void 0===this.component){let n=e.scene.find(t.component)??null,i=!1;if(n!==this.oldComponent){if(this.oldComponent){let t=0;for(let n of this.children){if(!sS.is(n))break;e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),bB(n),t+=1}this.children.splice(0,t)}i=!0}if(n){let r={};xB(e,[this.uuid],t.overrides,this,n,n,0,i,r);for(let t of this.children)if(sS.is(t)){let n=t.data;"Empty"===n.type&&n.animations&&t.traverseEntity((t=>{let n=t.dataPatched;if(t instanceof DO&&n.bones&&n.boneInverses){let n=t.dataPatched;if(n.bones&&n.boneInverses){let i=n.bones.map((t=>e.scene.find(r[t]))),s=n.boneInverses.map((e=>(new vr).fromArray(e))),a=new Fl(i,s);t.bind(a,t.bindMatrix)}}else t.matrixAutoUpdate=!0}))}}this.oldComponent=this.component}}};function bB(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let n of e.children)sS.is(n)&&bB(n)}}function wB(e,t,n,i){return e.component===t&&bv(e.identity,i)?e.overrideData===n?2:1:0}function xB(e,t,n,i,r,s,a,o,l){if(a>50)return!1;if(i.component!==r){if(i.component){let e=i.component.instances.indexOf(i);e>=0&&i.component.instances.splice(e,1)}r.instances.find((e=>e===i))||r.instances.push(i),i.component=r}r instanceof yB&&r.isInstanceRoot&&r.expandInstanceChildren(e);let c=0;for(let h of r.children)if(sS.is(h)){let r=[...t,..."string"==typeof h.identity?[h.identity]:h.identity],u=mE.resolve(n,r,1);null==u||u instanceof Ay||(Object.setPrototypeOf(u,Ay.prototype),console.error("wrong prototype"));let d,p=null;if(!o){let t=i.children[c];if(p=sS.is(t)?t:null,null!==p){let e=wB(p,h,u,r);d=e>=1?p.stateSelection:void 0,2!==e&&(p=null)}if(null===p&&(p=e.scene.findInstance(r)??null,null!==p)){let t=wB(p,h,u,r);if(d=t>=1?p.stateSelection:void 0,2!==t)p=null;else{let t=p.parent.children.indexOf(p);p.parent.children.splice(t,1),i.children.splice(c,0,p),p.parent===i?t<=c&&console.error("not possible"):(p.parent=i,p.matrixWorldNeedsUpdate=!0,p.resetBBoxNeedsUpdate(),p.updateVisible(),e.pendingDeletes.delete(p))}}}if(null===p){let t=u?wy.apply(h.data,u):h.data;dx.is(t.type)&&(t={...t,type:"Empty"}),p=vS.createEntity(r,t,e),p.overrideData=u,i.add(p),i.children.splice(i.children.length-1,1),i.children.splice(c,0,p),p.updateState(p.data,e),d&&p.changeSelectedState(d,e),e.scene.registerInstanceAndSetUuid(p)}if(p.isBone){l[p.identity[p.identity.length-1]]=p.uuid}c+=1,xB(e,t,n,p,h,s,a+1,o,l)}if(!o){let t=c;for(;;){let t=i.children[c];if(!sS.is(t))break;e.pendingDeletes.add(t),c+=1}i.children.splice(t,c-t)}return!0}var EB=class extends(LD(kl,tL)){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},CB=class extends DO{constructor(e,t,n){super(e,t,n),this.onBeforeRender=e=>{this.uiCanvas.render(e)},this.uiCanvas=new lB(e+"-canvas",t.geometry.width,t.geometry.height,n),this.uiCanvas.promise.then((()=>{this.applyFrame(this.dataPatched.geometry.frame,n.shared)}))}updateByPatchedOpGeometry(e,t,n){super.updateByPatchedOpGeometry(e,t,n),0===e.type&&(void 0!==e.props.frame&&this.applyFrame(e.props.frame,n.shared),(void 0!==e.props.width||void 0!==e.props.height)&&this.applySize(e.props,n.shared))}applySize(e,t){let n=e?.width??this.dataPatched.geometry.width,i=e?.height??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:n,height:i}),this.applyGeometryParametersFromFrame(t)}applyFrame(e,t){this.uiCanvas.applyFrame(e),this.applyGeometryParametersFromFrame(t),this.applyMaterialParametersFromFrame({shared:t})}applyGeometryParametersFromFrame(e){let t=this.frame;t&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),this.localGeometry?.dispose(),this.localGeometry=pP(this.dataPatched.geometry,e,this.data.flatShading,this))}applyMaterialParametersFromFrame(e){let t=this.frame;if(t){let n=t.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:n.radius,alpha:n.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:n.radius,alpha:n.enabled?1:0}),this.material.reset(this.dataPatched.material,e,!0)}}updateEntity2DByOp(e,t,n,i){this.uiCanvas.updateEntity2DByOp(e,t,n,i),e===this.frameId&&0===t.type&&(void 0!==t.props.cornerRadius?this.applyGeometryParametersFromFrame(i):Zy(t.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:i}))}get frame(){return this.uiCanvas.frame}get frameId(){return this.frame?.uuid}removeInteractionGeometry(e){super.removeInteractionGeometry(e),this.applySize({},e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.applySize({width:e.width,height:e.height},t)}},AB=class{constructor(e,t,n){this.variables=[],this.currentTextureIndex=0;let i=xn,r=new Ol,s=new Us;s.position.z=1;let a={passThruTexture:{value:null}},o=h("uniform sampler2D passThruTexture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( passThruTexture, uv );\n\n}\n",a),l=new Ns(new $s(2,2),o);function c(n){n.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}function h(e,t){let n=new Bs({uniforms:t=t||{},vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:e});return c(n),n}r.add(l),this.setDataType=function(e){return i=e,this},this.addVariable=function(e,t,n){let i={name:e,initialValueTexture:n,material:this.createShaderMaterial(t),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:pn,magFilter:pn};return this.variables.push(i),i},this.setVariableDependencies=function(e,t){e.dependencies=t},this.init=function(){if(!1===n.capabilities.isWebGL2&&!1===n.extensions.has("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===n.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(let n=0;n<this.variables.length;n++){let i=this.variables[n];i.renderTargets[0]=this.createRenderTarget(e,t,i.wrapS,i.wrapT,i.minFilter,i.magFilter),i.renderTargets[1]=this.createRenderTarget(e,t,i.wrapS,i.wrapT,i.minFilter,i.magFilter),this.renderTexture(i.initialValueTexture,i.renderTargets[0]),this.renderTexture(i.initialValueTexture,i.renderTargets[1]);let r=i.material,s=r.uniforms;if(null!==i.dependencies)for(let e=0;e<i.dependencies.length;e++){let t=i.dependencies[e];if(t.name!==i.name){let e=!1;for(let n=0;n<this.variables.length;n++)if(t.name===this.variables[n].name){e=!0;break}if(!e)return"Variable dependency not found. Variable="+i.name+", dependency="+t.name}s[t.name]={value:null},r.fragmentShader="\nuniform sampler2D "+t.name+";\n"+r.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let e=this.currentTextureIndex,t=0===this.currentTextureIndex?1:0;for(let n=0,i=this.variables.length;n<i;n++){let i=this.variables[n];if(null!==i.dependencies){let t=i.material.uniforms;for(let n=0,r=i.dependencies.length;n<r;n++){let r=i.dependencies[n];t[r.name].value=r.renderTargets[e].texture}}this.doRenderTarget(i.material,i.renderTargets[t])}this.currentTextureIndex=t},this.getCurrentRenderTarget=function(e){return e.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(e){return e.renderTargets[0===this.currentTextureIndex?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let e=this.variables;for(let t=0;t<e.length;t++){let n=e[t];n.initialValueTexture&&n.initialValueTexture.dispose();let i=n.renderTargets;for(let e=0;e<i.length;e++)i[e].dispose()}},this.addResolutionDefine=c,this.createShaderMaterial=h,this.createRenderTarget=function(n,r,s,a,o,l){return new Bi(n=n||e,r=r||t,{wrapS:s=s||un,wrapT:a=a||un,minFilter:o=o||pn,magFilter:l=l||pn,format:An,type:i,depthBuffer:!1})},this.createTexture=function(){let n=new Float32Array(e*t*4),i=new Bl(n,e,t,An,xn);return i.needsUpdate=!0,i},this.renderTexture=function(e,t){a.passThruTexture.value=e,this.doRenderTarget(o,t),a.passThruTexture.value=null},this.doRenderTarget=function(e,t){let i=n.getRenderTarget(),a=n.xr.enabled,c=n.shadowMap.autoUpdate,h=n.outputEncoding,u=n.toneMapping;n.xr.enabled=!1,n.shadowMap.autoUpdate=!1,n.outputEncoding=Vn,n.toneMapping=0,l.material=e,n.setRenderTarget(t),n.render(r,s),l.material=o,n.xr.enabled=a,n.shadowMap.autoUpdate=c,n.outputEncoding=h,n.toneMapping=u,n.setRenderTarget(i)}}},SB=new $r,_B=new ji,TB=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||3!==t.attributes.position.itemSize)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,n=new Float32Array(e.count/3);for(let r=0;r<e.count;r+=3){let i=1;t&&(i=t.getX(r)+t.getX(r+1)+t.getX(r+2)),SB.a.fromBufferAttribute(e,r),SB.b.fromBufferAttribute(e,r+1),SB.c.fromBufferAttribute(e,r+2),i*=SB.getArea(),n[r/3]=i}this.distribution=new Float32Array(e.count/3);let i=0;for(let r=0;r<n.length;r++)i+=n[r],this.distribution[r]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,n){let i=this.distribution[this.distribution.length-1],r=this.binarySearch(this.randomFunction()*i);return this.sampleFace(r,e,t,n)}binarySearch(e){let t=this.distribution,n=0,i=t.length-1,r=-1;for(;n<=i;){let s=Math.ceil((n+i)/2);if(0===s||t[s-1]<=e&&t[s]>e){r=s;break}e<t[s]?i=s-1:n=s+1}return r}sampleFace(e,t,n,i){let r=this.randomFunction(),s=this.randomFunction();return r+s>1&&(r=1-r,s=1-s),SB.a.fromBufferAttribute(this.positionAttribute,3*e),SB.b.fromBufferAttribute(this.positionAttribute,3*e+1),SB.c.fromBufferAttribute(this.positionAttribute,3*e+2),t.set(0,0,0).addScaledVector(SB.a,r).addScaledVector(SB.b,s).addScaledVector(SB.c,1-(r+s)),void 0!==n&&SB.getNormal(n),void 0!==i&&void 0!==this.colorAttribute&&(SB.a.fromBufferAttribute(this.colorAttribute,3*e),SB.b.fromBufferAttribute(this.colorAttribute,3*e+1),SB.c.fromBufferAttribute(this.colorAttribute,3*e+2),_B.set(0,0,0).addScaledVector(SB.a,r).addScaledVector(SB.b,s).addScaledVector(SB.c,1-(r+s)),i.r=_B.x,i.g=_B.y,i.b=_B.z),this}};function PB(e,t){let n=e,i=new Float32Array(4*t*t);for(let s=0;s<t*t;s++)i[4*s]=n[3*s],i[4*s+1]=n[3*s+1],i[4*s+2]=n[3*s+2],i[4*s+3]=0;let r=new Bl(i,t,t,An,xn);return r.needsUpdate=!0,r}var MB="\n\n  // Linear Fade In\n  float linearFadeIn(float t) {\n    return t;\n  }\n\n\n  // linear fade out\n  float linearFadeOut(float t) {\n    return 1.0 - t;\n  }\n  \n  float linearInOut(float t) {\n    return t < 0.5 ? t :  (1.0 - t);  \n  }\n\n    // lerp\n    float lerp(float a, float b, float t) {\n      return a + (b - a) * t;\n    }\n\n  // Ease In Out Quart\n  float exponentialInOut(float t) {\n    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :\n    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :\n    1.0;\n   }\n\n  // constant\n  float constant(float t) {\n    return 1.0;\n  } \n",NB=`\n  uniform sampler2D uPosition;\n  uniform float uSize;\n  uniform float uSizeEnd;\n  uniform vec3 uWorldOffset;\n  uniform vec4 uWorldQuaternion;\n  // Billboard Behavior - Currently at Zero, but we can change that\n  uniform float uRotation;\n  uniform float uRotationEnd;\n  uniform vec2 center;\n\n  // Randomness\n  uniform float uRandScaleFactor;\n  uniform float uRandRotationFactor;\n\n  attribute vec2 ref;\n\n  varying float v_LifeLeft;    // normalized lifetime 1 to 0\n  varying vec2 vUv;\n  varying vec2 vRef;\n\n  \n\nfloat rand(vec3 co){\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n}\n\nvec3 applyForce(vec3 force, float mass) {\n  vec3 acceleration = force / mass;\n    \n  return acceleration;\n}\n\n  ${MB}\n`,IB="\n  uniform vec4 uColor;                // start color\n  uniform vec4 uColor2;               // end color\n  uniform sampler2D uTexture;         // texture\n  varying float v_LifeLeft;   // normalized lifetime 1 to 0\n  varying vec2 vUv;\n  varying vec2 vRef;\n\n  float random(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n  }\n  "+MB+"  \n  \nvec3 rgb2xyz (in vec3 rgb) {\n    float r = rgb.r;\n\tfloat g = rgb.g;\n\tfloat b = rgb.b;\n\n\tr = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);\n\tg = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);\n\tb = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);\n\n\tfloat x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);\n\tfloat y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);\n\tfloat z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);\n    \n    vec3 xyz = vec3(\n        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,\n        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,\n        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0\n    );\n    return(xyz);\n}\n\nvec3 xyz2lab (in vec3 xyz) {\n\tfloat x = xyz.x / 95.047;\n\tfloat y = xyz.y / 100.0;\n\tfloat z = xyz.z / 108.883;\n\n\tx = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);\n\ty = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);\n\tz = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);\n\n    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));\n    return(lab);\n}\n\nvec3 rgb2lab(in vec3 rgb) {\n    vec3 xyz = rgb2xyz(rgb);\n    vec3 lab = xyz2lab(xyz);\n    return(lab);\n}\n\nvec3 xyz2rgb (in vec3 xyz) {\n\tfloat x = xyz.x / 100.0;\n\tfloat y = xyz.y / 100.0;\n\tfloat z = xyz.z / 100.0;\n\t\n    \n\tfloat r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);\n\tfloat g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);\n\tfloat b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);\n\n\tr = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;\n\tg = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;\n\tb = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;\n\n\tr = min(max(0.0, r), 1.0);\n\tg = min(max(0.0, g), 1.0);\n\tb = min(max(0.0, b), 1.0);\n\n\treturn(vec3(r, g, b));\n}\n\nvec3 lab2xyz (in vec3 lab) {\n    float l = lab.x;\n\tfloat a = lab.y;\n\tfloat b = lab.z;\n\n  \tfloat y = (l + 16.0) / 116.0;\n\tfloat x = a / 500.0 + y;\n\tfloat z = y - b / 200.0;\n\n\tfloat y2 = pow(y, 3.0);\n\tfloat x2 = pow(x, 3.0);\n\tfloat z2 = pow(z, 3.0);\n\n  \ty = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;\n\tx = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;\n\tz = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;\n\n\tx *= 95.047;\n\ty *= 100.0;\n\tz *= 108.883;\n\n\treturn(vec3(x, y, z));\n}\nvec3 lab2rgb (in vec3 lab) {\n    vec3 xyz = lab2xyz(lab);\n    vec3 rgb = xyz2rgb(xyz);\n    return(rgb);\n}\n\n\n\n",OB=class extends Bs{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],tM.startContext(tM.globalContext),this.lightLayer=new II(0,"",{...Bx.defaultData("light","phong"),visible:!1},new kN,{},t.shared),tM.endContext(tM.globalContext),this.build()}updateState(e){void 0!==e.coloring&&(this.isColoringRandom="random"===e.coloring),void 0!==e.color&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),void 0!==e.color2&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),void 0!==e.size&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),void 0!==e.ease&&(this.easeOpacity=e.ease,this.build()),void 0!==e.easeSize&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new WM;return e.needsJitter=this.needsJitter,e.addFragmentParsCode("\nlayout(location = 1) out vec4 gVelocity;\n"),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode("\n    // Discard fully transparent pixels \n    if (gl_FragColor.a <= 0.0) discard;\n\n    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);\n"),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(NB),e.addFragmentParsCode(IB),e.addVertexFinalCode((e=>{let{easeSize:t="linearFadeOut"}=e;return`\n  vUv = uv;  \n  vRef = ref;\n  // Normalized LifeTime 1 to 0\n  float lifeLeft = texture2D(uPosition, ref).w;\n  v_LifeLeft = lifeLeft;\n  // Position From DataTexture Simulation\n  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;\n  // Apply World Quaternion\n  pos = applyQuaternionToVector(uWorldQuaternion, pos);  \n            \n  #ifdef  USE_SIZE_END\n    // Scaled Over Time\n    float t = 1. - lifeLeft;\n    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd\n    vec3 scaledPosition = position * vec3(currentSize);\n  #else\n    // Change Size Behavior over LifeTime\n    float easeSize = ${t}(1. - lifeLeft);\n    // Scaled Over Time\n    vec3 scaledPosition = position * vec3(uSize * easeSize);\n  #endif\n\n  // Billboard Behavior\n  vec2 scale;\n  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    \n  // Randomness \n  float randRef = rand(ref);\n  scale *= (1.0 - (uRandScaleFactor * randRef));\n  // Rotation\n  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);\n  float originalRotation = (1.0 - uRotation) * 2.0 * PI;\n  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;\n  // OverTime\n  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);\n\n  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;\n  vec2 rotatedPosition;\n  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;\n  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;\n  \n  mat4 instanceMatrix = mat4(\n    vec4(1.0, 0.0, 0.0, 0.0),\n    vec4(0.0, 1.0, 0.0, 0.0),\n    vec4(0.0, 0.0, 1.0, 0.0),\n    vec4(pos.x, pos.y, pos.z, 1.0)\n  );  \n\n  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n  mvPosition.xy += rotatedPosition;\n  gl_Position = projectionMatrix  * mvPosition;   \n`})({easeSize:this.easeSize})),e.addFragmentFinalCode((e=>{let{easeOpacity:t="linearFadeOut"}=e;return`  \n  // if Particle is dead, hide it\n  if (v_LifeLeft <= 0.005 ) {\n    discard;\n  }\n\n  #ifdef USE_RANDOM_COLORING\n    float randVal = random(vRef); // Generate a random value based on the reference\n    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors\n  #else\n    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);\n  #endif\n\n  // Opacity over Life Time\n  float finalAlpha = ${t}(1. - v_LifeLeft);  \n  vec4 textureColor = texture2D(uTexture, vUv).rgba; \n  finalColor = textureColor.rgb * color.rgb;\n  finalAlpha = color.a * textureColor.a * finalAlpha;\n  \n  gl_FragColor = vec4(finalColor, finalAlpha);     \n\n`})({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms={...e.uniforms,...this.uniforms},this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach((e=>e.dispose())),super.dispose()}},DB=class{constructor(e,t,n,i){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=n,this.textureSize=function(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}(t);this.targetMesh="Mesh"===i?.type&&i?i:this.getMesh(n,1);let{positions:r,dataTexture:s,dataTextureNormals:a}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(n,1));this.positionsTexture=s,this.positionsAttribute=r,this.directionsTexture=a}createPositions(e,t){let{positions:n,normals:i}=function(e,t){let n=new Ns(e.geometry,e.material),i=[],r=[],s=new ji,a=new ji;null!==n.geometry.index&&(n.geometry=n.geometry.toNonIndexed());let o=new TB(n).build();for(let l=0;l<t;l++)o.sample(s,a),i.push(s.x,s.y,s.z),r.push(a.x,a.y,a.z);return{positions:new Float32Array(i),normals:new Float32Array(r)}}(t,e*e);return{dataTexture:PB(n,e),positions:n,dataTextureNormals:PB(i,e)}}getMesh(e,t){let n=null;switch(e){case"SphereEmitterShape":n=new ah(.5*t,32,32);break;case"TorusEmitterShape":n=new oh(.5*t,.3,15,40);break;case"ConeEmitterShape":n=new Tc(t,t,15);break;case"BoxEmitterShape":n=new Os(t,t,t);break;case"PlaneEmitterShape":n=new $s(t,t),n.rotateX(-Math.PI/2);break;default:n=new ah(t,32,32)}return new Ns(n,new ns({color:16711680}))}applyToShader(e,t){this.size=(new ji).fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function LB(e){let t={...e},n=Ex.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let i={...n.shape,...t.shape},r={...n.renderMaterial,...t.renderMaterial};return{...n,...t,shape:i,renderMaterial:r}}var RB=class extends Vr{constructor(e,t){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new Uh,this.currentWorldPosition=new ji,this.systemQuaternion=new Fi,this.worldGravity=new ji(0,0,0),this.directionAxis=new ji(0,0,0),this.colliderV3=new ji(0,0,0),this.colliderQuaternion=new Fi(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let n=t.data;this.material=new OB(n.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:n.renderMaterial.color},uColor2:{value:n.renderMaterial.color2},uPosition:{value:new ji(0,0,0)},uEmissionData:{value:new ji(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new ji(0,0,0)},uWorldQuaternion:{value:new ki(0,0,0,1)},uRandScaleFactor:{value:n.randomScale??0},uRandRotationFactor:{value:n.randomRotation??0},uRotation:{value:n.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:n.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,n.renderMaterial.texture),this.init(n)}setTexture(e,t){let n=t.data;if("string"==typeof t){let n=this.shared.image(t),i=new Ri(n.img);return i.needsUpdate=!0,void(e.uTexture.value=i)}if("string"!=typeof n){let t=new Image;t.onload=()=>{let n=new Ri(t);n.needsUpdate=!0,e.uTexture.value=n};let i=new Blob([n],{type:"image/*"}),r=URL.createObjectURL(i);t.src=r}}updateGeometryAttributes(e,t){let n=function(e){let t=new Float32Array(e*e*2);for(let n=0;n<e;n++)for(let i=0;i<e;i++){let r=n*e+i;t[2*r+0]=n/(e-1),t[2*r+1]=i/(e-1)}return t}(t);!this.emitterShape?.positionsAttribute||e.geometry.setAttribute("ref",new jl(n,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset)return void this.reset();this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let n=1e3/t,i=this.targetFPS/n,r=this.previousRatio+(i-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=r,this.previousRatio=r;let s=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=s,this.material.uniforms.uPosition.value=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT)?.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0],t=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(e.destroyedInAction&&t&&this.init(LB({...this.system.data,colliderEntityId:null})),!e||e.destroyedInAction)return;e.getWorldPosition(this.colliderV3),0===this.colliderV3.y&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let n=e.data.size;this.colliderV3.fromArray(n),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;"size"===t[2]&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),"sizeEnd"===t[2]&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let n=(e,t)=>{let n=[...this.system.data.shape.size];n[e]=t,this.updateParticleState({shape:{...this.system.data.shape,size:n}})};"shape_size_0"===t[2]&&n(0,e),"shape_size_1"===t[2]&&n(1,e),"shape_size_2"===t[2]&&n(2,e),"speed"===t[2]&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/10),"gravity"===t[2]&&this.worldGravity.set(0,e/100,0),"noiseStrength"===t[2]&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),"noiseScale"===t[2]&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),"direction_x"===t[2]&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),"direction_y"===t[2]&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),"direction_z"===t[2]&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState({...e,size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){if(this.positionSimRT&&this.velocitySimRT){if(this.shouldReInitGPUCompute(e)&&this.init(LB(this.system.data)),void 0!==e.life&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),void 0!==e.speed&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/10),void 0!==e.collisionBounce&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),void 0!==e.noiseStrength&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),void 0!==e.noiseScale&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),void 0!==e.noiseSeed&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),void 0!==e.randomMass&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),void 0!==e.renderMaterial?.size){let t=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(t)}if(void 0!==e.renderMaterial?.spriteRotation&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),void 0!==e.shape){let t=e.shape.size??this.system.data.shape.size,n=[Number(this.shared.getVariable(t[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(t[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(t[2],[this.uuid,"particles","shape_size_2"]))],i={...LB(this.system.data).shape,size:n};this.emitterShape?.applyToShader(this.positionSimRT.material.uniforms,i)}if(void 0!==e.gravity&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),void 0!==e.direction){let t=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(t),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}void 0!==e.randomRotation&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),void 0!==e.randomScale&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(void 0!==e.forceIntensity&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),void 0!==e.forceDambing&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*ui.DEG2RAD,Number(e[1])*ui.DEG2RAD,Number(e[2])*ui.DEG2RAD],n=new Tr(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(n).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:n,colliderEntityId:i,shape:r,emitTimeDuration:s,emitTimeCycle:a,life:o,directionMode:l,noiseType:c}=e;return void 0!==t||void 0!==n||i||null===i||void 0!==a||void 0!==r||void 0!==o||void 0!==s||void 0!==l||void 0!==c}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:"infinity"===e.emitTimeCycle?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to 100000."),this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval((()=>{if(this.emitterShape){if(isNaN(this.emitterShape.positionsTexture.source.data.data[0]))return void this.init(e);clearInterval(t)}}),100);if(!this.emitterShape)return;let n=new AB(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),i=this.updateSimulationDefinition(e),r=n.addVariable("uCurrentPosition",i+"\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\nuniform sampler2D uOriginalPosition;\nuniform float uTime;\nuniform float uSpeed;     // update speed of the particles\nuniform vec3 uWorldOffset;    \nuniform vec4 uWorldQuaternion;\nuniform float uMaxLifeTime;\nuniform vec3 uEmitterSize;\nuniform float uFPSRatio;     // 1  for 60 FPS\n\nfloat random (vec2 st) {\n    return fract(sin(dot(st.xy,\n        vec2(12.9898,78.233)))*\n        43758.5453123);\n}\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n}\n\nvec3 applyForce(vec3 force, float mass) {\n    vec3 acceleration = force / mass;\n    \n    return acceleration;\n  }\n  \n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;\n    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0\n    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active\n    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted\n    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);\n    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;\n    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided\n    float lifeTime = uMaxLifeTime;\n\n    // Calculate the position adjustment based on collision\n    //     if (collisionFlag > .5) {  \n    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0\n    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise\n    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);\n\n    // Update position based on collision or normal movement\n    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);\n    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);\n\n    // EMISSION RATE - BIRTH\n    // if (isSpawning == 1.0) {\n    // Better Approach to avoid If statement\n    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;\n    originalPosition = mix(originalPosition, newPosition, isSpawning);\n    position = mix(position, originalPosition, isSpawning);;\n    timeStart = mix(timeStart, uTime, isSpawning);\n\n    // Calculate timeLeft for life normalization\n    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);\n    float life_Normalize = timeLeft / lifeTime;\n\n    // Use isActive to blend between the calculated color and black\n    vec4 activeColor = vec4(position, life_Normalize);\n    // if (isActive == 1.0) {\n    gl_FragColor = mix(vec4(0.0), activeColor, isActive);\n\n}\n",this.emitterShape.positionsTexture),s=n.addVariable("uCurrentVelocity",i+"\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\nuniform sampler2D uOriginalPosition;\nuniform sampler2D uDirections;     \nuniform vec3 uDirectionsAxis;\nuniform vec4 uWorldQuaternion;\nuniform vec3 uGravity;        \nuniform float uNoiseStrength;     // Variation of the noise\nuniform float uNoiseScale;        // Scale of the noise\nuniform float uNoiseSeed;         // Seed of the noise\nuniform float particleSize;\nuniform float uSpeed;     // update speed of the particles\nuniform float uRandomMassFactor;\n\n// COLLIDER\nuniform vec3 uColliderPos;                // Collider Position\nuniform vec3 uColliderSize;               // Collider Dimension\nuniform vec4 uColliderQuaternion;         // Collider Rotation\nuniform vec4 uColliderQuaternionInvert;   // Collider Rotation\nuniform float uBounce;                    // Bounce factor\nuniform float uForceDamping;\nuniform float uForceIntensity;\n\n\n\n\n    vec3 mod289(vec3 x) {\n      return x - floor(x * (1.0 / 289.0)) * 289.0;\n    }\n    \n    vec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n    }\n    \n    vec4 permute(vec4 x) {\n        return mod289(((x*34.0)+1.0)*x);\n    }\n    \n    vec4 taylorInvSqrt(vec4 r)\n    {\n    return 1.79284291400159 - 0.85373472095314 * r;\n    }\n    \n    vec3 fade(vec3 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n    float snoise(vec3 v)\n    {\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n    \n    // Permutations\n    i = mod289(i);\n    vec4 p = permute( permute( permute(\n                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3  ns = n_ * D.wyz - D.xzx;\n    \n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n    \n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n    \n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n    \n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n    \n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n    \n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n    \n    //Normalise gradients\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    \n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                  dot(p2,x2), dot(p3,x3) ) );\n    }\n    \n    vec3 snoiseVec3( vec3 x ){\n    \n      float s  = snoise(vec3( x ));\n      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n      vec3 c = vec3( s , s1 , s2 );\n      return c;\n    \n    }\n    \n      \n    vec3 curlNoise( vec3 p, float seed){\n      p += seed;\n      const float e = .1;\n      vec3 dx = vec3( e   , 0.0 , 0.0 );\n      vec3 dy = vec3( 0.0 , e   , 0.0 );\n      vec3 dz = vec3( 0.0 , 0.0 , e   );\n    \n      vec3 p_x0 = snoiseVec3( p - dx );\n      vec3 p_x1 = snoiseVec3( p + dx );\n      vec3 p_y0 = snoiseVec3( p - dy );\n      vec3 p_y1 = snoiseVec3( p + dy );\n      vec3 p_z0 = snoiseVec3( p - dz );\n      vec3 p_z1 = snoiseVec3( p + dz );\n    \n      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n    \n      const float divisor = 1.0 / ( 2.0 * e );\n      return normalize( vec3( x , y , z ) * divisor );\n    \n    }\n\n\n// Classic Perlin noise\nfloat cnoise(vec3 P)\n{\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod289(Pi0);\n  Pi1 = mod289(Pi1);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 * (1.0 / 7.0);\n  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 * (1.0 / 7.0);\n  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n  return 2.2 * n_xyz;\n}\n\n\nvec3 fbm_vec3(vec3 p, float frequency, float offset)\n{\n  return vec3(\n    cnoise((p+vec3(offset))*frequency),\n    cnoise((p+vec3(offset+20.0))*frequency),\n    cnoise((p+vec3(offset-30.0))*frequency)\n  );\n}\n\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec3 applyQuaternionToVector( vec4 q, vec3 v ){\n    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );\n } \nvec3 applyForce(vec3 force, float mass) {\n  vec3 acceleration = force / mass;\n  \n  return acceleration;\n}\n\nvec4 conjugate(vec4 q) {\n  return vec4(q.w, -q.x, -q.y, -q.z);\n}\n\n// Function to compute the normal of the ellipsoid at a given point\nvec3 ellipsoidNormal(vec3 p, vec3 radii) {\n  return normalize(p / (radii * radii));\n}\n\nfloat friction = .3;\n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;\n    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;\n    float timeLeft = texture2D( uCurrentPosition, vUv ).w;\n    vec3 directions = texture2D( uDirections, vUv ).xyz;    \n    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;\n    float mass = rand(originalPosition.xy) * 0.5 + 0.5;\n    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active\n    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision\n\n    // Randomness Mass\n    mass = (1.0 - (uRandomMassFactor * mass));\n    \n    if (isActive == 1.0) {\n      // **************************************************************\n      // FORCES NOISES\n      // **************************************************************\n      #ifdef USE_CURL_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {\n          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;\n        }\n      #endif\n      // **************************************************************\n      #ifdef USE_SIMPLEX_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);\n          velocity *= uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {\n          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);\n        }\n      #endif\n      // ************************************************************** \n      #ifdef USE_FBM_NOISE\n        if (uNoiseScale > 0.0 ) {\n          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);\n          velocity *= uSpeed;\n        }\n        // Variation of the noise Over Time\n        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      \n          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;\n        }\n      #endif\n\n      // COLLIDER\n      \n  #ifdef USE_COLLIDER\n    float restitution = max(uBounce * 2., .01); // Energy Loss\n    // SPHERE COLLIDER\n    // **************************************************************\n    #ifdef USE_SPHERE_COLLIDER       \n      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)\n      vec3 radii = uColliderSize;\n      // Adjust position relative to collider\n      vec3 relPos = position - uColliderPos;\n      // Apply rotation of the collider to the relative position\n      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n      // Scale relative position by radii (for ellipsoid collision detection)\n      vec3 scaledPos = relPos / radii;\n      // Calculate ellipsoidal distance\n      float dist = length(scaledPos); // Distance in terms of ellipsoid\n      \n      // Check for collision\n      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {\n          // Compute the normal at the collision point, accounting for particle size\n        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          \n        // Compute the normal at the collision point\n        vec3 normal = ellipsoidNormal(adjustedPos, radii);\n        // Rotate the normal back to world space\n        normal = applyQuaternionToVector(uColliderQuaternion, normal);\n        // Reflect the velocity vector off the normal\n        velocity = reflect(velocity, normal) * restitution;\n\n        collisionFlag = 1.0;\n      } else {\n        collisionFlag = 0.0;\n      }\n    #endif\n\n    // BOX COLLIDER or PLANE COLLIDER \n    // **************************************************************\n    #ifdef USE_BOX_COLLIDER\n      // Box dimensions and repulsion variables\n      vec3 boxHalfSize = uColliderSize / 2.0;\n      // Convert world position to box's local space\n      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n      // Collision detection\n      vec3 localDistance = abs(localPos) - boxHalfSize;\n      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    \n\n      // Collision Detected\n      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      \n        // Find the nearest face normal for bounce direction\n        vec3 normal;\n        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {\n            normal = vec3(sign(localPos.x), 0.0, 0.0);\n        } else if (localDistance.y > localDistance.z) {\n            normal = vec3(0.0, sign(localPos.y), 0.0);\n        } else {\n            normal = vec3(0.0, 0.0, sign(localPos.z));\n        }            \n        // Rotate normal back to world space\n        normal = applyQuaternionToVector(uColliderQuaternion, normal);      \n        // Reflect velocity and apply repulsion force\n        velocity = reflect(velocity, normal) * restitution;\n        \n        collisionFlag = 1.0;\n      } else {\n        collisionFlag = 0.0;\n      }\n    #endif      \n  #endif      \n  // END COLLIDER    \n\n      // ATTRACTION\n      \n  #ifdef USE_ATTRACTOR\n\n      #ifdef USE_SPHERE_COLLIDER      \n        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)\n        vec3 radii = uColliderSize;\n        // Adjust position relative to collider\n        vec3 relPos = position - uColliderPos;\n        // Apply rotation of the collider to the relative position\n        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n        // Scale relative position by radii (for ellipsoid collision detection)\n        vec3 scaledPos = relPos / radii;\n        // Calculate ellipsoidal distance\n        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid\n        float insideCheck = 1.0;\n\n      #endif\n\n\n      #ifdef USE_BOX_COLLIDER\n        // Box dimensions\n        vec3 boxHalfSize = uColliderSize / 2.0;\n        // Convert world position to box's local space\n        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n        vec3 localDistance = abs(localPos) - boxHalfSize;\n        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));\n        float insideCheck = particleSize;\n      #endif      \n  \n      // Apply vortex force inside the Helper\n      #ifdef USE_FORCE_LOCAL_SPACE\n        if (distToSurface <= insideCheck ) {    \n            // Define parameters for the attractor field\n            #ifdef USE_SPHERE_COLLIDER      \n              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed\n            #endif\n\n            #ifdef USE_BOX_COLLIDER\n              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed\n              #endif\n\n            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)\n          \n            // Use the same radii calculation code as for the collider\n            vec3 attractorRadii = uColliderSize;\n            // Adjust position relative to attractor center\n            vec3 relPos = position - uColliderPos;\n            // Apply rotation of the collider to the relative position\n            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            \n            // Scale relative position by radii (for ellipsoid attraction)\n            vec3 scaledPos = relPos / attractorRadii;\n\n            // Calculate ellipsoidal distance as attractor radius\n            float attractorRadius = length(scaledPos);\n            // Calculate the distance from the attractor center\n            vec3 relativePosition = position - uColliderPos;\n            // Calculate the force vector towards the attractor center\n            vec3 attractorForce = normalize(relativePosition) * attractorStrength;\n            // Apply the attractor force to the particle\n            velocity -= attractorForce;\n            // Attenuate the particle's velocity\n            velocity *= attractorDamping;\n        }\n      #else \n            // Calculate the distance from the attractor center\n            vec3 relativePosition = position - uColliderPos;\n            // Calculate the force vector towards the attractor center\n            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;\n            // Apply the attractor force to the particle\n            velocity -= attractorForce;\n            // Attenuate the particle's velocity\n            velocity *= uForceDamping;\n      #endif    \n  #endif      \n  \n      // VORTEX\n      \n  #ifdef USE_VORTEX\n    // Box dimensions\n    vec3 boxHalfSize = uColliderSize / 2.0;\n    // Convert world position to box's local space\n    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      \n    vec3 localDistance = abs(localPos) - boxHalfSize;\n    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));\n\n    // Apply vortex force inside the box\n    if (distToSurface <= particleSize) {\n      float vortexStrength = uForceIntensity;\n      vec3 localTopCenter = vec3(0.0, 0., 0.0);\n\n      // Transform the local top center to the world space\n      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);\n      // Calculate the vector from particle to vortex center\n      vec3 vortexVector = vortexCenter - position;\n\n      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector\n      // Note: important to add a tiny z component to the up vector to avoid instability\n      vec3 upVector = vec3(0.0, 1.0, 0.01);\n      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));\n      rotationAxis = normalize(rotationAxis);\n\n      // Add rotational component to velocity\n      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; \n\n      vec3 rotationVelocity = rotationAxis * rotationSpeed;\n      // velocity += rotationVelocity * 0.005 ;\n      velocity = rotationVelocity * 0.005 ;\n\n      // Calculate vortex force\n      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;\n      // Apply the vortex force to the particle\n      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);\n      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);\n    }\n  #endif      \n\n    } \n    // End isActive\n\n    // SPAWN BIRTH \n    // **************************************************************\n    // if (isSpawning == 1.)\n    #ifdef USE_NORMALS\n      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);\n    #else\n      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    \n    #endif\n    \n    // if (collisionFlag == 0.0)\n    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);\n\n    gl_FragColor = vec4(velocity, collisionFlag);\n}\n",this.emitterShape.directionsTexture),a=n.addVariable("uCurrentEmissionRate","\n// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU\n// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU\n\nuniform sampler2D uIndex; // Texture with corresponding index\nuniform float uLastIndexEmitted; // Last emitted index\nuniform float uParticlesToEmit; // Number of particles to emit on that frame\nuniform float uTime;\n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    float particleIndex = texture(uIndex, vUv).x;\n    float timeLeft = texture2D( uCurrentPosition, vUv ).w;\n    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active\n    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;\n\n\n    // ********** Detect Colision to Create a flag and use it in position **********\n    // We are doing this here, so\n\n    // ********** Emit Particles **********\n    // X = isSpawning 0.0 or 1.0\n    // Y = isActive 0.0 or 1.0\n    // Check if the vertex index is between the first value and the last value\n    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {\n    //     // Emit a particle by writing 1 to the red channel of the color output\n    //     // r: 1. == emit the particle\n    //     // g: 1. == particle is now active\n    //     timeStart = uTime;\n    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);\n    // } else {\n    //     // The Particle is either already emitted or not in the range of the particles to emit\n    //     // Do not emit a particle by writing 0 to the red channel of the color output        \n    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);\n    // }\n    // Determine if the particle is within the emission range\n    float emitLowerBound = step(uLastIndexEmitted, particleIndex);\n    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);\n    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise\n\n    // Set timeStart and color\n    timeStart = mix(timeStart, uTime, emitParticle);\n    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);\n\n\n}\n",function(e){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=0,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let n=new Bl(t,e,e,An,xn);return n.needsUpdate=!0,n}(this.emitterShape.textureSize));n.setVariableDependencies(r,[r,s,a]),n.setVariableDependencies(s,[r,s,a]),n.setVariableDependencies(a,[r,s,a]);let o=function(e){let{size:t}=e,n=new Float32Array(4*t*t);for(let r=0;r<t*t;r++)n[4*r]=r,n[4*r+1]=0,n[4*r+2]=0,n[4*r+3]=0;let i=new Bl(n,t,t,An,xn);return i.needsUpdate=!0,i}({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new ji(0,0,0)},uWorldQuaternion:{value:new ki(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new ji(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};r.material.uniforms=l;let c=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(c),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let h=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),u={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new ki(0,0,0,1)},uColliderPos:{value:new ji(0,0,0)},uColliderSize:{value:new ji(0,0,0)},uForceIntensity:{value:h?h.forceIntensity:0},uForceDamping:{value:h?h.forceDambing:0},uColliderQuaternion:{value:new ki(0,0,0,1)},uColliderQuaternionInvert:{value:new ki(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/10}};s.material.uniforms=u;let d={uIndex:{value:o},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};a.material.uniforms=d;let p=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],f={...LB(this.system.data).shape,size:p};this.emitterShape.applyToShader(r.material.uniforms,f),n.init(),this.gpuCompute=n,this.positionSimRT=r,this.velocitySimRT=s,this.emissionRateSimRT=a,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){return[Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]))]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let t=this.system.getColliderData(e.colliderEntityId);switch(t?.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0}let n=t?.colliderType;"sphere"===n&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),"box"===n&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),"helper"===t?.forceRange&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}"normals"===e.directionMode&&(this.simFeaturesDefinition.USE_NORMALS=!0),"curl"===e.noiseType&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),"simplex"===e.noiseType&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),"fbm"===e.noiseType&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[n,i]of Object.entries(this.simFeaturesDefinition))i&&(t+=`#define ${n}\n`);return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let n=new ji(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if("MeshEmitterShape"===e.type){let i=null;return this.system.context.scene.traverseEntity((t=>{t.uuid===e.fromMeshId&&(i=t)})),i?new DB(n,t,e.type,i):new DB(n,t,"SphereEmitterShape")}return new DB(n,t,e.type)}createPrimaryEmitter(e){let t,n=e*e;return t=new Kl(new $s(1,1,1),this.material,n),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount(e){let{birthRatePerSecond:t,particleMaxLifeTime:n,loopDuration:i=0}=e;return Math.ceil(t*(n+i))}dispose(){!this.gpuCompute||(this.rootObject?.parent?.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),this.emitterShape?.dispose())}GoEmitSomeParticles(e,t){let n=e-this.lastEmitTime,i=1/t;if(n>=i){let t=Math.max(1,Math.floor(n/i));return this.lastEmitTime=e,this.emittedParticlesAmount+t>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=t,t}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(LB(this.system.data))}startEmitting(e){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=e}stopEmitting(){this.isEmitting=!1}},kB=class extends $P{constructor(e,t,n){super(e,t),this.type="ParticleSystem",this.geometry=new gs,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=e=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(e))},this.context=n,this.data={...t,...LB(t)},this.geometry.setAttribute("position",new ls([],3)),this.material=new ns({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new RB(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t="one_time"===this.data.emitTimeCycle;if(("loop"===this.data.emitTimeCycle||t)&&this.currentLoopTime>1e3*this.data.emitTimeDuration&&(this.stopped||(this.stop(),t||this.start(1e3*this.data.emitTimeDelay))),this.emitter&&this.started){let t=this.actualTime/1e3;this.emitter.update(t,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some((t=>t.identity===e))}getColliderData(e){let t=this.colliderEntities.find((t=>t.identity===e));return t?t.data:null}updateByPatchedOp(e,t,n){super.updateByPatchedOp(e,t,n),Zy(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...Ey.drop(e,1).props}}),Zy(e.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...Ey.drop(e,1).props}})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(void 0!==e.colliderEntityId&&null!==e.colliderEntityId){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}null===e.colliderEntityId&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.currentLoopTime=0,e?this.timeoutId=window.setTimeout((()=>{this.start(0)}),e):(this.started=!0,this.stopped=!1,this.isFrozen=!1,this.emitter?.startEmitting(this.actualTime/1e3))}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){this.stopped=!0,this.currentLoopTime=0,this.emitter?.stopEmitting(),clearTimeout(this.timeoutId)}reset(){this.started=!1,this.stopped=!1,this.emitter?.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};var BB=function(){try{let e=window.location.href;if(e.includes("reducesubdiv=")){let t=e.indexOf("reducesubdiv=")+13;return parseInt(e.slice(t,t+1))}}catch{}}();function UB(e,t,n){return console.assert(void 0!==t.type),"Mesh"===t.type?function(e,t,n){let i;return void 0!==BB&&(t?.geometry?.subdivisions??0)>BB&&(console.log("reducing subdivisions",t.name,t.geometry.subdivisions),t.geometry.subdivisions=BB),"TextGeometry"===t.geometry.type?new cD(e,t,n):"InputGeometry"===t.geometry.type?new vB(e,t,n):(i="SubdivGeometry"===t.geometry.type?new zO(e,t,n):"PathGeometry"===t.geometry.type?new gB(e,t,n):"VectorGeometry"===t.geometry.type?new mB(e,t,n):"BooleanGeometry"===t.geometry.type?new qD(e,t,n):"ShapeBlendGeometry"===t.geometry.type?new GB(e,t,n):"UIGeometry"===t.geometry.type?new CB(e,t,n):new DO(e,t,n),i)}(e,t,n):"Empty"===t.type?new nL(e,t):"Particle"===t.type?new kB(e,t,n):"ParticleCollider"===t.type?new iL(e,t,n):"Splat"===t.type?new nL(e,t):"Bone"===t.type?new EB(e,t):"Page"===t.type?new pB(e,t,n):"PointLight"===t.type?new fB(e,t,n):"SpotLight"===t.type?new pk(e,t,n):"DirectionalLight"===t.type?new ck(e,t,n):"Component"===t.type||"Instance"===t.type?new yB(e,t,n):dx.is(t.type)?new jD(e,t):(console.error(t),new nL(e,t))}vS.createEntity=UB,vS.changeEntityProptotype=function(e,t,n){let i=UB(e.identity,t,n),r=e.children,s=e.attachedPaths,a=e.parent,o=e.component,l=e.instances,c=e.overrideData,h=e.uuid,u=e.stateSelection;e.dispose();for(let d of Object.keys(e))delete e[d];Object.setPrototypeOf(e,Object.getPrototypeOf(i));for(let d of Object.keys(i))e[d]=i[d];e.children=[...e.children,...r],e.attachedPaths=s,e.parent=a,e.component=o,e.instances=l,e.uuid=h,e.overrideData=c,e.updateState(e.data,n),u&&e.changeSelectedState(u,n),e.resetBBoxNeedsUpdate()},vS.Cloner=ED;var zB=new gs;zB.setAttribute("position",new ss(new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),3));var FB=class extends ch{constructor(e){super({...e,depthTest:!1,depthWrite:!1,glslVersion:Qn,vertexShader:"\n\t\t\t\tprecision highp float;\n\t\t\t\tin vec3 position;\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_Position = vec4(position, 1);\n\t\t\t\t}\n\t\t\t"})}customProgramCacheKey(){return""}};var jB=new Us,VB=96,HB={shapeInput:()=>"\n\t\t\tconst float posRowCoord = 0.1;  // vec4: px py pz opType\n\t\t\tconst float quatRowCoord = 0.3;  // vec4: qx qy qz qw\n\t\t\tconst float param1RowCoord = 0.5;// vec4: type param1 param2 param3\n\t\t\tconst float param2RowCoord = 0.7;// vec4: blendRange roundness scale param4\n\t\t\tconst float colorRowCoord = 0.9; // vec4: r g b a\n\t\t\tuniform sampler2D shapesDataTexture;\n\t\t\tvec4 shapePos(float iin) { \n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, posRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeQuat(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, quatRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeParams1(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, param1RowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeParams2(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, param2RowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tvec4 shapeColor(float iin) {\n\t\t\t\tvec4 r = texture(shapesDataTexture, vec2(iin, colorRowCoord));\n\t\t\t\treturn r;\n\t\t\t}\n\t\t",getxyzi:"\n\t\t\t// this code must complement lookup\n\t\t\tfloat xi = mod(gl_FragCoord.x - 0.5, VOXEL_RESOLUTION);\n\t\t\tfloat yi = mod(gl_FragCoord.y - 0.5, VOXEL_RESOLUTION);\n\t\t\tfloat zi = floor((gl_FragCoord.x - 0.5) * INV_VOXEL_RESOLUTION) + floor((gl_FragCoord.y - 0.5) * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;\n\t\t",lookup:"\n\t\t\tuniform sampler2D potentialPassTexture;\n\t\t\tuniform sampler2D voxelPassTexture; // includes normal (in xyz) and key (in w)\n\t\t\t\n\t\t\t// box or marching cube lookup value in value texture, integer box coord inputs\n\t\t\t// this code must complement codebits.getxyzi\n\t\t\tvec4 look(float xi, float yi, float zi, sampler2D rt) {// range 0 .. numv etc\n\t\t\t\tvec2 uv = vec2(\n\t\t\t\t\tmod(zi, Z_LAYERS_PER_ROW) + (xi + 0.5) / VOXEL_RESOLUTION,\n\t\t\t\t\tfloor(zi / Z_LAYERS_PER_ROW) + (yi + 0.5) / VOXEL_RESOLUTION\n\t\t\t\t); \n\t\t\t\tuv /= Z_LAYERS_PER_ROW;\n\t\t\t\treturn texture(rt, uv);\n\t\t\t}\n\t\t",getpart:"\n\t\t\tfloat getpart(inout float a, float b) {\n\t\t\t\tfloat t = floor(a/b);\n\t\t\t\tfloat r = a - t*b;\n\t\t\t\ta = t;\n\t\t\t\treturn r;\n\t\t\t}\n\t\t",triTable:new Float32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,1,8,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,9,9,2,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,2,8,10,2,8,9,10,-1,-1,-1,-1,-1,-1,-1,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,0,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,1,11,9,1,11,8,9,-1,-1,-1,-1,-1,-1,-1,1,10,3,3,10,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,10,0,10,8,0,10,11,8,-1,-1,-1,-1,-1,-1,-1,0,9,3,9,11,3,9,10,11,-1,-1,-1,-1,-1,-1,-1,10,8,9,11,8,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,4,3,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,4,1,7,4,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,2,1,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,3,4,0,3,10,2,1,-1,-1,-1,-1,-1,-1,-1,10,2,9,2,0,9,7,4,8,-1,-1,-1,-1,-1,-1,-1,9,10,2,7,9,2,3,7,2,4,9,7,-1,-1,-1,-1,7,4,8,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,11,4,2,11,4,0,2,-1,-1,-1,-1,-1,-1,-1,1,0,9,7,4,8,11,3,2,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,9,2,11,9,1,2,9,-1,-1,-1,-1,1,10,3,10,11,3,4,8,7,-1,-1,-1,-1,-1,-1,-1,10,11,1,11,4,1,4,0,1,4,11,7,-1,-1,-1,-1,8,7,4,11,0,9,10,11,9,3,0,11,-1,-1,-1,-1,11,7,4,9,11,4,10,11,9,-1,-1,-1,-1,-1,-1,-1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,9,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,0,0,5,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,8,5,3,8,5,1,3,-1,-1,-1,-1,-1,-1,-1,10,2,1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,10,2,1,5,9,4,-1,-1,-1,-1,-1,-1,-1,10,2,5,2,4,5,2,0,4,-1,-1,-1,-1,-1,-1,-1,5,10,2,5,2,3,4,5,3,8,4,3,-1,-1,-1,-1,4,5,9,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,11,8,0,5,9,4,-1,-1,-1,-1,-1,-1,-1,4,5,0,5,1,0,11,3,2,-1,-1,-1,-1,-1,-1,-1,5,1,2,8,5,2,11,8,2,5,8,4,-1,-1,-1,-1,11,3,10,3,1,10,4,5,9,-1,-1,-1,-1,-1,-1,-1,5,9,4,1,8,0,1,10,8,10,11,8,-1,-1,-1,-1,0,4,5,11,0,5,10,11,5,3,0,11,-1,-1,-1,-1,8,4,5,10,8,5,11,8,10,-1,-1,-1,-1,-1,-1,-1,8,7,9,9,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,9,3,5,9,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,7,0,7,1,0,7,5,1,-1,-1,-1,-1,-1,-1,-1,3,5,1,7,5,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,9,7,5,9,2,1,10,-1,-1,-1,-1,-1,-1,-1,2,1,10,0,5,9,0,3,5,3,7,5,-1,-1,-1,-1,2,0,8,5,2,8,7,5,8,2,5,10,-1,-1,-1,-1,5,10,2,3,5,2,7,5,3,-1,-1,-1,-1,-1,-1,-1,5,9,7,9,8,7,2,11,3,-1,-1,-1,-1,-1,-1,-1,7,5,9,2,7,9,0,2,9,11,7,2,-1,-1,-1,-1,11,3,2,8,1,0,8,7,1,7,5,1,-1,-1,-1,-1,1,2,11,7,1,11,5,1,7,-1,-1,-1,-1,-1,-1,-1,8,5,9,7,5,8,3,1,10,11,3,10,-1,-1,-1,-1,0,7,5,9,0,5,0,11,7,10,0,1,0,10,11,-1,0,10,11,3,0,11,0,5,10,7,0,8,0,7,5,-1,5,10,11,5,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,9,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,8,9,1,6,10,5,-1,-1,-1,-1,-1,-1,-1,5,6,1,1,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,1,6,2,1,8,0,3,-1,-1,-1,-1,-1,-1,-1,5,6,9,6,0,9,6,2,0,-1,-1,-1,-1,-1,-1,-1,8,9,5,2,8,5,6,2,5,8,2,3,-1,-1,-1,-1,11,3,2,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,11,0,2,11,5,6,10,-1,-1,-1,-1,-1,-1,-1,9,1,0,11,3,2,6,10,5,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,9,1,2,11,9,11,8,9,-1,-1,-1,-1,11,3,6,3,5,6,3,1,5,-1,-1,-1,-1,-1,-1,-1,11,8,0,5,11,0,1,5,0,6,11,5,-1,-1,-1,-1,6,11,3,6,3,0,5,6,0,9,5,0,-1,-1,-1,-1,9,5,6,11,9,6,8,9,11,-1,-1,-1,-1,-1,-1,-1,6,10,5,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,3,7,4,10,5,6,-1,-1,-1,-1,-1,-1,-1,0,9,1,6,10,5,7,4,8,-1,-1,-1,-1,-1,-1,-1,5,6,10,7,9,1,3,7,1,4,9,7,-1,-1,-1,-1,2,1,6,1,5,6,8,7,4,-1,-1,-1,-1,-1,-1,-1,5,2,1,6,2,5,4,0,3,7,4,3,-1,-1,-1,-1,7,4,8,5,0,9,5,6,0,6,2,0,-1,-1,-1,-1,9,3,7,4,9,7,9,2,3,6,9,5,9,6,2,-1,2,11,3,4,8,7,5,6,10,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,7,4,0,2,4,11,7,2,-1,-1,-1,-1,9,1,0,8,7,4,11,3,2,6,10,5,-1,-1,-1,-1,1,2,9,2,11,9,11,4,9,4,11,7,6,10,5,-1,7,4,8,5,11,3,1,5,3,6,11,5,-1,-1,-1,-1,11,1,5,6,11,5,11,0,1,4,11,7,11,4,0,-1,9,5,0,5,6,0,6,3,0,3,6,11,7,4,8,-1,9,5,6,11,9,6,9,7,4,9,11,7,-1,-1,-1,-1,9,4,10,10,4,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,4,10,9,4,3,8,0,-1,-1,-1,-1,-1,-1,-1,1,0,10,0,6,10,0,4,6,-1,-1,-1,-1,-1,-1,-1,1,3,8,6,1,8,4,6,8,10,1,6,-1,-1,-1,-1,9,4,1,4,2,1,4,6,2,-1,-1,-1,-1,-1,-1,-1,8,0,3,9,2,1,9,4,2,4,6,2,-1,-1,-1,-1,4,2,0,6,2,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,4,2,8,6,2,4,-1,-1,-1,-1,-1,-1,-1,9,4,10,4,6,10,3,2,11,-1,-1,-1,-1,-1,-1,-1,2,8,0,11,8,2,10,9,4,6,10,4,-1,-1,-1,-1,2,11,3,6,1,0,4,6,0,10,1,6,-1,-1,-1,-1,1,4,6,10,1,6,1,8,4,11,1,2,1,11,8,-1,4,6,9,6,3,9,3,1,9,3,6,11,-1,-1,-1,-1,1,11,8,0,1,8,1,6,11,4,1,9,1,4,6,-1,6,11,3,0,6,3,4,6,0,-1,-1,-1,-1,-1,-1,-1,8,4,6,8,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,7,10,8,7,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,7,0,7,10,0,10,9,0,10,7,6,-1,-1,-1,-1,7,6,10,7,10,1,8,7,1,0,8,1,-1,-1,-1,-1,7,6,10,1,7,10,3,7,1,-1,-1,-1,-1,-1,-1,-1,6,2,1,8,6,1,9,8,1,7,6,8,-1,-1,-1,-1,9,6,2,1,9,2,9,7,6,3,9,0,9,3,7,-1,0,8,7,6,0,7,2,0,6,-1,-1,-1,-1,-1,-1,-1,2,3,7,2,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,3,2,8,6,10,9,8,10,7,6,8,-1,-1,-1,-1,7,0,2,11,7,2,7,9,0,10,7,6,7,10,9,-1,0,8,1,8,7,1,7,10,1,10,7,6,11,3,2,-1,1,2,11,7,1,11,1,6,10,1,7,6,-1,-1,-1,-1,6,9,8,7,6,8,6,1,9,3,6,11,6,3,1,-1,1,9,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,6,0,7,0,11,3,0,6,11,-1,-1,-1,-1,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,8,1,3,8,6,7,11,-1,-1,-1,-1,-1,-1,-1,2,1,10,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,8,0,3,7,11,6,-1,-1,-1,-1,-1,-1,-1,0,9,2,9,10,2,7,11,6,-1,-1,-1,-1,-1,-1,-1,7,11,6,3,10,2,3,8,10,8,9,10,-1,-1,-1,-1,3,2,7,7,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,7,0,6,7,0,2,6,-1,-1,-1,-1,-1,-1,-1,6,7,2,7,3,2,9,1,0,-1,-1,-1,-1,-1,-1,-1,2,6,1,6,8,1,8,9,1,6,7,8,-1,-1,-1,-1,6,7,10,7,1,10,7,3,1,-1,-1,-1,-1,-1,-1,-1,6,7,10,10,7,1,7,8,1,8,0,1,-1,-1,-1,-1,7,3,0,10,7,0,9,10,0,7,10,6,-1,-1,-1,-1,10,6,7,8,10,7,9,10,8,-1,-1,-1,-1,-1,-1,-1,4,8,6,6,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,3,6,0,3,6,4,0,-1,-1,-1,-1,-1,-1,-1,11,6,8,6,4,8,1,0,9,-1,-1,-1,-1,-1,-1,-1,6,4,9,3,6,9,1,3,9,6,3,11,-1,-1,-1,-1,4,8,6,8,11,6,1,10,2,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,0,3,11,6,0,6,4,0,-1,-1,-1,-1,8,11,4,11,6,4,9,2,0,9,10,2,-1,-1,-1,-1,3,9,10,2,3,10,3,4,9,6,3,11,3,6,4,-1,3,2,8,2,4,8,2,6,4,-1,-1,-1,-1,-1,-1,-1,2,4,0,2,6,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,4,3,2,6,4,2,8,3,4,-1,-1,-1,-1,4,9,1,2,4,1,6,4,2,-1,-1,-1,-1,-1,-1,-1,3,1,8,1,6,8,6,4,8,1,10,6,-1,-1,-1,-1,0,1,10,6,0,10,4,0,6,-1,-1,-1,-1,-1,-1,-1,3,6,4,8,3,4,3,10,6,9,3,0,3,9,10,-1,4,9,10,4,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,9,4,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,5,9,4,6,7,11,-1,-1,-1,-1,-1,-1,-1,1,0,5,0,4,5,11,6,7,-1,-1,-1,-1,-1,-1,-1,6,7,11,4,3,8,4,5,3,5,1,3,-1,-1,-1,-1,4,5,9,2,1,10,11,6,7,-1,-1,-1,-1,-1,-1,-1,7,11,6,10,2,1,3,8,0,5,9,4,-1,-1,-1,-1,11,6,7,10,4,5,10,2,4,2,0,4,-1,-1,-1,-1,8,4,3,4,5,3,5,2,3,2,5,10,6,7,11,-1,3,2,7,2,6,7,9,4,5,-1,-1,-1,-1,-1,-1,-1,4,5,9,6,8,0,2,6,0,7,8,6,-1,-1,-1,-1,2,6,3,6,7,3,0,5,1,0,4,5,-1,-1,-1,-1,8,2,6,7,8,6,8,1,2,5,8,4,8,5,1,-1,4,5,9,6,1,10,6,7,1,7,3,1,-1,-1,-1,-1,10,6,1,6,7,1,7,0,1,0,7,8,4,5,9,-1,10,0,4,5,10,4,10,3,0,7,10,6,10,7,3,-1,10,6,7,8,10,7,10,4,5,10,8,4,-1,-1,-1,-1,5,9,6,9,11,6,9,8,11,-1,-1,-1,-1,-1,-1,-1,11,6,3,3,6,0,6,5,0,5,9,0,-1,-1,-1,-1,8,11,0,11,5,0,5,1,0,11,6,5,-1,-1,-1,-1,3,11,6,5,3,6,1,3,5,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,5,9,8,11,9,6,5,11,-1,-1,-1,-1,3,11,0,11,6,0,6,9,0,9,6,5,10,2,1,-1,5,8,11,6,5,11,5,0,8,2,5,10,5,2,0,-1,3,11,6,5,3,6,3,10,2,3,5,10,-1,-1,-1,-1,9,8,5,8,2,5,2,6,5,2,8,3,-1,-1,-1,-1,6,5,9,0,6,9,2,6,0,-1,-1,-1,-1,-1,-1,-1,8,5,1,0,8,1,8,6,5,2,8,3,8,2,6,-1,6,5,1,6,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,3,1,10,6,1,6,8,3,9,6,5,6,9,8,-1,0,1,10,6,0,10,0,5,9,0,6,5,-1,-1,-1,-1,8,3,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,5,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,11,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,5,7,11,0,3,8,-1,-1,-1,-1,-1,-1,-1,7,11,5,11,10,5,0,9,1,-1,-1,-1,-1,-1,-1,-1,5,7,10,7,11,10,1,8,9,1,3,8,-1,-1,-1,-1,2,1,11,1,7,11,1,5,7,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,2,1,5,7,1,11,2,7,-1,-1,-1,-1,5,7,9,7,2,9,2,0,9,7,11,2,-1,-1,-1,-1,2,5,7,11,2,7,2,9,5,8,2,3,2,8,9,-1,10,5,2,5,3,2,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,2,8,2,5,8,5,7,8,5,2,10,-1,-1,-1,-1,1,0,9,3,10,5,7,3,5,2,10,3,-1,-1,-1,-1,2,8,9,1,2,9,2,7,8,5,2,10,2,5,7,-1,5,3,1,5,7,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,1,7,0,5,7,1,-1,-1,-1,-1,-1,-1,-1,3,0,9,5,3,9,7,3,5,-1,-1,-1,-1,-1,-1,-1,7,8,9,7,9,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,5,8,10,5,8,11,10,-1,-1,-1,-1,-1,-1,-1,4,0,5,0,11,5,11,10,5,0,3,11,-1,-1,-1,-1,9,1,0,10,4,8,11,10,8,5,4,10,-1,-1,-1,-1,4,11,10,5,4,10,4,3,11,1,4,9,4,1,3,-1,1,5,2,5,8,2,8,11,2,8,5,4,-1,-1,-1,-1,11,4,0,3,11,0,11,5,4,1,11,2,11,1,5,-1,5,2,0,9,5,0,5,11,2,8,5,4,5,8,11,-1,5,4,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,2,2,5,3,5,4,3,4,8,3,-1,-1,-1,-1,2,10,5,4,2,5,0,2,4,-1,-1,-1,-1,-1,-1,-1,2,10,3,10,5,3,5,8,3,8,5,4,9,1,0,-1,2,10,5,4,2,5,2,9,1,2,4,9,-1,-1,-1,-1,5,4,8,3,5,8,1,5,3,-1,-1,-1,-1,-1,-1,-1,5,4,0,5,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,4,8,3,5,8,5,0,9,5,3,0,-1,-1,-1,-1,5,4,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,11,4,11,9,4,11,10,9,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,9,4,7,11,9,11,10,9,-1,-1,-1,-1,11,10,1,4,11,1,0,4,1,11,4,7,-1,-1,-1,-1,4,1,3,8,4,3,4,10,1,11,4,7,4,11,10,-1,7,11,4,4,11,9,11,2,9,2,1,9,-1,-1,-1,-1,4,7,9,7,11,9,11,1,9,1,11,2,3,8,0,-1,4,7,11,2,4,11,0,4,2,-1,-1,-1,-1,-1,-1,-1,4,7,11,2,4,11,4,3,8,4,2,3,-1,-1,-1,-1,10,9,2,9,7,2,7,3,2,9,4,7,-1,-1,-1,-1,7,10,9,4,7,9,7,2,10,0,7,8,7,0,2,-1,10,7,3,2,10,3,10,4,7,0,10,1,10,0,4,-1,2,10,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,3,1,7,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,1,8,0,1,7,8,-1,-1,-1,-1,3,0,4,3,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,10,9,8,11,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,10,9,11,-1,-1,-1,-1,-1,-1,-1,10,1,0,8,10,0,11,10,8,-1,-1,-1,-1,-1,-1,-1,10,1,3,10,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,1,9,11,1,8,11,9,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,9,2,1,9,11,2,-1,-1,-1,-1,11,2,0,11,0,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,9,8,10,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,8,1,0,8,10,1,-1,-1,-1,-1,2,10,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),numTrisTable:new Float32Array([0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,2,3,4,4,3,3,4,4,3,4,5,5,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,2,3,3,4,3,4,2,3,3,4,4,5,4,5,3,2,3,4,4,3,4,5,3,2,4,5,5,4,5,2,4,1,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,2,4,3,4,3,5,2,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,3,4,4,3,4,5,5,4,4,3,5,2,5,4,2,1,2,3,3,4,3,4,4,5,3,4,4,5,2,3,3,2,3,4,4,5,4,5,5,2,4,3,5,4,3,2,4,1,3,4,4,5,4,5,3,4,4,5,5,2,3,4,2,1,2,3,3,2,3,4,2,1,3,2,4,1,2,1,1,0])},WB=class extends DO{constructor(e,t,n){super(e,t,n),this.data=t,this.needsRebuild=!0,this.customDepthMaterialNeedsUpdate=!1,this._npart=-1,this.spatialn=1,this.drawRangeNeedsForceUpdate=!0,this._resolutionLevel=-1,this.resolution=64,this.spatialDivisions=25,this.zLayersPerRow=8,this.basePyramidSize=512,this.pyramidTexture1Width=341,this.pyramidTexture1Height=256,this.pyramidTexture2Width=170,this.pyramidTexture2Height=128,this.numLevels=9,this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=0,this.bboxOffset=0,this.shapesDataTexture={value:void 0},this.spatialscene=new Ol,this.potentialPassScene=new Ol,this.voxelPassScene=new Ol,this._spatialPassRenderTargets=[],this._potentialPassRenderTargets=[],this._voxelPassRenderTargets=[],this._pyramidRenderTargets=[],this.geometry=new gs,this.geometry.drawRange.count=0,this.spatialPassUniforms={span:{value:-1},shapesDataTexture:this.shapesDataTexture,npart:{value:this.npart},spatialn:{value:this.spatialn}},this.spatialMesh=new Ns(zB,this.spatialPassMaterial()),this.spatialMesh.frustumCulled=!1,this.spatialscene.add(this.spatialMesh);let i=new Bl(HB.triTable,16,256,Tn,xn);i.needsUpdate=!0;let r=new Bl(HB.numTrisTable,256,1,Tn,xn);r.needsUpdate=!0,this.voxelPassUniforms={potentialPassTexture:{value:void 0},numTrisTable:{value:r}},this.voxelMesh=new Ns(zB,this.voxelPassMaterial()),this.voxelMesh.frustumCulled=!1,this.voxelPassScene.add(this.voxelMesh),this.potentialPassUniforms={shapesDataTexture:this.shapesDataTexture,spatialPassTexture:{value:void 0},npart:{value:this.npart},spatialn:{value:this.spatialn}},this.potentialMesh=new Ns(zB,this.potentialPassMaterial()),this.potentialMesh.frustumCulled=!1,this.potentialPassScene.add(this.potentialMesh),this.marchPassUniforms={triTable:{value:i},potentialPassTexture:{value:void 0},voxelPassTexture:{value:void 0},pyramidTexture1:{value:void 0},pyramidTexture1Size:{value:void 0},pyramidTexture2:{value:void 0},pyramidTexture2Size:{value:void 0}},this.frustumCulled=!1,this.onBeforeShadowPass=e=>{if(eU.call(this),0===this.npart)return void(this.geometry.drawRange.count=0);let t=this.material.root;if(t.shadersPatchedForShapeBlend){if(this.customDepthMaterialNeedsUpdate){this.customDepthMaterialNeedsUpdate=!1,this.customDepthMaterial=new Bs({vertexShader:t.vertexShader,fragmentShader:"\n\t\t\t\t\t\t#include <packing>\n\t\t\t\t\t\tvoid main()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgl_FragColor = packDepthToRGBA(gl_FragCoord.z);\n\t\t\t\t\t\t}\n\t\t\t\t\t",uniforms:t.uniforms,defines:this.material.defines}),this.isMeshDepthMaterial=!0,this.customDistanceMaterial=new Bs({vertexShader:t.vertexShader,fragmentShader:"\n\t\t\t\t\t#include <common>\n\t\t\t\t\t#include <packing>\n\t\t\t\t\tuniform vec3 referencePosition;\n\t\t\t\t\tuniform float nearDistance;\n\t\t\t\t\tuniform float farDistance;\n\t\t\t\t\t// World-space position\n\t\t\t\t\tvarying vec3 vWPosition;\n\t\t\t\t\tvoid main()\n\t\t\t\t\t{\n\t\t\t\t\t\tfloat dist = length(vWPosition - referencePosition);\n\t\t\t\t\t\tdist = (dist - nearDistance) / (farDistance - nearDistance);\n\t\t\t\t\t\tdist = saturate(dist);\n\t\t\t\t\t\t// Required by Three.js for this to work\n\t\t\t\t\t\tgl_FragColor = packDepthToRGBA( dist );\n\t\t\t\t\t}",uniforms:{nearDistance:{value:0},farDistance:{value:0},referencePosition:{value:new ji},opacity:{value:0},...t.uniforms},defines:this.material.defines});let e=this.customDistanceMaterial;e.referencePosition=new ji,e.nearDistance=0,e.farDistance=0,e.opacity=1,e.isMeshDistanceMaterial=!0}}else this.patchVertexShaderForShapeBlend(t),t.shadersPatchedForShapeBlend=!0,this.customDepthMaterialNeedsUpdate=!0;if(this.spatialPassUniforms.npart.value=this.npart,this.spatialPassUniforms.spatialn.value=this.spatialn,this.potentialPassUniforms.npart.value=this.npart,this.potentialPassUniforms.spatialn.value=this.spatialn,this.needsRebuild){this.needsRebuild=!1,this.spatialMesh.material.defines.RES=this.resolutionLevel,this.spatialMesh.material.needsUpdate=!0,this.potentialMesh.material.defines.RES=this.resolutionLevel,this.potentialPassUniforms.spatialPassTexture.value=this.spatialPassRenderTarget.texture,this.potentialMesh.material.needsUpdate=!0,this.voxelMesh.material.defines.RES=this.resolutionLevel,this.voxelMesh.material.needsUpdate=!0,this.voxelPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.voxelPassTexture.value=this.voxelPassRenderTarget.texture[0],this.material.defines.RES=this.resolutionLevel,this.material.defines.LEVELS=this.pyramidLevelSizes.length,this.material.defines.LOOP=this.pyramidLevelSizes.length%2===0?this.pyramidLevelSizes.length-3:this.pyramidLevelSizes.length-2,this.material.defines.HALF=this.pyramidLevelSizes.length%2===0?1:0,this.material.needsUpdate=!0;let e=this.pyramidLevelSizes.length%2===0?0:1,t=this.pyramidLevelSizes.length%2===0?1:0;this.marchPassUniforms.pyramidTexture2.value=this.pyramidRenderTarget[e].texture,this.marchPassUniforms.pyramidTexture2Size.value=new di(this.pyramidRenderTarget[e].width,this.pyramidRenderTarget[e].height),this.marchPassUniforms.pyramidTexture1.value=this.pyramidRenderTarget[t].texture,this.marchPassUniforms.pyramidTexture1Size.value=new di(this.pyramidRenderTarget[t].width,this.pyramidRenderTarget[t].height),Object.assign(this.material.uniforms,this.marchPassUniforms)}let n=e.shadowMap.enabled;e.shadowMap.enabled=!1;let i=e.getRenderTarget();e.setRenderTarget(this.spatialPassRenderTarget),e.render(this.spatialscene,jB),e.setRenderTarget(this.potentialPassRenderTarget),e.render(this.potentialPassScene,jB),e.setRenderTarget(this.voxelPassRenderTarget),e.render(this.voxelPassScene,jB),WB.streamCompaction.renderPyramid(this.resolutionLevel,this.pyramidLevelSizes,e,this.voxelPassRenderTarget,this.pyramidRenderTarget).then((e=>{this.material.wireframe&&(3*e>this.geometry.attributes.position.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.dispose(),this.geometry=new gs,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.geometry.attributes.position=new ss(new Float32Array(3*e*2),3)),(3*e>this.geometry.drawRange.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.drawRange.count=3*Math.floor(1.2*e)),this.drawRangeNeedsForceUpdate=!1})),e.shadowMap.enabled=n,e.setRenderTarget(i)}}set npart(e){e!==this._npart&&(this.drawRangeNeedsForceUpdate=!0,this._npart=e,this.spatialn=Math.ceil(e/96))}get npart(){return this._npart}set resolutionLevel(e){let t=Math.min(8,Math.max(5,e));if(t!==this._resolutionLevel){switch(this._resolutionLevel=t,this.resolution=Math.pow(2,t),this.resolutionLevel){case 5:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192],this.bboxSize=496,this.bboxOffset=-8;break;case 6:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=504,this.bboxOffset=-4;break;case 7:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192,384,768,1536],this.bboxSize=508,this.bboxOffset=-2;break;case 8:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096],this.bboxSize=510,this.bboxOffset=-1}this.pyramidTexture1Width=0,this.pyramidTexture2Width=0,this.pyramidTexture1Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-2],this.pyramidTexture2Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-3];for(let e=this.pyramidLevelSizes.length-2;e>=0;e--)(this.pyramidLevelSizes.length-2)%2===e%2?this.pyramidTexture1Width+=this.pyramidLevelSizes[e]:this.pyramidTexture2Width+=this.pyramidLevelSizes[e];this.basePyramidSize=this.pyramidLevelSizes[this.pyramidLevelSizes.length-1],this.zLayersPerRow=this.basePyramidSize/this.resolution,this.numLevels=this.pyramidLevelSizes.length-1,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.needsRebuild=!0}}get resolutionLevel(){return this._resolutionLevel}get spatialPassRenderTarget(){let e=this._spatialPassRenderTargets[this.resolutionLevel];return e||(e=new Bi(this.spatialDivisions*this.spatialn,this.spatialDivisions**2,{format:An,type:xn,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:pn,magFilter:pn}),this._spatialPassRenderTargets[this.resolutionLevel]=e),e}get potentialPassRenderTarget(){let e=this._potentialPassRenderTargets[this.resolutionLevel];return e||(e=new Bi(this.basePyramidSize,this.basePyramidSize,{format:An,type:xn,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:pn,magFilter:pn}),this._potentialPassRenderTargets[this.resolutionLevel]=e),e}get voxelPassRenderTarget(){let e=this._voxelPassRenderTargets[this.resolutionLevel];return e||(e=new zi(this.basePyramidSize,this.basePyramidSize,2,{stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:pn,magFilter:pn}),e.texture[0].format=An,e.texture[0].type=xn,e.texture[1].format=Tn,e.texture[1].type=xn,this._voxelPassRenderTargets[this.resolutionLevel]=e),e}get pyramidRenderTarget(){let e=this._pyramidRenderTargets[this.resolutionLevel];if(!e){e=[new Bi(this.pyramidTexture1Width,this.pyramidTexture1Height,{format:An,type:xn,stencilBuffer:!1,depthBuffer:!1,magFilter:pn,minFilter:pn}),new Bi(this.pyramidTexture2Width,this.pyramidTexture2Height,{format:An,type:xn,stencilBuffer:!1,depthBuffer:!1,magFilter:pn,minFilter:pn})],this._pyramidRenderTargets[this.resolutionLevel]=e}return e}updateState(e,t){let n=this.material;super.updateState(e,t),n!==this.material&&(this.needsRebuild=!0),e.geometry&&(this.resolutionLevel=e.geometry.resolutionLevel,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]}),e.wireframe&&!this.geometry.getAttribute("position")?this.geometry.setAttribute("position",new ss(new Float32Array(3*this.geometry.drawRange.count),3)):!e.wireframe&&this.geometry.getAttribute("position")&&this.geometry.deleteAttribute("position")}spatialPassMaterial(){let e=`\n\t\t\tprecision highp float;\n\t\t\tout vec4 pc_FragColor;\n\t\t\tconst float spatialDivisions = ${this.spatialDivisions}.;\n\t\t\tuniform float span;\n\t\t\tuniform float npart;\n\t\t\tuniform float spatialn;\n\t\t\t${HB.shapeInput()}\n\n\t\t\tvec3 low, high;     // range of current div; subset of -1 .. 1 with span border\n\n\t\t\t// lookup one element/channel's worth of spheres for current division\n\t\t\t// stating with low sphere number lowi\n\t\t\t// gives a key to which spheres from lowi..lowi+23 are active within given div (low..high)\n\t\t\tfloat spatialKey(float lowi) {\n\t\t\t\tfloat t = 0.;\n\t\t\t\tfor (float ii = 23.; ii >= 0.; ii--) {\n\t\t\t\t\tfloat i = ii + lowi;\n\t\t\t\t\tfloat iin = (i + 0.5) / 96.;\n\t\t\t\t\tvec4 shape = shapePos(iin);\n\t\t\t\t\tvec3 d = shape.xyz;\n\t\t\t\t\tfloat op = shape.w;\n\t\n\t\t\t\t\tt *= 2.;\n\t\t\t\t\tt += (\n\t\t\t\t\t\tlow.x < d.x && d.x < high.x &&\n\t\t\t\t\t\tlow.y < d.y && d.y < high.y &&\n\t\t\t\t\t\tlow.z < d.z && d.z < high.z &&\n\t\t\t\t\t\ti < npart || op == -2. // always include if op is -2, which is the intersection operation\n\t\t\t\t\t) ? 1. : 0.;\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t}\n\n\t\t\t${HB.getpart}\n\n\t\t\tvoid main() {               // spatialial fragment shader\n\t\t\t\t// find active div\n\t\t\t\tvec3 div;                               // which div is current\n\t\t\t\t// out holds x=> x, lowi faster moving and y=> z, y faster moving\n\t\t\t\tfloat yz = float(gl_FragCoord.y - 0.5);     // contains  z, y faster moving\n\t\t\t\tdiv.y = getpart(yz, spatialDivisions);\n\t\t\t\tdiv.z = yz; // getpart(yz, spatialDivisions.z); // what's left, should be the same as getpart\n\n\t\t\t\tfloat lx = float(gl_FragCoord.x - 0.5);     // contains x, lowi faster moving\n\t\t\t\tfloat lowi = getpart(lx, spatialn) * 96.;\n\t\t\t\tdiv.x = lx;\n\n\t\t\t\tlow = div / spatialDivisions * 2. - 1. - span;\n\t\t\t\thigh = (div+1.) / spatialDivisions * 2. - 1. + span;\n\n\t\t\t\t// find active range of spheres\n\t\t\t\tpc_FragColor.x = spatialKey(lowi);\n\t\t\t\tpc_FragColor.y = spatialKey(lowi+24.);\n\t\t\t\tpc_FragColor.z = spatialKey(lowi+48.);\n\t\t\t\tpc_FragColor.w = spatialKey(lowi+72.);\n\t\t\t}\n\t\t`;return new FB({name:"Spatial Pass",fragmentShader:e,uniforms:this.spatialPassUniforms})}potentialPassMaterial(){let e=`\n\t\t\tprecision highp float;\n\t\t\tout vec4 pc_FragColor;\n\n\t\t\t${HB.shapeInput()}\n\t\t\tuniform sampler2D spatialPassTexture;\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.;\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\n\t\t\tuniform float npart;\n\t\t\tuniform float spatialn;\n\t\t\tconst float spatialDivisions = ${this.spatialDivisions}.;\n\t\t\tconst float spatialDivisions2 = spatialDivisions * spatialDivisions;\n\t\t\tconst float spatialDivisionsSub1 = spatialDivisions - 1.;\n\n\t\t\t${HB.getpart}\n\n\t\t\tvec3 packRGBAToVec3(vec4 color) {\n\t\t\t\tuint r = uint(color.r * 255.);\n\t\t\t\tuint g = uint(color.g * 255.);\n\t\t\t\tuint combined = (r << 8) | g; \n\t\t\t\treturn vec3(float(combined) * 0.00001525902, color.b, color.a); // 1/65535\n\t\t\t}\n\n\t\t\tvoid applyQuaternionToVector(in vec4 q, inout vec3 v) {\n\t\t\t\tv += 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * SDF functions (reference: https://iquilezles.org/articles/distfunctions/)\n\t\t\t */\n\n\t\t\t// branchless version of "Smooth Union, Subtraction and Intersection - bound, bound, bound" in above reference\n\t\t\tfloat smoothOperation(float op, float sdf, float d, float k) {\n\t\t\t  //        union: op =  1 => signSubtract =  1, signIntersection =  1\n\t\t\t  //     subtract: op = -1 => signSubtract = -1, signIntersection =  1\n\t\t\t\t// intersection: op = -2 => signSubtract = -1, signIntersection = -1\n\n\t\t\t\tfloat signSubtract = clamp(op, -1., 1.);\n\t\t\t\tfloat signIntersection = 2. * (op - signSubtract) + 1.;\n\t\t\t\tfloat h = clamp(\n\t\t\t\t\t0.5 + signSubtract * 0.5 * (sdf - signSubtract * signIntersection * d) / k,\n\t\t\t\t\t0.0,\n\t\t\t\t\t1.0\n\t\t\t\t);\n\t\t\t\treturn mix(sdf, signSubtract * signIntersection * d, h) - \n\t\t\t\t\t\t\t signSubtract * k * h * (1.0 - h);\n\t\t\t}\n\n\t\t\tfloat sdSphere( vec3 p, float s )\n\t\t\t{\n\t\t\t\treturn length(p)-s;\n\t\t\t}\n\n\t\t\tfloat sdEllipsoid( vec3 p, vec3 r )\n\t\t\t{\n\t\t\t\tfloat k0 = length(p/r);\n\t\t\t\tfloat k1 = length(p/(r*r));\n\t\t\t\treturn k0*(k0-1.0)/k1;\n\t\t\t}\n\n\t\t\tfloat sdBox( vec3 p, vec3 b )\n\t\t\t{\n\t\t\t\tvec3 q = abs(p) - b;\n\t\t\t\treturn length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);\n\t\t\t}\n\n\t\t\tfloat sdTorus( vec3 p, vec2 t )\n\t\t\t{\n\t\t\t\tvec2 q = vec2(length(p.xy)-t.x,p.z);\n\t\t\t\treturn length(q)-t.y;\n\t\t\t}\n\n\t\t\tfloat sdCappedTorus( vec3 p, vec2 sc, float ra, float rb)\n\t\t\t{\n\t\t\t\tp.x = abs(p.x);\n\t\t\t\tfloat k = (sc.y*p.x>sc.x*p.y) ? dot(p.xy,sc) : length(p.xy);\n\t\t\t\treturn sqrt( dot(p,p) + ra*ra - 2.0*ra*k ) - rb;\n\t\t\t}\n\n\t\t\tfloat dot2( in vec2 v ) { return dot(v,v); }\n\t\t\tfloat sdCappedCone( vec3 p, float h, float r1, float r2 )\n\t\t\t{\n\t\t\t\tvec2 q = vec2( length(p.xz), p.y );\n\t\t\t\tvec2 k1 = vec2(r2,h);\n\t\t\t\tvec2 k2 = vec2(r2-r1,2.0*h);\n\t\t\t\tvec2 ca = vec2(q.x-min(q.x,(q.y<0.0)?r1:r2), abs(q.y)-h);\n\t\t\t\tvec2 cb = q - k1 + k2*clamp( dot(k1-q,k2)/dot2(k2), 0.0, 1.0 );\n\t\t\t\tfloat s = (cb.x<0.0 && ca.y<0.0) ? -1.0 : 1.0;\n\t\t\t\treturn s*sqrt( min(dot2(ca),dot2(cb)) );\n\t\t\t}\n\n\t\t\tfloat sdCappedCylinder( vec3 p, float h, float r )\n\t\t\t{\n\t\t\t\tvec2 d = abs(vec2(length(p.xz),p.y)) - vec2(r,h);\n\t\t\t\treturn min(max(d.x,d.y),0.0) + length(max(d,0.0));\n\t\t\t}\n\n\t\t\tfloat maxBlend = 0.0;\n\t\t\t// compute potential from A (=24) spheres, using the bit flags in 'activeKey'\n\t\t\t// to avoid lookup/compute for inactive spheres\n\t\t\t// return field potential, side effect updates track,\n\t\t\t// compute and return +ve and -ve values separately\n\t\t\tvoid fillSpatialInner(\n\t\t\t\tfloat ii,\n\t\t\t\tfloat activeKey,\n\t\t\t\tvec3 corner,\n\t\t\t\tinout float sdf,\n\t\t\t\tinout float colorDivisor,\n\t\t\t\tinout vec4 trackColor\n\t\t\t) {\n\t\t\t\tfor (float i = 0.; i < 24.; i++) {\n\t\t\t\t\tif (activeKey < 1.) break; // activeKey exhausted, no more active spheres\n\t\t\t\t\tactiveKey *= 0.5;\n\t\t\t\t\tif (fract(activeKey) < 0.5) continue;\n\n\t\t\t\t\tfloat iin = (i + ii + 0.5) * ${1/VB};\n\t\t\t\t\tvec4 shape = shapePos(iin);\n\t\t\t\t\tvec4 quat = shapeQuat(iin);\n\t\t\t\t\tvec4 params1 = shapeParams1(iin);\n\t\t\t\t\tvec4 params2 = shapeParams2(iin);\n\n\t\t\t\t\tvec3 p = corner - shape.xyz;\n\t\t\t\t\tapplyQuaternionToVector(quat, p);\n\t\t\t\t\tp /= params2.z; // scale\n\t\t\t\t\tfloat d; // d in -1..1 coordinates\n\t\t\t\t\tswitch (int(params1.x)) {\n\t\t\t\t\t\tcase 0: d = sdSphere(p, params1.y); break;\n\t\t\t\t\t\tcase 1: d = sdEllipsoid(p, params1.yzw); break;\n\t\t\t\t\t\tcase 2: d = sdBox(p, params1.yzw); break;\n\t\t\t\t\t\tcase 3: d = sdCappedCylinder(p, params1.y, params1.z); break;\n\t\t\t\t\t\tcase 4: d = sdCappedCone(p, params1.y, params1.z, params1.w); break;\n\t\t\t\t\t\tcase 5: d = sdTorus(p, params1.yz); break;\n\t\t\t\t\t\tcase 6: d = sdCappedTorus(p, params1.yz, params1.w, params2.w); break;\n\t\t\t\t\t}\n\t\t\t\t\td -= params2.y; // rounded edge\n\t\t\t\t\td *= params2.z; // scale\n\n\t\t\t\t\tfloat k = params2.x;\n\t\t\t\t\tfloat op = shape.w;\n\n\t\t\t\t\tsdf = smoothOperation(shape.w, sdf, d, k);\n\n\t\t\t\t\tfloat isNegativeOne = step(-1.5, op) * step(op, -0.5); // 1 when op == -1, 0 otherwise\n\t\t\t\t\tfloat colorCull = smoothstep(maxBlend, 0., -d);\n\t\t\t\t\tfloat cullFactor = mix(1.0, colorCull, isNegativeOne);\n\t\t\t\t\ttrackColor *= cullFactor;\n\t\t\t\t\tcolorDivisor *= cullFactor;\n\n\t\t\t\t\tmaxBlend = max(maxBlend, k);\n\n\t\t\t\t\tk += 2. * INV_VOXEL_RESOLUTION; // avoid division by zero, and other color artifacts with very small k\n\t\t\t\t\tfloat nearness = smoothstep(k, 0., d);\n\n\t\t\t\t\tvec4 color = shapeColor(iin);\n\t\t\t\t\tnearness *= float(color.a >= 0.);\n\n\t\t\t\t\tcolorDivisor += nearness;\n\t\t\t\t\ttrackColor += color * nearness;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvec3 div;\n\t\t\t// compute potential from all spheres; collect +ve and =ve values separately\n\t\t\t// work in blocks of A*4 (=96) spheres, using the bit flags in 4 float channel 'activeKey' values\n\t\t\t// TODO check if extra vec3 output useful, not really used at present\n\t\t\tfloat fillSpatial(vec3 corner, inout vec4 trackColor) {\n\t\t\t\tfloat sdf = 1e3; // hack: initialize to large value\n\t\t\t\tfloat colorDivisor = 0.;\n\t\t\t\t// spatialPassTexture holds x=> lowi, x faster moving and y=> z, y faster moving\n\t\t\t\tfloat divyz = (div.y + div.z * spatialDivisions + 0.5) / (spatialDivisions2);\n\t\t\t\tfor (float ii = 0.; ii < spatialn; ii++) {\n\t\t\t\t\tfloat i = ii * 96.;\n\n\t\t\t\t\tvec4 activeKey = texture(spatialPassTexture, vec2((div.x * spatialn + ii + 0.5)/(spatialn * spatialDivisions), divyz));\n\t\t\t\t\tfillSpatialInner(i, activeKey.x, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+24., activeKey.y, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+48., activeKey.z, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t\tfillSpatialInner(i+72., activeKey.w, corner, sdf, colorDivisor, trackColor);\n\t\t\t\t}\n\n\t\t\t\ttrackColor /= colorDivisor;\n\t\t\t\treturn mix(sdf, 0.0, step(1e20 - 0.1, sdf));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\t${HB.getxyzi}    // get xi yi zi from 2d position\n\n\t\t\t\tvec3 xyzi = vec3(xi,yi,zi);\n\t\t\t\tvec3 corner = xyzi / VOXEL_RESOLUTION_SUB1 * 2. - 1.;  // -1..1 coords\n\n\t\t\t\tdiv = floor(xyzi / VOXEL_RESOLUTION_SUB1 * spatialDivisionsSub1);\n\n\t\t\t\tvec4 c = vec4(0.);\n\t\t\t\tfloat t = fillSpatial(corner, c);\n\n\t\t\t\tpc_FragColor = vec4(t, packRGBAToVec3(c)); // RGB texture\n\t\t\t}\n\t\t`;return new FB({name:"PotentialPass",fragmentShader:e,uniforms:this.potentialPassUniforms})}voxelPassMaterial(){let e=`\n\t\t\tprecision highp float;\n\t\t\tlayout(location = 0) out vec4 pc_FragColor;\n\t\t\tlayout(location = 1) out vec4 numTris;\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.; \n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\t\t\tuniform sampler2D numTrisTable; // 256 x 1\n\n\t\t\tfloat keyi(float f000, float f100, float f010, float f110, float f001, float f101, float f011, float f111) {\n\t\t\t\treturn (float(f000 < 0.) * 1.) +\n\t\t\t\t\t\t\t (float(f100 < 0.) * 2.) +\n\t\t\t\t\t\t\t (float(f010 < 0.) * 8.) +\n\t\t\t\t\t\t\t (float(f110 < 0.) * 4.) +\n\t\t\t\t\t\t\t (float(f001 < 0.) * 16.) +\n\t\t\t\t\t\t\t (float(f101 < 0.) * 32.) +\n\t\t\t\t\t\t\t (float(f011 < 0.) * 128.) +\n\t\t\t\t\t\t\t (float(f111 < 0.) * 64.);\n\t\t\t}\n\n\t\t\t${HB.lookup}\n\n\t\t\tvec3 compNormi(float xi, float yi, float zi) {\n\t\t\t\tfloat dx = look(xi + 1., yi, zi, potentialPassTexture).r - look(xi - 1., yi, zi, potentialPassTexture).r;\n\t\t\t\tfloat dy = look(xi, yi + 1., zi, potentialPassTexture).r - look(xi, yi - 1., zi, potentialPassTexture).r;\n\t\t\t\tfloat dz = look(xi, yi, zi + 1., potentialPassTexture).r - look(xi, yi, zi - 1., potentialPassTexture).r;\n\t\t\t\t// if we allow (common) 0,0,0 case through then NaN can spread\n\t\t\t\t// eg r = vec4(compNorm i(???), 1.) will pollute r.w\n\t\t\t\tif (dx == 0.0 && dy == 0.0 && dz == 0.0) {\n\t\t\t\t\treturn vec3(0.199, 0.299, 0.399);\n\t\t\t\t}\n\t\t\t\treturn normalize(vec3(dx, dy, dz));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\t${HB.getxyzi}    // get xi yi zi from 2d\n\n\t\t\t\tvec3 normal = compNormi(xi, yi, zi);  // even if our key is -1 this may be needed by a neighbouring voxel\n\n\t\t\t\tif (xi >= VOXEL_RESOLUTION_SUB1 || yi >= VOXEL_RESOLUTION_SUB1 || zi >= VOXEL_RESOLUTION_SUB1) {\n\t\t\t\t\tpc_FragColor = vec4(normal, 0.);\n\t\t\t\t\tnumTris = vec4(0.);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfloat\n\t\t\t\t\tf000 = look(xi, yi, zi, potentialPassTexture).r,\n\t\t\t\t\tf100 = look(xi+1., yi, zi, potentialPassTexture).r,\n\t\t\t\t\tf010 = look(xi, yi+1., zi, potentialPassTexture).r,\n\t\t\t\t\tf110 = look(xi+1., yi+1., zi, potentialPassTexture).r,\n\t\t\t\t\tf001 = look(xi, yi, zi+1., potentialPassTexture).r,\n\t\t\t\t\tf101 = look(xi+1., yi, zi+1., potentialPassTexture).r,\n\t\t\t\t\tf011 = look(xi, yi+1., zi+1., potentialPassTexture).r,\n\t\t\t\t\tf111 = look(xi+1., yi+1., zi+1., potentialPassTexture).r;\n\t\t\t\tfloat key = keyi(f000, f100, f010, f110, f001, f101, f011, f111);\n\n\t\t\t\tpc_FragColor = vec4(normal, key);\n\n\t\t\t\tnumTris = texture(numTrisTable, vec2((key + 0.5) / 256., 0.5));\n\t\t\t}\n\t\t`;return new FB({name:"VoxelPass",fragmentShader:e,uniforms:this.voxelPassUniforms})}patchVertexShaderForShapeBlend(e){let t=`\n\t\t#ifdef SHAPEBLEND \n\t\t\tprecision highp sampler2D;\n\n\t\t\tuniform float isol;\n\n\t\t\tuniform sampler2D triTable;     // 256 x 16\n\t\t\tuniform sampler2D pyramidTexture1;\n\t\t\tuniform vec2 pyramidTexture1Size;\n\t\t\tuniform sampler2D pyramidTexture2;\n\t\t\tuniform vec2 pyramidTexture2Size;\n\n\t\t\tconst vec2 halfPixelOffset = vec2(0.5, 0.5);\n\n\t\t\tconst vec2 rShift = vec2(0., 1.);\n\t\t\tconst vec2 gShift = vec2(1., 1.);\n\t\t\tconst vec2 bShift = vec2(1., 0.);\n\n\t\t\tconst float res = float(RES);\n\t\t\tconst float VOXEL_RESOLUTION = pow(2., res);\n\t\t\tconst float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));\n\t\t\tconst float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;\n\n\t\t\tconst float scale_factor = 2.;\n\n\t\t\t#if SHAPEBLEND == 5\n\t\t\t\tconst float levelShiftX[7] = float[7](4., 6., 12., 24., 48., 96., 192.);\n\t\t\t\tconst float scale = 8. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(16.);\n\t\t\t#elif SHAPEBLEND == 7\n\t\t\t\tconst float levelShiftX[10] = float[10](4., 6., 12., 24., 48., 96., 192., 384., 768., 1536.); \n\t\t\t\tconst float scale = 2. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(64.);\n\t\t\t#elif SHAPEBLEND == 8\n\t\t\t\tconst float levelShiftX[11] = float[11](4., 8., 16., 32., 64., 128., 256., 512., 1024., 2048., 4096.);\n\t\t\t\tconst float scale = scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(128.);\n\t\t\t#else\n\t\t\t\tconst float levelShiftX[8] = float[8](4., 8., 16., 32., 64., 128., 256., 512.);\n\t\t\t\tconst float scale = 4. * scale_factor;\n\t\t\t\tconst vec3 originOffset = vec3(32.);\n\t\t\t#endif\n\n\t\t\t${HB.lookup}\n\n\t\t\tconst vec3 offsets[24] = vec3[](\n\t\t\t\tvec3(0., 0., 0.), vec3(1., 0., 0.),\n\t\t\t\tvec3(1., 0., 0.), vec3(1., 1., 0.),\n\t\t\t\tvec3(0., 1., 0.), vec3(1., 1., 0.),\n\t\t\t\tvec3(0., 0., 0.), vec3(0., 1., 0.),\n\t\t\t\tvec3(0., 0., 1.), vec3(1., 0., 1.),\n\t\t\t\tvec3(1., 0., 1.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 1., 1.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 0., 1.), vec3(0., 1., 1.),\n\t\t\t\tvec3(0., 0., 0.), vec3(0., 0., 1.),\n\t\t\t\tvec3(1., 0., 0.), vec3(1., 0., 1.),\n\t\t\t\tvec3(1., 1., 0.), vec3(1., 1., 1.),\n\t\t\t\tvec3(0., 1., 0.), vec3(0., 1., 1.)\n\t\t\t);\n\n\t\t\tvec2 computeShiftedPosition1(vec2 xy, float levelOriginX) {\n\t\t\t\tvec2 xyShifted = xy;\n\t\t\t\txyShifted.x += levelOriginX;\n\t\t\t\treturn (xyShifted + halfPixelOffset) / pyramidTexture1Size;\n\t\t\t}\n\n\t\t\tvec2 computeShiftedPosition2(vec2 xy, float levelOriginX) {\n\t\t\t\tvec2 xyShifted = xy;\n\t\t\t\txyShifted.x += levelOriginX;\n\t\t\t\treturn (xyShifted + halfPixelOffset) / pyramidTexture2Size;\n\t\t\t}\n\n\t\t\tvec4 unpackVec3ToRGBA(vec3 vec) {\n\t\t\t\tuint combined = uint(vec.x * 65535.0 + 0.5); // Add 0.5 for rounding\n\t\t\t\tfloat g = float(combined & uint(0xFF)) * 0.00392156862; // 1/255\n\t\t\t\tfloat r = float((combined >> 8) & uint(0xFF)) * 0.00392156862; \n\t\t\n\t\t\t\treturn vec4(r, g, vec.y, vec.z);\n\t\t\t}\n\n\t\t\tout vec4 marchColor;\n\t\t\t// end of marchvertPre\n\t\t#endif\n\t\t`;e.vertexShader=t+e.vertexShader.replace("#include <project_vertex>","\n\t\t#ifdef SHAPEBLEND\n\t\t\tfloat triIndex = floor(float(gl_VertexID/3));\n\t\t\tfloat vertexIndex = float(gl_VertexID);\n\t\t\t\n\t\t\t// Initial pyramid lookup\n\t\t\tfloat levelOriginX1 = pyramidTexture1Size.x - 2.;\n\t\t\tfloat levelOriginX2 = pyramidTexture2Size.x - 1.;\n\t\t\tvec2 xy = vec2(0.);\n\t\t\tvec4 lookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));\n\t\t\t\n\t\t\t// Early exit check\n\t\t\tif (triIndex >= lookUp.r) return;\n\t\t\t\n\t\t\t// Optimize loop variables\n\t\t\tfloat start = 0.;\n\t\t\tvec4 triIndexVec = vec4(triIndex);\n\t\t\t\n\t\t\t// Main position computation loop\n\t\t\tfor (int i = 0; i < LOOP;) {\n\t\t\t\t// Compute boundaries\n\t\t\t\tvec4 ends = lookUp + vec4(start);\n\t\t\t\tvec4 starts = vec4(ends.gba, start);\n\t\t\t\tvec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * \n\t\t\t\t\t\t\t\t\t\t\tvec4(lessThan(triIndexVec, ends));\n\t\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t\tlevelOriginX2 -= levelShiftX[i];\n\t\t\t\t\n\t\t\t\t// Update lookup\n\t\t\t\tlookUp = texture(pyramidTexture1, computeShiftedPosition1(xy, levelOriginX1));\n\t\t\t\ti++;\n\n\t\t\t\tends = lookUp + vec4(start);\n\t\t\t\tstarts = vec4(ends.gba, start);\n\t\t\t\tcheck = vec4(greaterThanEqual(triIndexVec, starts)) * \n\t\t\t\t\t\t\t\t\t\t\tvec4(lessThan(triIndexVec, ends));\n\t\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t\tlevelOriginX1 -= levelShiftX[i];\n\t\t\t\t\n\t\t\t\t// Update lookup\n\t\t\t\tlookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));\n\n\t\t\t\ti++;\n\t\t\t}\n\n\t\t\t#if HALF == 1\n\t\t\t\tvec4 ends = lookUp + vec4(start);\n\t\t\t\tvec4 starts = vec4(ends.gba, start);\n\t\t\t\tvec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * vec4(lessThan(triIndexVec, ends));\n\t\t\t\n\t\t\t\t// Update position\n\t\t\t\txy *= 2.;\n\t\t\t\txy += check.r * rShift + check.g * gShift + check.b * bShift;\n\t\t\t\n\t\t\t\t// Update loop variables\n\t\t\t\tstart = dot(check, starts);\n\t\t\t#endif\n\t\t\t\n\t\t\t// Compute final coordinates\n\t\t\tvec3 gridPos;\n\t\t\tgridPos.x = mod(xy.x, VOXEL_RESOLUTION);\n\t\t\tgridPos.y = mod(xy.y, VOXEL_RESOLUTION);\n\t\t\tgridPos.z = floor(xy.x * INV_VOXEL_RESOLUTION) + \n\t\t\t\t\t\t\t\t\tfloor(xy.y * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;\n\t\t\t\n\t\t\t// Vertex key computation\n\t\t\tvertexIndex -= start * 3.;\n\t\t\tfloat vk = vertexIndex * 0.0625 + 0.03125; // Optimized division by 16 and addition of 1/32\n\t\t\t\n\t\t\t// Voxel lookup and edge computation\n\t\t\tvec4 voxel = look(gridPos.x, gridPos.y, gridPos.z, voxelPassTexture);\n\t\t\tfloat key = (voxel.w + 0.5) * 0.00390625; // Optimized division by 256\n\t\t\t\n\t\t\t// Edge lookup and offset computation\n\t\t\tfloat edgeNum = texture(triTable, vec2(vk, key)).x;\n\t\t\tint edgeIndex = int(edgeNum) * 2;\n\t\t\t\n\t\t\t// Compute edge positions\n\t\t\tvec3 p1 = gridPos + offsets[edgeIndex];\n\t\t\tvec3 p2 = gridPos + offsets[edgeIndex + 1];\n\t\t\t\n\t\t\t// Compute potentials and normals\n\t\t\tvec4 potential1 = look(p1.x, p1.y, p1.z, potentialPassTexture);\n\t\t\tvec4 potential2 = look(p2.x, p2.y, p2.z, potentialPassTexture);\n\t\t\t\n\t\t\t// Final position and normal computation\n\t\t\tfloat mu = potential1.r / (potential1.r - potential2.r);\n\n\t\t\tmarchColor = mix(\n\t\t\t\tunpackVec3ToRGBA(potential1.gba),\n\t\t\t\tunpackVec3ToRGBA(potential2.gba),\n\t\t\t\tmu\n\t\t\t);\n\n\t\t\ttransformed = p1 + (p2 - p1) * mu;\n\t\t\ttransformed -= originOffset;\n\t\t\ttransformed *= scale;\n\t\t\tvec4 data1 = look(p1.x, p1.y, p1.z, voxelPassTexture);\n\t\t\tvec4 data2 = look(p2.x, p2.y, p2.z, voxelPassTexture);\n\t\t\tobjectNormal = normalize(mix(data1.xyz, data2.xyz, mu));\n\t\t\ttransformedNormal = normalMatrix * objectNormal;\n\t\t\t#ifndef FLAT_SHADED\n\t\t\t\tvNormal = transformedNormal;\n\t\t\t#endif\n\t\t#endif\n\t\t\n#include <project_vertex>");let n=e.fragmentShader.match(/vec3 diffuseColor[^\n]*\n/);if(!n)return;let i=`\n\t\t#ifdef SHAPEBLEND_C\n\t\t\t#if SHAPEBLEND_C == 1\n\t\t\t\t${n[0].replace(/nodeU0,/g,"marchColor.rgb,").replace(/nodeU\d+(?=,g_uid\d+_calpha\))/g,"marchColor.a")}\n\t\t\t#else\n\t\t\t\t${n[0]}\n\t\t\t#endif\n\t\t#else\n\t\t\t${n[0]}\n\t\t#endif\n\t\t`;e.fragmentShader="in vec4 marchColor;\n"+e.fragmentShader.replace(n[0],i),Object.assign(e.uniforms,this.marchPassUniforms)}initDebugPass(e){console.log("fboToDebug.width",e.width,e.height),this.geometry=new $s(e.width,e.height),this.geometry.userData={parameters:{width:4,height:4}};let t={inputTexture:{value:Array.isArray(e.texture)?e.texture[1]:e.texture},pyramidTextureSize:{value:void 0}},n=e=>{e.vertexShader="\n\t\t\t\tprecision highp float;\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t\tvUv = uv;\n\t\t\t\t}\n\t\t\t",e.fragmentShader="\n\t\t\t\tlayout(location = 1) out vec4 gVelocity;\n\n\t\t\t\tprecision highp float;\n\t\t\t\t\n\t\t\t\tuniform sampler2D inputTexture;\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t\tuniform vec2 pyramidTextureSize;\n\n\t\t\t\tvoid main() {\n\t\t\t\t\t\t// Sample the input texture using UV coordinates\n\t\t\t\t\t\tgl_FragColor = texture(inputTexture, vUv);\n\t\t\t\t\t\tgVelocity = vec4(0.0);\n\t\t\t\t}\n\t\t\t",t.pyramidTextureSize.value=new di(this.pyramidRenderTarget.width,this.pyramidRenderTarget.height),Object.assign(e.uniforms,t)};this.material.shapeBlendhack=n,this.material.root.shapeBlendhack=n}},GB=WB;GB.streamCompaction=new class{constructor(){this.pyramidPassScene=new Ol,this.pyramidPassMaterial=new FB({name:"PyramidPass"}),this.pyramidPassUniforms={inputTexture:{value:void 0},inputWidth:{value:0},inputHeight:{value:0},inputShiftX:{value:0},outputShiftX:{value:0}},this.pyramidTopLevelReadPixelBuffer=new Float32Array(4);this.pyramidPassMaterial.fragmentShader="\n\t\t\tprecision highp float;\n\t\t\tprecision highp sampler2D;\n\t\t\tlayout(location = 0) out vec4 pc_FragColor;\n\t\t\tuniform sampler2D inputTexture;\n\t\t\tuniform float inputWidth;\n\t\t\tuniform float inputHeight;\n\t\t\tuniform float inputShiftX;\n\t\t\tuniform float outputShiftX;\n\t\t\tconst vec2 half_unit_coord = vec2(0.5);\n\t\t\tconst vec4 one = vec4(1.0);\n\t\t\tvoid main() {\n\t\t\t\tvec2 inputSize = vec2(inputWidth, inputHeight);\n\t\t\t\tvec2 input_pixel_uv = 1. / inputSize;\n\t\t\t\tvec2 coord = gl_FragCoord.xy - half_unit_coord;\n\t\t\t\tcoord.x -= outputShiftX;\n\t\t\t\tcoord = coord * 2. + half_unit_coord;\n\t\t\t\tcoord.x += inputShiftX;\n\n\t\t\t\t// sample bottom left corner\n\t\t\t\tvec2 input_uv = coord / inputSize;\n\t\t\t\tfloat bl = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample bottom right corner\n\t\t\t\tinput_uv.x += input_pixel_uv.x;\n\t\t\t\tfloat br = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample top right corner\n\t\t\t\tinput_uv.y += input_pixel_uv.y;\n\t\t\t\tfloat tr = texture(inputTexture, input_uv).r;\n\n\t\t\t\t// sample top left corner\n\t\t\t\tinput_uv.x -= input_pixel_uv.x;\n\t\t\t\tfloat tl = texture(inputTexture, input_uv).r;\n\n\t\t\t\tpc_FragColor.a = bl;\n\t\t\t\tpc_FragColor.b = pc_FragColor.a + br;\n\t\t\t\tpc_FragColor.g = pc_FragColor.b + tr;\n\t\t\t\tpc_FragColor.r = pc_FragColor.g + tl; \n\t\t\t}\n\t\t",this.pyramidPassMaterial.uniforms=this.pyramidPassUniforms,this.pyramidPassMaterial.depthTest=!1,this.pyramidPassMaterial.depthWrite=!1;let e=new Ns(zB,this.pyramidPassMaterial);e.frustumCulled=!1,this.pyramidPassScene.add(e)}renderPyramid(e,t,n,i,r){(new Su).min.setScalar(0);let s=t.length-1,a=new ki;n.getViewport(a),this.pyramidPassUniforms.inputShiftX.value=0,this.pyramidPassUniforms.outputShiftX.value=0;let o=s-1;for(let c=o;c>=0;c--){let s=c%2===o%2?r[0]:r[1],a=c===o?i:c%2===o%2?r[1]:r[0];this.pyramidPassUniforms.inputTexture.value=Array.isArray(a.texture)?a.texture[1]:a.texture,this.pyramidPassUniforms.inputWidth.value=a.width,this.pyramidPassUniforms.inputHeight.value=a.height,n.setRenderTarget(s);let l=t[c],h=n.getPixelRatio();n.setViewport(this.pyramidPassUniforms.outputShiftX.value/h,0,l/h,l/h),2===c&&e%2!==0&&n.setViewport(this.pyramidPassUniforms.outputShiftX.value/h,0,3/h,3/h),n.render(this.pyramidPassScene,jB);let u=this.pyramidPassUniforms.inputShiftX.value;this.pyramidPassUniforms.inputShiftX.value=this.pyramidPassUniforms.outputShiftX.value,this.pyramidPassUniforms.outputShiftX.value=u,c<o&&(this.pyramidPassUniforms.outputShiftX.value+=t[c+1])}n.setViewport(a);let l=t.length%2===0?0:1;return n.readRenderTargetPixelsAsync(r[l],r[l].width-1,0,1,1,this.pyramidTopLevelReadPixelBuffer).then((()=>this.pyramidTopLevelReadPixelBuffer[0]))}};var qB=new vr,KB=new vr,YB=new Fi,QB=new ji,XB=new ji,ZB=new Fi;function JB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.children.length;for(;n--;){let i=this.children[n];JA.is(i)&&$B.call(i,e,t+1)}}function $B(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!0!==e(this,t)){let n=this.children.length;for(;n--;){let i=this.children[n];JA.is(i)&&$B.call(i,e,t+1)}}}function eU(){if(void 0===this.shapesDataTexture.value){let e=new Bl(new Float32Array(1920),VB,5,An,xn);this.shapesDataTexture.value=e}let e=this.shapesDataTexture.value,t=e.image.data;e.needsUpdate=!0;let n=0,i=this.data.geometry.blendRange,r=qB.copy(this.matrixWorld).invert(),s=0;JB.call(this,(e=>{if(!1===e.visible)return!0;let a;if(e instanceof ED)return;if(e instanceof iL||e instanceof kB)return;a=e instanceof lS?e.object:e;let o=e.data?.cloner;if(sS.is(e)&&o&&!o.hideBase&&"radial"!==o.type&&!0!==o.disabled||!(a instanceof DO))return;let l=a.geometry.userData.parameters,c=l.shapeBlendNode;if(void 0===c)return;if(KB.multiplyMatrices(r,e.matrixWorld).decompose(XB,YB,QB),"TorusGeometry"===l.type&&360!==l.arc){let e=l.arc*Math.PI/180;e/=4,YB.multiply(ZB.set(0,0,Math.sin(e),Math.cos(e)))}let h=c.overrideGlobalBlend?c.blendRange:i;h=h/this.bboxSize*2,t[4*s]=(XB.x-this.bboxOffset)/this.bboxSize*2,t[4*s+1]=(XB.y-this.bboxOffset)/this.bboxSize*2,t[4*s+2]=(XB.z-this.bboxOffset)/this.bboxSize*2,t[4*s+3]=0===c.operation?1:2===c.operation?-1:-2,t[384+4*s]=-YB.x,t[384+4*s+1]=-YB.y,t[384+4*s+2]=-YB.z,t[384+4*s+3]=YB.w;let u=new Float32Array(4),d=0;if("SphereGeometry"===l.type)l.width===l.height&&l.width===l.depth?u[0]=0:u[0]=1,u[1]=l.width/this.bboxSize,u[2]=l.height/this.bboxSize,u[3]=l.depth/this.bboxSize,n=Math.max(n,u[1]*QB.x+h,u[2]*QB.x+h,u[3]*QB.x+h);else if("CubeGeometry"===l.type){d=l.cornerRadius;let e=l.width,t=l.height,i=l.depth;u[0]=2,u[1]=(e-2*d)/this.bboxSize,u[2]=(t-2*d)/this.bboxSize,u[3]=(i-2*d)/this.bboxSize,n=Math.max(n,Math.sqrt(e**2+t**2+i**2)/this.bboxSize*QB.x+h)}else if("CylinderGeometry"===l.type){d=l.cornerRadius;let e=l.height,t=l.radiusBottom,i=l.radiusTop;if(i>=t){let n=Math.atan2(i-t,e),r=(Math.PI/2-n)/2;i-=d/Math.tan(r),t-=d*Math.tan(r)}else if(t>i){let n=Math.atan2(t-i,e),r=(Math.PI/2-n)/2;i-=d*Math.tan(r),t-=d/Math.tan(r)}u[1]=(l.height-2*d)/this.bboxSize,t===i?(u[0]=3,u[2]=t/this.bboxSize*2):(u[0]=4,u[2]=t/this.bboxSize*2,u[3]=i/this.bboxSize*2),n=Math.max(n,4*u[1]*QB.x+h)}else if("TorusGeometry"===l.type){if(u[0]=5,u[1]=(l.width-l.depth)/this.bboxSize,u[2]=l.depth/this.bboxSize,360!==l.arc){u[0]=6,u[3]=u[1],t[1152+4*s+3]=u[2];let e=2*Math.atan2(u[2]/2,u[1]),n=l.arc*Math.PI/180/2-e;u[1]=Math.sin(n),u[2]=Math.cos(n)}n=Math.max(n,l.width*QB.x/this.bboxSize+h)}t.set(u,768+4*s),t[1152+4*s]=h,t[1152+4*s+1]=d/this.bboxSize*2,t[1152+4*s+2]=QB.x;let p=a.material,f=p.uniforms.nodeU0.node.value,m=p.uniforms.nodeU1.value;0!==c.operation&&!c.useColor&&(m=-1),t[1536+4*s]=f.r,t[1536+4*s+1]=f.g,t[1536+4*s+2]=f.b,t[1536+4*s+3]=m,m<1&&1===this.material.defines.SHAPEBLEND_C&&(this.material.transparent=!0),s++})),this.npart=s,this.spatialPassUniforms.span.value=1.4*n}function tU(e,t){let n=!1,i=512&e.layers.mask,r=t.getLayersOfType("transmission"),s=t.getLayersOfType("outline");return s.length>0&&(e.layers.set(8),r.length>0&&e.layers.enable(3),n=!0,RO(e),LO(e)),0===r.length&&0===s.length&&e.layers.set(0),i&&e.layers.set(9),e instanceof TO&&e.needsAO&&e.layers.enable(5),n}function nU(e,t){if(!t.layers)return!1;let n=512&e.layers.mask,i=!1,r=t.getLayersOfType("transmission").filter((e=>e.data.visible)),s=t.getLayersOfType("outline").filter((e=>e.data.visible));return r.length>0&&(e.layers.set(3),s.length>0&&e.layers.enable(8),i=!0),0===r.length&&0===s.length&&e.layers.set(0),n&&e.layers.set(9),e.needsAO&&e.layers.enable(5),i}var iU=new wu,rU=new vr,sU=new gr;function aU(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e.cloner;if(r)for(let s of r.children){let r=rU.copy(s.matrixWorld).invert(),a=sU.copy(t.ray).applyMatrix4(r),o=e.matrixWorld;a.applyMatrix4(o);let l=iU;l.set(a.origin,a.direction),l.near=t.near,l.far=t.far;let c=l.intersectObject(e,!1);c.length>0&&n.push({...c[0],object:i?s:e})}}var oU=class{constructor(){this._constraints=new Map}setConstraint(e,t){null===t?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach(((n,i)=>{let r=[i,n],s=n;for(;this._constraints.has(s);){if(s=this._constraints.get(s),r.includes(s)){console.warn(`circular dependency detected: ${r.join(" -> ")}`);break}t.has(s)||r.push(s)}for(let a=r.length-2;a>=0;a--)if(!t.has(r[a])){let n=e.find(r[a]);n?n.applyPathSnapping(e):console.warn(`missing entity ${r[a]}`),t.add(r[a])}}))}findDependency(e,t){let n=e;for(;this._constraints.has(n);)if(n=this._constraints.get(n),n===t)return!0;return!1}},lU=class{};function cU(e){let t,n,i,r,s,a,o,l,c,h,u,d,p,f,m,g;function v(e,t,a){let o=new Float32Array(h,s,3*n);i=0;let l=new Uint32Array(h,r,n);for(let n=0;n<a.length-1;n++){let r=t[n],s=e[n].elements,c=r.filter((e=>e.enabled&&"Include"===e.mode)).map((e=>"Box"===e.type?b(e):x(e))),h=r.filter((e=>e.enabled&&"Exclude"===e.mode)).map((e=>"Box"===e.type?b(e):x(e)));for(let e=a[n];e<a[n+1];e++){let t=p[3*e],n=p[3*e+1],r=p[3*e+2];if((0===c.length||y(t,n,r,c))&&(0===h.length||!y(t,n,r,h))){let a=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);o[3*i]=(s[0]*t+s[4]*n+s[8]*r+s[12])*a,o[3*i+1]=(s[1]*t+s[5]*n+s[9]*r+s[13])*a,o[3*i+2]=(s[2]*t+s[6]*n+s[10]*r+s[14])*a,l[i]=e,i++}}}}function y(e,t,n,i,r){return i["Intersect"===r?"every":"some"]((i=>{let r=function(e,t,n,i,r){let s=e-r[0],a=t-r[1],o=n-r[2],l=1/(i[3]*s+i[7]*a+i[11]*o+i[15]);return{x:(i[0]*s+i[4]*a+i[8]*o+i[12])*l+r[0],y:(i[1]*s+i[5]*a+i[9]*o+i[13])*l+r[1],z:(i[2]*s+i[6]*a+i[10]*o+i[14])*l+r[2]}}(e,t,n,i.invRotationMatrix,i.cropCenter);return Array.isArray(i)?function(e,t,n,i){return e>=i[0]&&e<=i[3]&&t>=i[1]&&t<=i[4]&&n>=i[2]&&n<=i[5]}(r.x,r.y,r.z,i):function(e,t,n,i){let r=(e-i.cropCenter[0])*i.invRadiusX,s=(t-i.cropCenter[1])*i.invRadiusY,a=(n-i.cropCenter[2])*i.invRadiusZ;return r*r+s*s+a*a<=1}(r.x,r.y,r.z,i)}))}function b(e){let t=e.cropSize[0]/2,n=e.cropSize[1]/2,i=e.cropSize[2]/2,r=[e.cropCenter[0]-t,e.cropCenter[1]-n,e.cropCenter[2]-i,e.cropCenter[0]+t,e.cropCenter[1]+n,e.cropCenter[2]+i],s=w(e.cropRotation);return Object.assign(r,{invRotationMatrix:s,cropCenter:e.cropCenter})}function w(e){let t=[],n=e[0]*Math.PI/180,i=e[1]*Math.PI/180,r=e[2]*Math.PI/180,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),c=Math.cos(r),h=Math.sin(r),u=s*c,d=s*h,p=a*c,f=a*h;return t[0]=o*c,t[1]=-o*h,t[2]=l,t[4]=d+p*l,t[5]=u-f*l,t[6]=-a*o,t[8]=f-u*l,t[9]=p+d*l,t[10]=s*o,t[12]=0,t[13]=0,t[14]=0,t[3]=0,t[7]=0,t[11]=0,t[15]=1,t}function x(e){let t=2/e.cropSize[0],n=2/e.cropSize[1],i=2/e.cropSize[2],r=w(e.cropRotation);return{invRadiusX:t,invRadiusY:n,invRadiusZ:i,cropCenter:e.cropCenter,invRotationMatrix:r}}e.onmessage=w=>{if(w.data.getCroppedIndexes){let t=new Uint32Array(function(e,t){let n=[],i=t.filter((e=>e.enabled&&"Include"===e.mode)).map((e=>"Box"===e.type?b(e):x(e))),r=t.filter((e=>e.enabled&&"Exclude"===e.mode)).map((e=>"Box"===e.type?b(e):x(e))),s=e.length;for(let a=0;a<s;a+=3){let t=e[a],s=e[a+1],o=e[a+2];(0===i.length||y(t,s,o,i))&&(0===r.length||!y(t,s,o,r))||n.push(a/3)}return n}(new Float32Array(w.data.positions),w.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:t},[t])}else if(w.data.positions)u=w.data.positions,p=new Float32Array(u),m=w.data.meshMatrixWorlds,g=w.data.cropsArray,f=w.data.meshIndexIntervals,v(m,g,f),e.postMessage({sortSetupComplete:!0});else if(w.data.sort||w.data.newMatrixWorlds||w.data.newCropsArray)(w.data.newMatrixWorlds||w.data.newCropsArray)&&(g=w.data.newCropsArray||g,m=w.data.newMatrixWorlds||m,v(m,g,f)),function(u){let p,f=new Float64Array(h,a,16);for(let e=0;e<16;e++)f[e]=u[e];if(i>1){t.exports.sortIndexes(r,s,c,a,o,l,d.DepthMapRange,i);let e=new Uint32Array(i);p=e.buffer,e.set(new Uint32Array(h,l,i))}else if(1===i){let e=new Uint32Array(i);e[0]=new Uint32Array(h,r,n)[0],p=e.buffer}else p=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:p},[p])}(w.data.sort.view,w.data.sort.cameraPosition);else if(w.data.init){d=w.data.init.Constants,n=w.data.init.splatCount;let i=d.BytesPerInt,u=3*d.BytesPerFloat,p=new Uint8Array(w.data.init.sorterWasmBytes),f=n*(i+u)+(n*d.BytesPerInt*2+d.DepthMapRange*d.BytesPerInt*2)+32*d.MemoryPageSize,m=Math.floor(f/d.MemoryPageSize)+1,g={module:{},env:{memory:new WebAssembly.Memory({initial:2*m,maximum:3*m,shared:!0})}};WebAssembly.compile(p).then((e=>WebAssembly.instantiate(e,g))).then((p=>{t=p,r=0,s=n*i,a=s+n*u,c=a+16*d.BytesPerFloat*2,o=c+n*d.BytesPerInt,l=o+d.DepthMapRange*d.BytesPerInt,h=g.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})}))}}}Nt(lU,"DepthMapRange",65536),Nt(lU,"MemoryPageSize",65536),Nt(lU,"BytesPerFloat",4),Nt(lU,"BytesPerInt",4);var hU=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(n){return e[0]=n,t[0]}}(),uU=function(e,t,n,i){return e+(t<<8)+(n<<16)+(i<<24)},dU=new di;function pU(e){let t=!1;return e.scene.objects.traverse(((e,n)=>{if(!1===n.visible)return!0;"Splat"===n.type&&(t=!0)})),t}var fU,mU,gU,vU=class extends Ns{constructor(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6?arguments[6]:void 0,o=arguments.length>7?arguments[7]:void 0;super(n,i),this.splatCount=t,this.meshIndexIntervals=a,this.meshMatrixWorlds=o,this.splatBuffers=e,this.geometry=n,this.material=i,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=r,this.devicePixelRatio=s,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,a=vU.buildGeomtery(t),o=vU.buildMaterial(r);return new vU(e,t,a,o,n,i,r,s)}static buildMaterial(e){let t={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new di},viewport:{type:"v2",value:new di},basisViewport:{type:"v2",value:new di},debugColor:{type:"v3",value:new Mi},covariancesTextureSize:{type:"v2",value:new di(1024,1024)},centersColorsTextureSize:{type:"v2",value:new di(1024,1024)},orthoZoom:{type:"f",value:-1}};return new Bs({uniforms:t,vertexShader:"\n            precision highp float;\n            #include <common>\n\n            attribute uint splatIndex;\n\n            uniform highp sampler2D covariancesTexture;\n            uniform highp usampler2D centersColorsTexture;\n            uniform vec2 focal;\n            uniform vec2 viewport;\n            uniform vec2 basisViewport;\n            uniform vec2 covariancesTextureSize;\n            uniform vec2 centersColorsTextureSize;\n\t\t\t\t\t\tuniform highp sampler2D meshMatrixWorldsTexture;\n\t\t\t\t\t\tuniform uint meshIndexIntervals[257];\n\t\t\t\t\t\tuniform float orthoZoom;\n\n            varying vec4 vColor;\n            varying vec2 vUv;\n\n            varying vec2 vPosition;\n\n            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\n            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));\n            const uvec4 shift4 = uvec4(0, 8, 16, 24);\n            vec4 uintToRGBAVec (uint u) {\n               uvec4 urgba = mask4 & u;\n               urgba = urgba >> shift4;\n               vec4 rgba = vec4(urgba) * encodeNorm4;\n               return rgba;\n            }\n\n            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {\n                vec2 samplerUV = vec2(0.0, 0.0);\n                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;\n                samplerUV.y = float(floor(d)) / dimensions.y;\n                samplerUV.x = fract(d);\n                return samplerUV;\n            }\n\n            void main () {\n                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));\n                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));\n                vColor = uintToRGBAVec(sampledCenterColor.r);\n\n                vPosition = position.xy * 2.0;\n\n\t\t\t\t\t\t\t\tuint meshIndex;\n\t\t\t\t\t\t\t\tfor (int i = 1; i < 257; i++) {\n\t\t\t\t\t\t\t\t\tif (splatIndex < meshIndexIntervals[i]) {\n\t\t\t\t\t\t\t\t\t\tmeshIndex = uint(i - 1);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tfloat strideMulmeshIndex = float(4u*meshIndex);\n\t\t\t\t\t\t\t\tfloat meshMatrixWorldsTextureLength = float(256*4);\n\n\t\t\t\t\t\t\t\tmat4 modelMat = mat4(\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),\n\t\t\t\t\t\t\t\t\ttexture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tmat4 modelViewMat = viewMatrix * modelMat;\n\t\t\t\t\t\t\t\tvec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); \n                vec4 clipCenter = projectionMatrix * viewCenter;\n\n                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;\n                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;\n                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;\n\n                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);\n                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);\n\n                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix\n                mat3 Vrk = mat3(\n                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,\n                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,\n                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z\n                );\n                float s = 1.0 / (viewCenter.z * viewCenter.z);\n\n                mat3 W = transpose(mat3(modelViewMat));\n                mat3 T = orthoZoom > 0.0 ? W : W * mat3(\n\t\t\t\t\t\t\t\t\tfocal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,\n\t\t\t\t\t\t\t\t\t0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,\n\t\t\t\t\t\t\t\t\t0., 0., 0.\n\t\t\t\t\t\t\t\t);\n                mat3 cov2Dm = transpose(T) * Vrk * T;\n                cov2Dm[0][0] += 0.3;\n                cov2Dm[1][1] += 0.3;\n\n                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because\n                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],\n                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't\n                // need cov2Dm[1][0] because it is a symetric matrix.\n                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);\n\n                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;\n\n                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix\n                // so that we can determine the 2D basis for the splat. This is done using the method described\n                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html\n                //\n                // This is a different approach than in the original work at INRIA. In that work they compute the\n                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle\n                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance\n                // matrix (called 'conic') to determine fragment opacity.\n                float a = cov2Dv.x;\n                float d = cov2Dv.z;\n                float b = cov2Dv.y;\n                float D = a * d - b * b;\n                float trace = a + d;\n                float traceOver2 = 0.5 * trace;\n                float term2 = sqrt(trace * trace / 4.0 - D);\n                float eigenValue1 = traceOver2 + term2;\n\t\t\t\t\t\t\t\tfloat eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value\n\n                const float maxSplatSize = 1024.0;\n                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));\n                // since the eigen vectors are orthogonal, we derive the second one from the first\n                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);\n                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);\n                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);\n\n                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;\n\n\t\t\t\t\t\t\t\tif (orthoZoom > 0.0) {\n\t\t\t\t\t\t\t\t\tndcOffset *= orthoZoom;\n\t\t\t\t\t\t\t\t}\n\n                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);\n            }",fragmentShader:"\n            precision highp float;\n            #include <common>\n\n            uniform vec3 debugColor;\n\n            varying vec4 vColor;\n            varying vec2 vUv;\n\n            varying vec2 vPosition;\n\t\t\t\t\t\tlayout(location = 1) out vec4 gVelocity; \n\n            void main () {\n                // compute the negative squared distance from the center of the splat to the\n                // current fragment in the splat's local space.\n                float A = -dot(vPosition, vPosition);\n                if (A < -4.0) discard;\n                vec3 color = vColor.rgb;\n                A = exp(A) * vColor.a;\n                gl_FragColor = vec4(color.rgb, A);\n\t\t\t\t\t\t\t\tgVelocity = vec4(0.0); // so it is ignored by TAA\n            }",transparent:!0,alphaTest:1,blending:1,depthTest:!0,depthWrite:!1,side:2})}static buildGeomtery(e){let t=new gs;t.setIndex([0,1,2,0,2,3]);let n=new Float32Array(12),i=new ss(n,3);t.setAttribute("position",i),i.setXYZ(0,-1,-1,0),i.setXYZ(1,-1,1,0),i.setXYZ(2,1,1,0),i.setXYZ(3,1,-1,0),i.needsUpdate=!0;let r=(new eu).copy(t),s=new Uint32Array(e),a=new jl(s,1,!1);return a.setUsage(35048),r.setAttribute("splatIndex",a),r.instanceCount=e,r}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach((e=>e.buildPreComputedBuffers())),this.covariances=new Float32Array(6*this.splatCount),this.colors=new Uint8Array(4*this.splatCount),this.centers=new Float32Array(3*this.splatCount);let e=0,t=0,n=0;for(let i of this.splatBuffers){let r=i.nsplats;this.colors.subarray(e,e+4*r).set(i.colorsA),e+=4*r,this.centers.subarray(t,t+3*r).set(i.decoded.xyz.denormDequant().data),t+=3*r,this.covariances.subarray(n,n+6*r).set(new Float32Array(i.precomputedCovarianceBufferData)),n+=6*r}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new di(4096,1024);for(;t.x*t.y*2<6*e;)t.y*=2;let n,i,r=new di(4096,1024);for(;r.x*r.y*4<4*e;)r.y*=2;if(this.halfPrecisionCovariancesOnGPU){i=new Uint16Array(t.x*t.y*2);for(let e=0;e<this.covariances.length;e++)i[e]=Hu.toHalfFloat(this.covariances[e]);n=new Bl(i,t.x,t.y,Pn,En)}else i=new Float32Array(t.x*t.y*2),i.set(this.covariances),n=new Bl(i,t.x,t.y,Pn,xn);n.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=n,this.material.uniforms.covariancesTextureSize.value.copy(t);let s=new Uint32Array(r.x*r.y*4);for(let c=0;c<e;c++){let e=4*c,t=3*c,n=4*c;s[n]=uU(this.colors[e],this.colors[e+1],this.colors[e+2],this.colors[e+3]),s[n+1]=hU(this.centers[t]),s[n+2]=hU(this.centers[t+1]),s[n+3]=hU(this.centers[t+2])}let a=new Bl(s,r.x,r.y,1033,wn);a.internalFormat="RGBA32UI",a.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=a,this.material.uniforms.centersColorsTextureSize.value.copy(r);let o=new Float32Array(4096);for(let c=0;c<this.meshMatrixWorlds.length;c++)o.set(this.meshMatrixWorlds[c].elements,16*c);let l=new Bl(o,1024,1,An,xn);l.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=l,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:i,texture:n,size:t},centerColors:{data:s,texture:a,size:r},meshMatrixWorlds:{data:o,texture:l}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,n,i){this.splatCount>0&&(dU.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(dU),this.material.uniforms.basisViewport.value.set(2/dU.x,2/dU.y),this.material.uniforms.focal.value.set(t,n),this.material.uniforms.orthoZoom.value=i,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},yU=new Promise((e=>{fU=e})),bU=!1;function wU(){if(!bU)return mU||(mU=async function(){let e=await n.e(5023).then(n.bind(n,15023));fU(e),bU=!0}(),mU)}yU.then((e=>gU=e));var xU=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Nt(this,"updateView",function(){let e=new vr,t=[],n=new ji(0,0,-1),i=new ji(0,0,-1),r=new ji,s=new ji;return function(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1?arguments[1]:void 0,l=this.updateMatrixWorldsInWorkerIfNeeded(),c=this.cropsChanged();if(!a){i.set(0,0,-1).applyQuaternion(o.quaternion);let e=!1,t=!1;if(i.dot(n)<=.95&&(e=!0),s.copy(o.position).sub(r).length()>=1&&(t=!0),!e&&!t&&!l&&!c&&!this.needsInitialRender)return}this.needsInitialRender=!1,r.copy(o.position),n.copy(i),e.copy(o.matrixWorld).invert(),e.premultiply(this.dummyPerspectiveMatrix),t[0]=o.position.x,t[1]=o.position.y,t[2]=o.position.z;let h={sort:{view:e.elements,cameraPosition:t,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...l?{newMatrixWorlds:this.meshMatrixWorlds}:{},...c?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=h:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(h))}}()),this.scene=e.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=(new vr).makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(e,t){let n=new di;null!==this.splatMesh&&this.splatMesh.getSplatCount()>0&&(e.getSize(n),this.cameraFocalLengthX=t.projectionMatrix.elements[0]*this.devicePixelRatio*n.x*.45,this.cameraFocalLengthY=t.projectionMatrix.elements[5]*this.devicePixelRatio*n.y*.45,this.splatMesh.updateUniforms(n,this.cameraFocalLengthX,this.cameraFocalLengthY,t.isPerspectiveCamera?-1:t.zoom*this.devicePixelRatio))}loadSplat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.activePage=this.scene.activePage,e.position&&(e.position=(new ji).fromArray(e.position)),e.orientation&&(e.orientation=(new Fi).fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseVisibleEntity((e=>{"Splat"===e.data.type&&t.push(e)})),this.splatMesh&&this.splatMesh.dispose(),0===t.length)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map((e=>e.matrixWorld)),this.meshMatrixWorldsOld=t.map((e=>e.matrixWorld.clone())),this.cropsArray=t.map((e=>e.data.crops.map((e=>e.data))));let n=t.map((e=>new gU.GSplineBuffer(new Uint8Array(e.data.buffer).buffer))),i=0,r=[0];for(let s of n)i+=s.getSplatCount(),r.push(i);return this.setupSplatMesh(n,i,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,r,this.meshMatrixWorlds),this.setupSortWorker(i),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,16*t);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,!this.meshMatrixWorlds.every(((e,t)=>e.equals(this.meshMatrixWorldsOld[t])))&&(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map((e=>e.clone())),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach(((t,n)=>{t.data.crops.forEach(((t,i)=>{void 0===this.cropsArray[n][i]?(e=!0,this.cropsArray[n][i]=t.data):Object.entries(t.data).forEach((t=>{let[r,s]=t;(Array.isArray(s)&&s.some(((e,t)=>e!==this.cropsArray[n][i][r][t]))||s!==this.cropsArray[n][i]?.[r])&&(e=!0,this.cropsArray[n][i][r]=s)}))})),t.data.crops.length!==this.cropsArray[n]?.length&&(this.cropsArray[n].length=t.data.crops.length,e=!0)})),e}setupSplatMesh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ji,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Fi,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6?arguments[6]:void 0,o=arguments.length>7?arguments[7]:void 0;this.splatMesh=vU.buildMesh(e,t,r,s,a,o),this.splatMesh.position.copy(n),this.splatMesh.quaternion.copy(i),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=t,this.splatMesh.onBeforeRender=(e,t,n)=>this.update(e,n)}setupSortWorker(e){this.sortWorker=function(e){let t=new Worker(URL.createObjectURL(new Blob(["(",cU.toString(),")(self)"],{type:"application/javascript"}))),n=atob("AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL"),i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return t.postMessage({init:{sorterWasmBytes:i.buffer,splatCount:e,Constants:{BytesPerFloat:lU.BytesPerFloat,BytesPerInt:lU.BytesPerInt,DepthMapRange:lU.DepthMapRange,MemoryPageSize:lU.MemoryPageSize}}}),t}(e),this.sortWorker.onmessage=e=>{e.data.sortDone?(this.sortRunning=!1,this.splatMesh?.updateIndexes(new Uint32Array(e.data.indexesBuffer)),this.lastSortTime=e.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):e.data.sortCanceled?this.sortRunning=!1:e.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):e.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(e,t){null!==this.splatMesh&&(this.updateSplatMeshUniforms(e,t),this.updateView(!1,t))}getSplatMesh(){return this.splatMesh}},EU=new ns;EU.wireframe=!0;var CU=new ji,AU=class extends Ol{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.shapeBlendIntances=[],this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new oU,this.invisibleObjects=new nL("jflkdsafjasdifjaslk",{...lE.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new pB("fdasfa",{...vE.defaultData,name:""},{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=function(e){let t=!1;return e.traverseEntity((e=>{if(e instanceof TO)if(Array.isArray(e.material))for(let n=0;n<e.material.length;n++)nU(e,e.material[n])&&(t=!0);else nU(e,e.material)&&(t=!0)})),t}(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=function(e){let t=!1;return e.traverseEntity((e=>{if(e instanceof TO)if(Array.isArray(e.material))for(let n=0;n<e.material.length;n++)tU(e,e.material[n])&&(t=!0);else tU(e,e.material)&&(t=!0)})),t}(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),n=this.entityIdentityToEntity[t];n&&(e.uuid=n.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof pB&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(void 0===t)return;let n=[],i=t;for(;i!==this;){let e=i;i=i.parent;let t=i.children.indexOf(e);n.splice(0,0,t)}return{entity:t,sortKey:n}}getAllSorted(e){let t=[];for(let n of e){let e=this.getWithSortKey(n.id);void 0!==e&&t.push(e)}return t.sort(((e,t)=>Vv(e.sortKey,t.sortKey))),t.map((e=>e.entity))}nonExistOrDescendantOf(e,t){let n=this.find(e);if(void 0===n)return!0;for(;n;){if(n.uuid===t)return!0;n=n.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if("f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera"===e)return this.activePage.personalCamera;if(e===gx)return this.activePage.personalCamera}if(""===e||void 0===e)return;let t=this.entityByUuid[e];return void 0===t?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof pB&&t.uiScene){let n=t.uiScene.find(e);if(n)return n}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof pB&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity((n=>{void 0===t&&n instanceof CB&&(t=n.uiCanvas.find(e))})),t}traverse2D(e){for(let t of this.children)t instanceof pB&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);t?Array.isArray(t.identity)&&void 0===this.findInstance(t.identity)&&console.error("not found instance"):console.error("not found")}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors((e=>{this.toExpandCloner.add(e)}))}doPendingExpandCloner(){this.toExpandCloner.forEach((e=>{e.expandCloner(this)})),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach((e=>{e.cloner?.update()})),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach((e=>e())),this.pendingCommands.length=0}updateByLibOp(e,t){1===e.path.length&&"components"===e.path[0]&&1===e.type&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){if(0===e.path.length&&7===e.type){let n=null===e.parent?this:this.find(e.parent);if(void 0===n)throw new Error("unexpected");let i=this.createObject(e.id,e.data,e.children,n,e.localIndex,t);i.updateVisible(this),i.resetBBoxNeedsUpdate(),YD(i)&&QD(i.parent)&&(i.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(i),this.markToExpandCloner(i),this.markPenumbraSizeDirty(),i.updatePathSnapping()}else if(0===e.path.length&&8===e.type){let t=this.find(e.id);if(void 0===t)throw new Error("unexpected");t.traverseEntity((e=>{e instanceof GB&&(this.shapeBlendIntances=this.shapeBlendIntances.filter((t=>t!==e)))})),this.markToExpandCloner(t),t.resetBBoxNeedsUpdate(),this.unregisterObject(t);let n=t.parent;this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(t),this.markPenumbraSizeDirty(),t.parent.remove(t),QD(t.parent)&&(t.parent.invalidateUpstreamBooleanData(),t.parent.invalidateDownstreamBooleanData().recomputeBoolean()),YD(t)&&(t.freeBooleanPointer(),n instanceof qD&&n.invalidateDownstreamBooleanData().recomputeBoolean()),t instanceof gB&&t.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(t),this.pathConstraints.removeDependencies(t.uuid),t.updatePathSnapping()}else if(0===e.path.length&&9===e.type){let t=this.find(e.id);if(void 0===t)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(t);let n=t.parent;this.markNeedsRecomputeInstancesForAncessors(n),t.cloner?.resetOnMove(),this.markToExpandCloner(t);let i=null===e.parent?this:this.find(e.parent);if(void 0===i)throw new Error("unexpected");i.add(t),this.markNeedsRecomputeInstancesForAncessors(i),this.markToExpandCloner(t),t.invalidateClonerTransform(t),t.updateVisible(this),t.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let r=e.localIndex;i.children.splice(r,0,i.children.pop()),YD(t)&&(t.invalidateUpstreamBooleanData(),QD(t.parent)?t.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof qD&&n.invalidateDownstreamBooleanData().recomputeBoolean()),t.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let t of this.children)t instanceof pB&&(t.visible=t.uuid===e,t.visible&&(this.activePage=t,this.activePage.onActive(this)));this.activePage!==this.splatViewer?.activePage&&this.reloadSplats()}updateEntityByOp(e,t,n,i){if(0===t.type){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:e}=t.props;t={...t,props:e},this.markNeedsRecomputeInstances()}"pathSnapping"===t.path[0]&&void 0!==t.props.pathId&&this.pathConstraints.setConstraint(e,t.props.pathId)}let r=this.find(e);if(r)try{(function(e,t,n,i){e.updateByOp(t,n,i,!1)})(r,t,n,{scene:this,shared:i}),r instanceof DO&&r.updateGeometryGroupsIfNeeded()}catch(Jw){console.error(Jw)}}updateEntity2DByOp(e,t,n,i,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];e.updateEntityByOp(t,n,i,r),this.traverseEntity((e=>{(e instanceof CB||e instanceof pB)&&(s.includes(e.frameId??"")||e.frameId===t)&&e.updateEntity2DByOp(t,n,i,r)}))}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let n=Object.entries(t.data.lib.components).map(((e,t)=>({data:e[1].asset.data,children:e[1].asset.children,id:e[0],fi:t})));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(n,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity((e=>{e instanceof jD&&e.updateUp()})),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity((e=>{("Component"===e.data.type||"Instance"===e.data.type)&&this.markNeedsRecomputeInstances()}))}markNeedsRecomputeInstancesForAncessors(e){sS.is(e)&&("Component"===e.data.type&&this.markNeedsRecomputeInstances(),e.traverseAncestors((e=>{sS.is(e)&&"Component"===e.data.type&&this.markNeedsRecomputeInstances()})))}relativeizeInner(e,t,n,i,r,s,a){if(e){let o=i.find(e);o&&o!==i&&r.forInstancesRec((i=>{i.data=Qy(i.data,(r=>{let o=r.events.data(a.id),l=i.goUp(s);if(l){let i=[...jv(l.identity),e].join("-"),r=this.entityIdentityToEntity[i];if(r){let e=r.uuid;Gy.zoom(o,t)[n]=e}else console.warn("cannot find instance")}})).data}))}}rewriteActions(e,t,n,i,r,s){e.forEach((e=>{"Transition"===e.data.type||"Animation"===e.data.type?this.relativeizeInner(e.data.object,[...t,e.id],"object",n,i,r,s):"Conditional"===e.data.type&&(this.rewriteActions(e.data.ifActions,[...t,e.id,"ifActions"],n,i,r,s),this.rewriteActions(e.data.elseActions,[...t,e.id,"elseActions"],n,i,r,s))}))}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity((e=>{if(e instanceof yB&&"string"==typeof e.identity&&"Component"===e.data.type)return e.traverseEntity(((t,n)=>{t.data.events.forEach((i=>{if("GameControl"===i.data.type){let r=!1;if(t.forInstancesRec((e=>{e.data=Qy(e.data,(t=>{e.isInstanceRoot||(t.events.delete(i.id),r=!0)})).data})),!1===r)for(let s of kE.list)this.rewriteActions(i.data.gameActions[s],["gameActions",s],e,t,n,i)}else"Conditional"===i.data.type?("Distance"===i.data.condition.type?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",e,t,n,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",e,t,n,i)):"State"===i.data.condition.type?this.relativeizeInner(i.data.condition.object,["condition"],"object",e,t,n,i):"Comparison"===i.data.condition.type&&("Property"===i.data.condition.lOperand.type&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,n,i),"Property"===i.data.condition.rOperand.type&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,n,i)),this.rewriteActions(i.data.inActions,["inActions"],e,t,n,i),this.rewriteActions(i.data.outActions,["outActions"],e,t,n,i)):"actions"in i.data&&this.rewriteActions(i.data.actions,["actions"],e,t,n,i)}))})),!0}))}expandInstances(e,t,n){let i=new Set;this.traverseEntity((r=>{if(r instanceof yB&&r.isInstanceRoot)return r.expandInstanceChildren({scene:this,shared:e,pendingDeletes:i}),t||r.resetBBoxNeedsUpdate(),n&&r.traverseEntity((e=>{n.addClip(e)})),!0}));for(let r of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),bB(r)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity((e=>{e instanceof yB&&e.isInstanceRoot&&(e.component=void 0)})),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity((e=>{let t="string"==typeof e.identity?e.identity:e.identity.join("-");this.entityIdentityToEntity[t]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[t]),e.dispose()}))}clearScene(){for(let e of this.children)sS.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let n=[],i=r=>{for(let s of r.children){let r=s.cloner;if(sS.is(s)&&!s.raycastLock&&(s.visible||r?.object.data.visible))if(!0===t&&s.isInstanceRoot){let t=[];if(e.intersectObject(s,!0,t),t.length){let e=t[0];e.object=s,e.point.applyMatrix4(e.object.matrixWorld);let i=s.matrixWorld.clone().invert();e.point.applyMatrix4(i),n.push(e)}}else(YD(s)||XD(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,n),aU(s,e,n)),i(s)}};return i(this.activePage),n}raycastWithClones(e){let t=[],n=i=>{for(let r of i.children){let i=r.cloner;sS.is(r)&&(r.visible||i?.object.data.visible)&&((YD(r)||XD(r)&&this.enableHelpers&&r.objectHelper.visible)&&(e.intersectObject(r,!1,t),aU(r,e,t,!0)),n(r))}};return n(this),t}forEachEntity(e){for(let t of this.children)sS.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)sS.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)sS.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity((n=>{if(n instanceof DO&&"Mesh"===n.data.type&&("TextGeometry"===n.data.geometry.type||"InputGeometry"===n.data.geometry.type)&&n.data.geometry.font===e){let i=n.geometry,r=n.data.geometry;i.updateFont(e,t).then((()=>{i.update(r);let e=n.invalidateDownstreamBooleanData();QD(e)&&e.recomputeBoolean()}))}}))}traverseObject(e){for(let t of this.children)JA.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)sS.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,n){let i=0;for(let r of e)this.createObject(r.id,r.data,r.children,t,i,n),i+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,n,i,r,s){let a={scene:this,shared:s},o=UB(e,t,a);return o instanceof GB&&this.shapeBlendIntances.push(o),o&&(this.entityByUuid[e]=o,i.add(o),i.children.splice(r,0,i.children.pop()),n.length>0&&(o.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(n,o,s)),o.updateState(t,a),o instanceof DO&&o.updateGeometryGroupsIfNeeded(),o.updateVisible(this),o.cloner&&this.toExpandCloner.add(o),t.pathSnapping?.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),"Empty"===t.type&&t.animations&&o.traverseEntity((e=>{let t=e.dataPatched;if(e instanceof DO&&t.bones&&t.boneInverses){let n=t.bones.map((e=>this.find(e))),i=t.boneInverses.map((e=>(new vr).fromArray(e))),r=new Fl(n,i);e.bind(r,e.bindMatrix)}else e.matrixAutoUpdate=!0})),o}getCenter(e){let t=[];for(let i=0,r=e.length;i<r;++i){let{id:n,recursive:r}=e[i],s=this.find(n),a=r?s.recursiveBBox:s.singleBBox;t.push(...a.vertices)}let n=new Wi;return n.setFromPoints(t),n.getCenter(CU),CU}copyMatrixWorld(e,t){if(null===e)return void t.identity();let n=this.find(e);n?t.copy(n.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){if(null===e)return void t.identity();let n=this.find(e)?.parent;n?t.copy(n.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity((t=>{if(t instanceof $P)if(Array.isArray(t.material))for(let n=0;n<t.material.length;n++)t.material[n]instanceof RI&&e(t.material[n]);else t.material instanceof RI&&e(t.material)}))}updateViewPlaneSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.traverseConcreteEntity((i=>{i instanceof jD&&i.setViewplaneSize(e,t,n)}))}initializeSplatViewer(){this.splatViewer=new xU({scene:this}),this.reloadSplats()}reloadSplats(){this.splatViewer?.loadSplat()}},SU=(e,t)=>{let n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)},_U=e=>e*(Math.PI/180),TU=e=>e*(180/Math.PI),PU=new Map,MU=e=>{PU.has(e)&&clearTimeout(PU.get(e)),PU.set(e,setTimeout(e,100))},NU=(e,t,n)=>{let i,r=t.split(/[ ,]+/g);for(let s=0;s<r.length;s+=1)i=r[s],e.addEventListener?e.addEventListener(i,n,!1):e.attachEvent&&e.attachEvent(i,n)},IU=(e,t,n)=>{let i,r=t.split(/[ ,]+/g);for(let s=0;s<r.length;s+=1)i=r[s],e.removeEventListener?e.removeEventListener(i,n):e.detachEvent&&e.detachEvent(i,n)},OU=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),DU=()=>{if(typeof window>"u")return;return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},LU=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},RU=(e,t,n)=>{let i=kU(e);for(let r in i)if(i.hasOwnProperty(r))if("string"==typeof t)i[r]=t+" "+n;else{let e="";for(let i=0,r=t.length;i<r;i+=1)e+=t[i]+" "+n+", ";i[r]=e.slice(0,-2)}return i},kU=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach((function(n){t[n+e.charAt(0).toUpperCase()+e.slice(1)]=""})),t},BU=(e,t)=>{for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},UU=(e,t)=>{if(e.length)for(let n=0,i=e.length;n<i;n+=1)t(e[n]);else t(e)};typeof window<"u"&&(zU="ontouchstart"in window,FU=!!window.PointerEvent,jU=!!window.MSPointerEvent);var zU,FU,jU,VU,HU={start:"mousedown",move:"mousemove",end:"mouseup"},WU={};function GU(){}FU?VU={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:jU?VU={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:zU?(VU={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},WU=HU):VU=HU,GU.prototype.on=function(e,t){var n,i=this,r=e.split(/[ ,]+/g);i._handlers_=i._handlers_||{};for(var s=0;s<r.length;s+=1)n=r[s],i._handlers_[n]=i._handlers_[n]||[],i._handlers_[n].push(t);return i},GU.prototype.off=function(e,t){var n=this;return n._handlers_=n._handlers_||{},void 0===e?n._handlers_={}:void 0===t?n._handlers_[e]=null:n._handlers_[e]&&n._handlers_[e].indexOf(t)>=0&&n._handlers_[e].splice(n._handlers_[e].indexOf(t),1),n},GU.prototype.trigger=function(e,t){var n,i=this,r=e.split(/[ ,]+/g);i._handlers_=i._handlers_||{};for(var s=0;s<r.length;s+=1)n=r[s],i._handlers_[n]&&i._handlers_[n].length&&i._handlers_[n].forEach((function(e){e.call(i,{type:n,target:i},t)}))},GU.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=((e,t)=>{let n={};for(let i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)?n[i]=t[i]:e.hasOwnProperty(i)&&(n[i]=e[i]);return n})(t.options,e))},GU.prototype.bindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[t]=function(){"function"==typeof n["on"+t]?n["on"+t].apply(n,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},NU(e,VU[t],n._domHandlers_[t]),WU[t]&&NU(e,WU[t],n._domHandlers_[t]),n},GU.prototype.unbindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},IU(e,VU[t],n._domHandlers_[t]),WU[t]&&IU(e,WU[t],n._domHandlers_[t]),delete n._domHandlers_[t],this};var qU=GU;function KU(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=KU.id,KU.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}KU.prototype=new qU,KU.constructor=KU,KU.id=0,KU.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},KU.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=((e,t)=>{let n=kU(e);for(let i in n)n.hasOwnProperty(i)&&(n[i]=t);return n})("borderRadius","50%"),n=RU("transition","opacity",e),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},BU(i.el,n),"circle"===this.options.shape&&BU(i.back,t),BU(i.front,t),this.applyStyles(i),this},KU.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var n in e[t])this.ui[t].style[n]=e[t][n];return this},KU.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},KU.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},KU.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},KU.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout((function(){t.ui.el.style.opacity=1}),0),t.showTimeout=setTimeout((function(){t.trigger("shown",t.instance),"function"==typeof e&&e.call(this)}),t.options.fadeTime)),t},KU.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout((function(){var n="dynamic"===t.options.mode?"none":"block";t.ui.el.style.display=n,"function"==typeof e&&e.call(t),t.trigger("hidden",t.instance)}),t.options.fadeTime),t.options.restJoystick){let n=t.options.restJoystick,i={};i.x=!0===n||!1!==n.x?0:t.instance.frontPosition.x,i.y=!0===n||!1!==n.y?0:t.instance.frontPosition.y,t.setPosition(e,i)}return t},KU.prototype.setPosition=function(e,t){var n=this;n.frontPosition={x:t.x,y:t.y};var i=n.options.fadeTime+"ms",r={};r.front=RU("transition",["top","left"],i);var s={front:{}};s.front={left:n.frontPosition.x+"px",top:n.frontPosition.y+"px"},n.applyStyles(r),n.applyStyles(s),n.restTimeout=setTimeout((function(){"function"==typeof e&&e.call(n),n.restCallback()}),n.options.fadeTime)},KU.prototype.restCallback=function(){var e=this,t={};t.front=RU("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)},KU.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},KU.prototype.computeDirection=function(e){var t,n,i,r=e.angle.radian,s=Math.PI/4,a=Math.PI/2;if(r>s&&r<3*s&&!e.lockX?t="up":r>-s&&r<=s&&!e.lockY?t="left":r>3*-s&&r<=-s&&!e.lockX?t="down":e.lockY||(t="right"),e.lockY||(n=r>-a&&r<a?"left":"right"),e.lockX||(i=r>0?"up":"down"),e.force>this.options.threshold){var o,l={};for(o in this.direction)this.direction.hasOwnProperty(o)&&(l[o]=this.direction[o]);var c={};for(o in this.direction={x:n,y:i,angle:t},e.direction=this.direction,l)l[o]===this.direction[o]&&(c[o]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+n,e),c.y||this.trigger("plain:"+i,e),c.angle||this.trigger("dir dir:"+t,e)}else this.resetDirection();return e};var YU=KU;function QU(e,t){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=e,n.id=QU.id,QU.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(t),("static"===n.options.mode||"semi"===n.options.mode)&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);let i=getComputedStyle(n.options.zone.parentElement);return i&&"flex"===i.display&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}QU.prototype=new qU,QU.constructor=QU,QU.id=0,QU.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(e){if(void 0===e)return t[0];for(var n=0,i=t.length;n<i;n+=1)if(t[n].identifier===e)return t[n];return!1}},QU.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"},QU.prototype.begin=function(){var e=this,t=e.options;if("static"===t.mode){var n=e.createNipple(t.position,e.manager.getIdentifier());n.add(),e.idles.push(n)}},QU.prototype.createNipple=function(e,t){var n=this,i=n.manager.scroll,r={},s=n.options,a=n.parentIsFlex?i.x:i.x+n.box.left,o=n.parentIsFlex?i.y:i.y+n.box.top;if(e.x&&e.y)r={x:e.x-a,y:e.y-o};else if(e.top||e.right||e.bottom||e.left){var l=document.createElement("DIV");l.style.display="hidden",l.style.top=e.top,l.style.right=e.right,l.style.bottom=e.bottom,l.style.left=e.left,l.style.position="absolute",s.zone.appendChild(l);var c=l.getBoundingClientRect();s.zone.removeChild(l),r=e,e={x:c.left+i.x,y:c.top+i.y}}var h=new YU(n,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(LU(h.ui.el,r),LU(h.ui.front,h.frontPosition)),n.nipples.push(h),n.trigger("added "+h.identifier+":added",h),n.manager.trigger("added "+h.identifier+":added",h),n.bindNipple(h),h},QU.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},QU.prototype.bindNipple=function(e){var t,n=this,i=function(e,i){t=e.type+" "+i.id+":"+e.type,n.trigger(t,i)};e.on("destroyed",n.onDestroyed.bind(n)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)},QU.prototype.pressureFn=function(e,t,n){var i=this,r=0;clearInterval(i.pressureIntervals[n]),i.pressureIntervals[n]=setInterval(function(){var n=e.force||e.pressure||e.webkitForce||0;n!==r&&(t.trigger("pressure",n),i.trigger("pressure "+t.identifier+":pressure",n),r=n)}.bind(i),100)},QU.prototype.onstart=function(e){var t=this,n=t.options,i=e;e=OU(e),t.updateBox();return UU(e,(function(r){t.actives.length<n.maxNumberOfNipples?t.processOnStart(r):i.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach((function(n){if(Object.values(i.touches).findIndex((function(e){return e.identifier===n}))<0){var r=[e[0]];r.identifier=n,t.processOnEnd(r)}})),t.actives.length<n.maxNumberOfNipples&&t.processOnStart(r))})),t.manager.bindDocument(),!1},QU.prototype.processOnStart=function(e){var t,n=this,i=n.options,r=n.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},o=n.getOrCreate(r,a);o.identifier!==r&&n.manager.removeIdentifier(o.identifier),o.identifier=r;var l=function(t){t.trigger("start",t),n.trigger("start "+t.id+":start",t),t.show(),s>0&&n.pressureFn(e,t,t.identifier),n.processOnMove(e)};if((t=n.idles.indexOf(o))>=0&&n.idles.splice(t,1),n.actives.push(o),n.ids.push(o.identifier),"semi"!==i.mode)l(o);else{if(!(SU(a,o.position)<=i.catchDistance))return o.destroy(),void n.processOnStart(e);l(o)}return o},QU.prototype.getOrCreate=function(e,t){var n,i=this,r=i.options;return/(semi|static)/.test(r.mode)?(n=i.idles[0])?(i.idles.splice(0,1),n):"semi"===r.mode?i.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1):n=i.createNipple(t,e)},QU.prototype.processOnMove=function(e){var t=this,n=t.options,i=t.manager.getIdentifier(e),r=t.nipples.get(i),s=t.manager.scroll;if((e=>isNaN(e.buttons)?0!==e.pressure:0!==e.buttons)(e)){if(!r)return console.error("Found zombie joystick with ID "+i),void t.manager.removeIdentifier(i);if(n.dynamicPage){var a=r.el.getBoundingClientRect();r.position={x:s.x+a.left,y:s.y+a.top}}r.identifier=i;var o=r.options.size/2,l={x:e.pageX,y:e.pageY};n.lockX&&(l.y=r.position.y),n.lockY&&(l.x=r.position.x);var c,h,u=SU(l,r.position),d=((e,t)=>{let n=t.x-e.x,i=t.y-e.y;return TU(Math.atan2(i,n))})(l,r.position),p=_U(d),f=u/o,m={distance:u,position:l};if("circle"===r.options.shape?(c=Math.min(u,o),h=((e,t,n)=>{let i={x:0,y:0};return n=_U(n),i.x=e.x-t*Math.cos(n),i.y=e.y-t*Math.sin(n),i})(r.position,c,d)):(h=((e,t,n)=>({x:Math.min(Math.max(e.x,t.x-n),t.x+n),y:Math.min(Math.max(e.y,t.y-n),t.y+n)}))(l,r.position,o),c=SU(h,r.position)),n.follow){if(u>o){let e=l.x-h.x,n=l.y-h.y;r.position.x+=e,r.position.y+=n,r.el.style.top=r.position.y-(t.box.top+s.y)+"px",r.el.style.left=r.position.x-(t.box.left+s.x)+"px",u=SU(l,r.position)}}else l=h,u=c;var g=l.x-r.position.x,v=l.y-r.position.y;r.frontPosition={x:g,y:v},n.dataOnly||LU(r.ui.front,r.frontPosition);var y={identifier:r.identifier,position:l,force:f,pressure:e.force||e.pressure||e.webkitForce||0,distance:u,angle:{radian:p,degree:d},vector:{x:g/o,y:-v/o},raw:m,instance:r,lockX:n.lockX,lockY:n.lockY};(y=r.computeDirection(y)).angle={radian:_U(180-d),degree:180-d},r.trigger("move",y),t.trigger("move "+r.id+":move",y)}else this.processOnEnd(e)},QU.prototype.processOnEnd=function(e){var t=this,n=t.options,i=t.manager.getIdentifier(e),r=t.nipples.get(i),s=t.manager.removeIdentifier(r.identifier);!r||(n.dataOnly||r.hide((function(){"dynamic"===n.mode&&(r.trigger("removed",r),t.trigger("removed "+r.id+":removed",r),t.manager.trigger("removed "+r.id+":removed",r),r.destroy())})),clearInterval(t.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),t.trigger("end "+r.id+":end",r),t.ids.indexOf(r.identifier)>=0&&t.ids.splice(t.ids.indexOf(r.identifier),1),t.actives.indexOf(r)>=0&&t.actives.splice(t.actives.indexOf(r),1),/(semi|static)/.test(n.mode)?t.idles.push(r):t.nipples.indexOf(r)>=0&&t.nipples.splice(t.nipples.indexOf(r),1),t.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(t.manager.ids[s.id]=s.identifier))},QU.prototype.onDestroyed=function(e,t){var n=this;n.nipples.indexOf(t)>=0&&n.nipples.splice(n.nipples.indexOf(t),1),n.actives.indexOf(t)>=0&&n.actives.splice(n.actives.indexOf(t),1),n.idles.indexOf(t)>=0&&n.idles.splice(n.idles.indexOf(t),1),n.ids.indexOf(t.identifier)>=0&&n.ids.splice(n.ids.indexOf(t.identifier),1),n.manager.removeIdentifier(t.identifier),n.manager.unbindDocument()},QU.prototype.destroy=function(){var e=this;for(var t in e.unbindEvt(e.options.zone,"start"),e.nipples.forEach((function(e){e.destroy()})),e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var XU=QU;function ZU(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=DU(),t.config(e),t.prepareCollections();var n=function(){var e;t.collections.forEach((function(n){n.forEach((function(n){e=n.el.getBoundingClientRect(),n.position={x:t.scroll.x+e.left,y:t.scroll.y+e.top}}))}))};if(typeof window>"u")return t.collections;NU(window,"resize",(function(){MU(n)}));var i=function(){t.scroll=DU()};return NU(window,"scroll",(function(){MU(i)})),t.collections}ZU.prototype=new qU,ZU.constructor=ZU,ZU.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var n;return e.collections.every((function(e){return!(n=e.get(t))})),n}},ZU.prototype.create=function(e){return this.createCollection(e)},ZU.prototype.createCollection=function(e){var t=this,n=new XU(t,e);return t.bindCollection(n),t.collections.push(n),n},ZU.prototype.bindCollection=function(e){var t,n=this,i=function(e,i){t=e.type+" "+i.id+":"+e.type,n.trigger(t,i)};e.on("destroyed",n.onDestroyed.bind(n)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)},ZU.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)},ZU.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||!0===e)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)},ZU.prototype.getIdentifier=function(e){var t;return e?void 0===(t=void 0===e.identifier?e.pointerId:e.identifier)&&(t=this.latest||0):t=this.index,void 0===this.ids[t]&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},ZU.prototype.removeIdentifier=function(e){var t={};for(var n in this.ids)if(this.ids[n]===e){t.id=n,t.identifier=this.ids[n],delete this.ids[n];break}return t},ZU.prototype.onmove=function(e){return this.onAny("move",e),!1},ZU.prototype.onend=function(e){return this.onAny("end",e),!1},ZU.prototype.oncancel=function(e){return this.onAny("end",e),!1},ZU.prototype.onAny=function(e,t){var n,i=this,r="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=OU(t);var s=function(e,t,n){n.ids.indexOf(t)>=0&&(n[r](e),e._found_=!0)};return UU(t,(function(e){n=i.getIdentifier(e),UU(i.collections,s.bind(null,e,n)),e._found_||i.removeIdentifier(n)})),!1},ZU.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach((function(e){e.destroy()})),e.off()},ZU.prototype.onDestroyed=function(e,t){var n=this;if(n.collections.indexOf(t)<0)return!1;n.collections.splice(n.collections.indexOf(t),1)};var JU=new ZU,$U=function(e){return JU.create(e)},ez=new Map,tz=new Map,nz=class{constructor(e,t,n,i){this.data=t;let{audio:r,volume:s,delay:a,loop:o}=t;if(!r)throw new Error("Missing property");let l="string"==typeof r?i.getAudio(r).src:r.data;this.audioPlayer=new XI({src:l,volume:s,delay:a,loop:o}),tz.has(n.uuid)?tz.get(n.uuid).push(this):tz.set(n.uuid,[this]),ez.set(e,this)}playByToggle(){"stop"===this.data.toggle?"playing"===this.audioPlayer.status?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):"pause"===this.data.toggle?"playing"===this.audioPlayer.status?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},iz=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=ez.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()}),this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=tz.get(e);!t?.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t.forEach((e=>e.audioPlayer[this.data.interaction]())),this.disposeDelay()}),this.data.delay)):t.forEach((e=>e.audioPlayer[this.data.interaction]())))}pauseAllAudios(){let e=[...tz.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{e.forEach((e=>{e.forEach((e=>{e.audioPlayer[this.data.interaction]()}))})),this.disposeDelay()}),this.data.delay)):e.forEach((e=>{e.forEach((e=>{e.audioPlayer[this.data.interaction]()}))})))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},rz=class{constructor(e,t,n,i,r){if(this.data=t,this.shared=i,this.condition=r,"play"===t.interaction)this.interaction=new nz(e,t,n,i);else{if("pause"!==t.interaction&&"stop"!==t.interaction)throw new Error("Missing property");this.interaction=new iz(t)}}dispatchBasic(){if(!1===hj(this.shared,this.condition))return!1;this.interaction instanceof nz?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(!1===hj(this.shared,this.condition))return!1;this.interaction instanceof nz?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(!1===hj(this.shared,this.condition))return!1;this.interaction instanceof nz&&("start"===e?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},sz=class{constructor(e,t,n,i){this.data=e,this.page=t,this.shared=n,this.condition=i,this.delay=0,this.emission=e.emission,void 0!==e.delay&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.start(0),this.clearDelay()}),e):this.particleSystem.start()}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.stop(0),this.clearDelay()}),e):this.particleSystem.stop()}freeze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.freeze(0),this.clearDelay()}),e):this.particleSystem.froze()}unFreeze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.unFreeze(0),this.clearDelay()}),e):this.particleSystem.unFroze()}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e?this.delayTimerId=window.setTimeout((()=>{this.reset(0),this.clearDelay()}),e):this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze()}}dispatchBasic(){if(!1===hj(this.shared,this.condition)||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay)}}dispatchConditional(){if(!1===hj(this.shared,this.condition)||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay)}}dispatchGameControl(e){if(!1===hj(this.shared,this.condition)||!this.particleSystem)return!1;"start"===e?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},az=(e,t)=>t.some((t=>t instanceof RegExp?t.test(e):t===e));function oz(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return((e,t)=>{let{stripHash:n}=t,i=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!i)throw new Error(`Invalid URL: ${e}`);let{type:r,data:s,hash:a}=i.groups,o=r.split(";");a=n?"":a;let l=!1;"base64"===o[o.length-1]&&(o.pop(),l=!0);let c=(o.shift()||"").toLowerCase(),h=[...o.map((e=>{let[t,n=""]=e.split("=").map((e=>e.trim()));return"charset"===t&&(n=n.toLowerCase(),"us-ascii"===n)?"":`${t}${n?`=${n}`:""}`})).filter(Boolean)];return l&&h.push("base64"),(h.length>0||c&&"text/plain"!==c)&&h.unshift(c),`data:${h.join(";")},${l?s.trim():s}${a?`#${a}`:""}`})(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let n=e.startsWith("//");!n&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&"https:"===i.protocol&&(i.protocol="http:"),t.forceHttps&&"http:"===i.protocol&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash?i.hash="":t.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let e=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,t=0,n="";for(;;){let r=e.exec(i.pathname);if(!r)break;let s=r[0],a=r.index;n+=i.pathname.slice(t,a).replace(/\/{2,}/g,"/"),n+=s,t=a+s.length}n+=i.pathname.slice(t,i.pathname.length).replace(/\/{2,}/g,"/"),i.pathname=n}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(!0===t.removeDirectoryIndex&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let e=i.pathname.split("/"),n=e[e.length-1];az(n,t.removeDirectoryIndex)&&(e=e.slice(0,-1),i.pathname=e.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...i.searchParams.keys()])az(s,t.removeQueryParameters)&&i.searchParams.delete(s);if(!0===t.removeQueryParameters&&(i.search=""),t.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let r=e;return e=i.toString(),!t.removeSingleSlash&&"/"===i.pathname&&!r.endsWith("/")&&""===i.hash&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||"/"===i.pathname)&&""===i.hash&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),n&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var lz=class{constructor(e,t,n,i){let{url:r,context:s}=e;if(this.controlsManager=t,this.shared=n,this.condition=i,!r)throw new Error("Missing property");this.url=r.startsWith("mailto:")?r:oz(r,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=s??"tab"}dispatch(){if(!1===hj(this.shared,this.condition))return!1;kv?window.location.assign(this.url):("tab"===this.context||Lv&&"none"===this.context?window.open(this.url,"_blank"):"window"===this.context?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),this.controlsManager.orbitControls?.onPointerUp(Wv[0]),Wv.splice(0,Wv.length))}},cz=class{constructor(e,t,n,i,r){this.data=e,this.page=t,this.controlsManager=n,this.shared=i,this.condition=r,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=e=>{this.timeoutIdQueue.shift();let t=this.page.scene.find(e);if(void 0===t)return;let n=this.controlsManager.sharedGameControlGlobals.rapierWorld,i=!n||t.dataPatched.physics?.fusedBody;if(t.cloner){for(let e of t.cloner.children)i?(e.playModeVisible=!1,e.rigidBody&&"positioned"===t.dataPatched.physics?.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),n.removeRigidBody(e.rigidBody),e.rigidBody=void 0),e.bvhGeometry&&(e.bvhGeometry=void 0)):void 0===this.clone||this.clone===e?(e.playModeVisible=!1,e.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),n.removeRigidBody(e.rigidBody),e.rigidBody=void 0)):void 0===e.playModeVisible&&(e.playModeVisible=!0);(i||void 0===this.clone||!1===this.clone)&&(t.visible=!1,t.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(t.rigidBody.collider(0).handle),n.removeRigidBody(t.rigidBody),t.rigidBody=void 0),t.bvhGeometry&&(t.bvhGeometry=void 0))}else t.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(t.rigidBody.collider(0).handle),n.removeRigidBody(t.rigidBody),t.rigidBody=void 0),t.bvhGeometry&&(t.bvhGeometry=void 0),t.visible=!1;this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=void 0===n?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter((e=>void 0!==e.bvhGeometry)):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter((e=>void 0!==e.rigidBody)),t.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(!1===hj(this.shared,this.condition))return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay)):this.dispatchInner()}dispatchFromStart(){if(!1===hj(this.shared,this.condition))return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay))}dispose(){this.timeoutIdQueue.forEach((e=>window.clearTimeout(e)))}},hz=class{constructor(e,t,n,i,r){this.data=e,this.page=t,this.shared=n,this.eventManager=i,this.condition=r,this.shared=n}dispatch(){if(!1===hj(this.shared,this.condition))return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout((()=>{this.shared.reset(this.shared.data,!0),HF(this.page,this.shared,!0),this.eventManager.reset(),this.eventManager.controlsManager.gameControl?.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId}),1e3*(this.data.delay??0))}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},uz={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},dz={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},pz=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],fz={CSS:{},springs:{}};function mz(e,t,n){return Math.min(Math.max(e,t),n)}function gz(e,t){return e.indexOf(t)>-1}function vz(e,t){return e.apply(null,t)}var yz={arr:function(e){return Array.isArray(e)},obj:function(e){return gz(Object.prototype.toString.call(e),"Object")},pth:function(e){return yz.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||yz.svg(e))},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return yz.hex(e)||yz.rgb(e)||yz.hsl(e)},key:function(e){return!uz.hasOwnProperty(e)&&!dz.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function bz(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map((function(e){return parseFloat(e)})):[]}function wz(e,t){var n=bz(e),i=mz(yz.und(n[0])?1:n[0],.1,100),r=mz(yz.und(n[1])?100:n[1],.1,100),s=mz(yz.und(n[2])?10:n[2],.1,100),a=mz(yz.und(n[3])?0:n[3],.1,100),o=Math.sqrt(r/i),l=s/(2*Math.sqrt(r*i)),c=l<1?o*Math.sqrt(1-l*l):0,h=l<1?(l*o-a)/c:-a+o;function u(e){var n=t?t*e/1e3:e;return n=l<1?Math.exp(-n*l*o)*(1*Math.cos(c*n)+h*Math.sin(c*n)):(1+h*n)*Math.exp(-n*o),0===e||1===e?e:1-n}return t?u:function(){var t=fz.springs[e];if(t)return t;for(var n=1/6,i=0,r=0;;)if(1===u(i+=n)){if(++r>=16)break}else r=0;var s=i*n*1e3;return fz.springs[e]=s,s}}function xz(e){return void 0===e&&(e=10),function(t){return Math.ceil(mz(t,1e-6,1)*e)*(1/e)}}var Ez=function(){var e=.1;function t(e,t){return 1-3*t+3*e}function n(e,t){return 3*t-6*e}function i(e){return 3*e}function r(e,r,s){return((t(r,s)*e+n(r,s))*e+i(r))*e}function s(e,r,s){return 3*t(r,s)*e*e+2*n(r,s)*e+i(r)}return function(t,n,i,a){if(0<=t&&t<=1&&0<=i&&i<=1){var o=new Float32Array(11);if(t!==n||i!==a)for(var l=0;l<11;++l)o[l]=r(l*e,t,i);return function(e){return t===n&&i===a||0===e||1===e?e:r(c(e),n,a)}}function c(n){for(var a=0,l=1;10!==l&&o[l]<=n;++l)a+=e;--l;var c=a+(n-o[l])/(o[l+1]-o[l])*e,h=s(c,t,i);return h>=.001?function(e,t,n,i){for(var a=0;a<4;++a){var o=s(t,n,i);if(0===o)return t;t-=(r(t,n,i)-e)/o}return t}(n,c,t,i):0===h?c:function(e,t,n,i,s){var a,o,l=0;do{(a=r(o=t+(n-t)/2,i,s)-e)>0?n=o:t=o}while(Math.abs(a)>1e-7&&++l<10);return o}(n,a,a+e,t,i)}}}(),Cz=function(){var e={linear:function(){return function(e){return e}}},t={Sine:function(){return function(e){return 1-Math.cos(e*Math.PI/2)}},Circ:function(){return function(e){return 1-Math.sqrt(1-e*e)}},Back:function(){return function(e){return e*e*(3*e-2)}},Bounce:function(){return function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}},Elastic:function(e,t){void 0===e&&(e=1),void 0===t&&(t=.5);var n=mz(e,1,10),i=mz(t,.1,2);return function(e){return 0===e||1===e?e:-n*Math.pow(2,10*(e-1))*Math.sin((e-1-i/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/i)}}};return["Quad","Cubic","Quart","Quint","Expo"].forEach((function(e,n){t[e]=function(){return function(e){return Math.pow(e,n+2)}}})),Object.keys(t).forEach((function(n){var i=t[n];e["easeIn"+n]=i,e["easeOut"+n]=function(e,t){return function(n){return 1-i(e,t)(1-n)}},e["easeInOut"+n]=function(e,t){return function(n){return n<.5?i(e,t)(2*n)/2:1-i(e,t)(-2*n+2)/2}}})),e}();function Az(e,t){if(yz.fnc(e))return e;var n=e.split("(")[0],i=Cz[n],r=bz(e);switch(n){case"spring":return wz(e,t);case"cubicBezier":return vz(Ez,r);case"steps":return vz(xz,r);default:return vz(i,r)}}function Sz(e){try{return document.querySelectorAll(e)}catch{return}}function _z(e,t){for(var n=e.length,i=arguments.length>=2?arguments[1]:void 0,r=[],s=0;s<n;s++)if(s in e){var a=e[s];t.call(i,a,s,e)&&r.push(a)}return r}function Tz(e){return e.reduce((function(e,t){return e.concat(yz.arr(t)?Tz(t):t)}),[])}function Pz(e){return yz.arr(e)?e:(yz.str(e)&&(e=Sz(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function Mz(e,t){return e.some((function(e){return e===t}))}function Nz(e){var t={};for(var n in e)t[n]=e[n];return t}function Iz(e,t){var n=Nz(e);for(var i in e)n[i]=t.hasOwnProperty(i)?t[i]:e[i];return n}function Oz(e,t){var n=Nz(e);for(var i in t)n[i]=yz.und(e[i])?t[i]:e[i];return n}function Dz(e){return yz.rgb(e)?function(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}(e):yz.hex(e)?function(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,i){return t+t+n+n+i+i})),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+parseInt(n[1],16)+","+parseInt(n[2],16)+","+parseInt(n[3],16)+",1)"}(e):yz.hsl(e)?function(e){var t,n,i,r=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),s=parseInt(r[1],10)/360,a=parseInt(r[2],10)/100,o=parseInt(r[3],10)/100,l=r[4]||1;function c(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(0==a)t=n=i=o;else{var h=o<.5?o*(1+a):o+a-o*a,u=2*o-h;t=c(u,h,s+1/3),n=c(u,h,s),i=c(u,h,s-1/3)}return"rgba("+255*t+","+255*n+","+255*i+","+l+")"}(e):void 0}function Lz(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function Rz(e,t){return yz.fnc(e)?e(t.target,t.id,t.total):e}function kz(e,t){return e.getAttribute(t)}function Bz(e,t,n){if(Mz([n,"deg","rad","turn"],Lz(t)))return t;var i=fz.CSS[t+n];if(!yz.und(i))return i;var r=document.createElement(e.tagName),s=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;s.appendChild(r),r.style.position="absolute",r.style.width=100+n;var a=100/r.offsetWidth;s.removeChild(r);var o=a*parseFloat(t);return fz.CSS[t+n]=o,o}function Uz(e,t,n){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return n?Bz(e,r,n):r}}function zz(e,t){return yz.dom(e)&&!yz.inp(e)&&(kz(e,t)||yz.svg(e)&&e[t])?"attribute":yz.dom(e)&&Mz(pz,t)?"transform":yz.dom(e)&&"transform"!==t&&Uz(e,t)?"css":null!=e[t]?"object":void 0}function Fz(e){if(yz.dom(e)){for(var t,n=e.style.transform||"",i=/(\w+)\(([^)]*)\)/g,r=new Map;t=i.exec(n);)r.set(t[1],t[2]);return r}}function jz(e,t,n,i){var r=gz(t,"scale")?1:0+function(e){return gz(e,"translate")||"perspective"===e?"px":gz(e,"rotate")||gz(e,"skew")?"deg":void 0}(t),s=Fz(e).get(t)||r;return n&&(n.transforms.list.set(t,s),n.transforms.last=t),i?Bz(e,s,i):s}function Vz(e,t,n,i){switch(zz(e,t)){case"transform":return jz(e,t,i,n);case"css":return Uz(e,t,n);case"attribute":return kz(e,t);default:return e[t]||0}}function Hz(e,t){var n=/^(\*=|\+=|-=)/.exec(e);if(!n)return e;var i=Lz(e)||0,r=parseFloat(t),s=parseFloat(e.replace(n[0],""));switch(n[0][0]){case"+":return r+s+i;case"-":return r-s+i;case"*":return r*s+i}}function Wz(e,t){if(yz.col(e))return Dz(e);if(/\s/g.test(e))return e;var n=Lz(e),i=n?e.substr(0,e.length-n.length):e;return t?i+t:i}function Gz(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function qz(e){for(var t,n=e.points,i=0,r=0;r<n.numberOfItems;r++){var s=n.getItem(r);r>0&&(i+=Gz(t,s)),t=s}return i}function Kz(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return function(e){return 2*Math.PI*kz(e,"r")}(e);case"rect":return function(e){return 2*kz(e,"width")+2*kz(e,"height")}(e);case"line":return function(e){return Gz({x:kz(e,"x1"),y:kz(e,"y1")},{x:kz(e,"x2"),y:kz(e,"y2")})}(e);case"polyline":return qz(e);case"polygon":return function(e){var t=e.points;return qz(e)+Gz(t.getItem(t.numberOfItems-1),t.getItem(0))}(e)}}function Yz(e,t){var n=t||{},i=n.el||function(e){for(var t=e.parentNode;yz.svg(t)&&yz.svg(t.parentNode);)t=t.parentNode;return t}(e),r=i.getBoundingClientRect(),s=kz(i,"viewBox"),a=r.width,o=r.height,l=n.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function Qz(e,t){function n(n){void 0===n&&(n=0);var i=t+n>=1?t+n:0;return e.el.getPointAtLength(i)}var i=Yz(e.el,e.svg),r=n(),s=n(-1),a=n(1);switch(e.property){case"x":return(r.x-i.x)*i.w;case"y":return(r.y-i.y)*i.h;case"angle":return 180*Math.atan2(a.y-s.y,a.x-s.x)/Math.PI}}function Xz(e,t){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=Wz(yz.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(n)?i.match(n).map(Number):[0],strings:yz.str(e)||t?i.split(n):[]}}function Zz(e){return _z(e?Tz(yz.arr(e)?e.map(Pz):Pz(e)):[],(function(e,t,n){return n.indexOf(e)===t}))}function Jz(e){var t=Zz(e);return t.map((function(e,n){return{target:e,id:n,total:t.length,transforms:{list:Fz(e)}}}))}function $z(e,t){var n=Nz(t);if(/^spring/.test(n.easing)&&(n.duration=wz(n.easing)),yz.arr(e)){var i=e.length;2===i&&!yz.obj(e[0])?e={value:e}:yz.fnc(t.duration)||(n.duration=t.duration/i)}var r=yz.arr(e)?e:[e];return r.map((function(e,n){var i=yz.obj(e)&&!yz.pth(e)?e:{value:e};return yz.und(i.delay)&&(i.delay=n?0:t.delay),yz.und(i.endDelay)&&(i.endDelay=n===r.length-1?t.endDelay:0),i})).map((function(e){return Oz(e,n)}))}function eF(e,t){var n=[],i=t.keyframes;for(var r in i&&(t=Oz(function(e){for(var t=_z(Tz(e.map((function(e){return Object.keys(e)}))),(function(e){return yz.key(e)})).reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]),n={},i=function(i){var r=t[i];n[r]=e.map((function(e){var t={};for(var n in e)yz.key(n)?n==r&&(t.value=e[n]):t[n]=e[n];return t}))},r=0;r<t.length;r++)i(r);return n}(i),t)),t)yz.key(r)&&n.push({name:r,tweens:$z(t[r],e)});return n}function tF(e,t){var n;return e.tweens.map((function(i){var r=function(e,t){var n={};for(var i in e){var r=Rz(e[i],t);yz.arr(r)&&(r=r.map((function(e){return Rz(e,t)})),1===r.length&&(r=r[0])),n[i]=r}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}(i,t),s=r.value,a=yz.arr(s)?s[1]:s,o=Lz(a),l=Vz(t.target,e.name,o,t),c=n?n.to.original:l,h=yz.arr(s)?s[0]:c,u=Lz(h)||Lz(l),d=o||u;return yz.und(a)&&(a=c),r.from=Xz(h,d),r.to=Xz(Hz(a,h),d),r.start=n?n.end:0,r.end=r.start+r.delay+r.duration+r.endDelay,r.easing=Az(r.easing,r.duration),r.isPath=yz.pth(s),r.isColor=yz.col(r.from.original),r.isColor&&(r.round=1),n=r,r}))}var nF={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,i,r){if(i.list.set(t,n),t===i.last||r){var s="";i.list.forEach((function(e,t){s+=t+"("+e+") "})),e.style.transform=s}}};function iF(e,t){Jz(e).forEach((function(e){for(var n in t){var i=Rz(t[n],e),r=e.target,s=Lz(i),a=Vz(r,n,s,e),o=Hz(Wz(i,s||Lz(a)),a),l=zz(r,n);nF[l](r,n,o,e.transforms,!0)}}))}function rF(e,t){return _z(Tz(e.map((function(e){return t.map((function(t){return function(e,t){var n=zz(e.target,t.name);if(n){var i=tF(t,e),r=i[i.length-1];return{type:n,property:t.name,animatable:e,tweens:i,duration:r.end,delay:i[0].delay,endDelay:r.endDelay}}}(e,t)}))}))),(function(e){return!yz.und(e)}))}function sF(e,t){var n=e.length,i=function(e){return e.timelineOffset?e.timelineOffset:0},r={};return r.duration=n?Math.max.apply(Math,e.map((function(e){let t=e.startOnceDelay??0,n=e.pingPongDelayCorrection??0,r=e.pingPongEndDelayCorrection??0;return i(e)+t+n+r+e.duration*(e.loop??1)}))):t.duration,r.delay=n?Math.min.apply(Math,e.map((function(e){let t=e.startOnceDelay??0,n=e.pingPongDelayCorrection??0;return i(e)+t+n+e.delay}))):t.delay,r.endDelay=n?r.duration-Math.max.apply(Math,e.map((function(e){let t=e.startOnceDelay??0,n=e.pingPongDelayCorrection??0,r=e.pingPongEndDelayCorrection??0;return i(e)+t+n+e.duration*(e.loop??1)-e.endDelay-r}))):t.endDelay,r}var aF=0;var oF,lF=[],cF=[],hF=function(){function e(){oF=requestAnimationFrame(t)}function t(t){var n=lF.length;if(n){for(var i=0;i<n;){var r=lF[i];r.paused?(lF.splice(i,1),n-=1):(r.tick(t),i++)}e()}else oF=cancelAnimationFrame(oF)}return e}();function uF(e){void 0===e&&(e={});var t,n,i=0,r=0,s=0,a=0,o=null;function l(e){var t=window.Promise&&new Promise((function(e){return o=e}));return e.finished=t,t}var c=function(e){var t=Iz(uz,e),n=Iz(dz,e),i=eF(n,e),r=Jz(e.targets),s=rF(r,i),a=sF(s,n),o=aF;return aF++,Oz(t,{id:o,children:[],animatables:r,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay,startOnceDelay:n.startOnceDelay,pingPongDelayCorrection:n.pingPongDelayCorrection,pingPongEndDelayCorrection:n.pingPongEndDelayCorrection})}(e);l(c);function h(){var e=c.direction;"alternate"!==e&&(c.direction="normal"!==e?"normal":"reverse"),c.reversed=!c.reversed,n.forEach((function(e){(1===e.loop||e.loop%2===0)&&(e.reversed=c.reversed)}))}function u(e){return c.reversed?c.duration-e:e}function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&(c.reversed?t.seek(t.duration*t.loop-(e-t.timelineOffset-t.pingPongDelayCorrection),n):t.seek(e-t.timelineOffset-t.startOnceDelay-t.pingPongDelayCorrection,n))}function p(e){var t=0,n=c.animations,i=n.length;for("alternate"!==c.direction&&"alternate"===c.parent?.direction?!1===c.parent?.rewind&&!0===c.reversePlayback&&!1===c.rewind&&(e=c.parent?.reversed&&"alternate"===c.direction?c.duration-c.delay+c.endDelay-e:c.duration+c.delay-c.endDelay-e):g(!1,c.parent?.rewind,c.rewind,c.parent?.reversePlayback,c.reversePlayback)&&(e=c.parent?.reversed&&"alternate"===c.direction?c.duration-c.delay+c.endDelay-e:c.duration+c.delay-c.endDelay-e);t<i;){var r=n[t],s=r.animatable,a=r.tweens,o=a.length-1,l=a[o];let i;o&&(l=_z(a,(function(t){return e<t.end}))[0]||l),i=c.parent?.reversed&&"alternate"===c.direction?mz(e-l.start-l.endDelay,0,l.duration)/l.duration:mz(e-l.start-l.delay,0,l.duration)/l.duration;for(var h=isNaN(i)?1:l.easing(i),u=l.to.strings,d=l.round,p=[],f=l.to.numbers.length,m=void 0,v=0;v<f;v++){var y=void 0;let e,t;"alternate"!==c.direction?!1===c.parent?.rewind&&!0===c.reversePlayback&&!1===c.rewind?(e=l.to.numbers[v],t=l.from.numbers[v]||0):(t=l.to.numbers[v],e=l.from.numbers[v]||0):g(!0,c.parent?.rewind,c.rewind,c.parent?.reversePlayback,c.reversePlayback)?(e=l.to.numbers[v],t=l.from.numbers[v]||0):(t=l.to.numbers[v],e=l.from.numbers[v]||0),y=l.isPath?Qz(l.value,h*t):e+h*(t-e),d&&(l.isColor&&v>2||(y=Math.round(y*d)/d)),p.push(y)}var b=u.length;if(b){m=u[0];for(var w=0;w<b;w++){u[w];var x=u[w+1],E=p[w];isNaN(E)||(m+=x?E+x:E+" ")}}else m=p[0];nF[r.type](s.target,r.property,m,s.transforms),r.currentValue=m,t++}}function f(e){c[e]&&!c.passThrough&&c[e](c)}let m={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function g(e,t,n,i,r){return m[e<<4|t<<3|n<<2|i<<1|r]}function v(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var r=c.duration;let s=c.delay,m=r-c.endDelay;c.parent?.reversed&&"alternate"===c.direction&&(s=c.endDelay,m=r-c.delay);var g=u(e);if(c.progress=mz(g/r*100,0,100),t||(c.reversePlayback=g<c.currentTime),a&&function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(c.reversed)for(var i=a;i--;)d(e,n[i],t);else for(var r=0;r<a;r++)d(e,n[r],t)}(g,t),!c.began&&c.currentTime>=0&&(c.began=!0,f("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,f("loopBegin")),(c.reversed||g>=0)&&g<=s&&0!==c.currentTime&&(p(0),f("change")),(g>=m&&c.currentTime!==r+c.pingPongDelayCorrection||!r)&&(p(r),f("change")),g>s&&g<m?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,f("changeBegin")),p(g),f("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,f("change"),a&&f("timelineChangeComplete")):c.began&&g>m&&f("changeComplete"),c.currentTime=mz(g,0,r+c.pingPongDelayCorrection),c.began&&f("update"),e>=r)if(c.remaining&&!0!==c.remaining&&c.remaining--,c.remaining){i+=a?c.duration/uF.speed:c.duration;for(let e of n)e.setStartTime(0),e.remaining=e.loop;f("loopComplete"),c.loopBegan=!1,"alternate"===c.direction?h():a&&(c.direction="normal",c.reversed=!1,n.forEach((function(e){return e.reversed=!1})))}else c.paused=!0,c.completed||(c.completed=!0,f("loopComplete"),f("complete"),!c.passThrough&&"Promise"in window&&(o(),l(c)))}return c.reset=function(){var e=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed="reverse"===e,c.remaining=c.loop,n=c.children;for(var t=a=n.length;t--;)c.children[t].reset();p(c.reversed?c.duration:0)},c.setStartTime=function(e){i=e},c.set=function(e,t){return iF(e,t),c},c.tick=function(e){s=e,i||(i=s),v((s+(r-i))*uF.speed)},c.seek=function(e){v(e-i,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},c.pause=function(e){c.paused=!0,a&&(t=e??performance.now())},c.play=function(e){!c.paused||(c.completed&&c.reset(),c.paused=!1,lF.push(c),a&&void 0!==t&&(i+=(e??performance.now())-t),oF||hF())},c.reverse=function(){h(),c.completed=!c.reversed,i=0,r=u(c.currentTime)*(1/uF.speed)},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function dF(e,t){for(var n=t.length;n--;)Mz(e,t[n].animatable.target)&&t.splice(n,1)}typeof document<"u"&&document.addEventListener("visibilitychange",(function(e){document.hidden?(lF.forEach((function(t){return t.pause(e.timeStamp)})),cF=lF.slice(0),uF.running=lF=[]):cF.forEach((function(t){return t.play(e.timeStamp)}))})),uF.version="3.2.0",uF.speed=1,uF.running=lF,uF.remove=function(e){for(var t=Zz(e),n=lF.length;n--;){var i=lF[n],r=i.animations,s=i.children;dF(t,r);for(var a=s.length;a--;){var o=s[a],l=o.animations;dF(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!r.length&&!s.length&&i.pause()}},uF.get=Vz,uF.set=iF,uF.convertPx=Bz,uF.path=function(e,t){var n=yz.str(e)?Sz(e)[0]:e,i=t||100;return function(e){return{property:e,el:n,svg:Yz(n),totalLength:Kz(n)*(i/100)}}},uF.setDashoffset=function(e){var t=Kz(e);return e.setAttribute("stroke-dasharray",t),t},uF.stagger=function(e,t){void 0===t&&(t={});var n=t.direction||"normal",i=t.easing?Az(t.easing):null,r=t.grid,s=t.axis,a=t.from||0,o="first"===a,l="center"===a,c="last"===a,h=yz.arr(e),u=parseFloat(h?e[0]:e),d=h?parseFloat(e[1]):0,p=Lz(h?e[1]:e)||0,f=t.start||0+(h?u:0),m=[],g=0;return function(e,t,v){if(o&&(a=0),l&&(a=(v-1)/2),c&&(a=v-1),!m.length){for(var y=0;y<v;y++){if(r){var b=l?(r[0]-1)/2:a%r[0],w=l?(r[1]-1)/2:Math.floor(a/r[0]),x=b-y%r[0],E=w-Math.floor(y/r[0]),C=Math.sqrt(x*x+E*E);"x"===s&&(C=-x),"y"===s&&(C=-E),m.push(C)}else m.push(Math.abs(a-y));g=Math.max.apply(Math,m)}i&&(m=m.map((function(e){return i(e/g)*g}))),"reverse"===n&&(m=m.map((function(e){return s?e<0?-1*e:-e:Math.abs(g-e)})))}return f+(h?(d-u)/g:u)*(Math.round(100*m[t])/100)+p}},uF.timeline=function(e){void 0===e&&(e={});var t=uF(e);return t.duration=0,t.add=function(n,i){var r=lF.indexOf(t),s=t.children;function a(e){e.passThrough=!0}r>-1&&lF.splice(r,1);for(var o=0;o<s.length;o++)a(s[o]);var l=Oz(n,Iz(dz,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=yz.und(i)?c:Hz(i,c),a(t);var h=uF(l);a(h),s.push(h),h.parent=t;var u=sF(s,e);return t.delay=u.delay,t.endDelay=u.endDelay,t.duration=u.duration,!0===h.loop&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t},uF.easing=Az,uF.penner=Cz,uF.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var pF=uF,fF=new ji,mF=new ji,gF=new Fi;function vF(e,t,n,i,r,s){let a=void 0!==n[e]?n[e]:void 0,o=i[e];if(null==o)return;let l=null!=a?"string"==typeof a?Number(r.getVariable(a)??0):a:t[e],c="string"==typeof o?Number(r.getVariable(o)??0):o;return l!==c?{update:n=>{let i=ui.lerp(l,c,n);t[e]=s?Math.trunc(i):i},start:()=>{t[e]=l},end:()=>{t[e]=c}}:void 0}function yF(e,t,n,i,r,s){let a=n[e]?n[e]:void 0,o=i[e];if(!o)return;let l=t[e],c=[...a??l].map((e=>"string"==typeof e?Number(r.getVariable(e)??0):e)),h=[...o].map((e=>"string"==typeof e?Number(r.getVariable(e)??0):e));return c.length!==h.length||bv(c,h)?void 0:{update:n=>{c.forEach(((i,r)=>{let a=ui.lerp(i,h[r],n);t[e][r]=s?Math.trunc(a):a}))},start:()=>{Object.assign(t[e],c)},end:()=>{Object.assign(t[e],h)}}}function bF(e,t,n){return t.forEach(((t,i)=>{e.setComponent(i,"string"==typeof t?Number(n.getVariable(t)??0):t)})),e}function wF(e,t,n,i,r){let s=n[e]?n[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?bF(new ji,s,r):o.clone(),c=bF(new ji,a,r);return l.equals(c)?void 0:{update:e=>{o.lerpVectors(l,c,e)},start:()=>{o.copy(l)},end:()=>{o.copy(c)}}}function xF(e,t,n){return t.forEach(((t,i)=>{e.setComponent(i,"string"==typeof t?Number(n.getVariable(t)??0):t)})),e}function EF(e,t,n,i,r){let s=n[e]?n[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=!(o instanceof di),c=o instanceof di?o:(new di).fromArray(o),h=s?xF(new di,s,r):c.clone(),u=xF(new di,a,r);return h.equals(u)?void 0:{update:n=>{c.lerpVectors(h,u,n),l&&(t[e]=c.toArray())},start:()=>{c.copy(h),l&&(t[e]=c.toArray())},end:()=>{c.copy(u),l&&(t[e]=c.toArray())}}}function CF(e,t,n,i,r){let s=n[e]?n[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=new lM(o.r,o.g,o.b,o.a),c=s?"string"==typeof s?r.getColor(s).clone():new lM(s.r,s.g,s.b,s.a):l.clone(),h="string"==typeof a?r.getColor(a).clone():new lM(a.r,a.g,a.b,a.a);return c.equals(h)?void 0:{update:n=>{l.lerpColors(c,h,n);let i=ui.lerp(c.a,h.a,n);l.a=i,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(c)},end:()=>{l.copy(h)}}}function AF(e,t,n,i,r){return"number"==typeof t[e]?vF(e,t,n??{},i,r):Array.isArray(t[e])?yF(e,t,n??{},i,r):void 0}function SF(e,t,n,i){let r=[];if(!("geometry"in n))return r;let s=e.geometry.userData.parameters,a="geometry"in t?t.geometry:{},o=n.geometry;if(e instanceof zO){let t=function(e,t,n,i){if(void 0===n.scaleBaked)return;let r=(t.scaleBaked??e.data.geometry.scaleBaked).map((e=>"string"==typeof e?Number(i.getVariable(e)??0):e)),s=n.scaleBaked.map((e=>"string"==typeof e?Number(i.getVariable(e)??0):e));if(Zw.isEqual(r,s))return;let a=[];return a.push({update:t=>{e.updateGeometryInteractions({scaleBaked:[ui.lerp(r[0],s[0],t),ui.lerp(r[1],s[1],t),ui.lerp(r[2],s[2],t)]},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},start:()=>{e.updateGeometryInteractions({scaleBaked:r},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},end:()=>{e.updateGeometryInteractions({scaleBaked:s},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()}}),a}(e,a,o,i);t&&r.push(...t)}else{let t={};if(Object.assign(t,Nv(s,UE),Nv(a,UE)),UE.forEach((e=>{let n=AF(e,t,a,o,i);n&&r.push(n)})),e instanceof gB){Object.assign(t,{extrusion:{...s.extrusion}});let e=function(e,t,n,i){if(!n.extrusion)return;let r=e.extrusion,s=t.extrusion??{},a=n.extrusion,o=[];return Qx.forEach((e=>{let t=AF(e,r,s,a,i);t&&o.push(t)})),o}(t,a,o,i);e&&r.push(...e)}r.length&&r.push({update:n=>{e.updateGeometryInteractions(t,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},start:n=>{e.updateGeometryInteractions(t,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},end:n=>{e.updateGeometryInteractions(t,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()}})}return r}function _F(e,t,n,i){let r=[];if(void 0!==n.intensity){let s=vF("intensity",e,t,n,i);s&&r.push(s)}if(void 0!==n.color){let s=function(e,t,n,i,r){let s=n[e]?n[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?"string"==typeof s?r.getColor(s).clone():(new Mi).setRGB(s.r,s.g,s.b):o.clone(),c="string"==typeof a?r.getColor(a).clone():(new Mi).setRGB(a.r,a.g,a.b);if(l.equals(c))return;let h=o.clone();return{update:n=>{h.lerpColors(l,c,n),t[e]?.copy?.(h)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}("color",e,t,n,i);s&&r.push(s)}return r}function TF(e,t,n,i){let r=[],s=LI(n,i)||!!t.layers&&LI(t,i);r.push(function(e,t){return{update:()=>{e.transparent=t}}}(e,s));for(let a of e.layers){let e=t.layers?.data(a.uuid),s=n.layers.data(a.uuid);if(!s||"light"!==a.type&&(!(a.visible??1)||!(s.visible??1)))continue;let o=a.getNames().filter((e=>!jx.some((t=>e.includes(t)))));for(let t of o)try{let n,o=a.getValue(t);if("colors"===t)n=LF(a,e,s,t);else if(Array.isArray(o))"steps"===t&&(n=DF(a,e,s,t));else if("number"==typeof o)n=PF(a,e,s,t,i);else{if("boolean"==typeof o)continue;o instanceof di?n=MF(a,e,s,t):o instanceof ji?n=NF(a,e,s,t,i):o instanceof lM?n=OF(a,e,s,t,i):o instanceof Mi?n=IF(a,e,s,t,i):"isTexture"in o&&(n=RF(a,e,s,t))}n&&(Array.isArray(n)?r.push(...n):r.push(n))}catch(rx){console.error(`lerpMaterial: unexpected material layer for ${t}`,rx)}}return r}function PF(e,t,n,i,r){if(!e.hasValue(i)||!(i in n))return;let s=t?t[i]:e.getValue(i),a=n[i],o="string"==typeof s?Number(r.getVariable(s)??0):s,l="string"==typeof a?Number(r.getVariable(a)??0):a;return o!==l?{update:t=>{e.setValue(i,ui.lerp(o,l,t))},start:()=>{e.setValue(i,o)},end:()=>{e.setValue(i,l)}}:void 0}function MF(e,t,n,i){if(!e.hasValue(i)||!(i in n))return;let r=e.getValue(i),s=t?(new di).fromArray(t[i]):r.clone(),a=(new di).fromArray(n[i]);return s.equals(a)?void 0:{update:e=>{r.lerpVectors(s,a,e)},start:()=>{r.copy(s)},end:()=>{r.copy(a)}}}function NF(e,t,n,i,r){if(!e.hasValue(i)||!(i in n))return;let s=e.getValue(i),a=t?t[i]:void 0,o=n[i],l=a?bF(new ji,a,r):s.clone(),c=bF(new ji,o,r);return l.equals(c)?void 0:{update:e=>{s.lerpVectors(l,c,e)},start:()=>{s.copy(l)},end:()=>{s.copy(c)}}}function IF(e,t,n,i,r){if(!e.hasValue(i)||!(i in n))return;let s=t?t[i]:void 0,a=n[i],o=e.getValue(i),l=s?"string"==typeof s?r.getColor(s).clone():(new Mi).setRGB(s.r,s.g,s.b):o.clone(),c="string"==typeof a?r.getColor(a).clone():(new Mi).setRGB(a.r,a.g,a.b);if(l.equals(c))return;let h=o.clone();return{update:t=>{e.getValue(i)!==h&&e.setValue(i,h),h.lerpColors(l,c,t)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function OF(e,t,n,i,r){if(!e.hasValue(i)||!(i in n))return;let s=t?t[i]:void 0,a=n[i],o=e.getValue(i),l=s?"string"==typeof s?r.getColor(s).clone():(new Mi).setRGB(s.r,s.g,s.b):o.clone(),c="string"==typeof a?r.getColor(a).clone():new lM(a.r,a.g,a.b,a.a);if(l.equals(c))return;let h=o.clone();return{update:t=>{e.getValue(i)!==h&&e.setValue(i,h),h.lerpColors(l,c,t)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function DF(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(!e.hasValue(i)||!(i in n))return;let r=[],s=e.getValue(i),a=t?t[i]:s,o=n[i];return bv(a,o)||r.push({update:t=>{let n=[...s];for(let e=0;e<s.length;++e){let i=a[e],r=o[e];n[e]=ui.lerp(i,r,t)}e.setValue(i,n)},start:()=>{e.setValue(i,a)},end:()=>{e.setValue(i,o)}}),r.length?r:void 0}function LF(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"colors";if(!e.hasValue(i)||!(i in n))return;let r=[],s=e.getValue(i),a=t?t[i]:s.map((e=>e.toArray())),o=n[i];for(let l=0;l<s.length;++l){let e=[...a[l]],t=[...o[l]];$w.isEqual(e,t)||r.push({update:n=>{s[l].fromArray($w.lerp(e,t,n))},start:()=>{s[l].fromArray(e)},end:()=>{s[l].fromArray(t)}})}return r.length?r:void 0}function RF(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"texture";if(!e.hasValue(i)||!(i in n))return;let r=e.getNode("rotation"),s=t?.[i]?.rotation??0,a=n[i]?.rotation??0;if(r&&s!==a)return{update:e=>{r.value=ui.lerp(s,a,e)*ui.DEG2RAD},start:()=>{r.value=s*ui.DEG2RAD},end:()=>{r.value=a*ui.DEG2RAD}};let o=e.getNode("mat");if(!o)return;let l=t?t[i]:o,c=n[i],h=[...l.repeat],u=[...l.offset],d=[...c.repeat],p=[...c.offset],f=l.rotation??0,m=c.rotation??0;return Xw.isEqual(h,d)&&Xw.isEqual(u,p)&&f===m?void 0:{update:e=>{o.repeat=Xw.lerp(h,d,e),o.offset=Xw.lerp(u,p,e),o.rotation=ui.lerp(f,m,e),o.updateMatrix()},start:()=>{o.repeat=[...h],o.offset=[...u],o.rotation=f,o.updateMatrix()},end:()=>{o.repeat=[...d],o.offset=[...p],o.rotation=m,o.updateMatrix()}}}var kF=new ji,BF=new Tr;function UF(e,t,n,i,r){let s,a,o,l,c,h,u,d,p=[];if(e instanceof yk?(s=EF("position",e,t,n,r),s&&p.push(s),o=vF("rotation",e,t,n,r),o&&p.push(o),l=EF("shear",e,t,n,r),l&&p.push(l)):(d={slide:t.pathSnapping?.slide??e.updatedPathSnapping?.slide??e.dataPatched.pathSnapping?.slide??0,offset:t.pathSnapping?.offset??e.updatedPathSnapping?.offset??e.dataPatched.pathSnapping?.offset??0},h=vF("slide",d,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,n.pathSnapping??e.dataPatched.pathSnapping,r),h&&p.push(h),u=vF("offset",d,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,n.pathSnapping??e.dataPatched.pathSnapping,r),u&&p.push(u),!h&&!u&&(s=wF("position",e,t,n,r),s&&p.push(s),a=wF("scale",e,t,n,r),a&&p.push(a),o=function(e,t,n,i,r){let s=t?.rotation?t.rotation.map((e=>("string"==typeof e?Number(r.getVariable(e)??0):e)*ui.DEG2RAD)):void 0,a=n.rotation?.map((e=>("string"==typeof e?Number(r.getVariable(e)??0):e)*ui.DEG2RAD));if(!a)return;let o=s?(new ji).fromArray(s):(new ji).setFromEuler(e.rotation),l=(new ji).fromArray(a);if(o.equals(l))return;let c=kF.subVectors(l,o);if(i&&c.toArray().every((e=>Math.abs(e)<2*Math.PI))){let t=(new Fi).setFromEuler(BF.setFromVector3(o)),n=(new Fi).setFromEuler(BF.setFromVector3(l));return{update:i=>{!function(e,t,n,i){if(0===i)return n.copy(e);if(1===i)return n.copy(t);let r=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(r>=1)return n.copy(e);let s=1-r*r;if(s<=Number.EPSILON){let r=1-i;return n.w=r*e.w+i*t.w,n.x=r*e.x+i*t.x,n.y=r*e.y+i*t.y,n.z=r*e.z+i*t.z,n.normalize(),n}let a=Math.sqrt(s),o=Math.atan2(a,r),l=Math.sin((1-i)*o)/a,c=Math.sin(i*o)/a;n.w=e.w*l+t.w*c,n.x=e.x*l+t.x*c,n.y=e.y*l+t.y*c,n.z=e.z*l+t.z*c}(t,n,e.quaternion,i)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}return{update:t=>{kF.lerpVectors(o,l,t),e.rotation.setFromVector3(kF)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}(e,t,n,i,r),o&&p.push(o),c=function(e,t,n,i){let r=n[e]?n[e]:void 0,s=i[e];if(!s)return;let a=t[e],o=r?(new vr).fromArray(r):a.clone(),l=new ji,c=new Fi,h=new ji;o.decompose(l,c,h);let u=(new vr).fromArray(s),d=new ji,p=new Fi,f=new ji;return u.decompose(d,p,f),o.equals(u)?void 0:{update:e=>{gF.slerpQuaternions(c,p,e),fF.lerpVectors(l,d,e),mF.lerpVectors(h,f,e),a.compose(fF,gF,mF)},start:()=>{a.compose(l,c,h)},end:()=>{a.compose(d,p,f)}}}("hiddenMatrix",e,t,n),c&&p.push(c))),s||a||o||c||h||u){let n=e instanceof yk?()=>{e.updateWorldMatrix(!0,!1,!0),e.resetBBoxNeedsUpdate()}:()=>{e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),e.parent?.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),YD(e)&&QD(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,d))};p.push({update:n,start:n,end:n})}return p}function zF(e,t,n,i){let r=[];if(!("cloner"in n)||!e.cloner)return r;let s=e.cloner,a="cloner"in t?t.cloner:{},o=n.cloner;Ix.forEach((e=>{let t;t="count"===e?vF("count",s.parameters,a,o,i,!0):AF(e,s.parameters,a??{},o,i),t&&r.push(t)}));let l=function(e,t,n,i){if("radial"!==e.parameters.type)return;let r=t.radial,s=n.radial;if(!s)return;let a=e.parameters.radial,o=[];return Ox.forEach((e=>{let t=AF(e,a,r??{},s,i);t&&o.push(t)})),o}(s,a,o,i);l?.length&&r.push(...l);let c=function(e,t,n,i){if("linear"!==e.parameters.type)return;let r=t.linear,s=n.linear;if(!s)return;let a=[],o=e.parameters.linear;return Dx.forEach((e=>{let t=AF(e,o,r??{},s,i);t&&a.push(t)})),a}(s,a,o,i);c?.length&&r.push(...c);let h=function(e,t,n,i){if("grid"!==e.parameters.type)return;let r=t.grid,s=n.grid;if(!s)return;let a=[],o=e.parameters.grid;return Lx.forEach((e=>{let t;t="count"===e?yF(e,o,r??{},s,i,!0):AF(e,o,r??{},s,i),t&&a.push(t)})),a}(s,a,o,i);h?.length&&r.push(...h);let u=function(e,t,n,i){if("toObject"!==e.parameters.type)return;let r=t.toObject,s=n.toObject;if(!s)return;let a=[],o=e.parameters.toObject;return Rx.forEach((e=>{let t;t="count"===e?vF(e,o,r??{},s,i,!0):AF(e,o,r??{},s,i),t&&a.push(t)})),a}(s,a,o,i);u?.length&&r.push(...u);let d=function(e,t,n,i){if(!e.parameters.randomness)return;let r=t.randomnessObject,s=n.randomnessObject;if(!s)return;let a=[],o=e.parameters.randomnessObject;return kx.forEach((e=>{let t=AF(e,o,r??{},s,i);t&&a.push(t)})),a}(s,a,o,i);return d?.length&&r.push(...d),r.length&&r.push({update:()=>{s.update()}}),r}function FF(e,t,n,i,r){let s,a,o,l,c,h,u,d,p,f,m,g,v,y,b,w=[];if("width"in e&&(s=vF("width",e,t,n,r),s&&w.push(s)),"height"in e&&(a=vF("height",e,t,n,r),a&&w.push(a)),e instanceof Wk||e instanceof Qk){let i={...t.fill},s={...n.fill};void 0!==i.enabled&&i.enabled!==s.enabled&&(w.push(function(e,t){return{update:()=>{e instanceof Wk&&(e.fill.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,color:{...i.color,a:0}}),s.enabled||Object.assign(s,{enabled:!0,color:{...s.color,a:0}})),o=CF("color",e.fill,i,s,r),o&&w.push(o)}if(e instanceof Wk){let i={...t.stroke},s={...n.stroke};(i.enabled||s.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof Wk&&(e.stroke.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,color:{...i.color,a:0}}),s.enabled||Object.assign(s,{enabled:!0,color:{...s.color,a:0}})),l=CF("color",e.stroke,i,s,r),l&&w.push(l),c=vF("thickness",e.stroke,i,s,r),c&&w.push(c)}if(e instanceof Wk){let i={...t.dropShadow},s={...n.dropShadow};(i.enabled||s.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof Wk&&(e.dropShadow.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,color:{...i.color,a:0}}),s.enabled||Object.assign(s,{enabled:!0,color:{...s.color,a:0}})),h=CF("color",e.dropShadow,i,s,r),h&&w.push(h),u=vF("blurRadius",e.dropShadow,i,s,r),u&&w.push(u),p=vF("spread",e.dropShadow,i,s,r),p&&w.push(p),d=EF("offset",e.dropShadow,i,s,r),d&&w.push(d)}if(e instanceof Wk){let i={...t.innerShadow},s={...n.innerShadow};(i.enabled||s.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof Wk&&(e.innerShadow.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,color:{...i.color,a:0}}),s.enabled||Object.assign(s,{enabled:!0,color:{...s.color,a:0}})),f=CF("color",e.innerShadow,i,s,r),f&&w.push(f),m=vF("blurRadius",e.innerShadow,i,s,r),m&&w.push(m),v=vF("spread",e.innerShadow,i,s,r),v&&w.push(v),g=EF("offset",e.innerShadow,i,s,r),g&&w.push(g)}if(e instanceof Wk||e instanceof Qk){let i={...t.backgroundBlur},s={...n.backgroundBlur};(i.enabled||s.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof Wk&&(e.backgroundBlur.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,radius:0}),s.enabled||Object.assign(s,{enabled:!0,radius:0})),y=vF("radius",e.backgroundBlur,i,s,r),y&&w.push(y)}if(e instanceof Wk){let i={...t.layerBlur},s={...n.layerBlur};(i.enabled||s.enabled)&&(w.push(function(e,t){return{update:()=>{e instanceof Wk&&(e.layerBlur.enabled=t)}}}(e,!0)),i.enabled||Object.assign(i,{enabled:!0,radius:0}),s.enabled||Object.assign(s,{enabled:!0,radius:0})),b=vF("radius",e.layerBlur,i,s,r),b&&w.push(b)}if(e instanceof Qk||e instanceof qk){let i=yF("cornerRadius",e,t,n,r);i&&w.push(i)}return w}function jF(e,t,n,i,r){let s=[];return e.data.visible&&s.push(...UF(e,t,n,r,i)),e instanceof yk?s.push(...FF(e,t,n,0,i)):(e.data.visible&&s.push(...zF(e,t,n,i)),YD(e)?(e instanceof DO&&e.data.visible&&s.push(...SF(e,t,n,i)),e.data.visible&&s.push(...function(e,t,n,i){let r=[];if(Array.isArray(e.material)){if(!("materials"in n)||!n.materials)return r;let s="materials"in t&&t.materials?t.materials:[],a=n.materials;e.material.forEach(((e,t)=>{if(!a[t])return;let n=s[t]??{},o=a[t];"string"==typeof n||"string"==typeof o||r.push(...TF(e,n,o,i))}))}else{if(!("material"in n)||!n.material)return r;let s="material"in t&&t.material?t.material:{},a=n.material;if("string"==typeof s||"string"==typeof a)return r;r.push(...TF(e.material,s,a,i))}return r}(e,t,n,i))):(e=>GD.is(e))(e)?e.data.visible&&s.push(..._F(e,t,n,i)):(e=>e instanceof jD)(e)&&s.push(...function(e,t,n,i){let r=[],s="OrthographicCamera"===e.cameraType?t.orthographic?.zoom:t.perspective?.zoom,a="OrthographicCamera"===e.cameraType?n.orthographic?.zoom:n.perspective?.zoom;if(void 0!==a){let t=s??e.zoom,n=a;t!==n&&r.push({update:i=>{e.zoom=ui.lerp(t,n,i),e.updateProjectionMatrix()},start:()=>{e.zoom=t,e.updateProjectionMatrix()},end:()=>{e.zoom=n,e.updateProjectionMatrix()}})}if(void 0!==n.targetOffset){let s=vF("targetOffset",e,t,n,i);s&&r.push(s)}return r}(e,t,n,i))),s.length?{update:e=>{s.forEach((t=>t.update(e)))},start:e=>{s.forEach((t=>t.start?.(e)))},end:e=>{s.forEach((t=>t.end?.(e)))}}:void 0}var VF=new ji;function HF(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[],r=n=>{let i=n.data;delete n.states,n.currentState=null,n.reversibleToState=null,n.currentTransitionEvent=null;for(let e of i.states){let t={...e.data};n.states||(n.states={}),n.states[e.id]=cC.patch(i,t)}GF(e.scene,n,null,t,void 0!==i.events.find((e=>"Follow"===e.data.type||"LookAt"===e.data.type))),WF(e)};e.scene.traverse2D(r),e.traverseChildren((s=>{if(n&&(s.rigidBody?.setTranslation(s.position0,!0),s.rigidBody?.setRotation(s.rotation0,!0),s.rigidBody?.setLinvel(VF,!0),s.rigidBody?.setAngvel(VF,!0)),!sS.is(s))return;let a=s.uuid,o=s.data;if(delete s.states,s.uuid===gx)return;let l=!1;i.some((t=>e.scene.find(a)?.isDescendantOf(t)))?l=!0:!0===o.physics?.fusedBody&&"dynamic"===o.physics.rigidBody&&i.push(a),s.data=o,s.currentState=null,s.reversibleToState=null,s.currentTransitionEvent=null;for(let t of o.states){let n={...t.data};!0===e.data.globalPhysics.usePhysics&&o.physics&&("dynamic"===o.physics.rigidBody||l)&&(void 0!==t.data.position&&delete n.position,void 0!==t.data.rotation&&delete n.rotation,void 0!==t.data.hiddenMatrix&&delete n.hiddenMatrix),s.states||(s.states={}),s.states[t.id]=bE.patch(o,n)}GF(e.scene,s,null,t,void 0!==o.events.find((e=>"Follow"===e.data.type||"LookAt"===e.data.type))),s instanceof CB&&s.frame&&(s.frame.traverse((e=>r(e))),s.uiCanvas?.applySize())})),WF(e),e.frame&&(e.frame.traverse((e=>r(e))),e.uiCanvas?.applySize())}function WF(e){e.traverseEntity((t=>{for(let n of t.data.events){let t=[];switch(n.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":t.push(...n.data.actions);break;case"GameControl":for(let e of Object.values(n.data.gameActions))t.push(...e);break;case"DragDrop":t.push(...n.data.dragDropActions.drag,...n.data.dragDropActions.drop);break;case"Conditional":t.push(...n.data.inActions,...n.data.outActions)}for(let n of t)if("Create"===n.data.type&&"Yes"===n.data.hideBase){let t=e.scene.find(n.data.object);t&&(t.visible=!1)}}}))}function GF(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(t instanceof DO&&!(t instanceof GB)&&t.removeInteractionGeometry(i),t instanceof yk?t.changeSelectedState(n,{shared:i},r):t.changeSelectedState(n,{scene:e,shared:i},r),t instanceof DO&&t.updateGeometryGroupsIfNeeded(),t instanceof jD&&t.updateCameraState(t.dataPatched,{scene:e,shared:i}),!(t instanceof yk)){if(t.cloner)for(let e of t.cloner.children)e.playModeVisible=void 0;t.updateVisible()}}function qF(e){let t;if(5===e.easing){let{control1:n,control2:i}=e;t=`cubicBezier(\n\t\t\t${n[0]}, ${n[1]}, ${i[0]}, ${i[1]}\n\t\t)`}else if(6===e.easing){let{mass:n,stiffness:i,damping:r,velocity:s}=e;t=`spring( ${n}, ${i}, ${r}, ${s} )`}else{let n;switch(e.easing){case 0:default:n=hx.linear;break;case 1:n=hx.ease;break;case 2:n=hx.easeIn;break;case 3:n=hx.easeOut;break;case 4:n=hx.easeInOut}let[i,r,s,a]=n;t=`cubicBezier( ${i}, ${r}, ${s}, ${a} )`}return{duration:Math.max(e.duration,1e-4),easing:t}}function KF(e){let t={delay:0,loop:-1===e.repeat||e.repeat+1};if(0===e.repeat)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay}return"alternate"===t.direction&&(t.delay/=2,t.endDelay/=2,"start"===e.delayDirection?(t.pingPongDelayCorrection=t.delay,"number"==typeof t.loop&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):"end"===e.delayDirection?"number"==typeof t.loop&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):"start-end"===e.delayDirection&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var YF={type:"beginState"},QF={type:"completeState",isfromEntity:!1},XF=class{constructor(e,t,n,i,r,s){if(this.object=e,this.data=i,this.sharedAssets=r,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),0===this.targets.t||1===this.targets.t?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let e=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=e,this.object.dispatchEvent({type:"beginState",state:e}),this.object instanceof yk||this.object.traverseEntity((e=>{e!==this.object&&e instanceof jD&&e.dispatchEvent(YF)}))},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let e=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=e,this.object.dispatchEvent({type:"completeState",state:e}),this.object instanceof yk||this.object.traverseEntity((e=>{e!==this.object&&e instanceof jD&&e.dispatchEvent(QF)}))},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=jF(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},void 0===t){let e=JF(this.object,this.object.currentState===n?this.object.prevState:this.object.currentState);if(!e)throw new Error("Missing property");this.from=e}else{let e=JF(this.object,t);if(!e)throw new Error("Missing property");this.from=e}if(void 0===n)throw new Error("Missing property");{let e=JF(this.object,n);if(!e)throw new Error("Missing property");this.to=e}this.useCurrentState=void 0===t||void 0===n,this.params={targets:this.targets,t:1,autoplay:!1,...KF(i),...qF(i),change:this.onChange},this.callback=jF(this.object,void 0===t?{}:this.from.data,void 0===n?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},ZF=class extends Zn{constructor(e,t,n,i,r){if(super(),this.eventType=e,this.data=t,this.page=n,this.shared=i,this.condition=r,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{"normal"!==this.data.tweens[0].data.direction&&(this.toggleIsForward=!this.toggleIsForward),!1!==this.timelineNeedsRebuild&&(this.timeline?.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let s=this.page.scene.find(t.object)??this.page.uiCanvas?.find(t.object)??this.page.scene.find2DInUIObjects(t.object);if(!s)throw new Error("Missing property");if(!s.states)throw new Error("Missing property");if(this.object=s,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay="start-once"===t.tweens[0].data.delayDirection?t.tweens[0].data.delay:0,this.init()}get playing(){return!1===this.timeline?.paused}get changeBegan(){return this.tweens.some((e=>e.changeBegan))??!1}init(){this.initialCurrentState=JF(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return"Toggle"===this.data.runMode&&Pw(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline(){let{isForward:e=!0,needsRebuild:t=!1,isRebuild:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let i=KF(this.data.tweens[0].data);n&&"number"==typeof i.loop&&i.loop--,this.timeline?.pause(),this.timeline=pF.timeline({autoplay:!1,...i,...!0===i.loop||i.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let r=this.tweens.findIndex((e=>e?.changeBegan));if(!0===t&&(this.timelineNeedsRebuild=!0),e){let e=-1===r?0:r;for(let t=e;t<this.data.tweens.length-1;t++){let n,s=this.data.tweens[t],a=this.data.tweens[t+1];t!==e||!0!==this.object.wasMovedByUser&&!0!==this.object.previousAction?.changeBegan?n=void 0===s.data.state?this.currentState:s.data.state:(n=void 0,this.object instanceof jD&&(this.object.wasMovedByUser=!1));let o=new XF(this.object,n,void 0===a.data.state?this.currentState:a.data.state,a.data,this.shared,this.data.allowSlerp??!1);-1!==r&&t===e&&Object.assign(o.params,{startOnceDelay:0}),this.tweens[t]=o,this.timeline.add(o.params,this.timeline.duration+(t===e?i.delay:0))}this.timeline.duration+=i.endDelay}else{let e=-1===r?this.data.tweens.length-1:r+1;for(let t=e;t>0;t--){let n,s=this.data.tweens[t],a=this.data.tweens[t-1];t!==e||!0!==this.object.wasMovedByUser&&!0!==this.object.previousAction?.changeBegan?n=void 0===s.data.state?this.currentState:s.data.state:(n=void 0,this.object instanceof jD&&(this.object.wasMovedByUser=!1));let o=new XF(this.object,n,void 0===a.data.state?this.currentState:a.data.state,s.data,this.shared,this.data.allowSlerp??!1);-1!==r&&t===e&&Object.assign(o.params,{startOnceDelay:0}),this.tweens[t-1]=o,this.timeline.add(o.params,this.timeline.duration+(t===e?i.endDelay:0))}this.timeline.duration+=i.delay}}catch(ux){ux instanceof Error&&console.error(ux.message)}!0===this.object.previousAction?.playing&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(!1===hj(this.shared,this.condition)||Pw(this.eventType)&&"Once"===this.data.runMode&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let e=KF(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout((()=>{try{this.buildTimeline(),this.timeline.play()}catch(Me){Me instanceof Error&&console.error(Me.message)}}),this.startOnceDelay+e)}pause(){this.timeline?.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=void 0===this.data.tweens[0].data.state?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof yk?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){if(!1===hj(this.shared,this.condition))return!1;void 0===this.timeline&&this.buildTimeline(),this.timeline?.seek(e*this.timeline.duration,!0)}toggle(e){if(!1===hj(this.shared,this.condition))return!1;clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?(this.timeline?.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout((()=>{this.timeline?.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()}),this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function JF(e,t){let n,i;if("string"==typeof t?(n=t,i=e.states?.[n]):null===t&&(n=null,i=e.data),void 0!==n&&void 0!==i)return{id:n,data:i}}var $F={type:"beginState"},ej={type:"completeState",isfromEntity:!1},tj={type:"requestRender"},nj=class extends Zn{constructor(e,t,n,i){super(),this.data=e,this.page=t,this.shared=n,this.condition=i,this.toggleIsForward=!1,this.posStart=new ji,this.posEnd=new ji,this.qStart=new Fi,this.qEnd=new Fi,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(){if(!this.data.animate)return;let e=this.page.scene.find(this.data.targetCamera);if(!e||!e.visible)throw new ReferenceError("Target camera not founded or not visible");let t={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=pF({targets:t,t:1,...qF(this.data),update:()=>{0===t.t&&("Toggle"!==this.data.runMode||this.toggleIsForward?(this.posEnd.copy(e.position),this.qEnd.copy(e.quaternion),this.zoomEnd=e.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(e.uuid)):this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)),this.page.activeCamera.dispatchEvent($F));let n=this.page.activeCamera;n.position.lerpVectors(this.posStart,this.posEnd,t.t),n.quaternion.slerpQuaternions(this.qStart,this.qEnd,t.t),n.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*t.t,n.wasMovedBySwitchCameraAction=!0,n.updateMatrix(),n.updateMatrixWorld(),n.updateProjectionMatrix(),n.dispatchEvent(tj),1===t.t&&n.dispatchEvent(ej)}})}switchCamera(e){let t=this.page.activeCamera,n=this.page.scene.find(e);if(!n||!n.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(n),t.dispatchEvent({type:"cameraChange",camera:n})}play(){if(!1===hj(this.shared,this.condition))return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout((()=>{delete this.timeoutId,this.data.animate?(this.buildAnimation(),this.animation?.play()):this.switchCamera(this.data.targetCamera)}),1e3*this.data.delay)}catch{}}pause(){this.animation?.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){if(!1===hj(this.shared,this.condition))return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,e!==this.toggleIsForward)try{this.playing?(this.animation?.pause(),this.toggleIsForward=e??!this.toggleIsForward,this.buildAnimation(!0),this.animation?.play()):this.timeoutId=window.setTimeout((()=>{this.toggleIsForward=e??!this.toggleIsForward,this.data.animate?(this.animation?.pause(),this.buildAnimation(),this.animation?.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(ej),this.page.activeCamera.dispatchEvent(tj))}),1e3*this.data.delay)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function ij(e){let t=e?.tracks.filter((e=>"vector"===e.ValueTypeName||"quaternion"===e.ValueTypeName)).map((e=>e.times.length));if(t?.length){let e=xv(t);return e&&e>2?e:2}return 2}var rj=class extends Zn{constructor(e,t,n,i,r){super(),this.data=e,this.page=t,this.animationControls=n,this.shared=i,this.condition=r,this.startOnceDelay=0,this.toggleIsForward=!1;let s=e.object,a=t.scene.find(e.object);a&&Array.isArray(a.identity)&&(s=a.identity[0]),this.data={...e,object:s};let o=this.animationControls.clipIdToAction[e.clipId+"/"+s];if(this.duration=o?.getClip()?.duration??1,this.data.crop2){let e=ij(o?.getClip());this.leftFrameTime=this.data.crop2[0]/(e-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(e-1)*this.duration}else{let e=o?.getClip()?.tracks[0]?.times.length;e&&e>1?(this.leftFrameTime=this.data.crop[0]/e*this.duration,this.rightFrameTime=this.data.crop[1]/e*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=e.delay}get playing(){return this.threeAnimAction?.isRunning()??!1}play(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!1===hj(this.shared,this.condition))return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout((()=>{if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach((n=>{let[i,r]=n,s=i.split("/")[1];this.threeAnimAction!==r&&s===t&&r.isRunning()&&(e?r.fadeOut(.2):r.stop())})),e&&this.threeAnimAction?.fadeIn(.2)}),this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){this.threeAnimAction?.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=ui.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1===hj(this.shared,this.condition))return!1;this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout((()=>{if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let e=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach((n=>{let[i,r]=n,s=i.split("/")[1];this.threeAnimAction!==r&&s===e&&r.isRunning()&&(t?r.fadeOut(.2):r.stop())})),t&&this.threeAnimAction?.fadeIn(.2)}}),this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){let e=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object]?.getClip();e&&(e.duration=this.duration),this.pause()}},sj=class{constructor(e,t,n,i,r){this.data=e,this.page=t,this.eventManager=n,this.shared=i,this.condition=r,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(!1===hj(this.shared,this.condition))return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout((()=>{this.play()}),1e3*this.data.delay))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every((e=>e.uuid!==this.data.target||e.data.uiScene)))return;"fade"===this.data.transition&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,1e3*this.data.duration),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity((e=>{"ParticleSystem"===e.type&&(e.sleep(),e.wakeUp(),e.data.autoPlay?e.start():e.stop())})),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),HF(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},aj=class{constructor(e,t,n,i){this.data=e,this.page=t,this.shared=n,this.condition=i,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=hj(this.shared,this.condition)}dispatch(){if(!1===this.evaluatedCondition)return!1;let e=this.shared.getVariable(this.data.variableId),t=$T(this.data.expression,this.shared,NE.typeOfVariable(e));void 0!==t&&this.shared.updateVariable(this.data.variableId,"string"==typeof t?{textValue:t}:t)}dispose(){}},oj=class{constructor(e,t,n,i){this.data=e,this.page=t,this.shared=n,this.condition=i,this.timeoutId=null}dispatchInner(){if(!1===hj(this.shared,this.condition))return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if("PlayPause"===this.data.mode)void 0===this.shared.getDynamicVariableToggleIsForward(this.data.variableId)&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"===e?"Paused":"Playing");else if("Play"===this.data.mode&&"Playing"!==e)void 0===this.shared.getDynamicVariableToggleIsForward(this.data.variableId)&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if("Stop"===this.data.mode&&"Stopped"!==e)this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if("Pause"===this.data.mode&&"Paused"!==e)this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if("Restart"===this.data.mode)this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if("Toggle"===this.data.mode){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);"Playing"===e?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,void 0!==t&&!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);"PlayPause"===this.data.mode&&"Playing"===t&&(e=this.data.pauseDelay),0!==e?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout((()=>{this.timeoutId=null,this.dispatchInner()}),e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},lj=class{constructor(e,t,n,i){this.data=e,this.page=t,this.shared=n,this.condition=i}dispatch(){if(!1===hj(this.shared,this.condition))return!1;("single"===this.data.target?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach((e=>{this.shared.getVariable(e);let t=this.shared.data.variables.data(e)?.value;void 0!==t&&this.shared.updateVariable(e,t),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(AO(e))}))}dispose(){}},cj=class{constructor(e,t,n,i){this.data=e,this.page=t,this.shared=n,this.condition=i}dispatch(){if(!1===hj(this.shared,this.condition))return!1;this.data.userAPIId&&this.shared.getUserAPI(this.data.userAPIId)?.callUserAPI(this.shared)}dispose(){}};function hj(e,t){if(void 0===t)return!0;if(0===t.expression.length)return!1;let n=$T(t.expression,e,"boolean");return t.negate?!n:!!n}function uj(e,t,n,i,r,s){let a={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},o=t=>l=>{let{id:c,data:h}=l;try{"Audio"===h.type?Qw[e.type].includes("Audio")&&a.Audio.push(new rz(c,h,s,i,t)):"Video"!==h.type||s instanceof yk?"Particles"===h.type?Qw[e.type].includes("Particles")&&a.Particles.push(new sz(h,n,i,t)):"Link"===h.type?Qw[e.type].includes("Link")&&a.Link.push(new lz(h,r.controlsManager,i,t)):"Create"===h.type?Qw[e.type].includes("Create")&&a.Create.push(new Cj(h,n,r.controlsManager,i,t)):"Destroy"===h.type?Qw[e.type].includes("Destroy")&&a.Destroy.push(new cz(h,n,r.controlsManager,i,t)):"Reset"===h.type?Qw[e.type].includes("Reset")&&a.Reset.push(new hz(h,n,i,r,t)):"Transition"===h.type?Qw[e.type].includes("Transition")&&a.Transition.push(new ZF(e.type,h,n,i,t)):"SwitchCamera"===h.type?Qw[e.type].includes("SwitchCamera")&&a.SwitchCamera.push(new nj(h,n,i,t)):"SceneTransition"===h.type?Qw[e.type].includes("SceneTransition")&&a.SceneTransition.push(new sj(h,n,r,i,t)):"Animation"===h.type?Qw[e.type].includes("Animation")&&a.Animation.push(new rj(h,n,r.animationControls,i,t)):"SetVariable"===h.type?Qw[e.type].includes("SetVariable")&&a.SetVariable.push(new aj(h,n,i,t)):"DynamicVariablePlay"===h.type?Qw[e.type].includes("DynamicVariablePlay")&&a.DynamicVariablePlay.push(new oj(h,n,i,t)):"Conditional"===h.type?Qw[e.type].includes("Conditional")&&(h.ifActions.forEach(o({expression:h.condition,negate:!1})),h.elseActions.forEach(o({expression:h.condition,negate:!0}))):"ClearLocalStorage"===h.type?Qw[e.type].includes("ClearLocalStorage")&&a.ClearLocalStorage.push(new lj(h,n,i,t)):"UserAPI"===h.type&&Qw[e.type].includes("UserAPI")&&a.UserAPI.push(new cj(h,n,i,t)):Qw[e.type].includes("Video")&&a.Video.push(new vj(c,h,s,i,t))}catch(rx){}};return t.forEach(o()),a}function dj(e){Object.values(e).forEach((e=>{e.forEach((e=>{(e instanceof rz||e instanceof vj||e instanceof sz||e instanceof rj||e instanceof ZF||e instanceof Cj||e instanceof cz||e instanceof nj||e instanceof sj||e instanceof hz||e instanceof aj||e instanceof oj)&&e.dispose()}))}))}var pj=new Map,fj=new Map,mj=class{constructor(e,t,n){this.data=t,this.delay=0,this.status="stopped";let{layerId:i,loop:r,volume:s,delay:a}=t;if(this.object=n,void 0===i)throw new Error("Missing property");let o=function(e,t){let n;if("material"in e){let i=e.material;n=Array.isArray(i)?e.material[0].layers.find((e=>e.uuid===t)):e.material.layers.find((e=>e.uuid===t))}if(n)return n.color.texture.image.img instanceof HTMLVideoElement?n.color.texture.image.img:void 0}(n,i);o&&(this.videoElement=o,this.videoElement.loop=r===1/0,kv&&(this.videoElement.autoplay=!0),void 0!==s&&(this.videoElement.volume=s)),void 0!==a&&(this.delay=a),fj.has(n.uuid)?fj.get(n.uuid).push(this):fj.set(n.uuid,[this]),pj.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout((()=>{this.unMute()}),100)):this.unMute(),this.delayTimerId=window.setTimeout((()=>{if(!this.videoElement)return;let e=this.videoElement.play();void 0!==e&&e.then((e=>{})).catch((e=>{this.play()})),this.clearDelay()}),this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){"stop"===this.data.toggle?"playing"===this.status?this.stop():(this.stop(),this.play()):"pause"===this.data.toggle?"playing"===this.status?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},gj=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=pj.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t[this.data.interaction](),this.disposeDelay()}),this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=fj.get(e);!t?.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{t.forEach((e=>e[this.data.interaction]())),this.disposeDelay()}),this.data.delay)):t.forEach((e=>e[this.data.interaction]())))}pauseAllVideos(){let e=[...fj.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout((()=>{e.forEach((e=>{e.forEach((e=>{e[this.data.interaction]()}))})),this.disposeDelay()}),this.data.delay)):e.forEach((e=>{e.forEach((e=>{e[this.data.interaction]()}))})))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},vj=class{constructor(e,t,n,i,r){if(this.data=t,this.shared=i,this.condition=r,"play"===t.interaction)this.interaction=new mj(e,t,n);else{if("pause"!==t.interaction&&"stop"!==t.interaction)throw new Error("Missing property");this.interaction=new gj(t)}}dispatchBasic(){if(!1===hj(this.shared,this.condition))return!1;this.interaction instanceof mj?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(!1===hj(this.shared,this.condition))return!1;this.interaction instanceof mj?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},yj=(()=>{let e,t,n,i;function r(n){!e&&!bj()&&t?.sharedGameControlGlobals.createdObjects.length>0&&(e=requestAnimationFrame(s)),n&&(t=n,i=n.requestRender)}function s(r){let a=n?r-n:0,o=t.sharedGameControlGlobals.createdObjects,l=t.sharedGameControlGlobals.nCreatedPerAction,c=o.length,h=0;for(;h<c;){let e=o[h];void 0===e.userData.createdTime&&(e.userData.createdTime=r),void 0===e.userData.lifetime&&void 0===e.userData.quantity||e.userData.lifetime&&r-e.userData.createdTime<e.userData.lifetime||e.userData.quantity&&l[e.userData.actionId]<=e.userData.quantity?(e.userData.velocity&&(e.position.addScaledVector(e.userData.velocity,a/1e3),e.updateMatrix(),i()),h++):(l[e.userData.actionId]>e.userData.quantity&&l[e.userData.actionId]--,o.splice(h,1),e.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&e.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(e.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(e.rigidBody)):(e.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter((e=>void 0!==e.bvhGeometry))),c--,i())}e=h>0?requestAnimationFrame(s):void 0,n=h>0?r:void 0}return typeof document<"u"&&document.addEventListener("visibilitychange",(function(){bj()?e&&(cancelAnimationFrame(e),e=void 0,n=void 0):r()})),r})();function bj(){return!!document&&document.hidden}var wj=new Fi,xj=new ji,Ej=new ji,Cj=class{constructor(e,t,n,i,r){this.data=e,this.page=t,this.controlsManager=n,this.shared=i,this.condition=r,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=ui.generateUUID(),this.dispatch=()=>{if(!1===hj(this.shared,this.condition))return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay)):this.dispatchInner()},this.dispatchFromStart=()=>{if(!1===hj(this.shared,this.condition))return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,1e3*this.data.delay))},this.dispatchThrottled=Iv(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{null===this.intervalId&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{null!==this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let e=new lS(this.object);if(e.playModeVisible=!0,e.expand(),"world"!==this.data.coordinateSystem){let t=this.data.coordinateSystem,n=this.page.scene.find(t);n&&(n.updateMatrixWorldSVD(),e.hiddenMatrix.copy(n.matrixWorldRigid))}e.scale.copy(this.object.scale),e.position.fromArray(this.data.position),e.rotation.fromArray(this.data.rotation),e.updateMatrix(),this.page.add(e);let t=this.controlsManager.sharedGameControlGlobals;t.createdObjects.push(e),void 0===t.nCreatedPerAction[this.uniqueId]?t.nCreatedPerAction[this.uniqueId]=1:t.nCreatedPerAction[this.uniqueId]++,e.updateWorldMatrix(!0,!0),e.traverseObject(this.traverseObjectCB),yj(),this.controlsManager.requestRender()},this.traverseObjectCB=e=>{let t;if(e.hasNonUniformScale&&e.updateMatrixWorldSVD(),this.controlsManager.sharedGameControlGlobals.rapierWorld){if(e instanceof ED){if(!e.objectForSample)return!0===e.object.dataPatched.physics.fusedBody&&"dynamic"===e.object.dataPatched.physics.rigidBody||void 0;if(e.objectForSample.dataPatched.physics.fusedBody)return;t=e.object}else if(e instanceof lS)t=e.object;else if(t=e,t.dataPatched.cloner?.hideBase)return!0}else{if(e instanceof ED)return;t=e instanceof lS?e.object:e}"Time"===this.data.destroy?e.userData.lifetime=1e3*this.data.lifetime:"Quantity"===this.data.destroy&&(e.userData.quantity=this.data.destroyAfterQuantity,e.userData.actionId=this.uniqueId);let n=(new ji).fromArray(this.data.velocity),i=t.dataPatched;if(!("visibility"===i.physics.enabled?!i.visible:!i.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(e,t,{fromCreate:!0,dynamic:this.data.dynamic}),"Collision"===this.data.destroy&&(e.rigidBody?.collider(0).setActiveEvents(1),e.userData.hasCollisionDestroy=!0),e.matrixWorld.decompose(xj,wj,Ej),n.applyQuaternion(wj),this.data.velocity.some((e=>0!==e))&&this.data.dynamic&&e.rigidBody?.setLinvel(n.divideScalar(this.controlsManager.pixelsPerMeter),!0)):("geometry"in e.object&&this.controlsManager.addBoundsTree(e),this.data.velocity.some((e=>0!==e))&&this.data.dynamic&&(e.userData.velocity=n)),!0===t.dataPatched.physics?.fusedBody))return!0};let s=this.page.scene.find(this.data.object);if(!s)throw new Error("Missing Property");if(this.object=s,"world"!==this.data.coordinateSystem&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");yj(n)}dispose(){null!==this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach((e=>window.clearTimeout(e))),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},Aj=.02,Sj=(new ji,new ji),_j=new ji,Tj=new ji,Pj=new ji,Mj=new ji,Nj=new ji,Ij=new vr,Oj=new vr,Dj=new vr,Lj=(new vr,new Fi),Rj=new Fi,kj=new Tr(0,0,0,"YXZ"),Bj=new ji(1,0,0),Uj=new ji(0,1,0),zj=new ji(0,0,1),Fj=new ji(1,1,1),jj=(new lr,new Pu),Vj=new Wi,Hj={type:"requestRender"},Wj={type:"updateMatrix"},Gj=Math.PI/6,qj=class extends Zn{constructor(e,t,n,i,r,s,a,o,l){super(),this.object=e,this.domElement=t,this.data=n,this.gloabalPhysics=i,this.controlsManager=r,this.cameraFollow=s,this.camera=a,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new vr,this.target0=new ji,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=200,this.euler0=new Tr(0,0,0,"YXZ"),this.position0Cam=new ji,this.quat0Cam=new Fi,this.scale0Cam=new ji,this.hiddenMatrix0Cam=new vr,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new Pu(new ji(0,-40,0),new ji(0,40,0)),matrix:new vr,position:new ji,rotation:new Fi},this.euler=new Tr(0,0,0,"YXZ"),this.eulerDelta=new ji,this.lastPosition=new ji,this.lastCameraQuaternion=new Fi,this.lastCameraPosition=new ji,this.PI_2=Math.PI/2,this.prevMouse=new di,this.velocityTarget=new ji,this.velocity=new ji,this.directionXZ=new ji,this.rotVelocityStick=new ji,this.rotVelocityTarget=new ji,this.rotVelocity=new ji,this.rotDirection=new ji,this.nonColliderRotOffset=new vr,this.nonColliderPosOffset=new vr,this.firstPointerId=-1,this.rot=new ji,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new vr,this.objectToTarget=new ji,this.objectToTarget0=new ji,this.objectToCamXZ=new ji,this.objectToCamXZ0=new ji,this.targetToCamera=new ji,this.targetToCamera0=new ji,this.cameraPolarAxis0=new ji,this.targetPos=new ji,this.targetQuat=new Fi,this.lerpFactorPos=(new ji).setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new Fi,this.objXZQuatInv=new Fi,this.objXZRotMat=new vr,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new ji,this.pushedVelocity=new ji,this.groundYRotation=0,this.objectRealQuat=new Fi,this.colliderWorldQuat=new Fi,this.groundNormal=new ji,this.groundTilt=new Fi,this.groundTiltInv=new Fi,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new ji,this.quaternion=new Fi,this.scale=new ji,this.initialAction=!0,this.onPointerDown=e=>{!(e.target===this.domElement||e.target instanceof HTMLElement&&"SPLINE-VIEWER"===e.target.tagName&&e.target.shadowRoot?.contains(this.domElement))||-1!==this.firstPointerId||(this.firstPointerId=e.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),"keys"!==this.rotBy&&!Uv&&!zv&&this.domElement.requestPointerLock(),this.prevMouse.set(e.clientX,e.clientY))},this.onPointerUp=e=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),"mouse"===e.pointerType&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=e=>{if(e.pointerId!==this.firstPointerId)return;let t=e.clientX-this.prevMouse.x,n=e.clientY-this.prevMouse.y;this.prevMouse.set(e.clientX,e.clientY),"mouse"===e.pointerType&&"keys"!==this.rotBy&&(zv&&Fv<15.5&&!Uv?(this.eulerDelta.y=-t*this.mouseOrbitSensitivity,this.eulerDelta.x=-n*this.mouseOrbitSensitivity):(this.eulerDelta.y=-e.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-e.movementY*this.mouseOrbitSensitivity)),"mouse"!==e.pointerType&&"drag"===this.rotByTouch&&(this.eulerDelta.y=-t*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-n*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=e=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?qj.isLocked=!0:qj.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document?.hidden)for(let e in this.movementState)this.movementState[e]=0},this.onKeyDown=e=>{!(e.target instanceof HTMLInputElement)&&("ArrowLeft"===e.code||"ArrowUp"===e.code||"ArrowRight"===e.code||"ArrowDown"===e.code||"Space"===e.code)&&e.preventDefault();for(let t of this.keyAssignments)if(e.key.toUpperCase()===t[1]||e.key===t[1]){this.movementState[t[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=e=>{for(let t of this.keyAssignments)if(e.key.toUpperCase()===t[1]||e.key===t[1]||e.code.slice(3,e.code.length).toUpperCase()===t[1]){this.movementState[t[0]]=0;break}},this.copyVRGamePadValues=(e,t)=>{for(let n=2;n<4;n++){let i=e.axes[n];0===t?2===n?this.movementState.movePosX=i:this.movementState.movePosZ=i:(e.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,2===n?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(i)>=.3&&(this.vrEulerYOffset+=i<0?1:-1),this.movementState.rotPosY=i):"fly"===this.moveMode&&(this.movementState.moveNegY=i))}},this.sharedGameControlGlobals=r.sharedGameControlGlobals,e===a&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),h=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,h,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||!0===this.cameraFollow)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),!0===this.cameraFollow){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy(this.camera?.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let e,t,n=new ji(0,0,-1).applyQuaternion(this.camera.quaternion),i=(new ji).subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(i),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ),Math.abs(n.y)<1e-6?(i.y=0,n.y=0,t=i.projectOnVector(n)):t=i.y/n.y>0?n.multiplyScalar(i.y/n.y):n.multiplyScalar(i.length()),this.targetToCamera0.copy(t).negate(),e=this.camera.position.clone().add(t),this.objectToTarget0.subVectors(e,this.position);let r=(new Tr).setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-r.x,r.x=0,r.z=0,r.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(r)}if(this.object instanceof jD&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=n.rotByTouch??"joystick",this.rotBy=n.rotBy??"keys",this.rotationMode=n.rotationMode??"normal",this.moveMode=n.moveMode??"walk",this.collisionEnabled=n.collisionEnabled,this.speedTranslate=1*(n.speedTranslate??250),this.speedOrbit=.025*(n.speedRotate??100),this.mouseOrbitSensitivity=16e-6*(n.speedRotate??100),this.keyAssignments=n.keyAssignments.map((e=>{let t=[e[0],e[1]];return"\u25b2"===t[1]?t[1]="ArrowUp":"\u25c0"===t[1]?t[1]="ArrowLeft":"\u25bc"===t[1]?t[1]="ArrowDown":"\u25b6"===t[1]?t[1]="ArrowRight":"\u21e7"===t[1]?t[1]="Shift":"\u21b5"===t[1]?t[1]="Enter":"Space"===t[1]?t[1]=" ":"\u2318"===t[1]?t[1]="Meta":"Ctrl"===t[1]?t[1]="Control":"Esc"===t[1]&&(t[1]="Escape"),t})),"mouse"===n.rotBy){let e;e=this.keyAssignments.findIndex((e=>"rotNegX"===e[0])),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex((e=>"rotPosX"===e[0])),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex((e=>"rotPosY"===e[0])),-1!==e&&(this.keyAssignments[e][1]=""),e=this.keyAssignments.findIndex((e=>"rotNegY"===e[0])),-1!==e&&(this.keyAssignments[e][1]="")}this.lerpFactorPosStart=1-.02**(1/(60*(n.delayPos[0]??.3))),this.lerpFactorPosEnd=1-.02**(1/(60*(n.delayPos[1]??.3))),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/(60*(n.delayRot[0]??.3))),this.lerpFactorRotEnd=1-.02**(1/(60*(n.delayRot[1]??.3))),this.lerpFactorPosCamera=1-.02**(1/(60*(n.delayPosCamera??.3))),this.lerpFactorRotCamera=1-.02**(1/(60*(n.delayRotCamera??.3))),this.gravity=12*(this.gloabalPhysics.gravity??tE.defaultData.gravity),this.usePhysics=this.gloabalPhysics.usePhysics??tE.defaultData.usePhysics,this.jumpPower=20*n.jumpPower,this.resetYPosition=this.position.y+Math.abs(n.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=n.alignToGround??!1,this.orientMode=n.autoOrientMove?n.orientMode:"none",this.orientWith=n.orientWith??BE.defaultDataThirdPerson.orientWith,this.slopeThresh=65*Math.PI/180,"capsule"===n.collider.type?(this.collider.radius=n.collider.radius,this.collider.segment.start.y=n.collider.height/2-n.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=n.collider.height*Aj/this.pixelsPerMeter,this.stepThresh=.3*n.collider.height/this.pixelsPerMeter,this.colliderHeight=n.collider.height):"sphere"===n.collider.type?(this.collider.radius=n.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*n.collider.radius*Aj/this.pixelsPerMeter,this.stepThresh=2*n.collider.radius*.3/this.pixelsPerMeter,this.colliderHeight=2*n.collider.radius):(this.offset=n.collider.height*Aj/this.pixelsPerMeter,this.stepThresh=.3*n.collider.height/this.pixelsPerMeter,this.colliderHeight=n.collider.height),this.collider.type=n.collider.type;let u=(new ji).fromArray(n.collider.position),d=(new Fi).setFromEuler((new Tr).fromArray([...n.collider.rotation,"XYZ"]));this.collider.position.copy(u).multiply(this.scale),this.collider.rotation.copy(d),this.collider.matrix.compose(u,d,Fj),void 0!==n.cameraXAxis&&(this.cameraXAxis=n.cameraXAxis,this.cameraYAxis=n.cameraYAxis,this.minPolarAngle=n.cameraRotXLimits[0],this.maxPolarAngle=n.cameraRotXLimits[1],this.minAzimuthAngleRel=n.cameraRotYLimits[0],this.maxAzimuthAngleRel=n.cameraRotYLimits[1]),this.forwardDir=n.forwardDirection??"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=n.runMultiplier??2;let p=2*n.navmesh.destinationHelperRadius;if(p>0){let e=new yy;e.push({fi:0,data:{...Bx.defaultData("light","phong"),alpha:0},id:"layer1"}),e.push({fi:0,data:{...Bx.defaultData("color"),color:n.navmesh.destinationHelperColor,alpha:n.navmesh.destinationHelperColor.a},id:"layer2"});let t=new BI({layers:e},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new Ns(MS.create({parameters:{width:p,height:p/10,hollow:.7}}),t),this.navMeshPathDest.material.userData.opacity0=n.navmesh.destinationHelperColor.a}this.activate()}reset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let e=(new Tr).setFromQuaternion(this.quaternion,"YXZ"),t=e.y;this.objectRealQuat.copy(this.quaternion),e.y=0,this.quaternion.setFromEuler(e),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),e.set(0,t,0),this.quaternion.setFromEuler(e),this.rot.setFromEuler(e),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof jD?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();!0===this.cameraFollow&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){this.deactivate(),this.navMeshPathDest?.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;void 0!==e.gameActions&&(this.actions={},kE.list.forEach((n=>{this.actions[n]=uj({...e,disabled:!1,type:"GameControl"},e.gameActions[n],this.page,t,this.controlsManager.eventManager,this.object)}))),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),dj(this.actions.idle),dj(this.actions.move),dj(this.actions.run),dj(this.actions.jump)}dispatchStartEvent(e){void 0!==this.actions[e]&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach((e=>{e.play()})),this.actions[e].Animation.forEach((e=>{e.play(!1===this.initialAction)})),this.actions[e].Create.forEach((e=>{e.dispatchStart()})),this.actions[e].Audio.forEach((e=>{e.dispatchGameControl("start")})),this.actions[e].Particles.forEach((e=>{e.dispatchGameControl("start")}))))}dispatchStopEvent(e){void 0!==this.actions[e]&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})})),this.actions[e].Create.forEach((e=>{e.dispatchStop()})),this.actions[e].Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.actions[e].Particles.forEach((e=>{e.dispatchGameControl("stop")}))))}get colliderWorldPosition(){return Pj.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,n){if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let r=60*i,s=!1;if(this.usePhysics&&this.collisionEnabled){let e=Mj.set(0,(0===this.velocity.y?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/120,1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),t=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,e,this.object.rigidBody?.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(t){this.onObject=!0,this.groundNormal.set(t.normal2.x,t.normal2.y,t.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),0===t.collider.parent()?.bodyType()&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let e=t.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(t.rigidBody===e&&t.userData.isFollowingObj!==this.object.uuid){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Pj,Rj,Mj),this.groundVelocity.subVectors(Pj,t.prevT),this.object.getWorldPosition(Mj).add(this.collider.position).sub(Pj),this.groundYRotation=kj.setFromQuaternion(Rj).y-t.prevR.y,Nj.copy(Mj).applyAxisAngle(Uj,this.groundYRotation),this.groundVelocity.add(Nj.sub(Mj)).divideScalar(i);break}}else this.onObject=!1}if("walk"===this.moveMode&&this.collisionEnabled&&(1===this.movementState.jump&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*r),"fly"===this.moveMode&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,"+z"===this.forwardDir&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let e=this.navMeshPathDest.material;if("walk"===this.moveMode&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let t=Pj.subVectors(this.path[1],this.position),n=Mj.subVectors(this.path[1],this.path[0]);t.dot(n)<0?this.path.shift():(this.directionXZ.x=n.x,this.directionXZ.z=n.z),e.opacity=e.userData.opacity0}else e.opacity-=.05*e.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,("walk"===this.moveMode?this.velocityTarget.x+this.velocityTarget.z===0:0===this.velocityTarget.manhattanLength())?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),"walk"===this.moveMode&&(this.lerpFactorPos.y=1),!1===this.didHit&&0===this.pushedVelocity.manhattanLength()||!1===this.usePhysics?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**r),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**r),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**r)):this.velocity.copy(this.velocityTarget),("walk"===this.moveMode?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let a=Tj.copy(this.velocity);if("none"!==this.orientMode&&!1===this.isFirstPerson){let e=Mj.copy(a);e.y=0,a.set(0,a.y,e.length()*("+z"===this.forwardDir?1:-1))}if(this.directionXZ.manhattanLength()>0&&"none"!==this.orientMode&&!1===this.isFirstPerson)if("camera"===this.orientWith&&this.path.length<=1){let e=Pj;this.camera.getWorldDirection(e);let t=Nj.copy(Uj).multiplyScalar(e.dot(Uj));e.sub(t);let n=Mj.copy(this.directionXZ);n.x*=-1,this.rot.y=e.angleTo(n)*(e.cross(n).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*("+z"===this.forwardDir?1:-1);if(kj.setFromVector3(this.rot),"walk"===this.moveMode&&(kj.x=0),a.applyEuler(kj),s&&(Rj.setFromUnitVectors(Uj,this.groundNormal),a.applyQuaternion(Rj)),n){let e=kj.set(0,this.vrEulerYOffset*Gj,0);n.applyEuler(e),a.x+=n.x,a.z+=n.z,this.nonColliderPosOffset.elements[13]+=n.y*i}if(!0===this.usePhysics){let e=Mj;this.pushedVelocity.set(0,0,0);for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){let n=Nj.setFromMatrixPosition(t.matrixWorld).sub(t.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),r=t.rigidBody.collider(0).castCollider(n,this.object.rigidBody.collider(0),Pj.copy(a).divideScalar(this.pixelsPerMeter),i,!1);n.multiplyScalar(this.pixelsPerMeter);let s=sS.is(t)?t:t.object;if(null!==r&&this.lastHitObj!==s){let e;t instanceof lS&&(e=t);let n=this.sharedGameControlGlobals.entityToCollisionEvents[s.uuid];if(n)for(let t of n)"character"===t.data.target&&(t.dispatch(e),s.dispatchEvent(gW));this.lastHitObj=s}if(null!==r){this.pushedVelocity.copy(n),e.copy(r.normal1).applyQuaternion(t.quaternion);break}}if(0!==this.pushedVelocity.manhattanLength()){let t=e.dot(a);t<0&&a.addScaledVector(e,-t),a.add(this.pushedVelocity)}else a.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),"normal"===this.rotationMode&&(this.movementState.rotPosX||this.movementState.rotNegX)||"steer"===this.rotationMode&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||"walk"===this.moveMode)?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,"normal"===this.rotationMode&&(this.movementState.rotPosY||this.movementState.rotNegY)||"steer"===this.rotationMode&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),0===this.rotVelocityTarget.manhattanLength()?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**r):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**r),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,0===this.rotVelocityTarget.y&&0===this.directionXZ.manhattanLength()?this.rotationAccumWhenOrientWithCamera=0:(!1===this.cameraFollow||"Locked"===this.cameraYAxis)&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),!1===this.isFirstPerson&&"none"!==this.orientMode&&this.directionXZ.manhattanLength()>0){if("radial"===this.orientMode){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(Uj,this.euler.y-this.euler0.y);let e=Mj.copy(this.objectToCamXZ).normalize(),t=Nj.copy(a).multiplyScalar(i);t.y=0;let n=t.sub(Pj.copy(e).multiplyScalar(t.dot(e))).cross(e).y;this.euler.y-=Math.atan2(n,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,0!==this.rotVelocityTarget.y&&(!1===this.cameraFollow||"Locked"===this.cameraYAxis)&&(this.euler.y=this.rot.y);if(!0===this.cameraFollow&&("walk"===this.moveMode?"Limit"===this.cameraXAxis?this.euler.x=ui.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=ui.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):"Limit"===this.cameraXAxis&&(this.euler.x=ui.clamp(this.euler.x,-this.PI_2,this.PI_2))),"fly"===this.moveMode?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(kj.copy(t),kj.y=0):(kj.copy(this.euler),kj.y=0),this.nonColliderRotOffset.makeRotationFromEuler(kj)),t&&("walk"===this.moveMode?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*Gj),Lj.setFromAxisAngle(Bj,this.rot.x),Rj.setFromAxisAngle(Uj,this.rot.y),Rj.multiply(Lj),Lj.setFromAxisAngle(zj,this.rot.z),Rj.multiply(Lj),this.quaternion.copy(Rj),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let e=Mj.copy(a).multiplyScalar(i/this.pixelsPerMeter),t=null;this.didHit=!1;let n=new ji;for(let i=0;i<5;i++){let r=e.length(),s=Nj.copy(e).normalize();if(t=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(n),this.colliderWorldQuat,s,this.object.rigidBody?.collider(0).shape,r,!1,24,void 0,void 0,this.object.rigidBody),null===t){0===i&&0!==this.directionXZ.manhattanLength()&&(this.lastHitObj=null),n.add(e);break}{this.didHit=!0;let a=this.sharedGameControlGlobals.colliderToEntity.get(t.collider.handle);if(a!==this.lastHitObj&&0===i){this.lastHitObj=a;let e=this.sharedGameControlGlobals.entityToCollisionEvents[a?.uuid];if(e)for(let n of e)if("character"===n.data.target){let e,i=(this.sharedGameControlGlobals.rapierWorld?.getCollider(t.collider.handle))._parent;if(a.cloner)for(let t of a.cloner.children)if(t.rigidBody===i){e=t;break}n.dispatch(e),a.dispatchEvent(gW)}}let o=Sj.set(t.normal2.x,t.normal2.y,t.normal2.z).applyQuaternion(this.colliderWorldQuat),l=_j.copy(s).multiplyScalar(t.toi).dot(o),c=t.toi;if(0===c&&(this.position.y+=this.offset*this.pixelsPerMeter),l>this.offset&&(c=t.toi*(l-this.offset)/l,n.addScaledVector(s,c)),e.copy(s).multiplyScalar(r-c),Math.acos(-o.y)>this.slopeThresh){let i=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(n),r=Nj.copy(t.witness2).applyQuaternion(this.colliderWorldQuat);r.y=0;let s=i.add(r);s.y+=this.stepThresh;let a=this.sharedGameControlGlobals.rapierWorld.castShape(s,this.colliderWorldQuat,e,this.object.rigidBody?.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);null!==a&&0===a.toi&&(o.y=0,o.normalize())}e.addScaledVector(o,-e.dot(o))}}this.position.addScaledVector(n,this.pixelsPerMeter),this.object.rigidBody?.setTranslation(Pj.copy(this.position).divideScalar(this.pixelsPerMeter),!0),this.object.rigidBody?.setRotation(Lj.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let e=this.onObject?1:5,t=a.multiplyScalar(i/e);for(let n=0;n<e;n++)this.position.add(t),this.collisionAdjustment(i/e)}else this.position.addScaledVector(a,i);if("walk"===this.moveMode&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),!0===this.cameraFollow){this.updateFollowArms();let e=this.objectToTarget.add(this.position),t=this.targetToCamera.add(e);Ij.lookAt(t,e,Uj).setPosition(t),Ij.decompose(this.targetPos,this.targetQuat,Pj),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**r),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**r),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),"Limit"===this.cameraYAxis&&"cartesian"===this.orientMode&&(this.euler.y=ui.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=ui.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(Wj),(!(this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(void 0===this.camera||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate))||"fly"!==this.moveMode&&!0!==this.onObject&&!1!==this.collisionEnabled||!(null===this.navMeshPathDest||this.navMeshPathDest.material.opacity<-.04*this.navMeshPathDest?.material?.userData.opacity0))&&(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(Hj),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e,t=Lj.setFromAxisAngle(Uj,"Limit"===this.cameraYAxis&&"radial"!==this.orientMode?ui.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);("Locked"!==this.cameraYAxis||"radial"===this.orientMode)&&this.objectToTarget.applyQuaternion(t),e="Limit"===this.cameraXAxis?ui.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):ui.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let n=Pj.copy(this.cameraPolarAxis0);("Locked"!==this.cameraYAxis||"radial"===this.orientMode)&&n.applyQuaternion(t);let i=Rj.setFromAxisAngle(n,e);"Locked"!==this.cameraYAxis&&this.targetToCamera.applyQuaternion(t),"Locked"!==this.cameraXAxis&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(e){180*Uj.angleTo(e)/Math.PI<15||180*Uj.angleTo(e)/Math.PI>85?Lj.identity():Lj.setFromUnitVectors(Uj,e),this.groundTilt.slerp(Lj,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){let t=_j.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let n=Ij.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(Pj,Lj,Mj).compose(Pj,Lj,Fj);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach((e=>{if(e===this.object||e.isDescendantOf(this.object))return;Vj.makeEmpty(),e.updateMatrixWorldSVD();let i=e.matrixWorldRigid,r=Oj.copy(i).invert(),s=Dj.copy(Oj).multiply(n);jj.copy(this.collider.segment),jj.start.applyMatrix4(s),jj.end.applyMatrix4(s);let a=Sj.copy(this.position).applyMatrix4(r);Vj.expandByPoint(jj.start),Vj.expandByPoint(jj.end),Vj.min.addScalar(-this.collider.radius),Vj.max.addScalar(this.collider.radius),e.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder:e=>e.distanceToPoint(jj.end),intersectsBounds:e=>e.intersectsBox(Vj),intersectsTriangle:e=>{let n=Pj,r=Mj,s=e.closestPointToSegment(jj,n,r);if(s<this.collider.radius){let e=this.collider.radius-s,o=r.sub(n).normalize(),l=Nj.copy(a);l.addScaledVector(o,e);let c=l.applyMatrix4(i).sub(this.position);t.add(c),jj.start.addScaledVector(o,e),jj.end.addScaledVector(o,e)}}})})),Vj.makeEmpty(),jj.copy(this.collider.segment),jj.start.applyMatrix4(n),jj.end.applyMatrix4(n),Vj.expandByPoint(jj.start),Vj.expandByPoint(jj.end),Vj.min.addScalar(-this.collider.radius),Vj.max.addScalar(this.collider.radius),this.sharedGameControlGlobals.staticMeshBVH?.shapecast({traverseBoundsOrder:e=>e.distanceToPoint(jj.end),intersectsBounds:e=>e.intersectsBox(Vj),intersectsTriangle:e=>{let n=Pj,i=Mj,r=e.closestPointToSegment(jj,n,i);if(r<this.collider.radius){let e=this.collider.radius-r,s=i.sub(n).normalize();this.alignToGround&&this.groundTiltAdjustment(s),t.addScaledVector(s,e),jj.start.addScaledVector(s,e),jj.end.addScaledVector(s,e)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(i),this.position.add(t)}},Kj=qj;Kj.isLocked=!1;var Yj=Mt(Ot());function Qj(e){let t=e.elements,n=t[0]**2+t[1]**2+t[2]**2,i=t[4]**2+t[5]**2+t[6]**2,r=t[8]**2+t[9]**2+t[10]**2,s=t[0]**2+t[4]**2+t[8]**2,a=t[1]**2+t[5]**2+t[9]**2,o=t[2]**2+t[6]**2+t[10]**2,l=1e-8;return n<l||i<l||r<l||s<l||a<l||o<l}function Xj(e,t){let n=new gs;if(t&&Qj(t))return n.setAttribute("position",new ls([],3)),n.setIndex([]),n;if(!e.getAttribute("position"))return n.setAttribute("position",new ls([],3)),n.setIndex([]),n;let{positions:i,triIndices:r}=AP(e.getAttribute("position"),e.getIndex());return n.setAttribute("position",new ls(i,3)),n.setIndex(r),t&&n.applyMatrix4(t),n}var Zj=new vr,Jj=new vr,$j=[[0,0,0],[0,0,0],[0,0,0]];function eV(e){let t=e.elements;$j[0][0]=t[0],$j[0][1]=t[4],$j[0][2]=t[8],$j[1][0]=t[1],$j[1][1]=t[5],$j[1][2]=t[9],$j[2][0]=t[2],$j[2][1]=t[6],$j[2][2]=t[10];let{u:n,v:i}=(0,Yj.SVD)($j),r=Zj.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),s=Jj.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return r.multiply(s.transpose())}var tV=class extends wu{constructor(){super(),this.layers.enable(3),this.layers.enable(8),this.layers.enable(9)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.forEach((e=>{e.visible&&this.intersectObject(e,t,n)})),n}createRaycastLineHelper(){let e=new Yl({color:65280,linewidth:10}),t=new ji(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),n=new ji(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,r=(new ji).addVectors(t,n.multiplyScalar(i)),s=new gs;return s.setFromPoints([t,r]),new ec(s,e)}},nV=e=>e instanceof nL||e instanceof yB;function iV(e,t){return e.distance-t.distance}function rV(e,t,n){if(CS(t)&&t.visible){YD(t)&&t.raycast(e,n);for(let i of t.children)rV(e,i,n)}}function sV(e,t,n){if(!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])&&!n.some((t=>void 0!==lV(e,t))))return[];let i=[];return t.children.forEach((t=>rV(e,t,i))),i.sort(iV),i}function aV(e){let t=[];if(e.length){let n=e[0].object;CS(n)&&t.push(n);let i=n.parent;for(;i;)nV(i)&&t.push(i),i=i.parent}return t}function oV(e,t,n,i){let r=e.frame;if(r){let e=t[0]*r.width,s=(1-t[1])*r.height;for(let t of n){let n=t===r.uuid?r:r.find(t);if(n?.intersects(e,s))return i(n),!0}}return!1}function lV(e,t){if(YD(t)){if(t.visible){let n=[];return t.raycast(e,n),n.length?n[0]:void 0}}else if(nV(t))return cV(e,t)}function cV(e,t){if(CS(t)&&t.visible){if(YD(t)){let n=[];if(t.raycast(e,n),n.length)return n[0]}for(let n of t.children){let t=cV(e,n);if(t)return t}}}var hV=class{constructor(e,t,n,i,r,s,a,o){this.renderer=e,this.publish=t,this.scene=n,this.getCamera=i,this.sharedAssets=r,this.requestRender=s,this.isExport=a,this.frame=o,this.raycaster=new tV,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents="window"===t.mouseEventTarget,this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){let{pageX:t,pageY:n}=e.touches?.length>0?e.touches[0]:e;this.pointerWorld=function(e,t,n){return{x:(e-(n.left+window.scrollX))/n.width*2-1,y:-(t-(n.top+window.scrollY))/n.height*2+1}}(t,n,this._domRect),this.pointerScreen=function(e,t,n){return{x:(e-(n.left+window.scrollX))/n.width,y:1-(t-(n.top+window.scrollY))/n.height}}(t,n,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},uV=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},dV=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],pV=e=>dV.find((t=>{let[n,i]=t;return i===e}))?.[0],fV=e=>dV.find((t=>{let[n]=t;return n===e}))?.[1],mV=(e,t)=>{let n=pV(e);if(n){let e=new CustomEvent(n,{bubbles:!0});return Object.defineProperty(e,"target",{writable:!1,value:t}),e}},gV=class extends uV{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=e=>{if(!e.eventName||!e.target||"Scroll"===e.eventName)return;let t=this.splineEvents[pV(e.eventName)]?.[e.target.uuid];if(!t)return;"Scroll"===e.eventName&&void 0!==e.deltaY&&Object.assign(t,{deltaY:e.deltaY});let{domElement:n}=this.eventContext;n.dispatchEvent(t)}}connect(){let{page:e}=this.eventContext;e.traverseEntity((e=>{if(e.data?.events.length)for(let[t,n]of dV)if(e.data.events.some((e=>e.data.type===n&&!e.data.disabled))){this.objectsPerEvents.has(t)?this.objectsPerEvents.get(t)?.push(e):this.objectsPerEvents.set(t,[e]);let i={id:e.uuid,name:e.name},r=mV(n,i),s=this.splineEvents[t];s?s[e.uuid]=r:this.splineEvents[t]={[e.uuid]:r}}})),this.objectsPerEvents.forEach((e=>{e.forEach((e=>{e.addEventListener("beginEvent",this.onBeginEvent)}))}))}disconnect(){this.objectsPerEvents.forEach((e=>{e.forEach((e=>{e.removeEventListener("beginEvent",this.onBeginEvent)}))}))}},vV=class{constructor(e,t,n,i,r,s){if(this.id=e,this.data=t,this.object=n,this.entered=!1,("KeyDown"===t.type||"KeyUp"===t.type||"KeyPress"===t.type)&&!t.key)throw new Error("Missing property");this.actions=uj(t,t.actions,i,r,s,n)}disconnect(){dj(this.actions)}dispatchHeld(e){this.actions.Create.forEach((t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()}))}dispatch(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),"MousePress"===this.data.type||"KeyPress"===this.data.type?this.entered||(this.entered=!0,this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent())),this.actions.Create.forEach((e=>e.dispatchStart()))):(this.actions.Transition.some((e=>e.playing&&"Toggle"!==e.data.runMode))||this.actions.Transition.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.SwitchCamera.some((e=>e.playing&&"Toggle"!==e.data.runMode))||this.actions.SwitchCamera.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Animation.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()}))),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),!1===e&&this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Particles.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent())),this.actions.Create.forEach((e=>e.dispatchStop())))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent()))),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},yV=class extends uV{constructor(e,t,n){super(e),this.eventManager=t,this.useForRaycastProperty=n,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=e=>{if(!0===this.useForRaycastProperty&&null===this.sceneInterects){this.eventContext.updateRaycaster(e);let{raycaster:t,page:n}=this.eventContext,i=sV(t,n,[],!0);this.sceneInterects=i,i.length&&(this.eventContext.sharedAssets.raycastProperty={x:i[0].point.x,y:i[0].point.y,z:i[0].point.z,objX:i[0].object.matrixWorld.elements[12],objY:i[0].object.matrixWorld.elements[13],objZ:i[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=e=>{(e.target===this.eventContext.domElement||"SPLINE-VIEWER"===e.target.tagName)&&this.canvasMouseEvents.forEach((t=>{("MouseDown"===t.data.type||"MousePress"===t.data.type)&&(this.onCanvasRaycast(e),t.dispatch())}))},this.onCanvasMouseUp=e=>{(e.target===this.eventContext.domElement||"SPLINE-VIEWER"===e.target.tagName)&&this.canvasMouseEvents.forEach((t=>{"MouseUp"===t.data.type?(this.onCanvasRaycast(e),t.dispatch()):"MousePress"===t.data.type&&t.dispatchRelease()}))},this.onMouseDown=e=>{Wv.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseEvent("MouseDown"))},this.onMouseUp=e=>{Wv.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=e=>{Wv.length>1||(this.eventContext.updateRaycaster(e),this.handleMousePressEvent())},this.onMousePressRelease=e=>{Wv.length>1||(this.eventContext.updateRaycaster(e),this.handleMousePressEvent(!0))},this.onKeyDown=e=>{this.heldKeys[e.key]||(this.handleKeyEvent(e,"KeyDown"),this.handleKeyEventHeld(e,"KeyDown",!0)),this.heldKeys[e.key]=!0},this.onKeyUp=e=>{this.handleKeyEvent(e,"KeyUp"),this.handleKeyEventHeld(e,"KeyUp",!0)},this.onKeyPressDown=e=>{this.heldKeysPress[e.key]?this.handleKeyEventHeld(e,"KeyPress"):(this.handleKeyEvent(e,"KeyPress"),this.handleKeyEventHeld(e,"KeyPress",!0)),this.heldKeysPress[e.key]=!0},this.onKeyPressUp=e=>{this.handleKeyEvent(e,"KeyPress",!0)},this.releaseHeldKey=e=>{delete this.heldKeys[e.key]},this.releaseHeldKeyPress=e=>{delete this.heldKeysPress[e.key]},this._onUserEvent=e=>{let{eventName:t,target:n,reverse:i}=e;if(!t||!n)return;let r=fV(t);r&&("MouseDown"===r||"MouseUp"===r||"MousePress"===r?(n.dispatchEvent({type:"beginEvent",eventName:r}),this.eventsPerObjects[r]?.[n.uuid]?.forEach((e=>{e.dispatchUserEvent(i)}))):("KeyDown"===r||"KeyUp"===r||"KeyPress"===r)&&(n.dispatchEvent({type:"beginEvent",eventName:r}),this.eventsPerObjects[r]?.[n.uuid]?.forEach((e=>{e.dispatchUserEvent()}))))}}connect(){let{page:e,sharedAssets:t,domElement:n}=this.eventContext,i=(n,i)=>{if(!n.data?.events.length)return;let r=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let s of r){let r=this.eventsPerObjects[s];if(n.data.events.filter((e=>{let{data:t}=e;return t.type===s&&!0!==t.disabled})).forEach((i=>{let{id:s,data:a}=i;try{let i=new vV(s,a,n,e,t,this.eventManager);i.actions.Video.length&&(this.hasVideoAction=!0),"MouseDown"!==a.type&&"MouseUp"!==a.type&&"MousePress"!==a.type||"Canvas"!==a.mode&&"Window"!==a.mode?(r[n.uuid]?r[n.uuid].some((e=>e.id===i.id))||r[n.uuid].push(i):r[n.uuid]=[i],n instanceof GB&&n.traverseChildren((e=>{if(!e.visible)return!0;e instanceof DO&&2!==e.data.geometry.shapeBlendNode?.operation&&(r[e.uuid]?r[e.uuid].push(i):r[e.uuid]=[i])}))):this.canvasMouseEvents.push(i)}catch(o){}})),r[n.uuid]?.length&&(this.objectsPerTypes[s].push(n instanceof yk&&("MouseDown"===s||"MouseUp"===s||"MousePress"===s)?i:n),n instanceof GB)){let e=this.objectsPerTypes[s];n.traverseChildren((t=>{if(!t.visible)return!0;t instanceof DO&&-1===e.indexOf(t)&&e.push(t)}))}}};e.traverseEntity((e=>{(e instanceof CB||e instanceof pB)&&e.frame?.traverse((t=>{i(t,e)})),i(e)})),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),n.addEventListener("pointerdown",this.onCanvasMouseDown),n.addEventListener("pointerup",this.onCanvasMouseUp),(this.objectsPerTypes.MouseDown?.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),n.addEventListener("pointerdown",this.onMouseDown)),this.objectsPerTypes.MouseUp?.length&&(this.domEventsNeeded.add("pointerup"),n.addEventListener("pointerup",this.onMouseUp)),this.objectsPerTypes.MousePress?.length&&(this.domEventsNeeded.add("pointerdown"),n.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),n.addEventListener("pointerup",this.onMousePressRelease)),this.objectsPerTypes.KeyDown?.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),this.objectsPerTypes.KeyUp?.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),this.objectsPerTypes.KeyPress?.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach((e=>{let[t,n]=e;n.forEach((e=>{e.addEventListener("userEvent",this._onUserEvent)}))}))}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach((e=>{Object.values(e).forEach((e=>{e.forEach((e=>{e.disconnect()}))}))})),this.canvasMouseEvents.forEach((e=>{e.disconnect()})),Object.entries(this.objectsPerTypes).forEach((e=>{let[t,n]=e;n.forEach((e=>{e.removeEventListener("userEvent",this._onUserEvent)}))}))}handleMouseEvent(e){let{stopRaycast:t,raycaster:n,page:i,pointerScreen:r}=this.eventContext,s=this.objectsPerTypes[e],a=s.filter((e=>!(e instanceof yk)));if((s.length||this.useForRaycastProperty)&&(!i.uiCanvas||!oV(i,[r.x,r.y],Object.keys(this.eventsPerObjects[e]),(t=>{this.handleObjectMouseEventDispatch(t,e)})))){if(t||this.useForRaycastProperty){let r;if(null===this.sceneInterects?r=sV(n,i,a,this.useForRaycastProperty):(r=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&r.length&&(this.eventContext.sharedAssets.raycastProperty={x:r[0].point.x,y:r[0].point.y,z:r[0].point.z,objX:r[0].object.matrixWorld.elements[12],objY:r[0].object.matrixWorld.elements[13],objZ:r[0].object.matrixWorld.elements[14]}),t){let t=[r[0]?.uv?.x??0,r[0]?.uv?.y??0];aV(r).forEach((n=>{n instanceof CB&&oV(n,t,Object.keys(this.eventsPerObjects[e]),(t=>{this.handleObjectMouseEventDispatch(t,e)})),this.eventsPerObjects[e][n.uuid]&&this.handleObjectMouseEventDispatch(n,e)}))}}t||a.forEach((t=>{let i=lV(n,t);i&&(this.handleObjectMouseEventDispatch(t,e),t instanceof CB&&oV(t,[i?.uv?.x??0,i?.uv?.y??0],Object.keys(this.eventsPerObjects[e]),(t=>{this.handleObjectMouseEventDispatch(t,e)})))}))}}handleMousePressEvent(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="MousePress",n=this.objectsPerTypes[t],i=n.filter((e=>!(e instanceof yk))),r=[];if(n.length){if(!e){let{stopRaycast:e,raycaster:n,page:s,pointerScreen:a}=this.eventContext,o=!1;if(s.uiCanvas&&(o=oV(s,[a.x,a.y],Object.keys(this.eventsPerObjects[t]),(e=>{r.push(e)}))),e&&!o){let e=sV(n,s,i);r=aV(e),e.forEach((e=>{e.object instanceof CB&&oV(e.object,[e?.uv?.x??0,e?.uv?.y??0],Object.keys(this.eventsPerObjects[t]),(e=>{r.push(e)}))}))}else i.forEach((e=>{let i=lV(n,e);i&&(r.push(e),e instanceof CB&&oV(e,[i?.uv?.x??0,i?.uv?.y??0],Object.keys(this.eventsPerObjects[t]),(e=>{r.push(e)})))}))}this._prevObjects.length&&this._prevObjects.forEach((e=>{r.includes(e)||this.handleObjectMouseEventDispatchRelease(e,t)})),r.length&&r.forEach((e=>{this.handleObjectMouseEventDispatch(e,t)})),this._prevObjects=r}}handleObjectMouseEventDispatch(e,t){e.dispatchEvent({type:"beginEvent",eventName:t}),this.eventsPerObjects[t]?.[e.uuid]?.forEach((e=>{e.dispatch()}))}handleObjectMouseEventDispatchRelease(e,t){e.dispatchEvent({type:"beginEvent",eventName:t}),this.eventsPerObjects[t]?.[e.uuid]?.forEach((e=>{e.dispatchRelease()}))}handleKeyEvent(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.objectsPerTypes[t].forEach((i=>{let r=this.eventsPerObjects[t][i.uuid];r.some((t=>{let{data:n}=t;return"key"in n&&n.key===e.key}))&&i.dispatchEvent({type:"beginEvent",eventName:t}),r.forEach((t=>{"key"in t.data&&t.data.key===e.key&&(n?t.dispatchRelease():t.dispatch(!0))}))}))}handleKeyEventHeld(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.objectsPerTypes[t].forEach((i=>{this.eventsPerObjects[t][i.uuid].forEach((t=>{"key"in t.data&&t.data.key===e.key&&t.dispatchHeld(n)}))}))}},bV=new ji,wV=new ji,xV=class{constructor(e,t,n,i,r){this.actionsIn=uj(e,e.inActions,n,i,r,t),this.actionsOut=uj(e,e.outActions,n,i,r,t)}disconnect(){dj(this.actionsIn),dj(this.actionsOut)}},EV=class extends xV{constructor(e,t,n,i,r,s){super(t,n,i,r,s),this.id=e,this.data=t,this.object=n,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let i of this.objects)if(!i.visible)return;let e=bV.setFromMatrixPosition(this.objects[0].matrixWorld),t=wV.setFromMatrixPosition(this.objects[1].matrixWorld),n=e.distanceTo(t)<=this.distance?"in":"out";if(this.stage!==n){this.stage=n;let e="in"===n?this.actionsIn:this.actionsOut;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Link.forEach((e=>e.dispatch())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}};let{distance:a,fromObject:o,toObject:l}=t.condition;this.distance=a;for(let c of[o,l]){if(!c)throw new Error("Missing property");let e=i.find(c);if(!e)throw new Error("Missing property");this.objects.push(e)}}connect(){window.setTimeout((()=>{this.objects.forEach((e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})),this.onUpdateMatrixWorld()}),0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach((e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}))}},CV=class extends xV{constructor(e,t,n,i,r,s){super(t,n,i,r,s),this.id=e,this.data=t,this.object=n,this.onBegin=e=>{let{target:t,state:n}=e;this.toState!==n&&(this.actionsOut.Audio.forEach((e=>e.dispatchConditional())),this.actionsOut.Particles.forEach((e=>e.dispatchConditional())),this.actionsOut.Video.forEach((e=>e.dispatchConditional())),this.actionsOut.Link.forEach((e=>e.dispatch())),this.actionsOut.Create.forEach((e=>e.dispatch())),this.actionsOut.Destroy.forEach((e=>e.dispatch())),this.actionsOut.Reset.forEach((e=>e.dispatch())),this.actionsIn.Transition.forEach((e=>e.pause())),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach((e=>e.play())),this.actionsOut.Animation.forEach((e=>e.play())),this.actionsIn.SwitchCamera.forEach((e=>e.pause())),this.actionsOut.SwitchCamera.forEach((e=>e.play())),this.actionsOut.SceneTransition.forEach((e=>e.dispatch())),this.actionsOut.SetVariable.forEach((e=>e.checkConditions())),this.actionsOut.SetVariable.forEach((e=>e.dispatch())),this.actionsOut.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actionsOut.ClearLocalStorage.forEach((e=>e.dispatch())),this.actionsOut.UserAPI.forEach((e=>e.dispatch())))},this.onComplete=e=>{let{target:t,state:n}=e;this.toState===n&&(this.actionsIn.Audio.forEach((e=>e.dispatchConditional())),this.actionsIn.Particles.forEach((e=>e.dispatchConditional())),this.actionsIn.Video.forEach((e=>e.dispatchConditional())),this.actionsIn.Link.forEach((e=>e.dispatch())),this.actionsIn.Create.forEach((e=>e.dispatch())),this.actionsIn.Destroy.forEach((e=>e.dispatch())),this.actionsIn.Reset.forEach((e=>e.dispatch())),this.actionsOut.Transition.forEach((e=>e.pause())),this.actionsOut.Transition.forEach((e=>e.pause())),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach((e=>e.play())),this.actionsIn.Animation.forEach((e=>e.play())),this.actionsOut.SwitchCamera.forEach((e=>e.pause())),this.actionsIn.SwitchCamera.forEach((e=>e.play())),this.actionsIn.SceneTransition.forEach((e=>e.dispatch())),this.actionsIn.SetVariable.forEach((e=>e.checkConditions())),this.actionsIn.SetVariable.forEach((e=>e.dispatch())),this.actionsIn.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actionsOut.ClearLocalStorage.forEach((e=>e.dispatch())),this.actionsOut.UserAPI.forEach((e=>e.dispatch())))};let{condition:a}=t;if(!a.object)throw new Error("Missing property");let o=i.find(a.object)??i.scene.find2D(a.object);if(!o)throw new Error("Missing property");if(this.toObject=o,a.state&&!this.toObject.states?.[a.state])throw new Error("Missing property");this.toState=a.state}connect(){Sf(this.actionsOut).forEach((e=>{this.actionsOut[e]?.length&&this.toObject.addEventListener("beginState",this.onBegin)})),Sf(this.actionsIn).forEach((e=>{this.actionsIn[e]?.length&&this.toObject.addEventListener("completeState",this.onComplete)}))}disconnect(){super.disconnect(),Sf(this.actionsOut).forEach((e=>{this.actionsIn[e]?.length&&this.toObject.removeEventListener("beginState",this.onBegin)})),Sf(this.actionsIn).forEach((e=>{this.actionsIn[e]?.length&&this.toObject.removeEventListener("completeState",this.onComplete)}))}},AV=class extends uV{constructor(e,t){super(e),this.eventManager=t,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:e,sharedAssets:t}=this.eventContext;e.traverseEntity((n=>{if(n.data?.events.length)for(let{id:i,data:r}of n.data.events)if(!r.disabled&&"Conditional"===r.type)try{let s;"Comparison"===r.condition.type||("Distance"===r.condition.type?s=new EV(i,r,n,e,t,this.eventManager):"State"===r.condition.type&&(s=new CV(i,r,n,e,t,this.eventManager))),s&&(this.eventsPerConditions[r.condition.type].push(s),(s.actionsIn.Video.length||s.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch(Jw){}})),Object.values(this.eventsPerConditions).forEach((e=>e.forEach((e=>e.connect()))))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach((e=>e.forEach((e=>e.disconnect()))))}},SV=new ji,_V=new ji,TV=new ji,PV=new Ks,MV=new ji,NV=new ji,IV=new ji,OV=new Fi,DV=new Tr,LV=new vr,RV=new pi,kV=new ji,BV=new ji,UV=.2;function zV(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var FV=function(){let e=new vr;return(t,n,i)=>{let r=t.obj;e.copy(r.hiddenMatrix),null!==r.parent&&e.premultiply(r.parent.matrixWorld),e.invert(),r.position.copy(n),"global"===t.reference&&zV(r.position,t.limits),r.position.applyMatrix4(e),"parent"===t.reference?zV(r.position,t.limits):"local"===t.reference&&(OV.copy(t.quat0).invert(),r.position.sub(t.position0),r.position.applyQuaternion(OV),zV(r.position,t.limits),OV.invert(),r.position.applyQuaternion(OV),r.position.add(t.position0)),e.multiply(i??r.matrixWorld).decompose(MV,r.quaternion,NV),r.updateMatrix(),r.hasNonUniformScale&&(r.updateMatrixWorld(),r.updateMatrixWorldSVD()),r instanceof $P&&QD(r.parent)&&r.invalidateDownstreamBooleanData(!0)}}(),jV=class{constructor(e,t,n,i,r,s,a){this.object=e,this.id=t,this.data=n,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=0===this.data.resetSpeed?1:8/this.data.resetSpeed+1,this.snapDampingFactor=0===this.data.snapSpeed?1:8/this.data.snapSpeed+1,this.actionsDrag=uj(n,n.dragDropActions.drag,i,r,s,this.object),this.actionsDrop=uj(n,n.dragDropActions.drop,i,r,s,this.object);let o=[];this.data.objects.forEach((e=>{let t=i.find(e);!t||!1!==t.data.visible&&(o.push(t),a[t.uuid]&&a[t.uuid].forEach((e=>{let t=i.find(e);!t||!1!==t.data.visible&&o.push(t)})))})),this.data.dropDestinations.forEach((e=>{let t=i.find(e);!t||!1!==t.data.visible&&(this.dropDestIds.push(t.uuid),a[t.uuid]&&a[t.uuid].forEach((e=>{let t=i.find(e);!t||!1!==t.data.visible&&this.dropDestIds.push(t.uuid)})))})),this.dragItems=o.map((e=>("locked"===this.data.planeMode&&(e.userData.lockedPlane=!0),e.userData.worldPosition0=(new ji).setFromMatrixPosition(e.matrixWorld),{obj:e,fromPosition:(new ji).setFromMatrixPosition(e.matrixWorld),pointStart:new ji,pointEnd:new ji,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:(new ji).copy(e.position),quat0:(new Fi).copy(e.quaternion),snapped:!1,orientationMatrix:new vr,limits:this.data.limits,reference:this.data.referenceFrame})))}get activeDragItem(){return null!==this.activeIdx?this.dragItems[this.activeIdx]:null}dispose(){dj(this.actionsDrag),dj(this.actionsDrop),this.dragItems.forEach((e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()}))}},VV=class extends uV{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=e=>{if(Wv.length>1)return;this.eventContext.updateRaycaster(e);let{raycaster:t,page:n}=this.eventContext,i=n.raycastWithClones(t);if(this.lastDropDestination=null,0!==i.length){for(let e of this.events){let t=0;for(let{obj:n,pointEnd:r,pointStart:s}of e.dragItems){if(n===i[0].object||n===i[0].object.object||sS.is(n)&&n.isAncestorOf(i[0].object.uuid)){if(e.activeIdx=t,e.activeDragItem.reset=!1,e.activeDragItem.currentDampingFactor=e.data.dampingFactor,e.activeDragItem.snapped=!1,"hand"===e.data.cursor&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){e.activeDragItem.obj.rigidBody&&e.activeDragItem.obj.rigidBody.setBodyType(2,!0);let t=e.activeDragItem.obj;n.hasNonUniformScale&&n.updateMatrixWorldSVD(),(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(MV,OV,NV),DV.setFromQuaternion(OV),void 0===t.prevR?(t.prevR=DV.clone(),t.prevT=MV.clone()):(t.prevR.copy(DV),t.prevT.copy(MV)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(e.activeDragItem.obj)}return this.calcPlaneIntersectPos(n,s,e.data.plane,e.data.referenceFrame),r.copy(s),(this.eventManager.controlsManager.usePhysics&&"dynamic"===n.data.physics?.rigidBody||!1===e.data.drop||!1===e.data.resetOnSnapFail)&&e.activeDragItem.fromPosition.setFromMatrixPosition(e.activeDragItem.obj.matrixWorld),this.activeEvent=e,void(this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1))}t++}}this.activeEvent=null}else this.activeEvent=null},this.onPointerMove=e=>{if(Wv.length>1)return;this.eventContext.updateRaycaster(e);let{raycaster:t,page:n}=this.eventContext,i=n.raycastWithClones(t);if(0!==Wv.length){if(this.activeEvent&&this.activeEvent.activeDragItem){let e,t=this.activeEvent.activeDragItem;if(t.snapped=!1,this.activeEvent.data.drop&&(e=i.filter((e=>t.obj!==e.object&&!t.obj.isAncestorOf(e.object.uuid)&&!(e.object instanceof nL)&&("all"===this.activeEvent.data.dropOn||this.activeEvent.dropDestIds.some((t=>t===e.object.uuid||n.scene.find(t).isAncestorOf(e.object.uuid))))))[0]),e){let n=IV.copy(e.face.normal).applyMatrix3(RV.getNormalMatrix(e.object.matrixWorld));if("center"===this.activeEvent.data.snapTo)t.fromPosition.setFromMatrixPosition(e.object.matrixWorld);else if("surface"===this.activeEvent.data.snapTo){if(t.fromPosition.copy(e.point),"bbox"===this.activeEvent.data.snapSurfaceMode){MV.copy(n).applyMatrix3(RV.setFromMatrix4(t.obj.matrixWorld).transpose());let e=t.obj;MV.x>UV?NV.x=-e.recursiveBBox.min.x:MV.x<-UV&&(NV.x=-e.recursiveBBox.max.x),MV.y>UV?NV.y=-e.recursiveBBox.min.y:MV.y<-UV&&(NV.y=-e.recursiveBBox.max.y),MV.z>UV?NV.z=-e.recursiveBBox.min.z:MV.z<-UV&&(NV.z=-e.recursiveBBox.max.z),NV.applyMatrix3(RV.invert())}else NV.copy(n).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);t.fromPosition.add(NV)}this.activeEvent.data.autoOrient&&(MV.set(0,1,0).cross(n),MV.length()<1e-4&&MV.set(-1,0,0).cross(n),NV.crossVectors(IV,MV),t.orientationMatrix.makeBasis(MV,NV,n)),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart),t.currentDampingFactor=this.activeEvent.snapDampingFactor,t.snapped=!0,this.lastDropDestination!==e.object&&(this.lastDropDestination=e.object,this.activeEvent.actionsDrop.Transition.forEach((e=>{e.play()})),this.activeEvent.actionsDrop.Animation.forEach((e=>{e.play()})),this.activeEvent.actionsDrop.Audio.forEach((e=>{e.dispatchGameControl("start")})),this.activeEvent.actionsDrop.Particles.forEach((e=>{e.dispatchGameControl("start")})),this.activeEvent.actionsDrop.Create.forEach((e=>{e.dispatchThrottled()})))}else t.orientationMatrix.makeRotationFromQuaternion(t.quat0),this.lastDropDestination=null,t.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(t.obj,t.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})})),this.activeEvent.actionsDrop.Animation.forEach((e=>{e.stop()})),this.activeEvent.actionsDrop.Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrop.Particles.forEach((e=>{e.dispatchGameControl("stop")}));this.activeEvent.actionsDrag.Create.forEach((e=>{e.dispatchThrottled()})),this.activeEvent.actionsDrag.SetVariable.forEach((e=>e.checkConditions())),this.activeEvent.actionsDrag.SetVariable.forEach((e=>e.dispatch())),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach((e=>e.dispatch())),this.activeEvent.actionsDrag.ClearLocalStorage.forEach((e=>e.dispatch())),this.activeEvent.actionsDrag.UserAPI.forEach((e=>e.dispatch())),!1===this.activeEvent.wasDragEventTriggered&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach((e=>{e.play()})),this.activeEvent.actionsDrag.Animation.forEach((e=>{e.play()})),this.activeEvent.actionsDrag.Audio.forEach((e=>{e.dispatchGameControl("start")})),this.activeEvent.actionsDrag.Particles.forEach((e=>{e.dispatchGameControl("start")}))),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout((()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrag.Particles.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrag.Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})})),this.activeEvent.actionsDrag.Animation.forEach((e=>{e.stop()})))}),500),this.updateDragItem(t),t.obj.dispatchEvent({type:"requestRender"})}}else{let e=!1;for(let t of this.events){for(let{obj:n}of t.dragItems)if(n===i[0]?.object||n===i[0]?.object?.object||sS.is(n)&&n.isAncestorOf(i[0]?.object.uuid)){switch(e=!0,t.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move")}break}if(e)break}e||this.setCursor("default")}},this.onPointerUp=e=>{if(this.activeEvent&&this.activeEvent.activeDragItem){"hand"===this.activeEvent.data.cursor&&this.setCursor("grab");let e="dynamic"===this.activeEvent.activeDragItem.obj.data.physics?.rigidBody;!1===this.activeEvent.activeDragItem.snapped&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(!1===this.eventManager.controlsManager.usePhysics||!e)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&e&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),!0===this.activeEvent.wasDragEventTriggered&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach((e=>{e.stop(),null!==e.object.currentState&&e.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})})),this.activeEvent.actionsDrag.Animation.forEach((e=>{e.stop()})),this.activeEvent.actionsDrag.Audio.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrag.Particles.forEach((e=>{e.dispatchGameControl("stop")})),this.activeEvent.actionsDrop.SetVariable.forEach((e=>e.checkConditions())),this.activeEvent.actionsDrop.SetVariable.forEach((e=>e.dispatch())),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach((e=>e.dispatch())),this.activeEvent.actionsDrop.ClearLocalStorage.forEach((e=>e.dispatch())),this.activeEvent.actionsDrop.UserAPI.forEach((e=>e.dispatch()))),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let e={};if(this.eventContext.page.traverseEntity((t=>{t.component&&(e[t.component.uuid]?e[t.component.uuid].push(t.uuid):e[t.component.uuid]=[t.uuid])})),this.eventContext.page.traverseEntity((t=>{t.data?.events.filter((e=>"DragDrop"===e.data.type&&!e.data.disabled)).forEach((n=>{this.events.push(new jV(t,n.id,n.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,e))}))})),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach((e=>e.dispose()))}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,n,i){let{getCamera:r,raycaster:s}=this.eventContext;r().getWorldDirection(_V),_V.negate();let a=OV.identity();switch("parent"===i?LV.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(MV,a,NV):"local"===i&&e.matrixWorld.decompose(MV,a,NV),n){case"x":MV.set(1,0,0).applyQuaternion(a),kV.copy(_V).cross(MV),BV.copy(MV).cross(kV);break;case"y":MV.set(0,1,0).applyQuaternion(a),kV.copy(_V).cross(MV),BV.copy(MV).cross(kV);break;case"z":MV.set(0,0,1).applyQuaternion(a),kV.copy(_V).cross(MV),BV.copy(MV).cross(kV);break;case"xy":BV.set(0,0,1).applyQuaternion(a);break;case"yz":BV.set(1,0,0).applyQuaternion(a);break;case"xz":BV.set(0,1,0).applyQuaternion(a);break;case"adaptive":_V.angleTo(NV.set(0,1,0))>Math.PI/6?(MV.crossVectors(NV.set(0,1,0),_V),BV.crossVectors(MV,NV)):BV.set(0,1,0);break;default:BV.copy(_V)}TV.setFromMatrixPosition(e.matrixWorld);let o=e.userData.lockedPlane?e.userData.worldPosition0:TV;if(PV.setFromNormalAndCoplanarPoint(BV,o),s.ray.intersectPlane(PV,t)&&("x"===n||"y"===n||"z"===n)){let e=NV.subVectors(t,o).dot(MV);t.copy(o).addScaledVector(MV,e)}}updateDragItem(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];TV.setFromMatrixPosition(e.obj.matrixWorld),"current"===e.reset?SV.subVectors(e.fromPosition,TV).divideScalar(e.currentDampingFactor):"original"===e.reset?(SV.subVectors(e.obj.userData.worldPosition0,TV).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):SV.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(TV).divideScalar(e.currentDampingFactor),e.paused=!(e.currentDampingFactor>1)||SV.length()<.01,(this.activeEvent&&1===this.activeEvent.data.dampingFactor||t)&&FV(e,SV.add(TV),this.activeEvent?.data.drop&&this.activeEvent?.data.autoOrient?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},HV=new ji,WV=new ji,GV=new ji,qV=new ji,KV=new Ks,YV={type:"requestRender"},QV=function(){let e=new ji,t=new ji;return(n,i,r)=>r>0?(e.subVectors(n,i),e.length()<=r?n:t.copy(i).add(e.normalize().multiplyScalar(r))):i}(),XV=function(){let e=new vr;return(t,n)=>{t.position.copy(n),null!==t.parent&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof $P&&QD(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),ZV=class{constructor(e,t,n,i,r,s){this.data=e,this.id=t,this.object=n,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new ji,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...Rw.defaultData,...e,...void 0===e.resetOnPointerLeave&&{resetOnPointerLeave:!1}},void 0===e.target||"cursor"===e.target||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=uj(e,e.actions,i,r,s,n)}},JV=class extends uV{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=e=>{if(!(Wv.length>1)){this.eventContext.updateRaycaster(e);for(let e of this.events)void 0===e.target&&this.updateSingleEvent(e)}},this.onMouseEnter=e=>{for(let t of this.events)void 0===t.target&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)void 0===t.target&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity((t=>{let n=t.data?.events.find((e=>"Follow"===e.data.type&&!e.data.disabled));n&&(!e.data.globalPhysics.usePhysics||"dynamic"!==t.dataPatched.physics?.rigidBody)&&this.events.push(new ZV(n.data,n.id,t,e,this.eventContext.sharedAssets,this.eventManager))})),!this.events.length)return;let{domElement:t,eventElement:n}=this.eventContext;this.domEventsNeeded.clear(),Uv&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),n.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(void 0!==i.target){let e=i.target,t=this.onTargetChange(i);this.pairOfEventListeners.push([e,t]),e.addEventListener("requestRender",t)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),Uv&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[n,i]of this.pairOfEventListeners)n.removeEventListener("requestRender",i);for(let n of this.events)n.paused=!0,n.isReset=!1,dj(n.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.events.forEach((e=>{e.actions.Create.forEach((e=>{e.dispatchThrottled()}))}));let{plane:n,limitDistance:i,limitDistanceEnabled:r}=e.data;if(e.object.getWorldPosition(GV),e.isReset)qV.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(qV);else{let{getCamera:e,raycaster:t}=this.eventContext;if("custom"===n?(e().getWorldDirection(WV),WV.negate(),HV.copy(WV)):"xy"===n?HV.set(0,0,1):"xz"===n?HV.set(0,1,0):"yz"===n&&HV.set(1,0,0),KV.setFromNormalAndCoplanarPoint(HV,GV),!t.ray.intersectPlane(KV,qV))return}if(!e.isReset)if(qV.distanceTo(e.worldPosition0)>i&&r&&e.target){if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&null!==e.timeoutId&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,!e.data.resetAfterDistanceLimit)return;qV.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor}else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout((()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)}),1e3*e.data.snapDelay)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),!1===e.delayFinished)return;!1===e.data.enabledTranslation[0]&&(qV.x=GV.x),!1===e.data.enabledTranslation[1]&&(qV.y=GV.y),!1===e.data.enabledTranslation[2]&&(qV.z=GV.z);let s=QV(GV,qV,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let n=HV.subVectors(s,GV).divideScalar(e.currentDampingFactor);GV.add(n),t&&XV(e.object,GV),e.paused=n.length()<.01}else XV(e.object,s),e.paused=!0;e.object?.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(YV)}},$V=new ji,eH=new ji,tH=new vr,nH=new Fi,iH=new Fi,rH=new ji,sH=new ji,aH=new ji,oH=new ji,lH=new Ks,cH={type:"requestRender"},hH={type:"changeRotation"},uH=function(){let e=new vr;return function(t,n){null!==t.parent?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),n.premultiply(eV(e).invert()),t.rotation.setFromRotationMatrix(n),t.updateMatrix(),t instanceof $P&&QD(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),dH=class{constructor(e,t,n,i){this.id=t,this.object=n,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new Fi,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...kw.defaultData,...e,...void 0===e.resetOnPointerLeave&&{resetOnPointerLeave:!1}},void 0===e.target||"cursor"===e.target||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},pH=class extends uV{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=e=>{if(!(Wv.length>1)){this._lastMouseEvent=e,this.eventContext.updateRaycaster(e);for(let e of this.events)void 0===e.target&&this.updateSingleEvent(e)}},this.onMouseEnter=e=>{for(let t of this.events)void 0===t.target&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)void 0===t.target&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onScroll=e=>{if(this._lastMouseEvent){let e=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(e)}},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)},this.createUserEventListener=e=>t=>{let{eventName:n,target:i}=t;if(!n||!i)return;let r=fV(n);r&&"LookAt"===r&&this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity((t=>{let n=t.data?.events.find((e=>"LookAt"===e.data.type&&!e.data.disabled));n&&(!e.data.globalPhysics.usePhysics||"dynamic"!==t.dataPatched.physics?.rigidBody)&&this.events.push(new dH(n.data,n.id,t,e))})),!this.events.length)return;let{domElement:t,eventElement:n}=this.eventContext;this.domEventsNeeded.clear(),Uv&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),n.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?n.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(void 0!==i.target){let e=this.onTargetChange(i),t=i.target;this.pairOfEventListeners.push([t,e]),t.addEventListener("requestRender",e)}let e=this.createUserEventListener(i),t=i.object;this.pairOfUserEventListeners.push([t,e]),t.addEventListener("userEvent",e)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),Uv&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[n,i]of this.pairOfEventListeners)n.removeEventListener("requestRender",i);for(let[n,i]of this.pairOfUserEventListeners)n.removeEventListener("userEvent",i);for(let n of this.events)n.paused=!0,n.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){let{tilt:t,axis:n,distance:i,plane:r,limitDistance:s,enabledRotation:a,limitDistanceEnabled:o}=e.data,{getCamera:l,raycaster:c}=this.eventContext,{object:h,target:u}=e;if(h.getWorldPosition(rH),!e.isReset)if(e.target)e.target.getWorldPosition(sH);else{if("custom"===r?(l().getWorldDirection(eH),eH.negate(),lH.setFromNormalAndCoplanarPoint(eH,rH)):("xy"===r?$V.set(0,0,1):"xz"===r?$V.set(0,1,0):"yz"===r&&$V.set(1,0,0),lH.setFromNormalAndCoplanarPoint($V,rH)),!c.ray.intersectPlane(lH,sH))return;i>0&&("custom"===r||void 0===r)&&sH.addScaledVector(eH,i)}if(e.isReset||(u?"target"===t?aH.copy(u.up).applyMatrix4(tH.extractRotation(u.matrixWorld)).normalize():a.some((e=>!1===e))?("x"===n?(oH.set(0,0,1),!1===a[2]&&oH.set(0,1,0)):"y"===n?(oH.set(1,0,0),!1===a[0]&&oH.set(0,0,1)):(oH.set(0,1,0),!1===a[1]&&oH.set(1,0,0)),aH.copy(oH).applyQuaternion(e.worldQuaternion0).normalize()):aH.set(0,1,0):"custom"===r?aH.set(0,1,0):aH.copy($V)),e.isReset)iH.copy(e.worldQuaternion0);else if(rH.distanceTo(sH)>s&&o&&u){if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&null!==e.timeoutId&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,!e.data.resetAfterDistanceLimit)return;iH.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor}else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout((()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)}),1e3*e.data.snapDelay)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),!1===e.delayFinished)return;(function(e,t,n,i,r,s){let a=e.elements;gH.subVectors(t,n),0===gH.lengthSq()&&(gH.z=1),gH.normalize(),mH.crossVectors(i,gH),0===mH.lengthSq()&&(1===Math.abs(i.z)?gH.x+=1e-4:gH.z+=1e-4,gH.normalize(),mH.crossVectors(i,gH)),mH.normalize(),fH.crossVectors(gH,mH),"x"===r?1===s.z?[mH,fH,gH]=[gH,mH,fH]:(mH.negate(),[mH,gH]=[gH,mH]):"y"===r?1===s.x?[mH,fH,gH]=[fH,gH,mH]:(mH.negate(),[fH,gH]=[gH,fH]):1===s.x&&(mH.negate(),[mH,fH]=[fH,mH]),a[0]=mH.x,a[4]=fH.x,a[8]=gH.x,a[1]=mH.y,a[5]=fH.y,a[9]=gH.y,a[2]=mH.z,a[6]=fH.z,a[10]=gH.z})(tH,sH,rH,aH,n,oH),iH.setFromRotationMatrix(tH),nH.setFromUnitVectors(oH.applyQuaternion(iH),aH),a.some((e=>!1===e))&&"target"!==t&&iH.premultiply(nH).normalize()}e.currentDampingFactor>1?(h.updateWorldMatrix(!0,!1),nH.setFromRotationMatrix(eV(h.matrixWorld)),nH.slerp(iH,1/e.currentDampingFactor),uH(h,tH.makeRotationFromQuaternion(nH)),e.paused=8*(1-nH.dot(iH))<1e-6):(uH(h,tH.makeRotationFromQuaternion(iH)),e.paused=!0),e.object?.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),h.dispatchEvent(cH),h.dispatchEvent(hH)}},fH=new ji,mH=new ji,gH=new ji;var vH=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.entered=!1,this.actions=uj(t,t.actions,i,r,s,n)}disconnect(){dj(this.actions)}dispatchEnter(){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.entered||(this.entered=!0,this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.play())),this.actions.Create.forEach((e=>e.dispatchStart())),this.actions.Particles.forEach((e=>e.dispatchBasic())),this.actions.Destroy.forEach((e=>e.dispatch())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent())),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())))}dispatchLeave(){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.entered&&(this.entered=!1,this.actions.Create.forEach((e=>e.dispatchStop())),this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Particles.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent())))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Particles.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.Create.forEach((e=>e.dispatch())),this.actions.Particles.forEach((e=>e.dispatchBasic())),this.actions.Destroy.forEach((e=>e.dispatch())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent()))),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},yH=class extends uV{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=e=>{Wv.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseHoverEvent())},this.onMouseUp=e=>{Wv.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=e=>{Wv.length>1||(this.eventContext.updateRaycaster(e),this.handleMouseHoverEvent())},this.onUserEvent=e=>{let{eventName:t,target:n,reverse:i}=e;if(!t||!n)return;let r=fV(t);r&&"MouseHover"===r&&(n.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),this.eventsPerObjects[n.uuid]?.forEach((e=>e.dispatchUserEvent(i))))}}connect(){let{page:e,sharedAssets:t}=this.eventContext,n=(n,i)=>{if(n.visible&&n.data?.events.length){for(let{id:i,data:s}of n.data.events)if(!s.disabled&&"MouseHover"===s.type)try{let r=new vH(i,s,n,e,t,this.eventManager);this.eventsPerObjects[n.uuid]?this.eventsPerObjects[n.uuid].push(r):this.eventsPerObjects[n.uuid]=[r]}catch(r){}this.eventsPerObjects[n.uuid]?.length&&this.objects.push(n instanceof yk?i:n)}};if(e.traverseEntity((e=>{(e instanceof CB||e instanceof pB)&&e.frame?.traverse((t=>{n(t,e)})),n(e)})),!this.objects.length)return;let{domElement:i}=this.eventContext;this.domEventsNeeded.clear(),Uv&&(this.domEventsNeeded.add("pointerdown"),i.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),i.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.objects.forEach((e=>{e.addEventListener("userEvent",this.onUserEvent)}))}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),Uv&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach((e=>{e.forEach((e=>{e.disconnect()}))})),this.objects.forEach((e=>{e.removeEventListener("userEvent",this.onUserEvent)}))}handleMouseHoverEvent(){let e=[];if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])){let{stopRaycast:t,raycaster:n,page:i,pointerScreen:r}=this.eventContext,s=!1;if(i.uiCanvas&&(s=oV(i,[r.x,r.y],Object.keys(this.eventsPerObjects),(t=>{e.push(t)}))),t&&!s){let t=sV(n,i,this.objects);e=aV(t),t.forEach((t=>{t.object instanceof CB&&oV(t.object,[t?.uv?.x??0,t?.uv?.y??0],Object.keys(this.eventsPerObjects),(t=>{e.push(t)}))}))}else this.objects.forEach((t=>{let i=lV(n,t);i&&(e.push(t),t instanceof CB&&oV(t,[i?.uv?.x??0,i?.uv?.y??0],Object.keys(this.eventsPerObjects),(t=>{e.push(t)})))}))}this._prevObjects.length&&this._prevObjects.forEach((t=>{e.includes(t)||(t.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),this.eventsPerObjects[t.uuid]?.forEach((e=>e.dispatchLeave())))})),e.length&&e.forEach((e=>{e.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),this.eventsPerObjects[e.uuid]?.forEach((e=>e.dispatchEnter()))})),this._prevObjects=e}},bH=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.scrollCounter=0,this.actions=uj(t,t.actions,i,r,s,n)}connect(){this.scrollCounter=0}disconnect(){dj(this.actions)}dispatch(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}));let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let n=this.scrollCounter/this.data.steps;this.actions.Transition.forEach((e=>e.seek(n))),this.actions.Animation.forEach((e=>e.seek(t))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>{e.playFromCurrent()})),this.actions.Animation.forEach((e=>{e.playFromCurrent()}))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},wH=class{constructor(e,t,n,i,r,s,a){this.id=e,this.data=t,this.object=n,this.domElement=s,this.eventManager=a,this.scrollStart=0,this.scrollEnd=0,this.actions=uj(t,t.actions,i,r,a,n)}getStickyParentElement(){let e=this.domElement;for(;e;){if("sticky"===window.getComputedStyle(e).position)return e;e=e.parentElement}return null}computeScrollBounds(){let e=this.getStickyParentElement(),t=e?.parentElement,n=this.domElement.getBoundingClientRect(),i={top:n.top,bottom:n.bottom,left:n.left,right:n.right,width:n.width,height:n.height};if(t){let r=t.getBoundingClientRect(),s=window.getComputedStyle(e),a=parseFloat(s.marginTop)+parseFloat(s.marginBottom),o=parseFloat(s.top),l=parseFloat(s.bottom),c=r.height-a;if(isNaN(o)){if(!isNaN(l)){let e=document.body.clientHeight??window.innerHeight,t=window.innerWidth-(document.documentElement.clientWidth??window.innerWidth);n.bottom===e-l?(i.top+=r.top-n.height+l+t,i.bottom+=r.top-n.height+l+t):n.bottom<e-l&&(i.top-=c-n.height,i.bottom-=c-n.height)}}else n.top===o?(i.top+=r.top-o,i.bottom+=r.top-o):n.top<0&&(i.top-=c-n.height,i.bottom-=c-n.height)}let r=document.body,s=document.documentElement,a=window.pageYOffset||s.scrollTop||r.scrollTop,o=s.clientTop||r.clientTop||0,l=Math.round(i.top+a-o);if("enter"===this.data.startFrom){let e=window.innerHeight,t=i.height,n=this.data.enterAnchor,r="top"===n?e:"bottom"===n?e-t:e-.5*t;this.scrollStart=l-r}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=i,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){dj(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return void 0===this.box||0===this.box.width&&0===this.box.height&&0===this.box.top&&0===this.box.bottom}computeScroll(e){let{x:t,y:n}=e;this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}));let i=this.scrollEnd-this.scrollStart,r=Math.min(1,Math.max(0,(n-this.scrollStart)/i));this.actions.Transition.forEach((e=>e.seek(r))),this.actions.Animation.forEach((e=>e.seek(r))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>{e.playFromCurrent()})),this.actions.Animation.forEach((e=>{e.playFromCurrent()}))),this.actions.Create.forEach((e=>e.dispatchThrottled())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}},xH=class extends uV{constructor(e,t){super(e),this.managers=t,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach((e=>{let[t,n]=e;n.forEach((e=>e.handleResize()))}))},this.onScroll=e=>{if(!this.isInview)return;let t={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach((e=>{let[n,i]=e;n.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:t}),i.forEach((e=>e.dispatch(t)))}))},this.onWheel=e=>{!this.isInview||e.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach((t=>{let[n,i]=t;n.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:e.deltaY}),i.forEach((t=>t.dispatch(e.deltaY)))}))},this.onUserEvent=e=>{let{eventName:t,target:n,reverse:i}=e;if(!t||!n)return;let r=fV(t);r&&"Scroll"===r&&(n.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),this.wheelEventsPerObject.get(n)?.forEach((e=>{e.dispatchUserEvent(i)})))}}connect(){let{page:e,sharedAssets:t,domElement:n,isExport:i}=this.eventContext,r=r=>{if(r.data?.events.length)for(let{id:s,data:a}of r.data.events)if(!a.disabled&&"Scroll"===a.type)if("load"!==a.trigger&&i){let i=new wH(s,a,r,e,t,n,this.managers);this.scrollEventsPerObject.has(r)?this.scrollEventsPerObject.get(r)?.push(i):this.scrollEventsPerObject.set(r,[i])}else{let n=new bH(s,a,r,e,t,this.managers);this.wheelEventsPerObject.has(r)?this.wheelEventsPerObject.get(r)?.push(n):this.wheelEventsPerObject.set(r,[n])}};e.traverseEntity((e=>{(e instanceof CB||e instanceof pB)&&e.frame?.traverse((e=>{r(e)})),r(e)})),this.intersectionObserver=new IntersectionObserver((e=>{let t=e[0];t&&(this.isInview=t.isIntersecting)}),{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach((e=>{let[t,n]=e;n.forEach((e=>e.connect())),t.addEventListener("userEvent",this.onUserEvent)})),[...this.scrollEventsPerObject.entries()].forEach((e=>{let[t,n]=e;n.forEach((e=>e.connect())),t.addEventListener("userEvent",this.onUserEvent)})),[...this.wheelEventsPerObject.values()].some((e=>e.length))&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some((e=>e.length))&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach((e=>{let[t,n]=e;n.forEach((e=>e.disconnect())),t.removeEventListener("userEvent",this.onUserEvent)})),[...this.scrollEventsPerObject.entries()].forEach((e=>{let[t,n]=e;n.forEach((e=>e.disconnect())),t.removeEventListener("userEvent",this.onUserEvent)}))}},EH=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.actions=uj(t,t.actions,i,r,s,n)}disconnect(){dj(this.actions)}dispatch(){this.actions.Transition.forEach((e=>{e.play()})),this.actions.Animation.forEach((e=>{e.play()})),this.actions.SwitchCamera.forEach((e=>{e.play()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())),this.actions.Create.forEach((e=>{e.dispatchFromStart()})),this.actions.Destroy.forEach((e=>{e.dispatchFromStart()}))}dispatchAfter(e){this.actions.Audio.forEach((t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof nz?t.interaction.audioPlayer.play():t.interaction instanceof iz&&t.interaction.dispatch())})),this.actions.Video.forEach((t=>{let n=t.interaction.data.triggerAfter??"autoplay";n===e&&(t.interaction instanceof mj?t.interaction.play("autoplay"===n):t.interaction instanceof gj&&t.interaction.dispatch())})),this.actions.Particles.forEach((t=>{(t.data.triggerAfter??"any")===e&&t.dispatchBasic()}))}dispatchUserEvent(e){this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),e?(this.actions.Transition.forEach((e=>e.reverseFromCurrent())),this.actions.Animation.forEach((e=>e.reverseFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.reverseFromCurrent()))):(this.actions.Transition.forEach((e=>e.playFromCurrent())),this.actions.Animation.forEach((e=>e.playFromCurrent())),this.actions.SwitchCamera.forEach((e=>e.playFromCurrent()))),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.Reset.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch()})),this.actions.Audio.forEach((e=>{e.interaction instanceof nz?e.interaction.audioPlayer.play():e.interaction instanceof iz&&e.interaction.dispatch()})),this.actions.Video.forEach((e=>{e.interaction instanceof mj?e.interaction.play():e.interaction instanceof gj&&e.interaction.dispatch()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()}))}},CH=class extends uV{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>{e.dispatchAfter("mouseDown")}))}))},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>{e.dispatchAfter("keyDown")}))}))},this.onAny=()=>{let{domElement:e,isExport:t}=this.eventContext,n=t?document:e;n.removeEventListener("pointerdown",this.onAny),n.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>{e.dispatchAfter("any")}))}))},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>{e.actions.Audio.forEach((e=>{e.interaction instanceof nz&&e.interaction.audioPlayer.play()})),e.actions.Video.forEach((e=>{let t=e.interaction.data.triggerAfter??"autoplay";e.interaction instanceof mj&&e.interaction.play("autoplay"===t)})),e.actions.Particles.forEach((e=>{e.dispatchBasic()}))}))}))},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>{e.dispatchAfter("autoplay")}))}))},this.onUserEvent=e=>{let{eventName:t,target:n,reverse:i}=e;if(!t||!n)return;let r=fV(t);r&&"Start"===r&&(n instanceof yk||n.dispatchEvent({type:"beginEvent",eventName:"Start"}),this.eventsPerObject.get(n)?.forEach((e=>{e.dispatchUserEvent(i)})),this.eventsAfterPerObject.get(n)?.forEach((e=>{e.dispatchUserEvent(i)})))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,n=n=>{if(n.data?.events.length)for(let{id:i,data:r}of n.data.events){if(r.disabled||"Start"!==r.type)continue;let s=new EH(i,r,n,t,e,this.eventManager);(s.actions.Transition.length||s.actions.Animation.length||s.actions.SwitchCamera.length||s.actions.Create.length||s.actions.Destroy.length||s.actions.SceneTransition.length||s.actions.Reset.length||s.actions.SetVariable.length||s.actions.DynamicVariablePlay.length||s.actions.ClearLocalStorage.length||s.actions.UserAPI.length)&&(this.eventsPerObject.has(n)?this.eventsPerObject.get(n)?.push(s):this.eventsPerObject.set(n,[s])),s.actions.Audio.length&&(this.eventsAfterPerObject.has(n)?this.eventsAfterPerObject.get(n)?.push(s):this.eventsAfterPerObject.set(n,[s])),s.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(n)?this.eventsAfterPerObject.get(n)?.push(s):this.eventsAfterPerObject.set(n,[s])),s.actions.Particles.length&&(this.eventsAfterPerObject.has(n)?this.eventsAfterPerObject.get(n)?.push(s):this.eventsAfterPerObject.set(n,[s]))}};if(t.traverseEntity((e=>{(e instanceof CB||e instanceof pB)&&e.frame?.traverse((e=>{n(e)})),n(e)})),[...this.eventsAfterPerObject.values()].some((e=>e.length))){if(0===this.eventManager.activateCount){let{domElement:e,isExport:t}=this.eventContext,n=t?document:e;n.addEventListener("pointerdown",this.onMouseDown,{once:!0}),n.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),n.addEventListener("pointerdown",this.onAny),n.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.addEventListener("userEvent",this.onUserEvent)}))}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach((e=>{let[t,n]=e;t.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach((e=>e.dispatch())),t.addEventListener("userEvent",this.onUserEvent)}))}disconnect(){if([...this.eventsAfterPerObject.values()].some((e=>e.length))){let{domElement:e,isExport:t}=this.eventContext,n=t?document:e;n.removeEventListener("pointerdown",this.onMouseDown),n.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),n.removeEventListener("pointerdown",this.onAny),n.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach((e=>{let[t,n]=e;t.removeEventListener("userEvent",this.onUserEvent),n.forEach((e=>e.disconnect()))}))}[...this.eventsPerObject.entries()].forEach((e=>{let[t,n]=e;t.removeEventListener("userEvent",this.onUserEvent),n.forEach((e=>e.disconnect()))})),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},AH=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.initialDisabled=!1,this.actions=uj(t,t.actions,i,r,s,n),this.target=t.target}disconnect(){dj(this.actions)}dispatch(e){this.initialDisabled||(this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Animation.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((t=>{t.dispatch(e??!1)})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())))}},SH=class extends uV{constructor(e,t,n,i,r){super(e),this.sharedVariables=t,this.eventManager=n,this.needsMouse=i,this.needsRaycast=r,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=e=>{let t=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let n=new Date,i=[],r=[];for(let o=0;o<this.propertiesToWatch.length;o++){let{objectId:e,property:t,prevValue:n}=this.propertiesToWatch[o],i=this.eventContext.scene.find(e),s=Ww.propertyPaths[t];if("width"===s[0]||"height"===s[0]||"depth"===s[0])i=i.geometry.userData.parameters[s[0]];else for(let r=0;r<s.length;r++)i=i[s[r]];null===n?this.propertiesToWatch[o].prevValue=i instanceof ji?i.clone():i:(i instanceof ji?!i.equals(n):n!==i)&&(r.push({objId:e,property:t}),i instanceof ji?this.propertiesToWatch[o].prevValue.copy(i):this.propertiesToWatch[o].prevValue=i)}for(let o=0;o<this.variablesToWatch.length;o++){let{id:e,prevValue:n}=this.variablesToWatch[o],r=t.getVariable(e);r!==n&&(i.push(e),this.variablesToWatch[o].prevValue=r)}for(let o=0;o<this.dynamicVars.length;o++){let{id:r,expectedTime:s,last:a,data:l,timerSeconds:c,startValue:h}=this.dynamicVars[o],u=1e3;if("timer"!==l.dynamicVariableType&&"stopwatch"!==l.dynamicVariableType||"number3decimal"!==l.format?"counter"===l.dynamicVariableType?u=l.updateInterval:"random"===l.dynamicVariableType&&(u=l.isStatic?1/0:l.updateInterval):u=1,-1!==s){if("Stopped"!==t.getDynamicVariablePlayState(r)&&"Restarted"!==t.getDynamicVariablePlayState(r)||(this.dynamicVars[o].last=e,this.dynamicVars[o].expectedTime=e+u,"counter"===l.dynamicVariableType&&t.getVariable(r)!==h&&(t.updateVariable(r,h),this.eventManager.requestRender()),("timer"===l.dynamicVariableType||"stopwatch"===l.dynamicVariableType)&&this.dynamicVars[o].timerSeconds!==h&&(this.dynamicVars[o].timerSeconds=h,t.updateVariable(r,RE.getFormattedTimerTime(h,l)),this.eventManager.requestRender()),"Restarted"===t.getDynamicVariablePlayState(r)&&t.setDynamicVariablePlayState(r,"Playing"),"Stopped"!==t.getDynamicVariablePlayState(r))){if("Paused"===t.getDynamicVariablePlayState(r)){void 0===this.dynamicVars[o].deltaToExpectedTime&&(this.dynamicVars[o].deltaToExpectedTime=Math.max(this.dynamicVars[o].expectedTime-e,0)),this.dynamicVars[o].last=e-(u-this.dynamicVars[o].deltaToExpectedTime),this.dynamicVars[o].expectedTime=e+this.dynamicVars[o].deltaToExpectedTime;continue}if(this.dynamicVars[o].deltaToExpectedTime=void 0,e>=s)if(this.dynamicVars[o].last=e,this.dynamicVars[o].expectedTime+=u,"random"===l.dynamicVariableType){let e=l.min+Math.random()*(l.max-l.min),n=l.decimals;e=Math.round(e*Math.pow(10,n))/Math.pow(10,n),t.updateVariable(r,e),i.push(r),this.eventManager.requestRender()}else if("counter"===l.dynamicVariableType){let e=t.getVariable(r),n=t.getDynamicVariableToggleIsForward(r)??!0,s=t.getVariable(r)+l.increment*(n?1:-1);l.hasEnd&&(s=l.increment>0?ui.clamp(s,h,l.endValue):ui.clamp(s,l.endValue,h),s===h&&t.setDynamicVariableToggleIsForward(r,void 0),l.repeat?s===l.endValue&&(s=h):(s===h||s===l.endValue)&&t.setDynamicVariablePlayState(r,"Paused")),s!==e&&(i.push(r),t.updateVariable(r,s),this.eventManager.requestRender())}else if("time"===l.dynamicVariableType){let e=t.getVariable(r),s=yI(n,l);if("object"==typeof e&&"textValue"in e&&"object"==typeof s&&"textValue"in s){if(Array.isArray(e.textValue)&&Array.isArray(s.textValue)){if(e.textValue.every(((e,t)=>e===s.textValue[t])))continue}else if(e.textValue===s.textValue)continue}else if(e===s)continue;t.updateVariable(r,s),i.push(r),this.eventManager.requestRender()}else{let n=NE.isTextValue(l.endValue)?TH(l.endValue.textValue):l.endValue,s=t.getDynamicVariableToggleIsForward(r)??!0,u=c+(e-a)/1e3*("timer"===l.dynamicVariableType?-1:1)*(s?1:-1);u=Math.max(u,0),l.hasEnd&&(u="stopwatch"===l.dynamicVariableType?ui.clamp(u,h,n):ui.clamp(u,n,h),u===h&&t.setDynamicVariableToggleIsForward(r,void 0),l.repeat?Math.abs(u-n)<("number3decimal"===l.format?1e-4:.1)&&(u=h):(Math.abs(u-h)<("number3decimal"===l.format?1e-4:.1)||Math.abs(u-n)<("number3decimal"===l.format?1e-4:.1))&&t.setDynamicVariablePlayState(r,"Paused")),u!==c&&(i.push(r),this.dynamicVars[o].timerSeconds=u,t.updateVariable(r,RE.getFormattedTimerTime(u,l)),this.eventManager.requestRender())}}}else this.dynamicVars[o].last=e,this.dynamicVars[o].expectedTime=e+u}let s=!1;t.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=t.mouseProperty,s=!0);let a=!1;t.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=t.raycastProperty,a=!0),this.events.forEach((e=>{(i.includes(e.data.variableId)||r.find((t=>t.objId===e.data.objectId&&t.property===e.data.property))||"mouseProperty"===e.data.variableId&&s||"raycastProperty"===e.data.variableId&&a)&&(e.dispatch(),this.eventManager.requestRender())}))},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.eventContext.page.traverseEntity((e=>{e.data?.events.filter((e=>"VariableChange"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new _H(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),this.propertiesToWatch=this.events.filter((e=>"objectProperty"===e.data.variableId&&null!==e.data.objectId)).map((e=>({objectId:e.data.objectId,property:e.data.property,prevValue:null})));let e=this.eventContext.sharedAssets;this.sharedVariables.forEach((t=>{let n,{id:i,data:r}=t;if("dynamicVariableType"in r)if("timer"===r.dynamicVariableType||"stopwatch"===r.dynamicVariableType){let e;if(NE.isTextValue(r.value)&&Array.isArray(r.value.textValue)){let t=r.value.textValue;e=3===t.length?t[2]+60*t[1]+3600*t[0]:t[1]+60*t[0]}else e=r.value;n=e,this.dynamicVars.push({id:i,last:-1,expectedTime:-1,data:r,timerSeconds:e,startValue:n})}else"time"===r.dynamicVariableType&&e.updateVariable(i,yI(new Date,r)),"counter"===r.dynamicVariableType&&(n=NE.isTextValue(r.value)?TH(r.value.textValue):r.value),this.dynamicVars.push({id:i,last:-1,expectedTime:-1,data:r,startValue:n});else this.events.find((e=>e.data.variableId===i))&&this.variablesToWatch.push({id:i,prevValue:e.getVariable(i)})})),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach((e=>e.dispose()))}},_H=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.actions=uj(t,t.actions,i,r,s,n)}dispatch(){let e=this.actions;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}dispose(){dj(this.actions)}};function TH(e){return 3===e.length?e[2]+60*e[1]+3600*e[0]:e[1]+60*e[0]}var PH,MH,NH,IH={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1};ny.then((e=>{PH=e,MH=new e.Vec3,NH=new e.Vec3}));var OH=new ji,DH=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.usePhysics=e,this.isExport=t,this.onPointerDown=e=>{if(1!==Wv.length)return;let{raycaster:t,page:n}=this.eventContext;this.eventContext.updateRaycaster(e);let i=n.raycastWithClones(t);if(0!==i.length){if(this.gameControl){let e=OH.copy(this.gameControl.colliderWorldPosition);e.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(e,i[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(e,t)=>n=>{let i;if(n instanceof ED){if(!n.objectForSample)return!0===n.object.dataPatched.physics.fusedBody&&"dynamic"===n.object.dataPatched.physics.rigidBody||void 0;if(n.objectForSample.dataPatched.physics.fusedBody)return;i=n.object}else if(n instanceof lS)i=n.object;else if(i=n,!1===i.dataPatched.cloner?.disabled&&i.dataPatched.cloner?.hideBase&&!0!==i.dataPatched.physics?.fusedBody)return!0;if(t&&!i.userData.navmesh)return;let r=i.dataPatched;if(!r.visible&&!0!==r.physics?.enabled)return!0;n.updateMatrixWorldSVD();let s=yW(r),a=i.userData.hasDestroy,o=i.userData.hasDrag,l=!1,c=!1;for(let e of r.events)!0!==e.data.disabled&&("GameControl"===e.data.type?l=!0:"Follow"===e.data.type&&(c=!0));if(l||s||c||a||o)return!0;if(this.usePhysics&&"dynamic"===r.physics?.rigidBody){if(this.usePhysics&&r.physics?.fusedBody)return!0}else if("geometry"in n&&n.geometry&&e.push(Xj(n.geometry,n.matrixWorld)),this.usePhysics&&r.physics?.fusedBody)return n.traverseObject(((t,n)=>{if(0===n)return;let i;if(t instanceof ED){if(!t.objectForSample)return!0===t.object.dataPatched.physics.fusedBody&&"dynamic"===t.object.dataPatched.physics.rigidBody||void 0;if(t.objectForSample.dataPatched.physics.fusedBody)return;i=t.object}else if(t instanceof lS)i=t.object;else if(i=t,t.dataPatched.cloner?.hideBase)return!0;let r=i.dataPatched;if(!r.visible&&!0!==r.physics?.enabled)return!0;"geometry"in t&&t.geometry&&e.push(Xj(t.geometry,t.matrixWorld))})),!0},this.traverseNoPhysics=(e,t)=>n=>{let i;if(n instanceof ED)return;i=n instanceof lS?n.object:n;let r=i.dataPatched;if("visibility"===r.physics.enabled?!r.visible:!r.physics.enabled)return!0;if(t&&!i.userData.navmesh)return;let s=n.geometry,a=!0===i.userData.hasDestroy,o=!0===i.userData.hasDrag;if(yW(r)||a||o||i.dataPatched.events.some((e=>!0!==e.data.disabled&&"GameControl"===e.data.type)))return!0;s&&e.push(Xj(s,n.matrixWorld))},this.navmeshWasm=PH,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?"\n(async function() {\n\tconst [wasmImport, wasmBinary] = await Promise.all([\n\t\timport('https://unpkg.com/@splinetool/runtime@1.9.87/build/' + 'navmesh.js'),\n\t\tfetch('https://unpkg.com/@splinetool/navmesh-wasm@1.9.87/build/' + 'navmesh.wasm').then((res) => res.arrayBuffer()),\n\t]);\n\tconst wasmModule = wasmImport.default;\n\tself.module = await wasmModule({ wasmBinary });\n\tpostMessage('ready');\n})();\n":"\n(async function() {\n\tconst [wasmImport, wasmBinary] = await Promise.all([\n\t\timport(self.location.origin + '/_libraries/navmesh.js'),\n\t\tfetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),\n\t]);\n\tconst wasmModule = wasmImport.default;\n\tself.module = await wasmModule({ wasmBinary });\n\tpostMessage('ready');\n})();\n")+"\n\nonmessage = function(messageEvent) {\n\tconst meshData = messageEvent.data;\n\tconst positions = meshData[0];\n\tconst offset = meshData[1];\n\tconst indices = meshData[2];\n\tconst indicesLength = meshData[3];\n\tconst parameters = meshData[4];\n\n\tconst module = self.module;\n\tconst rc = new module.rcConfig();\n\trc.cs = parameters.cs;\n\trc.ch = parameters.ch;\n\trc.borderSize = parameters.borderSize ? parameters.borderSize : 0;\n\trc.tileSize = parameters.tileSize ? parameters.tileSize : 0;\n\trc.walkableSlopeAngle = parameters.walkableSlopeAngle;\n\trc.walkableHeight = parameters.walkableHeight;\n\trc.walkableClimb = parameters.walkableClimb;\n\trc.walkableRadius = parameters.walkableRadius;\n\trc.maxEdgeLen = parameters.maxEdgeLen;\n\trc.maxSimplificationError = parameters.maxSimplificationError;\n\trc.minRegionArea = parameters.minRegionArea;\n\trc.mergeRegionArea = parameters.mergeRegionArea;\n\trc.maxVertsPerPoly = parameters.maxVertsPerPoly;\n\trc.detailSampleDist = parameters.detailSampleDist;\n\trc.detailSampleMaxError = parameters.detailSampleMaxError;\n\n\tif (!self.navMesh) {\n\t\tself.navMesh = new module.NavMesh();\n\t}\n\tself.navMesh.build(positions, offset, indices, indicesLength, rc);\n\n\tconst navmeshData = navMesh.getNavmeshData();\n\tconst arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);\n\tconst ret = new Uint8Array(navmeshData.size);\n\tret.set(arrView);\n\tnavMesh.freeNavmeshData(navmeshData);\n\n\tpostMessage(ret);\n}\n"])),this._worker=new Worker(this._workerURL)}init(e,t,n){this.gameControl=t,this.eventContext=n,this.setDefaultQueryExtent((new ji).setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(n.page,e,(e=>{this.buildFromNavmeshData(e.data)}))},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,n){t.objects.forEach((t=>{let n=e.scene.find(t);n.traverseEntity((e=>{e.userData.navmesh=!0})),n.cloner?.traverseObject((e=>{e.userData.navmesh=!0}))}));let i=[],r=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(i,"custom"===t.zones);if(e.traverseChildren(r),t.objects.forEach((t=>{let n=e.scene.find(t);n.traverseEntity((e=>{e.userData.navmesh=void 0})),n.cloner?.traverseObject((e=>{e.userData.navmesh=void 0}))})),0===i.length)return!1;let s=_C(i),{positions:a,triIndices:o}=AP(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([a,a.length/3,o,o.length,{...IH,...t}]),this._worker.onmessage=n,!0}createDebugNavGeometry(){let e,t,n=this.navMesh.getDebugNavMesh(),i=n.getTriangleCount(),r=new Uint32Array(3*i),s=new Float32Array(3*i*3);for(e=0;e<3*i;e++)r[e]=e;for(e=0;e<i;e++)for(t=0;t<3;t++){let i=n.getTriangle(e).getPoint(t);s[9*e+3*t+0]=i.x,s[9*e+3*t+1]=i.y,s[9*e+3*t+2]=i.z}let a=new gs;return a.setIndex(new ss(r,1)),a.setAttribute("position",new ss(s,3)),a}getClosestPoint(e){return MH.x=e.x,MH.y=e.y,MH.z=e.z,this.navMesh.getClosestPoint(MH)}getClosestPointToRef(e,t){MH.x=e.x,MH.y=e.y,MH.z=e.z;let n=this.navMesh.getClosestPoint(MH);t.set(n.x,n.y,n.z)}getRandomPointAround(e,t){return MH.x=e.x,MH.y=e.y,MH.z=e.z,this.navMesh.getRandomPointAround(MH,t)}getRandomPointAroundToRef(e,t,n){MH.x=e.x,MH.y=e.y,MH.z=e.z;let i=this.navMesh.getRandomPointAround(MH,t);n.set(i.x,i.y,i.z)}moveAlong(e,t){return MH.x=e.x,MH.y=e.y,MH.z=e.z,NH.x=t.x,NH.y=t.y,NH.z=t.z,this.navMesh.moveAlong(MH,NH)}moveAlongToRef(e,t,n){return MH.x=e.x,MH.y=e.y,MH.z=e.z,NH.x=t.x,NH.y=t.y,NH.z=t.z,this.navMesh.moveAlong(MH,NH)}computePath(e,t){let n=this.getClosestPoint(t);if(NH.x=n.x,NH.y=n.y,NH.z=n.z,Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)+Math.pow(t.z-n.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(e);let i=this.navMesh.computePath(MH,NH),r=i.getPointCount(),s=[];for(let a=0;a<r;a++){let e=i.getPoint(a);s.push(new ji(e.x,e.y,e.z))}return s}createCrowd(e,t){return new LH(this,e,t)}setDefaultQueryExtent(e){MH.x=e.x,MH.y=e.y,MH.z=e.z,this.navMesh.setDefaultQueryExtent(MH)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,n=this.navmeshWasm._malloc(t),i=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,n,t);i.set(e);let r=new this.navmeshWasm.NavmeshData;r.dataPointer=i.byteOffset,r.size=e.length,this.navMesh.buildFromNavmeshData(r),this.navmeshWasm._free(i.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),n=new Uint8Array(e.size);return n.set(t),this.navMesh.freeNavmeshData(e),n}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),this.eventContext?.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,n){return MH.x=e.x,MH.y=e.y,MH.z=e.z,this.navMesh.addCylinderObstacle(MH,t,n)}addBoxObstacle(e,t,n){return MH.x=e.x,MH.y=e.y,MH.z=e.z,NH.x=t.x,NH.y=t.y,NH.z=t.z,this.navMesh.addBoxObstacle(MH,NH,n)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return void 0!==this.navmeshWasm}},LH=class{constructor(e,t,n){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,n,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,n){let i=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;i.radius=t.radius,i.height=t.height,i.maxAcceleration=t.maxAcceleration,i.maxSpeed=t.maxSpeed,i.collisionQueryRange=t.collisionQueryRange,i.pathOptimizationRange=t.pathOptimizationRange,i.separationWeight=t.separationWeight,i.updateFlags=7,i.obstacleAvoidanceType=0,i.queryFilterType=0,i.userData=0;let r=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),i);return this.transforms.push(n),this.agents.push(r),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new ji(0,0,0)),r}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let n=this.crowd.getAgentPosition(e);t.set(n.x,n.y,n.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let n=this.crowd.getAgentVelocity(e);t.set(n.x,n.y,n.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let n=this.crowd.getAgentNextTargetPath(e);t.set(n.x,n.y,n.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let n=this.agents.indexOf(e);n>-1&&(this._agentDestinationArmed[n]=!0,this._agentDestination[n].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let n=this.crowd.getAgentParameters(e);void 0!==t.radius&&(n.radius=t.radius),void 0!==t.height&&(n.height=t.height),void 0!==t.maxAcceleration&&(n.maxAcceleration=t.maxAcceleration),void 0!==t.maxSpeed&&(n.maxSpeed=t.maxSpeed),void 0!==t.collisionQueryRange&&(n.collisionQueryRange=t.collisionQueryRange),void 0!==t.pathOptimizationRange&&(n.pathOptimizationRange=t.pathOptimizationRange),void 0!==t.separationWeight&&(n.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,n)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=.001)return;let t=1/60;{let n=Math.floor(e/t);n>10&&(n=10),n<1&&(n=1);let i=e/n;for(let e=0;e<n;e++)this.crowd.update(i)}for(let n=0;n<this.agents.length;n++){let e=this.agents[n],t=this.getAgentPosition(e);if(this.transforms[n].copy(t),this._agentDestinationArmed[n]){let i=t.x-this._agentDestination[n].x,r=t.z-this._agentDestination[n].z,s=this.reachRadii[n],a=this._agentDestination[n].y-this.reachRadii[n],o=this._agentDestination[n].y+this.reachRadii[n],l=i*i+r*r;t.y>a&&t.y<o&&l<s*s&&(this.onReachTarget(e,this._agentDestination[n]),this._agentDestinationArmed[n]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,n=this.crowd.getCorners(e),i=n.getPointCount(),r=[];for(t=0;t<i;t++){let e=n.getPoint(t);r.push(new ji(e.x,e.y,e.z))}return r}dispose(){this.crowd.destroy()}};function RH(e){let t=!1;return e.scene.objects.forEach((n=>{"Page"===n.data.type&&!t&&n.data.publish.gameControlObject&&SE.traverseModuleInstances(e,n.id,((e,n,i)=>{for(let r of i)"GameControl"===r.data.type&&r.data.navmesh.enabled&&(t=!0)}))})),t}var kH={type:"change"},BH={type:"changeZoom"},UH={type:"changePan"},zH={type:"start"},FH={type:"end",changed:!0},jH={type:"end",changed:!1},VH=new Fi,HH=new di,WH=2*Math.PI,GH=new ji,qH=new di,KH=new ji,YH=new Fi,QH=new vr,XH={type:"requestRender"},ZH=class extends Zn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isPlayMode:!1,isExport:!1};super(),this.object=e,this.domElement=t,this.options=n,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Vt,Ft],this.offset=new ji,this.eye=new ji,this.lastPosition=new ji,this.lastQuaternion=new Fi,this.current=new di,this.overShoot=new di,this.overRatio=new di,this.spherical=new Cu,this.sphericalDelta=new Cu,this.panOffset=new ji,this.panLeftV=new ji,this.panUpV=new ji,this.panV=new ji,this.rotateStart=new di,this.rotateEnd=new di,this.rotateDelta=new di,this.panStart=new di,this.panEnd=new di,this.panDelta=new di,this.dollyStart=new di,this.dollyEnd=new di,this.dollyDelta=new di,this.rotationRangeFactor=new di,this.panRangeFactor=new di,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=e=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=e.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(KH,YH,GH),this.offset.copy(KH).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&-1===this.state&&this.rotateLeft((!0===this.autoRotateClockwise?1:-1)*this.getAutoRotationAngle()),0!==this.rotationLimitsMode&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),2!==this.rotationLimitsMode&&(this.spherical.phi+=this.sphericalDelta.phi),(1!==this.rotationLimitsMode||!0===this.autoRotate)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),0!==this.panLimitsMode&&(this.target.applyQuaternion(VH.copy(YH).invert()),this.panOffset.applyQuaternion(VH),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(YH),this.panOffset.applyQuaternion(YH)),2===this.panLimitsMode&&(this.panOffset.y=0),1===this.panLimitsMode&&(this.panOffset.x=0),-1!==this.state||this.gesture?(this.target.add(this.panOffset),this.panOffset.set(0,0,0)):(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)),this.offset.setFromSpherical(this.spherical),KH.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(QH.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(QH));let e=this.spherical.phi%WH;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(Vr.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),e>0&&e>Math.PI||e<0&&e>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),-1===this.state||!0===this.enableDamping){let e=1===this.hoverRotatePanMode?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-e,this.sphericalDelta.phi*=1-e}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>.01||8*(1-this.lastQuaternion.dot(this.object.quaternion))>1e-8?(this.dispatchEvent(kH),this.object.dispatchEvent(XH),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=e=>{!1!==this.enabled&&("touch"===e.pointerType||"pen"===e.pointerType&&Uv?this.onPointerDownTouch(e):this.onPointerDownMouse(e),-1!==this.state&&(this.isPointerDown=!0,this.dispatchEvent(zH),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),e.stopPropagation(),"touch"===e.pointerType||"pen"===e.pointerType&&Uv||this.domElement.setPointerCapture(e.pointerId)))},this.onPointerLeave=e=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(1===this.hoverRotatePanMode?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,GH.subVectors(this.position0,this.target0),this.spherical.setFromVector3(GH),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):2===this.hoverRotatePanMode&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=e},this.onPointerEnter=e=>{this.resetHoverEffectOnPointerLeave||void 0===this.pointerLeaveEvent?qH.set(e.clientX-this.domElement.clientWidth/2,e.clientY-this.domElement.clientHeight/2):qH.set(e.clientX-this.pointerLeaveEvent.clientX,e.clientY-this.pointerLeaveEvent.clientY),1===this.hoverRotatePanMode?(this.rotateDelta.copy(qH).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(HH,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(e.clientX,e.clientY)):2===this.hoverRotatePanMode&&(this.panDelta.copy(qH).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(e.clientX,e.clientY)),this.update()},this.onPointerMove=e=>{!1!==this.enabled&&(this.checkRaycastLock()||("touch"===e.pointerType||"pen"===e.pointerType&&Uv?this.onPointerMoveTouch(e):this.onPointerMoveMouse(e),e.stopPropagation()))},this.onPointerUp=e=>{this.isPointerDown=!1,0===Wv.length&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),Wv.length>1&&e.preventDefault(),this.hasChange?this.dispatchEvent(FH):this.dispatchEvent(jH),this.state=-1,e&&(e.stopPropagation(),"touch"===e.pointerType||"pen"===e.pointerType&&Uv||this.domElement.releasePointerCapture(e.pointerId))},this.onPointerDownMouse=e=>{let t;switch(t=this.useKeyEvents?this.mouseButtons[e.button]:this.mouseButtonsPlay[e.button],t){case 0:if(!0!==e.altKey||e.shiftKey||Hv(e)){if(" "===this.key){if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}}else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}break;case 4:if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2;break;case 3:if(Hv(e)||e.shiftKey){if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}break;case 5:if(Hv(e)||e.shiftKey){if(!1===this.enableRotate)return;this.handleMouseDownRotate(e),this.state=0}else{if(!1===this.enablePan)return;this.handleMouseDownPan(e),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=e=>{switch(this.state){case 0:if(!1===this.enableRotate)return;this.handleMouseMoveRotate(e);break;case 1:if(!1===this.enableZoom)return;this.handleMouseMoveDolly(e);break;case 2:if(!1===this.enablePan)return;this.handleMouseMovePan(e)}this.object.wasMovedByUser=!0},this.onPointerDownTouch=e=>{switch(Wv.length>1&&e.preventDefault(),this.touches[Wv.length-1]){case zt:if(!1===this.enableRotate)return void(this.state=-1);this.handleTouchStartRotate(),this.state=3;break;case Ft:if(!1===this.enablePan)return void(this.state=-1);this.handleTouchStartPan(),this.state=4;break;case jt:if(!1===this.enableZoom&&!1===this.enablePan)return;this.handleTouchStartDollyPan(),this.state=5;break;case Vt:if(!1===this.enableZoom&&!1===this.enableRotate)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=e=>{switch(Wv.length>1&&e.preventDefault(),this.state){case 3:if(!1===this.enableRotate)return;this.handleTouchMoveRotate(e),this.update();break;case 4:if(!1===this.enablePan)return;this.handleTouchMovePan(e),this.update();break;case 5:if(!1===this.enableZoom&&!1===this.enablePan)return;this.handleTouchMoveDollyPan(e),this.update();break;case 6:if(!1===this.enableZoom&&!1===this.enableRotate)return;this.handleTouchMoveDollyRotate(e),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=mv((()=>this.dispatchEvent(FH)),33),this.onMouseWheel=e=>{!1===this.enabled||!1===this.enableZoom&&!1===this.enablePan||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&e.preventDefault(),this.dispatchEvent(zH),this.handleMouseWheel(e),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=e=>{if(e.preventDefault(),!1!==this.enabled&&!this.checkRaycastLock()&&!kv)if("gesturechange"===e.type){if(!1===this.enableZoom||!1===this.isTouchZoom)return;this.dispatchEvent(zH),e.scale>this.prevScale?this.dollyIn(this.getZoomScale()):e.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=e.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(FH)},this.onContextMenu=e=>{e.preventDefault()},this.onTouchEnd=e=>{e.preventDefault()},this.onKeyDown=e=>{!1!==this.enabled&&(this.key=e.key," "===e.key&&this.dispatchEvent(zH))},this.onKeyUp=e=>{!1!==this.enabled&&(this.key=void 0,-1!==this.state&&"Alt"===e.key&&this.onPointerUp(Wv[0])," "===e.key&&this.dispatchEvent(FH))},this.onPointerHover=e=>{"mouse"!==e.pointerType||!1===this.enabled||-1!==this.state||2===this.hoverRotatePanMode&&this.isPanOverShoot||1===this.hoverRotatePanMode&&this.isRotateOverShoot||(this.isPointerDown=!0,2===this.hoverRotatePanMode?this.handleMouseMovePan(e,this.hoverRotatePanStrength):1===this.hoverRotatePanMode&&this.handleMouseMoveRotate(e,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=e=>{e.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.initialSphericalRadius=this.spherical.radius,this.addEventListenersToCamera()}dispatchEvent(e){"start"===e.type?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,0!==this.hoverRotatePanMode&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),0!==this.hoverRotatePanMode&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=e.hoverRotateDamping??this.dampingFactor,this.useWindowEvents="window"===t,0!==this.hoverRotatePanMode&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let n=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=n**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/this.maxZoom,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let i=this.object.getTarget().applyQuaternion(VH.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+i.y,this.maxV=e.panVerticalOffset.max+i.y,this.minH=-e.panHorizontalOffset.min+i.x,this.maxH=e.panHorizontalOffset.max+i.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=JH(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=JH(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=JH(JH(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=JH(JH(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,1===e.orbitTouches&&(this.touches[0]=zt),1===e.panTouches&&(this.touches[0]=Ft),2===e.orbitTouches&&(this.touches[1]=Vt),2===e.panTouches&&(this.touches[1]=jt),3===e.orbitTouches&&(this.touches[2]=zt),3===e.panTouches&&(this.touches[2]=Ft),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),0!==this.hoverRotatePanMode&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,n,i,r,s,a,o){let l,c,h;this.overShoot.set(0,0),e instanceof ji?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),h=!0):(l=e.theta,c=e.phi,this.current.set(JH(this.spherical.theta),JH(this.spherical.phi)),h=!1),0===n&&(this.current.x+=l,this.current.y+=c),(3===t||2===t)&&(!h&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<r&&this.current.x>0&&(this.overShoot.x=r-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<r&&(this.overShoot.x=r-this.current.x)),(3===t||1===t)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y)),h||(this.overShoot.x=JH(this.overShoot.x),this.overShoot.y=JH(this.overShoot.y)),0!==n?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),1===n&&(this.overRatio.x=$H(Math.abs(this.overRatio.x)),this.overRatio.y=$H(Math.abs(this.overRatio.y))),this.isPointerDown||1===n?2===n&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):2===n&&(!h&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||h&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=.05*this.overShoot.x),this.phiIsFree||(c=.05*this.overShoot.y),h?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):h?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof ji?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=!0===e?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let n=this.domElement;if(n&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let r=this.panV.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*r/n.clientHeight,this.object.matrixWorld),this.panUp(2*t*r/n.clientHeight,this.object.matrixWorld)}else n&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrixWorld));this.dispatchEvent(UH)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(BH)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(BH)}zoomOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getZoomScale();this.dispatchEvent(zH),this.dollyOut(e),this.dispatchEvent(FH)}zoomIn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getZoomScale();this.dispatchEvent(zH),this.dollyIn(e),this.dispatchEvent(FH)}setZoom(e){if(this.dispatchEvent(zH),this.object.isPerspectiveCamera){let t=this.initialSphericalRadius/e/this.spherical.radius;this.scale=t}else this.object.isOrthographicCamera&&(this.object.zoom=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0);this.dispatchEvent(FH)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;void 0!==e.movementX?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(HH,-this.object.angleOffsetFromUp);let n=this.domElement,i=this.useWindowEvents?window.innerHeight:n.clientHeight,r=2*Math.PI*this.rotateDelta.x/i,s=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(r),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;void 0!==e.movementX?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(!1===Bv&&!1===Hv(e)&&!0===function(e){return 0===e.wheelDeltaY||0===e.deltaY?!(Rv&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120)&&(e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:0===e.deltaMode):e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:0===e.deltaMode}(e)){if(!1===this.enablePan)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout((()=>{this.gesture=!1,this.isPointerDown=!1}),30)}else{if(!1===this.enableZoom||this.gesture)return;0===e.deltaY?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(2===Wv.length){let e=.5*(Wv[0].pageX+Wv[1].pageX),t=.5*(Wv[0].pageY+Wv[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(Wv[0].pageX,Wv[0].pageY)}handleTouchStartPan(){if(2===Wv.length){let e=.5*(Wv[0].pageX+Wv[1].pageX),t=.5*(Wv[0].pageY+Wv[1].pageY);this.panStart.set(e,t)}else this.panStart.set(Wv[0].pageX,Wv[0].pageY)}handleTouchStartDolly(){let e=Wv[0].pageX-Wv[1].pageX,t=Wv[0].pageY-Wv[1].pageY,n=Math.sqrt(e*e+t*t);this.dollyStart.set(0,n)}handleTouchStartDollyPan(){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(2===Wv.length){let t=Zv(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.rotateEnd.set(n,i)}else{if(e.pointerId!==Wv[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(2===Wv.length){let t=Zv(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.panEnd.set(n,i)}else{if(e.pointerId!==Wv[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=Zv(e),n=e.pageX-t.x,i=e.pageY-t.y,r=Math.sqrt(n*n+i*i);this.dollyEnd.set(0,r),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&!0===this.isTouchZoom&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let e=this.options?.showCameraLock;return e&&e(),!0}}return!1}};function JH(e){let t=2*Math.PI;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function $H(e){return 1-Math.pow(1-e,4)}var eW,tW=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.page=i,this.currentIntersectedObjects=[],this.actions=uj(t,t.actions,i,r,s,n),this.target=t.target,this.triggeringObjects=[];for(let a of t.triggeringObjects){let e=i.scene.find(a);e&&this.triggeringObjects.push(e)}}isValidTriggeringObject(e){return"all"===this.target||this.triggeringObjects.some((t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid)))}disconnect(){dj(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.SwitchCamera.forEach((e=>{"Toggle"===e.data.runMode?e.toggle():e.play()})),this.actions.Link.forEach((e=>{e.dispatch()})),this.actions.Reset.forEach((e=>{e.dispatch()})),this.actions.Create.forEach((e=>{e.dispatch()})),this.actions.Destroy.forEach((e=>{e.dispatch(!1)})),this.actions.Audio.forEach((e=>{e.dispatchBasic()})),this.actions.Particles.forEach((e=>{e.dispatchBasic()})),this.actions.Video.forEach((e=>{e.dispatchBasic()})),this.actions.SceneTransition.forEach((e=>{e.dispatch()})),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch())))}};ay.then((e=>eW=e));var nW=new ji,iW=new Fi,rW=new ji,sW=new Tr(0,0,0,"YXZ"),aW=new Tr(0,0,0,"XYZ"),oW=new ji,lW=new ji,cW=new ji(1,1,1),hW=new Fi,uW=new vr,dW=new vr,pW={type:"updateMatrix"},fW=new Fi,mW=new lr,gW={type:"beginEvent",eventName:"Collision"},vW={type:"beginEvent",eventName:"Trigger"};var yW=e=>e.states.some((e=>void 0!==e.data.position||void 0!==e.data.rotation||void 0!==e.data.hiddenMatrix||void 0!==e.data.cloner||void 0!==e.data.pathSnapping)),bW=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=e=>{if(e.bodyType()!==eW.RigidBodyType.Dynamic)return;e.isSleeping()||this.nActiveRigidBodies++;let[t,n,i]=this.rigidBodyToMesh.get(e.handle);if(nW.copy(e.translation()).multiplyScalar(this.pixelsPerMeter),iW.copy(e.rotation()),t.matrixWorld.compose(nW,iW,n),t.hasNonUniformScale&&t.matrixWorld.multiply(t.shearScale),t.dispatchEvent(pW),i){let e=t.cloner;if(e&&void 0===e.objectForSample){e.matrixWorld.copy(t.matrixWorld);for(let t of e.children)t.updateMatrixWorld(!0)}for(let n of t.children)n.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(e,t,n)=>{if(!1===n)return;let i,r;if(this.sensorToTriggerEvent[e]?(i=this.sensorToTriggerEvent[e],r=this.sharedGameControlGlobals.colliderToEntity.get(t)):this.sensorToTriggerEvent[t]&&(i=this.sensorToTriggerEvent[t],r=this.sharedGameControlGlobals.colliderToEntity.get(e)),i&&r&&i.isValidTriggeringObject(r))i.dispatch();else{for(let n=this.sharedGameControlGlobals.createdObjects.length-1;n>=0;n--){let i=this.sharedGameControlGlobals.createdObjects[n];if(i.userData.hasCollisionDestroy&&(i.rigidBody?.collider(0).handle===e||i.rigidBody?.collider(0).handle===t)){this.sharedGameControlGlobals.createdObjects.splice(n,1),i.removeFromParent(),requestAnimationFrame((()=>this.sharedGameControlGlobals.rapierWorld?.removeRigidBody(i.rigidBody)));break}}if(void 0!==this.gameControl?.object&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(e)){let e=this.sharedGameControlGlobals.colliderToEntity.get(t),n=this.sharedGameControlGlobals.entityToCollisionEvents[e.uuid];if(void 0===n)return;for(let i of n)"character"===i.data.target&&this.dispatchCollisionEvent(i,e,t)}else if(void 0!==this.gameControl?.object&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(t)){let t=this.sharedGameControlGlobals.colliderToEntity.get(e),n=this.sharedGameControlGlobals.entityToCollisionEvents[t.uuid];if(void 0===n)return;for(let i of n)"character"===i.data.target&&this.dispatchCollisionEvent(i,t,e)}else{let n=this.sharedGameControlGlobals.colliderToEntity.get(e),i=this.sharedGameControlGlobals.entityToCollisionEvents[n.uuid];if(void 0!==i)for(let t of i)"scene"===t.data.target&&this.dispatchCollisionEvent(t,n,e);let r=this.sharedGameControlGlobals.colliderToEntity.get(t),s=this.sharedGameControlGlobals.entityToCollisionEvents[r?.uuid];if(void 0!==s)for(let e of s)"scene"===e.data.target&&this.dispatchCollisionEvent(e,r,t)}}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=200,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach((e=>{e.addEventListener("connected",(e=>{"gamepad"in e.data&&"axes"in e.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(e.data.gamepad)}))}))}markIsDestroyTarget(){this.page.traverseVisibleEntity((e=>{let t=e.dataPatched;for(let n of t.events){if(!0===n.data.disabled)continue;let e=n.data.actions?.find((e=>"Destroy"===e.data.type))?.data;if(e)for(let t of e.objects){let e=this.page.scene.find(t);e&&(e.userData.hasDestroy=!0)}}}))}markIsDragObject(){this.page.traverseVisibleEntity((e=>{let t=e.dataPatched;for(let n of t.events)if(!0!==n.data.disabled&&"DragDrop"===n.data.type)for(let e of n.data.objects){let t=this.page.scene.find(e);t&&(t.userData.hasDrag=!0)}}))}initBVH(){let e=[];if(this.page.traverseChildren((t=>{let n;if(t instanceof ED||t instanceof iL||t instanceof kB)return;n=t instanceof lS?t.object:t;let i=n.dataPatched;if("visibility"===i.physics?.enabled?!i.visible:!i.physics?.enabled)return!0;let r=t.geometry,s=!0===n.userData.hasDestroy,a=!0===n.userData.hasDrag;if(yW(i)||s||a||n.dataPatched.events.some((e=>!0!==e.data.disabled&&("GameControl"===e.data.type||"Follow"===e.data.type))))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;r&&e.push(Xj(r,t.matrixWorld))})),e.length>0){let t=_C(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new VA(t)}}addRigidBody(e,t,n){if(Qj(e.matrixWorld))return;let i=[],r="geometry"in e?e.geometry:void 0,s=t.dataPatched;if(void 0!==r?.getAttribute("position")&&i.push(Xj(r,e.shearScale)),s.physics.fusedBody){let t=this.gatherChildrenGeom(e,i);e.traverseObject(t),e.children.forEach((e=>e.updateMatrixWorld(!0)));let n=e.cloner;n&&void 0===n.objectForSample&&"dynamic"===s.physics.rigidBody&&(n.traverseObject(t),n.children.forEach((e=>e.updateMatrixWorld(!0))))}if(i.length>0){let o,l=!n.fromCreate&&"dynamic"===s.physics.rigidBody||n.fromCreate&&n.dynamic;l?(o=eW.RigidBodyDesc.dynamic(),o.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(n.hasTransformAnim||n.hasFollow||n.hasDrag)&&!n.fromCreate?(o=eW.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):o=eW.RigidBodyDesc.fixed();let c=_C(i);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(nW,iW,rW),e.position0=nW.clone().divideScalar(this.pixelsPerMeter),e.rotation0=iW.clone(),nW.divideScalar(this.pixelsPerMeter),o.setTranslation(nW.x,nW.y,nW.z).setRotation(iW),r?c?.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):c?.scale(rW.x/this.pixelsPerMeter,rW.y/this.pixelsPerMeter,rW.z/this.pixelsPerMeter);let h=this.sharedGameControlGlobals.rapierWorld.createRigidBody(o);l&&this.rigidBodyToMesh.set(h.handle,[e,rW.clone(),s.physics.fusedBody]);let u=!(void 0===s.geometry||"SubdivGeometry"===s.geometry.type||"NonParametricGeometry"===s.geometry.type||"BooleanGeometry"===s.geometry.type||"VectorGeometry"===s.geometry.type||"StarGeometry"===s.geometry.type||"RectangleGeometry"===s.geometry.type||"EllipseGeometry"===s.geometry.type||"TriangleGeometry"===s.geometry.type||"TorusGeometry"===s.geometry.type||"HelixGeometry"===s.geometry.type);try{this.addCollider(h,s.physics,c,t,u)}catch{try{this.addCollider(h,s.physics,c,t,!1)}catch(a){console.error(a)}}e.rigidBody=h}}addBoundsTree(e){let t=[];if(void 0!==e.geometry?.getAttribute("position")&&e.geometry?.getAttribute("position").count>0&&t.push(Xj(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach((e=>e.updateMatrixWorld(!0))),t.length>0){let n=_C(t,!1);e.bvhGeometry=n,n.getAttribute("position").count>0&&(e.bvhGeometry.boundsTree=new VA(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e))}}addCollider(e,t,n,i){let r,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(0===n?.getAttribute("position").count||0===n?.getIndex()?.count)return;n&&(r="trimesh"===t.colliderType?eW.ColliderDesc.trimesh(n.getAttribute("position").array,n.getIndex().array):eW.ColliderDesc.convexMesh(n.getAttribute("position").array,s?n.getIndex().array:void 0)),r.setFrictionCombineRule(eW.CoefficientCombineRule.Average).setRestitutionCombineRule(eW.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let a=this.sharedGameControlGlobals.rapierWorld.createCollider(r,e);this.sharedGameControlGlobals.colliderToEntity.set(a.handle,i),this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid]?.some((e=>"scene"===e.target))&&a.setActiveEvents(eW.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(n,i)=>{if(0===i)return;let r;if(n instanceof ED){if(!n.objectForSample)return!0===n.object.dataPatched.physics.fusedBody&&"dynamic"===n.object.dataPatched.physics.rigidBody||void 0;if(n.objectForSample.dataPatched.physics.fusedBody)return;r=n.object}else if(n instanceof lS)r=n.object;else if(r=n,r.dataPatched.cloner?.hideBase)return!0;let s=r.dataPatched;if("visibility"===s.physics.enabled?!s.visible:!s.physics.enabled)return!0;1===i?e.hasNonUniformScale?n.matrixWorld.multiplyMatrices(e.shearScale,n.hiddenMatrix):n.matrixWorld.copy(n.hiddenMatrix):n.matrixWorld.multiplyMatrices(n.parent.matrixWorld,n.hiddenMatrix),n.matrixWorld.multiply(n.matrix);let a=n.geometry;void 0!==a?.getAttribute("position")&&t.push(Xj(a,n.matrixWorld))}}activate(e){if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,n=!1,i=5,r=8,s=9,a="drag",o=this.page.data.publish.gameControlObject,l=null!==o?this.page.find(o):null,c=null;if(l)for(let d of l.data.events){if(d.data.disabled||"GameControl"!==d.data.type)continue;let e=l;for(;this.usePhysics&&null!==(e=e.parent)?.parent;)e.data.physics;d.data.collisionEnabled&&(this.needsCollisionDetection=!0),null===c&&(c=d.data)}if(this.page.traverseEntity((e=>{for(let t of e.dataPatched.events)if(!1===t.data.disabled&&"Trigger"===t.data.type)return this.needsCollisionDetection=!0,!0})),l&&c&&(!0===l.data.visible||!0===l.data.physics.enabled)){n=n||c.camera===t.uuid||l.uuid===t.uuid;let e=new Kj(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&c.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=e,i=c.joystickPosLoc,r=c.joystickRotLoc,s=c.jumpTouchButtonLoc,a=c.rotByTouch,Uv&&c.touchControl&&(this.joystickToGameControls[i]="pos","walk"===c.moveMode&&(this.joystickToGameControls[s]="jmp"),"joystick"===a&&(this.joystickToGameControls[r]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let e=this.gameControl.data;if(!this.navigationMeshWrapper){let t;this.navigationMeshWrapper=new DH(this.usePhysics,this.isExport),t="sphere"===e.collider.type?2*e.collider.radius:e.collider.height,t=Math.floor(t/e.navmesh.ch-1),this.navigationMeshWrapper.init({...e.navmesh,walkableHeight:t},this.gameControl,this.eventContext)}}if(!1===n){let{enableRotate:e,enablePan:n,enableZoom:i,autoRotate:r,hoverRotatePanMode:s}=this.eventManager.publish.orbitControls;(e||n||i||r||0!==s)&&(this.orbitControls=new ZH(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let h=this.renderer.domElement.width/this.renderer.getPixelRatio(),u=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach(((e,t)=>{let n=document.body.appendChild(document.createElement("div")),[i,r,s]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[t],a=(h-5*i)/4+i,o={},l="jmp"===e,c=l?0:i;t<10?(t<5?o.top=c/2:o.bottom=c/2,o.left=c/2+t%5*a):10===t?(o.left=c/2,o.top=u/2):(o.right=c/2,o.top=u/2),o.top?o.top-=r[1]:o.bottom+=r[1],o.left?o.left+=r[0]:o.right-=r[0];for(let h in o)o[h]+="px";if(l){let e=n.appendChild(document.createElement("div"));Object.assign(e.style,o,{position:"absolute",width:i+"px",height:i+"px",backgroundColor:`rgba(255,255,255,${"show"===s?.4:0})`,zIndex:"9999",borderRadius:i+"px",border:"show"===s?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let r=i/16*16*.4;return"show"===s&&(e.innerHTML=`\n\t\t\t\t\t\t<svg width="${r}" height="${.4*i}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t`),e.addEventListener("pointerdown",(()=>{this.gameControl.movementState.jump=1,this.requestRender()})),e.addEventListener("touchend",(e=>e.preventDefault())),void(this.joysticks[t]=[void 0,n])}let d={zone:n,mode:"static",position:o,size:i};"hide"===s&&(d.restOpacity=0);let p=$U(d);p.on("move",((t,n)=>{let i=this.gameControl;"pos"===e?n.force<.2?i.moveForce=0:(i.movementState.movePosZ=Math.sin(-n.angle.radian),i.movementState.movePosX=Math.cos(-n.angle.radian),n.force>1.2?i.movementState.run=1:i.movementState.run=0,n.force<.3?i.moveForce=(n.force-.2)/.1:i.moveForce=1):"rot"===e&&(n.force<.2?i.rotForce=0:(i.movementState.rotPosX=n.vector.y,i.movementState.rotPosY=-n.vector.x,n.force<.3?i.rotForce=(n.force-.2)/.1:i.rotForce=1)),this.requestRender()})),p.on("end",((t,n)=>{let i=this.gameControl;"pos"===e?(i.movementState.movePosZ=0,i.movementState.movePosX=0,i.moveForce=1):"rot"===e&&(i.movementState.rotPosX=0,i.movementState.rotPosY=0,i.rotForce=1)})),this.joysticks[t]=[p,n]})),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout((()=>{this.collisionEvents.forEach((e=>e.initialDisabled=!1))}),80)}initPhysics(){this.sharedGameControlGlobals.rapierWorld?.free(),this.sharedGameControlGlobals.rapierWorld=new eW.World(new eW.Vector3(0,this.gravity,0)),this.events=new eW.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren((n=>{let i;if(n instanceof ED){if(!n.objectForSample)return!0===n.object.dataPatched.physics.fusedBody&&"dynamic"===n.object.dataPatched.physics.rigidBody||void 0;if(n.objectForSample.dataPatched.physics.fusedBody)return;i=n.object}else if(n instanceof lS)i=n.object;else{if(n instanceof kB||n instanceof iL)return;if(i=n,!1===i.dataPatched.cloner?.disabled&&i.dataPatched.cloner?.hideBase&&!0!==i.dataPatched.physics?.fusedBody)return!0}let r,s=i.dataPatched;for(let e of s.events)!0!==e.data.disabled&&"GameControl"===e.data.type&&(r=e.data);if(!s.physics||("visibility"===s.physics.enabled?!s.visible:!s.physics.enabled))return!0;n.updateMatrixWorldSVD();let a=yW(s),o=!1,l=i.userData.hasDestroy,c=i.userData.hasDrag,h=!1;for(let e of s.events)if(!0!==e.data.disabled)if("Collision"===e.data.type){o=!0;let t=new AH(e.id,e.data,i,this.page,this.sharedAssets,this.eventManager);t.initialDisabled=!0,this.collisionEvents.push(t),this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid].every((t=>t.id!==e.id))?this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid].push(t):this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid]=[t]}else if("Follow"===e.data.type){h=!0;let t=e.data.target;n.traverseVisible((e=>{e.userData.isFollowingObj=t}))}"dynamic"===s.physics.rigidBody&&!1===s.physics.fusedBody&&(n.matrixWorldFusedFalse=n.matrixWorld.clone());let u=n.geometry;if(void 0!==r){let e=eW.RigidBodyDesc.kinematicPositionBased();(n.hasNonUniformScale?n.matrixWorldRigid:n.matrixWorld).decompose(nW,iW,rW),n.position0=nW.clone().divideScalar(this.pixelsPerMeter),n.rotation0=iW.clone(),nW.divideScalar(this.pixelsPerMeter),e.setTranslation(nW.x,nW.y,nW.z).setRotation(iW);let t,a=this.sharedGameControlGlobals.rapierWorld.createRigidBody(e);n.rigidBody=a,t="sphere"===r.collider.type?eW.ColliderDesc.ball(r.collider.radius/this.pixelsPerMeter):"capsule"===r.collider.type?eW.ColliderDesc.capsule((r.collider.height/2-r.collider.radius)/this.pixelsPerMeter,r.collider.radius/this.pixelsPerMeter):eW.ColliderDesc.cuboid(r.collider.width/this.pixelsPerMeter/2,r.collider.height/this.pixelsPerMeter/2,r.collider.depth/this.pixelsPerMeter/2),t.setFrictionCombineRule(eW.CoefficientCombineRule.Average).setRestitutionCombineRule(eW.CoefficientCombineRule.Average).setDensity(s.physics.density).setFriction(s.physics.friction).setRestitution(s.physics.restitution);let o=this.sharedGameControlGlobals.rapierWorld.createCollider(t,a);this.sharedGameControlGlobals.colliderToEntity.set(o.handle,i),nW.fromArray(r.collider.position).multiply(rW.setFromMatrixScale(i.matrixWorld)).divideScalar(this.pixelsPerMeter),o.setTranslationWrtParent(nW);let l=(new Fi).setFromEuler((new Tr).setFromVector3((new ji).fromArray(r.collider.rotation)));o.setRotationWrtParent(l),o.setActiveEvents(eW.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(i,!0)}else"dynamic"===s.physics.rigidBody||a||h||l||c||o?(this.addRigidBody(n,i,{hasFollow:h,hasTransformAnim:a,hasDrag:c}),this.generateSensorColliderDescs(i,s.physics.fusedBody)):(u&&e.push(Xj(u,n.matrixWorld)),s.physics.fusedBody&&n.traverseObject(((t,n)=>{if(0===n)return;let i;if(t instanceof ED){if(!t.objectForSample)return!0===t.object.dataPatched.physics.fusedBody&&"dynamic"===t.object.dataPatched.physics.rigidBody||void 0;if(t.objectForSample.dataPatched.physics.fusedBody)return;i=t.object}else{if(t instanceof kB||t instanceof iL)return;if(t instanceof lS)i=t.object;else if(i=t,i.dataPatched.cloner?.hideBase)return!0}let r=i.dataPatched;if("visibility"===r.physics.enabled?!r.visible:!r.physics.enabled)return!0;let s=t.geometry;void 0!==s?.getAttribute("position")&&e.push(Xj(s,t.matrixWorld))})),this.generateSensorColliderDescs(i,s.physics.fusedBody,t));return!(!0!==s.physics?.fusedBody&&!r)||void 0})),0===e.length)return;let n=_C(e);n.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let i=eW.RigidBodyDesc.fixed(),r=this.sharedGameControlGlobals.rapierWorld.createRigidBody(i),s=eW.ColliderDesc.trimesh(n.getAttribute("position").array,n.getIndex().array).setFrictionCombineRule(eW.CoefficientCombineRule.Multiply).setRestitutionCombineRule(eW.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,r);for(let[a,o]of t){let e=this.sharedGameControlGlobals.rapierWorld.createCollider(a,r);this.sensorToTriggerEvent[e.handle]=o}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity((e=>{for(let t of e.dataPatched.events)if("Trigger"===t.data.type&&!0!==t.data.disabled){let n=new tW(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),i=(new vr).compose(oW.fromArray(t.data.position),hW.setFromEuler(aW.fromArray(t.data.rotation)),cW);if("box"===t.data.triggerZone){let r=new Wi;r.min.fromArray(t.data.size).multiplyScalar(-.5),r.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([r,i,e,n])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,i,e,n])}})),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach((e=>e.disconnect())),this.sharedGameControlGlobals.triggers.forEach((e=>e[3].disconnect())),this.sharedGameControlGlobals.triggers.length=0}deactivate(){if(this.isEnabled){this.isEnabled=!1,this.page.traverse((e=>{let t=e;t.matrixWorldFusedFalse&&(t.matrixWorldFusedFalse=void 0),t.rigidBody&&(t.rigidBody=void 0),t.position0&&(t.position0=void 0),t.rotation0&&(t.rotation0=void 0)})),this.sharedGameControlGlobals.rapierWorld?.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),this.gameControl?.reset(),this.gameControl?.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach((e=>{let[t,n]=e;t?.destroy(),n.remove()})),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),this.navigationMeshWrapper?.dispose(),this.navigationMeshWrapper=void 0;for(let e of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))e.forEach((e=>e.disconnect()));this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,n){if(!this.isEnabled)return!0;let i=!0;if(void 0!==this.orbitControls&&this.orbitControls.needsUpdate&&(i=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,i=!1):2===this.initializationCounter&&this.gameControl&&(i=!this.gameControl.update(e,t,n)&&i),!1===this.usePhysics&&this.checkTrigger(),this.usePhysics){let t=.016666666666666666;if(0===e)i=this.stepPhysics()&&i;else{let n=e/1e3;n<t&&n>.55*t&&(n=t),this.accumulator+=n;let r=performance.now(),s=0,a=6;for(;this.accumulator>=t&&s<a&&(i=this.stepPhysics()&&i,this.accumulator-=t,s++,!(performance.now()-r>1e3*t)););this.accumulator=this.accumulator%t}}return i}stepPhysics(){for(let e of this.sharedGameControlGlobals.entitiesWithTransformAnim){(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(nW,iW,rW),sW.setFromQuaternion(iW);let t=e;void 0===t.prevR?(t.prevR=sW.clone(),t.prevT=nW.clone()):(t.prevR.copy(sW),t.prevT.copy(nW)),e.rigidBody&&(e.rigidBody.setNextKinematicTranslation(nW.divideScalar(this.pixelsPerMeter)),e.rigidBody.setNextKinematicRotation(iW))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),this.events?.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,n){let i,r=(this.sharedGameControlGlobals.rapierWorld?.getCollider(n))._parent;if(t.cloner)for(let s of t.cloner.children)if(s.rigidBody===r){i=s;break}e.dispatch(i),t.dispatchEvent(gW)}updateUseWindowEvents(e){this.orbitControls?.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,n){let i=dW.copy(e.matrixWorld).invert();e.traverseEntity(((r,s)=>{if(!1===t&&1===s)return!0;for(let t of r.dataPatched.events)if("Trigger"===t.data.type&&!0!==t.data.disabled){let s,a=new tW(t.id,t.data,r,this.page,this.sharedAssets,this.eventManager);if(s="box"===t.data.triggerZone?eW.ColliderDesc.cuboid(...t.data.size.map((e=>e/(2*this.pixelsPerMeter)))):eW.ColliderDesc.ball(t.data.radius/this.pixelsPerMeter),s.setDensity(0).setSensor(!0).setActiveEvents(eW.ActiveEvents.COLLISION_EVENTS),oW.fromArray(t.data.position),hW.setFromEuler(aW.fromArray(t.data.rotation)),uW.compose(oW,hW,cW).premultiply(r.matrixWorld),n?(uW.decompose(oW,hW,lW),s.setActiveCollisionTypes(eW.ActiveCollisionTypes.KINEMATIC_FIXED|eW.ActiveCollisionTypes.DYNAMIC_FIXED)):(uW.premultiply(i).decompose(oW,hW,lW),e.rigidBody.bodyType()===eW.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===eW.RigidBodyType.Fixed?s.setActiveCollisionTypes(eW.ActiveCollisionTypes.KINEMATIC_FIXED|eW.ActiveCollisionTypes.DYNAMIC_FIXED):s.setActiveCollisionTypes(eW.ActiveCollisionTypes.KINEMATIC_KINEMATIC|eW.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),oW.divideScalar(this.pixelsPerMeter),s.setTranslation(oW.x,oW.y,oW.z),s.setRotation(hW),n)n.push([s,a]);else{let t=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e.rigidBody);this.sensorToTriggerEvent[t.handle]=a}}}))}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[n,i,r,s]=this.sharedGameControlGlobals.triggers[t];for(let t=0;t<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;t++){let a=this.sharedGameControlGlobals.entitiesWithTransformAnim[t];if(r===a||!1===s.isValidTriggeringObject(sS.is(a)?a:a.object))continue;let o=dW.copy(r.matrixWorld).decompose(oW,fW,lW).compose(oW,fW,cW).multiply(i),l=uW.copy(a.matrixWorld).invert().multiply(o);n instanceof Wi?e=a.bvhGeometry.boundsTree.intersectsBox(n,l):(mW.radius=n,mW.center.setFromMatrixPosition(l),e=a.bvhGeometry.boundsTree.intersectsSphere(mW)),e?-1===s.currentIntersectedObjects.indexOf(a)&&(s.currentIntersectedObjects.push(a),s.dispatch(),r.dispatchEvent(vW)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter((e=>e!==a))}}}};function wW(e){let t=this._clip.duration,n=this._clip.start??0,i=this.loop,r=this.time+e,s=this._loopCount,a=i===Ln;if(0===e)return-1===s?r:a&&1===(1&s)?t-(r-n):r;if(2200===i){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<n){let i=Math.floor((r-n)/(t-n));r-=(t-n)*i,s+=Math.abs(i);let o=this.repetitions-s;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a||(r=e>0?t:n,1===this.repetitions&&(r=t)),this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){let t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i})}}else this.time=r;if(a&&1===(1&s))return t-(r-n)}return r}var xW,EW=!1,CW=class{constructor(e,t,n,i){this.scene=e,this.requestRender=t,this.updateDisplayProgress=n,this.animationInspectorState=i,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=e=>{"Empty"===e.data.type&&e.data.animations&&e.data.animations.forEach(((t,n)=>{let i=t[0]+"/";if(Array.isArray(e.identity)?i+=e.identity[0]:i+=e.uuid,this.clipIdToAction[i])return;let r=Ph.parse(JSON.parse(t[2]));e.animations[n]=r;let s=this.mixer.clipAction(r,e);!1===EW&&(Object.getPrototypeOf(s)._updateTime=wW,EW=!0),s.clampWhenFinished=!0,this.clipIdToAction[i]=s}))},this.mixer=new yu(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let n=this.scene.find(t);if(!n)return;let i=n.animations.find((t=>t.uuid===e));if(!i)return;let r=this.clipIdToAction[e];!r||(r.stop(),this.mixer.uncacheClip(i),delete this.clipIdToAction[e],n.animations=n.animations.filter((t=>t.uuid!==e)))}get isPlaying(){return Object.values(this.clipIdToAction).some((e=>e.isRunning()))}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach((e=>{e.repetitions=1/0,e.loop=2201})),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,n=this.clipIdToAction[t];if(n)return e&&(e.repeat>=0&&(n.repetitions=e.repeat+1),"pingpong"===e.direction&&0!==e.repeat&&(n.loop=Ln)),n.play(),n.paused=!1,this.requestRender(),n}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){if(this.needsUpdate)this.needsUpdate=!1;else if(!1===this.isPlaying||this.animationInspectorState?.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*(this.maxFrames-1)%(this.maxFrames-1))),this.requestRender()}get maxFrames(){return ij(this.activeClip??void 0)}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let n=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(e/(this.maxFrames-1),.9999)*this.activeClip.duration),this.requestRender(),n&&(this.clipIdToAction[t].paused=!0)}},AW=new WeakMap,SW=class extends Dh{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,i){let r=new kh(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,(e=>{this.decodeDracoFile(e,t).catch(i)}),n,i)}decodeDracoFile(e,t,n,i){let r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};return this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){let n=JSON.stringify(t);if(AW.has(e)){let t=AW.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,r=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(r,s).then((n=>(i=n,new Promise(((n,s)=>{i._callbacks[r]={resolve:n,reject:s},i.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return a.catch((()=>!0)).then((()=>{i&&r&&this._releaseTask(i,r)})),AW.set(e,{key:n,promise:a}),a}_createGeometry(e){let t=new gs;e.index&&t.setIndex(new ss(e.index.array,1));for(let n=0;n<e.attributes.length;n++){let i=e.attributes[n],r=i.name,s=i.array,a=i.itemSize;t.setAttribute(r,new ss(s,a))}return t}_loadLibrary(e,t){let n=new kh(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise(((t,i)=>{n.load(e,t,void 0,i)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{let n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let i=_W.toString(),r=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([r]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){let e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){let n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));let n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}};function _W(){let e,t;function n(e,t,n,i,r,s){let a=s.num_components(),o=n.num_points()*a,l=o*r.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,r),h=e._malloc(l);t.GetAttributeDataArrayForAllPoints(n,s,c,l,h);let u=new r(e.HEAPF32.buffer,h,o).slice();return e._free(h),{name:i,array:u,itemSize:a}}onmessage=function(i){let r=i.data;switch(r.type){case"init":e=r.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":let i=r.buffer,s=r.taskConfig;t.then((e=>{let t=e.draco,a=new t.Decoder,o=new t.DecoderBuffer;o.Init(new Int8Array(i),i.byteLength);try{let e=function(e,t,i,r){let s,a,o=r.attributeIDs,l=r.attributeTypes,c=t.GetEncodedGeometryType(i);if(c===e.TRIANGULAR_MESH)s=new e.Mesh,a=t.DecodeBufferToMesh(i,s);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");s=new e.PointCloud,a=t.DecodeBufferToPointCloud(i,s)}if(!a.ok()||0===s.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());let h={index:null,attributes:[]};for(let u in o){let i,a,c=self[l[u]];if(r.useUniqueIDs)a=o[u],i=t.GetAttributeByUniqueId(s,a);else{if(a=t.GetAttributeId(s,e[o[u]]),-1===a)continue;i=t.GetAttribute(s,a)}h.attributes.push(n(e,t,s,u,c,i))}return c===e.TRIANGULAR_MESH&&(h.index=function(e,t,n){let i=3*n.num_faces(),r=4*i,s=e._malloc(r);t.GetTrianglesUInt32Array(n,r,s);let a=new Uint32Array(e.HEAPF32.buffer,s,i).slice();return e._free(s),{array:a,itemSize:1}}(e,t,s)),e.destroy(s),h}(t,a,o,s),i=e.attributes.map((e=>e.array.buffer));e.index&&i.push(e.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:e},i)}catch(l){console.error(l),self.postMessage({type:"error",id:r.id,error:l.message})}finally{t.destroy(o),t.destroy(a)}}))}}}async function TW(e){if(xW){let t,n={attributeIDs:xW.defaultAttributeIDs,attributeTypes:xW.defaultAttributeTypes,useUniqueIDs:!1};try{t=await xW.decodeGeometry(new Int8Array(e).buffer,n)}catch(Me){console.error(Me)}if(t)return{index:t.index?{array:t.index.array}:void 0,attributes:Object.entries(t.attributes).map((e=>{let[t,n]=e;return{name:t,itemSize:n.itemSize,array:n.array}}))}}return null}var PW=class{constructor(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0],this._delay=500,this._distance=2,this._onMouseDown=e=>{let t=[e.clientX,e.clientY],n=(new Date).getTime();if(this._clickCount>0){let e=t[0]-this._lastPosition[0],n=t[1]-this._lastPosition[1];Math.sqrt(e*e+n*n)>this._distance&&(this._clickCount=0)}this._lastPosition=t,this._clickCount=n-this._lastTime>this._delay?1:this._clickCount+1,this._lastTime=n},this._onMouseUp=e=>{}}start(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this._target&&this.stop(),this.reset(),this._delay=t,this._distance=n,this._target=e,this._target.addEventListener("pointerdown",this._onMouseDown,!1),this._target.addEventListener("pointerup",this._onMouseUp,!1)}stop(){this._target&&(this._target.removeEventListener("pointerdown",this._onMouseDown,!1),this._target.removeEventListener("pointerup",this._onMouseUp,!1),this._target=void 0)}get clickCount(){return this._clickCount}reset(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0]}},MW=class{constructor(e,t,n,i,r,s,a,o){this.eventId=e,this.id=t,this.data=n,this.dataEvent=i,this.object=r,this.stage=!1,this.actions=uj(i,n.actions,s,a,o,r)}disconnect(){dj(this.actions)}dispatchIn(){this.actions.Audio.forEach((e=>e.dispatchBasic())),this.actions.Particles.forEach((e=>e.dispatchBasic())),this.actions.Video.forEach((e=>e.dispatchBasic())),this.actions.Create.forEach((e=>e.dispatch())),this.actions.Destroy.forEach((e=>e.dispatch())),this.actions.Reset.forEach((e=>e.dispatch())),this.actions.Link.forEach((e=>e.dispatch())),this.actions.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())})),this.actions.Transition.forEach((e=>e.toggle())),this.actions.Animation.forEach((e=>e.play())),this.actions.SwitchCamera.forEach((e=>e.play())),this.actions.SceneTransition.forEach((e=>e.dispatch())),this.actions.SetVariable.forEach((e=>e.checkConditions())),this.actions.SetVariable.forEach((e=>e.dispatch())),this.actions.DynamicVariablePlay.forEach((e=>e.dispatch())),this.actions.ClearLocalStorage.forEach((e=>e.dispatch())),this.actions.UserAPI.forEach((e=>e.dispatch()))}dispatchOut(){this.actions.Transition.forEach((e=>{e.toggle()}))}},NW=class extends uV{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(e,t)=>{this.breakpoints.forEach((n=>{let i,r=Vw.deviceToSize(n.data.size),s="horizontal"===n.dataEvent.orientation?e:t;switch(n.data.operator){case"<":i=s<r[0];break;case">":i=s>r[0];break;case"<>":i=s>r[0]&&s<r[1]}n.stage!==i&&(n.stage=i,n.stage?n.dispatchIn():n.dispatchOut())}))},this.onResizeObserver=new ResizeObserver((e=>{for(let t of e){let{width:e,height:n}=t.contentRect;this.resize(e,n)}}))}connect(){let{page:e,sharedAssets:t,domElement:n}=this.eventContext;this.onResizeObserver.observe(n);let i=n=>{if(n.visible&&n.data?.events.length)for(let{data:i,id:r}of n.data.events)i.disabled||"Resize"===i.type&&i.breakpoints.forEach((s=>{let{data:a,id:o}=s;try{let s=new MW(r,o,a,i,n,e,t,this.eventManager);this.breakpoints.push(s)}catch(rx){}}))};e.traverseEntity((e=>{(e instanceof CB||e instanceof pB)&&e.frame?.traverse((e=>{i(e)})),i(e)}))}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach((e=>{e.disconnect()})),this.breakpoints=[]}},IW=class extends uV{constructor(e,t){super(e),this.eventManager=t,this.userAPIs={},this.events=[],this.onSuccess=e=>{let{userAPIId:t}=e;this.events.forEach((e=>{e.data.userAPIId===t&&e.dispatchSuccess()}))},this.onError=e=>{let{userAPIId:t}=e;this.events.forEach((e=>{e.data.userAPIId===t&&e.dispatchError()}))},this.userAPIs=e.sharedAssets.getUserAPIs()}connect(){this.eventContext.page.traverseEntity((e=>{e.data?.events.filter((e=>"API"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new OW(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),Object.entries(this.userAPIs).forEach((e=>{let[t,n]=e;n.on("success",this.onSuccess),n.on("error",this.onError),n.autostart&&n.callUserAPI(this.eventContext.sharedAssets)}))}disconnect(){Object.entries(this.userAPIs).forEach((e=>{let[t,n]=e;n.off("success",this.onSuccess),n.off("error",this.onError)}))}},OW=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.successActions=uj(t,t.successActions,i,r,s,n),this.errorActions=uj(t,t.errorActions,i,r,s,n)}dispatchSuccess(){this.dispatchActions(this.successActions)}dispatchError(){this.dispatchActions(this.errorActions)}dispatchActions(e){e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}},DW=class extends uV{constructor(e,t){super(e),this.eventManager=t,this.userWebhooks={},this.events=[],this.onMessage=e=>{let{userWebhookId:t}=e;this.events.forEach((e=>{e.data.userWebhookId===t&&e.dispatch()}))},this.userWebhooks=e.sharedAssets.getUserWebhooks()}connect(){this.eventContext.page.traverseEntity((e=>{e.data?.events.filter((e=>"WEBHOOK"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new LW(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),Object.entries(this.userWebhooks).forEach((e=>{let[t,n]=e;n.connect(),n.on("message",this.onMessage)}))}disconnect(){Object.entries(this.userWebhooks).forEach((e=>{let[t,n]=e;n.off("message",this.onMessage),n.disconnect()}))}},LW=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.actions=uj(t,t.actions,i,r,s,n)}dispatch(){let e=this.actions;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}};var RW=new ji(0,0,1),kW=new ji,BW=new ji,UW=new pi,zW=class{constructor(e,t,n,i,r){this.containerScene=e,this.raycaster=t,this.sharedAssets=n,this.requestRender=i,this.onExit=r,this.htmlInput=null,this.virtualInput=null,this.helper=new ik,this.doubleClickHandler=new PW,this.isDragging=!1,this.plane=new Ks,this.caretInterval=0,this.planeIntersection=new ji,this.projected=new di,this._lastIndex=0,this._isFirstDragMove=!1,this.selectionOnDragStart=0,this.onTextMaterialChanged=()=>{let e=this.virtualInput?.data;if(void 0!==this.virtualInput&&e){let t=e.material,n=function(e,t){let n=ix.fromHex(3223857),i=.8;for(let r of e.layers){if("light"===r.data.type||"displace"===r.data.type||"fresnel"===r.data.type||"matcap"===r.data.type||"texture"===r.data.type||"toon"===r.data.type||"outline"===r.data.type||"transmission"===r.data.type||"noise"===r.data.type)continue;let e="string"==typeof r.data.alpha?Number(t.getVariable(r.data.alpha)):r.data.alpha;if("color"===r.data.type&&e>.3){n=ak(r.data.color,t),i=e;break}if(("depth"===r.data.type||"gradient"===r.data.type)&&e>.3){let e=ok(r.data);n={r:e[0],g:e[1],b:e[2]},i="string"==typeof r.data.alpha?1:r.data.alpha;break}}return{...n,a:i}}("string"==typeof t?this.sharedAssets.data.materials[t]:t,this.sharedAssets);this.helper.setCaretColor(n)}},this.stopAnimateTextCursor=()=>{clearInterval(this.caretInterval),this.helper&&(this.helper.caretMesh.visible=!1)},this.startAnimateTextCursor=()=>{this.stopAnimateTextCursor(),this.helper&&(this.helper.caretMesh.visible=!0,this.caretInterval=setInterval((()=>{this.helper&&(this.helper.caretMesh.visible=!this.helper.caretMesh.visible),this.requestRender()}),600))},this.handleCaretUpdate=e=>{if(!this.htmlInput||!this.virtualInput)return;let t=this.helper,n="ArrowLeft"===e?.key||"ArrowRight"===e?.key,i="ArrowUp"===e?.key||"ArrowDown"===e?.key;this.htmlInput.selectionStart===this.htmlInput.selectionEnd?(t.setCaretPosition(this.htmlInput.selectionStart,{horizontalKeyMove:n,verticalKeyMove:i}),this.startAnimateTextCursor()):t.setSelection(this.htmlInput.selectionStart,this.htmlInput.selectionEnd),this.requestRender()},this.containerScene.add(this.helper)}createInput(){return this.htmlInput=function(){let e=document.createElement("textarea");return e.style.position="fixed",e.style.top="200px",e.style.left="400px",e.style.zIndex="-1",e.style.border="1px solid rgba(255,0,0,0.5)",e.style.width="10px",e.style.height="500px",e.style.color="white",e.style.opacity="0.5",e.style.background="transparent",e.style.display="none",e.style.margin="0px",e.style.padding="0px",e.style.boxSizing="content-box",e.style.pointerEvents="none",e}(),this.htmlInput}connect(){}disconnect(){this.stopAnimateTextCursor(),this.helper.hide(),this.htmlInput?.remove(),this.doubleClickHandler.stop()}handleMouseDown(){if(!this.htmlInput||!this.virtualInput)return!0;this.getPointOnPlane();let e=this.doubleClickHandler.clickCount,{index:t,lineIndex:n,characterIndex:i}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,e>1?"inside":"previous")??{index:0,lineIndex:0,characterIndex:0};this.virtualInput?.wrappedText?.length&&"\n"===this.virtualInput.wrappedText[n][Math.max(0,i-1)]&&(t--,i--),this._lastIndex=t,this._isFirstDragMove=!0;let r=this.checkClickedObject();if(1===e){if(null===r)return this.onExit(this.virtualInput),!0;this.selectionOnDragStart=t,this.isDragging=!0,this.setInputSelection(t)}else r===this.virtualInput&&(2===e?this.selectClosestWord(n,i):e>2&&(this.setInputSelection(0,this.htmlInput.value.length),this.doubleClickHandler.reset()))}handleMouseUp(){this.applyRangeToTextInput(),this.isDragging=!1,this._isFirstDragMove=!1}handleMouseMove(){!this.virtualInput||(this._isFirstDragMove&&this.doubleClickHandler.clickCount>1&&(this.selectionOnDragStart=this._lastIndex,this.isDragging=!0,this.setInputSelection(this._lastIndex)),this._isFirstDragMove=!1,this.getPointOnPlane(),this.applyRangeToTextInput())}focus(e){if(this.virtualInput=e,this.updateTextInputStyles(),this.htmlInput)if(e){let e=this.data?.geometry.text;this.htmlInput.value="string"==typeof e?"":e?.textValue.toString()??""}else this.htmlInput.value=""}blur(){}get data(){let{virtualInput:e}=this;if(e)return e.dataPatched}applyRangeToTextInput(){if(!this.isDragging||!this.virtualInput||!this.htmlInput)return;let e=this.selectionOnDragStart,{index:t,lineIndex:n,characterIndex:i}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,this.doubleClickHandler.clickCount>2?"inside":"previous")??{index:0};void 0!==n&&void 0!==i&&"\n"===this.virtualInput?.wrappedText[n][i-1]&&t--,this.htmlInput.setSelectionRange(Math.min(e,t),Math.max(e,t))}checkClickedObject(){if(this.virtualInput){let e=this.raycaster.intersectObject(this.virtualInput,!1);if(e.length>0){let t=e[0];if(t.object instanceof vB)return t.object}}return null}selectClosestWord(e,t){if(!this.virtualInput)return;let n=this.virtualInput.wrappedText,i=n[e],r=t+1,s=t;" "!==i[t]&&(r=this.findNextCharOccurence(i,t,"forward"," "),s=this.findNextCharOccurence(i,t,"backward"," "),s>0&&s++,r>=i.length-1&&e===n.length-1&&r++);let a=this.helper,o=a.getGlobalIndexFromLineAndCharIndexes(n,e,s),l=a.getGlobalIndexFromLineAndCharIndexes(n,e,r);this.setInputSelection(o,l)}findNextCharOccurence(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",r=Math.max(0,e.length-1),s="forward"===n?r:0,a="forward"===n?1:-1,o=Math.max(Math.min(t,r),0);for(;o!==s;)if(o+=a,e.charAt(o)===i)return o;return s}getPointOnPlane(){let e=this.virtualInput?.data;if(this.virtualInput&&e&&this.raycaster.ray.intersectsPlane(this.plane)){null===this.planeIntersection&&(this.planeIntersection=new ji);let t=this.raycaster.ray.intersectPlane(this.plane,this.planeIntersection);if(t){this.planeIntersection.copy(this.virtualInput.worldToLocal(t));let n="number"==typeof e.geometry.width?e.geometry.width:1,i="number"==typeof e.geometry.height?e.geometry.height:1;this.projected.set(t.x+.5*n,t.y-.5*i)}}}updatePlane(){let e=this.virtualInput?.data;this.virtualInput&&e&&(UW.getNormalMatrix(this.virtualInput.matrixWorld),kW.copy(RW).applyMatrix3(UW).normalize(),this.virtualInput.localToWorld(BW.set(0,0,e.geometry.depth)),this.plane.setFromNormalAndCoplanarPoint(kW,BW))}setInputSelection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;this.htmlInput?.setSelectionRange(e,t),setTimeout((()=>{this.htmlInput?.focus()}))}updateTextInputStyles(){let e=this.virtualInput?.data;this.virtualInput&&e&&this.htmlInput&&(this.htmlInput.style.fontSize=e.geometry.fontSize+"px",this.htmlInput.style.letterSpacing=e.geometry.letterSpacing*e.geometry.fontSize+"px",this.htmlInput.style.lineHeight=e.geometry.fontSize*e.geometry.lineHeight+"px",this.htmlInput.style.width=e.geometry.width+"px",this.htmlInput.style.height=e.geometry.height+"px",this.htmlInput.style.textAlign=function(e){return 4===e?"justify":2===e?"right":3===e?"center":"left"}(e.geometry.horizontalAlign))}};var FW=(e,t)=>{if("string"==typeof e){let n=t.data(e);if(n)return FW(n.value,t)}return NE.getDisplayedValue(e)};function jW(e,t){let n=e.text,i="";if("string"==typeof n){let e=t.variables.data(i);e&&(i=FW(e.value,t.variables))}else i=n.textValue.toString();return i}var VW=class extends uV{constructor(e,t){super(e),this.eventManager=t,this._textInputs=[],this.sceneHelpers=new Ol,this.helper=new ik,this._onMouseDownFocusIn=e=>{if(Wv.length>1)return;this.eventContext.updateRaycaster(e);let t=null;if(this.eventContext.raycaster)for(let n of this._textInputs)if(this.eventContext.raycaster.intersectObject(n,!0).length>0){t=n;break}this.focusOnTextInput(t),this._onCaretUpdate(),this._onMouseUp(),this.textInputManager.doubleClickHandler.start(this.eventContext.domElement),this.textInputManager.doubleClickHandler._onMouseDown(e),this._onMouseDown(e)},this.onExit=()=>{let{virtualInput:e}=this.textInputManager;if(null===e)return;let t=this.textInputManager.htmlInput;this.helper.hide(),t?.setSelectionRange(t.value.length,t.value.length),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0);let{domElement:n}=this.eventContext;n.removeEventListener("pointerdown",this._onMouseDown,!1),n.removeEventListener("pointerup",this._onMouseUp,!1),n.removeEventListener("pointermove",this._onMouseMove,!1),window.removeEventListener("keydown",this._onKeyPress),this.textInputManager.doubleClickHandler.reset(),n.addEventListener("pointerdown",this._onMouseDownFocusIn),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers()},this._onMouseDown=e=>{this.eventContext.updateRaycaster(e),this.textInputManager.handleMouseDown(),this.textInputManager.virtualInput&&this.eventContext.raycaster.intersectObject(this.textInputManager.virtualInput,!0).length>0&&this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1)},this._onMouseUp=()=>{this.textInputManager.handleMouseUp(),this.eventManager.controlsManager.orbitControls&&!this.eventManager.controlsManager.orbitControls.enabled&&(this.eventManager.controlsManager.orbitControls.enabled=!0)},this._onMouseMove=e=>{this.eventContext.updateRaycaster(e),this.textInputManager.handleMouseMove()},this._onTextEdit=e=>{let{htmlInput:t,virtualInput:n,helper:i}=this.textInputManager;if(!t||!n)return;let r=t.value;n.textGeometry.setText(r).then((()=>{this.eventContext.requestRender()}));let s=n.data;i.update();let a=s.geometry.text;if("string"==typeof a){let e=a;this.eventContext.sharedAssets.updateVariable(e,{textValue:r})}this.textInputManager.updateTextInputStyles(),this._onCaretUpdate()},this._onCaretUpdate=e=>{this.textInputManager.handleCaretUpdate(e)},this._onKeyPress=e=>{"Escape"===e.key&&this.onExit()},this.textInputManager=new zW(this.sceneHelpers,e.raycaster,e.sharedAssets,e.requestRender,this.onExit)}connect(){let e=[];if(this.eventContext.scene.traverseEntity((t=>{t instanceof vB&&e.push(t)})),this._textInputs=e,0===e.length)return;let{domElement:t}=this.eventContext;t.addEventListener("pointerdown",this._onMouseDownFocusIn),this.textInputManager.connect();let n=this.textInputManager.createInput();document.body.appendChild(n),n.style.display="none",n.addEventListener("keyup",this._onCaretUpdate),n.addEventListener("keydown",this._onCaretUpdate),n.addEventListener("beforeinput",this._onCaretUpdate),n.addEventListener("paste",this._onCaretUpdate),n.addEventListener("cut",this._onCaretUpdate),n.addEventListener("select",this._onCaretUpdate),n.addEventListener("selectstart",this._onCaretUpdate)}disconnect(){let e=this.textInputManager.htmlInput,{domElement:t}=this.eventContext;t.removeEventListener("pointerdown",this._onMouseDownFocusIn),e?.removeEventListener("keyup",this._onCaretUpdate),e?.removeEventListener("keydown",this._onCaretUpdate),e?.removeEventListener("beforeinput",this._onCaretUpdate),e?.removeEventListener("paste",this._onCaretUpdate),e?.removeEventListener("cut",this._onCaretUpdate),e?.removeEventListener("select",this._onCaretUpdate),e?.removeEventListener("selectstart",this._onCaretUpdate),this._textInputs.forEach((e=>{let t=jW(e.data.geometry,this.eventContext.sharedAssets.data);e.textGeometry.setText(t)})),t.removeEventListener("pointerdown",this._onMouseDown,!1),t.removeEventListener("pointerup",this._onMouseUp,!1),t.removeEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers(),this.textInputManager.disconnect()}focusOnTextInput(e){this.textInputManager.focus(e),this.textInputManager.onTextMaterialChanged();let t=this.textInputManager.htmlInput;if(!t||null===e)return;this.textInputManager.updateTextInputStyles(),this.eventContext.renderer.sceneHelpersOnTop=this.sceneHelpers,this.eventContext.renderer.pipeline.enableHelpers(),this.textInputManager.isDragging=!1;let n=jW(e.textGeometry.userData.parameters,this.eventContext.sharedAssets.data);t.value=n,t.setSelectionRange(0,0),this.textInputManager.helper.show(e),t.style.display="block",t.addEventListener("input",this._onTextEdit),this.textInputManager.updatePlane();let{domElement:i}=this.eventContext;i.removeEventListener("pointerdown",this._onMouseDownFocusIn),i.addEventListener("pointerdown",this._onMouseDown,!1),i.addEventListener("pointerup",this._onMouseUp,!1),i.addEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress)}},HW=class extends uV{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onVoice=e=>{let{value:t,frequencies:n}=e;this.events.forEach((e=>{e.dispatch()}))}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity((e=>{e.data?.events.filter((e=>"AIAssistantListener"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new WW(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),this.openAIRealtime.on("voice",this.onVoice))}disconnect(){this.openAIRealtime?.off("voice",this.onVoice)}},WW=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.actions=uj(t,t.actions,i,r,s,n)}dispatch(){this.dispatchActions(this.actions)}dispatchActions(e){e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}},GW=class extends uV{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onTriggerEvent=e=>{let{description:t,direction:n}=e,i=this.events.find((e=>e.data.description===t));i&&("backward"===n?i.dispatchReverse():i.dispatch())}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity((e=>{e.data?.events.filter((e=>"AIAssistantTrigger"===e.data.type&&!e.data.disabled)).forEach((t=>{this.events.push(new qW(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))}))})),this.openAIRealtime.on("trigger_event",this.onTriggerEvent))}disconnect(){this.openAIRealtime?.off("trigger_event",this.onTriggerEvent)}},qW=class{constructor(e,t,n,i,r,s){this.id=e,this.data=t,this.object=n,this.actions=uj(t,t.actions,i,r,s,n)}dispatch(){let e=this.actions;e.Audio.forEach((e=>e.dispatchConditional())),e.Particles.forEach((e=>e.dispatchConditional())),e.Video.forEach((e=>e.dispatchConditional())),e.Create.forEach((e=>e.dispatch())),e.Destroy.forEach((e=>e.dispatch())),e.Reset.forEach((e=>e.dispatch())),e.Transition.forEach((e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()})),e.Transition.forEach((e=>e.play())),e.Animation.forEach((e=>e.play())),e.SwitchCamera.forEach((e=>e.play())),e.SceneTransition.forEach((e=>e.dispatch())),e.SetVariable.forEach((e=>e.checkConditions())),e.SetVariable.forEach((e=>e.dispatch())),e.DynamicVariablePlay.forEach((e=>e.dispatch())),e.ClearLocalStorage.forEach((e=>e.dispatch())),e.UserAPI.forEach((e=>e.dispatch()))}dispatchReverse(){let e=this.actions;e.Transition.forEach((e=>e.reverseFromCurrent())),e.Particles.forEach((e=>e.reverseFromCurrent())),e.Animation.forEach((e=>e.reverseFromCurrent())),e.SwitchCamera.forEach((e=>e.reverseFromCurrent())),e.Create.forEach((e=>e.dispatchStop()))}},KW=class{constructor(e,t,n,i,r){this.publish=e,this.controlsManager=t,this.animationControls=n,this.eventContext=i,this.sharedVariables=r,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=e=>{let t=window.parent!==window,n=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(e.touches.length>1||this.preventTouchScroll||!1===t&&!1===n)&&e.preventDefault()},this.onMouseWheelPreventScroll=e=>{this.preventScroll&&e.preventDefault()},this.onMouseMove=e=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(e),pressed:e.buttons>0}},this.onMouseDown=e=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(e),pressed:!0}},this.onMouseUp=e=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(e),pressed:!1}},this.getMousePosition=e=>{let{domRect:t}=this.eventContext,{pageX:n,pageY:i}=e.touches?.length>0?e.touches[0]:e;return{x:n-(t.left+window.scrollX),y:i-(t.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=i.requestRender}activate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new gV(this.eventContext),VariableChange:new SH(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),API:new IW(this.eventContext,this),WEBHOOK:new DW(this.eventContext,this),AIAssistantListener:new HW(this.eventContext,this),AIAssistantTrigger:new GW(this.eventContext,this),Conditional:new AV(this.eventContext,this),Start:new CH(this.eventContext,this),Basic:new yV(this.eventContext,this,this.needsRaycast),MouseHover:new yH(this.eventContext,this),Scroll:new xH(this.eventContext,this),Follow:new JV(this.eventContext,this),DragDrop:new VV(this.eventContext,this),LookAt:new pH(this.eventContext),Resize:new NW(this.eventContext,this),Textfields:new VW(this.eventContext,this)};let{page:t,domElement:n}=this.eventContext;this.hideCursor&&(n.style.cursor="none"),t.traverseEntity((e=>{e.addEventListener("requestRender",this.requestRender)})),Object.values(this.handlers).forEach((e=>e.connect())),n.addEventListener("wheel",this.onMouseWheelPreventScroll),n.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++,e||this.eventContext.sharedAssets.openAIRealtime?.connect()}deactivate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:t,domElement:n}=this.eventContext;n.style.cursor="",Object.values(this.handlers).forEach((e=>e.disconnect())),this.controlsManager.gameControl?.disposeActions(),this.controlsManager.disconnectEvents(),t.traverseEntity((e=>{e.removeEventListener("requestRender",this.requestRender),e.destroyedInAction=!1})),n.removeEventListener("touchmove",this.onTouchMovePreventScroll),n.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode(),e||this.eventContext.sharedAssets.openAIRealtime?.disconnect()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(!0),this.activate(!0),this.controlsManager.deactivate(),this.controlsManager.activate(this),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=n=>{if("Conditional"===n.data.type&&(n.data.ifActions.forEach(t),n.data.elseActions.forEach(t)),"Conditional"===n.data.type||"SetVariable"===n.data.type)for(let e of"Conditional"===n.data.type?n.data.condition:n.data.expression)"id"in e&&Array.isArray(e.id)&&("mouse"===e.id[0]&&(this.needsMouse=!0),"raycast"===e.id[0]&&(this.needsRaycast=!0));"DynamicVariablePlay"===n.data.type&&""!==n.data.variableId&&("Play"===n.data.mode||"PlayPause"===n.data.mode||"Toggle"===n.data.mode)&&e.setDynamicVariablePlayState(n.data.variableId,"Stopped")};this.eventContext.page.traverseEntity((e=>{if(e.data?.events.length)for(let n of e.data.events)if("VariableChange"===n.data.type&&("mouseProperty"===n.data.variableId&&(this.needsMouse=!0),"raycastProperty"===n.data.variableId&&(this.needsRaycast=!0)),"Conditional"===n.data.type)for(let e of["inActions","outActions"])n.data[e].forEach(t);else if("DragDrop"===n.data.type)for(let e of["drag","drop"])n.data.dragDropActions[e].forEach(t);else if("GameControl"===n.data.type)for(let e of["idle","move","jump","run"])n.data.gameActions[e].forEach(t);else if("Resize"===n.data.type)for(let e of n.data.breakpoints)e.data.actions.forEach(t);else"LookAt"===n.data.type||"API"===n.data.type||n.data.actions.forEach(t)}))}},YW=class{constructor(e,t,n,i,r){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=(new di).copy(n),this._editorSize=(new di).copy(i),this._aspect=t.aspect,this._fov=r??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||"PerspectiveCamera"!==this._camera.cameraType)return;let e=this._frameSize.x,t=this._frameSize.y,n=this._editorSize.y;this._aspect=e/t,t<=n&&(this._camera.zoom*=n/t),this._renderer.setViewport(0,0,e,t)}updateCamera(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._camera)if("PerspectiveCamera"===this._camera.cameraType){let t=this._frameSize.y,n=this._editorSize.y,i=this._fov;if(e&&t>n){let e=function(e,t,n,i,r){return(e-t)/(n-t)*(r-i)+i}(t,1080,2160,1,15)/100;i*=t/n,i*=1-e}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};var QW=class{get sharedAssets(){return this.shared}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.shared=new _O(e.shared,t,!0,n),this.scene=new AU(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof pB&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity((e=>{e instanceof DO&&e.markGeometryAsReachable(this.shared)})),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},XW=class{constructor(e){let{x:t=10,y:n=10}=e;this._startTime=0;let i=document.getElementById("spe-perfs");i?this.element=i:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${t}px`,this.element.style.top=`${n}px`}dispose(){this.element.parentElement?.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function ZW(e){let t;if(e.index)for(let n=0;n<e.index.array.length;n+=3)t=e.index.array[n],e.index.array[n]=e.index.array[n+2],e.index.array[n+2]=t}function JW(e){return e instanceof zO?"SubdivObject":"NonParametricGeometry"===e.geometry.type?"NonParametric":"Mesh"}function $W(e,t){let n=function(e,t){let n={};return e.traverseEntity((e=>{if(!e.visible||!(e instanceof $P)||"Mesh"!==e.type||Array.isArray(e.material)||e.states&&Object.keys(e.states).length)return;let i=e.parent;for(;i;){if(i instanceof $P&&e.states&&Object.keys(e.states).length)return;i=i.parent}let r=e.material.uuid,s=t.shared.materials[r];if(s){if(!Ux.isMergable(s))return}else{let n=t.scene.objects.get(e.uuid)?.data;if(n&&"material"in n&&"string"!=typeof n.material){if(!Ux.isMergable(n.material))return;r=Ux.getHash(n.material)}}n[r]||(n[r]={});let a=n[r][JW(e)];if(a){if(a.push(e),e.cloner)for(let t of e.cloner.children)a.push(t)}else if(n[r][JW(e)]=[e],e.cloner)for(let t of e.cloner.children)n[r][JW(e)].push(t)})),n}(t,e),i=function(e){let t=0;return Object.values(e).forEach((e=>{Object.values(e).forEach((e=>{let n=e.length;n>t&&(t=n)}))})),t}(n),r=new Array(i),s=0,a=new Array(i),o=0,l=new Array(i),c=0,h=new Array(i),u=0;for(let[d,p]of Object.entries(n))for(let e of Object.values(p)){if(o=0,c=0,e.forEach((e=>{e instanceof $P&&(a[o++]=e.geometry.clone(),l[c++]=e)})),c<2)continue;for(let e=0;e<c;e++)l[e].updateWorldMatrix(!0,!1),a[e].applyMatrix4(l[e].matrixWorld),l[e].matrixWorld.determinant()<0&&ZW(a[e]);let i=_C(a.slice(0,o),!1);if(i){let e;if("SubdivObject"===d)console.warn("Turning subdiv object into mesh"),e=new Ns(i,l[0].material);else e=new Ns(i,l[0].material);e.castShadow=l[0].castShadow,e.receiveShadow=l[0].receiveShadow,t.add(e);let a=e=>{u=0;for(let t of e)t.children&&a(t.children),t instanceof $P&&(Array.isArray(t.material)||n[t.material.uuid]&&n[t.material.uuid][JW(t)]&&n[t.material.uuid][JW(t)].length>1||(h[u++]=t));for(let n=0;n<u;n++)t.attach(h[n])};for(let t=0;t<c;t++){let e=l[t];a(e.children),r[s++]=e}}}for(let d=0;d<s;d++)r[d].removeFromParent()}var eG=Mt(Bt(),1),tG=new di;var nG=class{constructor(e){let{renderOnDemand:t,renderMode:n="auto"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=e=>{if(this.time=e,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,this._perfs?.start(),this._renderer)if(this._isPaused||!("manual"===this.renderMode&&!this._renderRequested||"auto"===this.renderMode&&this._skipRender)){if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&(this._eventManager.handlers?.Start.hasVideoAction||this._eventManager.handlers?.Basic.hasVideoAction||this._eventManager.handlers?.Conditional.hasVideoAction)&&(this._skipRender=!1),this._animationControls?.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,this._scene?.traverseVisibleEntity((e=>{"ParticleSystem"===e.type&&(e.update(this.dt),this._skipRender=!1)})),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),this._eventManager?.isEnabled&&((this._eventManager.handlers?.Follow).onAnimationFrameDamping(),(this._eventManager.handlers?.LookAt).onAnimationFrameDamping(),(this._eventManager.handlers?.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let e=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=e,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),this._perfs?.end()}else this._perfs?.end();else this._perfs?.end()},this._resize=e=>{if(this._renderer){if(1===this._viewportMode&&this._frameView&&(this._frameView.frameSize=tG.set(this._viewportWidth,this._viewportHeight)),e){let e=this._viewportWidth,t=this._viewportHeight;this._renderer.setSize(e-1,t-1,!1),this._renderer.setSize(e,t,!1)}else this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1);if(this._camera=this._scene?.activeCamera,this._scene?.updateViewPlaneSize(this._frameView?.frameSize?.x??this._viewportWidth,this._frameView?.frameSize?.y??this._viewportHeight,this._frameView?.enableResponsive??!1),this._camera){let e=Object.values(this._data?.frames??{})[0].preset??"fullscreen";this._frameView?.setCamera(this._camera),this._frameView?.updateCamera("fullscreen"!==e),"PerspectiveCamera"===this._camera.cameraType&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=mv(this._resize,10),this._onScroll=e=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":n,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new XW({x:10,y:10})),function(e){e.addEventListener("pointerdown",Yv,!0),e.addEventListener("pointerdown",Xv,!0),e.addEventListener("pointermove",Xv,!0),e.addEventListener("pointerup",Qv,!0),e.addEventListener("pointercancel",Qv,!0),e.addEventListener("pointerleave",Qv,!0),window.addEventListener("keydown",Jv,!0),window.addEventListener("keyup",$v,!0)}(e)}async load(e,t,n){(function(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)})(e),this.disposed=!1;let i=await(await fetch(e,n)).arrayBuffer();await this.start(i,{variables:t})}async start(e){let{interactive:t=!0,variables:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.disposed)return;let i=await async function(e,t){let[n,i]=Yy(gw.deserialize(new Uint8Array(e)));return SC(n),t&&t(n),i.result().data}(e);this._data=i;let r=function(e){let t=[];return e.scene.objects.traverse(((e,n)=>{"Mesh"===n.type&&"NonParametricGeometry"===n.geometry.type&&void 0!==n.geometry.data.draco&&t.push(n)})),t}(i);i.version&&(0,eG.default)(i.version,"1.9.87")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([r.length&&(xW||(xW=new SW).setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload(),xW.decoderPending),WD(i)&&kP(),UO(i)&&uP(),SE.physicsEnabled(i.scene.objects)&&oy(),rD(i)&&tO(),pU(i)&&wU(),KI(i)&&qI(),Ok(i)&&Ik(),RH(i)&&iy()].filter(Boolean)),r.length&&await async function(e){for(let t of e){let e=await TW(t.geometry.data.draco);if(e){let n=t.geometry.data;e.index&&(n.index={array:e.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let i={};e.attributes.forEach((e=>{let{name:t,array:n,itemSize:r}=e;i[t]={array:n,itemSize:r,type:"Float32Array",normalized:!1}})),n.attributes=i,n.draco=void 0}}}(r),this._eventManager?.deactivate(),this._controls?.deactivate(),this._scene?.dispose();let s=new QW(i);if(s.resetPersonalCameraFromDocumentData(),this._scene=s.scene,this._sharedAssetsManager=s.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let e=performance.now();$W(i,s.scene);let t=performance.now();console.log("Merged geometries in ",t-e," ms")}WD(i)&&this._scene.traverse((e=>{QD(e)&&e.recomputeBoolean()})),this._sharedAssetsManager.setRequestRender((()=>{this._requestRenderAutoMode(),this._scene?.traverse((e=>{e instanceof ED&&e.pendingMediaLoad&&e.update()}))})),this._scene?.traverse((e=>{"ParticleSystem"===e.type&&(e.wakeUp(),e.data.autoPlay?e.start():e.stop())}));let a=Object.keys(i.shared.fonts).map((e=>this._sharedAssetsManager.getFont(e).loadingPromise));if(Promise.all(a).then((()=>{s.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()})),rD(i)&&function(e){if(SE.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse(((e,n)=>{if(n.events)if(Array.isArray(n.events)){for(let i of n.events)if(!0!==i.data.disabled&&"GameControl"===i.data.type&&i.data.collisionEnabled){t=!0;break}}else for(let i of Object.values(n.events))if(!0!==i.disabled&&"GameControl"===i.type&&i.collisionEnabled){t=!0;break}})),t}(i)&&await Promise.all(a),Ok(i)){let e=[];this._scene.traverseEntity((t=>{(t instanceof CB||t instanceof pB)&&t.uiCanvas&&e.push(t.uiCanvas)})),await Promise.all(e.map((e=>e.promise)))}if(this._scene.rewriteEventsBeforeGoToPlayMode(),HF(this._scene.activePage,this._sharedAssetsManager),!this._renderer&&(this._renderer=new JR({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=!0===i.scene.publish.hdTransmission,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode),i.shared.images.SplineWatermark)){let e=this._sharedAssetsManager.getImage("SplineWatermark");await e.loadPromise;let t=e.getTexture(1001);this._renderer.pipeline.setWatermark(t)}pU(i)&&this._scene.initializeSplatViewer(),void 0!==i.scene.blueNoiseTextureData&&this._renderer.pipeline.updateBlueNoiseTexture(i.scene.blueNoiseTextureData);let o=Object.values(i.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):("fullscreen"===o.preset?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=o.size[0],this._viewportHeight=o.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new YW(this._renderer,this._camera,new di(this._viewportWidth,this._viewportHeight),new di(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(o.allowResponsive??!1)&&"fullscreen"===o.preset),t){let e=new hV(this._renderer,this.data.scene.publish,this._scene,(()=>this._scene.activeCamera),this._sharedAssetsManager,this._requestRenderAutoMode,!0,o);this._scene.updateMatrixWorld(!0),this._controls=new bW(e),this._animationControls=new CW(this._scene,this._requestRenderAutoMode),this._eventManager=new KW(i.scene.publish,this._controls,this._animationControls,e,i.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this._scene.activePage.data.postprocessing.depthOfField.enabled&&Promise.all(this._sharedAssetsManager.getImageLoadPromises()).then((()=>{this._resize(!0)})),void 0!==n&&this.setVariables(n),0===this.dt&&(this.render(performance.now()),setTimeout((()=>{this._renderer?.setAnimationLoop(this.render)}),0)),this._resizeObserverTimeout=setTimeout((()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver((()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()})),this._resizeObserver.observe(this.canvas.parentElement))}),300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(void 0!==this._data){let t=Object.entries(e);for(let[e,n]of t)this.setVariable(e,n)}}setVariable(e,t){let n=this._getVariableByName(e);if(n&&!("dynamicVariableType"in n.data)){let e=t;"number"==typeof n.data.value?e="number"==typeof t?t:"boolean"==typeof t?!0===t?1:0:parseFloat(t):"boolean"==typeof n.data.value?e="number"==typeof t?!!t:"boolean"==typeof t?t:"false"!==t.toLocaleLowerCase()&&!!t:"string"!=typeof n.data.value&&void 0!==n.data.value.textValue&&(e=t.toString());let i="string"==typeof e?{textValue:e}:e;this._sharedAssetsManager?.updateVariable(n.id,i),this.requestRender(),this._requestRenderAutoMode()}else void 0===n?console.warn(`No variable named ${e} was found in your Spline file. Make sure to create it from Spline editor.`):"dynamicVariableType"in n.data&&console.warn(`Dynamic variables like ${e} cannot be updated from code.`)}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach((t=>{void 0===e[t.data.name]&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))})),e}getVariable(e){let t=this._getVariableByName(e);if(t){let e=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(e)}}_getVariableValue(e){return"string"!=typeof e&&NE.isTextValue(e)?NE.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find((t=>t.data.name===e));return t&&this._variablesCache.set(e,t),t}}findObjectById(e){let t=this._scene?.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){let t=this._scene?.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){let e=[];return this._scene?.traverseEntity((t=>{if(t.uuid!==gx&&!this._scene.isInvisibleObjects(t)&&!(t instanceof pB)){let n=this._createProxyObject(t);n&&e.push(n)}})),e}getSplineEvents(){return(this._eventManager?.handlers?.Spline).splineEvents}emitEvent(e,t){(this.findObjectById(t)||this.findObjectByName(t))?.emitEvent(e)}emitEventReverse(e,t){(this.findObjectById(t)||this.findObjectByName(t))?.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){this._controls?.orbitControls instanceof ZH&&this._controls?.orbitControls.setZoom(e)}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){let{r:t,g:n,b:i,a:r}={r:0,g:0,b:0,a:1},s=new lM(t,n,i,r);try{s.setStyle(e)}catch{console.error("This is not a valid css color",e)}this._scene?.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){this.disposed=!0,this._eventManager?.deactivate(),this._scene?.dispose(),this._sharedAssetsManager?.dispose(),this._proxyObjectCache.forEach((e=>{_d.unsubscribe(e)})),this._variablesCache.clear(),this._renderer?.setAnimationLoop(null),this._renderer?.dispose(),this._renderer=void 0,this._sharedAssetsManager?.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),void 0!==this._resizeObserverTimeout&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),this._controls?.deactivate(),this.dt=0,function(e){e.removeEventListener("pointerdown",Yv,!0),e.removeEventListener("pointerdown",Xv,!0),e.removeEventListener("pointermove",Xv,!0),e.removeEventListener("pointerup",Qv,!0),e.removeEventListener("pointercancel",Qv,!0),e.removeEventListener("pointerleave",Qv,!0),window.removeEventListener("keydown",Jv,!0),window.removeEventListener("keyup",$v,!0)}(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){this._isPaused||(this._renderer?.setAnimationLoop(null),this._isPaused=!0,this._eventManager?.pause(),this._controls?.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){!this._isPaused||(this._isPaused=!1,this._eventManager?.resume(),this._controls?.orbitControls&&(this._controls.orbitControls.enabled=!0),this._renderer?.setAnimationLoop(this.render))}setGlobalEvents(e){this._eventManager?.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){if(null==e)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors((e=>{e instanceof pB&&(t=e.name)}));let n={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof pB||e instanceof AU?void 0:e.parent?.uuid,emitEvent(t){e.dispatchEvent({type:"userEvent",eventName:t})},emitEventReverse(t){e.dispatchEvent({type:"userEvent",eventName:t,reverse:!0})}},i=_d(n,((t,n)=>{"object"!=typeof e[t]&&Object.getOwnPropertyDescriptor(e,t)?.writable&&(e[t]=n),this._requestRenderAutoMode(),e.updateMatrix()}));return this._proxyObjectCache.set(e.uuid,i),i}setUIWasmUrl(e){RN.skiaWasmUrl=e}},iG=n(10446);function rG(e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}const sG=[],aG={width:"100%",height:"100%"},oG=(0,t.forwardRef)((function(e,n){let{className:i,children:r,debounceTime:s=300,ignoreDimensions:a=sG,parentSizeStyles:o,enableDebounceLeadingCall:l=!0,resizeObserverPolyfill:c,...h}=e;const u=(0,t.useRef)(null),d=(0,t.useRef)(0),[p,f]=(0,t.useState)({width:0,height:0,top:0,left:0}),m=(0,t.useMemo)((()=>{const e=Array.isArray(a)?a:[a];return iG((t=>{f((n=>Object.keys(n).filter((e=>n[e]!==t[e])).every((t=>e.includes(t)))?n:t))}),s,{leading:l})}),[s,l,a]);return(0,t.useEffect)((()=>{const e=new(c||window.ResizeObserver)((e=>{e.forEach((e=>{const{left:t,top:n,width:i,height:r}=(null==e?void 0:e.contentRect)??{};d.current=window.requestAnimationFrame((()=>{m({width:i,height:r,top:n,left:t})}))}))}));return u.current&&e.observe(u.current),()=>{window.cancelAnimationFrame(d.current),e.disconnect(),m.cancel()}}),[m,c]),(0,gt.jsx)("div",{style:{...aG,...o},ref:rG([n,u]),className:i,...h,children:r({...p,ref:u.current,resize:m})})})),lG=(0,t.forwardRef)(((e,n)=>{let{scene:i,style:r,onSplineMouseDown:s,onSplineMouseUp:a,onSplineMouseHover:o,onSplineKeyDown:l,onSplineKeyUp:c,onSplineStart:h,onSplineLookAt:u,onSplineFollow:d,onSplineScroll:p,onLoad:f,renderOnDemand:m=!0,children:g,...v}=e;const y=(0,t.useRef)(null),[b,w]=(0,t.useState)(!0),[x,E]=(0,t.useState)();if(x)throw x;return(0,t.useEffect)((()=>{let e;w(!0);const t=[{name:"mouseDown",cb:s},{name:"mouseUp",cb:a},{name:"mouseHover",cb:o},{name:"keyDown",cb:l},{name:"keyUp",cb:c},{name:"start",cb:h},{name:"lookAt",cb:u},{name:"follow",cb:d},{name:"scroll",cb:p}];if(y.current){async function n(){await e.load(i);for(let n of t)n.cb&&e.addEventListener(n.name,n.cb);w(!1),null==f||f(e)}e=new nG(y.current,{renderOnDemand:m}),n().catch((e=>{E(e)}))}return()=>{for(let n of t)n.cb&&e.removeEventListener(n.name,n.cb);e.dispose()}}),[i]),(0,gt.jsx)(oG,{ref:n,parentSizeStyles:{overflow:"hidden",...r},debounceTime:50,...v,children:()=>(0,gt.jsxs)(gt.Fragment,{children:[b&&g,(0,gt.jsx)("canvas",{ref:y,style:{display:b?"none":"block"}})]})})})),cG="data:image/png;base64,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",hG=n.p+"static/media/etherscan.f3e9a4514e5fb8f0fbce.png",uG=n.p+"static/media/polygon.45d6b83b0df75d851923.png",dG=n.p+"static/media/bscscan.e8990125bf0d749c5464.png",pG="data:image/png;base64,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",fG="data:image/png;base64,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",mG=()=>(0,gt.jsx)(gt.Fragment,{children:(0,gt.jsxs)("div",{className:"container-fluid px-0",children:[(0,gt.jsx)(xt,{}),(0,gt.jsxs)("div",{className:"position-relative",children:[(0,gt.jsxs)("div",{className:"position-absolute hero-text",children:[(0,gt.jsxs)("div",{className:"custom-border rounded-pill w-auto d-flex align-items-center p-2 w-75 mx-auto mx-md-0 w-md-50",children:[(0,gt.jsx)("div",{className:"ms-3 badge rounded-pill text-bg-primary text-white",children:"New"}),(0,gt.jsx)("p",{className:"m-0 ps-3",children:"Join the revolution now \ud83d\udd25"})]}),(0,gt.jsx)("h1",{className:"fw-bold g-text text-center text-md-start pt-4",children:"Onewave The Multi-Chain"}),(0,gt.jsx)("h1",{className:"fw-bold g-text text-center text-md-start",children:"Multi-Utility Platform"}),(0,gt.jsx)("h1",{className:"fw-bold g-text text-center text-md-start",children:"For The Wab-3 World"}),(0,gt.jsxs)("p",{className:" text-center text-md-start",style:{color:"#4d4d4d"},children:["Cutting-edge multichain, multi-utility cryptocurrency platform designed to provide ",(0,gt.jsx)("br",{})," users with a comprehensive suite of blockchain-based tools and services."]}),(0,gt.jsxs)("div",{className:"d-flex gap-3",children:[(0,gt.jsxs)("button",{className:"btn btn-primary px-5 py-3",children:[(0,gt.jsx)("i",{className:"fa-solid fa-cart-shopping"})," Presale"]}),(0,gt.jsxs)("button",{className:"btn btn-light  px-5 py-3",children:[(0,gt.jsx)("i",{class:"fa-solid fa-boxes-stacked"})," Staking"]})]})]}),(0,gt.jsx)(lG,{className:"spline",scene:"https://prod.spline.design/4VdDkNqrkM2jk2GG/scene.splinecode"})]}),(0,gt.jsxs)("div",{className:"community",children:[(0,gt.jsx)("div",{className:"community2",children:(0,gt.jsxs)("div",{className:"frame-44",children:[(0,gt.jsxs)("div",{className:"frame-34",children:[(0,gt.jsx)("h2",{className:"section-heading",children:"Join the community"}),(0,gt.jsxs)("div",{className:"frame-33",children:[(0,gt.jsx)("div",{className:"icon-box black-box",children:(0,gt.jsx)("img",{src:"data:image/png;base64,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",alt:"Community icon 1"})}),(0,gt.jsx)("div",{className:"icon-box blue-box",children:(0,gt.jsx)("img",{src:"data:image/png;base64,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",alt:"Community icon 2"})}),(0,gt.jsx)("div",{className:"icon-box white-box",children:(0,gt.jsx)("img",{src:cG,alt:"Community icon 3"})}),(0,gt.jsx)("div",{className:"icon-box white-box",children:(0,gt.jsx)("img",{src:cG,alt:"Community icon 4"})})]})]}),(0,gt.jsxs)("div",{className:"frame-42",children:[(0,gt.jsx)("h2",{className:"section-heading",children:"We are listed on"}),(0,gt.jsxs)("div",{className:"frame-41",children:[(0,gt.jsxs)("div",{className:"logo-row",children:[(0,gt.jsx)("div",{className:"logo-box logo-box-lg",children:(0,gt.jsx)("img",{src:hG,alt:"Listing 1"})}),(0,gt.jsx)("div",{className:"logo-box logo-box-lg",children:(0,gt.jsx)("img",{src:uG,alt:"Listing 2"})}),(0,gt.jsx)("div",{className:"logo-box logo-box-lg",children:(0,gt.jsx)("img",{src:dG,alt:"Listing 3"})})]}),(0,gt.jsxs)("div",{className:"logo-row",children:[(0,gt.jsx)("div",{className:"logo-box logo-box-md",children:(0,gt.jsx)("img",{src:pG,alt:"Listing 4"})}),(0,gt.jsx)("div",{className:"logo-box logo-box-sm",children:(0,gt.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAdCAYAAABhXag7AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAR8SURBVHgB7VrNbttGEJ5dUoEAqQB7zCnytShQSn6AWk8QtZWT3mo/geMnkPUErp+g8q2AXJS5tSfrCSReeo5y6rECYgNCJO50Zin+yaJjHSIsFX4Aof37uMsdzuzMUAAlSpQoUcJQWFBia7Tqry6fP/vmr+fPvnX+/fjP32AwBOwIbr17pAsoZv790IeCwq3+3JB28C6qK4Smyc8jYUeQIG7DC86gyKjOZ4gw5aL+rSymYDB2JuB9gT/zZhhYbdLcU6wsmlwHg2GD4XCrnQb/+nNvugXts/L8+e/cN4ACwEgBu7VjVwrRIyN4RFWH21r1Y0CAEQL2/bub0UYenfMCRI8cCzfNI1fDU8uP53lCy+HNaEJPBYv+Oo/6/iTz7JIHM53cDdtgMIwz0Ye1V79IARMSbgdWmx2BBHDE5zh5sb11HrdxH49Z5/G9pF15tyXPoQlPmOfSmjJ3oz4hoMEXGA6jBMyahAIHXKZNpLMN++ylrq7TyLmh9otW7fWbiNeqHZ9w2wMeYJuuPui2kOd+9VNnI4/urRDP1XJxwDzyj6+icZLWFEcBBYNRJpqC8ktclWnD25P7m3T44VOIMhJ2QNrN2qV6rtMZrJwcrZksXFwumpOsSR2RyffIKtwyTyp5Sb/eqq+3mmuKwaKdMsVTzat3PdZubmATzm1QMBijwXzuIghXVxAGm2LL0LnBSLMcuZAdrVkrUynozNx0zob3Ute6QmOZc8iavOLRi9HfyAvPei+kwVGz+uMLKBiMEbAlVSMqK6ne5o1TKLy4ImRDIrhxn8DrPB6dl6OozBxE4aa68xMVCPFahAVGO1SbYIyAUcnEwaFsV+7AwJqlxr0g1XLgCQjS9yQOmeVGXA2C//J49NJMocAwMtEhMdHmB7CXSZ/A96RhKcHhk4TNHNLoaVy1rK8hdy0pCyGF0UmNTTBGwCqwRnFFZMxnBhJFHLKQdvlKJOZV4lN54KuUw0ReciePR2v5Pi4vgsLl0I0RMDtQGG+6PGOna32MbqPYlMvs+fof/vDYEUrCJ3EWZaIyvNChSnjsPNlLFtbsMd5h7TXnzbXwKcEy2jYrZgJ2HyYJ4WyKKbWgKGalcET3cbKD4tSBdpzI9Eq0vqNtjmNflOo8Lgs8FWE441BiYkLJi4ECctQ0jzQQRcID+EHPR+GVW+v2KWN2qXlW5bZV615pi8A8JV+iUCcrDoVfy1MoIHb2uZDSe/hY//huqNdCWnpCwv0tbxxvtkDsj+9vfs3ev3sBYaz6CA/Ox/fDwbY8jsnTYVuzfhxmvugcH38YHoDB2JmJ1smER65oHG3kQC2tA0S8TreHGSp1xYmMdeEyxnc3FyEv4UTzJryscLM8mg8Shy3kYR/txcGDmBzxfbhu8z3snWnwLsFWgB6spx9OoEcO1du8DxT7jr0RMKUtHbm036TbSCNfCog9a9JOMaJ8c7/I/yjZFsZ/D34y5lUH7CBzlq69vY7+qgQBZ6a+GAGX/+jYc+yPBlfnM7W0P50rrqgvRntLlChRooTR+B8CVzmTneFx+wAAAABJRU5ErkJggg==",alt:"Listing 5"})}),(0,gt.jsx)("div",{className:"logo-box logo-box-xl",children:(0,gt.jsx)("img",{src:fG,alt:"Listing 6"})}),(0,gt.jsx)("div",{className:"logo-box logo-box-lg",children:(0,gt.jsx)("img",{src:"data:image/png;base64,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",alt:"Listing 7"})})]})]})]}),(0,gt.jsxs)("div",{className:"frame-43",children:[(0,gt.jsx)("h2",{className:"section-heading",children:"Audited By"}),(0,gt.jsxs)("div",{className:"frame-41",children:[(0,gt.jsxs)("div",{className:"logo-row",children:[(0,gt.jsx)("div",{className:"logo-box logo-box-lg",children:(0,gt.jsx)("img",{src:uG,alt:"Auditor 1"})}),(0,gt.jsx)("div",{className:"logo-box logo-box-lg",children:(0,gt.jsx)("img",{src:dG,alt:"Auditor 2"})})]}),(0,gt.jsxs)("div",{className:"logo-row",children:[(0,gt.jsx)("div",{className:"logo-box logo-box-lg",children:(0,gt.jsx)("img",{src:pG,alt:"Auditor 3"})}),(0,gt.jsx)("div",{className:"logo-box logo-box-lg",children:(0,gt.jsx)("img",{src:fG,alt:"Auditor 4"})})]})]})]})]})}),(0,gt.jsx)("img",{className:"frame-101",src:"/images/bottom-frame.svg",alt:"Bottom frame"})]})]})}),gG=e=>{let{setshowSideNav:t,showSideNav:n}=e;const i=ee();return(0,gt.jsx)(gt.Fragment,{children:(0,gt.jsx)("nav",{class:"navbar navbar-expand-lg blur-bg-2",children:(0,gt.jsxs)("div",{class:"container position-relative z-2",children:[(0,gt.jsx)("img",{onClick:()=>i("/"),src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAAyCAMAAAAuj2TTAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAvRQTFRFAAAA////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////ScVxIwAAAPx0Uk5TAAEeKCclBwUjEQIfDjo5FRA4NgwUMwgLKYfr6ONLQt/pjiLO6tgxFsb18/aMIdLxXoWxMOT0968G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",alt:"Wave Logo",style:{maxWidth:"120px"},className:"img-fluid"}),(0,gt.jsx)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,gt.jsx)("span",{class:"navbar-toggler-icon"})}),(0,gt.jsxs)("div",{class:"collapse navbar-collapse",id:"navbarSupportedContent",children:[(0,gt.jsxs)("ul",{class:"navbar-nav ms-auto mb-2 mb-lg-0",children:[(0,gt.jsxs)("li",{class:"nav-item dropdown px-2",children:[(0,gt.jsx)("a",{class:"nav-link dropdown-toggle nav-text",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"Utilities"}),(0,gt.jsxs)("ul",{class:"dropdown-menu",children:[(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Action"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Another action"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("hr",{class:"dropdown-divider"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Something else here"})})]})]}),(0,gt.jsxs)("li",{class:"nav-item dropdown px-2",children:[(0,gt.jsx)("a",{class:"nav-link dropdown-toggle nav-text",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"Resources"}),(0,gt.jsxs)("ul",{class:"dropdown-menu",children:[(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Action"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Another action"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("hr",{class:"dropdown-divider"})}),(0,gt.jsx)("li",{children:(0,gt.jsx)("a",{class:"dropdown-item",href:"#",children:"Something else here"})})]})]}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link nav-text",href:"#",children:"Lern"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)(_e,{class:"nav-link nav-text",to:"/presale",children:"Presele"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link nav-text",href:"#",children:"Staking"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link nav-text",href:"#",children:"Roadmap"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link nav-text",href:"#",children:"Tokenomics"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link nav-text",href:"#",children:"Team"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link nav-text",href:"#",children:"Downloads"})}),(0,gt.jsx)("li",{class:"nav-item px-2",children:(0,gt.jsx)("a",{class:"nav-link nav-text",href:"#",children:"Contact"})})]}),(0,gt.jsx)("button",{class:"rounded-2 custom-login px-4 py-2",type:"submit",onClick:()=>i("/signin"),children:"Login"})]})]})})})},vG=n.p+"static/media/aemethish.8df45932362434d1fd0f.png",yG=n.p+"static/media/emrald.11300494d046550203cd.png",bG=n.p+"static/media/iron.52de4a45f55053d85be7.png",wG=n.p+"static/media/ore.e9fe2d134f5944cae7dc.png",xG=n.p+"static/media/ruby.0ba10916d548a393ef28.png",EG=n.p+"static/media/capsule.c589068ea86533427638.png",CG=n.p+"static/media/stare.e5e30e93670903a7c9f0.png",AG=n.p+"static/media/dimoand.356b4e6d95b9fa324795.png",SG=n.p+"static/media/gold.f818b4bc704efd5b65d6.png",_G=n.p+"static/media/lapis.8c0737816a8c8295bb6b.png",TG=n.p+"static/media/wave.715739dc5ffc7b154442.png",PG=n.p+"static/media/bluejems.d5b60b5f5600ecc47a32.png",MG=n.p+"static/media/bluestone.c7cb9b69253c9d64c0c0.png",NG=e=>{let{show:t,onClose:n}=e;return(0,gt.jsx)(gt.Fragment,{})};var IG=n(24657),OG=n(80883),DG=n(25347),LG=n(73939),RG=n(93022),kG=n(79323),BG=n(84657),UG=n(44098),zG=n(16496),FG=n(595),jG=n(15814),VG=n(42661),HG=n(36141),WG=n(88861),GG=n(63542),qG=n(99251),KG=n(32819);const YG={UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${"undefined"!==typeof window?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},SOCIALS_TIMEOUT:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}}};var QG=n(38993),XG=n(76844);const ZG={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0},JG=(0,QG.BX)({providers:{...ZG},providerIds:{...ZG}}),$G={state:JG,subscribeKey:(e,t)=>(0,XG.u$)(JG,e,t),subscribe:e=>(0,QG.B1)(JG,(()=>{e(JG)})),subscribeProviders:e=>(0,QG.B1)(JG.providers,(()=>e(JG.providers))),setProvider(e,t){t&&(JG.providers[e]=(0,QG.KR)(t))},getProvider:e=>JG.providers[e],setProviderId(e,t){t&&(JG.providerIds[e]=t)},getProviderId(e){if(e)return JG.providerIds[e]},reset(){JG.providers={...ZG},JG.providerIds={...ZG}},resetChain(e){JG.providers[e]=void 0,JG.providerIds[e]=void 0}};var eq,tq,nq=n(22538),iq=n(59979);!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!==typeof t[t[e]])),i={};for(const e of n)i[e]=t[e];return e.objectValues(i)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"===typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"===typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"===typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" | ";return e.map((e=>"string"===typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"===typeof t?t.toString():t}(eq||(eq={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(tq||(tq={}));const rq=eq.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),sq=e=>{switch(typeof e){case"undefined":return rq.undefined;case"string":return rq.string;case"number":return isNaN(e)?rq.nan:rq.number;case"boolean":return rq.boolean;case"function":return rq.function;case"bigint":return rq.bigint;case"symbol":return rq.symbol;case"object":return Array.isArray(e)?rq.array:null===e?rq.null:e.then&&"function"===typeof e.then&&e.catch&&"function"===typeof e.catch?rq.promise:"undefined"!==typeof Map&&e instanceof Map?rq.map:"undefined"!==typeof Set&&e instanceof Set?rq.set:"undefined"!==typeof Date&&e instanceof Date?rq.date:rq.object;default:return rq.unknown}},aq=eq.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class oq extends Error{constructor(e){var t;super(),t=this,this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.issues=[...t.issues,...e]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},n={_errors:[]},i=e=>{for(const r of e.issues)if("invalid_union"===r.code)r.unionErrors.map(i);else if("invalid_return_type"===r.code)i(r.returnTypeError);else if("invalid_arguments"===r.code)i(r.argumentsError);else if(0===r.path.length)n._errors.push(t(r));else{let e=n,i=0;for(;i<r.path.length;){const n=r.path[i];i===r.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(r))):e[n]=e[n]||{_errors:[]},e=e[n],i++}}};return i(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,eq.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e.message;const t={},n=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}oq.create=e=>new oq(e);const lq=(e,t)=>{let n;switch(e.code){case aq.invalid_type:n=e.received===rq.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case aq.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,eq.jsonStringifyReplacer)}`;break;case aq.unrecognized_keys:n=`Unrecognized key(s) in object: ${eq.joinValues(e.keys,", ")}`;break;case aq.invalid_union:n="Invalid input";break;case aq.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${eq.joinValues(e.options)}`;break;case aq.invalid_enum_value:n=`Invalid enum value. Expected ${eq.joinValues(e.options)}, received '${e.received}'`;break;case aq.invalid_arguments:n="Invalid function arguments";break;case aq.invalid_return_type:n="Invalid function return type";break;case aq.invalid_date:n="Invalid date";break;case aq.invalid_string:"object"===typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"===typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:eq.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case aq.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case aq.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case aq.custom:n="Invalid input";break;case aq.invalid_intersection_types:n="Intersection results could not be merged";break;case aq.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case aq.not_finite:n="Number must be finite";break;default:n=t.defaultError,eq.assertNever(e)}return{message:n}};let cq=lq;function hq(){return cq}const uq=e=>{const{data:t,path:n,errorMaps:i,issueData:r}=e,s=[...n,...r.path||[]],a={...r,path:s};let o="";const l=i.filter((e=>!!e)).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...r,path:s,message:r.message||o}};function dq(e,t){const n=uq({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,hq(),lq].filter((e=>!!e))});e.common.issues.push(n)}class pq{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const i of t){if("aborted"===i.status)return fq;"dirty"===i.status&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const i of t)n.push({key:await i.key,value:await i.value});return pq.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const i of t){const{key:t,value:r}=i;if("aborted"===t.status)return fq;if("aborted"===r.status)return fq;"dirty"===t.status&&e.dirty(),"dirty"===r.status&&e.dirty(),"__proto__"===t.value||"undefined"===typeof r.value&&!i.alwaysSet||(n[t.value]=r.value)}return{status:e.value,value:n}}}const fq=Object.freeze({status:"aborted"}),mq=e=>({status:"dirty",value:e}),gq=e=>({status:"valid",value:e}),vq=e=>"aborted"===e.status,yq=e=>"dirty"===e.status,bq=e=>"valid"===e.status,wq=e=>"undefined"!==typeof Promise&&e instanceof Promise;var xq;!function(e){e.errToObj=e=>"string"===typeof e?{message:e}:e||{},e.toString=e=>"string"===typeof e?e:null===e||void 0===e?void 0:e.message}(xq||(xq={}));class Eq{constructor(e,t,n,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Cq=(e,t)=>{if(bq(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new oq(e.common.issues);return this._error=t,this._error}}};function Aq(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:i,description:r}=e;if(t&&(n||i))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:r};return{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:"undefined"===typeof t.data?{message:null!==i&&void 0!==i?i:t.defaultError}:{message:null!==n&&void 0!==n?n:t.defaultError},description:r}}class Sq{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return sq(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:sq(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new pq,ctx:{common:e.parent.common,data:e.data,parsedType:sq(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(wq(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const i={common:{issues:[],async:null!==(n=null===t||void 0===t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null===t||void 0===t?void 0:t.errorMap},path:(null===t||void 0===t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:sq(e)},r=this._parseSync({data:e,path:i.path,parent:i});return Cq(i,r)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null===t||void 0===t?void 0:t.errorMap,async:!0},path:(null===t||void 0===t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:sq(e)},i=this._parse({data:e,path:n.path,parent:n}),r=await(wq(i)?i:Promise.resolve(i));return Cq(n,r)}refine(e,t){const n=e=>"string"===typeof t||"undefined"===typeof t?{message:t}:"function"===typeof t?t(e):t;return this._refinement(((t,i)=>{const r=e(t),s=()=>i.addIssue({code:aq.custom,...n(t)});return"undefined"!==typeof Promise&&r instanceof Promise?r.then((e=>!!e||(s(),!1))):!!r||(s(),!1)}))}refinement(e,t){return this._refinement(((n,i)=>!!e(n)||(i.addIssue("function"===typeof t?t(n,i):t),!1)))}_refinement(e){return new pK({schema:this,typeName:SK.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return fK.create(this,this._def)}nullable(){return mK.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Yq.create(this,this._def)}promise(){return dK.create(this,this._def)}or(e){return Zq.create([this,e],this._def)}and(e){return tK.create(this,e,this._def)}transform(e){return new pK({...Aq(this._def),schema:this,typeName:SK.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"===typeof e?e:()=>e;return new gK({...Aq(this._def),innerType:this,defaultValue:t,typeName:SK.ZodDefault})}brand(){return new wK({typeName:SK.ZodBranded,type:this,...Aq(this._def)})}catch(e){const t="function"===typeof e?e:()=>e;return new vK({...Aq(this._def),innerType:this,catchValue:t,typeName:SK.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return xK.create(this,e)}readonly(){return EK.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const _q=/^c[^\s-]{8,}$/i,Tq=/^[a-z][a-z0-9]*$/,Pq=/^[0-9A-HJKMNP-TV-Z]{26}$/,Mq=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Nq=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let Iq;const Oq=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Dq=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;function Lq(e,t){return!("v4"!==t&&t||!Oq.test(e))||!("v6"!==t&&t||!Dq.test(e))}class Rq extends Sq{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==rq.string){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.string,received:t.parsedType}),fq}const t=new pq;let n;for(const r of this._def.checks)if("min"===r.kind)e.data.length<r.value&&(n=this._getOrReturnCtx(e,n),dq(n,{code:aq.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),t.dirty());else if("max"===r.kind)e.data.length>r.value&&(n=this._getOrReturnCtx(e,n),dq(n,{code:aq.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),t.dirty());else if("length"===r.kind){const i=e.data.length>r.value,s=e.data.length<r.value;(i||s)&&(n=this._getOrReturnCtx(e,n),i?dq(n,{code:aq.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):s&&dq(n,{code:aq.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),t.dirty())}else if("email"===r.kind)Nq.test(e.data)||(n=this._getOrReturnCtx(e,n),dq(n,{validation:"email",code:aq.invalid_string,message:r.message}),t.dirty());else if("emoji"===r.kind)Iq||(Iq=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Iq.test(e.data)||(n=this._getOrReturnCtx(e,n),dq(n,{validation:"emoji",code:aq.invalid_string,message:r.message}),t.dirty());else if("uuid"===r.kind)Mq.test(e.data)||(n=this._getOrReturnCtx(e,n),dq(n,{validation:"uuid",code:aq.invalid_string,message:r.message}),t.dirty());else if("cuid"===r.kind)_q.test(e.data)||(n=this._getOrReturnCtx(e,n),dq(n,{validation:"cuid",code:aq.invalid_string,message:r.message}),t.dirty());else if("cuid2"===r.kind)Tq.test(e.data)||(n=this._getOrReturnCtx(e,n),dq(n,{validation:"cuid2",code:aq.invalid_string,message:r.message}),t.dirty());else if("ulid"===r.kind)Pq.test(e.data)||(n=this._getOrReturnCtx(e,n),dq(n,{validation:"ulid",code:aq.invalid_string,message:r.message}),t.dirty());else if("url"===r.kind)try{new URL(e.data)}catch(cC){n=this._getOrReturnCtx(e,n),dq(n,{validation:"url",code:aq.invalid_string,message:r.message}),t.dirty()}else if("regex"===r.kind){r.regex.lastIndex=0;r.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),dq(n,{validation:"regex",code:aq.invalid_string,message:r.message}),t.dirty())}else if("trim"===r.kind)e.data=e.data.trim();else if("includes"===r.kind)e.data.includes(r.value,r.position)||(n=this._getOrReturnCtx(e,n),dq(n,{code:aq.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),t.dirty());else if("toLowerCase"===r.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===r.kind)e.data=e.data.toUpperCase();else if("startsWith"===r.kind)e.data.startsWith(r.value)||(n=this._getOrReturnCtx(e,n),dq(n,{code:aq.invalid_string,validation:{startsWith:r.value},message:r.message}),t.dirty());else if("endsWith"===r.kind)e.data.endsWith(r.value)||(n=this._getOrReturnCtx(e,n),dq(n,{code:aq.invalid_string,validation:{endsWith:r.value},message:r.message}),t.dirty());else if("datetime"===r.kind){((i=r).precision?i.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${i.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${i.precision}}Z$`):0===i.precision?i.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):i.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(e.data)||(n=this._getOrReturnCtx(e,n),dq(n,{code:aq.invalid_string,validation:"datetime",message:r.message}),t.dirty())}else"ip"===r.kind?Lq(e.data,r.version)||(n=this._getOrReturnCtx(e,n),dq(n,{validation:"ip",code:aq.invalid_string,message:r.message}),t.dirty()):eq.assertNever(r);var i;return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:aq.invalid_string,...xq.errToObj(n)})}_addCheck(e){return new Rq({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...xq.errToObj(e)})}url(e){return this._addCheck({kind:"url",...xq.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...xq.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...xq.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...xq.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...xq.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...xq.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...xq.errToObj(e)})}datetime(e){var t;return"string"===typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision,offset:null!==(t=null===e||void 0===e?void 0:e.offset)&&void 0!==t&&t,...xq.errToObj(null===e||void 0===e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...xq.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null===t||void 0===t?void 0:t.position,...xq.errToObj(null===t||void 0===t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...xq.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...xq.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...xq.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...xq.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...xq.errToObj(t)})}nonempty(e){return this.min(1,xq.errToObj(e))}trim(){return new Rq({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Rq({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Rq({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function kq(e,t){const n=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,r=n>i?n:i;return parseInt(e.toFixed(r).replace(".",""))%parseInt(t.toFixed(r).replace(".",""))/Math.pow(10,r)}Rq.create=e=>{var t;return new Rq({checks:[],typeName:SK.ZodString,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t,...Aq(e)})};class Bq extends Sq{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==rq.number){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.number,received:t.parsedType}),fq}let t;const n=new pq;for(const i of this._def.checks)if("int"===i.kind)eq.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),dq(t,{code:aq.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty());else if("min"===i.kind){(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),dq(t,{code:aq.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty())}else if("max"===i.kind){(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),dq(t,{code:aq.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty())}else"multipleOf"===i.kind?0!==kq(e.data,i.value)&&(t=this._getOrReturnCtx(e,t),dq(t,{code:aq.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),dq(t,{code:aq.not_finite,message:i.message}),n.dirty()):eq.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,xq.toString(t))}gt(e,t){return this.setLimit("min",e,!1,xq.toString(t))}lte(e,t){return this.setLimit("max",e,!0,xq.toString(t))}lt(e,t){return this.setLimit("max",e,!1,xq.toString(t))}setLimit(e,t,n,i){return new Bq({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:xq.toString(i)}]})}_addCheck(e){return new Bq({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:xq.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:xq.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:xq.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:xq.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:xq.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:xq.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:xq.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:xq.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:xq.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&eq.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Bq.create=e=>new Bq({checks:[],typeName:SK.ZodNumber,coerce:(null===e||void 0===e?void 0:e.coerce)||!1,...Aq(e)});class Uq extends Sq{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==rq.bigint){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.bigint,received:t.parsedType}),fq}let t;const n=new pq;for(const i of this._def.checks)if("min"===i.kind){(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),dq(t,{code:aq.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty())}else if("max"===i.kind){(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),dq(t,{code:aq.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty())}else"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),dq(t,{code:aq.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):eq.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,xq.toString(t))}gt(e,t){return this.setLimit("min",e,!1,xq.toString(t))}lte(e,t){return this.setLimit("max",e,!0,xq.toString(t))}lt(e,t){return this.setLimit("max",e,!1,xq.toString(t))}setLimit(e,t,n,i){return new Uq({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:xq.toString(i)}]})}_addCheck(e){return new Uq({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:xq.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:xq.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:xq.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:xq.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:xq.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Uq.create=e=>{var t;return new Uq({checks:[],typeName:SK.ZodBigInt,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t,...Aq(e)})};class zq extends Sq{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==rq.boolean){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.boolean,received:t.parsedType}),fq}return gq(e.data)}}zq.create=e=>new zq({typeName:SK.ZodBoolean,coerce:(null===e||void 0===e?void 0:e.coerce)||!1,...Aq(e)});class Fq extends Sq{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==rq.date){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.date,received:t.parsedType}),fq}if(isNaN(e.data.getTime())){return dq(this._getOrReturnCtx(e),{code:aq.invalid_date}),fq}const t=new pq;let n;for(const i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),dq(n,{code:aq.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),t.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),dq(n,{code:aq.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),t.dirty()):eq.assertNever(i);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Fq({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:xq.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:xq.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}Fq.create=e=>new Fq({checks:[],coerce:(null===e||void 0===e?void 0:e.coerce)||!1,typeName:SK.ZodDate,...Aq(e)});class jq extends Sq{_parse(e){if(this._getType(e)!==rq.symbol){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.symbol,received:t.parsedType}),fq}return gq(e.data)}}jq.create=e=>new jq({typeName:SK.ZodSymbol,...Aq(e)});class Vq extends Sq{_parse(e){if(this._getType(e)!==rq.undefined){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.undefined,received:t.parsedType}),fq}return gq(e.data)}}Vq.create=e=>new Vq({typeName:SK.ZodUndefined,...Aq(e)});class Hq extends Sq{_parse(e){if(this._getType(e)!==rq.null){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.null,received:t.parsedType}),fq}return gq(e.data)}}Hq.create=e=>new Hq({typeName:SK.ZodNull,...Aq(e)});class Wq extends Sq{constructor(){super(...arguments),this._any=!0}_parse(e){return gq(e.data)}}Wq.create=e=>new Wq({typeName:SK.ZodAny,...Aq(e)});class Gq extends Sq{constructor(){super(...arguments),this._unknown=!0}_parse(e){return gq(e.data)}}Gq.create=e=>new Gq({typeName:SK.ZodUnknown,...Aq(e)});class qq extends Sq{_parse(e){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.never,received:t.parsedType}),fq}}qq.create=e=>new qq({typeName:SK.ZodNever,...Aq(e)});class Kq extends Sq{_parse(e){if(this._getType(e)!==rq.undefined){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.void,received:t.parsedType}),fq}return gq(e.data)}}Kq.create=e=>new Kq({typeName:SK.ZodVoid,...Aq(e)});class Yq extends Sq{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),i=this._def;if(t.parsedType!==rq.array)return dq(t,{code:aq.invalid_type,expected:rq.array,received:t.parsedType}),fq;if(null!==i.exactLength){const e=t.data.length>i.exactLength.value,r=t.data.length<i.exactLength.value;(e||r)&&(dq(t,{code:e?aq.too_big:aq.too_small,minimum:r?i.exactLength.value:void 0,maximum:e?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(null!==i.minLength&&t.data.length<i.minLength.value&&(dq(t,{code:aq.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),null!==i.maxLength&&t.data.length>i.maxLength.value&&(dq(t,{code:aq.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>i.type._parseAsync(new Eq(t,e,t.path,n))))).then((e=>pq.mergeArray(n,e)));const r=[...t.data].map(((e,n)=>i.type._parseSync(new Eq(t,e,t.path,n))));return pq.mergeArray(n,r)}get element(){return this._def.type}min(e,t){return new Yq({...this._def,minLength:{value:e,message:xq.toString(t)}})}max(e,t){return new Yq({...this._def,maxLength:{value:e,message:xq.toString(t)}})}length(e,t){return new Yq({...this._def,exactLength:{value:e,message:xq.toString(t)}})}nonempty(e){return this.min(1,e)}}function Qq(e){if(e instanceof Xq){const t={};for(const n in e.shape){const i=e.shape[n];t[n]=fK.create(Qq(i))}return new Xq({...e._def,shape:()=>t})}return e instanceof Yq?new Yq({...e._def,type:Qq(e.element)}):e instanceof fK?fK.create(Qq(e.unwrap())):e instanceof mK?mK.create(Qq(e.unwrap())):e instanceof nK?nK.create(e.items.map((e=>Qq(e)))):e}Yq.create=(e,t)=>new Yq({type:e,minLength:null,maxLength:null,exactLength:null,typeName:SK.ZodArray,...Aq(t)});class Xq extends Sq{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=eq.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==rq.object){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.object,received:t.parsedType}),fq}const{status:t,ctx:n}=this._processInputParams(e),{shape:i,keys:r}=this._getCached(),s=[];if(!(this._def.catchall instanceof qq&&"strip"===this._def.unknownKeys))for(const o in n.data)r.includes(o)||s.push(o);const a=[];for(const o of r){const e=i[o],t=n.data[o];a.push({key:{status:"valid",value:o},value:e._parse(new Eq(n,t,n.path,o)),alwaysSet:o in n.data})}if(this._def.catchall instanceof qq){const e=this._def.unknownKeys;if("passthrough"===e)for(const t of s)a.push({key:{status:"valid",value:t},value:{status:"valid",value:n.data[t]}});else if("strict"===e)s.length>0&&(dq(n,{code:aq.unrecognized_keys,keys:s}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of s){const i=n.data[t];a.push({key:{status:"valid",value:t},value:e._parse(new Eq(n,i,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of a){const n=await t.key;e.push({key:n,value:await t.value,alwaysSet:t.alwaysSet})}return e})).then((e=>pq.mergeObjectSync(t,e))):pq.mergeObjectSync(t,a)}get shape(){return this._def.shape()}strict(e){return xq.errToObj,new Xq({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var i,r,s,a;const o=null!==(s=null===(r=(i=this._def).errorMap)||void 0===r?void 0:r.call(i,t,n).message)&&void 0!==s?s:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(a=xq.errToObj(e).message)&&void 0!==a?a:o}:{message:o}}}:{}})}strip(){return new Xq({...this._def,unknownKeys:"strip"})}passthrough(){return new Xq({...this._def,unknownKeys:"passthrough"})}extend(e){return new Xq({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Xq({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:SK.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Xq({...this._def,catchall:e})}pick(e){const t={};return eq.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new Xq({...this._def,shape:()=>t})}omit(e){const t={};return eq.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new Xq({...this._def,shape:()=>t})}deepPartial(){return Qq(this)}partial(e){const t={};return eq.objectKeys(this.shape).forEach((n=>{const i=this.shape[n];e&&!e[n]?t[n]=i:t[n]=i.optional()})),new Xq({...this._def,shape:()=>t})}required(e){const t={};return eq.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof fK;)e=e._def.innerType;t[n]=e}})),new Xq({...this._def,shape:()=>t})}keyof(){return cK(eq.objectKeys(this.shape))}}Xq.create=(e,t)=>new Xq({shape:()=>e,unknownKeys:"strip",catchall:qq.create(),typeName:SK.ZodObject,...Aq(t)}),Xq.strictCreate=(e,t)=>new Xq({shape:()=>e,unknownKeys:"strict",catchall:qq.create(),typeName:SK.ZodObject,...Aq(t)}),Xq.lazycreate=(e,t)=>new Xq({shape:e,unknownKeys:"strip",catchall:qq.create(),typeName:SK.ZodObject,...Aq(t)});class Zq extends Sq{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const i of e)if("dirty"===i.result.status)return t.common.issues.push(...i.ctx.common.issues),i.result;const n=e.map((e=>new oq(e.ctx.common.issues)));return dq(t,{code:aq.invalid_union,unionErrors:n}),fq}));{let e;const i=[];for(const s of n){const n={...t,common:{...t.common,issues:[]},parent:null},r=s._parseSync({data:t.data,path:t.path,parent:n});if("valid"===r.status)return r;"dirty"!==r.status||e||(e={result:r,ctx:n}),n.common.issues.length&&i.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const r=i.map((e=>new oq(e)));return dq(t,{code:aq.invalid_union,unionErrors:r}),fq}}get options(){return this._def.options}}Zq.create=(e,t)=>new Zq({options:e,typeName:SK.ZodUnion,...Aq(t)});const Jq=e=>e instanceof oK?Jq(e.schema):e instanceof pK?Jq(e.innerType()):e instanceof lK?[e.value]:e instanceof hK?e.options:e instanceof uK?Object.keys(e.enum):e instanceof gK?Jq(e._def.innerType):e instanceof Vq?[void 0]:e instanceof Hq?[null]:null;class $q extends Sq{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==rq.object)return dq(t,{code:aq.invalid_type,expected:rq.object,received:t.parsedType}),fq;const n=this.discriminator,i=t.data[n],r=this.optionsMap.get(i);return r?t.common.async?r._parseAsync({data:t.data,path:t.path,parent:t}):r._parseSync({data:t.data,path:t.path,parent:t}):(dq(t,{code:aq.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),fq)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const i=new Map;for(const r of t){const t=Jq(r.shape[e]);if(!t)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const n of t){if(i.has(n))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);i.set(n,r)}}return new $q({typeName:SK.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...Aq(n)})}}function eK(e,t){const n=sq(e),i=sq(t);if(e===t)return{valid:!0,data:e};if(n===rq.object&&i===rq.object){const n=eq.objectKeys(t),i=eq.objectKeys(e).filter((e=>-1!==n.indexOf(e))),r={...e,...t};for(const s of i){const n=eK(e[s],t[s]);if(!n.valid)return{valid:!1};r[s]=n.data}return{valid:!0,data:r}}if(n===rq.array&&i===rq.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<e.length;i++){const r=eK(e[i],t[i]);if(!r.valid)return{valid:!1};n.push(r.data)}return{valid:!0,data:n}}return n===rq.date&&i===rq.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}class tK extends Sq{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=(e,i)=>{if(vq(e)||vq(i))return fq;const r=eK(e.value,i.value);return r.valid?((yq(e)||yq(i))&&t.dirty(),{status:t.value,value:r.data}):(dq(n,{code:aq.invalid_intersection_types}),fq)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((e=>{let[t,n]=e;return i(t,n)})):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}tK.create=(e,t,n)=>new tK({left:e,right:t,typeName:SK.ZodIntersection,...Aq(n)});class nK extends Sq{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==rq.array)return dq(n,{code:aq.invalid_type,expected:rq.array,received:n.parsedType}),fq;if(n.data.length<this._def.items.length)return dq(n,{code:aq.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),fq;!this._def.rest&&n.data.length>this._def.items.length&&(dq(n,{code:aq.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map(((e,t)=>{const i=this._def.items[t]||this._def.rest;return i?i._parse(new Eq(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(i).then((e=>pq.mergeArray(t,e))):pq.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new nK({...this._def,rest:e})}}nK.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new nK({items:e,typeName:SK.ZodTuple,rest:null,...Aq(t)})};class iK extends Sq{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==rq.object)return dq(n,{code:aq.invalid_type,expected:rq.object,received:n.parsedType}),fq;const i=[],r=this._def.keyType,s=this._def.valueType;for(const a in n.data)i.push({key:r._parse(new Eq(n,a,n.path,a)),value:s._parse(new Eq(n,n.data[a],n.path,a))});return n.common.async?pq.mergeObjectAsync(t,i):pq.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,n){return new iK(t instanceof Sq?{keyType:e,valueType:t,typeName:SK.ZodRecord,...Aq(n)}:{keyType:Rq.create(),valueType:e,typeName:SK.ZodRecord,...Aq(t)})}}class rK extends Sq{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==rq.map)return dq(n,{code:aq.invalid_type,expected:rq.map,received:n.parsedType}),fq;const i=this._def.keyType,r=this._def.valueType,s=[...n.data.entries()].map(((e,t)=>{let[s,a]=e;return{key:i._parse(new Eq(n,s,n.path,[t,"key"])),value:r._parse(new Eq(n,a,n.path,[t,"value"]))}}));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of s){const i=await n.key,r=await n.value;if("aborted"===i.status||"aborted"===r.status)return fq;"dirty"!==i.status&&"dirty"!==r.status||t.dirty(),e.set(i.value,r.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of s){const i=n.key,r=n.value;if("aborted"===i.status||"aborted"===r.status)return fq;"dirty"!==i.status&&"dirty"!==r.status||t.dirty(),e.set(i.value,r.value)}return{status:t.value,value:e}}}}rK.create=(e,t,n)=>new rK({valueType:t,keyType:e,typeName:SK.ZodMap,...Aq(n)});class sK extends Sq{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==rq.set)return dq(n,{code:aq.invalid_type,expected:rq.set,received:n.parsedType}),fq;const i=this._def;null!==i.minSize&&n.data.size<i.minSize.value&&(dq(n,{code:aq.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),null!==i.maxSize&&n.data.size>i.maxSize.value&&(dq(n,{code:aq.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const r=this._def.valueType;function s(e){const n=new Set;for(const i of e){if("aborted"===i.status)return fq;"dirty"===i.status&&t.dirty(),n.add(i.value)}return{status:t.value,value:n}}const a=[...n.data.values()].map(((e,t)=>r._parse(new Eq(n,e,n.path,t))));return n.common.async?Promise.all(a).then((e=>s(e))):s(a)}min(e,t){return new sK({...this._def,minSize:{value:e,message:xq.toString(t)}})}max(e,t){return new sK({...this._def,maxSize:{value:e,message:xq.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}sK.create=(e,t)=>new sK({valueType:e,minSize:null,maxSize:null,typeName:SK.ZodSet,...Aq(t)});class aK extends Sq{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==rq.function)return dq(t,{code:aq.invalid_type,expected:rq.function,received:t.parsedType}),fq;function n(e,n){return uq({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,hq(),lq].filter((e=>!!e)),issueData:{code:aq.invalid_arguments,argumentsError:n}})}function i(e,n){return uq({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,hq(),lq].filter((e=>!!e)),issueData:{code:aq.invalid_return_type,returnTypeError:n}})}const r={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof dK){const e=this;return gq((async function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];const l=new oq([]),c=await e._def.args.parseAsync(a,r).catch((e=>{throw l.addIssue(n(a,e)),l})),h=await Reflect.apply(s,this,c),u=await e._def.returns._def.type.parseAsync(h,r).catch((e=>{throw l.addIssue(i(h,e)),l}));return u}))}{const e=this;return gq((function(){for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];const l=e._def.args.safeParse(a,r);if(!l.success)throw new oq([n(a,l.error)]);const c=Reflect.apply(s,this,l.data),h=e._def.returns.safeParse(c,r);if(!h.success)throw new oq([i(c,h.error)]);return h.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new aK({...this._def,args:nK.create(t).rest(Gq.create())})}returns(e){return new aK({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new aK({args:e||nK.create([]).rest(Gq.create()),returns:t||Gq.create(),typeName:SK.ZodFunction,...Aq(n)})}}class oK extends Sq{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}oK.create=(e,t)=>new oK({getter:e,typeName:SK.ZodLazy,...Aq(t)});class lK extends Sq{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return dq(t,{received:t.data,code:aq.invalid_literal,expected:this._def.value}),fq}return{status:"valid",value:e.data}}get value(){return this._def.value}}function cK(e,t){return new hK({values:e,typeName:SK.ZodEnum,...Aq(t)})}lK.create=(e,t)=>new lK({value:e,typeName:SK.ZodLiteral,...Aq(t)});class hK extends Sq{_parse(e){if("string"!==typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return dq(t,{expected:eq.joinValues(n),received:t.parsedType,code:aq.invalid_type}),fq}if(-1===this._def.values.indexOf(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return dq(t,{received:t.data,code:aq.invalid_enum_value,options:n}),fq}return gq(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return hK.create(e)}exclude(e){return hK.create(this.options.filter((t=>!e.includes(t))))}}hK.create=cK;class uK extends Sq{_parse(e){const t=eq.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==rq.string&&n.parsedType!==rq.number){const e=eq.objectValues(t);return dq(n,{expected:eq.joinValues(e),received:n.parsedType,code:aq.invalid_type}),fq}if(-1===t.indexOf(e.data)){const e=eq.objectValues(t);return dq(n,{received:n.data,code:aq.invalid_enum_value,options:e}),fq}return gq(e.data)}get enum(){return this._def.values}}uK.create=(e,t)=>new uK({values:e,typeName:SK.ZodNativeEnum,...Aq(t)});class dK extends Sq{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==rq.promise&&!1===t.common.async)return dq(t,{code:aq.invalid_type,expected:rq.promise,received:t.parsedType}),fq;const n=t.parsedType===rq.promise?t.data:Promise.resolve(t.data);return gq(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}dK.create=(e,t)=>new dK({type:e,typeName:SK.ZodPromise,...Aq(t)});class pK extends Sq{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===SK.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=this._def.effect||null,r={addIssue:e=>{dq(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(r.addIssue=r.addIssue.bind(r),"preprocess"===i.type){const e=i.transform(n.data,r);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(e).then((e=>this._def.schema._parseAsync({data:e,path:n.path,parent:n}))):this._def.schema._parseSync({data:e,path:n.path,parent:n})}if("refinement"===i.type){const e=e=>{const t=i.refinement(e,r);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===i.status?fq:("dirty"===i.status&&t.dirty(),e(i.value),{status:t.value,value:i.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?fq:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===i.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!bq(e))return e;const s=i.transform(e.value,r);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>bq(e)?Promise.resolve(i.transform(e.value,r)).then((e=>({status:t.value,value:e}))):e))}eq.assertNever(i)}}pK.create=(e,t,n)=>new pK({schema:e,typeName:SK.ZodEffects,effect:t,...Aq(n)}),pK.createWithPreprocess=(e,t,n)=>new pK({schema:t,effect:{type:"preprocess",transform:e},typeName:SK.ZodEffects,...Aq(n)});class fK extends Sq{_parse(e){return this._getType(e)===rq.undefined?gq(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}fK.create=(e,t)=>new fK({innerType:e,typeName:SK.ZodOptional,...Aq(t)});class mK extends Sq{_parse(e){return this._getType(e)===rq.null?gq(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}mK.create=(e,t)=>new mK({innerType:e,typeName:SK.ZodNullable,...Aq(t)});class gK extends Sq{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===rq.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}gK.create=(e,t)=>new gK({innerType:e,typeName:SK.ZodDefault,defaultValue:"function"===typeof t.default?t.default:()=>t.default,...Aq(t)});class vK extends Sq{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return wq(i)?i.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new oq(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new oq(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}vK.create=(e,t)=>new vK({innerType:e,typeName:SK.ZodCatch,catchValue:"function"===typeof t.catch?t.catch:()=>t.catch,...Aq(t)});class yK extends Sq{_parse(e){if(this._getType(e)!==rq.nan){const t=this._getOrReturnCtx(e);return dq(t,{code:aq.invalid_type,expected:rq.nan,received:t.parsedType}),fq}return{status:"valid",value:e.data}}}yK.create=e=>new yK({typeName:SK.ZodNaN,...Aq(e)});const bK=Symbol("zod_brand");class wK extends Sq{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class xK extends Sq{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?fq:"dirty"===e.status?(t.dirty(),mq(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?fq:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new xK({in:e,out:t,typeName:SK.ZodPipeline})}}class EK extends Sq{_parse(e){const t=this._def.innerType._parse(e);return bq(t)&&(t.value=Object.freeze(t.value)),t}}EK.create=(e,t)=>new EK({innerType:e,typeName:SK.ZodReadonly,...Aq(t)});const CK=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return e?Wq.create().superRefine(((i,r)=>{var s,a;if(!e(i)){const e="function"===typeof t?t(i):"string"===typeof t?{message:t}:t,o=null===(a=null!==(s=e.fatal)&&void 0!==s?s:n)||void 0===a||a,l="string"===typeof e?{message:e}:e;r.addIssue({code:"custom",...l,fatal:o})}})):Wq.create()},AK={object:Xq.lazycreate};var SK;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(SK||(SK={}));const _K=Rq.create,TK=Bq.create,PK=yK.create,MK=Uq.create,NK=zq.create,IK=Fq.create,OK=jq.create,DK=Vq.create,LK=Hq.create,RK=Wq.create,kK=Gq.create,BK=qq.create,UK=Kq.create,zK=Yq.create,FK=Xq.create,jK=Xq.strictCreate,VK=Zq.create,HK=$q.create,WK=tK.create,GK=nK.create,qK=iK.create,KK=rK.create,YK=sK.create,QK=aK.create,XK=oK.create,ZK=lK.create,JK=hK.create,$K=uK.create,eY=dK.create,tY=pK.create,nY=fK.create,iY=mK.create,rY=pK.createWithPreprocess,sY=xK.create,aY={string:e=>Rq.create({...e,coerce:!0}),number:e=>Bq.create({...e,coerce:!0}),boolean:e=>zq.create({...e,coerce:!0}),bigint:e=>Uq.create({...e,coerce:!0}),date:e=>Fq.create({...e,coerce:!0})},oY=fq;var lY=Object.freeze({__proto__:null,defaultErrorMap:lq,setErrorMap:function(e){cq=e},getErrorMap:hq,makeIssue:uq,EMPTY_PATH:[],addIssueToContext:dq,ParseStatus:pq,INVALID:fq,DIRTY:mq,OK:gq,isAborted:vq,isDirty:yq,isValid:bq,isAsync:wq,get util(){return eq},get objectUtil(){return tq},ZodParsedType:rq,getParsedType:sq,ZodType:Sq,ZodString:Rq,ZodNumber:Bq,ZodBigInt:Uq,ZodBoolean:zq,ZodDate:Fq,ZodSymbol:jq,ZodUndefined:Vq,ZodNull:Hq,ZodAny:Wq,ZodUnknown:Gq,ZodNever:qq,ZodVoid:Kq,ZodArray:Yq,ZodObject:Xq,ZodUnion:Zq,ZodDiscriminatedUnion:$q,ZodIntersection:tK,ZodTuple:nK,ZodRecord:iK,ZodMap:rK,ZodSet:sK,ZodFunction:aK,ZodLazy:oK,ZodLiteral:lK,ZodEnum:hK,ZodNativeEnum:uK,ZodPromise:dK,ZodEffects:pK,ZodTransformer:pK,ZodOptional:fK,ZodNullable:mK,ZodDefault:gK,ZodCatch:vK,ZodNaN:yK,BRAND:bK,ZodBranded:wK,ZodPipeline:xK,ZodReadonly:EK,custom:CK,Schema:Sq,ZodSchema:Sq,late:AK,get ZodFirstPartyTypeKind(){return SK},coerce:aY,any:RK,array:zK,bigint:MK,boolean:NK,date:IK,discriminatedUnion:HK,effect:tY,enum:JK,function:QK,instanceof:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{message:`Input not instance of ${e.name}`};return CK((t=>t instanceof e),t)},intersection:WK,lazy:XK,literal:ZK,map:KK,nan:PK,nativeEnum:$K,never:BK,null:LK,nullable:iY,number:TK,object:FK,oboolean:()=>NK().optional(),onumber:()=>TK().optional(),optional:nY,ostring:()=>_K().optional(),pipeline:sY,preprocess:rY,promise:eY,record:qK,set:YK,strictObject:jK,string:_K,symbol:OK,transformer:tY,tuple:GK,undefined:DK,union:VK,unknown:kK,void:UK,NEVER:oY,ZodIssueCode:aq,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:oq});const cY=lY.object({message:lY.string()});function hY(e){return lY.literal(iq.s1[e])}lY.object({accessList:lY.array(lY.string()),blockHash:lY.string().nullable(),blockNumber:lY.string().nullable(),chainId:lY.string().or(lY.number()),from:lY.string(),gas:lY.string(),hash:lY.string(),input:lY.string().nullable(),maxFeePerGas:lY.string(),maxPriorityFeePerGas:lY.string(),nonce:lY.string(),r:lY.string(),s:lY.string(),to:lY.string(),transactionIndex:lY.string().nullable(),type:lY.string(),v:lY.string(),value:lY.string()});const uY=lY.object({chainId:lY.string().or(lY.number())}),dY=lY.object({email:lY.string().email()}),pY=lY.object({otp:lY.string()}),fY=lY.object({uri:lY.string()}),mY=lY.object({chainId:lY.optional(lY.string().or(lY.number())),preferredAccountType:lY.optional(lY.string())}),gY=lY.object({provider:lY.enum(["google","github","apple","facebook","x","discord"])}),vY=lY.object({email:lY.string().email()}),yY=lY.object({otp:lY.string()}),bY=lY.object({otp:lY.string()}),wY=lY.object({themeMode:lY.optional(lY.enum(["light","dark"])),themeVariables:lY.optional(lY.record(lY.string(),lY.string().or(lY.number()))),w3mThemeVariables:lY.optional(lY.record(lY.string(),lY.string()))}),xY=lY.object({metadata:lY.object({name:lY.string(),description:lY.string(),url:lY.string(),icons:lY.array(lY.string())}).optional(),sdkVersion:lY.string().optional(),sdkType:lY.string().optional(),projectId:lY.string()}),EY=lY.object({type:lY.string()}),CY=lY.object({action:lY.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),AY=lY.object({url:lY.string()}),SY=lY.object({userName:lY.string()}),_Y=lY.object({email:lY.string().optional().nullable(),address:lY.string(),chainId:lY.string().or(lY.number()),accounts:lY.array(lY.object({address:lY.string(),type:lY.enum([iq.Vl.ACCOUNT_TYPES.EOA,iq.Vl.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:lY.string().optional().nullable()}),TY=lY.object({action:lY.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),PY=lY.object({email:lY.string().email().optional().nullable(),address:lY.string(),chainId:lY.string().or(lY.number()),smartAccountDeployed:lY.optional(lY.boolean()),accounts:lY.array(lY.object({address:lY.string(),type:lY.enum([iq.Vl.ACCOUNT_TYPES.EOA,iq.Vl.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:lY.optional(lY.string())}),MY=lY.object({uri:lY.string()}),NY=lY.object({isConnected:lY.boolean()}),IY=lY.object({chainId:lY.string().or(lY.number())}),OY=lY.object({chainId:lY.string().or(lY.number())}),DY=lY.object({newEmail:lY.string().email()}),LY=lY.object({smartAccountEnabledNetworks:lY.array(lY.number())}),RY=(lY.object({address:lY.string(),isDeployed:lY.boolean()}),lY.object({version:lY.string().optional()})),kY=lY.object({type:lY.string(),address:lY.string()}),BY=lY.any(),UY=lY.object({method:lY.literal("eth_accounts")}),zY=lY.object({method:lY.literal("eth_blockNumber")}),FY=lY.object({method:lY.literal("eth_call"),params:lY.array(lY.any())}),jY=lY.object({method:lY.literal("eth_chainId")}),VY=lY.object({method:lY.literal("eth_estimateGas"),params:lY.array(lY.any())}),HY=lY.object({method:lY.literal("eth_feeHistory"),params:lY.array(lY.any())}),WY=lY.object({method:lY.literal("eth_gasPrice")}),GY=lY.object({method:lY.literal("eth_getAccount"),params:lY.array(lY.any())}),qY=lY.object({method:lY.literal("eth_getBalance"),params:lY.array(lY.any())}),KY=lY.object({method:lY.literal("eth_getBlockByHash"),params:lY.array(lY.any())}),YY=lY.object({method:lY.literal("eth_getBlockByNumber"),params:lY.array(lY.any())}),QY=lY.object({method:lY.literal("eth_getBlockReceipts"),params:lY.array(lY.any())}),XY=lY.object({method:lY.literal("eth_getBlockTransactionCountByHash"),params:lY.array(lY.any())}),ZY=lY.object({method:lY.literal("eth_getBlockTransactionCountByNumber"),params:lY.array(lY.any())}),JY=lY.object({method:lY.literal("eth_getCode"),params:lY.array(lY.any())}),$Y=lY.object({method:lY.literal("eth_getFilterChanges"),params:lY.array(lY.any())}),eQ=lY.object({method:lY.literal("eth_getFilterLogs"),params:lY.array(lY.any())}),tQ=lY.object({method:lY.literal("eth_getLogs"),params:lY.array(lY.any())}),nQ=lY.object({method:lY.literal("eth_getProof"),params:lY.array(lY.any())}),iQ=lY.object({method:lY.literal("eth_getStorageAt"),params:lY.array(lY.any())}),rQ=lY.object({method:lY.literal("eth_getTransactionByBlockHashAndIndex"),params:lY.array(lY.any())}),sQ=lY.object({method:lY.literal("eth_getTransactionByBlockNumberAndIndex"),params:lY.array(lY.any())}),aQ=lY.object({method:lY.literal("eth_getTransactionByHash"),params:lY.array(lY.any())}),oQ=lY.object({method:lY.literal("eth_getTransactionCount"),params:lY.array(lY.any())}),lQ=lY.object({method:lY.literal("eth_getTransactionReceipt"),params:lY.array(lY.any())}),cQ=lY.object({method:lY.literal("eth_getUncleCountByBlockHash"),params:lY.array(lY.any())}),hQ=lY.object({method:lY.literal("eth_getUncleCountByBlockNumber"),params:lY.array(lY.any())}),uQ=lY.object({method:lY.literal("eth_maxPriorityFeePerGas")}),dQ=lY.object({method:lY.literal("eth_newBlockFilter")}),pQ=lY.object({method:lY.literal("eth_newFilter"),params:lY.array(lY.any())}),fQ=lY.object({method:lY.literal("eth_newPendingTransactionFilter")}),mQ=lY.object({method:lY.literal("eth_sendRawTransaction"),params:lY.array(lY.any())}),gQ=lY.object({method:lY.literal("eth_syncing"),params:lY.array(lY.any())}),vQ=lY.object({method:lY.literal("eth_uninstallFilter"),params:lY.array(lY.any())}),yQ=lY.object({method:lY.literal("personal_sign"),params:lY.array(lY.any())}),bQ=lY.object({method:lY.literal("eth_signTypedData_v4"),params:lY.array(lY.any())}),wQ=lY.object({method:lY.literal("eth_sendTransaction"),params:lY.array(lY.any())}),xQ=lY.object({method:lY.literal("solana_signMessage"),params:lY.object({message:lY.string(),pubkey:lY.string()})}),EQ=lY.object({method:lY.literal("solana_signTransaction"),params:lY.object({transaction:lY.string()})}),CQ=lY.object({method:lY.literal("solana_signAllTransactions"),params:lY.object({transactions:lY.array(lY.string())})}),AQ=lY.object({method:lY.literal("solana_signAndSendTransaction"),params:lY.object({transaction:lY.string(),options:lY.object({skipPreflight:lY.boolean().optional(),preflightCommitment:lY.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:lY.number().optional(),minContextSlot:lY.number().optional()}).optional()})}),SQ=lY.object({method:lY.literal("wallet_sendCalls"),params:lY.array(lY.object({chainId:lY.string().or(lY.number()).optional(),from:lY.string().optional(),version:lY.string().optional(),capabilities:lY.any().optional(),calls:lY.array(lY.object({to:lY.string().startsWith("0x"),data:lY.string().startsWith("0x").optional(),value:lY.string().optional()}))}))}),_Q=lY.object({method:lY.literal("wallet_getCallsStatus"),params:lY.array(lY.string())}),TQ=lY.object({method:lY.literal("wallet_getCapabilities")}),PQ=lY.object({method:lY.literal("wallet_grantPermissions"),params:lY.array(lY.any())}),MQ=lY.object({method:lY.literal("wallet_revokePermissions"),params:lY.any()}),NQ=lY.object({method:lY.literal("wallet_getAssets"),params:lY.any()}),IQ=lY.object({token:lY.string()}),OQ=lY.object({id:lY.string().optional()}),DQ={appEvent:OQ.extend({type:hY("APP_SWITCH_NETWORK"),payload:uY}).or(OQ.extend({type:hY("APP_CONNECT_EMAIL"),payload:dY})).or(OQ.extend({type:hY("APP_CONNECT_DEVICE")})).or(OQ.extend({type:hY("APP_CONNECT_OTP"),payload:pY})).or(OQ.extend({type:hY("APP_CONNECT_SOCIAL"),payload:fY})).or(OQ.extend({type:hY("APP_GET_FARCASTER_URI")})).or(OQ.extend({type:hY("APP_CONNECT_FARCASTER")})).or(OQ.extend({type:hY("APP_GET_USER"),payload:lY.optional(mY)})).or(OQ.extend({type:hY("APP_GET_SOCIAL_REDIRECT_URI"),payload:gY})).or(OQ.extend({type:hY("APP_SIGN_OUT")})).or(OQ.extend({type:hY("APP_IS_CONNECTED"),payload:lY.optional(IQ)})).or(OQ.extend({type:hY("APP_GET_CHAIN_ID")})).or(OQ.extend({type:hY("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(OQ.extend({type:hY("APP_INIT_SMART_ACCOUNT")})).or(OQ.extend({type:hY("APP_SET_PREFERRED_ACCOUNT"),payload:EY})).or(OQ.extend({type:hY("APP_RPC_REQUEST"),payload:yQ.or(NQ).or(UY).or(zY).or(FY).or(jY).or(VY).or(HY).or(WY).or(GY).or(qY).or(KY).or(YY).or(QY).or(XY).or(ZY).or(JY).or($Y).or(eQ).or(tQ).or(nQ).or(iQ).or(rQ).or(sQ).or(aQ).or(oQ).or(lQ).or(cQ).or(hQ).or(uQ).or(dQ).or(pQ).or(fQ).or(mQ).or(gQ).or(vQ).or(yQ).or(bQ).or(wQ).or(xQ).or(EQ).or(CQ).or(AQ).or(_Q).or(SQ).or(TQ).or(PQ).or(MQ)})).or(OQ.extend({type:hY("APP_UPDATE_EMAIL"),payload:vY})).or(OQ.extend({type:hY("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:yY})).or(OQ.extend({type:hY("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:bY})).or(OQ.extend({type:hY("APP_SYNC_THEME"),payload:wY})).or(OQ.extend({type:hY("APP_SYNC_DAPP_DATA"),payload:xY})).or(OQ.extend({type:hY("APP_RELOAD")})),frameEvent:OQ.extend({type:hY("FRAME_SWITCH_NETWORK_ERROR"),payload:cY}).or(OQ.extend({type:hY("FRAME_SWITCH_NETWORK_SUCCESS"),payload:OY})).or(OQ.extend({type:hY("FRAME_CONNECT_EMAIL_SUCCESS"),payload:CY})).or(OQ.extend({type:hY("FRAME_CONNECT_EMAIL_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:AY})).or(OQ.extend({type:hY("FRAME_GET_FARCASTER_URI_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:SY})).or(OQ.extend({type:hY("FRAME_CONNECT_FARCASTER_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_CONNECT_OTP_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_CONNECT_OTP_SUCCESS")})).or(OQ.extend({type:hY("FRAME_CONNECT_DEVICE_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_CONNECT_DEVICE_SUCCESS")})).or(OQ.extend({type:hY("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:_Y})).or(OQ.extend({type:hY("FRAME_CONNECT_SOCIAL_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_GET_USER_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_GET_USER_SUCCESS"),payload:PY})).or(OQ.extend({type:hY("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:MY})).or(OQ.extend({type:hY("FRAME_SIGN_OUT_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_SIGN_OUT_SUCCESS")})).or(OQ.extend({type:hY("FRAME_IS_CONNECTED_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_IS_CONNECTED_SUCCESS"),payload:NY})).or(OQ.extend({type:hY("FRAME_GET_CHAIN_ID_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_GET_CHAIN_ID_SUCCESS"),payload:IY})).or(OQ.extend({type:hY("FRAME_RPC_REQUEST_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_RPC_REQUEST_SUCCESS"),payload:BY})).or(OQ.extend({type:hY("FRAME_SESSION_UPDATE"),payload:IQ})).or(OQ.extend({type:hY("FRAME_UPDATE_EMAIL_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_UPDATE_EMAIL_SUCCESS"),payload:TY})).or(OQ.extend({type:hY("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(OQ.extend({type:hY("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:DY})).or(OQ.extend({type:hY("FRAME_SYNC_THEME_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_SYNC_THEME_SUCCESS")})).or(OQ.extend({type:hY("FRAME_SYNC_DAPP_DATA_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(OQ.extend({type:hY("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:LY})).or(OQ.extend({type:hY("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:kY})).or(OQ.extend({type:hY("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_READY"),payload:RY})).or(OQ.extend({type:hY("FRAME_RELOAD_ERROR"),payload:cY})).or(OQ.extend({type:hY("FRAME_RELOAD_SUCCESS")}))};function LQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"===typeof t?.type&&t?.type?.includes(e)}class RQ{constructor(e){let{projectId:t,isAppClient:n=!1,chainId:i="eip155:1",enableLogger:r=!0}=e;if(this.iframe=null,this.rpcUrl=OG.o.BLOCKCHAIN_API_RPC_URL,this.initFrame=()=>{const e=document.getElementById("w3m-iframe");this.iframe&&!e&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(e,t,n)=>{function i(n){let{data:r}=n;if(!LQ(iq.s1.FRAME_EVENT_KEY,r))return;const s=DQ.frameEvent.parse(r);s.id===e&&(t(s),window.removeEventListener("message",i))}nq.Q.isClient&&(window.addEventListener("message",i),n.addEventListener("abort",(()=>{window.removeEventListener("message",i)})))},onFrameEvent:e=>{nq.Q.isClient&&window.addEventListener("message",(t=>{let{data:n}=t;if(!LQ(iq.s1.FRAME_EVENT_KEY,n))return;const i=DQ.frameEvent.parse(n);e(i)}))},onAppEvent:e=>{nq.Q.isClient&&window.addEventListener("message",(t=>{let{data:n}=t;if(!LQ(iq.s1.APP_EVENT_KEY,n))return;const i=DQ.appEvent.parse(n);e(i)}))},postAppEvent:e=>{if(nq.Q.isClient){if(!this.iframe?.contentWindow)throw new Error("W3mFrame: iframe is not set");DQ.appEvent.parse(e),this.iframe.contentWindow.postMessage(e,"*")}},postFrameEvent:e=>{if(nq.Q.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");DQ.frameEvent.parse(e),parent.postMessage(e,"*")}}},this.projectId=t,this.frameLoadPromise=new Promise(((e,t)=>{this.frameLoadPromiseResolver={resolve:e,reject:t}})),n&&(this.frameLoadPromise=new Promise(((e,t)=>{this.frameLoadPromiseResolver={resolve:e,reject:t}})),nq.Q.isClient)){const e=document.createElement("iframe");e.id="w3m-iframe",e.src=`${iq.hy}?projectId=${t}&chainId=${i}&version=${iq.gS}&enableLogger=${r}`,e.name="w3m-secure-iframe",e.style.position="fixed",e.style.zIndex="999999",e.style.display="none",e.style.animationDelay="0s, 50ms",e.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",e.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=e,this.iframe.onerror=()=>{this.frameLoadPromiseResolver?.reject("Unable to load email login dependency")},this.events.onFrameEvent((e=>{"@w3m-frame/READY"===e.type&&this.frameLoadPromiseResolver?.resolve(void 0)}))}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map((e=>({[e]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${e}&projectId=${this.projectId}`,chainId:e}})));return Object.assign({},...e)}}var kQ=n(69397);class BQ{constructor(e){const t=(0,kQ.iP)({level:iq.OH}),{logger:n,chunkLoggerController:i}=(0,kQ.D5)({opts:t});this.logger=(0,kQ.U5)(n,this.constructor.name),this.chunkLoggerController=i,"undefined"!==typeof window&&this.chunkLoggerController?.downloadLogsBlobInBrowser&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{this.chunkLoggerController?.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}var UQ=n(67887);class zQ{constructor(e){let{projectId:t,chainId:n,enableLogger:i=!0,onTimeout:r}=e;this.openRpcRequests=[],i&&(this.w3mLogger=new BQ(t)),this.w3mFrame=new RQ({projectId:t,isAppClient:!0,chainId:n,enableLogger:i}),this.onTimeout=r,this.getLoginEmailUsed()&&this.w3mFrame.initFrame(),this.initPromise=new Promise((e=>{this.w3mFrame.events.onFrameEvent((async t=>{t.type===iq.s1.FRAME_READY&&(this.initPromise=void 0,await new Promise((e=>{setTimeout(e,500)})),e())}))}))}async init(){this.w3mFrame.initFrame(),this.initPromise&&await this.initPromise}getLoginEmailUsed(){return Boolean(UQ.o.get(iq.s1.EMAIL_LOGIN_USED_KEY))}getEmail(){return UQ.o.get(iq.s1.EMAIL)}getUsername(){return UQ.o.get(iq.s1.SOCIAL_USERNAME)}async reload(){try{this.w3mFrame.initFrame(),await this.appEvent({type:iq.s1.APP_RELOAD})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error reloading iframe"),e}}async connectEmail(e){try{nq.Q.checkIfAllowedToTriggerEmail(),this.w3mFrame.initFrame();const t=await this.appEvent({type:iq.s1.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),t}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error connecting email"),t}}async connectDevice(){try{return this.appEvent({type:iq.s1.APP_CONNECT_DEVICE})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting device"),e}}async connectOtp(e){try{return this.appEvent({type:iq.s1.APP_CONNECT_OTP,payload:e})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error connecting otp"),t}}async isConnected(){try{if(!this.getLoginEmailUsed())return{isConnected:!1};const e=await this.appEvent({type:iq.s1.APP_IS_CONNECTED});return e?.isConnected||this.deleteAuthLoginCache(),e}catch(e){throw this.deleteAuthLoginCache(),this.w3mLogger?.logger.error({error:e},"Error checking connection"),e}}async getChainId(){try{const e=await this.appEvent({type:iq.s1.APP_GET_CHAIN_ID});return this.setLastUsedChainId(e.chainId),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting chain id"),e}}async getSocialRedirectUri(e){try{return this.w3mFrame.initFrame(),this.appEvent({type:iq.s1.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error getting social redirect uri"),t}}async updateEmail(e){try{const t=await this.appEvent({type:iq.s1.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),t}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error updating email"),t}}async updateEmailPrimaryOtp(e){try{return this.appEvent({type:iq.s1.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error updating email primary otp"),t}}async updateEmailSecondaryOtp(e){try{const t=await this.appEvent({type:iq.s1.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(t.newEmail),t}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error updating email secondary otp"),t}}async syncTheme(e){try{return this.appEvent({type:iq.s1.APP_SYNC_THEME,payload:e})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error syncing theme"),t}}async syncDappData(e){try{return this.appEvent({type:iq.s1.APP_SYNC_DAPP_DATA,payload:e})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error syncing dapp data"),t}}async getSmartAccountEnabledNetworks(){try{const e=await this.appEvent({type:iq.s1.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(e.smartAccountEnabledNetworks),e}catch(e){throw this.persistSmartAccountEnabledNetworks([]),this.w3mLogger?.logger.error({error:e},"Error getting smart account enabled networks"),e}}async setPreferredAccount(e){try{return this.appEvent({type:iq.s1.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error setting preferred account"),t}}async connect(e){try{const t=e?.chainId||this.getLastUsedChainId()||1,n=await this.getUser({chainId:t,preferredAccountType:e?.preferredAccountType});return this.setLoginSuccess(n.email),this.setLastUsedChainId(n.chainId),this.user=n,n}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error connecting"),t}}async getUser(e){try{const t=e?.chainId||this.getLastUsedChainId()||1,n=await this.appEvent({type:iq.s1.APP_GET_USER,payload:{...e,chainId:t}});return this.user=n,n}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error connecting"),t}}async connectSocial(e){try{this.w3mFrame.initFrame();const t=await this.appEvent({type:iq.s1.APP_CONNECT_SOCIAL,payload:{uri:e}});return t.userName&&this.setSocialLoginSuccess(t.userName),t}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error connecting social"),t}}async getFarcasterUri(){try{this.w3mFrame.initFrame();return await this.appEvent({type:iq.s1.APP_GET_FARCASTER_URI})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting farcaster uri"),e}}async connectFarcaster(){try{const e=await this.appEvent({type:iq.s1.APP_CONNECT_FARCASTER});return e.userName&&this.setSocialLoginSuccess(e.userName),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting farcaster"),e}}async switchNetwork(e){try{const t=await this.appEvent({type:iq.s1.APP_SWITCH_NETWORK,payload:{chainId:e}});return this.setLastUsedChainId(t.chainId),t}catch(t){throw this.w3mLogger?.logger.error({error:t},"Error switching network"),t}}async disconnect(){try{const e=await this.appEvent({type:iq.s1.APP_SIGN_OUT});return this.deleteAuthLoginCache(),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error disconnecting"),e}}async request(e){try{if(iq.Vl.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();this.rpcRequestHandler?.(e);const t=await this.appEvent({type:iq.s1.APP_RPC_REQUEST,payload:e});return this.rpcSuccessHandler?.(t,e),t}catch(t){throw this.rpcErrorHandler?.(t,e),this.w3mLogger?.logger.error({error:t},"Error requesting"),t}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent((t=>{t.type===iq.s1.FRAME_IS_CONNECTED_SUCCESS&&t.payload.isConnected&&e()}))}onNotConnected(e){this.w3mFrame.events.onFrameEvent((t=>{t.type===iq.s1.FRAME_IS_CONNECTED_ERROR&&e(),t.type!==iq.s1.FRAME_IS_CONNECTED_SUCCESS||t.payload.isConnected||e()}))}onConnect(e){this.w3mFrame.events.onFrameEvent((t=>{t.type===iq.s1.FRAME_GET_USER_SUCCESS&&e(t.payload)}))}onSocialConnected(e){this.w3mFrame.events.onFrameEvent((t=>{t.type===iq.s1.FRAME_CONNECT_SOCIAL_SUCCESS&&e(t.payload)}))}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent((t=>{t.type===iq.s1.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(t.payload):t.type===iq.s1.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:iq.Vl.ACCOUNT_TYPES.EOA})}))}onGetSmartAccountEnabledNetworks(e){this.w3mFrame.events.onFrameEvent((t=>{t.type===iq.s1.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS?e(t.payload.smartAccountEnabledNetworks):t.type===iq.s1.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR&&e([])}))}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}rejectRpcRequests(){try{this.openRpcRequests.forEach((e=>{let{abortController:t,method:n}=e;iq.Vl.SAFE_RPC_METHODS.includes(n)||t.abort()})),this.openRpcRequests=[]}catch(yw){this.w3mLogger?.logger.error({error:yw},"Error aborting RPC request")}}async appEvent(e){let t;function n(e){return e.replace("@w3m-app/","")}await this.w3mFrame.frameLoadPromise;const i=new AbortController,r=n(e.type);return[iq.s1.APP_CONNECT_EMAIL,iq.s1.APP_CONNECT_DEVICE,iq.s1.APP_CONNECT_OTP,iq.s1.APP_CONNECT_SOCIAL,iq.s1.APP_GET_SOCIAL_REDIRECT_URI].map(n).includes(r)&&(t=setTimeout((()=>{this.onTimeout?.(),i.abort()}),3e4)),new Promise(((n,s)=>{const a=Math.random().toString(36).substring(7);if(this.w3mLogger?.logger.info?.({event:e,id:a},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:a}),"RPC_REQUEST"===r){const t=e;this.openRpcRequests=[...this.openRpcRequests,{...t.payload,abortController:i}]}i.signal.addEventListener("abort",(()=>{"RPC_REQUEST"===r?s(new Error("Request was aborted")):"GET_FARCASTER_URI"!==r&&s(new Error("Something went wrong"))})),this.w3mFrame.events.registerFrameEventHandler(a,(e=>{return i=e,o=this.w3mLogger,void(i.id===a&&(o?.logger.info?.({framEvent:i,id:a},"Received frame response"),i.type===`@w3m-frame/${r}_SUCCESS`?(t&&clearTimeout(t),"payload"in i&&n(i.payload),n(void 0)):i.type===`@w3m-frame/${r}_ERROR`&&(t&&clearTimeout(t),"payload"in i&&s(new Error(i.payload?.message||"An error occurred")),s(new Error("An error occurred")))));var i,o}),i.signal)}))}setNewLastEmailLoginTime(){UQ.o.set(iq.s1.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){UQ.o.set(iq.s1.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&UQ.o.set(iq.s1.EMAIL,e),UQ.o.set(iq.s1.EMAIL_LOGIN_USED_KEY,"true"),UQ.o.delete(iq.s1.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){UQ.o.delete(iq.s1.EMAIL_LOGIN_USED_KEY),UQ.o.delete(iq.s1.EMAIL),UQ.o.delete(iq.s1.LAST_USED_CHAIN_KEY),UQ.o.delete(iq.s1.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&UQ.o.set(iq.s1.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=UQ.o.get(iq.s1.LAST_USED_CHAIN_KEY)??void 0,t=Number(e);return isNaN(t)?e:t}persistSmartAccountEnabledNetworks(e){UQ.o.set(iq.s1.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}}class FQ{constructor(){}static getInstance(e){let{projectId:t,chainId:n,enableLogger:i,onTimeout:r}=e;return FQ.instance||(FQ.instance=new zQ({projectId:t,chainId:n,enableLogger:i,onTimeout:r})),FQ.instance}}var jQ=n(62983);const VQ={validateCaipAddress(e){if(3!==e.split(":")?.length)throw new Error("Invalid CAIP Address");return e},parseCaipAddress(e){const t=e.split(":");if(3!==t.length)throw new Error(`Invalid CAIP-10 address: ${e}`);const[n,i,r]=t;if(!n||!i||!r)throw new Error(`Invalid CAIP-10 address: ${e}`);return{chainNamespace:n,chainId:i,address:r}},parseCaipNetworkId(e){const t=e.split(":");if(2!==t.length)throw new Error(`Invalid CAIP-2 network id: ${e}`);const[n,i]=t;if(!n||!i)throw new Error(`Invalid CAIP-2 network id: ${e}`);return{chainNamespace:n,chainId:i}}};var HQ=n(99632),WQ=n(65618),GQ=n(73609),qQ=n(83793),KQ=n(1348),YQ=n(7258),QQ=n(61139),XQ=(n(80629),n(91391),n(93005)),ZQ=n(89268),JQ=n(72494),$Q=n(21627);class eX extends $Q.C{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}var tX=n(46510);function nX(e,t){let{errorInstance:n=new Error("timed out"),timeout:i,signal:r}=t;return new Promise(((t,s)=>{(async()=>{let a;try{const o=new AbortController;i>0&&(a=setTimeout((()=>{r?o.abort():s(n)}),i)),t(await e({signal:o?.signal||null}))}catch(o){"AbortError"===o?.name&&s(n),s(o)}finally{clearTimeout(a)}})()}))}var iX=n(23512);function rX(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const sX=rX();var aX=n(43340),oX=n(84117),lX=n(56844);const cX=new lX.A(8192);async function hX(e){return new Promise((t=>setTimeout(t,e)))}function uX(e){let{delay:t=100,retryCount:n=2,shouldRetry:i=()=>!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(((r,s)=>{const a=async function(){let{count:o=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=await e();r(t)}catch(l){if(o<n&&await i({count:o,error:l}))return(async e=>{let{error:n}=e;const i="function"===typeof t?t({count:o,error:n}):t;i&&await hX(i),a({count:o+1})})({error:l});s(l)}};a()}))}function dX(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{dedupe:r=!1,methods:s,retryDelay:a=150,retryCount:o=3,uid:l}={...t,...i},{method:c}=n;if(s?.exclude?.includes(c))throw new aX.ab(new Error("method not supported"),{method:c});if(s?.include&&!s.include.includes(c))throw new aX.ab(new Error("method not supported"),{method:c});return function(e,t){let{enabled:n=!0,id:i}=t;if(!n||!i)return e();if(cX.get(i))return cX.get(i);const r=e().finally((()=>cX.delete(i)));return cX.set(i,r),r}((()=>uX((async()=>{try{return await e(n)}catch(t){const e=t;switch(e.code){case aX.XU.code:throw new aX.XU(e);case aX.CL.code:throw new aX.CL(e);case aX.Gi.code:throw new aX.Gi(e,{method:n.method});case aX.D5.code:throw new aX.D5(e);case aX.bq.code:throw new aX.bq(e);case aX.Di.code:throw new aX.Di(e);case aX.hA.code:throw new aX.hA(e);case aX.qZ.code:throw new aX.qZ(e);case aX.YW.code:throw new aX.YW(e);case aX.ab.code:throw new aX.ab(e,{method:n.method});case aX.s0.code:throw new aX.s0(e);case aX.xQ.code:throw new aX.xQ(e);case aX.vx.code:throw new aX.vx(e);case aX.sV.code:throw new aX.sV(e);case aX.Sf.code:throw new aX.Sf(e);case aX.RV.code:throw new aX.RV(e);case aX.xq.code:throw new aX.xq(e);case aX.ch.code:throw new aX.ch(e);case aX.L5.code:throw new aX.L5(e);case aX.WT.code:throw new aX.WT(e);case aX.hl.code:throw new aX.hl(e);case aX.cg.code:throw new aX.cg(e);case aX.uL.code:throw new aX.uL(e);case aX.G1.code:throw new aX.G1(e);case aX.jz.code:throw new aX.jz(e);case 5e3:throw new aX.vx(e);default:if(t instanceof $Q.C)throw t;throw new aX.MI(e)}}}),{delay:e=>{let{count:t,error:n}=e;if(n&&n instanceof JQ.Ci){const e=n?.headers?.get("Retry-After");if(e?.match(/\d/))return 1e3*Number.parseInt(e)}return(1<<t)*a},retryCount:o,shouldRetry:e=>{let{error:t}=e;return function(e){if("code"in e&&"number"===typeof e.code)return-1===e.code||(e.code===aX.s0.code||e.code===aX.bq.code);if(e instanceof JQ.Ci&&e.status)return 403===e.status||(408===e.status||(413===e.status||(429===e.status||(500===e.status||(502===e.status||(503===e.status||504===e.status))))));return!0}(t)}})),{enabled:r,id:r?(0,oX.i3)(`${l}.${(0,iX.A)(n)}`):void 0})}}let pX,fX=256;function mX(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:11;if(!pX||fX+e>512){pX="",fX=0;for(let e=0;e<256;e++)pX+=(256+256*Math.random()|0).toString(16).substring(1)}return pX.substring(fX,fX+++e)}function gX(e,t){let{key:n,methods:i,name:r,request:s,retryCount:a=3,retryDelay:o=150,timeout:l,type:c}=e;return{config:{key:n,methods:i,name:r,request:s,retryCount:a,retryDelay:o,timeout:l,type:c},request:dX(s,{methods:i,retryCount:a,retryDelay:o,uid:mX()}),value:t}}function vX(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{batch:n,fetchOptions:i,key:r="http",methods:s,name:a="HTTP JSON-RPC",onFetchRequest:o,onFetchResponse:l,retryDelay:c,raw:h}=t;return u=>{let{chain:d,retryCount:p,timeout:f}=u;const{batchSize:m=1e3,wait:g=0}="object"===typeof n?n:{},v=t.retryCount??p,y=f??t.timeout??1e4,b=e||d?.rpcUrls.default.http[0];if(!b)throw new eX;const w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{async request(n){const{body:i,onRequest:r=t.onRequest,onResponse:s=t.onResponse,timeout:a=t.timeout??1e4}=n,o={...t.fetchOptions??{},...n.fetchOptions??{}},{headers:l,method:c,signal:h}=o;try{const t=await nX((async t=>{let{signal:n}=t;const s={...o,body:Array.isArray(i)?(0,iX.A)(i.map((e=>({jsonrpc:"2.0",id:e.id??sX.take(),...e})))):(0,iX.A)({jsonrpc:"2.0",id:i.id??sX.take(),...i}),headers:{"Content-Type":"application/json",...l},method:c||"POST",signal:h||(a>0?n:null)},u=new Request(e,s),d=await(r?.(u,s))??{...s,url:e};return await fetch(d.url??e,d)}),{errorInstance:new JQ.MU({body:i,url:e}),timeout:a,signal:!0});let n;if(s&&await s(t),t.headers.get("Content-Type")?.startsWith("application/json"))n=await t.json();else{n=await t.text();try{n=JSON.parse(n||"{}")}catch(u){if(t.ok)throw u;n={error:n}}}if(!t.ok)throw new JQ.Ci({body:i,details:(0,iX.A)(n.error)||t.statusText,headers:t.headers,status:t.status,url:e});return n}catch(u){if(u instanceof JQ.Ci)throw u;if(u instanceof JQ.MU)throw u;throw new JQ.Ci({body:i,cause:u,url:e})}}}}(b,{fetchOptions:i,onRequest:o,onResponse:l,timeout:y});return gX({key:r,methods:s,name:a,async request(e){let{method:t,params:i}=e;const r={method:t,params:i},{schedule:s}=(0,tX.u)({id:b,wait:g,shouldSplitBatch:e=>e.length>m,fn:e=>w.request({body:e}),sort:(e,t)=>e.id-t.id}),[{error:a,result:o}]=await(async e=>n?s(e):[await w.request({body:e})])(r);if(h)return{error:a,result:o};if(a)throw new JQ.J8({body:r,error:a,url:b});return o},retryCount:v,retryDelay:c,timeout:y,type:"http"},{fetchOptions:i,url:b})}}var yX=n(12343);function bX(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{key:n="fallback",name:i="Fallback",rank:r=!1,shouldThrow:s=wX,retryCount:a,retryDelay:o}=t;return t=>{let{chain:l,pollingInterval:c=4e3,timeout:h,...u}=t,d=e,p=()=>{};const f=gX({key:n,name:i,async request(e){let t,{method:n,params:i}=e;const r=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const a=d[e]({...u,chain:l,retryCount:0,timeout:h});try{const e=await a.request({method:n,params:i});return p({method:n,params:i,response:e,transport:a,status:"success"}),e}catch(o){if(p({error:o,method:n,params:i,transport:a,status:"error"}),s(o))throw o;if(e===d.length-1)throw o;if(t??=d.slice(e+1).some((e=>{const{include:t,exclude:i}=e({chain:l}).config.methods||{};return t?t.includes(n):!i||!i.includes(n)})),!t)throw o;return r(e+1)}};return r()},retryCount:a,retryDelay:o,type:"fallback"},{onResponse:e=>p=e,transports:d.map((e=>e({chain:l,retryCount:0})))});if(r){const e="object"===typeof r?r:{};!function(e){let{chain:t,interval:n=4e3,onTransports:i,ping:r,sampleCount:s=10,timeout:a=1e3,transports:o,weights:l={}}=e;const{stability:c=.7,latency:h=.3}=l,u=[],d=async()=>{const e=await Promise.all(o.map((async e=>{const n=e({chain:t,retryCount:0,timeout:a}),i=Date.now();let s,o;try{await(r?r({transport:n}):n.request({method:"net_listening"})),o=1}catch{o=0}finally{s=Date.now()}return{latency:s-i,success:o}})));u.push(e),u.length>s&&u.shift();const l=Math.max(...u.map((e=>Math.max(...e.map((e=>{let{latency:t}=e;return t})))))),p=o.map(((e,t)=>{const n=u.map((e=>e[t].latency)),i=1-n.reduce(((e,t)=>e+t),0)/n.length/l,r=u.map((e=>e[t].success)),s=r.reduce(((e,t)=>e+t),0)/r.length;return 0===s?[0,t]:[h*i+c*s,t]})).sort(((e,t)=>t[0]-e[0]));i(p.map((e=>{let[,t]=e;return o[t]}))),await hX(n),d()};d()}({chain:l,interval:e.interval??c,onTransports:e=>d=e,ping:e.ping,sampleCount:e.sampleCount,timeout:e.timeout,transports:d,weights:e.weights})}return f}}function wX(e){return!(!("code"in e)||"number"!==typeof e.code||e.code!==aX.YW.code&&e.code!==aX.vx.code&&!yX.A7.nodeMessage.test(e.message)&&5e3!==e.code)}const xX={ConnectorExplorerIds:{[OG.o.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[OG.o.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[OG.o.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[OG.o.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[OG.o.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[KG.o.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[KG.o.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[KG.o.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[KG.o.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[KG.o.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[KG.o.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[KG.o.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[KG.o.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[KG.o.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[KG.o.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[KG.o.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[OG.o.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[OG.o.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[OG.o.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[OG.o.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[OG.o.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[OG.o.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[OG.o.CONNECTOR_ID.INJECTED]:"Browser Wallet",[OG.o.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[OG.o.CONNECTOR_ID.COINBASE]:"Coinbase",[OG.o.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[OG.o.CONNECTOR_ID.LEDGER]:"Ledger",[OG.o.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[OG.o.CONNECTOR_ID.INJECTED]:"INJECTED",[OG.o.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[OG.o.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[OG.o.CONNECTOR_ID.AUTH]:"AUTH"},WalletConnectRpcChainIds:[1,5,11155111,10,420,42161,421613,137,80001,42220,1313161554,1313161555,56,97,43114,43113,100,8453,84531,7777777,999,324,280]};function EX(e,t){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",e),n.searchParams.set("projectId",t),n.toString()}const CX=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],AX={extendRpcUrlWithProjectId(e,t){let n=!1;try{n="rpc.walletconnect.org"===new URL(e).host}catch(yw){n=!1}if(n){const n=new URL(e);return n.searchParams.has("projectId")||n.searchParams.set("projectId",t),n.toString()}return e},isCaipNetwork:e=>"chainNamespace"in e&&"caipNetworkId"in e,getChainNamespace(e){return this.isCaipNetwork(e)?e.chainNamespace:OG.o.CHAIN.EVM},getCaipNetworkId(e){return this.isCaipNetwork(e)?e.caipNetworkId:`${OG.o.CHAIN.EVM}:${e.id}`},getDefaultRpcUrl(e,t,n){const i=e.rpcUrls?.default?.http?.[0];return CX.includes(t)?EX(t,n):i||""},extendCaipNetwork(e,t){let{customNetworkImageUrls:n,projectId:i,customRpcUrls:r}=t;const s=this.getChainNamespace(e),a=this.getCaipNetworkId(e),o=e.rpcUrls.default.http?.[0],l=this.getDefaultRpcUrl(e,a,i),c=e?.rpcUrls?.chainDefault?.http?.[0]||o,h=r?.[a]?.map((e=>e.url))||[],u=[...h,l],d=[...h];return c&&!d.includes(c)&&d.push(c),{...e,chainNamespace:s,caipNetworkId:a,assets:{imageId:xX.NetworkImageIds[e.id],imageUrl:n?.[e.id]},rpcUrls:{...e.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(e,t){let{customNetworkImageUrls:n,projectId:i,customRpcUrls:r}=t;return e.map((e=>AX.extendCaipNetwork(e,{customNetworkImageUrls:n,customRpcUrls:r,projectId:i})))},getViemTransport(e,t,n){const i=[];return n?.forEach((e=>{i.push(vX(e.url,e.config))})),CX.includes(e.caipNetworkId)&&i.push(vX(EX(e.caipNetworkId,t),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),e?.rpcUrls?.default?.http?.forEach((e=>{i.push(vX(e))})),bX(i)},extendWagmiTransports(e,t,n){if(CX.includes(e.caipNetworkId)){return bX([n,vX(this.getDefaultRpcUrl(e,e.caipNetworkId,t))])}return n},getUnsupportedNetwork:e=>({id:e.split(":")[1],caipNetworkId:e,name:OG.o.UNSUPPORTED_NETWORK_NAME,chainNamespace:e.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}),getCaipNetworkFromStorage(e){const t=WG.i.getActiveCaipNetworkId(),n=jG.W.getAllRequestedCaipNetworks(),i=Array.from(jG.W.state.chains?.keys()||[]),r=t?.split(":")[0],s=!!r&&i.includes(r),a=n?.find((e=>e.caipNetworkId===t));return s&&!a&&t?this.getUnsupportedNetwork(t):a||(e||n?.[0])}},SX={createLogger(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";const n=(0,kQ.iP)({level:t}),{logger:i}=(0,kQ.D5)({opts:n});return i.error=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const r of n)if(r instanceof Error)return void e(r,...n);e(void 0,...n)},i}};var _X=n(31666),TX=n(13237);const PX=4902,MX=5e3,NX=32603;function IX(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}const OX=IX({id:42161,name:"Arbitrum One",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://arb1.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://arbiscan.io",apiUrl:"https://api.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7654707}}}),DX=IX({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xce01f8eee7E479C928F8919abD53E553a36CeF67",blockCreated:19258213},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}});function LX(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}const RX=LX({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),kX=LX({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"}),BX=(LX({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"}),LX({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}}),LX({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0}),{solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]}),UX={getMethodsByChainNamespace:e=>BX[e]||[],createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};const n={...e},i=new Set;if(t.methods&&Object.keys(t.methods).forEach((e=>i.add(e))),t.chains&&Object.keys(t.chains).forEach((e=>i.add(e))),t.events&&Object.keys(t.events).forEach((e=>i.add(e))),t.rpcMap&&Object.keys(t.rpcMap).forEach((e=>{const[t]=e.split(":");t&&i.add(t)})),i.forEach((e=>{n[e]||(n[e]=this.createDefaultNamespace(e))})),t.methods&&Object.entries(t.methods).forEach((e=>{let[t,i]=e;n[t]&&(n[t].methods=i)})),t.chains&&Object.entries(t.chains).forEach((e=>{let[t,i]=e;n[t]&&(n[t].chains=i)})),t.events&&Object.entries(t.events).forEach((e=>{let[t,i]=e;n[t]&&(n[t].events=i)})),t.rpcMap){const e=new Set;Object.entries(t.rpcMap).forEach((t=>{let[i,r]=t;const[s,a]=i.split(":");s&&a&&n[s]&&(n[s].rpcMap||(n[s].rpcMap={}),e.has(s)||(n[s].rpcMap={},e.add(s)),n[s].rpcMap[a]=r)}))}return n},createNamespaces(e,t){const n=e.reduce(((e,t)=>{const{id:n,chainNamespace:i,rpcUrls:r}=t,s=r.default.http[0];e[i]||(e[i]=this.createDefaultNamespace(i));const a=`${i}:${n}`,o=e[i];switch(o.chains.push(a),a){case RX.caipNetworkId:o.chains.push(RX.deprecatedCaipNetworkId);break;case kX.caipNetworkId:o.chains.push(kX.deprecatedCaipNetworkId)}return o?.rpcMap&&s&&(o.rpcMap[n]=s),e}),{});return this.applyNamespaceOverrides(n,t)},resolveReownName:async e=>{const t=await qQ.f.resolveName(e),n=Object.values(t?.addresses)||[];return n[0]?.address||!1},getChainsFromNamespaces(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.values(e).flatMap((e=>{const t=e.chains||[],n=e.accounts.map((e=>{const[t,n]=e.split(":");return`${t}:${n}`}));return Array.from(new Set([...t,...n]))}))},isSessionEventData:e=>"object"===typeof e&&null!==e&&"id"in e&&"topic"in e&&"params"in e&&"object"===typeof e.params&&null!==e.params&&"chainId"in e.params&&"event"in e.params&&"object"===typeof e.params.event&&null!==e.params.event};class zX{constructor(e){let{provider:t,namespace:n}=e;this.id=OG.o.CONNECTOR_ID.WALLET_CONNECT,this.name=xX.ConnectorNamesMap[OG.o.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=xX.ConnectorImageIds[OG.o.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=jG.W.getCaipNetworks.bind(jG.W),this.caipNetworks=this.getCaipNetworks(),this.provider=t,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const e=this.getCaipNetworks(),t=VG.H.state.universalProviderConfigOverride,n=UX.createNamespaces(e,t);await this.provider.connect({optionalNamespaces:n})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map((e=>e.caipNetworkId));return TX.U.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:FX})}}const FX=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class jX{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,this.getCaipNetworks=e=>jG.W.getCaipNetworks(e),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.getCaipNetworks(this.namespace)}setAuthProvider(e){this.addConnector({id:OG.o.CONNECTOR_ID.AUTH,type:"AUTH",name:OG.o.CONNECTOR_NAMES.AUTH,provider:e,imageId:xX.ConnectorImageIds[OG.o.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(){const e=new Set;for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.availableConnectors=[...n,...this.availableConnectors].filter((t=>!e.has(t.id)&&(e.add(t.id),!0))),this.emit("connectors",this.availableConnectors)}setStatus(e,t){FG.U.setStatus(e,t)}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(t)}off(e,t){const n=this.eventListeners.get(e);n&&n.delete(t)}removeAllEventListeners(){this.eventListeners.forEach((e=>{e.clear()}))}emit(e,t){const n=this.eventListeners.get(e);n&&n.forEach((e=>e(t)))}async connectWalletConnect(e){const t=this.getWalletConnectConnector();return{clientId:(await t.connectWalletConnect()).clientId}}async switchNetwork(e){const{caipNetwork:t,providerType:n}=e;if(!e.provider)return;const i="provider"in e.provider?e.provider.provider:e.provider;if("WALLET_CONNECT"!==n){if(i&&"AUTH"===n){const e=i,n=FG.U.state.preferredAccountTypes?.[t.chainNamespace];await e.switchNetwork(t.caipNetworkId);const r=await e.getUser({chainId:t.caipNetworkId,preferredAccountType:n});this.emit("switchNetwork",r)}}else i.setDefaultChain(t.caipNetworkId)}getWalletConnectConnector(){const e=this.connectors.find((e=>e instanceof zX));if(!e)throw new Error("WalletConnectConnector not found");return e}}class VX extends jX{setUniversalProvider(e){this.addConnector(new zX({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{const e=this.getWalletConnectConnector();await e.disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts(e){let{namespace:t}=e;const n=this.provider,i=n?.session?.namespaces?.[t]?.accounts?.map((e=>{const[,,t]=e.split(":");return t})).filter(((e,t,n)=>n.indexOf(e)===t))||[];return Promise.resolve({accounts:i.map((e=>IG.w.createAccount(t,e,"bip122"===t?"payment":"eoa")))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&BG.oU.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};if(FG.U.state.balanceLoading&&e.chainId===jG.W.state.activeCaipNetwork?.id)return{balance:FG.U.state.balance||"0.00",symbol:FG.U.state.balanceSymbol||""};const t=(await FG.U.fetchTokenBalance()).find((t=>t.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&t.symbol===e.caipNetwork?.nativeCurrency.symbol));return{balance:t?.quantity.numeric||"0.00",symbol:t?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){const{provider:t,message:n,address:i}=e;if(!t)throw new Error("UniversalAdapter:signMessage - provider is undefined");let r="";if(jG.W.state.activeCaipNetwork?.chainNamespace===OG.o.CHAIN.SOLANA){r=(await t.request({method:"solana_signMessage",params:{message:_X.A.encode((new TextEncoder).encode(n)),pubkey:i}},jG.W.state.activeCaipNetwork?.caipNetworkId)).signature}else r=await t.request({method:"personal_sign",params:[n,i]},jG.W.state.activeCaipNetwork?.caipNetworkId);return{signature:r}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async getProfile(){return Promise.resolve({profileImage:"",profileName:""})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}async getEnsAddress(){return Promise.resolve({address:!1})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){const{caipNetwork:t}=e,n=this.getWalletConnectConnector();if(t.chainNamespace===OG.o.CHAIN.EVM)try{await(n.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,oX.nj)(t.id)}]}))}catch(i){if(i.code===PX||i.code===NX||i.code===MX||i?.data?.originalError?.code===PX)try{await(n.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:(0,oX.nj)(t.id),rpcUrls:[t?.rpcUrls.chainDefault?.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[t.blockExplorers?.default.url]}]}))}catch(r){throw new Error("Chain is not supported")}}n.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find((e=>"WALLET_CONNECT"===e.type)),t=e?.provider;return t}}class HX{constructor(e){this.chainNamespaces=[],this.reportedAlertErrors={},this.getCaipNetwork=(e,t)=>{if(e){const n=jG.W.getNetworkData(e)?.requestedCaipNetworks?.find((e=>e.id===t));if(n)return n;const i=jG.W.getNetworkData(e)?.caipNetwork;return i||jG.W.getRequestedCaipNetworks(e).filter((t=>t.chainNamespace===e))?.[0]}return jG.W.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const e=this.getCaipNetwork();if(e)return e.id},this.getCaipNetworks=e=>jG.W.getCaipNetworks(e),this.getActiveChainNamespace=()=>jG.W.state.activeChain,this.setRequestedCaipNetworks=(e,t)=>{jG.W.setRequestedCaipNetworks(e,t)},this.getApprovedCaipNetworkIds=()=>jG.W.getAllApprovedCaipNetworkIds(),this.getCaipAddress=e=>jG.W.state.activeChain!==e&&e?jG.W.getAccountProp("caipAddress",e):jG.W.state.activeCaipAddress,this.setClientId=e=>{WQ.T.setClientId(e)},this.getProvider=e=>$G.getProvider(e),this.getProviderType=e=>$G.getProviderId(e),this.getPreferredAccountType=e=>FG.U.state.preferredAccountTypes?.[e],this.setCaipAddress=(e,t)=>{FG.U.setCaipAddress(e,t)},this.setBalance=(e,t,n)=>{FG.U.setBalance(e,t,n)},this.setProfileName=(e,t)=>{FG.U.setProfileName(e,t)},this.setProfileImage=(e,t)=>{FG.U.setProfileImage(e,t)},this.setUser=(e,t)=>{FG.U.setUser(e,t),VG.H.state.enableEmbedded&&GQ.W.close()},this.resetAccount=e=>{FG.U.resetAccount(e)},this.setCaipNetwork=e=>{jG.W.setActiveCaipNetwork(e)},this.setCaipNetworkOfNamespace=(e,t)=>{jG.W.setChainNetworkData(t,{caipNetwork:e})},this.setAllAccounts=(e,t)=>{FG.U.setAllAccounts(e,t),VG.H.setHasMultipleAddresses(e?.length>1)},this.setStatus=(e,t)=>{FG.U.setStatus(e,t),LG.a.isConnected()?WG.i.setConnectionStatus("connected"):WG.i.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=e=>jG.W.getAccountProp("address",e),this.setConnectors=e=>{const t=[...LG.a.state.allConnectors,...e];LG.a.setConnectors(t)},this.fetchIdentity=e=>WQ.T.fetchIdentity(e),this.getReownName=e=>qQ.f.getNamesForAddress(e),this.getConnectors=()=>LG.a.getConnectors(),this.getConnectorImage=e=>KQ.$.getConnectorImage(e),this.setConnectedWalletInfo=(e,t)=>{const n=$G.getProviderId(t),i=e?{...e,type:n}:void 0;FG.U.setConnectedWalletInfo(i,t)},this.getIsConnectedState=()=>Boolean(jG.W.state.activeCaipAddress),this.addAddressLabel=(e,t,n)=>{FG.U.addAddressLabel(e,t,n)},this.removeAddressLabel=(e,t)=>{FG.U.removeAddressLabel(e,t)},this.getAddress=e=>jG.W.state.activeChain!==e&&e?jG.W.getAccountProp("address",e):FG.U.state.address,this.setApprovedCaipNetworksData=e=>jG.W.setApprovedCaipNetworksData(e),this.resetNetwork=e=>{jG.W.resetNetwork(e)},this.addConnector=e=>{LG.a.addConnector(e)},this.resetWcConnection=()=>{RG.x.resetWcConnection()},this.setAddressExplorerUrl=(e,t)=>{FG.U.setAddressExplorerUrl(e,t)},this.setSmartAccountDeployed=(e,t)=>{FG.U.setSmartAccountDeployed(e,t)},this.setSmartAccountEnabledNetworks=(e,t)=>{jG.W.setSmartAccountEnabledNetworks(e,t)},this.setPreferredAccountType=(e,t)=>{FG.U.setPreferredAccountType(e,t)},this.setEIP6963Enabled=e=>{VG.H.setEIP6963Enabled(e)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.initialize(e)}getChainNamespacesSet(e,t){const n=e?.map((e=>e.namespace)).filter((e=>Boolean(e)));if(n?.length)return[...new Set(n)];const i=t?.map((e=>e.chainNamespace));return[...new Set(i)]}async initialize(e){this.initControllers(e),await this.initChainAdapters(),await this.injectModalUi(),this.sendInitializeEvent(e),UG.z.set({initialized:!0}),await this.syncExistingConnection()}sendInitializeEvent(e){const{...t}=e;delete t.adapters,delete t.universalProvider,kG.E.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map((e=>e.id)),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&HG.W.setThemeMode(e.themeMode),e.themeVariables&&HG.W.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");jG.W.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const t=this.getDefaultNetwork();t&&jG.W.setActiveCaipNetwork(t)}initializeConnectionController(e){RG.x.setWcBasic(e.basic??!1)}initializeConnectorController(){LG.a.initialize(this.chainNamespaces)}initializeOptionsController(e){VG.H.setDebug(!1!==e.debug),VG.H.setEnableWalletConnect(!1!==e.enableWalletConnect),VG.H.setEnableWalletGuide(!1!==e.enableWalletGuide),VG.H.setEnableWallets(!1!==e.enableWallets),VG.H.setEIP6963Enabled(!1!==e.enableEIP6963),VG.H.setEnableNetworkSwitch(!1!==e.enableNetworkSwitch),VG.H.setEnableAuthLogger(!1!==e.enableAuthLogger),VG.H.setCustomRpcUrls(e.customRpcUrls),VG.H.setSdkVersion(e.sdkVersion),VG.H.setProjectId(e.projectId),VG.H.setEnableEmbedded(e.enableEmbedded),VG.H.setAllWallets(e.allWallets),VG.H.setIncludeWalletIds(e.includeWalletIds),VG.H.setExcludeWalletIds(e.excludeWalletIds),VG.H.setFeaturedWalletIds(e.featuredWalletIds),VG.H.setTokens(e.tokens),VG.H.setTermsConditionsUrl(e.termsConditionsUrl),VG.H.setPrivacyPolicyUrl(e.privacyPolicyUrl),VG.H.setCustomWallets(e.customWallets),VG.H.setFeatures(e.features),VG.H.setAllowUnsupportedChain(e.allowUnsupportedChain),VG.H.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),VG.H.setDefaultAccountTypes(e.defaultAccountTypes);const t=WG.i.getPreferredAccountTypes(),n={...VG.H.state.defaultAccountTypes,...t};FG.U.setPreferredAccountTypes(n);const i=this.getDefaultMetaData();if(!e.metadata&&i&&(e.metadata=i),VG.H.setMetadata(e.metadata),VG.H.setDisableAppend(e.disableAppend),VG.H.setEnableEmbedded(e.enableEmbedded),VG.H.setSIWX(e.siwx),!e.projectId)return void GG.h.open(YG.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");const r=e.adapters?.find((e=>e.namespace===OG.o.CHAIN.EVM));if(r&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");VG.H.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return"undefined"!==typeof window&&"undefined"!==typeof document?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){const t=this.getActiveChainNamespace();if(t){const n=AX.getUnsupportedNetwork(`${t}:${e}`);jG.W.setActiveCaipNetwork(n)}}getDefaultNetwork(){return AX.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return AX.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return AX.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const t=e.networks.find((t=>t.id===e.defaultNetwork?.id));return t?AX.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const e=jG.W.state.activeChain,t=this.getAdapter(e),n=this.getCaipNetwork(e)?.id;if(!t)throw new Error("Adapter not found");const i=await t.connectWalletConnect(n);this.close(),this.setClientId(i?.clientId||null),WG.i.setConnectedNamespaces([...jG.W.state.chains.keys()]),this.chainNamespaces.forEach((e=>{LG.a.setConnectorId(KG.o.CONNECTOR_TYPE_WALLET_CONNECT,e)})),await this.syncWalletConnectAccount()},connectExternal:async e=>{let{id:t,info:n,type:i,provider:r,chain:s,caipNetwork:a}=e;const o=jG.W.state.activeChain,l=s||o,c=this.getAdapter(l);if(s&&s!==o&&!a){const e=this.getCaipNetworks().find((e=>e.chainNamespace===s));e&&this.setCaipNetwork(e)}if(!c)throw new Error("Adapter not found");const h=this.getCaipNetwork(l),u=await c.connect({id:t,info:n,type:i,provider:r,chainId:a?.id||h?.id,rpcUrl:a?.rpcUrls?.default?.http?.[0]||h?.rpcUrls?.default?.http?.[0]});if(!u)return;WG.i.addConnectedNamespace(l),this.syncProvider({...u,chainNamespace:l});const{accounts:d}=await c.getAccounts({namespace:l,id:t});this.setAllAccounts(d,l),this.setStatus("connected",l)},reconnectExternal:async e=>{let{id:t,info:n,type:i,provider:r}=e;const s=jG.W.state.activeChain,a=this.getAdapter(s);a?.reconnect&&(await(a?.reconnect({id:t,info:n,type:i,provider:r,chainId:this.getCaipNetwork()?.id})),WG.i.addConnectedNamespace(s))},disconnect:async e=>{const t=e||jG.W.state.activeChain,n=this.getAdapter(t),i=$G.getProvider(t),r=$G.getProviderId(t);await(n?.disconnect({provider:i,providerType:r})),WG.i.removeConnectedNamespace(t),$G.resetChain(t),this.setUser(void 0,t),this.setStatus("disconnected",t)},checkInstalled:e=>e?e.some((e=>Boolean(window.ethereum?.[String(e)]))):Boolean(window.ethereum),signMessage:async e=>{const t=this.getAdapter(jG.W.state.activeChain),n=await(t?.signMessage({message:e,address:FG.U.state.address,provider:$G.getProvider(jG.W.state.activeChain)}));return n?.signature||""},sendTransaction:async e=>{if(e.chainNamespace===OG.o.CHAIN.EVM){const t=this.getAdapter(jG.W.state.activeChain),n=$G.getProvider(jG.W.state.activeChain),i=await(t?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:n}));return i?.hash||""}return""},estimateGas:async e=>{if(e.chainNamespace===OG.o.CHAIN.EVM){const t=this.getAdapter(jG.W.state.activeChain),n=$G.getProvider(jG.W.state.activeChain),i=this.getCaipNetwork();if(!i)throw new Error("CaipNetwork is undefined");const r=await(t?.estimateGas({...e,provider:n,caipNetwork:i}));return r?.gas||0n}return 0n},getEnsAvatar:async()=>{const e=this.getAdapter(jG.W.state.activeChain),t=await(e?.getProfile({address:FG.U.state.address,chainId:Number(this.getCaipNetwork()?.id)}));return t?.profileImage||!1},getEnsAddress:async e=>{const t=this.getAdapter(jG.W.state.activeChain),n=this.getCaipNetwork();if(!n)return!1;const i=await(t?.getEnsAddress({name:e,caipNetwork:n}));return i?.address||!1},writeContract:async e=>{const t=this.getAdapter(jG.W.state.activeChain),n=this.getCaipNetwork(),i=this.getCaipAddress(),r=$G.getProvider(jG.W.state.activeChain);if(!n||!i)throw new Error("CaipNetwork or CaipAddress is undefined");const s=await(t?.writeContract({...e,caipNetwork:n,provider:r,caipAddress:i}));return s?.hash},parseUnits:(e,t)=>{const n=this.getAdapter(jG.W.state.activeChain);return n?.parseUnits({value:e,decimals:t})??0n},formatUnits:(e,t)=>{const n=this.getAdapter(jG.W.state.activeChain);return n?.formatUnits({value:e,decimals:t})??"0"},getCapabilities:async e=>{const t=this.getAdapter(jG.W.state.activeChain);return await(t?.getCapabilities(e))},grantPermissions:async e=>{const t=this.getAdapter(jG.W.state.activeChain);return await(t?.grantPermissions(e))},revokePermissions:async e=>{const t=this.getAdapter(jG.W.state.activeChain);return t?.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{const t=this.getAdapter(jG.W.state.activeChain);return await(t?.walletGetAssets(e))??{}}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},RG.x.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){if($G.getProviderId(jG.W.state.activeChain)===KG.o.CONNECTOR_TYPE_WALLET_CONNECT){const e=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:"MetaMask Wallet"===this.universalProvider?.session?.peer?.metadata.name,approvedCaipNetworkIds:this.getChainsFromNamespaces(e)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const n=$G.getProvider(t),i=$G.getProviderId(t);if(e.chainNamespace===jG.W.state.activeChain){const r=this.getAdapter(t);await(r?.switchNetwork({caipNetwork:e,provider:n,providerType:i}))}else if(this.setCaipNetwork(e),i===KG.o.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const n=this.getAddressByChainNamespace(t);n&&this.syncAccount({address:n,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.values(e).flatMap((e=>{const t=e.chains||[],n=e.accounts.map((e=>{const{chainId:t,chainNamespace:n}=VQ.parseCaipAddress(e);return`${n}:${t}`}));return Array.from(new Set([...t,...n]))}))}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce(((t,n)=>{const i=e?.find((e=>e.namespace===n));return i?(i.construct({namespace:n,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),t[n]=i):t[n]=new VX({namespace:n,networks:this.getCaipNetworks()}),t}),{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e),this.chainAdapters?.[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map((async e=>{await this.initChainAdapter(e)})))}onConnectors(e){const t=this.getAdapter(e);t?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const t=this.getAdapter(e);if(!t)return;const n=WG.i.getConnectionStatus();"connected"===n?this.setStatus("connecting",e):"disconnected"===n?(WG.i.clearAddressCache(),this.setStatus(n,e)):this.setStatus(n,e),t.on("switchNetwork",(t=>{let{address:n,chainId:i}=t;const r=this.getCaipNetworks().find((e=>e.id===i||e.caipNetworkId===i)),s=jG.W.state.activeChain===e,a=jG.W.getAccountProp("address",e);if(r){const t=s&&n?n:a;t&&this.syncAccount({address:t,chainId:r.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)})),t.on("disconnect",this.disconnect.bind(this,e)),t.on("pendingTransactions",(()=>{const e=FG.U.state.address,t=jG.W.state.activeCaipNetwork;e&&t?.id&&this.updateNativeBalance(e,t.id,t.chainNamespace)})),t.on("accountChanged",(t=>{let{address:n,chainId:i}=t;const r=jG.W.state.activeChain===e;r&&i?this.syncAccount({address:n,chainId:i,chainNamespace:e}):r&&jG.W.state.activeCaipNetwork?.id?this.syncAccount({address:n,chainId:jG.W.state.activeCaipNetwork?.id,chainNamespace:e}):this.syncAccountInfo(n,i,e)}))}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map((e=>this.syncNamespaceConnection(e))))}async syncNamespaceConnection(e){try{const t=LG.a.getConnectorId(e);switch(this.setStatus("connecting",e),t){case OG.o.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case OG.o.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){const t=this.getAdapter(e),n=LG.a.getConnectorId(e),i=this.getCaipNetwork(e),r=LG.a.getConnectors(e).find((e=>e.id===n));try{if(!t||!r)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!i?.id)throw new Error("CaipNetwork not found");const n=await(t?.syncConnection({namespace:e,id:r.id,chainId:i.id,rpcUrl:i?.rpcUrls?.default?.http?.[0]}));if(n){const i=await(t?.getAccounts({namespace:e,id:r.id}));i&&i.accounts.length>0?this.setAllAccounts(i.accounts,e):this.setAllAccounts([IG.w.createAccount(e,n.address,"eoa")],e),this.syncProvider({...n,chainNamespace:e}),await this.syncAccount({...n,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch(yw){this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){const e=this.chainNamespaces.map((async e=>{const t=this.getAdapter(e),n=this.universalProvider?.session?.namespaces?.[e]?.accounts||[],i=jG.W.state.activeCaipNetwork?.id,r=n.find((e=>{const{chainId:t}=VQ.parseCaipAddress(e);return t===i?.toString()}))||n[0];if(r){const n=VQ.validateCaipAddress(r),{chainId:i,address:s}=VQ.parseCaipAddress(n);if($G.setProviderId(e,KG.o.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&jG.W.state.activeCaipNetwork&&t?.namespace!==OG.o.CHAIN.EVM){const n=t?.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:jG.W.state.activeCaipNetwork});$G.setProvider(e,n)}else $G.setProvider(e,this.universalProvider);LG.a.setConnectorId(OG.o.CONNECTOR_ID.WALLET_CONNECT,e),WG.i.addConnectedNamespace(e),this.syncWalletConnectAccounts(e),await this.syncAccount({address:s,chainId:i,chainNamespace:e})}else this.setStatus("disconnected",e);await jG.W.setApprovedCaipNetworksData(e)}));await Promise.all(e)}syncWalletConnectAccounts(e){const t=this.universalProvider?.session?.namespaces?.[e]?.accounts?.map((e=>{const{address:t}=VQ.parseCaipAddress(e);return t})).filter(((e,t,n)=>n.indexOf(e)===t));t&&this.setAllAccounts(t.map((t=>IG.w.createAccount(e,t,"bip122"===e?"payment":"eoa"))),e)}syncProvider(e){let{type:t,provider:n,id:i,chainNamespace:r}=e;$G.setProviderId(r,t),$G.setProvider(r,n),LG.a.setConnectorId(i,r)}async syncAccount(e){const t=e.chainNamespace===jG.W.state.activeChain,n=jG.W.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:i,chainId:r,chainNamespace:s}=e,{chainId:a}=WG.i.getActiveNetworkProps(),o=r||a,l=jG.W.state.activeCaipNetwork?.name===OG.o.UNSUPPORTED_NETWORK_NAME,c=jG.W.getNetworkProp("supportsAllNetworks",s);if(this.setStatus("connected",s),(!l||c)&&o){let e=this.getCaipNetworks().find((e=>e.id.toString()===o.toString())),r=this.getCaipNetworks().find((e=>e.chainNamespace===s));if(!c&&!e&&!r){const t=this.getApprovedCaipNetworkIds()||[],n=t.find((e=>VQ.parseCaipNetworkId(e)?.chainId===o.toString())),i=t.find((e=>VQ.parseCaipNetworkId(e)?.chainNamespace===s));e=this.getCaipNetworks().find((e=>e.caipNetworkId===n)),r=this.getCaipNetworks().find((e=>e.caipNetworkId===i||"deprecatedCaipNetworkId"in e&&e.deprecatedCaipNetworkId===i))}const a=e||r;a?.chainNamespace===jG.W.state.activeChain?VG.H.state.enableNetworkSwitch&&!VG.H.state.allowUnsupportedChain&&jG.W.state.activeCaipNetwork?.name===OG.o.UNSUPPORTED_NETWORK_NAME?jG.W.showUnsupportedChainUI():this.setCaipNetwork(a):t||n&&this.setCaipNetworkOfNamespace(n,s),this.syncConnectedWalletInfo(s),qG.y.isLowerCaseMatch(i,FG.U.state.address)||this.syncAccountInfo(i,a?.id,s),t?await this.syncBalance({address:i,chainId:a?.id,chainNamespace:s}):await this.syncBalance({address:i,chainId:n?.id,chainNamespace:s})}}async syncAccountInfo(e,t,n){const i=this.getCaipAddress(n),r=t||i?.split(":")[1];if(!r)return;const s=`${n}:${r}:${e}`;this.setCaipAddress(s,n),await this.syncIdentity({address:e,chainId:r,chainNamespace:n})}async syncReownName(e,t){try{const n=await this.getReownName(e);if(n[0]){const e=n[0];this.setProfileName(e.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){const t=LG.a.getConnectorId(e),n=$G.getProviderId(e);if(n===KG.o.CONNECTOR_TYPE_ANNOUNCED||n===KG.o.CONNECTOR_TYPE_INJECTED){if(t){const n=this.getConnectors().find((e=>e.id===t));if(n){const{info:t,name:i,imageUrl:r}=n,s=r||this.getConnectorImage(n);this.setConnectedWalletInfo({name:i,icon:s,...t},e)}}}else if(n===KG.o.CONNECTOR_TYPE_WALLET_CONNECT){const t=$G.getProvider(e);t?.session&&this.setConnectedWalletInfo({...t.session.peer.metadata,name:t.session.peer.metadata.name,icon:t.session.peer.metadata.icons?.[0]},e)}else if(t)if(t===OG.o.CONNECTOR_ID.COINBASE){const t=this.getConnectors().find((e=>e.id===OG.o.CONNECTOR_ID.COINBASE));this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(t)},e)}else this.setConnectedWalletInfo({name:t},e)}async syncBalance(e){const t=HQ.L.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find((t=>t.id.toString()===e.chainId?.toString()));t&&e.chainId&&await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async updateNativeBalance(e,t,n){const i=this.getAdapter(n),r=jG.W.getCaipNetworkByNamespace(n,t);if(i){const s=await i.getBalance({address:e,chainId:t,caipNetwork:r,tokens:this.options.tokens});this.setBalance(s.balance,s.symbol,n)}}async initializeUniversalAdapter(){var e=this;const t=SX.createLogger((function(t){t&&e.handleAlertError(t);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];console.error(...i)})),n={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:t};VG.H.setManualWCControl(Boolean(this.options?.manualWCControl)),this.universalProvider=this.options.universalProvider??await jQ.A.init(n),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",(e=>{RG.x.setUri(e)})),this.universalProvider.on("connect",RG.x.finalizeWcConnection),this.universalProvider.on("disconnect",(()=>{this.chainNamespaces.forEach((e=>{this.resetAccount(e)})),RG.x.resetWcConnection()})),this.universalProvider.on("chainChanged",(e=>{const t=this.getCaipNetworks().find((t=>t.id==e)),n=this.getCaipNetwork();t?n?.id!==t?.id&&this.setCaipNetwork(t):this.setUnsupportedNetwork(e)})),this.universalProvider.on("session_event",(e=>{if(UX.isSessionEventData(e)){const{name:t,data:n}=e.params.event;"accountsChanged"===t&&Array.isArray(n)&&IG.w.isCaipAddress(n[0])&&this.syncAccount(VQ.parseCaipAddress(n[0]))}})))}createUniversalProvider(){return!this.universalProviderInitPromise&&IG.w.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){kG.E.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const t=Object.entries(YG.UniversalProviderErrors).find((t=>{let[,{message:n}]=t;return e.message.includes(n)})),[n,i]=t??[],{message:r,alertErrorKey:s}=i??{};if(n&&r&&!this.reportedAlertErrors[n]){const e=YG.ALERT_ERRORS[s];e&&(GG.h.open(e,"error"),this.reportedAlertErrors[n]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;const t=e.namespace;if(!t)return;this.createClients();const n=e;n.namespace=t,n.construct({namespace:t,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=n)}async open(e){return await this.injectModalUi(),e?.uri&&RG.x.setUri(e.uri),e?.arguments&&"Swap"===e?.view?GQ.W.open({...e,data:{swap:e.arguments}}):GQ.W.open(e)}async close(){await this.injectModalUi(),GQ.W.close()}setLoading(e,t){GQ.W.setLoading(e,t)}async disconnect(e){await RG.x.disconnect(e)}getError(){return""}getChainId(){return jG.W.state.activeCaipNetwork?.id}async switchNetwork(e){const t=this.getCaipNetworks().find((t=>t.id===e.id));t?await jG.W.switchActiveNetwork(t):GG.h.open(YG.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error")}getWalletProvider(){return jG.W.state.activeChain?$G.state.providers[jG.W.state.activeChain]:null}getWalletProviderType(){return $G.getProviderId(jG.W.state.activeChain)}subscribeProviders(e){return $G.subscribeProviders(e)}getThemeMode(){return HG.W.state.themeMode}getThemeVariables(){return HG.W.state.themeVariables}setThemeMode(e){HG.W.setThemeMode(e),(0,ZQ.JX)(HG.W.state.themeMode)}setTermsConditionsUrl(e){VG.H.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){VG.H.setPrivacyPolicyUrl(e)}setThemeVariables(e){HG.W.setThemeVariables(e),(0,ZQ.ds)(HG.W.state.themeVariables)}subscribeTheme(e){return HG.W.subscribe(e)}getWalletInfo(){return FG.U.state.connectedWalletInfo}getAccount(e){const t=LG.a.getAuthConnector(e),n=jG.W.getAccountData(e),i=jG.W.state.activeChain;if(n)return{allAccounts:n.allAccounts,caipAddress:n.caipAddress,address:IG.w.getPlainAddress(n.caipAddress),isConnected:Boolean(n.caipAddress),status:n.status,embeddedWalletInfo:t?{user:n.user?{...n.user,username:WG.i.getConnectedSocialUsername()}:void 0,authProvider:n.socialProvider||"email",accountType:n.preferredAccountTypes?.[e||i],isSmartAccountDeployed:Boolean(n.smartAccountDeployed)}:void 0}}subscribeAccount(e,t){const n=()=>{const n=this.getAccount(t);n&&e(n)};t?jG.W.subscribeChainProp("accountState",n,t):jG.W.subscribe(n),LG.a.subscribe(n)}subscribeNetwork(e){return jG.W.subscribe((t=>{let{activeCaipNetwork:n}=t;e({caipNetwork:n,chainId:n?.id,caipNetworkId:n?.caipNetworkId})}))}subscribeWalletInfo(e){return FG.U.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){FG.U.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){jG.W.subscribeKey("activeCaipNetwork",e)}getState(){return UG.z.state}subscribeState(e){return UG.z.subscribe(e)}showErrorMessage(e){YQ.P.showError(e)}showSuccessMessage(e){YQ.P.showSuccess(e)}getEvent(){return{...kG.E.state}}subscribeEvents(e){return kG.E.subscribe(e)}replace(e){QQ.I.replace(e)}redirect(e){QQ.I.push(e)}popTransactionStack(e){QQ.I.popTransactionStack(e)}isOpen(){return GQ.W.state.open}isTransactionStackEmpty(){return 0===QQ.I.state.transactionStack.length}isTransactionShouldReplaceView(){return QQ.I.state.transactionStack[QQ.I.state.transactionStack.length-1]?.replace}static getInstance(){return this.instance}updateFeatures(e){VG.H.setFeatures(e)}updateOptions(e){const t={...VG.H.state||{},...e};VG.H.setOptions(t)}setConnectMethodsOrder(e){VG.H.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){VG.H.setWalletFeaturesOrder(e)}setCollapseWallets(e){VG.H.setCollapseWallets(e)}setSocialsOrder(e){VG.H.setSocialsOrder(e)}getConnectMethodsOrder(){return XQ.A.getConnectOrderMethod(VG.H.state.features,LG.a.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const n=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find((e=>e.id===n.id))||jG.W.addNetwork(n)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const n=this.getCaipNetworks().find((e=>e.id===t));n&&jG.W.removeNetwork(e,t)}}let WX,GX=!1;class qX extends HX{setupAuthConnectorListeners(e){e.onRpcRequest((t=>{nq.Q.checkIfRequestExists(t)?nq.Q.checkIfRequestIsSafe(t)||this.handleUnsafeRPCRequest():(this.open(),console.error(iq.Vl.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:t.method}),setTimeout((()=>{this.showErrorMessage(iq.Vl.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)}),300),e.rejectRpcRequests())})),e.onRpcError((()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack(!0))})),e.onRpcSuccess(((e,t)=>{const n=nq.Q.checkIfRequestIsSafe(t),i=FG.U.state.address,r=jG.W.state.activeCaipNetwork;n||(this.isTransactionStackEmpty()?(this.close(),i&&r?.id&&this.updateNativeBalance(i,r.id,r.chainNamespace)):(this.popTransactionStack(),i&&r?.id&&this.updateNativeBalance(i,r.id,r.chainNamespace)))})),e.onNotConnected((()=>{const e=jG.W.state.activeChain;LG.a.getConnectorId(e)===OG.o.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,e),this.setLoading(!1,e))})),e.onConnect((async t=>{const n=jG.W.state.activeChain,i=n===OG.o.CHAIN.EVM?`eip155:${t.chainId}:${t.address}`:`${t.chainId}:${t.address}`,r=t.preferredAccountType||FG.U.state.preferredAccountTypes?.[n]||VG.H.state.defaultAccountTypes[n];qG.y.isLowerCaseMatch(t.address,FG.U.state.address)||this.syncIdentity({address:t.address,chainId:t.chainId,chainNamespace:n}),this.setCaipAddress(i,n),this.setUser({...FG.U.state.user||{},...t},n),this.setSmartAccountDeployed(Boolean(t.smartAccountDeployed),n),this.setPreferredAccountType(r,n);const s=t.accounts?.map((e=>IG.w.createAccount(n,e.address,e.type||FG.U.state.preferredAccountTypes?.[n]||VG.H.state.defaultAccountTypes[n])));this.setAllAccounts(s||[IG.w.createAccount(n,t.address,t.preferredAccountType||r)],n),await e.getSmartAccountEnabledNetworks(),this.setLoading(!1,n)})),e.onSocialConnected((e=>{let{userName:t}=e;this.setUser({...FG.U.state.user||{},username:t},jG.W.state.activeChain)})),e.onGetSmartAccountEnabledNetworks((e=>{this.setSmartAccountEnabledNetworks(e,jG.W.state.activeChain)})),e.onSetPreferredAccount((e=>{let{address:t,type:n}=e;t&&this.setPreferredAccountType(n,jG.W.state.activeChain)}))}async syncAuthConnector(e,t){const n=OG.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t);if(!n)return;this.setLoading(!0,t);const i=e.getLoginEmailUsed();this.setLoading(i,t),i&&this.setStatus("connecting",t);const r=e.getEmail(),s=e.getUsername();this.setUser({...FG.U.state?.user||{},username:s,email:r},jG.W.state.activeChain),this.setupAuthConnectorListeners(e);const{isConnected:a}=await e.isConnected(),o=HG.W.getSnapshot(),l=VG.H.getSnapshot();e.syncDappData({metadata:l.metadata,sdkVersion:l.sdkVersion,projectId:l.projectId,sdkType:l.sdkType}),e.syncTheme({themeMode:o.themeMode,themeVariables:o.themeVariables,w3mThemeVariables:(0,DG.o)(o.themeVariables,o.themeMode)}),t&&n&&(a&&this.connectionControllerClient?.connectExternal?(await(this.connectionControllerClient?.connectExternal({id:OG.o.CONNECTOR_ID.AUTH,info:{name:OG.o.CONNECTOR_ID.AUTH},type:KG.o.CONNECTOR_TYPE_AUTH,provider:e,chainId:jG.W.state.activeCaipNetwork?.id,chain:t})),this.setStatus("connected",t)):LG.a.getConnectorId(t)===OG.o.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",t),WG.i.removeConnectedNamespace(t))),this.setLoading(!1,t)}async checkExistingTelegramSocialConnection(e){try{if(!IG.w.isTelegram())return;const t=WG.i.getTelegramSocialProvider();if(!t)return;if("undefined"===typeof window||"undefined"===typeof document)return;const n=new URL(window.location.href).searchParams.get("result_uri");if(!n)return;FG.U.setSocialProvider(t,e),await(this.authProvider?.init());const i=LG.a.getAuthConnector();t&&i&&(this.setLoading(!0,e),await i.provider.connectSocial(n),await RG.x.connectExternal(i,i.chain),WG.i.setConnectedSocialProvider(t),WG.i.removeTelegramSocialProvider(),kG.E.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:t}}))}catch(t){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",t)}try{const e=new URL(window.location.href);e.searchParams.delete("result_uri"),window.history.replaceState({},document.title,e.toString())}catch(t){console.error("tma social login failed",t)}}createAuthProvider(e){if(!OG.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const t=void 0===this.options?.features?.email?BG.oU.DEFAULT_FEATURES.email:this.options?.features?.email,n=this.options?.features?.socials?this.options?.features?.socials?.length>0:BG.oU.DEFAULT_FEATURES.socials,i=t||n;!this.authProvider&&this.options?.projectId&&i&&(this.authProvider=FQ.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:this.getCaipNetwork(e)?.caipNetworkId,onTimeout:()=>{GG.h.open(YG.ALERT_ERRORS.SOCIALS_TIMEOUT,"error")}}),UG.z.subscribeOpen((e=>{!e&&this.isTransactionStackEmpty()&&this.authProvider?.rejectRpcRequests()})),e===OG.o.CHAIN.EVM&&FG.U.state.preferredAccountTypes?.eip155&&this.authProvider.setPreferredAccount(FG.U.state.preferredAccountTypes?.eip155),this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){this.createAuthProvider(e),this.authProvider&&this.chainAdapters?.[e]?.setAuthProvider?.(this.authProvider)}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&zG.N.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){if(!e)return;const t=jG.W.state.activeChain,n=e.chainNamespace,i=this.getAddressByChainNamespace(e.chainNamespace);if(e.chainNamespace===jG.W.state.activeChain&&i){const t=this.getAdapter(n),i=$G.getProvider(n),r=$G.getProviderId(n);await(t?.switchNetwork({caipNetwork:e,provider:i,providerType:r})),this.setCaipNetwork(e)}else{const s=$G.getProviderId(t)===KG.o.CONNECTOR_TYPE_AUTH,a=$G.getProviderId(n),o=a===KG.o.CONNECTOR_TYPE_AUTH,l=OG.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n);if((s||o)&&l)try{jG.W.state.activeChain=e.chainNamespace,await(this.connectionControllerClient?.connectExternal?.({id:OG.o.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:n,chainId:e.id,type:KG.o.CONNECTOR_TYPE_AUTH,caipNetwork:e})),this.setCaipNetwork(e)}catch(r){const t=this.getAdapter(n);await(t?.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:a}))}else a===KG.o.CONNECTOR_TYPE_WALLET_CONNECT?(this.setCaipNetwork(e),this.syncWalletConnectAccount()):(this.setCaipNetwork(e),i&&this.syncAccount({address:i,chainId:e.id,chainNamespace:n}))}}async initChainAdapter(e){await super.initChainAdapter(e),this.createAuthProviderForAdapter(e)}async syncIdentity(e){let{address:t,chainId:n,chainNamespace:i}=e;const r=`${i}:${n}`,s=this.caipNetworks?.find((e=>e.caipNetworkId===r));if(i!==OG.o.CHAIN.EVM||s?.testnet)return this.setProfileName(null,i),void this.setProfileImage(null,i);try{const{name:e,avatar:s}=await this.fetchIdentity({address:t,caipNetworkId:r});if(this.setProfileName(e,i),this.setProfileImage(s,i),!e){const e=this.getAdapter(i),r=await(e?.getProfile({address:t,chainId:Number(n)}));r?.profileName?(this.setProfileName(r.profileName,i),r.profileImage&&this.setProfileImage(r.profileImage,i)):(await this.syncReownName(t,i),this.setProfileImage(null,i))}}catch{await this.syncReownName(t,i),1!==n&&this.setProfileImage(null,i)}}syncConnectedWalletInfo(e){const t=$G.getProviderId(e);if(t===KG.o.CONNECTOR_TYPE_AUTH){const n=this.authProvider;if(n){const i=WG.i.getConnectedSocialProvider()??"email",r=n.getEmail()??n.getUsername();this.setConnectedWalletInfo({name:t,identifier:r,social:i},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(!GX&&IG.w.isClient()){const e={...BG.oU.DEFAULT_FEATURES,...this.options.features},t=[];if(e){(e.email||e.socials&&e.socials.length)&&t.push(Promise.all([n.e(7),n.e(6867),n.e(8126)]).then(n.bind(n,38126))),e.email&&t.push(Promise.all([n.e(7),n.e(6867),n.e(5465)]).then(n.bind(n,25465))),e.socials&&t.push(Promise.all([n.e(7),n.e(5938),n.e(1191)]).then(n.bind(n,51191))),e.swaps&&t.push(Promise.all([n.e(7),n.e(6867),n.e(1117),n.e(7556)]).then(n.bind(n,77556))),e.send&&t.push(Promise.all([n.e(7),n.e(6867),n.e(1117),n.e(8486)]).then(n.bind(n,88486))),e.receive&&t.push(Promise.all([n.e(7),n.e(5938),n.e(1150)]).then(n.bind(n,91150))),e.onramp&&t.push(Promise.all([n.e(7),n.e(6867),n.e(9190),n.e(1250)]).then(n.bind(n,51250))),e.history&&t.push(Promise.all([n.e(7),n.e(374),n.e(4093)]).then(n.bind(n,37192)))}await Promise.all([...t,Promise.all([n.e(7),n.e(6867),n.e(5938),n.e(9190),n.e(374),n.e(4865),n.e(7209)]).then(n.bind(n,37209)),Promise.all([n.e(7),n.e(4865),n.e(2456)]).then(n.bind(n,41036))]);if(!document.querySelector("w3m-modal")){const e=document.createElement("w3m-modal");VG.H.state.disableAppend||VG.H.state.enableEmbedded||document.body.insertAdjacentElement("beforeend",e)}GX=!0}}}let KX;const YX=()=>{const[e,n]=(0,t.useState)(!1),{open:i,close:r}=function(){if(!WX)throw new Error('Please call "createAppKit" before using "useAppKit" hook');return{open:async function(e){await(WX?.open(e))},close:async function(){await(WX?.close())}}}();return(0,t.useEffect)((()=>{}),[]),(0,gt.jsxs)(gt.Fragment,{children:[(0,gt.jsxs)("div",{className:"main-liner main-bg-img vh-100",children:[(0,gt.jsx)(gG,{}),(0,gt.jsx)("img",{src:vG,className:"floating-asset asset1",alt:"i1"}),(0,gt.jsx)("img",{src:yG,className:"floating-asset asset2",alt:"i1"}),(0,gt.jsx)("img",{src:bG,className:"floating-asset asset3",alt:"i1"}),(0,gt.jsx)("img",{src:wG,className:"floating-asset asset4",alt:"i1"}),(0,gt.jsx)("img",{src:xG,className:"floating-asset asset5",alt:"i1"}),(0,gt.jsx)("img",{src:EG,className:"floating-asset asset6",alt:"i1"}),(0,gt.jsx)("img",{src:CG,className:"floating-asset asset7",alt:"i1"}),(0,gt.jsx)("img",{src:AG,className:"floating-asset asset8",alt:"i1"}),(0,gt.jsx)("img",{src:SG,className:"floating-asset asset9",alt:"i1"}),(0,gt.jsx)("img",{src:_G,className:"floating-asset asset10 z-2",alt:"i1"}),(0,gt.jsx)("img",{src:TG,className:"floating-asset asset11 z-2",alt:"i1"}),(0,gt.jsx)("img",{src:PG,className:"floating-asset asset12",alt:"i1"}),(0,gt.jsx)("img",{src:MG,className:"floating-asset asset13",alt:"i1"}),(0,gt.jsxs)("div",{className:"container",children:[(0,gt.jsx)("h1",{className:"text-center text-white",style:{paddingTop:"7rem",fontWeight:"700",textShadow:"0 0.4rem 0.15rem rgb(55 59 62 / 30%)"},children:"World's First Real World Assets (RWA)"}),(0,gt.jsx)("h1",{className:"text-center text-white",style:{fontWeight:"700",textShadow:"0 0.4rem 0.15rem rgb(55 59 62 / 30%)"},children:"Backed Presale"}),(0,gt.jsxs)("p",{className:"text-center text-white",style:{fontSize:"1.1rem",textShadow:"0 0.25rem 0.15rem rgb(55 59 62 / 50%)"},children:["OneWave Presale sets a new benchmark in crypto\u2014backed by real-world assets ",(0,gt.jsx)("br",{})," like gold, silver, and certified gems for unmatched trust and value"]}),(0,gt.jsx)("div",{className:"container-fluid  pt-5 z-0",children:(0,gt.jsxs)("div",{className:"row gx-4 justify-content-center",children:[(0,gt.jsx)("div",{className:"col-md-6 col-lg-3 mb-4",children:(0,gt.jsxs)("div",{className:"presale-card position-relative bg-white rounded-4 shadow-sm p-3",children:[(0,gt.jsx)("h4",{className:"fw-bold mb-4",children:"Presale Phase 1"}),(0,gt.jsx)("hr",{className:""}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Price"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"$0.2"})]}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Cliff"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"12 Months"})]}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Vesting"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"5% X 20 Months"})]}),(0,gt.jsx)("div",{className:"text-center pt-3",children:(0,gt.jsx)("button",{className:"btn btn-primary w-100 fw-bold",onClick:i,children:"Buy Now"})})]})}),(0,gt.jsx)("div",{className:"col-md-6 col-lg-3 mb-4",children:(0,gt.jsxs)("div",{className:"presale-card position-relative bg-white rounded-4 shadow-sm p-3",children:[(0,gt.jsx)("h4",{className:"fw-bold mb-4",children:"Presale Phase 2"}),(0,gt.jsx)("hr",{className:""}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Price"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"$0.4"})]}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Cliff"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"9 Months"})]}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Vesting"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"5% X 20 Months"})]}),(0,gt.jsx)("div",{className:"text-center pt-3",children:(0,gt.jsx)("button",{className:"btn btn-primary w-100 fw-bold",onClick:i,children:"Buy Now"})})]})}),(0,gt.jsx)("div",{className:"col-md-6 col-lg-3 mb-4",children:(0,gt.jsxs)("div",{className:"presale-card position-relative bg-white rounded-4 shadow-sm p-3",children:[(0,gt.jsx)("h4",{className:"fw-bold mb-4",children:"Presale Phase 3"}),(0,gt.jsx)("hr",{className:""}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Price"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"$0.6"})]}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Cliff"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"6 Months"})]}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Vesting"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"5% X 20 Months"})]}),(0,gt.jsx)("div",{className:"text-center pt-3",children:(0,gt.jsx)("button",{className:"btn btn-primary w-100 fw-bold",onClick:i,children:"Buy Now"})})]})}),(0,gt.jsx)("div",{className:"col-md-6 col-lg-3 mb-4",children:(0,gt.jsxs)("div",{className:"presale-card position-relative bg-white rounded-4 shadow-sm p-3",children:[(0,gt.jsx)("h4",{className:"fw-bold mb-4",children:"Presale Phase 4"}),(0,gt.jsx)("hr",{className:""}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Price"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"$0.8"})]}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Cliff"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"3 Months"})]}),(0,gt.jsxs)("div",{className:"info-row d-flex py-2",children:[(0,gt.jsx)("span",{className:"label me-auto",children:"Vesting"}),(0,gt.jsx)("div",{className:"flex-grow-1 mx-2 dor-range"})," ",(0,gt.jsx)("span",{className:"value",children:"5% X 20 Months"})]}),(0,gt.jsx)("div",{className:"text-center pt-3",children:(0,gt.jsx)("button",{className:"btn btn-primary w-100 fw-bold",onClick:i,children:"Buy Now"})})]})})]})})]})]}),(0,gt.jsx)(NG,{show:e,onClose:()=>n(!1)})]})};const QX=function(){return(0,gt.jsx)(gt.Fragment,{children:(0,gt.jsx)(Ce,{children:(0,gt.jsxs)(ve,{children:[(0,gt.jsx)(me,{path:"/",element:(0,gt.jsx)(mG,{})}),(0,gt.jsx)(me,{path:"/signin",element:(0,gt.jsx)(vt,{})}),(0,gt.jsx)(me,{path:"/signup",element:(0,gt.jsx)(bt,{})}),(0,gt.jsx)(me,{path:"/forgot-password",element:(0,gt.jsx)(wt,{})}),(0,gt.jsx)(me,{path:"/presale",element:(0,gt.jsx)(YX,{})})]})})})},XX=e=>{e&&e instanceof Function&&n.e(6453).then(n.bind(n,46453)).then((t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:s,getTTFB:a}=t;n(e),i(e),r(e),s(e),a(e)}))};let ZX=!1;async function JX(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(ZX)return[];ZX=!0,e.setState((e=>({...e,status:e.current?"reconnecting":"connecting"})));const n=[];if(t.connectors?.length)for(const c of t.connectors){let t;t="function"===typeof c?e._internal.connectors.setup(c):c,n.push(t)}else n.push(...e.connectors);let i;try{i=await(e.storage?.getItem("recentConnectorId"))}catch{}const r={};for(const[,c]of e.state.connections)r[c.connector.id]=1;i&&(r[i]=0);const s=Object.keys(r).length>0?[...n].sort(((e,t)=>(r[e.id]??10)-(r[t.id]??10))):n;let a=!1;const o=[],l=[];for(const c of s){const t=await c.getProvider().catch((()=>{}));if(!t)continue;if(l.some((e=>e===t)))continue;if(!await c.isAuthorized())continue;const n=await c.connect({isReconnecting:!0}).catch((()=>null));n&&(c.emitter.off("connect",e._internal.events.connect),c.emitter.on("change",e._internal.events.change),c.emitter.on("disconnect",e._internal.events.disconnect),e.setState((e=>{const t=new Map(a?e.connections:new Map).set(c.uid,{accounts:n.accounts,chainId:n.chainId,connector:c});return{...e,current:a?e.current:c.uid,connections:t}})),o.push({accounts:n.accounts,chainId:n.chainId,connector:c}),l.push(t),a=!0)}return"reconnecting"!==e.state.status&&"connecting"!==e.state.status||(a?e.setState((e=>({...e,status:"connected"}))):e.setState((e=>({...e,connections:new Map,current:null,status:"disconnected"})))),ZX=!1,o}function $X(e){const{children:n,config:i,initialState:r,reconnectOnMount:s=!0}=e,{onMount:a}=function(e,t){const{initialState:n,reconnectOnMount:i}=t;return n&&!e._internal.store.persist.hasHydrated()&&e.setState({...n,chainId:e.chains.some((e=>e.id===n.chainId))?n.chainId:e.chains[0].id,connections:i?n.connections:new Map,status:i?"reconnecting":"disconnected"}),{async onMount(){e._internal.ssr&&(await e._internal.store.persist.rehydrate(),e._internal.mipd&&e._internal.connectors.setState((t=>{const n=new Set;for(const e of t??[])if(e.rdns){const t=Array.isArray(e.rdns)?e.rdns:[e.rdns];for(const e of t)n.add(e)}const i=[],r=e._internal.mipd?.getProviders()??[];for(const s of r){if(n.has(s.info.rdns))continue;const t=e._internal.connectors.providerDetailToConnector(s),r=e._internal.connectors.setup(t);i.push(r)}return[...t,...i]}))),i?JX(e):e.storage&&e.setState((e=>({...e,connections:new Map})))}}}(i,{initialState:r,reconnectOnMount:s});i._internal.ssr||a();const o=(0,t.useRef)(!0);return(0,t.useEffect)((()=>{if(o.current&&i._internal.ssr)return a(),()=>{o.current=!1}}),[]),n}const eZ=(0,t.createContext)(void 0);function tZ(e){const{children:n,config:i}=e,r={value:i};return(0,t.createElement)($X,e,(0,t.createElement)(eZ.Provider,r,n))}var nZ="undefined"===typeof window||"Deno"in globalThis;function iZ(){}function rZ(e,t){return"function"===typeof e?e(t):e}function sZ(e,t){const{type:n="all",exact:i,fetchStatus:r,predicate:s,queryKey:a,stale:o}=e;if(a)if(i){if(t.queryHash!==oZ(a,t.options))return!1}else if(!cZ(t.queryKey,a))return!1;if("all"!==n){const e=t.isActive();if("active"===n&&!e)return!1;if("inactive"===n&&e)return!1}return("boolean"!==typeof o||t.isStale()===o)&&((!r||r===t.state.fetchStatus)&&!(s&&!s(t)))}function aZ(e,t){const{exact:n,status:i,predicate:r,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(n){if(lZ(t.options.mutationKey)!==lZ(s))return!1}else if(!cZ(t.options.mutationKey,s))return!1}return(!i||t.state.status===i)&&!(r&&!r(t))}function oZ(e,t){return(t?.queryKeyHashFn||lZ)(e)}function lZ(e){return JSON.stringify(e,((e,t)=>dZ(t)?Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{}):t))}function cZ(e,t){return e===t||typeof e===typeof t&&(!(!e||!t||"object"!==typeof e||"object"!==typeof t)&&Object.keys(t).every((n=>cZ(e[n],t[n]))))}function hZ(e,t){if(e===t)return e;const n=uZ(e)&&uZ(t);if(n||dZ(e)&&dZ(t)){const i=n?e:Object.keys(e),r=i.length,s=n?t:Object.keys(t),a=s.length,o=n?[]:{};let l=0;for(let c=0;c<a;c++){const r=n?c:s[c];(!n&&i.includes(r)||n)&&void 0===e[r]&&void 0===t[r]?(o[r]=void 0,l++):(o[r]=hZ(e[r],t[r]),o[r]===e[r]&&void 0!==e[r]&&l++)}return r===a&&l===r?e:o}return t}function uZ(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function dZ(e){if(!pZ(e))return!1;const t=e.constructor;if(void 0===t)return!0;const n=t.prototype;return!!pZ(n)&&(!!n.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function pZ(e){return"[object Object]"===Object.prototype.toString.call(e)}function fZ(e,t,n){return"function"===typeof n.structuralSharing?n.structuralSharing(e,t):!1!==n.structuralSharing?hZ(e,t):t}function mZ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=[...e,t];return n&&i.length>n?i.slice(1):i}function gZ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=[t,...e];return n&&i.length>n?i.slice(0,-1):i}var vZ=Symbol();function yZ(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==vZ?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}var bZ=e=>setTimeout(e,0);var wZ=function(){let e=[],t=0,n=e=>{e()},i=e=>{e()},r=bZ;const s=i=>{t?e.push(i):r((()=>{n(i)}))};return{batch:s=>{let a;t++;try{a=s()}finally{t--,t||(()=>{const t=e;e=[],t.length&&r((()=>{i((()=>{t.forEach((e=>{n(e)}))}))}))})()}return a},batchCalls:e=>function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];s((()=>{e(...n)}))},schedule:s,setNotifyFunction:e=>{n=e},setBatchNotifyFunction:e=>{i=e},setScheduler:e=>{r=e}}}(),xZ=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},EZ=new class extends xZ{#e;#t;#n;constructor(){super(),this.#n=e=>{if(!nZ&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#n=e,this.#t?.(),this.#t=e((e=>{"boolean"===typeof e?this.setFocused(e):this.onFocus()}))}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach((t=>{t(e)}))}isFocused(){return"boolean"===typeof this.#e?this.#e:"hidden"!==globalThis.document?.visibilityState}},CZ=new class extends xZ{#i=!0;#t;#n;constructor(){super(),this.#n=e=>{if(!nZ&&window.addEventListener){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#n=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#i!==e&&(this.#i=e,this.listeners.forEach((t=>{t(e)})))}isOnline(){return this.#i}};function AZ(e){return Math.min(1e3*2**e,3e4)}function SZ(e){return"online"!==(e??"online")||CZ.isOnline()}var _Z=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function TZ(e){return e instanceof _Z}function PZ(e){let t,n=!1,i=0,r=!1;const s=function(){let e,t;const n=new Promise(((n,i)=>{e=n,t=i}));function i(e){Object.assign(n,e),delete n.resolve,delete n.reject}return n.status="pending",n.catch((()=>{})),n.resolve=t=>{i({status:"fulfilled",value:t}),e(t)},n.reject=e=>{i({status:"rejected",reason:e}),t(e)},n}(),a=()=>EZ.isFocused()&&("always"===e.networkMode||CZ.isOnline())&&e.canRun(),o=()=>SZ(e.networkMode)&&e.canRun(),l=n=>{r||(r=!0,e.onSuccess?.(n),t?.(),s.resolve(n))},c=n=>{r||(r=!0,e.onError?.(n),t?.(),s.reject(n))},h=()=>new Promise((n=>{t=e=>{(r||a())&&n(e)},e.onPause?.()})).then((()=>{t=void 0,r||e.onContinue?.()})),u=()=>{if(r)return;let t;const s=0===i?e.initialPromise:void 0;try{t=s??e.fn()}catch(o){t=Promise.reject(o)}Promise.resolve(t).then(l).catch((t=>{if(r)return;const s=e.retry??(nZ?0:3),o=e.retryDelay??AZ,l="function"===typeof o?o(i,t):o,d=!0===s||"number"===typeof s&&i<s||"function"===typeof s&&s(i,t);var p;!n&&d?(i++,e.onFail?.(i,t),(p=l,new Promise((e=>{setTimeout(e,p)}))).then((()=>a()?void 0:h())).then((()=>{n?c(t):u()}))):c(t)}))};return{promise:s,cancel:t=>{r||(c(new _Z(t)),e.abort?.())},continue:()=>(t?.(),s),cancelRetry:()=>{n=!0},continueRetry:()=>{n=!1},canStart:o,start:()=>(o()?u():h().then(u),s)}}var MZ=class{#r;destroy(){this.clearGcTimeout()}scheduleGc(){var e;this.clearGcTimeout(),"number"===typeof(e=this.gcTime)&&e>=0&&e!==1/0&&(this.#r=setTimeout((()=>{this.optionalRemove()}),this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(nZ?1/0:3e5))}clearGcTimeout(){this.#r&&(clearTimeout(this.#r),this.#r=void 0)}},NZ=class extends MZ{#s;#a;#o;#l;#c;#h;#u;constructor(e){super(),this.#u=!1,this.#h=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#l=e.client,this.#o=this.#l.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#s=function(e){const t="function"===typeof e.initialData?e.initialData():e.initialData,n=void 0!==t,i=n?"function"===typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}(this.options),this.state=e.state??this.#s,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#c?.promise}setOptions(e){this.options={...this.#h,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#o.remove(this)}setData(e,t){const n=fZ(this.state.data,e,this.options);return this.#d({data:n,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),n}setState(e,t){this.#d({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#c?.promise;return this.#c?.cancel(e),t?t.then(iZ).catch(iZ):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#s)}isActive(){return this.observers.some((e=>{return!1!==(t=e.options.enabled,n=this,"function"===typeof t?t(n):t);var t,n}))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===vZ||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return!!this.state.isInvalidated||(this.getObserversCount()>0?this.observers.some((e=>e.getCurrentResult().isStale)):void 0===this.state.data)}isStaleByTime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.state.isInvalidated||void 0===this.state.data||!function(e,t){return Math.max(e+(t||0)-Date.now(),0)}(this.state.dataUpdatedAt,e)}onFocus(){const e=this.observers.find((e=>e.shouldFetchOnWindowFocus()));e?.refetch({cancelRefetch:!1}),this.#c?.continue()}onOnline(){const e=this.observers.find((e=>e.shouldFetchOnReconnect()));e?.refetch({cancelRefetch:!1}),this.#c?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#o.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter((t=>t!==e)),this.observers.length||(this.#c&&(this.#u?this.#c.cancel({revert:!0}):this.#c.cancelRetry()),this.scheduleGc()),this.#o.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#d({type:"invalidate"})}fetch(e,t){if("idle"!==this.state.fetchStatus)if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#c)return this.#c.continueRetry(),this.#c.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find((e=>e.options.queryFn));e&&this.setOptions(e.options)}const n=new AbortController,i=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#u=!0,n.signal)})},r={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#l,state:this.state,fetchFn:()=>{const e=yZ(this.options,t),n={client:this.#l,queryKey:this.queryKey,meta:this.meta};return i(n),this.#u=!1,this.options.persister?this.options.persister(e,n,this):e(n)}};i(r),this.options.behavior?.onFetch(r,this),this.#a=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===r.fetchOptions?.meta||this.#d({type:"fetch",meta:r.fetchOptions?.meta});const s=e=>{TZ(e)&&e.silent||this.#d({type:"error",error:e}),TZ(e)||(this.#o.config.onError?.(e,this),this.#o.config.onSettled?.(this.state.data,e,this)),this.scheduleGc()};return this.#c=PZ({initialPromise:t?.initialPromise,fn:r.fetchFn,abort:n.abort.bind(n),onSuccess:e=>{if(void 0!==e){try{this.setData(e)}catch(t){return void s(t)}this.#o.config.onSuccess?.(e,this),this.#o.config.onSettled?.(e,this.state.error,this),this.scheduleGc()}else s(new Error(`${this.queryHash} data is undefined`))},onError:s,onFail:(e,t)=>{this.#d({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#d({type:"pause"})},onContinue:()=>{this.#d({type:"continue"})},retry:r.options.retry,retryDelay:r.options.retryDelay,networkMode:r.options.networkMode,canRun:()=>!0}),this.#c.start()}#d(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...IZ(t.data,this.options),fetchMeta:e.meta??null};case"success":return{...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=e.error;return TZ(n)&&n.revert&&this.#a?{...this.#a,fetchStatus:"idle"}:{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),wZ.batch((()=>{this.observers.forEach((e=>{e.onQueryUpdate()})),this.#o.notify({query:this,type:"updated",action:e})}))}};function IZ(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:SZ(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}var OZ=class extends xZ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.config=e,this.#p=new Map}#p;build(e,t,n){const i=t.queryKey,r=t.queryHash??oZ(i,t);let s=this.get(r);return s||(s=new NZ({client:e,queryKey:i,queryHash:r,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(s)),s}add(e){this.#p.has(e.queryHash)||(this.#p.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#p.get(e.queryHash);t&&(e.destroy(),t===e&&this.#p.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){wZ.batch((()=>{this.getAll().forEach((e=>{this.remove(e)}))}))}get(e){return this.#p.get(e)}getAll(){return[...this.#p.values()]}find(e){const t={exact:!0,...e};return this.getAll().find((e=>sZ(t,e)))}findAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.getAll();return Object.keys(e).length>0?t.filter((t=>sZ(e,t))):t}notify(e){wZ.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}onFocus(){wZ.batch((()=>{this.getAll().forEach((e=>{e.onFocus()}))}))}onOnline(){wZ.batch((()=>{this.getAll().forEach((e=>{e.onOnline()}))}))}},DZ=class extends MZ{#f;#m;#c;constructor(e){super(),this.mutationId=e.mutationId,this.#m=e.mutationCache,this.#f=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#f.includes(e)||(this.#f.push(e),this.clearGcTimeout(),this.#m.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#f=this.#f.filter((t=>t!==e)),this.scheduleGc(),this.#m.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#f.length||("pending"===this.state.status?this.scheduleGc():this.#m.remove(this))}continue(){return this.#c?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#d({type:"continue"})};this.#c=PZ({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#d({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#d({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#m.canRun(this)});const n="pending"===this.state.status,i=!this.#c.canStart();try{if(n)t();else{this.#d({type:"pending",variables:e,isPaused:i}),await(this.#m.config.onMutate?.(e,this));const t=await(this.options.onMutate?.(e));t!==this.state.context&&this.#d({type:"pending",context:t,variables:e,isPaused:i})}const r=await this.#c.start();return await(this.#m.config.onSuccess?.(r,e,this.state.context,this)),await(this.options.onSuccess?.(r,e,this.state.context)),await(this.#m.config.onSettled?.(r,null,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(r,null,e,this.state.context)),this.#d({type:"success",data:r}),r}catch(r){try{throw await(this.#m.config.onError?.(r,e,this.state.context,this)),await(this.options.onError?.(r,e,this.state.context)),await(this.#m.config.onSettled?.(void 0,r,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(void 0,r,e,this.state.context)),r}finally{this.#d({type:"error",error:r})}}finally{this.#m.runNext(this)}}#d(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),wZ.batch((()=>{this.#f.forEach((t=>{t.onMutationUpdate(e)})),this.#m.notify({mutation:this,type:"updated",action:e})}))}};var LZ=class extends xZ{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.config=e,this.#g=new Set,this.#v=new Map,this.#y=0}#g;#v;#y;build(e,t,n){const i=new DZ({mutationCache:this,mutationId:++this.#y,options:e.defaultMutationOptions(t),state:n});return this.add(i),i}add(e){this.#g.add(e);const t=RZ(e);if("string"===typeof t){const n=this.#v.get(t);n?n.push(e):this.#v.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#g.delete(e)){const t=RZ(e);if("string"===typeof t){const n=this.#v.get(t);if(n)if(n.length>1){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}else n[0]===e&&this.#v.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=RZ(e);if("string"===typeof t){const n=this.#v.get(t),i=n?.find((e=>"pending"===e.state.status));return!i||i===e}return!0}runNext(e){const t=RZ(e);if("string"===typeof t){const n=this.#v.get(t)?.find((t=>t!==e&&t.state.isPaused));return n?.continue()??Promise.resolve()}return Promise.resolve()}clear(){wZ.batch((()=>{this.#g.forEach((e=>{this.notify({type:"removed",mutation:e})})),this.#g.clear(),this.#v.clear()}))}getAll(){return Array.from(this.#g)}find(e){const t={exact:!0,...e};return this.getAll().find((e=>aZ(t,e)))}findAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getAll().filter((t=>aZ(e,t)))}notify(e){wZ.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}resumePausedMutations(){const e=this.getAll().filter((e=>e.state.isPaused));return wZ.batch((()=>Promise.all(e.map((e=>e.continue().catch(iZ))))))}};function RZ(e){return e.options.scope?.id}function kZ(e){return{onFetch:(t,n)=>{const i=t.options,r=t.fetchOptions?.meta?.fetchMore?.direction,s=t.state.data?.pages||[],a=t.state.data?.pageParams||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let n=!1;const c=yZ(t.options,t.fetchOptions),h=async(e,i,r)=>{if(n)return Promise.reject();if(null==i&&e.pages.length)return Promise.resolve(e);const s={client:t.client,queryKey:t.queryKey,pageParam:i,direction:r?"backward":"forward",meta:t.options.meta};var a;a=s,Object.defineProperty(a,"signal",{enumerable:!0,get:()=>(t.signal.aborted?n=!0:t.signal.addEventListener("abort",(()=>{n=!0})),t.signal)});const o=await c(s),{maxPages:l}=t.options,h=r?gZ:mZ;return{pages:h(e.pages,o,l),pageParams:h(e.pageParams,i,l)}};if(r&&s.length){const e="backward"===r,t={pages:s,pageParams:a},n=(e?UZ:BZ)(i,t);o=await h(t,n,e)}else{const t=e??s.length;do{const e=0===l?a[0]??i.initialPageParam:BZ(i,o);if(l>0&&null==e)break;o=await h(o,e),l++}while(l<t)}return o};t.options.persister?t.fetchFn=()=>t.options.persister?.(c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n):t.fetchFn=c}}}function BZ(e,t){let{pages:n,pageParams:i}=t;const r=n.length-1;return n.length>0?e.getNextPageParam(n[r],n,i[r],i):void 0}function UZ(e,t){let{pages:n,pageParams:i}=t;return n.length>0?e.getPreviousPageParam?.(n[0],n,i[0],i):void 0}var zZ=t.createContext(void 0),FZ=e=>{let{client:n,children:i}=e;return t.useEffect((()=>(n.mount(),()=>{n.unmount()})),[n]),(0,gt.jsx)(zZ.Provider,{value:n,children:i})};function jZ(e){const t=e.state.current,n=e.state.connections.get(t),i=n?.accounts,r=i?.[0],s=e.chains.find((e=>e.id===n?.chainId)),a=e.state.status;switch(a){case"connected":return{address:r,addresses:i,chain:s,chainId:n?.chainId,connector:n?.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:a};case"reconnecting":return{address:r,addresses:i,chain:s,chainId:n?.chainId,connector:n?.connector,isConnected:!!r,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:a};case"connecting":return{address:r,addresses:i,chain:s,chainId:n?.chainId,connector:n?.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:a};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:a}}}function VZ(){const e=new Set;let t=[];const n=()=>function(e){if("undefined"===typeof window)return;const t=t=>e(t.detail);return window.addEventListener("eip6963:announceProvider",t),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",t)}((n=>{t.some((e=>{let{info:t}=e;return t.uuid===n.info.uuid}))||(t=[...t,n],e.forEach((e=>e(t,{added:[n]}))))}));let i=n();return{_listeners:()=>e,clear(){e.forEach((e=>e([],{removed:[...t]}))),t=[]},destroy(){this.clear(),e.clear(),i?.()},findProvider(e){let{rdns:n}=e;return t.find((e=>e.info.rdns===n))},getProviders:()=>t,reset(){this.clear(),i?.(),i=n()},subscribe(n){let{emitImmediately:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.add(n),i&&n(t,{added:t}),()=>e.delete(n)}}}var HZ=n(64034);function WZ(e){const{batch:t,cacheTime:n=e.pollingInterval??4e3,ccipRead:i,key:r="base",name:s="Base Client",pollingInterval:a=4e3,type:o="base"}=e,l=e.chain,c=e.account?(0,HZ.J)(e.account):void 0,{config:h,request:u,value:d}=e.transport({chain:l,pollingInterval:a}),p={account:c,batch:t,cacheTime:n,ccipRead:i,chain:l,key:r,name:s,pollingInterval:a,request:u,transport:{...h,...d},type:o,uid:mX()};return Object.assign(p,{extend:function e(t){return n=>{const i=n(t);for(const e in p)delete i[e];const r={...t,...i};return Object.assign(r,{extend:e(r)})}}(p)})}const GZ=e=>(t,n,i)=>{const r=i.subscribe;i.subscribe=(e,t,n)=>{let s=e;if(t){const r=(null==n?void 0:n.equalityFn)||Object.is;let a=e(i.getState());s=n=>{const i=e(n);if(!r(a,i)){const e=a;t(a=i,e)}},(null==n?void 0:n.fireImmediately)&&t(a,a)}return r(s)};return e(t,n,i)};function qZ(e,t){let n;try{n=e()}catch(yw){return}const i={getItem:e=>{var i;const r=e=>null===e?null:JSON.parse(e,null==t?void 0:t.reviver),s=null!=(i=n.getItem(e))?i:null;return s instanceof Promise?s.then(r):r(s)},setItem:(e,i)=>n.setItem(e,JSON.stringify(i,null==t?void 0:t.replacer)),removeItem:e=>n.removeItem(e)};return i}const KZ=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then:e=>KZ(e)(n),catch(e){return this}}}catch(yw){return{then(e){return this},catch:t=>KZ(t)(yw)}}},YZ=(e,t)=>(n,i,r)=>{let s={storage:qZ((()=>localStorage)),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},a=!1;const o=new Set,l=new Set;let c=s.storage;if(!c)return e((function(){console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...arguments)}),i,r);const h=()=>{const e=s.partialize({...i()});return c.setItem(s.name,{state:e,version:s.version})},u=r.setState;r.setState=(e,t)=>{u(e,t),h()};const d=e((function(){n(...arguments),h()}),i,r);let p;r.getInitialState=()=>d;const f=()=>{var e,t;if(!c)return;a=!1,o.forEach((e=>{var t;return e(null!=(t=i())?t:d)}));const r=(null==(t=s.onRehydrateStorage)?void 0:t.call(s,null!=(e=i())?e:d))||void 0;return KZ(c.getItem.bind(c))(s.name).then((e=>{if(e){if("number"!==typeof e.version||e.version===s.version)return[!1,e.state];if(s.migrate)return[!0,s.migrate(e.state,e.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]})).then((e=>{var t;const[r,a]=e;if(p=s.merge(a,null!=(t=i())?t:d),n(p,!0),r)return h()})).then((()=>{null==r||r(p,void 0),p=i(),a=!0,l.forEach((e=>e(p)))})).catch((e=>{null==r||r(void 0,e)}))};return r.persist={setOptions:e=>{s={...s,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>f(),hasHydrated:()=>a,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},s.skipHydration||f(),p||d},QZ=e=>{let t;const n=new Set,i=(e,i)=>{const r="function"===typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=i?i:"object"!==typeof r||null===r)?r:Object.assign({},t,r),n.forEach((n=>n(t,e)))}},r=()=>t,s={setState:i,getState:r,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e))},a=t=e(i,r,s);return s},XZ=e=>e?QZ(e):QZ;var ZZ=n(43028),JZ=n(38639),$Z=n(60392);class eJ extends $Z.C{constructor(){super("Provider not found."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderNotFoundError"})}}class tJ extends $Z.C{constructor(e){let{connector:t}=e;super(`"${t.name}" does not support programmatic chain switching.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainNotSupportedError"})}}var nJ=n(98677);function iJ(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{shimDisconnect:t=!0,unstable_shimAsyncInject:n}=e;function i(){const t=e.target;if("function"===typeof t){const e=t();if(e)return e}return"object"===typeof t?t:"string"===typeof t?{...rJ[t]??{id:t,name:`${t[0].toUpperCase()}${t.slice(1)}`,provider:`is${t[0].toUpperCase()}${t.slice(1)}`}}:{id:"injected",name:"Injected",provider:e=>e?.ethereum}}let r,s,a,o;return(0,nJ.U)((l=>({get icon(){return i().icon},get id(){return i().id},get name(){return i().name},get supportsSimulation(){return!0},type:iJ.type,async setup(){const t=await this.getProvider();t?.on&&e.target&&(a||(a=this.onConnect.bind(this),t.on("connect",a)),r||(r=this.onAccountsChanged.bind(this),t.on("accountsChanged",r)))},async connect(){let{chainId:n,isReconnecting:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const c=await this.getProvider();if(!c)throw new eJ;let h=[];if(i)h=await this.getAccounts().catch((()=>[]));else if(t)try{const e=await c.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]});if(h=e[0]?.caveats?.[0]?.value?.map((e=>(0,ZZ.b)(e))),h.length>0){h=await this.getAccounts()}}catch(u){const e=u;if(e.code===aX.vx.code)throw new aX.vx(e);if(e.code===aX.qZ.code)throw e}try{if(!h?.length&&!i){h=(await c.request({method:"eth_requestAccounts"})).map((e=>(0,ZZ.b)(e)))}a&&(c.removeListener("connect",a),a=void 0),r||(r=this.onAccountsChanged.bind(this),c.on("accountsChanged",r)),s||(s=this.onChainChanged.bind(this),c.on("chainChanged",s)),o||(o=this.onDisconnect.bind(this),c.on("disconnect",o));let u=await this.getChainId();if(n&&u!==n){const e=await this.switchChain({chainId:n}).catch((e=>{if(e.code===aX.vx.code)throw e;return{id:u}}));u=e?.id??u}return t&&await(l.storage?.removeItem(`${this.id}.disconnected`)),e.target||await(l.storage?.setItem("injected.connected",!0)),{accounts:h,chainId:u}}catch(u){const e=u;if(e.code===aX.vx.code)throw new aX.vx(e);if(e.code===aX.qZ.code)throw new aX.qZ(e);throw e}},async disconnect(){const n=await this.getProvider();if(!n)throw new eJ;s&&(n.removeListener("chainChanged",s),s=void 0),o&&(n.removeListener("disconnect",o),o=void 0),a||(a=this.onConnect.bind(this),n.on("connect",a));try{await nX((()=>n.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]})),{timeout:100})}catch{}t&&await(l.storage?.setItem(`${this.id}.disconnected`,!0)),e.target||await(l.storage?.removeItem("injected.connected"))},async getAccounts(){const e=await this.getProvider();if(!e)throw new eJ;return(await e.request({method:"eth_accounts"})).map((e=>(0,ZZ.b)(e)))},async getChainId(){const e=await this.getProvider();if(!e)throw new eJ;const t=await e.request({method:"eth_chainId"});return Number(t)},async getProvider(){if("undefined"===typeof window)return;let e;const t=i();return e="function"===typeof t.provider?t.provider(window):"string"===typeof t.provider?sJ(window,t.provider):t.provider,e&&!e.removeListener&&("off"in e&&"function"===typeof e.off?e.removeListener=e.off:e.removeListener=()=>{}),e},async isAuthorized(){try{if(t&&await(l.storage?.getItem(`${this.id}.disconnected`)))return!1;if(!e.target){if(!await(l.storage?.getItem("injected.connected")))return!1}if(!await this.getProvider()){if(void 0!==n&&!1!==n){const e=async()=>{"undefined"!==typeof window&&window.removeEventListener("ethereum#initialized",e);return!!await this.getProvider()},t="number"===typeof n?n:1e3;if(await Promise.race([..."undefined"!==typeof window?[new Promise((t=>window.addEventListener("ethereum#initialized",(()=>t(e())),{once:!0})))]:[],new Promise((n=>setTimeout((()=>n(e())),t)))]))return!0}throw new eJ}return!!(await uX((()=>this.getAccounts()))).length}catch{return!1}},async switchChain(e){let{addEthereumChainParameter:t,chainId:n}=e;const i=await this.getProvider();if(!i)throw new eJ;const r=l.chains.find((e=>e.id===n));if(!r)throw new aX.ch(new JZ.nk);const s=new Promise((e=>{const t=i=>{"chainId"in i&&i.chainId===n&&(l.emitter.off("change",t),e())};l.emitter.on("change",t)}));try{return await Promise.all([i.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,oX.cK)(n)}]}).then((async()=>{await this.getChainId()===n&&l.emitter.emit("change",{chainId:n})})),s]),r}catch(a){const e=a;if(4902===e.code||4902===e?.data?.originalError?.code)try{const{default:e,...a}=r.blockExplorers??{};let o,c;t?.blockExplorerUrls?o=t.blockExplorerUrls:e&&(o=[e.url,...Object.values(a).map((e=>e.url))]),c=t?.rpcUrls?.length?t.rpcUrls:[r.rpcUrls.default?.http[0]??""];const h={blockExplorerUrls:o,chainId:(0,oX.cK)(n),chainName:t?.chainName??r.name,iconUrls:t?.iconUrls,nativeCurrency:t?.nativeCurrency??r.nativeCurrency,rpcUrls:c};return await Promise.all([i.request({method:"wallet_addEthereumChain",params:[h]}).then((async()=>{if(await this.getChainId()!==n)throw new aX.vx(new Error("User rejected switch after adding network."));l.emitter.emit("change",{chainId:n})})),s]),r}catch(o){throw new aX.vx(o)}if(e.code===aX.vx.code)throw new aX.vx(e);throw new aX.ch(e)}},async onAccountsChanged(e){if(0===e.length)this.onDisconnect();else if(l.emitter.listenerCount("connect")){const e=(await this.getChainId()).toString();this.onConnect({chainId:e}),t&&await(l.storage?.removeItem(`${this.id}.disconnected`))}else l.emitter.emit("change",{accounts:e.map((e=>(0,ZZ.b)(e)))})},onChainChanged(e){const t=Number(e);l.emitter.emit("change",{chainId:t})},async onConnect(e){const t=await this.getAccounts();if(0===t.length)return;const n=Number(e.chainId);l.emitter.emit("connect",{accounts:t,chainId:n});const i=await this.getProvider();i&&(a&&(i.removeListener("connect",a),a=void 0),r||(r=this.onAccountsChanged.bind(this),i.on("accountsChanged",r)),s||(s=this.onChainChanged.bind(this),i.on("chainChanged",s)),o||(o=this.onDisconnect.bind(this),i.on("disconnect",o)))},async onDisconnect(e){const t=await this.getProvider();e&&1013===e.code&&t&&(await this.getAccounts()).length||(l.emitter.emit("disconnect"),t&&(s&&(t.removeListener("chainChanged",s),s=void 0),o&&(t.removeListener("disconnect",o),o=void 0),a||(a=this.onConnect.bind(this),t.on("connect",a))))}})))}iJ.type="injected";const rJ={coinbaseWallet:{id:"coinbaseWallet",name:"Coinbase Wallet",provider:e=>e?.coinbaseWalletExtension?e.coinbaseWalletExtension:sJ(e,"isCoinbaseWallet")},metaMask:{id:"metaMask",name:"MetaMask",provider:e=>sJ(e,(e=>{if(!e.isMetaMask)return!1;if(e.isBraveWallet&&!e._events&&!e._state)return!1;const t=["isApexWallet","isAvalanche","isBitKeep","isBlockWallet","isKuCoinWallet","isMathWallet","isOkxWallet","isOKExWallet","isOneInchIOSWallet","isOneInchAndroidWallet","isOpera","isPhantom","isPortal","isRabby","isTokenPocket","isTokenary","isUniswapWallet","isZerion"];for(const n of t)if(e[n])return!1;return!0}))},phantom:{id:"phantom",name:"Phantom",provider:e=>e?.phantom?.ethereum?e.phantom?.ethereum:sJ(e,"isPhantom")}};function sJ(e,t){function n(e){return"function"===typeof t?t(e):"string"!==typeof t||e[t]}const i=e.ethereum;return i?.providers?i.providers.find((e=>n(e))):i&&n(i)?i:void 0}var aJ=n(52898);class oJ{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:new aJ})}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}emit(e){const t=arguments.length<=1?void 0:arguments[1];this._emitter.emit(e,{uid:this.uid,...t})}listenerCount(e){return this._emitter.listenerCount(e)}}function lJ(e,t){return JSON.parse(e,((e,n)=>{let i=n;return"bigint"===i?.__type&&(i=BigInt(i.value)),"Map"===i?.__type&&(i=new Map(i.value)),t?.(e,i)??i}))}function cJ(e,t){return e.slice(0,t).join(".")||"."}function hJ(e,t){const{length:n}=e;for(let i=0;i<n;++i)if(e[i]===t)return i+1;return 0}function uJ(e,t,n,i){return JSON.stringify(e,function(e,t){const n="function"===typeof e,i="function"===typeof t,r=[],s=[];return function(a,o){if("object"===typeof o)if(r.length){const e=hJ(r,this);0===e?r[r.length]=this:(r.splice(e),s.splice(e)),s[s.length]=a;const n=hJ(r,o);if(0!==n)return i?t.call(this,a,o,cJ(s,n)):`[ref=${cJ(s,n)}]`}else r[0]=o,s[0]=a;return n?e.call(this,a,o):o}}(((e,n)=>{let i=n;return"bigint"===typeof i&&(i={__type:"bigint",value:n.toString()}),i instanceof Map&&(i={__type:"Map",value:Array.from(n.entries())}),t?.(e,i)??i}),i),n??void 0)}function dJ(e){const{deserialize:t=lJ,key:n="wagmi",serialize:i=uJ,storage:r=pJ}=e;function s(e){return e instanceof Promise?e.then((e=>e)).catch((()=>null)):e}return{...r,key:n,async getItem(e,i){const a=r.getItem(`${n}.${e}`),o=await s(a);return o?t(o)??null:i??null},async setItem(e,t){const a=`${n}.${e}`;null===t?await s(r.removeItem(a)):await s(r.setItem(a,i(t)))},async removeItem(e){await s(r.removeItem(`${n}.${e}`))}}}const pJ={getItem:()=>null,setItem:()=>{},removeItem:()=>{}};function fJ(){const e="undefined"!==typeof window&&window.localStorage?window.localStorage:pJ;return{getItem:t=>e.getItem(t),removeItem(t){e.removeItem(t)},setItem(t,n){try{e.setItem(t,n)}catch{}}}}let mJ,gJ=256;var vJ=n(15977);function yJ(e){const{multiInjectedProviderDiscovery:t=!0,storage:n=dJ({storage:fJ()}),syncConnectedChain:i=!0,ssr:r=!1,...s}=e,a="undefined"!==typeof window&&t?VZ():void 0,o=XZ((()=>s.chains)),l=XZ((()=>{const e=[],t=new Set;for(const n of s.connectors??[]){const i=c(n);if(e.push(i),!r&&i.rdns){const e="string"===typeof i.rdns?[i.rdns]:i.rdns;for(const n of e)t.add(n)}}if(!r&&a){const n=a.getProviders();for(const i of n)t.has(i.info.rdns)||e.push(c(h(i)))}return e}));function c(e){const t=function(e){return new oJ(e)}(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:11;if(!mJ||gJ+e>512){mJ="",gJ=0;for(let e=0;e<256;e++)mJ+=(256+256*Math.random()|0).toString(16).substring(1)}return mJ.substring(gJ,gJ+++e)}()),i={...e({emitter:t,chains:o.getState(),storage:n,transports:s.transports}),emitter:t,uid:t.uid};return t.on("connect",y),i.setup?.(),i}function h(e){const{info:t}=e,n=e.provider;return iJ({target:{...t,id:t.rdns,provider:n}})}const u=new Map;function d(){return{chainId:o.getState()[0].id,connections:new Map,current:null,status:"disconnected"}}let p;const f="0.0.0-canary-";p=vJ.r.startsWith(f)?Number.parseInt(vJ.r.replace(f,"")):Number.parseInt(vJ.r.split(".")[0]??"0");const m=XZ(GZ(n?YZ(d,{migrate(e,t){if(t===p)return e;const n=d(),i=g(e,n.chainId);return{...n,chainId:i}},name:"store",partialize:e=>({connections:{__type:"Map",value:Array.from(e.connections.entries()).map((e=>{let[t,n]=e;const{id:i,name:r,type:s,uid:a}=n.connector,o={id:i,name:r,type:s,uid:a};return[t,{...n,connector:o}]}))},chainId:e.chainId,current:e.current}),merge(e,t){"object"===typeof e&&e&&"status"in e&&delete e.status;const n=g(e,t.chainId);return{...t,...e,chainId:n}},skipHydration:r,storage:n,version:p}):d));function g(e,t){return e&&"object"===typeof e&&"chainId"in e&&"number"===typeof e.chainId&&o.getState().some((t=>t.id===e.chainId))?e.chainId:t}function v(e){m.setState((t=>{const n=t.connections.get(e.uid);return n?{...t,connections:new Map(t.connections).set(e.uid,{accounts:e.accounts??n.accounts,chainId:e.chainId??n.chainId,connector:n.connector})}:t}))}function y(e){"connecting"!==m.getState().status&&"reconnecting"!==m.getState().status&&m.setState((t=>{const n=l.getState().find((t=>t.uid===e.uid));return n?(n.emitter.listenerCount("connect")&&n.emitter.off("connect",v),n.emitter.listenerCount("change")||n.emitter.on("change",v),n.emitter.listenerCount("disconnect")||n.emitter.on("disconnect",b),{...t,connections:new Map(t.connections).set(e.uid,{accounts:e.accounts,chainId:e.chainId,connector:n}),current:e.uid,status:"connected"}):t}))}function b(e){m.setState((t=>{const n=t.connections.get(e.uid);if(n){const e=n.connector;e.emitter.listenerCount("change")&&n.connector.emitter.off("change",v),e.emitter.listenerCount("disconnect")&&n.connector.emitter.off("disconnect",b),e.emitter.listenerCount("connect")||n.connector.emitter.on("connect",y)}if(t.connections.delete(e.uid),0===t.connections.size)return{...t,connections:new Map,current:null,status:"disconnected"};const i=t.connections.values().next().value;return{...t,connections:new Map(t.connections),current:i.connector.uid}}))}return m.setState(d()),i&&m.subscribe((e=>{let{connections:t,current:n}=e;return n?t.get(n)?.chainId:void 0}),(e=>{if(o.getState().some((t=>t.id===e)))return m.setState((t=>({...t,chainId:e??t.chainId})))})),a?.subscribe((e=>{const t=new Set,i=new Set;for(const n of l.getState())if(t.add(n.id),n.rdns){const e="string"===typeof n.rdns?[n.rdns]:n.rdns;for(const t of e)i.add(t)}const r=[];for(const n of e){if(i.has(n.info.rdns))continue;const e=c(h(n));t.has(e.id)||r.push(e)}n&&!m.persist.hasHydrated()||l.setState((e=>[...e,...r]),!0)})),{get chains(){return o.getState()},get connectors(){return l.getState()},storage:n,getClient:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.chainId??m.getState().chainId,n=o.getState().find((e=>e.id===t));if(e.chainId&&!n)throw new JZ.nk;{const e=u.get(m.getState().chainId);if(e&&!n)return e;if(!n)throw new JZ.nk}{const e=u.get(t);if(e)return e}let i;if(s.client)i=s.client({chain:n});else{const e=n.id,t=o.getState().map((e=>e.id)),r={},a=Object.entries(s);for(const[n,i]of a)if("chains"!==n&&"client"!==n&&"connectors"!==n&&"transports"!==n)if("object"===typeof i)if(e in i)r[n]=i[e];else{if(t.some((e=>e in i)))continue;r[n]=i}else r[n]=i;i=WZ({...r,chain:n,batch:r.batch??{multicall:!0},transport:t=>s.transports[e]({...t,connectors:l})})}return u.set(t,i),i},get state(){return m.getState()},setState(e){let t;t="function"===typeof e?e(m.getState()):e;const n=d();"object"!==typeof t&&(t=n);Object.keys(n).some((e=>!(e in t)))&&(t=n),m.setState(t,!0)},subscribe:(e,t,n)=>m.subscribe(e,t,n?{...n,fireImmediately:n.emitImmediately}:void 0),_internal:{mipd:a,store:m,ssr:Boolean(r),syncConnectedChain:i,transports:s.transports,chains:{setState(e){const t="function"===typeof e?e(o.getState()):e;if(0!==t.length)return o.setState(t,!0)},subscribe:e=>o.subscribe(e)},connectors:{providerDetailToConnector:h,setup:c,setState:e=>l.setState("function"===typeof e?e(l.getState()):e,!0),subscribe:e=>l.subscribe(e)},events:{change:v,connect:y,disconnect:b}}}}function bJ(e,t,n){const i=e[t.name];if("function"===typeof i)return i;const r=e[n];return"function"===typeof r?r:n=>t(e,n)}const wJ=new Map,xJ=new Map;let EJ=0;function CJ(e,t,n){const i=++EJ,r=()=>wJ.get(e)||[],s=()=>{const t=r();if(!t.some((e=>e.id===i)))return;const n=xJ.get(e);1===t.length&&n&&n(),(()=>{const t=r();wJ.set(e,t.filter((e=>e.id!==i)))})()},a=r();if(wJ.set(e,[...a,{id:i,fns:t}]),a&&a.length>0)return s;const o={};for(const c in t)o[c]=function(){const e=r();if(0!==e.length){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(const t of e)t.fns[c]?.(...n)}};const l=n(o);return"function"===typeof l&&xJ.set(e,l),s}function AJ(e,t){let{emitOnBegin:n,initialWaitTime:i,interval:r}=t,s=!0;const a=()=>s=!1;return(async()=>{let t;n&&(t=await e({unpoll:a}));const o=await(i?.(t))??r;await hX(o);const l=async()=>{s&&(await e({unpoll:a}),await hX(r),l())};l()})(),a}async function SJ(e){const t=function(e,t){let{method:n}=t;const i={};return"fallback"===e.transport.type&&e.transport.onResponse?.((e=>{let{method:t,response:r,status:s,transport:a}=e;"success"===s&&n===t&&(i[r]=a.request)})),t=>i[t]||e.request}(e,{method:"eth_newPendingTransactionFilter"}),n=await e.request({method:"eth_newPendingTransactionFilter"});return{id:n,request:t(n),type:"transaction"}}var _J=n(97965),TJ=n(6816),PJ=n(37131),MJ=n(81064),NJ=n(30284),IJ=n(22017),OJ=n(99577),DJ=n(63206),LJ=n(59052);const RJ="/docs/contract/decodeEventLog";function kJ(e){let{param:t,value:n}=e;if("string"===t.type||"bytes"===t.type||"tuple"===t.type||t.type.match(/^(.*)\[(\d+)?\]$/))return n;return((0,DJ.n)([t],n)||[])[0]}function BJ(e){const{abi:t,args:n,logs:i,strict:r=!0}=e,s=(()=>{if(e.eventName)return Array.isArray(e.eventName)?e.eventName:[e.eventName]})();return i.map((e=>{try{const i=t.find((t=>"event"===t.type&&e.topics[0]===(0,NJ.h)(t)));if(!i)return null;const a=function(e){const{abi:t,data:n,strict:i,topics:r}=e,s=i??!0,[a,...o]=r;if(!a)throw new _J._z({docsPath:RJ});const l=1===t.length?t[0]:t.find((e=>"event"===e.type&&a===(0,NJ.h)((0,LJ.B)(e))));if(!l||!("name"in l)||"event"!==l.type)throw new _J.kE(a,{docsPath:RJ});const{name:c,inputs:h}=l,u=h?.some((e=>!("name"in e&&e.name)));let d=u?[]:{};const p=h.filter((e=>"indexed"in e&&e.indexed));for(let g=0;g<p.length;g++){const e=p[g],t=o[g];if(!t)throw new _J.l3({abiItem:l,param:e});d[u?g:e.name||g]=kJ({param:e,value:t})}const f=h.filter((e=>!("indexed"in e&&e.indexed)));if(f.length>0)if(n&&"0x"!==n)try{const e=(0,DJ.n)(f,n);if(e)if(u)d=[...d,...e];else for(let t=0;t<f.length;t++)d[f[t].name]=e[t]}catch(m){if(s){if(m instanceof _J.Iy||m instanceof OJ.SK)throw new _J.fo({abiItem:l,data:n,params:f,size:(0,IJ.E)(n)});throw m}}else if(s)throw new _J.fo({abiItem:l,data:"0x",params:f,size:0});return{eventName:c,args:Object.values(d).length>0?d:void 0}}({...e,abi:[i],strict:r});return s&&!s.includes(a.eventName)?null:function(e){const{args:t,inputs:n,matchArgs:i}=e;if(!i)return!0;if(!t)return!1;function r(e,t,n){try{return"address"===e.type?(0,TJ.h)(t,n):"string"===e.type||"bytes"===e.type?(0,MJ.S)((0,PJ.ZJ)(t))===n:t===n}catch{return!1}}if(Array.isArray(t)&&Array.isArray(i))return i.every(((e,i)=>{if(null===e||void 0===e)return!0;const s=n[i];if(!s)return!1;return(Array.isArray(e)?e:[e]).some((e=>r(s,e,t[i])))}));return"object"===typeof t&&!Array.isArray(t)&&"object"===typeof i&&!Array.isArray(i)&&Object.entries(i).every((e=>{let[i,s]=e;if(null===s||void 0===s)return!0;const a=n.find((e=>e.name===i));if(!a)return!1;return(Array.isArray(s)?s:[s]).some((e=>r(a,e,t[i])))}))}({args:a.args,inputs:i.inputs,matchArgs:n})?{...a,...e}:null}catch(i){let t,n;if(i instanceof _J.kE)return null;if(i instanceof _J.fo||i instanceof _J.l3){if(r)return null;t=i.abiItem.name,n=i.abiItem.inputs?.some((e=>!("name"in e&&e.name)))}return{...e,args:n?[]:{},eventName:t}}})).filter(Boolean)}function UJ(e){let{args:t,eventName:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,logIndex:e.logIndex?Number(e.logIndex):null,transactionHash:e.transactionHash?e.transactionHash:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,...n?{args:t,eventName:n}:{}}}async function zJ(e,t){let{filter:n}=t;const i="strict"in n&&n.strict,r=await n.request({method:"eth_getFilterChanges",params:[n.id]});if("string"===typeof r[0])return r;const s=r.map((e=>UJ(e)));return"abi"in n&&n.abi?BJ({abi:n.abi,logs:s,strict:i}):s}async function FJ(e,t){let{filter:n}=t;return n.request({method:"eth_uninstallFilter",params:[n.id]})}function jJ(e,t){let{batch:n=!0,onError:i,onTransactions:r,poll:s,pollingInterval:a=e.pollingInterval}=t;return("undefined"!==typeof s?s:"webSocket"!==e.transport.type)?CJ((0,iX.A)(["watchPendingTransactions",e.uid,n,a]),{onTransactions:r,onError:i},(t=>{let i;const r=AJ((async()=>{try{if(!i)try{return void(i=await bJ(e,SJ,"createPendingTransactionFilter")({}))}catch(s){throw r(),s}const a=await bJ(e,zJ,"getFilterChanges")({filter:i});if(0===a.length)return;if(n)t.onTransactions(a);else for(const e of a)t.onTransactions([e])}catch(s){t.onError?.(s)}}),{emitOnBegin:!0,interval:a});return async()=>{i&&await bJ(e,FJ,"uninstallFilter")({filter:i}),r()}})):(()=>{let t=!0,n=()=>t=!1;return(async()=>{try{const{unsubscribe:s}=await e.transport.subscribe({params:["newPendingTransactions"],onData(e){if(!t)return;const n=e.result;r([n])},onError(e){i?.(e)}});n=s,t||n()}catch(s){i?.(s)}})(),()=>n()})()}function VJ(e,t,n){const i=e[t.name];if("function"===typeof i)return i;const r=e[n];return"function"===typeof r?r:n=>t(e,n)}function HJ(e,t){if(e===t)return!0;if(e&&t&&"object"===typeof e&&"object"===typeof t){if(e.constructor!==t.constructor)return!1;let n,i;if(Array.isArray(e)&&Array.isArray(t)){if(n=e.length,n!==t.length)return!1;for(i=n;0!==i--;)if(!HJ(e[i],t[i]))return!1;return!0}if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const r=Object.keys(e);if(n=r.length,n!==Object.keys(t).length)return!1;for(i=n;0!==i--;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(i=n;0!==i--;){const n=r[i];if(n&&!HJ(e[n],t[n]))return!1}return!0}return e!==e&&t!==t}class WJ extends $Q.C{constructor(){let{docsPath:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join("\n"),{docsPath:e,docsSlug:"account",name:"AccountNotFoundError"})}}class GJ extends $Q.C{constructor(e){let{docsPath:t,metaMessages:n,type:i}=e;super(`Account type "${i}" is not supported.`,{docsPath:t,metaMessages:n,name:"AccountTypeNotSupportedError"})}}async function qJ(e,t){let{account:n=e.account,message:i}=t;if(!n)throw new WJ({docsPath:"/docs/actions/wallet/signMessage"});const r=(0,HZ.J)(n);if(r.signMessage)return r.signMessage({message:i});const s="string"===typeof i?(0,oX.i3)(i):i.raw instanceof Uint8Array?(0,oX.nj)(i.raw):i.raw;return e.request({method:"personal_sign",params:[s,r.address]},{retryCount:0})}async function KJ(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.connector){const{connector:i}=n;if("reconnecting"===e.state.status&&!i.getAccounts&&!i.getChainId)throw new JZ.HF({connector:i});const[r,s]=await Promise.all([i.getAccounts().catch((e=>{if(null===n.account)return[];throw e})),i.getChainId()]);t={accounts:r,chainId:s,connector:i}}else t=e.state.connections.get(e.state.current);if(!t)throw new JZ.gC;const i=n.chainId??t.chainId,r=await t.connector.getChainId();if(r!==t.chainId)throw new JZ.xU({connectionChainId:t.chainId,connectorChainId:r});const s=t.connector;if(s.getClient)return s.getClient({chainId:i});const a=(0,HZ.J)(n.account??t.accounts[0]);if(a&&(a.address=(0,ZZ.b)(a.address)),n.account&&!t.accounts.some((e=>e.toLowerCase()===a.address.toLowerCase())))throw new JZ.aj({address:a.address,connector:s});const o=e.chains.find((e=>e.id===i)),l=await t.connector.getProvider({chainId:i});return WZ({account:a,chain:o,name:"Connector Client",transport:e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{key:n="custom",methods:i,name:r="Custom Provider",retryDelay:s}=t;return a=>{let{retryCount:o}=a;return gX({key:n,methods:i,name:r,request:e.request.bind(e),retryCount:t.retryCount??o,retryDelay:s,type:"custom"})}}(l)({...e,retryCount:0})})}var YJ=n(4569);class QJ extends $Q.C{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class XJ extends $Q.C{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class ZJ extends $Q.C{constructor(e){let{maxPriorityFeePerGas:t}=e;super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${(0,YJ.Q)(t)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}var JJ=n(67962);class $J extends $Q.C{constructor(e){let{blockHash:t,blockNumber:n}=e,i="Block";t&&(i=`Block at hash "${t}"`),n&&(i=`Block at number "${n}"`),super(`${i} could not be found.`,{name:"BlockNotFoundError"})}}const e$={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function t$(e){const t={...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,chainId:e.chainId?(0,JJ.ME)(e.chainId):void 0,gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,maxFeePerBlobGas:e.maxFeePerBlobGas?BigInt(e.maxFeePerBlobGas):void 0,maxFeePerGas:e.maxFeePerGas?BigInt(e.maxFeePerGas):void 0,maxPriorityFeePerGas:e.maxPriorityFeePerGas?BigInt(e.maxPriorityFeePerGas):void 0,nonce:e.nonce?(0,JJ.ME)(e.nonce):void 0,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,type:e.type?e$[e.type]:void 0,typeHex:e.type?e.type:void 0,value:e.value?BigInt(e.value):void 0,v:e.v?BigInt(e.v):void 0};return e.authorizationList&&(t.authorizationList=e.authorizationList.map((e=>({address:e.address,chainId:Number(e.chainId),nonce:Number(e.nonce),r:e.r,s:e.s,yParity:Number(e.yParity)})))),t.yParity=(()=>{if(e.yParity)return Number(e.yParity);if("bigint"===typeof t.v){if(0n===t.v||27n===t.v)return 0;if(1n===t.v||28n===t.v)return 1;if(t.v>=35n)return t.v%2n===0n?1:0}})(),"legacy"===t.type&&(delete t.accessList,delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,delete t.yParity),"eip2930"===t.type&&(delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas),"eip1559"===t.type&&delete t.maxFeePerBlobGas,t}function n$(e){const t=(e.transactions??[]).map((e=>"string"===typeof e?e:t$(e)));return{...e,baseFeePerGas:e.baseFeePerGas?BigInt(e.baseFeePerGas):null,blobGasUsed:e.blobGasUsed?BigInt(e.blobGasUsed):void 0,difficulty:e.difficulty?BigInt(e.difficulty):void 0,excessBlobGas:e.excessBlobGas?BigInt(e.excessBlobGas):void 0,gasLimit:e.gasLimit?BigInt(e.gasLimit):void 0,gasUsed:e.gasUsed?BigInt(e.gasUsed):void 0,hash:e.hash?e.hash:null,logsBloom:e.logsBloom?e.logsBloom:null,nonce:e.nonce?e.nonce:null,number:e.number?BigInt(e.number):null,size:e.size?BigInt(e.size):void 0,timestamp:e.timestamp?BigInt(e.timestamp):void 0,transactions:t,totalDifficulty:e.totalDifficulty?BigInt(e.totalDifficulty):null}}async function i$(e){let{blockHash:t,blockNumber:n,blockTag:i,includeTransactions:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=i??"latest",a=r??!1,o=void 0!==n?(0,oX.cK)(n):void 0;let l=null;if(l=t?await e.request({method:"eth_getBlockByHash",params:[t,a]},{dedupe:!0}):await e.request({method:"eth_getBlockByNumber",params:[o||s,a]},{dedupe:Boolean(o)}),!l)throw new $J({blockHash:t,blockNumber:n});return(e.chain?.formatters?.block?.format||n$)(l)}async function r$(e){const t=await e.request({method:"eth_gasPrice"});return BigInt(t)}async function s$(e,t){const{block:n,chain:i=e.chain,request:r}=t||{};try{const t=i?.fees?.maxPriorityFeePerGas??i?.fees?.defaultPriorityFee;if("function"===typeof t){const i=n||await bJ(e,i$,"getBlock")({}),s=await t({block:i,client:e,request:r});if(null===s)throw new Error;return s}if("undefined"!==typeof t)return t;const s=await e.request({method:"eth_maxPriorityFeePerGas"});return(0,JJ.uU)(s)}catch{const[t,i]=await Promise.all([n?Promise.resolve(n):bJ(e,i$,"getBlock")({}),bJ(e,r$,"getGasPrice")({})]);if("bigint"!==typeof t.baseFeePerGas)throw new XJ;const r=i-t.baseFeePerGas;return r<0n?0n:r}}async function a$(e,t){const{block:n,chain:i=e.chain,request:r,type:s="eip1559"}=t||{},a=await(async()=>"function"===typeof i?.fees?.baseFeeMultiplier?i.fees.baseFeeMultiplier({block:n,client:e,request:r}):i?.fees?.baseFeeMultiplier??1.2)();if(a<1)throw new QJ;const o=10**(a.toString().split(".")[1]?.length??0),l=e=>e*BigInt(Math.ceil(a*o))/BigInt(o),c=n||await bJ(e,i$,"getBlock")({});if("function"===typeof i?.fees?.estimateFeesPerGas){const t=await i.fees.estimateFeesPerGas({block:n,client:e,multiply:l,request:r,type:s});if(null!==t)return t}if("eip1559"===s){if("bigint"!==typeof c.baseFeePerGas)throw new XJ;const t="bigint"===typeof r?.maxPriorityFeePerGas?r.maxPriorityFeePerGas:await s$(e,{block:c,chain:i,request:r}),n=l(c.baseFeePerGas);return{maxFeePerGas:r?.maxFeePerGas??n+t,maxPriorityFeePerGas:t}}return{gasPrice:r?.gasPrice??l(await bJ(e,r$,"getGasPrice")({}))}}var o$=n(31499);function l$(e){if(0===e||1===e)return e;if(27===e)return 0;if(28===e)return 1;throw new Error("Invalid yParityOrV value")}async function c$(e){let{hash:t,signature:i}=e;return function(e){const t=(0,MJ.S)(`0x${e.substring(4)}`).substring(26);return(0,ZZ.o)(`0x${t}`)}(await async function(e){let{hash:t,signature:i}=e;const r=(0,o$.q)(t)?t:(0,oX.nj)(t),{secp256k1:s}=await n.e(9252).then(n.bind(n,39252)),a=(()=>{if("object"===typeof i&&"r"in i&&"s"in i){const{r:e,s:t,v:n,yParity:r}=i,a=l$(Number(r??n));return new s.Signature((0,JJ.uU)(e),(0,JJ.uU)(t)).addRecoveryBit(a)}const e=(0,o$.q)(i)?i:(0,oX.nj)(i),t=l$((0,JJ.ME)(`0x${e.slice(130)}`));return s.Signature.fromCompact(e.substring(2,130)).addRecoveryBit(t)})();return`0x${a.recoverPublicKey(r.substring(2)).toHex(!1)}`}({hash:t,signature:i}))}var h$=n(52620),u$=n(30751);function d$(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hex";const n=p$(e),i=(0,u$.l)(new Uint8Array(n.length));return n.encode(i),"hex"===t?(0,oX.My)(i.bytes):i.bytes}function p$(e){return Array.isArray(e)?function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=f$(t);return{length:t<=55?1+t:1+n+t,encode(i){t<=55?i.pushByte(192+t):(i.pushByte(247+n),1===n?i.pushUint8(t):2===n?i.pushUint16(t):3===n?i.pushUint24(t):i.pushUint32(t));for(const{encode:t}of e)t(i)}}}(e.map((e=>p$(e)))):function(e){const t="string"===typeof e?(0,PJ.aT)(e):e,n=f$(t.length),i=1===t.length&&t[0]<128?1:t.length<=55?1+t.length:1+n+t.length;return{length:i,encode(e){1===t.length&&t[0]<128?e.pushBytes(t):t.length<=55?(e.pushByte(128+t.length),e.pushBytes(t)):(e.pushByte(183+n),1===n?e.pushUint8(t.length):2===n?e.pushUint16(t.length):3===n?e.pushUint24(t.length):e.pushUint32(t.length),e.pushBytes(t))}}}(e)}function f$(e){if(e<256)return 1;if(e<65536)return 2;if(e<2**24)return 3;if(e<2**32)return 4;throw new $Q.C("Length is too large.")}function m$(e){const{chainId:t,nonce:n,to:i}=e,r=e.contractAddress??e.address,s=(0,MJ.S)((0,h$.aP)(["0x05",d$([t?(0,oX.cK)(t):"0x",r,n?(0,oX.cK)(n):"0x"])]));return"bytes"===i?(0,PJ.aT)(s):s}async function g$(e){const{authorization:t,signature:n}=e;return c$({hash:m$(t),signature:n??t})}var v$=n(1273),y$=n(83003);class b$ extends $Q.C{constructor(e,t){let{account:n,docsPath:i,chain:r,data:s,gas:a,gasPrice:o,maxFeePerGas:l,maxPriorityFeePerGas:c,nonce:h,to:u,value:d}=t;const p=(0,y$.aO)({from:n?.address,to:u,value:"undefined"!==typeof d&&`${(0,v$.c)(d)} ${r?.nativeCurrency?.symbol||"ETH"}`,data:s,gas:a,gasPrice:"undefined"!==typeof o&&`${(0,YJ.Q)(o)} gwei`,maxFeePerGas:"undefined"!==typeof l&&`${(0,YJ.Q)(l)} gwei`,maxPriorityFeePerGas:"undefined"!==typeof c&&`${(0,YJ.Q)(c)} gwei`,nonce:h});super(e.shortMessage,{cause:e,docsPath:i,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Estimate Gas Arguments:",p].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}var w$=n(26615);var x$=n(41928),E$=n(6812),C$=n(93692),A$=n(40920);async function S$(e,t){let{address:n,blockNumber:i,blockTag:r="latest"}=t;const s=i?(0,oX.cK)(i):void 0,a=await e.request({method:"eth_getBalance",params:[n,s||r]});return BigInt(a)}async function _$(e,t){const{account:n=e.account}=t,i=n?(0,HZ.J)(n):void 0;try{const{accessList:s,authorizationList:a,blobs:o,blobVersionedHashes:l,blockNumber:c,blockTag:h,data:u,gas:d,gasPrice:p,maxFeePerBlobGas:f,maxFeePerGas:m,maxPriorityFeePerGas:g,nonce:v,value:y,stateOverride:b,...w}=await V$(e,{...t,parameters:"local"===i?.type?void 0:["blobVersionedHashes"]}),x=(c?(0,oX.cK)(c):void 0)||h,E=(0,C$.yH)(b),C=await(async()=>w.to?w.to:a&&a.length>0?await g$({authorization:a[0]}).catch((()=>{throw new $Q.C("`to` is required. Could not infer from `authorizationList`")})):void 0)();(0,A$.c)(t);const A=e.chain?.formatters?.transactionRequest?.format,S=(A||E$.Bv)({...(0,x$.o)(w,{format:A}),from:i?.address,accessList:s,authorizationList:a,blobs:o,blobVersionedHashes:l,data:u,gas:d,gasPrice:p,maxFeePerBlobGas:f,maxFeePerGas:m,maxPriorityFeePerGas:g,nonce:v,to:C,value:y});function _(t){const{block:n,request:i,rpcStateOverride:r}=t;return e.request({method:"eth_estimateGas",params:r?[i,n??"latest",r]:n?[i,n]:[i]})}let T=BigInt(await _({block:x,request:S,rpcStateOverride:E}));if(a){const P=await S$(e,{address:S.from}),M=await Promise.all(a.map((async e=>{const{address:t}=e,n=await _({block:x,request:{authorizationList:void 0,data:u,from:i?.address,to:t,value:(0,oX.cK)(P)},rpcStateOverride:E}).catch((()=>100000n));return 2n*BigInt(n)})));T+=M.reduce(((e,t)=>e+t),0n)}return T}catch(r){throw function(e,t){let{docsPath:n,...i}=t;const r=(()=>{const t=(0,w$.l)(e,i);return t instanceof yX.RM?e:t})();return new b$(r,{docsPath:n,...i})}(r,{...t,account:i,chain:e.chain})}}async function T$(e,t){let{address:n,blockTag:i="latest",blockNumber:r}=t;const s=await e.request({method:"eth_getTransactionCount",params:[n,r?(0,oX.cK)(r):i]},{dedupe:Boolean(r)});return(0,JJ.ME)(s)}function P$(e){const{kzg:t}=e,n=e.to??("string"===typeof e.blobs[0]?"hex":"bytes"),i="string"===typeof e.blobs[0]?e.blobs.map((e=>(0,PJ.aT)(e))):e.blobs,r=[];for(const s of i)r.push(Uint8Array.from(t.blobToKzgCommitment(s)));return"bytes"===n?r:r.map((e=>(0,oX.My)(e)))}function M$(e){const{kzg:t}=e,n=e.to??("string"===typeof e.blobs[0]?"hex":"bytes"),i="string"===typeof e.blobs[0]?e.blobs.map((e=>(0,PJ.aT)(e))):e.blobs,r="string"===typeof e.commitments[0]?e.commitments.map((e=>(0,PJ.aT)(e))):e.commitments,s=[];for(let a=0;a<i.length;a++){const e=i[a],n=r[a];s.push(Uint8Array.from(t.computeBlobKzgProof(e,n)))}return"bytes"===n?s:s.map((e=>(0,oX.My)(e)))}var N$=n(60473);function I$(e){const{commitment:t,version:n=1}=e,i=e.to??("string"===typeof t?"hex":"bytes"),r=function(e,t){const n=t||"hex",i=(0,N$.sc)((0,o$.q)(e,{strict:!1})?(0,PJ.ZJ)(e):e);return"bytes"===n?i:(0,oX.nj)(i)}(t,"bytes");return r.set([n],0),"bytes"===i?r:(0,oX.My)(r)}const O$=32,D$=4096,L$=O$*D$,R$=6*L$-1-1*D$*6;class k$ extends $Q.C{constructor(e){let{maxSize:t,size:n}=e;super("Blob size is too large.",{metaMessages:[`Max: ${t} bytes`,`Given: ${n} bytes`],name:"BlobSizeTooLargeError"})}}class B$ extends $Q.C{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}$Q.C;$Q.C;function U$(e){const{data:t,kzg:n,to:i}=e,r=e.blobs??function(e){const t=e.to??("string"===typeof e.data?"hex":"bytes"),n="string"===typeof e.data?(0,PJ.aT)(e.data):e.data,i=(0,IJ.E)(n);if(!i)throw new B$;if(i>R$)throw new k$({maxSize:R$,size:i});const r=[];let s=!0,a=0;for(;s;){const e=(0,u$.l)(new Uint8Array(L$));let t=0;for(;t<D$;){const i=n.slice(a,a+(O$-1));if(e.pushByte(0),e.pushBytes(i),i.length<31){e.pushByte(128),s=!1;break}t++,a+=31}r.push(e)}return"bytes"===t?r.map((e=>e.bytes)):r.map((e=>(0,oX.My)(e.bytes)))}({data:t,to:i}),s=e.commitments??P$({blobs:r,kzg:n,to:i}),a=e.proofs??M$({blobs:r,commitments:s,kzg:n,to:i}),o=[];for(let l=0;l<r.length;l++)o.push({blob:r[l],commitment:s[l],proof:a[l]});return o}async function z$(e){const t=await e.request({method:"eth_chainId"},{dedupe:!0});return(0,JJ.ME)(t)}const F$=["blobVersionedHashes","chainId","fees","gas","nonce","type"],j$=new Map;async function V$(e,t){const{account:n=e.account,blobs:i,chain:r,gas:s,kzg:a,nonce:o,nonceManager:l,parameters:c=F$,type:h}=t,u=n?(0,HZ.J)(n):n,d={...t,...u?{from:u?.address}:{}};let p,f;async function m(){return p||(p=await bJ(e,i$,"getBlock")({blockTag:"latest"}),p)}async function g(){if(f)return f;if(r)return r.id;if("undefined"!==typeof t.chainId)return t.chainId;const n=await bJ(e,z$,"getChainId")({});return f=n,f}if(c.includes("nonce")&&"undefined"===typeof o&&u)if(l){const t=await g();d.nonce=await l.consume({address:u.address,chainId:t,client:e})}else d.nonce=await bJ(e,T$,"getTransactionCount")({address:u.address,blockTag:"pending"});if((c.includes("blobVersionedHashes")||c.includes("sidecars"))&&i&&a){const e=P$({blobs:i,kzg:a});if(c.includes("blobVersionedHashes")){const t=function(e){const{commitments:t,version:n}=e,i=e.to??("string"===typeof t[0]?"hex":"bytes"),r=[];for(const s of t)r.push(I$({commitment:s,to:i,version:n}));return r}({commitments:e,to:"hex"});d.blobVersionedHashes=t}if(c.includes("sidecars")){const t=U$({blobs:i,commitments:e,proofs:M$({blobs:i,commitments:e,kzg:a}),to:"hex"});d.sidecars=t}}if(c.includes("chainId")&&(d.chainId=await g()),(c.includes("fees")||c.includes("type"))&&"undefined"===typeof h)try{d.type=function(e){if(e.type)return e.type;if("undefined"!==typeof e.authorizationList)return"eip7702";if("undefined"!==typeof e.blobs||"undefined"!==typeof e.blobVersionedHashes||"undefined"!==typeof e.maxFeePerBlobGas||"undefined"!==typeof e.sidecars)return"eip4844";if("undefined"!==typeof e.maxFeePerGas||"undefined"!==typeof e.maxPriorityFeePerGas)return"eip1559";if("undefined"!==typeof e.gasPrice)return"undefined"!==typeof e.accessList?"eip2930":"legacy";throw new y$.Vg({transaction:e})}(d)}catch{let t=j$.get(e.uid);if("undefined"===typeof t){const n=await m();t="bigint"===typeof n?.baseFeePerGas,j$.set(e.uid,t)}d.type=t?"eip1559":"legacy"}if(c.includes("fees"))if("legacy"!==d.type&&"eip2930"!==d.type){if("undefined"===typeof d.maxFeePerGas||"undefined"===typeof d.maxPriorityFeePerGas){const n=await m(),{maxFeePerGas:i,maxPriorityFeePerGas:s}=await a$(e,{block:n,chain:r,request:d});if("undefined"===typeof t.maxPriorityFeePerGas&&t.maxFeePerGas&&t.maxFeePerGas<s)throw new ZJ({maxPriorityFeePerGas:s});d.maxPriorityFeePerGas=s,d.maxFeePerGas=i}}else{if("undefined"!==typeof t.maxFeePerGas||"undefined"!==typeof t.maxPriorityFeePerGas)throw new XJ;if("undefined"===typeof t.gasPrice){const t=await m(),{gasPrice:n}=await a$(e,{block:t,chain:r,request:d,type:"legacy"});d.gasPrice=n}}return c.includes("gas")&&"undefined"===typeof s&&(d.gas=await bJ(e,_$,"estimateGas")({...d,account:u?{address:u.address,type:"json-rpc"}:u})),(0,A$.c)(d),delete d.parameters,d}var H$=n(6310);async function W$(e,t){let{serializedTransaction:n}=t;return e.request({method:"eth_sendRawTransaction",params:[n]},{retryCount:0})}const G$=new lX.A(128);async function q$(e,t){const{account:n=e.account,chain:i=e.chain,accessList:r,authorizationList:s,blobs:a,data:o,gas:l,gasPrice:c,maxFeePerBlobGas:h,maxFeePerGas:u,maxPriorityFeePerGas:d,nonce:p,value:f,...m}=t;if("undefined"===typeof n)throw new WJ({docsPath:"/docs/actions/wallet/sendTransaction"});const g=n?(0,HZ.J)(n):null;try{(0,A$.c)(t);const n=await(async()=>t.to?t.to:null!==t.to&&s&&s.length>0?await g$({authorization:s[0]}).catch((()=>{throw new $Q.C("`to` is required. Could not infer from `authorizationList`.")})):void 0)();if("json-rpc"===g?.type||null===g){let t;null!==i&&(t=await bJ(e,z$,"getChainId")({}),function(e){let{chain:t,currentChainId:n}=e;if(!t)throw new H$.jF;if(n!==t.id)throw new H$.EH({chain:t,currentChainId:n})}({currentChainId:t,chain:i}));const v=e.chain?.formatters?.transactionRequest?.format,y=(v||E$.Bv)({...(0,x$.o)(m,{format:v}),accessList:r,authorizationList:s,blobs:a,chainId:t,data:o,from:g?.address,gas:l,gasPrice:c,maxFeePerBlobGas:h,maxFeePerGas:u,maxPriorityFeePerGas:d,nonce:p,to:n,value:f}),b=G$.get(e.uid),w=b?"wallet_sendTransaction":"eth_sendTransaction";try{return await e.request({method:w,params:[y]},{retryCount:0})}catch(yw){if(!1===b)throw yw;const n=yw;if("InvalidInputRpcError"===n.name||"InvalidParamsRpcError"===n.name||"MethodNotFoundRpcError"===n.name||"MethodNotSupportedRpcError"===n.name)return await e.request({method:"wallet_sendTransaction",params:[y]},{retryCount:0}).then((t=>(G$.set(e.uid,!0),t))).catch((t=>{const i=t;if("MethodNotFoundRpcError"===i.name||"MethodNotSupportedRpcError"===i.name)throw G$.set(e.uid,!1),n;throw i}));throw n}}if("local"===g?.type){const t=await bJ(e,V$,"prepareTransactionRequest")({account:g,accessList:r,authorizationList:s,blobs:a,chain:i,data:o,gas:l,gasPrice:c,maxFeePerBlobGas:h,maxFeePerGas:u,maxPriorityFeePerGas:d,nonce:p,nonceManager:g.nonceManager,parameters:[...F$,"sidecars"],value:f,...m,to:n}),v=i?.serializers?.transaction,y=await g.signTransaction(t,{serializer:v});return await bJ(e,W$,"sendRawTransaction")({serializedTransaction:y})}if("smart"===g?.type)throw new GJ({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"});throw new GJ({docsPath:"/docs/actions/wallet/sendTransaction",type:g?.type})}catch(v){if(v instanceof GJ)throw v;throw function(e,t){let{docsPath:n,...i}=t;const r=(()=>{const t=(0,w$.l)(e,i);return t instanceof yX.RM?e:t})();return new y$.$s(r,{docsPath:n,...i})}(v,{...t,account:g,chain:t.chain||void 0})}}var K$=n(78628);async function Y$(e,t){let{blockHash:n,blockNumber:i,blockTag:r,hash:s,index:a}=t;const o=r||"latest",l=void 0!==i?(0,oX.cK)(i):void 0;let c=null;if(s?c=await e.request({method:"eth_getTransactionByHash",params:[s]},{dedupe:!0}):n?c=await e.request({method:"eth_getTransactionByBlockHashAndIndex",params:[n,(0,oX.cK)(a)]},{dedupe:!0}):(l||o)&&(c=await e.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[l||o,(0,oX.cK)(a)]},{dedupe:Boolean(l)})),!c)throw new y$.Kz({blockHash:n,blockNumber:i,blockTag:o,hash:s,index:a});return(e.chain?.formatters?.transaction?.format||t$)(c)}const Q$={"0x0":"reverted","0x1":"success"};function X$(e){const t={...e,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,contractAddress:e.contractAddress?e.contractAddress:null,cumulativeGasUsed:e.cumulativeGasUsed?BigInt(e.cumulativeGasUsed):null,effectiveGasPrice:e.effectiveGasPrice?BigInt(e.effectiveGasPrice):null,gasUsed:e.gasUsed?BigInt(e.gasUsed):null,logs:e.logs?e.logs.map((e=>UJ(e))):null,to:e.to?e.to:null,transactionIndex:e.transactionIndex?(0,JJ.ME)(e.transactionIndex):null,status:e.status?Q$[e.status]:null,type:e.type?e$[e.type]||e.type:null};return e.blobGasPrice&&(t.blobGasPrice=BigInt(e.blobGasPrice)),e.blobGasUsed&&(t.blobGasUsed=BigInt(e.blobGasUsed)),t}async function Z$(e,t){let{hash:n}=t;const i=await e.request({method:"eth_getTransactionReceipt",params:[n]},{dedupe:!0});if(!i)throw new y$.Kc({hash:n});return(e.chain?.formatters?.transactionReceipt?.format||X$)(i)}const J$=new Map,$$=new Map;async function e0(e,t){let{cacheKey:n,cacheTime:i=Number.POSITIVE_INFINITY}=t;const r=function(e){const t=(e,t)=>({clear:()=>t.delete(e),get:()=>t.get(e),set:n=>t.set(e,n)}),n=t(e,J$),i=t(e,$$);return{clear:()=>{n.clear(),i.clear()},promise:n,response:i}}(n),s=r.response.get();if(s&&i>0){if((new Date).getTime()-s.created.getTime()<i)return s.data}let a=r.promise.get();a||(a=e(),r.promise.set(a));try{const e=await a;return r.response.set({created:new Date,data:e}),e}finally{r.promise.clear()}}const t0=e=>`blockNumber.${e}`;async function n0(e){let{cacheTime:t=e.cacheTime}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await e0((()=>e.request({method:"eth_blockNumber"})),{cacheKey:t0(e.uid),cacheTime:t});return BigInt(n)}function i0(e,t){let{emitOnBegin:n=!1,emitMissed:i=!1,onBlockNumber:r,onError:s,poll:a,pollingInterval:o=e.pollingInterval}=t;let l;return("undefined"!==typeof a?a:"webSocket"!==e.transport.type&&("fallback"!==e.transport.type||"webSocket"!==e.transport.transports[0].config.type))?CJ((0,iX.A)(["watchBlockNumber",e.uid,n,i,o]),{onBlockNumber:r,onError:s},(t=>AJ((async()=>{try{const n=await bJ(e,n0,"getBlockNumber")({cacheTime:0});if(l){if(n===l)return;if(n-l>1&&i)for(let e=l+1n;e<n;e++)t.onBlockNumber(e,l),l=e}(!l||n>l)&&(t.onBlockNumber(n,l),l=n)}catch(n){t.onError?.(n)}}),{emitOnBegin:n,interval:o}))):CJ((0,iX.A)(["watchBlockNumber",e.uid,n,i]),{onBlockNumber:r,onError:s},(t=>{let n=!0,i=()=>n=!1;return(async()=>{try{const r=(()=>{if("fallback"===e.transport.type){const t=e.transport.transports.find((e=>"webSocket"===e.config.type));return t?t.value:e.transport}return e.transport})(),{unsubscribe:s}=await r.subscribe({params:["newHeads"],onData(e){if(!n)return;const i=(0,JJ.uU)(e.result?.number);t.onBlockNumber(i,l),l=i},onError(e){t.onError?.(e)}});i=s,n||i()}catch(r){s?.(r)}})(),()=>i()}))}async function r0(e,t){let{confirmations:n=1,hash:i,onReplaced:r,pollingInterval:s=e.pollingInterval,retryCount:a=6,retryDelay:o=e=>{let{count:t}=e;return 200*(1<<t)},timeout:l=18e4}=t;const c=(0,iX.A)(["waitForTransactionReceipt",e.uid,i]);let h,u,d,p=!1;const{promise:f,resolve:m,reject:g}=(0,K$.Y)(),v=l?setTimeout((()=>g(new y$.WA({hash:i}))),l):void 0,y=CJ(c,{onReplaced:r,resolve:m,reject:g},(t=>{const r=bJ(e,i0,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:s,async onBlockNumber(s){const l=e=>{clearTimeout(v),r(),e(),y()};let c=s;if(!p)try{if(d){if(n>1&&(!d.blockNumber||c-d.blockNumber+1n<n))return;return void l((()=>t.resolve(d)))}if(h||(p=!0,await uX((async()=>{h=await bJ(e,Y$,"getTransaction")({hash:i}),h.blockNumber&&(c=h.blockNumber)}),{delay:o,retryCount:a}),p=!1),d=await bJ(e,Z$,"getTransactionReceipt")({hash:i}),n>1&&(!d.blockNumber||c-d.blockNumber+1n<n))return;l((()=>t.resolve(d)))}catch(f){if(f instanceof y$.Kz||f instanceof y$.Kc){if(!h)return void(p=!1);try{u=h,p=!0;const i=await uX((()=>bJ(e,i$,"getBlock")({blockNumber:c,includeTransactions:!0})),{delay:o,retryCount:a,shouldRetry:e=>{let{error:t}=e;return t instanceof $J}});p=!1;const r=i.transactions.find((e=>{let{from:t,nonce:n}=e;return t===u.from&&n===u.nonce}));if(!r)return;if(d=await bJ(e,Z$,"getTransactionReceipt")({hash:r.hash}),n>1&&(!d.blockNumber||c-d.blockNumber+1n<n))return;let s="replaced";r.to===u.to&&r.value===u.value&&r.input===u.input?s="repriced":r.from===r.to&&0n===r.value&&(s="cancelled"),l((()=>{t.onReplaced?.({reason:s,replacedTransaction:u,transaction:r,transactionReceipt:d}),t.resolve(d)}))}catch(m){l((()=>t.reject(m)))}}else l((()=>t.reject(f)))}}})}));return f}var s0=n(61990);var a0=n(27908),o0=n(87942);const l0=3;function c0(e,t){let{abi:n,address:i,args:r,docsPath:s,functionName:a,sender:o}=t;const l=e instanceof o0.$S?e:e instanceof $Q.C?e.walk((e=>"data"in e))||e.walk():{},{code:c,data:h,details:u,message:d,shortMessage:p}=l,f=e instanceof _J.O?new o0.rR({functionName:a}):[l0,aX.bq.code].includes(c)&&(h||u||d||p)?new o0.M({abi:n,data:"object"===typeof h?h.data:h,functionName:a,message:l instanceof JQ.J8?u:p??d}):e;return new o0.bG(f,{abi:n,args:r,contractAddress:i,docsPath:s,functionName:a,sender:o})}async function h0(e,t){const{abi:n,account:i=e.account,address:r,args:s,dataSuffix:a,functionName:o,...l}=t;if("undefined"===typeof i)throw new WJ({docsPath:"/docs/contract/writeContract"});const c=i?(0,HZ.J)(i):null,h=(0,a0.p)({abi:n,args:s,functionName:o});try{return await bJ(e,q$,"sendTransaction")({data:`${h}${a?a.replace("0x",""):""}`,to:r,account:c,...l})}catch(u){throw c0(u,{abi:n,address:r,args:s,docsPath:"/docs/contract/writeContract",functionName:o,sender:c?.address})}}var u0=n(92770),d0=n(61313),p0=n(31898),f0=n(48604),m0=n(19048);function g0(e,t){if(!(e instanceof $Q.C))return!1;const n=e.walk((e=>e instanceof o0.M));return n instanceof o0.M&&("ResolverNotFound"===n.data?.errorName||("ResolverWildcardNotSupported"===n.data?.errorName||("ResolverNotContract"===n.data?.errorName||("ResolverError"===n.data?.errorName||("HttpError"===n.data?.errorName||(!!n.reason?.includes("Wildcard on non-extended resolvers is not supported")||"reverse"===t&&n.reason===m0.fD[50]))))))}var v0=n(47204);function y0(e){if(66!==e.length)return null;if(0!==e.indexOf("["))return null;if(65!==e.indexOf("]"))return null;const t=`0x${e.slice(1,65)}`;return(0,o$.q)(t)?t:null}function b0(e){let t=new Uint8Array(32).fill(0);if(!e)return(0,oX.My)(t);const n=e.split(".");for(let i=n.length-1;i>=0;i-=1){const e=y0(n[i]),r=e?(0,PJ.ZJ)(e):(0,MJ.S)((0,PJ.Af)(n[i]),"bytes");t=(0,MJ.S)((0,h$.xW)([t,r]),"bytes")}return(0,oX.My)(t)}function w0(e){const t=new Uint8Array(32).fill(0);return e?y0(e)||(0,MJ.S)((0,PJ.Af)(e)):(0,oX.My)(t)}function x0(e){const t=e.replace(/^\.|\.$/gm,"");if(0===t.length)return new Uint8Array(1);const n=new Uint8Array((0,PJ.Af)(t).byteLength+2);let i=0;const r=t.split(".");for(let s=0;s<r.length;s++){let e=(0,PJ.Af)(r[s]);e.byteLength>255&&(e=(0,PJ.Af)(`[${w0(r[s]).slice(2)}]`)),n[i]=e.length,n.set(e,i+1),i+=e.length+1}return n.byteLength!==i+1?n.slice(0,i+1):n}async function E0(e,t){const{abi:n,address:i,args:r,functionName:s,...a}=t,o=(0,a0.p)({abi:n,args:r,functionName:s});try{const{data:t}=await bJ(e,s0.T,"call")({...a,data:o,to:i});return(0,d0.e)({abi:n,args:r,functionName:s,data:t||"0x"})}catch(l){throw c0(l,{abi:n,address:i,args:r,docsPath:"/docs/contract/readContract",functionName:s})}}async function C0(e,t){const{blockNumber:n,blockTag:i,coinType:r,name:s,gatewayUrls:a,strict:o}=t,{chain:l}=e,c=(()=>{if(t.universalResolverAddress)return t.universalResolverAddress;if(!l)throw new Error("client chain not configured. universalResolverAddress is required.");return(0,p0.M)({blockNumber:n,chain:l,contract:"ensUniversalResolver"})})(),h=l?.ensTlds;if(h&&!h.some((e=>s.endsWith(e))))return null;try{const t=(0,a0.p)({abi:u0.Rm,functionName:"addr",...null!=r?{args:[b0(s),BigInt(r)]}:{args:[b0(s)]}}),o={address:c,abi:u0.Ag,functionName:"resolve",args:[(0,oX.nj)(x0(s)),t,a??[v0.J]],blockNumber:n,blockTag:i},l=bJ(e,E0,"readContract"),h=await l(o);if("0x"===h[0])return null;const u=(0,d0.e)({abi:u0.Rm,args:null!=r?[b0(s),BigInt(r)]:void 0,functionName:"addr",data:h[0]});return"0x"===u||"0x00"===(0,f0.B)(u)?null:u}catch(u){if(o)throw u;if(g0(u,"resolve"))return null;throw u}}let A0=[];function S0(e){const t=[...e.state.connections.values()];return"reconnecting"===e.state.status||HJ(A0,t)?A0:(A0=t,t)}async function _0(e,t){let n;if(n="function"===typeof t.connector?e._internal.connectors.setup(t.connector):t.connector,n.uid===e.state.current)throw new JZ.nM;try{e.setState((e=>({...e,status:"connecting"}))),n.emitter.emit("message",{type:"connecting"});const{connector:i,...r}=t,s=await n.connect(r),a=s.accounts;return n.emitter.off("connect",e._internal.events.connect),n.emitter.on("change",e._internal.events.change),n.emitter.on("disconnect",e._internal.events.disconnect),await(e.storage?.setItem("recentConnectorId",n.id)),e.setState((e=>({...e,connections:new Map(e.connections).set(n.uid,{accounts:a,chainId:s.chainId,connector:n}),current:n.uid,status:"connected"}))),{accounts:a,chainId:s.chainId}}catch(i){throw e.setState((e=>({...e,status:e.current?"connected":"disconnected"}))),i}}async function T0(e,t){const{addEthereumChainParameter:n,chainId:i}=t,r=e.state.connections.get(t.connector?.uid??e.state.current);if(r){const e=r.connector;if(!e.switchChain)throw new tJ({connector:e});return await e.switchChain({addEthereumChainParameter:n,chainId:i})}const s=e.chains.find((e=>e.id===i));if(!s)throw new JZ.nk;return e.setState((e=>({...e,chainId:i}))),s}var P0=n(10306),M0=n(69611);function N0(e){return"number"===typeof e?e:"wei"===e?0:Math.abs(M0.pj[e])}async function I0(e,t){const{allowFailure:n=!0,batchSize:i,blockNumber:r,blockTag:s,multicallAddress:a,stateOverride:o}=t,l=t.contracts,c=i??("object"===typeof e.batch?.multicall&&e.batch.multicall.batchSize||1024);let h=a;if(!h){if(!e.chain)throw new Error("client chain not configured. multicallAddress is required.");h=(0,p0.M)({blockNumber:r,chain:e.chain,contract:"multicall3"})}const u=[[]];let d=0,p=0;for(let v=0;v<l.length;v++){const{abi:e,address:t,args:i,functionName:r}=l[v];try{const n=(0,a0.p)({abi:e,args:i,functionName:r});p+=(n.length-2)/2,c>0&&p>c&&u[d].length>0&&(d++,p=(n.length-2)/2,u[d]=[]),u[d]=[...u[d],{allowFailure:!0,callData:n,target:t}]}catch(g){const s=c0(g,{abi:e,address:t,args:i,docsPath:"/docs/contract/multicall",functionName:r});if(!n)throw s;u[d]=[...u[d],{allowFailure:!0,callData:"0x",target:t}]}}const f=await Promise.allSettled(u.map((t=>bJ(e,E0,"readContract")({abi:u0.v2,address:h,args:[t],blockNumber:r,blockTag:s,functionName:"aggregate3",stateOverride:o})))),m=[];for(let v=0;v<f.length;v++){const e=f[v];if("rejected"===e.status){if(!n)throw e.reason;for(let t=0;t<u[v].length;t++)m.push({status:"failure",error:e.reason,result:void 0});continue}const t=e.value;for(let i=0;i<t.length;i++){const{returnData:e,success:r}=t[i],{callData:s}=u[v][i],{abi:a,address:o,functionName:c,args:h}=l[m.length];try{if("0x"===s)throw new _J.O;if(!r)throw new o0.$S({data:e});const t=(0,d0.e)({abi:a,args:h,data:e,functionName:c});m.push(n?{result:t,status:"success"}:t)}catch(g){const e=c0(g,{abi:a,address:o,args:h,docsPath:"/docs/contract/multicall",functionName:c});if(!n)throw e;m.push({error:e,result:void 0,status:"failure"})}}}if(m.length!==l.length)throw new $Q.C("multicall results mismatch");return m}async function O0(e,t){const{allowFailure:n=!0,blockNumber:i,blockTag:r,...s}=t,a=t.contracts;try{const t={};for(const[n,i]of a.entries()){const r=i.chainId??e.state.chainId;t[r]||(t[r]=[]),t[r]?.push({contract:i,index:n})}const o=()=>Object.entries(t).map((t=>{let[a,o]=t;return async function(e,t){const{allowFailure:n=!0,chainId:i,contracts:r,...s}=t;return VJ(e.getClient({chainId:i}),I0,"multicall")({allowFailure:n,contracts:r,...s})}(e,{...s,allowFailure:n,blockNumber:i,blockTag:r,chainId:Number.parseInt(a),contracts:o.map((e=>{let{contract:t}=e;return t}))})})),l=(await Promise.all(o())).flat(),c=Object.values(t).flatMap((e=>e.map((e=>{let{index:t}=e;return t}))));return l.reduce(((e,t,n)=>(e&&(e[c[n]]=t),e)),[])}catch(o){if(o instanceof o0.bG)throw o;const t=()=>a.map((t=>function(e,t){const{chainId:n,...i}=t;return VJ(e.getClient({chainId:n}),E0,"readContract")(i)}(e,{...t,blockNumber:i,blockTag:r})));return n?(await Promise.allSettled(t())).map((e=>"fulfilled"===e.status?{result:e.value,status:"success"}:{error:e.reason,result:void 0,status:"failure"})):await Promise.all(t())}}async function D0(e,t){const{balanceAddress:n,chainId:i,symbolType:r,tokenAddress:s,unit:a}=t,o={abi:[{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:r}]}],address:s},[l,c,h]=await O0(e,{allowFailure:!1,contracts:[{...o,functionName:"balanceOf",args:[n],chainId:i},{...o,functionName:"decimals",chainId:i},{...o,functionName:"symbol",chainId:i}]});return{decimals:c,formatted:(0,P0.J)(l??"0",N0(a??c)),symbol:h,value:l}}async function L0(e,t){let{address:n,blockNumber:i,blockTag:r,gatewayUrls:s,strict:a,universalResolverAddress:o}=t,l=o;if(!l){if(!e.chain)throw new Error("client chain not configured. universalResolverAddress is required.");l=(0,p0.M)({blockNumber:i,chain:e.chain,contract:"ensUniversalResolver"})}const c=`${n.toLowerCase().substring(2)}.addr.reverse`;try{const t={address:l,abi:u0.oX,functionName:"reverse",args:[(0,oX.nj)(x0(c))],blockNumber:i,blockTag:r},a=bJ(e,E0,"readContract"),[o,h]=s?await a({...t,args:[...t.args,s]}):await a(t);return n.toLowerCase()!==h.toLowerCase()?null:o}catch(h){if(a)throw h;if(g0(h,"reverse"))return null;throw h}}class R0 extends $Q.C{constructor(e){let{data:t}=e;super("Unable to extract image from metadata. The metadata may be malformed or invalid.",{metaMessages:["- Metadata must be a JSON object with at least an `image`, `image_url` or `image_data` property.","",`Provided data: ${JSON.stringify(t)}`],name:"EnsAvatarInvalidMetadataError"})}}class k0 extends $Q.C{constructor(e){let{reason:t}=e;super(`ENS NFT avatar URI is invalid. ${t}`,{name:"EnsAvatarInvalidNftUriError"})}}class B0 extends $Q.C{constructor(e){let{uri:t}=e;super(`Unable to resolve ENS avatar URI "${t}". The URI may be malformed, invalid, or does not respond with a valid image.`,{name:"EnsAvatarUriResolutionError"})}}class U0 extends $Q.C{constructor(e){let{namespace:t}=e;super(`ENS NFT avatar namespace "${t}" is not supported. Must be "erc721" or "erc1155".`,{name:"EnsAvatarUnsupportedNamespaceError"})}}const z0=/(?<protocol>https?:\/\/[^\/]*|ipfs:\/|ipns:\/|ar:\/)?(?<root>\/)?(?<subpath>ipfs\/|ipns\/)?(?<target>[\w\-.]+)(?<subtarget>\/.*)?/,F0=/^(Qm[1-9A-HJ-NP-Za-km-z]{44,}|b[A-Za-z2-7]{58,}|B[A-Z2-7]{58,}|z[1-9A-HJ-NP-Za-km-z]{48,}|F[0-9A-F]{50,})(\/(?<target>[\w\-.]+))?(?<subtarget>\/.*)?$/,j0=/^data:([a-zA-Z\-/+]*);base64,([^"].*)/,V0=/^data:([a-zA-Z\-/+]*)?(;[a-zA-Z0-9].*?)?(,)/;function H0(e,t){return e?e.endsWith("/")?e.slice(0,-1):e:t}function W0(e){let{uri:t,gatewayUrls:n}=e;const i=j0.test(t);if(i)return{uri:t,isOnChain:!0,isEncoded:i};const r=H0(n?.ipfs,"https://ipfs.io"),s=H0(n?.arweave,"https://arweave.net"),a=t.match(z0),{protocol:o,subpath:l,target:c,subtarget:h=""}=a?.groups||{},u="ipns:/"===o||"ipns/"===l,d="ipfs:/"===o||"ipfs/"===l||F0.test(t);if(t.startsWith("http")&&!u&&!d){let e=t;return n?.arweave&&(e=t.replace(/https:\/\/arweave.net/g,n?.arweave)),{uri:e,isOnChain:!1,isEncoded:!1}}if((u||d)&&c)return{uri:`${r}/${u?"ipns":"ipfs"}/${c}${h}`,isOnChain:!1,isEncoded:!1};if("ar:/"===o&&c)return{uri:`${s}/${c}${h||""}`,isOnChain:!1,isEncoded:!1};let p=t.replace(V0,"");if(p.startsWith("<svg")&&(p=`data:image/svg+xml;base64,${btoa(p)}`),p.startsWith("data:")||p.startsWith("{"))return{uri:p,isOnChain:!0,isEncoded:!1};throw new B0({uri:t})}function G0(e){if("object"!==typeof e||!("image"in e)&&!("image_url"in e)&&!("image_data"in e))throw new R0({data:e});return e.image||e.image_url||e.image_data}async function q0(e){let{gatewayUrls:t,uri:n}=e;const{uri:i,isOnChain:r}=W0({uri:n,gatewayUrls:t});if(r)return i;const s=await async function(e){try{const t=await fetch(e,{method:"HEAD"});if(200===t.status){const e=t.headers.get("content-type");return e?.startsWith("image/")}return!1}catch(t){return("object"!==typeof t||"undefined"===typeof t.response)&&!!globalThis.hasOwnProperty("Image")&&new Promise((t=>{const n=new Image;n.onload=()=>{t(!0)},n.onerror=()=>{t(!1)},n.src=e}))}}(i);if(s)return i;throw new B0({uri:n})}async function K0(e,t){let{gatewayUrls:n,record:i}=t;return/eip155:/i.test(i)?async function(e,t){let{gatewayUrls:n,record:i}=t;const r=function(e){let t=e;t.startsWith("did:nft:")&&(t=t.replace("did:nft:","").replace(/_/g,"/"));const[n,i,r]=t.split("/"),[s,a]=n.split(":"),[o,l]=i.split(":");if(!s||"eip155"!==s.toLowerCase())throw new k0({reason:"Only EIP-155 supported"});if(!a)throw new k0({reason:"Chain ID not found"});if(!l)throw new k0({reason:"Contract address not found"});if(!r)throw new k0({reason:"Token ID not found"});if(!o)throw new k0({reason:"ERC namespace not found"});return{chainID:Number.parseInt(a),namespace:o.toLowerCase(),contractAddress:l,tokenID:r}}(i),s=await async function(e,t){let{nft:n}=t;if("erc721"===n.namespace)return E0(e,{address:n.contractAddress,abi:[{name:"tokenURI",type:"function",stateMutability:"view",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{name:"",type:"string"}]}],functionName:"tokenURI",args:[BigInt(n.tokenID)]});if("erc1155"===n.namespace)return E0(e,{address:n.contractAddress,abi:[{name:"uri",type:"function",stateMutability:"view",inputs:[{name:"_id",type:"uint256"}],outputs:[{name:"",type:"string"}]}],functionName:"uri",args:[BigInt(n.tokenID)]});throw new U0({namespace:n.namespace})}(e,{nft:r}),{uri:a,isOnChain:o,isEncoded:l}=W0({uri:s,gatewayUrls:n});if(o&&(a.includes("data:application/json;base64,")||a.startsWith("{"))){const e=l?atob(a.replace("data:application/json;base64,","")):a;return q0({uri:G0(JSON.parse(e)),gatewayUrls:n})}let c=r.tokenID;"erc1155"===r.namespace&&(c=c.replace("0x","").padStart(64,"0"));return async function(e){let{gatewayUrls:t,uri:n}=e;try{const e=await fetch(n).then((e=>e.json()));return await q0({gatewayUrls:t,uri:G0(e)})}catch{throw new B0({uri:n})}}({gatewayUrls:n,uri:a.replace(/(?:0x)?{id}/,c)})}(e,{gatewayUrls:n,record:i}):q0({uri:i,gatewayUrls:n})}async function Y0(e,t){const{blockNumber:n,blockTag:i,key:r,name:s,gatewayUrls:a,strict:o}=t,{chain:l}=e,c=(()=>{if(t.universalResolverAddress)return t.universalResolverAddress;if(!l)throw new Error("client chain not configured. universalResolverAddress is required.");return(0,p0.M)({blockNumber:n,chain:l,contract:"ensUniversalResolver"})})(),h=l?.ensTlds;if(h&&!h.some((e=>s.endsWith(e))))return null;try{const t={address:c,abi:u0.Ag,functionName:"resolve",args:[(0,oX.nj)(x0(s)),(0,a0.p)({abi:u0.SJ,functionName:"text",args:[b0(s),r]}),a??[v0.J]],blockNumber:n,blockTag:i},o=bJ(e,E0,"readContract"),l=await o(t);if("0x"===l[0])return null;const h=(0,d0.e)({abi:u0.SJ,functionName:"text",data:l[0]});return""===h?null:h}catch(u){if(o)throw u;if(g0(u,"resolve"))return null;throw u}}async function Q0(e,t){let{blockNumber:n,blockTag:i,assetGatewayUrls:r,name:s,gatewayUrls:a,strict:o,universalResolverAddress:l}=t;const c=await bJ(e,Y0,"getEnsText")({blockNumber:n,blockTag:i,key:"avatar",name:s,universalResolverAddress:l,gatewayUrls:a,strict:o});if(!c)return null;try{return await K0(e,{record:c,gatewayUrls:r})}catch{return null}}class X0 extends $Q.C{constructor(e){let{value:t}=e;super(`Number \`${t}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}const Z0=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]);function J0(e){return function(e){let t=0;return()=>e[t++]}(function(e){let t=0;function n(){return e[t++]<<8|e[t++]}let i=n(),r=1,s=[0,1];for(let w=1;w<i;w++)s.push(r+=n());let a=n(),o=t;t+=a;let l=0,c=0;function h(){return 0==l&&(c=c<<8|e[t++],l=8),c>>--l&1}const u=2**31,d=u>>>1,p=d>>1,f=u-1;let m=0;for(let w=0;w<31;w++)m=m<<1|h();let g=[],v=0,y=u;for(;;){let e=Math.floor(((m-v+1)*r-1)/y),t=0,n=i;for(;n-t>1;){let i=t+n>>>1;e<s[i]?n=i:t=i}if(0==t)break;g.push(t);let a=v+Math.floor(y*s[t]/r),o=v+Math.floor(y*s[t+1]/r)-1;for(;0==((a^o)&d);)m=m<<1&f|h(),a=a<<1&f,o=o<<1&f|1;for(;a&~o&p;)m=m&d|m<<1&f>>>1|h(),a=a<<1^d,o=(o^d)<<1|d|1;v=a,y=1+o-a}let b=i-4;return g.map((t=>{switch(t-b){case 3:return b+65792+(e[o++]<<16|e[o++]<<8|e[o++]);case 2:return b+256+(e[o++]<<8|e[o++]);case 1:return b+e[o++];default:return t-1}}))}(function(e){let t=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach(((e,n)=>t[e.charCodeAt(0)]=n));let n=e.length,i=new Uint8Array(6*n>>3);for(let r=0,s=0,a=0,o=0;r<n;r++)o=o<<6|t[e.charCodeAt(r)],a+=6,a>=8&&(i[s++]=o>>(a-=8));return i}(e)))}function $0(e){return 1&e?~e>>1:e>>1}function e1(e,t){let n=Array(e);for(let i=0,r=0;i<e;i++)n[i]=r+=$0(t());return n}function t1(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[];for(;;){let i=e(),r=e();if(!r)break;t+=i;for(let e=0;e<r;e++)n.push(t+e);t+=r+1}return n}function n1(e){return r1((()=>{let t=t1(e);if(t.length)return t}))}function i1(e){let t=[];for(;;){let n=e();if(0==n)break;t.push(a1(n,e))}for(;;){let n=e()-1;if(n<0)break;t.push(o1(n,e))}return t.flat()}function r1(e){let t=[];for(;;){let n=e(t.length);if(!n)break;t.push(n)}return t}function s1(e,t,n){let i=Array(e).fill().map((()=>[]));for(let r=0;r<t;r++)e1(e,n).forEach(((e,t)=>i[t].push(e)));return i}function a1(e,t){let n=1+t(),i=t(),r=r1(t);return s1(r.length,1+e,t).flatMap(((e,t)=>{let[s,...a]=e;return Array(r[t]).fill().map(((e,t)=>{let r=t*i;return[s+t*n,a.map((e=>e+r))]}))}))}function o1(e,t){return s1(1+t(),1+e,t).map((e=>[e[0],e.slice(1)]))}function l1(e){return`{${function(e){return e.toString(16).toUpperCase().padStart(2,"0")}(e)}}`}function c1(e){let t=[];for(let n=0,i=e.length;n<i;){let i=e.codePointAt(n);n+=i<65536?1:2,t.push(i)}return t}function h1(e){let t=e.length;if(t<4096)return String.fromCodePoint(...e);let n=[];for(let i=0;i<t;)n.push(String.fromCodePoint(...e.slice(i,i+=4096)));return n.join("")}function u1(e,t){let n=e.length,i=n-t.length;for(let r=0;0==i&&r<n;r++)i=e[r]-t[r];return i}const d1=44032,p1=4352,f1=4449,m1=4519,g1=28,v1=588;function y1(e){return e>>24&255}function b1(e){return 16777215&e}let w1,x1,E1,C1;function A1(e){return e>=d1&&e<55204}function S1(e,t){if(e>=p1&&e<4371&&t>=f1&&t<4470)return d1+(e-p1)*v1+(t-f1)*g1;if(A1(e)&&t>m1&&t<4547&&(e-d1)%g1==0)return e+(t-m1);{let n=C1.get(e);return n&&(n=n.get(t),n)?n:-1}}function _1(e){w1||function(){let e=J0("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");w1=new Map(n1(e).flatMap(((e,t)=>e.map((e=>[e,t+1<<24]))))),x1=new Set(t1(e)),E1=new Map,C1=new Map;for(let[t,n]of i1(e)){if(!x1.has(t)&&2==n.length){let[e,i]=n,r=C1.get(e);r||(r=new Map,C1.set(e,r)),r.set(i,t)}E1.set(t,n.reverse())}}();let t=[],n=[],i=!1;function r(e){let n=w1.get(e);n&&(i=!0,e|=n),t.push(e)}for(let s of e)for(;;){if(s<128)t.push(s);else if(A1(s)){let e=s-d1,t=e%v1/g1|0,n=e%g1;r(p1+(e/v1|0)),r(f1+t),n>0&&r(m1+n)}else{let e=E1.get(s);e?n.push(...e):r(s)}if(!n.length)break;s=n.pop()}if(i&&t.length>1){let e=y1(t[0]);for(let n=1;n<t.length;n++){let i=y1(t[n]);if(0==i||e<=i){e=i;continue}let r=n-1;for(;;){let n=t[r+1];if(t[r+1]=t[r],t[r]=n,!r)break;if(e=y1(t[--r]),e<=i)break}e=y1(t[n])}}return t}function T1(e){return _1(e).map(b1)}function P1(e){return function(e){let t=[],n=[],i=-1,r=0;for(let s of e){let e=y1(s),a=b1(s);if(-1==i)0==e?i=a:t.push(a);else if(r>0&&r>=e)0==e?(t.push(i,...n),n.length=0,i=a):n.push(a),r=e;else{let s=S1(i,a);s>=0?i=s:0==r&&0==e?(t.push(i),i=a):(n.push(a),r=e)}}return i>=0&&t.push(i,...n),t}(_1(e))}const M1=".",N1=e=>Array.from(e);function I1(e,t){return e.P.has(t)||e.Q.has(t)}class O1 extends Array{get is_emoji(){return!0}}let D1,L1,R1,k1,B1,U1,z1,F1,j1,V1,H1,W1;function G1(){if(D1)return;let e=J0("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");const t=()=>t1(e),n=()=>new Set(t()),i=(e,t)=>t.forEach((t=>e.add(t)));D1=new Map(i1(e)),L1=n(),R1=t(),k1=new Set(t().map((e=>R1[e]))),R1=new Set(R1),B1=n(),U1=n();let r=n1(e),s=e();const a=()=>{let e=new Set;return t().forEach((t=>i(e,r[t]))),i(e,t()),e};z1=r1((t=>{let n=r1(e).map((e=>e+96));if(n.length){let i=t>=s;return n[0]-=32,n=h1(n),i&&(n=`Restricted[${n}]`),{N:n,P:a(),Q:a(),M:!e(),R:i}}})),F1=n(),j1=new Map;let o=t().concat(N1(F1)).sort(((e,t)=>e-t));o.forEach(((t,n)=>{let i=e(),r=o[n]=i?o[n-i]:{V:[],M:new Map};r.V.push(t),F1.has(t)||j1.set(t,r)}));for(let{V:h,M:u}of new Set(j1.values())){let e=[];for(let n of h){let t=z1.filter((e=>I1(e,n))),r=e.find((e=>{let{G:n}=e;return t.some((e=>n.has(e)))}));r||(r={G:new Set,V:[]},e.push(r)),r.V.push(n),i(r.G,t)}let t=e.flatMap((e=>N1(e.G)));for(let{G:n,V:i}of e){let e=new Set(t.filter((e=>!n.has(e))));for(let t of i)u.set(t,e)}}V1=new Set;let l=new Set;const c=e=>V1.has(e)?l.add(e):V1.add(e);for(let h of z1){for(let e of h.P)c(e);for(let e of h.Q)c(e)}for(let h of V1)j1.has(h)||l.has(h)||j1.set(h,1);i(V1,T1(V1)),H1=function(e){let t=[],n=t1(e);return function e(n,i,r){let{S:s,B:a}=n;if(!(4&s&&r===i[i.length-1])){2&s&&(r=i[i.length-1]),1&s&&t.push(i);for(let t of a)for(let n of t.Q)e(t,[...i,n],r)}}(function t(i){let r=e(),s=r1((()=>{let i=t1(e).map((e=>n[e]));if(i.length)return t(i)}));return{S:r,B:s,Q:i}}([]),[]),t}(e).map((e=>O1.from(e))).sort(u1),W1=new Map;for(let h of H1){let e=[W1];for(let t of h){let n=e.map((e=>{let n=e.get(t);return n||(n=new Map,e.set(t,n)),n}));65039===t?e.push(...n):e=n}for(let t of e)t.V=h}}function q1(e){return(Q1(e)?"":`${K1(Y1([e]))} `)+l1(e)}function K1(e){return`"${e}"\u200e`}function Y1(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l1,i=[];(function(e,t){return G1(),t?k1.has(e):R1.has(e)})(e[0])&&i.push("\u25cc"),e.length>t&&(t>>=1,e=[...e.slice(0,t),8230,...e.slice(-t)]);let r=0,s=e.length;for(let a=0;a<s;a++){let t=e[a];Q1(t)&&(i.push(h1(e.slice(r,a))),i.push(n(t)),r=a+1)}return i.push(h1(e.slice(r,s))),i.join("")}function Q1(e){return G1(),B1.has(e)}function X1(e,t,n){if(!e)return[];G1();let i=0;return e.split(M1).map((e=>{let r=c1(e),s={input:r,offset:i};i+=r.length+1;try{let e,i=s.tokens=t2(r,t,n),a=i.length;if(!a)throw new Error("empty label");let o=s.output=i.flat();if(function(e){for(let t=e.lastIndexOf(95);t>0;)if(95!==e[--t])throw new Error("underscore allowed only at start")}(o),!(s.emoji=a>1||i[0].is_emoji)&&o.every((e=>e<128)))!function(e){if(e.length>=4&&45==e[2]&&45==e[3])throw new Error(`invalid label extension: "${h1(e.slice(0,4))}"`)}(o),e="ASCII";else{let t=i.flatMap((e=>e.is_emoji?[]:e));if(t.length){if(R1.has(o[0]))throw e2("leading combining mark");for(let e=1;e<a;e++){let t=i[e];if(!t.is_emoji&&R1.has(t[0]))throw e2(`emoji + combining mark: "${h1(i[e-1])} + ${Y1([t[0]])}"`)}!function(e){let t=e[0],n=Z0.get(t);if(n)throw e2(`leading ${n}`);let i=e.length,r=-1;for(let s=1;s<i;s++){t=e[s];let i=Z0.get(t);if(i){if(r==s)throw e2(`${n} + ${i}`);r=s+1,n=i}}if(r==i)throw e2(`trailing ${n}`)}(o);let n=N1(new Set(t)),[r]=function(e){let t=z1;for(let n of e){let e=t.filter((e=>I1(e,n)));if(!e.length)throw z1.some((e=>I1(e,n)))?$1(t[0],n):J1(n);if(t=e,1==e.length)break}return t}(n);!function(e,t){for(let n of t)if(!I1(e,n))throw $1(e,n);if(e.M){let e=T1(t);for(let t=1,n=e.length;t<n;t++)if(k1.has(e[t])){let i=t+1;for(let r;i<n&&k1.has(r=e[i]);i++)for(let n=t;n<i;n++)if(e[n]==r)throw new Error(`duplicate non-spacing marks: ${q1(r)}`);if(i-t>4)throw new Error(`excessive non-spacing marks: ${K1(Y1(e.slice(t-1,i)))} (${i-t}/4)`);t=i}}}(r,t),function(e,t){let n,i=[];for(let r of t){let e=j1.get(r);if(1===e)return;if(e){let t=e.M.get(r);if(n=n?n.filter((e=>t.has(e))):N1(t),!n.length)return}else i.push(r)}if(n)for(let r of n)if(i.every((e=>I1(r,e))))throw new Error(`whole-script confusable: ${e.N}/${r.N}`)}(r,n),e=r.N}else e="Emoji"}s.type=e}catch(a){s.error=a}return s}))}function Z1(e){return e.map((t=>{let{input:n,error:i,output:r}=t;if(i){let t=i.message;throw new Error(1==e.length?t:`Invalid label ${K1(Y1(n,63))}: ${t}`)}return h1(r)})).join(M1)}function J1(e){return new Error(`disallowed character: ${q1(e)}`)}function $1(e,t){let n=q1(t),i=z1.find((e=>e.P.has(t)));return i&&(n=`${i.N} ${n}`),new Error(`illegal mixture: ${e.N} + ${n}`)}function e2(e){return new Error(`illegal placement: ${e}`)}function t2(e,t,n){let i=[],r=[];for(e=e.slice().reverse();e.length;){let s=i2(e);if(s)r.length&&(i.push(t(r)),r=[]),i.push(n(s));else{let t=e.pop();if(V1.has(t))r.push(t);else{let e=D1.get(t);if(e)r.push(...e);else if(!L1.has(t))throw J1(t)}}}return r.length&&i.push(t(r)),i}function n2(e){return e.filter((e=>65039!=e))}function i2(e,t){let n,i=W1,r=e.length;for(;r&&(i=i.get(e[--r]),i);){let{V:s}=i;s&&(n=s,t&&t.push(...e.slice(r).reverse()),e.length=r)}return n}function r2(e){return function(e){return Z1(X1(e,P1,n2))}(e)}function s2(e){return r2(e)}function a2(e){let t,n,i=[];function r(e){return HQ.L.parseEvmChainId(e)||1}async function s(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=(t||(t=FQ.getInstance({projectId:e.options.projectId,enableLogger:e.options.enableAuthLogger,onTimeout:()=>{GG.h.open(YG.ALERT_ERRORS.SOCIALS_TIMEOUT,"error")}})),t);let a=n.chainId;if(n.isReconnecting){const t=HQ.L.parseEvmChainId(s.getLastUsedChainId()||""),n=e.chains?.[0].id;if(a=t||n,!a)throw new Error("ChainId not found in provider")}const o=FG.U.state.preferredAccountTypes?.eip155,{address:l,chainId:c,accounts:h}=await s.connect({chainId:a,preferredAccountType:o});i=h?.map((e=>e.address))||[l];const u=r(c);return{accounts:i,account:l,chainId:u,chain:{id:u,unsuported:!1}}}return(0,nJ.U)((t=>({id:OG.o.CONNECTOR_ID.AUTH,name:OG.o.CONNECTOR_NAMES.AUTH,type:"AUTH",chain:OG.o.CHAIN.EVM,async connect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n)return n;n||(n=new Promise((t=>{t(s(e))})));const t=await n;return n=void 0,t},async disconnect(){const e=await this.getProvider();await e.disconnect()},getAccounts:()=>i?.length?(t.emitter.emit("change",{accounts:i}),Promise.resolve(i)):Promise.resolve([]),async getProvider(){return this.provider||(this.provider=FQ.getInstance({projectId:e.options.projectId,enableLogger:e.options.enableAuthLogger,onTimeout:()=>{GG.h.open(YG.ALERT_ERRORS.SOCIALS_TIMEOUT,"error")}})),Promise.resolve(this.provider)},async getChainId(){const e=await this.getProvider(),{chainId:t}=await e.getChainId();return r(t)},async isAuthorized(){const e=await this.getProvider();return Promise.resolve(e.getLoginEmailUsed())},async switchChain(e){let{chainId:n}=e;try{const e=t.chains.find((e=>e.id===n));if(!e)throw new aX.ch(new Error("chain not found on connector."));const r=await this.getProvider(),s=FG.U.state.preferredAccountTypes?.eip155,a=await r.connect({chainId:n,preferredAccountType:s});return i=a?.accounts?.map((e=>e.address))||[a.address],t.emitter.emit("change",{chainId:Number(n),accounts:i}),e}catch(r){if(r instanceof Error)throw new aX.ch(r);throw r}},onAccountsChanged(e){0===e.length?this.onDisconnect():t.emitter.emit("change",{accounts:e.map(ZZ.b)})},onChainChanged(e){const n=Number(e);t.emitter.emit("change",{chainId:n})},async onDisconnect(e){const t=await this.getProvider();await t.disconnect()}})))}function o2(e,t){const n=e.isNewChainsStale??!0;let i,r,s,a,o,l,c;return(0,nJ.U)((e=>({id:"walletConnect",name:"WalletConnect",type:o2.type,async setup(){const e=await this.getProvider().catch((()=>null));e&&(a||(a=this.onConnect.bind(this),e.on("connect",a)),l||(l=this.onSessionDelete.bind(this),e.on("session_delete",l)))},async connect(){let{...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=jG.W.getCaipNetworks(),n=await this.getProvider();if(!n)throw new eJ;o||(o=this.onDisplayUri,n.on("display_uri",o));const i=await this.isChainsStale();n.session&&i&&await n.disconnect();const h=VG.H.state.universalProviderConfigOverride;if(!n.session||i){const i=UX.createNamespaces(t,h);await n.connect({optionalNamespaces:i,..."pairingTopic"in e?{pairingTopic:e.pairingTopic}:{}}),this.setRequestedChainsIds(t.map((e=>Number(e.id))))}const u=await this.getAccounts(),d=await this.getChainId(),p=n.session?.namespaces?.eip155?.chains,f=p?.some((e=>Number(e.split(":")[1])===d));let m=1;f?m=d:p?.[0]&&(m=Number(p[0].split(":")[1])),o&&(n.removeListener("display_uri",o),o=void 0),a&&(n.removeListener("connect",a),a=void 0),r||(r=this.onAccountsChanged.bind(this),n.on("accountsChanged",r)),s||(s=this.onChainChanged.bind(this),n.on("chainChanged",s)),c||(c=this.onDisconnect.bind(this),n.on("disconnect",c)),l||(l=this.onSessionDelete.bind(this),n.on("session_delete",l));const g=h?.defaultChain;return n.setDefaultChain(g??`eip155:${m}`),{accounts:u,chainId:m}}catch(t){if(/(user rejected|connection request reset)/i.test(t?.message))throw new aX.vx(t);throw t}},async disconnect(){const e=await this.getProvider();try{await(e?.disconnect())}catch(t){if(!/No matching key/i.test(t.message))throw t}finally{s&&(e?.removeListener("chainChanged",s),s=void 0),c&&(e?.removeListener("disconnect",c),c=void 0),a||(a=this.onConnect.bind(this),e?.on("connect",a)),r&&(e?.removeListener("accountsChanged",r),r=void 0),l&&(e?.removeListener("session_delete",l),l=void 0),this.setRequestedChainsIds([])}},async getAccounts(){const e=await this.getProvider();if(!e?.session?.namespaces)return[];const t=e?.session?.namespaces[OG.o.CHAIN.EVM]?.accounts;return t?.map((e=>e.split(":")[2]))??[]},async getProvider(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i||(i=await t.getUniversalProvider(),i?.events.setMaxListeners(Number.POSITIVE_INFINITY));const n=WG.i.getActiveNamespace(),r=t.getCaipNetwork()?.id;if(e&&r!==e&&n){const e=WG.i.getStoredActiveCaipNetworkId(),i=t.getCaipNetworks(n),r=i?.find((t=>t.id===e));r&&r.chainNamespace===OG.o.CHAIN.EVM&&await(this.switchChain?.({chainId:Number(r.id)}))}return i},async getChainId(){const e=t.getCaipNetwork(OG.o.CHAIN.EVM)?.id;if(e)return e;const n=await this.getProvider(),i=n.session?.namespaces[OG.o.CHAIN.EVM]?.chains?.[0],r=jG.W.getCaipNetworks().find((e=>e.id===i));return r?.id},async isAuthorized(){try{const[e,t]=await Promise.all([this.getAccounts(),this.getProvider()]);if(!e.length)return!1;return!await this.isChainsStale()||!t.session||(await t.disconnect().catch((()=>{})),!1)}catch{return!1}},async switchChain(t){let{addEthereumChainParameter:n,chainId:i}=t;const r=await this.getProvider();if(!r)throw new eJ;const s=jG.W.getCaipNetworks().find((e=>e.id===i));if(!s)throw new aX.ch(new JZ.nk);try{await r.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,oX.cK)(i)}]}),s?.caipNetworkId&&r.setDefaultChain(s?.caipNetworkId),e.emitter.emit("change",{chainId:Number(i)});const t=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...t,i]),{...s,id:s.id}}catch(a){const e=a;if(/(?:user rejected)/iu.test(e.message))throw new aX.vx(e);try{let e;e=n?.blockExplorerUrls?n.blockExplorerUrls:s.blockExplorers?.default.url?[s.blockExplorers?.default.url]:[];const t=s.rpcUrls?.chainDefault?.http||[],a={blockExplorerUrls:e,chainId:(0,oX.cK)(i),chainName:s.name,iconUrls:n?.iconUrls,nativeCurrency:s.nativeCurrency,rpcUrls:t};await r.request({method:"wallet_addEthereumChain",params:[a]});const o=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...o,i]),{...s,id:s.id}}catch(yw){throw new aX.vx(yw)}}},onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t.map((e=>(0,ZZ.b)(e)))})},onChainChanged(t){const n=Number(t);e.emitter.emit("change",{chainId:n})},onConnect(e){this.setRequestedChainsIds(jG.W.getCaipNetworks().map((e=>Number(e.id))))},async onDisconnect(t){this.setRequestedChainsIds([]),e.emitter.emit("disconnect");const n=await this.getProvider();r&&(n.removeListener("accountsChanged",r),r=void 0),s&&(n.removeListener("chainChanged",s),s=void 0),c&&(n.removeListener("disconnect",c),c=void 0),l&&(n.removeListener("session_delete",l),l=void 0),a||(a=this.onConnect.bind(this),n.on("connect",a))},onDisplayUri(t){e.emitter.emit("message",{type:"display_uri",data:t})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){if(!i?.session?.namespaces)return[];const e=i?.session?.namespaces[OG.o.CHAIN.EVM]?.accounts;return e?.map((e=>Number.parseInt(e.split(":")[1]??"")))??[]},async getRequestedChainsIds(){const t=await(e.storage?.getItem(this.requestedChainsStorageKey))??[];return[...new Set(t)]},async isChainsStale(){if(!n)return!1;const t=e.chains.map((e=>e.id)),i=this.getNamespaceChainsIds();if(i.length&&!i.some((e=>t.includes(e))))return!1;const r=await this.getRequestedChainsIds();return!t.every((e=>r.includes(Number(e))))},async setRequestedChainsIds(t){await(e.storage?.setItem(this.requestedChainsStorageKey,t))},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}})))}o2.type="walletConnect";const l2=(0,QG.BX)({pendingTransactions:0}),c2={state:l2,subscribeKey:(e,t)=>(0,XG.u$)(l2,e,t),increase(e){l2[e]+=1},decrease(e){l2[e]-=1},reset(e){l2[e]=0}};const h2={enable:!1,pollingInterval:3e4};const u2=new class{#b;#m;#h;#w;#x;#E;#C;#A;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.#b=e.queryCache||new OZ,this.#m=e.mutationCache||new LZ,this.#h=e.defaultOptions||{},this.#w=new Map,this.#x=new Map,this.#E=0}mount(){this.#E++,1===this.#E&&(this.#C=EZ.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#b.onFocus())})),this.#A=CZ.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#b.onOnline())})))}unmount(){this.#E--,0===this.#E&&(this.#C?.(),this.#C=void 0,this.#A?.(),this.#A=void 0)}isFetching(e){return this.#b.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#m.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#b.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=this.#b.build(this,t),i=n.state.data;return void 0===i?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(rZ(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(e){return this.#b.findAll(e).map((e=>{let{queryKey:t,state:n}=e;return[t,n.data]}))}setQueryData(e,t,n){const i=this.defaultQueryOptions({queryKey:e}),r=this.#b.get(i.queryHash),s=r?.state.data,a=function(e,t){return"function"===typeof e?e(t):e}(t,s);if(void 0!==a)return this.#b.build(this,i).setData(a,{...n,manual:!0})}setQueriesData(e,t,n){return wZ.batch((()=>this.#b.findAll(e).map((e=>{let{queryKey:i}=e;return[i,this.setQueryData(i,t,n)]}))))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#b.get(t.queryHash)?.state}removeQueries(e){const t=this.#b;wZ.batch((()=>{t.findAll(e).forEach((e=>{t.remove(e)}))}))}resetQueries(e,t){const n=this.#b;return wZ.batch((()=>(n.findAll(e).forEach((e=>{e.reset()})),this.refetchQueries({type:"active",...e},t))))}cancelQueries(e){const t={revert:!0,...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},n=wZ.batch((()=>this.#b.findAll(e).map((e=>e.cancel(t)))));return Promise.all(n).then(iZ).catch(iZ)}invalidateQueries(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return wZ.batch((()=>(this.#b.findAll(e).forEach((e=>{e.invalidate()})),"none"===e?.refetchType?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t))))}refetchQueries(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={...t,cancelRefetch:t.cancelRefetch??!0},i=wZ.batch((()=>this.#b.findAll(e).filter((e=>!e.isDisabled())).map((e=>{let t=e.fetch(void 0,n);return n.throwOnError||(t=t.catch(iZ)),"paused"===e.state.fetchStatus?Promise.resolve():t}))));return Promise.all(i).then(iZ)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const n=this.#b.build(this,t);return n.isStaleByTime(rZ(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(iZ).catch(iZ)}fetchInfiniteQuery(e){return e.behavior=kZ(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(iZ).catch(iZ)}ensureInfiniteQueryData(e){return e.behavior=kZ(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return CZ.isOnline()?this.#m.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#b}getMutationCache(){return this.#m}getDefaultOptions(){return this.#h}setDefaultOptions(e){this.#h=e}setQueryDefaults(e,t){this.#w.set(lZ(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#w.values()],n={};return t.forEach((t=>{cZ(e,t.queryKey)&&Object.assign(n,t.defaultOptions)})),n}setMutationDefaults(e,t){this.#x.set(lZ(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#x.values()],n={};return t.forEach((t=>{cZ(e,t.mutationKey)&&Object.assign(n,t.defaultOptions)})),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#h.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=oZ(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===vZ&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#h.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#b.clear(),this.#m.clear()}},d2="bb8edcd28daf7c13ce0a49cafab2782d";console.log("\ud83d\ude80 REACT_APP_PROJECT_ID:",d2);const p2=[DX,OX],f2=new class extends jX{constructor(e){const t=AX.extendCaipNetworks(e.networks,{projectId:e.projectId,customNetworkImageUrls:{},customRpcUrls:e.customRpcUrls});super({projectId:e.projectId,adapterType:OG.o.ADAPTER_TYPES.WAGMI,namespace:OG.o.CHAIN.EVM}),this.balancePromises={},this.pendingTransactionsFilter={...h2,...e.pendingTransactionsFilter??{}},this.createConfig({...e,networks:t}),this.setupWatchers()}async getAccounts(e){const t=this.getWagmiConnector(e.id);if(!t)return{accounts:[]};if(t.id===OG.o.CONNECTOR_ID.AUTH){const e=t.provider;if(!e.user)return{accounts:[]};const{address:n,accounts:i}=e.user;return Promise.resolve({accounts:(i||[{address:n,type:"eoa"}]).map((e=>IG.w.createAccount("eip155",e.address,e.type)))})}const{addresses:n,address:i}=jZ(this.wagmiConfig);return Promise.resolve({accounts:(n||[i])?.map((e=>IG.w.createAccount("eip155",e||"","eoa")))})}getWagmiConnector(e){return this.wagmiConfig.connectors.find((t=>t.id===e))}createConfig(e){this.wagmiChains=e.networks.filter((e=>e.chainNamespace===OG.o.CHAIN.EVM));const t={},n=[...e.connectors??[]];this.wagmiChains.forEach((n=>{const i=e.transports?.[n.id],r=AX.getCaipNetworkId(n);t[n.id]=i?AX.extendWagmiTransports(n,e.projectId,i):AX.getViemTransport(n,e.projectId,e.customRpcUrls?.[r])})),this.wagmiConfig=yJ({...e,chains:this.wagmiChains,connectors:n,transports:t})}setupWatchPendingTransactions(){if(!this.pendingTransactionsFilter.enable||this.unwatchPendingTransactions)return;this.unwatchPendingTransactions=function(e,t){const{syncConnectedChain:n=e._internal.syncConnectedChain,...i}=t;let r;const s=t=>{r&&r();const n=VJ(e.getClient({chainId:t}),jJ,"watchPendingTransactions");return r=n(i),r},a=s(t.chainId);let o;return n&&!t.chainId&&(o=e.subscribe((e=>{let{chainId:t}=e;return t}),(async e=>s(e)))),()=>{a?.(),o?.()}}(this.wagmiConfig,{pollingInterval:this.pendingTransactionsFilter.pollingInterval,onError:()=>{},onTransactions:()=>{this.emit("pendingTransactions"),c2.increase("pendingTransactions")}});const e=c2.subscribeKey("pendingTransactions",(t=>{t>=OG.o.LIMITS.PENDING_TRANSACTIONS&&(this.unwatchPendingTransactions?.(),e())}))}setupWatchers(){!function(e,t){const{onChange:n}=t;e.subscribe((()=>jZ(e)),n,{equalityFn(e,t){const{connector:n,...i}=e,{connector:r,...s}=t;return HJ(i,s)&&n?.id===r?.id&&n?.uid===r?.uid}})}(this.wagmiConfig,{onChange:(e,t)=>{"disconnected"===e.status&&t.address&&this.emit("disconnect"),"connected"===e.status&&(e.address===t?.address&&"connected"===t.status||(this.setupWatchPendingTransactions(),this.emit("accountChanged",{address:e.address,chainId:e.chainId})),e.chainId!==t?.chainId&&this.emit("switchNetwork",{address:e.address,chainId:e.chainId}))}})}async addThirdPartyConnectors(e){const t=[];if(!1!==e.enableCoinbase)try{const{coinbaseWallet:i}=await n.e(6118).then(n.bind(n,56118));i&&t.push(i({version:"4",appName:e.metadata?.name??"Unknown",appLogoUrl:e.metadata?.icons[0]??"Unknown",preference:e.coinbasePreference??"all"}))}catch(i){console.error("Failed to import Coinbase Wallet SDK:",i)}t.forEach((e=>{const t=this.wagmiConfig._internal.connectors.setup(e);this.wagmiConfig._internal.connectors.setState((e=>[...e,t]))}))}addWagmiConnectors(e,t){const n=[];!1!==e.enableWalletConnect&&n.push(o2(e,t)),!1!==e.enableInjected&&n.push(iJ({shimDisconnect:!0}));const i=void 0===e.features?.email?BG.oU.DEFAULT_FEATURES.email:e.features?.email,r=e.features?.socials?e.features?.socials?.length>0:BG.oU.DEFAULT_FEATURES.socials;(i||r)&&n.push(a2({chains:this.wagmiChains,options:{projectId:e.projectId,enableAuthLogger:e.enableAuthLogger}})),n.forEach((e=>{const t=this.wagmiConfig._internal.connectors.setup(e);this.wagmiConfig._internal.connectors.setState((e=>[...e,t]))}))}async signMessage(e){try{const t=await async function(e,t){const{account:n,connector:i,...r}=t;let s;return s="object"===typeof n&&"local"===n.type?e.getClient():await KJ(e,{account:n,connector:i}),VJ(s,qJ,"signMessage")({...r,...n?{account:n}:{}})}(this.wagmiConfig,{message:e.message,account:e.address});return{signature:t}}catch(t){throw new Error("WagmiAdapter:signMessage - Sign message failed")}}async sendTransaction(e){const{chainId:t}=jZ(this.wagmiConfig),n={account:e.address,to:e.to,value:e.value,gas:e.gas,gasPrice:e.gasPrice,data:e.data,chainId:t,type:"legacy",parameters:["nonce"]};await async function(e,t){const{account:n,chainId:i,...r}=t,s=n??jZ(e).address;return VJ(e.getClient({chainId:i}),V$,"prepareTransactionRequest")({...r,...s?{account:s}:{}})}(this.wagmiConfig,n);const i=await async function(e,t){const{account:n,chainId:i,connector:r,...s}=t;let a;a="object"===typeof n&&"local"===n?.type?e.getClient({chainId:i}):await KJ(e,{account:n??void 0,chainId:i,connector:r});const o=VJ(a,q$,"sendTransaction");return await o({...s,...n?{account:n}:{},chain:i?{id:i}:null,gas:s.gas??void 0})}(this.wagmiConfig,n);return await async function(e,t){const{chainId:n,timeout:i=0,...r}=t,s=e.getClient({chainId:n}),a=VJ(s,r0,"waitForTransactionReceipt"),o=await a({...r,timeout:i});if("reverted"===o.status){const e=VJ(s,Y$,"getTransaction"),t=await e({hash:o.transactionHash}),n=VJ(s,s0.T,"call"),i=await n({...t,data:t.input,gasPrice:"eip1559"!==t.type?t.gasPrice:void 0,maxFeePerGas:"eip1559"===t.type?t.maxFeePerGas:void 0,maxPriorityFeePerGas:"eip1559"===t.type?t.maxPriorityFeePerGas:void 0}),r=i?.data?(0,JJ.IQ)(`0x${i.data.substring(138)}`):"unknown reason";throw new Error(r)}return{...o,chainId:s.chain.id}}(this.wagmiConfig,{hash:i,timeout:25e3}),{hash:i}}async writeContract(e){const{caipNetwork:t,...n}=e,i=Number(HQ.L.caipNetworkIdToNumber(t.caipNetworkId)),r=await async function(e,t){const{account:n,chainId:i,connector:r,...s}=t;let a;a="object"===typeof n&&"local"===n?.type?e.getClient({chainId:i}):await KJ(e,{account:n??void 0,chainId:i,connector:r});const o=VJ(a,h0,"writeContract");return await o({...s,...n?{account:n}:{},chain:i?{id:i}:null})}(this.wagmiConfig,{chain:this.wagmiChains?.[i],chainId:i,address:n.tokenAddress,account:n.fromAddress,abi:n.abi,functionName:n.method,args:n.args,__mode:"prepared"});return{hash:r}}async getEnsAddress(e){const{name:t,caipNetwork:n}=e;try{if(!this.wagmiConfig)throw new Error("networkControllerClient:getApprovedCaipNetworksData - wagmiConfig is undefined");let e=!1,r=!1;return i=t,(i?.endsWith(OG.o.WC_NAME_SUFFIX_LEGACY)||i?.endsWith(OG.o.WC_NAME_SUFFIX))&&(r=await UX.resolveReownName(t)||!1),1===n.id&&(e=await function(e,t){const{chainId:n,...i}=t;return VJ(e.getClient({chainId:n}),C0,"getEnsAddress")(i)}(this.wagmiConfig,{name:s2(t),chainId:n.id})),{address:e||r||!1}}catch{return{address:!1}}var i}async estimateGas(e){try{return{gas:await async function(e,t){const{chainId:n,connector:i,...r}=t;let s;s=t.account?t.account:(await KJ(e,{account:t.account,chainId:n,connector:i})).account;return VJ(e.getClient({chainId:n}),_$,"estimateGas")({...r,account:s})}(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}}catch(t){throw new Error("WagmiAdapter:estimateGas - error estimating gas")}}parseUnits(e){return function(e,t){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(e))throw new X0({value:e});let[n,i="0"]=e.split(".");const r=n.startsWith("-");if(r&&(n=n.slice(1)),i=i.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${i}`))&&(n=`${BigInt(n)+1n}`),i="";else if(i.length>t){const[e,r,s]=[i.slice(0,t-1),i.slice(t-1,t),i.slice(t)],a=Math.round(Number(`${r}.${s}`));i=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`,i.length>t&&(i=i.slice(1),n=`${BigInt(n)+1n}`),i=i.slice(0,t)}else i=i.padEnd(t,"0");return BigInt(`${r?"-":""}${n}${i}`)}(e.value,e.decimals)}formatUnits(e){return(0,P0.J)(e.value,e.decimals)}async addWagmiConnector(e,t){if(e.id===OG.o.CONNECTOR_ID.AUTH||e.id===OG.o.CONNECTOR_ID.WALLET_CONNECT)return;const n=await e.getProvider().catch((()=>{}));this.addConnector({id:e.id,explorerId:xX.ConnectorExplorerIds[e.id],imageUrl:t?.connectorImages?.[e.id]??e.icon,name:xX.ConnectorNamesMap[e.id]??e.name,imageId:xX.ConnectorImageIds[e.id],type:xX.ConnectorTypesMap[e.type]??"EXTERNAL",info:e.id===OG.o.CONNECTOR_ID.INJECTED?void 0:{rdns:e.id},provider:n,chain:this.namespace,chains:[]})}async syncConnectors(e,t){!function(e,t){const{onChange:n}=t;e._internal.connectors.subscribe(((e,t)=>{n(Object.values(e),t)}))}(this.wagmiConfig,{onChange:t=>t.forEach((t=>this.addWagmiConnector(t,e)))}),await Promise.all(this.wagmiConfig.connectors.map((t=>this.addWagmiConnector(t,e)))),this.addWagmiConnectors(e,t),await this.addThirdPartyConnectors(e)}async syncConnection(e){const{id:t}=e,n=S0(this.wagmiConfig).find((e=>e.connector.id===t)),i=this.getWagmiConnector(t),r=await(i?.getProvider());return{chainId:Number(n?.chainId),address:n?.accounts[0],provider:r,type:n?.connector.type,id:n?.connector.id}}async connectWalletConnect(e){const t=this.getWalletConnectConnector();await t.authenticate();const n=this.getWagmiConnector("walletConnect");if(!n)throw new Error("UniversalAdapter:connectWalletConnect - connector not found");const i=await _0(this.wagmiConfig,{connector:n,chainId:e?Number(e):void 0});return i.chainId!==Number(e)&&await T0(this.wagmiConfig,{chainId:i.chainId}),{clientId:await t.provider.client.core.crypto.getClientId()}}async connect(e){const{id:t,provider:n,type:i,info:r,chainId:s}=e,a=this.getWagmiConnector(t);if(!a)throw new Error("connectionControllerClient:connectExternal - connector is undefined");if(n&&r&&a.id===OG.o.CONNECTOR_ID.EIP6963&&a.setEip6963Wallet?.({provider:n,info:r}),a.uid===this.wagmiConfig?.state?.current){const e=this.wagmiConfig.state?.connections?.get(a.uid);if(e)return{address:e?.accounts[0],chainId:e?.chainId,provider:n,type:i,id:t}}const o=await _0(this.wagmiConfig,{connector:a,chainId:s?Number(s):void 0});return{address:o.accounts[0],chainId:o.chainId,provider:n,type:i,id:t}}async reconnect(e){const{id:t}=e,n=this.getWagmiConnector(t);if(!n)throw new Error("connectionControllerClient:connectExternal - connector is undefined");await JX(this.wagmiConfig,{connectors:[n]})}async getBalance(e){const t=e.address,n=this.getCaipNetworks().find((t=>t.id===e.chainId));if(!t)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(n&&this.wagmiConfig){const t=`${n.caipNetworkId}:${e.address}`,i=this.balancePromises[t];if(i)return i;const r=WG.i.getNativeBalanceCacheForCaipAddress(t);return r?{balance:r.balance,symbol:r.symbol}:(this.balancePromises[t]=new Promise((async i=>{try{const r=Number(e.chainId),s=await async function(e,t){const{address:n,blockNumber:i,blockTag:r,chainId:s,token:a,unit:o="ether"}=t;if(a)try{return await D0(e,{balanceAddress:n,chainId:s,symbolType:"string",tokenAddress:a})}catch(d){if("ContractFunctionExecutionError"===d.name){const t=await D0(e,{balanceAddress:n,chainId:s,symbolType:"bytes32",tokenAddress:a}),i=(0,JJ.IQ)((0,f0.B)(t.symbol,{dir:"right"}));return{...t,symbol:i}}throw d}const l=e.getClient({chainId:s}),c=VJ(l,S$,"getBalance"),h=await c(i?{address:n,blockNumber:i}:{address:n,blockTag:r}),u=e.chains.find((e=>e.id===s))??l.chain;return{decimals:u.nativeCurrency.decimals,formatted:(0,P0.J)(h,N0(o)),symbol:u.nativeCurrency.symbol,value:h}}(this.wagmiConfig,{address:e.address,chainId:r,token:e.tokens?.[n.caipNetworkId]?.address});WG.i.updateNativeBalanceCache({caipAddress:t,balance:s.formatted,symbol:s.symbol,timestamp:Date.now()}),i({balance:s.formatted,symbol:s.symbol})}catch(r){console.warn("Appkit:WagmiAdapter:getBalance - Error getting balance",r),i({balance:"0.00",symbol:"ETH"})}})).finally((()=>{delete this.balancePromises[t]})),this.balancePromises[t]||{balance:"0.00",symbol:"ETH"})}return{balance:"",symbol:""}}async getProfile(e){const t=e.chainId,n=await function(e,t){const{chainId:n,...i}=t;return VJ(e.getClient({chainId:n}),L0,"getEnsName")(i)}(this.wagmiConfig,{address:e.address,chainId:t});if(n){const e=await function(e,t){const{chainId:n,...i}=t;return VJ(e.getClient({chainId:n}),Q0,"getEnsAvatar")(i)}(this.wagmiConfig,{name:n,chainId:t});return{profileName:n,profileImage:e??void 0}}return{profileName:void 0,profileImage:void 0}}getWalletConnectProvider(){return this.getWagmiConnector("walletConnect")?.provider}async disconnect(){const e=S0(this.wagmiConfig);await Promise.all(e.map((async e=>{const t=this.getWagmiConnector(e.connector.id);t&&await async function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.connector)t=n.connector;else{const{connections:n,current:i}=e.state,r=n.get(i);t=r?.connector}const i=e.state.connections;t&&(await t.disconnect(),t.emitter.off("change",e._internal.events.change),t.emitter.off("disconnect",e._internal.events.disconnect),t.emitter.on("connect",e._internal.events.connect),i.delete(t.uid)),e.setState((e=>{if(0===i.size)return{...e,connections:new Map,current:null,status:"disconnected"};const t=i.values().next().value;return{...e,connections:new Map(i),current:t.connector.uid}}));{const t=e.state.current;if(!t)return;const n=e.state.connections.get(t)?.connector;if(!n)return;await(e.storage?.setItem("recentConnectorId",n.id))}}(this.wagmiConfig,{connector:t})})))}async switchNetwork(e){await T0(this.wagmiConfig,{chainId:e.caipNetwork.id}),await super.switchNetwork(e)}async getCapabilities(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:getCapabilities - wagmiConfig is undefined");const t=S0(this.wagmiConfig)[0],n=t?this.getWagmiConnector(t.connector.id):null;if(!n)throw new Error("connectionControllerClient:getCapabilities - connector is undefined");const i=await n.getProvider();if(!i)throw new Error("connectionControllerClient:getCapabilities - provider is undefined");const r=i.session?.sessionProperties?.capabilities;if(r){const t=function(e){try{return JSON.parse(e)}catch(t){throw new Error("Error parsing wallet capabilities")}}(r)[e];if(t)return t}return await i.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:grantPermissions - wagmiConfig is undefined");const t=S0(this.wagmiConfig)[0],n=t?this.getWagmiConnector(t.connector.id):null;if(!n)throw new Error("connectionControllerClient:grantPermissions - connector is undefined");const i=await n.getProvider();if(!i)throw new Error("connectionControllerClient:grantPermissions - provider is undefined");return i.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:revokePermissions - wagmiConfig is undefined");const t=S0(this.wagmiConfig)[0],n=t?this.getWagmiConnector(t.connector.id):null;if(!n)throw new Error("connectionControllerClient:revokePermissions - connector is undefined");const i=await n.getProvider();if(!i)throw new Error("connectionControllerClient:revokePermissions - provider is undefined");return i.request({method:"wallet_revokePermissions",params:e})}async walletGetAssets(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:walletGetAssets - wagmiConfig is undefined");const t=S0(this.wagmiConfig)[0],n=t?this.getWagmiConnector(t.connector.id):null;if(!n)throw new Error("connectionControllerClient:walletGetAssets - connector is undefined");const i=await n.getProvider();if(!i)throw new Error("connectionControllerClient:walletGetAssets - provider is undefined");return i.request({method:"wallet_getAssets",params:[e]})}setUniversalProvider(e){this.addConnector(new zX({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"}))}}({networks:p2,projectId:d2,ssr:!0});function m2(e){let{children:t}=e;return(0,gt.jsx)(tZ,{config:f2.wagmiConfig,children:(0,gt.jsx)(FZ,{client:u2,children:t})})}!function(e){var t;KX||(KX=new qX({...e,sdkVersion:IG.w.generateSdkVersion(e.adapters??[],"react","1.7.3")}),(t=KX)&&(WX=t))}({adapters:[f2],networks:p2,projectId:d2,metadata:{name:"AppKit Example",description:"Testing WalletKit",url:"http://localhost:3000",icons:["https://avatars.githubusercontent.com/u/179229932"]},features:{email:!1,socials:[],analytics:!1}});r.createRoot(document.getElementById("root")).render((0,gt.jsx)(gt.Fragment,{children:(0,gt.jsxs)(m2,{children:[(0,gt.jsx)(QX,{}),(0,gt.jsx)(ft,{position:"top-center",autoClose:5e3,hideProgressBar:!0,newestOnTop:!0,closeOnClick:!1,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})})),XX()})()})();
//# sourceMappingURL=main.6a6a5d1d.js.map